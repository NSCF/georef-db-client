var dw=(l,o)=>()=>(o||l((o={exports:{}}).exports,o),o.exports);var pw=dw((exports,module)=>{(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))c(h);new MutationObserver(h=>{for(const d of h)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&c(p)}).observe(document,{childList:!0,subtree:!0});function s(h){const d={};return h.integrity&&(d.integrity=h.integrity),h.referrerpolicy&&(d.referrerPolicy=h.referrerpolicy),h.crossorigin==="use-credentials"?d.credentials="include":h.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function c(h){if(h.ep)return;h.ep=!0;const d=s(h);fetch(h.href,d)}})();function noop$2(){}const identity=l=>l;function assign(l,o){for(const s in o)l[s]=o[s];return l}function run(l){return l()}function blank_object(){return Object.create(null)}function run_all(l){l.forEach(run)}function is_function(l){return typeof l=="function"}function safe_not_equal(l,o){return l!=l?o==o:l!==o||l&&typeof l=="object"||typeof l=="function"}function is_empty(l){return Object.keys(l).length===0}function subscribe(l,...o){if(l==null)return noop$2;const s=l.subscribe(...o);return s.unsubscribe?()=>s.unsubscribe():s}function component_subscribe(l,o,s){l.$$.on_destroy.push(subscribe(o,s))}function create_slot(l,o,s,c){if(l){const h=get_slot_context(l,o,s,c);return l[0](h)}}function get_slot_context(l,o,s,c){return l[1]&&c?assign(s.ctx.slice(),l[1](c(o))):s.ctx}function get_slot_changes(l,o,s,c){if(l[2]&&c){const h=l[2](c(s));if(o.dirty===void 0)return h;if(typeof h=="object"){const d=[],p=Math.max(o.dirty.length,h.length);for(let Co=0;Co<p;Co+=1)d[Co]=o.dirty[Co]|h[Co];return d}return o.dirty|h}return o.dirty}function update_slot_base(l,o,s,c,h,d){if(h){const p=get_slot_context(o,s,c,d);l.p(p,h)}}function get_all_dirty_from_scope(l){if(l.ctx.length>32){const o=[],s=l.ctx.length/32;for(let c=0;c<s;c++)o[c]=-1;return o}return-1}function exclude_internal_props(l){const o={};for(const s in l)s[0]!=="$"&&(o[s]=l[s]);return o}function compute_rest_props(l,o){const s={};o=new Set(o);for(const c in l)!o.has(c)&&c[0]!=="$"&&(s[c]=l[c]);return s}function set_store_value(l,o,s){return l.set(s),o}const is_client=typeof window<"u";let now=is_client?()=>window.performance.now():()=>Date.now(),raf=is_client?l=>requestAnimationFrame(l):noop$2;const tasks=new Set;function run_tasks(l){tasks.forEach(o=>{o.c(l)||(tasks.delete(o),o.f())}),tasks.size!==0&&raf(run_tasks)}function loop(l){let o;return tasks.size===0&&raf(run_tasks),{promise:new Promise(s=>{tasks.add(o={c:l,f:s})}),abort(){tasks.delete(o)}}}function append(l,o){l.appendChild(o)}function get_root_for_style(l){if(!l)return document;const o=l.getRootNode?l.getRootNode():l.ownerDocument;return o&&o.host?o:l.ownerDocument}function append_empty_stylesheet(l){const o=element("style");return append_stylesheet(get_root_for_style(l),o),o}function append_stylesheet(l,o){append(l.head||l,o)}function insert(l,o,s){l.insertBefore(o,s||null)}function detach(l){l.parentNode.removeChild(l)}function destroy_each(l,o){for(let s=0;s<l.length;s+=1)l[s]&&l[s].d(o)}function element(l){return document.createElement(l)}function svg_element(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function text(l){return document.createTextNode(l)}function space(){return text(" ")}function empty$1(){return text("")}function listen(l,o,s,c){return l.addEventListener(o,s,c),()=>l.removeEventListener(o,s,c)}function prevent_default(l){return function(o){return o.preventDefault(),l.call(this,o)}}function stop_propagation(l){return function(o){return o.stopPropagation(),l.call(this,o)}}function attr(l,o,s){s==null?l.removeAttribute(o):l.getAttribute(o)!==s&&l.setAttribute(o,s)}function set_attributes(l,o){const s=Object.getOwnPropertyDescriptors(l.__proto__);for(const c in o)o[c]==null?l.removeAttribute(c):c==="style"?l.style.cssText=o[c]:c==="__value"?l.value=l[c]=o[c]:s[c]&&s[c].set?l[c]=o[c]:attr(l,c,o[c])}function set_custom_element_data(l,o,s){o in l?l[o]=typeof l[o]=="boolean"&&s===""?!0:s:attr(l,o,s)}function to_number(l){return l===""?null:+l}function children$1(l){return Array.from(l.childNodes)}function set_data(l,o){o=""+o,l.wholeText!==o&&(l.data=o)}function set_input_value(l,o){l.value=o==null?"":o}function set_style(l,o,s,c){l.style.setProperty(o,s,c?"important":"")}function select_option(l,o){for(let s=0;s<l.options.length;s+=1){const c=l.options[s];if(c.__value===o){c.selected=!0;return}}l.selectedIndex=-1}function select_value(l){const o=l.querySelector(":checked")||l.options[0];return o&&o.__value}let crossorigin;function is_crossorigin(){if(crossorigin===void 0){crossorigin=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{crossorigin=!0}}return crossorigin}function add_resize_listener(l,o){getComputedStyle(l).position==="static"&&(l.style.position="relative");const c=element("iframe");c.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),c.setAttribute("aria-hidden","true"),c.tabIndex=-1;const h=is_crossorigin();let d;return h?(c.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",d=listen(window,"message",p=>{p.source===c.contentWindow&&o()})):(c.src="about:blank",c.onload=()=>{d=listen(c.contentWindow,"resize",o)}),append(l,c),()=>{(h||d&&c.contentWindow)&&d(),detach(c)}}function toggle_class(l,o,s){l.classList[s?"add":"remove"](o)}function custom_event(l,o,s=!1){const c=document.createEvent("CustomEvent");return c.initCustomEvent(l,s,!1,o),c}class HtmlTag{constructor(){this.e=this.n=null}c(o){this.h(o)}m(o,s,c=null){this.e||(this.e=element(s.nodeName),this.t=s,this.c(o)),this.i(c)}h(o){this.e.innerHTML=o,this.n=Array.from(this.e.childNodes)}i(o){for(let s=0;s<this.n.length;s+=1)insert(this.t,this.n[s],o)}p(o){this.d(),this.h(o),this.i(this.a)}d(){this.n.forEach(detach)}}const active_docs=new Set;let active=0;function hash(l){let o=5381,s=l.length;for(;s--;)o=(o<<5)-o^l.charCodeAt(s);return o>>>0}function create_rule(l,o,s,c,h,d,p,Co=0){const Bo=16.666/c;let Lo=`{
`;for(let jo=0;jo<=1;jo+=Bo){const zo=o+(s-o)*d(jo);Lo+=jo*100+`%{${p(zo,1-zo)}}
`}const Uo=Lo+`100% {${p(s,1-s)}}
}`,Qo=`__svelte_${hash(Uo)}_${Co}`,Po=get_root_for_style(l);active_docs.add(Po);const Mo=Po.__svelte_stylesheet||(Po.__svelte_stylesheet=append_empty_stylesheet(l).sheet),Go=Po.__svelte_rules||(Po.__svelte_rules={});Go[Qo]||(Go[Qo]=!0,Mo.insertRule(`@keyframes ${Qo} ${Uo}`,Mo.cssRules.length));const $o=l.style.animation||"";return l.style.animation=`${$o?`${$o}, `:""}${Qo} ${c}ms linear ${h}ms 1 both`,active+=1,Qo}function delete_rule(l,o){const s=(l.style.animation||"").split(", "),c=s.filter(o?d=>d.indexOf(o)<0:d=>d.indexOf("__svelte")===-1),h=s.length-c.length;h&&(l.style.animation=c.join(", "),active-=h,active||clear_rules())}function clear_rules(){raf(()=>{active||(active_docs.forEach(l=>{const o=l.__svelte_stylesheet;let s=o.cssRules.length;for(;s--;)o.deleteRule(s);l.__svelte_rules={}}),active_docs.clear())})}let current_component;function set_current_component(l){current_component=l}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function beforeUpdate(l){get_current_component().$$.before_update.push(l)}function onMount(l){get_current_component().$$.on_mount.push(l)}function afterUpdate(l){get_current_component().$$.after_update.push(l)}function onDestroy(l){get_current_component().$$.on_destroy.push(l)}function createEventDispatcher(){const l=get_current_component();return(o,s)=>{const c=l.$$.callbacks[o];if(c){const h=custom_event(o,s);c.slice().forEach(d=>{d.call(l,h)})}}}function setContext(l,o){get_current_component().$$.context.set(l,o)}function getContext(l){return get_current_component().$$.context.get(l)}function bubble(l,o){const s=l.$$.callbacks[o.type];s&&s.slice().forEach(c=>c.call(this,o))}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function tick(){return schedule_update(),resolved_promise}function add_render_callback(l){render_callbacks.push(l)}function add_flush_callback(l){flush_callbacks.push(l)}let flushing=!1;const seen_callbacks=new Set;function flush(){if(!flushing){flushing=!0;do{for(let l=0;l<dirty_components.length;l+=1){const o=dirty_components[l];set_current_component(o),update(o.$$)}for(set_current_component(null),dirty_components.length=0;binding_callbacks.length;)binding_callbacks.pop()();for(let l=0;l<render_callbacks.length;l+=1){const o=render_callbacks[l];seen_callbacks.has(o)||(seen_callbacks.add(o),o())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,flushing=!1,seen_callbacks.clear()}}function update(l){if(l.fragment!==null){l.update(),run_all(l.before_update);const o=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,o),l.after_update.forEach(add_render_callback)}}let promise;function wait(){return promise||(promise=Promise.resolve(),promise.then(()=>{promise=null})),promise}function dispatch$2(l,o,s){l.dispatchEvent(custom_event(`${o?"intro":"outro"}${s}`))}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(l,o){l&&l.i&&(outroing.delete(l),l.i(o))}function transition_out(l,o,s,c){if(l&&l.o){if(outroing.has(l))return;outroing.add(l),outros.c.push(()=>{outroing.delete(l),c&&(s&&l.d(1),c())}),l.o(o)}}const null_transition={duration:0};function create_in_transition(l,o,s){let c=o(l,s),h=!1,d,p,Co=0;function Bo(){d&&delete_rule(l,d)}function Lo(){const{delay:Qo=0,duration:Po=300,easing:Mo=identity,tick:Go=noop$2,css:$o}=c||null_transition;$o&&(d=create_rule(l,0,1,Po,Qo,Mo,$o,Co++)),Go(0,1);const jo=now()+Qo,zo=jo+Po;p&&p.abort(),h=!0,add_render_callback(()=>dispatch$2(l,!0,"start")),p=loop(Xo=>{if(h){if(Xo>=zo)return Go(1,0),dispatch$2(l,!0,"end"),Bo(),h=!1;if(Xo>=jo){const Zo=Mo((Xo-jo)/Po);Go(Zo,1-Zo)}}return h})}let Uo=!1;return{start(){Uo||(Uo=!0,delete_rule(l),is_function(c)?(c=c(),wait().then(Lo)):Lo())},invalidate(){Uo=!1},end(){h&&(Bo(),h=!1)}}}function create_out_transition(l,o,s){let c=o(l,s),h=!0,d;const p=outros;p.r+=1;function Co(){const{delay:Bo=0,duration:Lo=300,easing:Uo=identity,tick:Qo=noop$2,css:Po}=c||null_transition;Po&&(d=create_rule(l,1,0,Lo,Bo,Uo,Po));const Mo=now()+Bo,Go=Mo+Lo;add_render_callback(()=>dispatch$2(l,!1,"start")),loop($o=>{if(h){if($o>=Go)return Qo(0,1),dispatch$2(l,!1,"end"),--p.r||run_all(p.c),!1;if($o>=Mo){const jo=Uo(($o-Mo)/Lo);Qo(1-jo,jo)}}return h})}return is_function(c)?wait().then(()=>{c=c(),Co()}):Co(),{end(Bo){Bo&&c.tick&&c.tick(1,0),h&&(d&&delete_rule(l,d),h=!1)}}}function create_bidirectional_transition(l,o,s,c){let h=o(l,s),d=c?0:1,p=null,Co=null,Bo=null;function Lo(){Bo&&delete_rule(l,Bo)}function Uo(Po,Mo){const Go=Po.b-d;return Mo*=Math.abs(Go),{a:d,b:Po.b,d:Go,duration:Mo,start:Po.start,end:Po.start+Mo,group:Po.group}}function Qo(Po){const{delay:Mo=0,duration:Go=300,easing:$o=identity,tick:jo=noop$2,css:zo}=h||null_transition,Xo={start:now()+Mo,b:Po};Po||(Xo.group=outros,outros.r+=1),p||Co?Co=Xo:(zo&&(Lo(),Bo=create_rule(l,d,Po,Go,Mo,$o,zo)),Po&&jo(0,1),p=Uo(Xo,Go),add_render_callback(()=>dispatch$2(l,Po,"start")),loop(Zo=>{if(Co&&Zo>Co.start&&(p=Uo(Co,Go),Co=null,dispatch$2(l,p.b,"start"),zo&&(Lo(),Bo=create_rule(l,d,p.b,p.duration,0,$o,h.css))),p){if(Zo>=p.end)jo(d=p.b,1-d),dispatch$2(l,p.b,"end"),Co||(p.b?Lo():--p.group.r||run_all(p.group.c)),p=null;else if(Zo>=p.start){const Wo=Zo-p.start;d=p.a+p.d*$o(Wo/p.duration),jo(d,1-d)}}return!!(p||Co)}))}return{run(Po){is_function(h)?wait().then(()=>{h=h(),Qo(Po)}):Qo(Po)},end(){Lo(),p=Co=null}}}const globals=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function outro_and_destroy_block(l,o){transition_out(l,1,1,()=>{o.delete(l.key)})}function update_keyed_each(l,o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo){let Po=l.length,Mo=d.length,Go=Po;const $o={};for(;Go--;)$o[l[Go].key]=Go;const jo=[],zo=new Map,Xo=new Map;for(Go=Mo;Go--;){const is=Qo(h,d,Go),Jo=s(is);let Ko=p.get(Jo);Ko?c&&Ko.p(is,o):(Ko=Lo(Jo,is),Ko.c()),zo.set(Jo,jo[Go]=Ko),Jo in $o&&Xo.set(Jo,Math.abs(Go-$o[Jo]))}const Zo=new Set,Wo=new Set;function es(is){transition_in(is,1),is.m(Co,Uo),p.set(is.key,is),Uo=is.first,Mo--}for(;Po&&Mo;){const is=jo[Mo-1],Jo=l[Po-1],Ko=is.key,Yo=Jo.key;is===Jo?(Uo=is.first,Po--,Mo--):zo.has(Yo)?!p.has(Ko)||Zo.has(Ko)?es(is):Wo.has(Yo)?Po--:Xo.get(Ko)>Xo.get(Yo)?(Wo.add(Ko),es(is)):(Zo.add(Yo),Po--):(Bo(Jo,p),Po--)}for(;Po--;){const is=l[Po];zo.has(is.key)||Bo(is,p)}for(;Mo;)es(jo[Mo-1]);return jo}function get_spread_update(l,o){const s={},c={},h={$$scope:1};let d=l.length;for(;d--;){const p=l[d],Co=o[d];if(Co){for(const Bo in p)Bo in Co||(c[Bo]=1);for(const Bo in Co)h[Bo]||(s[Bo]=Co[Bo],h[Bo]=1);l[d]=Co}else for(const Bo in p)h[Bo]=1}for(const p in c)p in s||(s[p]=void 0);return s}function get_spread_object(l){return typeof l=="object"&&l!==null?l:{}}function bind(l,o,s){const c=l.$$.props[o];c!==void 0&&(l.$$.bound[c]=s,s(l.$$.ctx[c]))}function create_component(l){l&&l.c()}function mount_component(l,o,s,c){const{fragment:h,on_mount:d,on_destroy:p,after_update:Co}=l.$$;h&&h.m(o,s),c||add_render_callback(()=>{const Bo=d.map(run).filter(is_function);p?p.push(...Bo):run_all(Bo),l.$$.on_mount=[]}),Co.forEach(add_render_callback)}function destroy_component(l,o){const s=l.$$;s.fragment!==null&&(run_all(s.on_destroy),s.fragment&&s.fragment.d(o),s.on_destroy=s.fragment=null,s.ctx=[])}function make_dirty(l,o){l.$$.dirty[0]===-1&&(dirty_components.push(l),schedule_update(),l.$$.dirty.fill(0)),l.$$.dirty[o/31|0]|=1<<o%31}function init(l,o,s,c,h,d,p,Co=[-1]){const Bo=current_component;set_current_component(l);const Lo=l.$$={fragment:null,ctx:null,props:d,update:noop$2,not_equal:h,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(Bo?Bo.$$.context:[])),callbacks:blank_object(),dirty:Co,skip_bound:!1,root:o.target||Bo.$$.root};p&&p(Lo.root);let Uo=!1;if(Lo.ctx=s?s(l,o.props||{},(Qo,Po,...Mo)=>{const Go=Mo.length?Mo[0]:Po;return Lo.ctx&&h(Lo.ctx[Qo],Lo.ctx[Qo]=Go)&&(!Lo.skip_bound&&Lo.bound[Qo]&&Lo.bound[Qo](Go),Uo&&make_dirty(l,Qo)),Po}):[],Lo.update(),Uo=!0,run_all(Lo.before_update),Lo.fragment=c?c(Lo.ctx):!1,o.target){if(o.hydrate){const Qo=children$1(o.target);Lo.fragment&&Lo.fragment.l(Qo),Qo.forEach(detach)}else Lo.fragment&&Lo.fragment.c();o.intro&&transition_in(l.$$.fragment),mount_component(l,o.target,o.anchor,o.customElement),flush()}set_current_component(Bo)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop$2}$on(o,s){const c=this.$$.callbacks[o]||(this.$$.callbacks[o]=[]);return c.push(s),()=>{const h=c.indexOf(s);h!==-1&&c.splice(h,1)}}$set(o){this.$$set&&!is_empty(o)&&(this.$$.skip_bound=!0,this.$$set(o),this.$$.skip_bound=!1)}}const firebaseConfig={apiKey:"AIzaSyBwK_DbeqcjfjRbqlZcrYnFYMn8GmbarHQ",authDomain:"georef-745b9.firebaseapp.com",databaseURL:"https://georef-745b9.firebaseio.com",projectId:"georef-745b9",storageBucket:"georef-745b9.appspot.com",appId:"1:162606464079:web:ed51bb48a5443b0795be3a"};var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getAugmentedNamespace(l){var o=l.default;if(typeof o=="function"){var s=function(){return o.apply(this,arguments)};s.prototype=o.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(l).forEach(function(c){var h=Object.getOwnPropertyDescriptor(l,c);Object.defineProperty(s,c,h.get?h:{enumerable:!0,get:function(){return l[c]}})}),s}var index_cjs$2={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var extendStatics$1=function(l,o){return extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,c){s.__proto__=c}||function(s,c){for(var h in c)c.hasOwnProperty(h)&&(s[h]=c[h])},extendStatics$1(l,o)};function __extends$1(l,o){extendStatics$1(l,o);function s(){this.constructor=l}l.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}var __assign$1=function(){return __assign$1=Object.assign||function(o){for(var s,c=1,h=arguments.length;c<h;c++){s=arguments[c];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(o[d]=s[d])}return o},__assign$1.apply(this,arguments)};function __rest(l,o){var s={};for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&o.indexOf(c)<0&&(s[c]=l[c]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var h=0,c=Object.getOwnPropertySymbols(l);h<c.length;h++)o.indexOf(c[h])<0&&Object.prototype.propertyIsEnumerable.call(l,c[h])&&(s[c[h]]=l[c[h]]);return s}function __decorate(l,o,s,c){var h=arguments.length,d=h<3?o:c===null?c=Object.getOwnPropertyDescriptor(o,s):c,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(l,o,s,c);else for(var Co=l.length-1;Co>=0;Co--)(p=l[Co])&&(d=(h<3?p(d):h>3?p(o,s,d):p(o,s))||d);return h>3&&d&&Object.defineProperty(o,s,d),d}function __param(l,o){return function(s,c){o(s,c,l)}}function __metadata(l,o){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,o)}function __awaiter$1(l,o,s,c){function h(d){return d instanceof s?d:new s(function(p){p(d)})}return new(s||(s=Promise))(function(d,p){function Co(Uo){try{Lo(c.next(Uo))}catch(Qo){p(Qo)}}function Bo(Uo){try{Lo(c.throw(Uo))}catch(Qo){p(Qo)}}function Lo(Uo){Uo.done?d(Uo.value):h(Uo.value).then(Co,Bo)}Lo((c=c.apply(l,o||[])).next())})}function __generator$1(l,o){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},c,h,d,p;return p={next:Co(0),throw:Co(1),return:Co(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function Co(Lo){return function(Uo){return Bo([Lo,Uo])}}function Bo(Lo){if(c)throw new TypeError("Generator is already executing.");for(;s;)try{if(c=1,h&&(d=Lo[0]&2?h.return:Lo[0]?h.throw||((d=h.return)&&d.call(h),0):h.next)&&!(d=d.call(h,Lo[1])).done)return d;switch(h=0,d&&(Lo=[Lo[0]&2,d.value]),Lo[0]){case 0:case 1:d=Lo;break;case 4:return s.label++,{value:Lo[1],done:!1};case 5:s.label++,h=Lo[1],Lo=[0];continue;case 7:Lo=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(Lo[0]===6||Lo[0]===2)){s=0;continue}if(Lo[0]===3&&(!d||Lo[1]>d[0]&&Lo[1]<d[3])){s.label=Lo[1];break}if(Lo[0]===6&&s.label<d[1]){s.label=d[1],d=Lo;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(Lo);break}d[2]&&s.ops.pop(),s.trys.pop();continue}Lo=o.call(l,s)}catch(Uo){Lo=[6,Uo],h=0}finally{c=d=0}if(Lo[0]&5)throw Lo[1];return{value:Lo[0]?Lo[1]:void 0,done:!0}}}function __exportStar(l,o){for(var s in l)o.hasOwnProperty(s)||(o[s]=l[s])}function __values$1(l){var o=typeof Symbol=="function"&&Symbol.iterator,s=o&&l[o],c=0;if(s)return s.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&c>=l.length&&(l=void 0),{value:l&&l[c++],done:!l}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(l,o){var s=typeof Symbol=="function"&&l[Symbol.iterator];if(!s)return l;var c=s.call(l),h,d=[],p;try{for(;(o===void 0||o-- >0)&&!(h=c.next()).done;)d.push(h.value)}catch(Co){p={error:Co}}finally{try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(p)throw p.error}}return d}function __spread(){for(var l=[],o=0;o<arguments.length;o++)l=l.concat(__read(arguments[o]));return l}function __spreadArrays$1(){for(var l=0,o=0,s=arguments.length;o<s;o++)l+=arguments[o].length;for(var c=Array(l),h=0,o=0;o<s;o++)for(var d=arguments[o],p=0,Co=d.length;p<Co;p++,h++)c[h]=d[p];return c}function __await(l){return this instanceof __await?(this.v=l,this):new __await(l)}function __asyncGenerator(l,o,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=s.apply(l,o||[]),h,d=[];return h={},p("next"),p("throw"),p("return"),h[Symbol.asyncIterator]=function(){return this},h;function p(Po){c[Po]&&(h[Po]=function(Mo){return new Promise(function(Go,$o){d.push([Po,Mo,Go,$o])>1||Co(Po,Mo)})})}function Co(Po,Mo){try{Bo(c[Po](Mo))}catch(Go){Qo(d[0][3],Go)}}function Bo(Po){Po.value instanceof __await?Promise.resolve(Po.value.v).then(Lo,Uo):Qo(d[0][2],Po)}function Lo(Po){Co("next",Po)}function Uo(Po){Co("throw",Po)}function Qo(Po,Mo){Po(Mo),d.shift(),d.length&&Co(d[0][0],d[0][1])}}function __asyncDelegator(l){var o,s;return o={},c("next"),c("throw",function(h){throw h}),c("return"),o[Symbol.iterator]=function(){return this},o;function c(h,d){o[h]=l[h]?function(p){return(s=!s)?{value:__await(l[h](p)),done:h==="return"}:d?d(p):p}:d}}function __asyncValues(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=l[Symbol.asyncIterator],s;return o?o.call(l):(l=typeof __values$1=="function"?__values$1(l):l[Symbol.iterator](),s={},c("next"),c("throw"),c("return"),s[Symbol.asyncIterator]=function(){return this},s);function c(d){s[d]=l[d]&&function(p){return new Promise(function(Co,Bo){p=l[d](p),h(Co,Bo,p.done,p.value)})}}function h(d,p,Co,Bo){Promise.resolve(Bo).then(function(Lo){d({value:Lo,done:Co})},p)}}function __makeTemplateObject(l,o){return Object.defineProperty?Object.defineProperty(l,"raw",{value:o}):l.raw=o,l}function __importStar(l){if(l&&l.__esModule)return l;var o={};if(l!=null)for(var s in l)Object.hasOwnProperty.call(l,s)&&(o[s]=l[s]);return o.default=l,o}function __importDefault(l){return l&&l.__esModule?l:{default:l}}function __classPrivateFieldGet(l,o){if(!o.has(l))throw new TypeError("attempted to get private field on non-instance");return o.get(l)}function __classPrivateFieldSet(l,o,s){if(!o.has(l))throw new TypeError("attempted to set private field on non-instance");return o.set(l,s),s}const tslib_es6=Object.freeze(Object.defineProperty({__proto__:null,__extends:__extends$1,get __assign(){return __assign$1},__rest,__decorate,__param,__metadata,__awaiter:__awaiter$1,__generator:__generator$1,__exportStar,__values:__values$1,__read,__spread,__spreadArrays:__spreadArrays$1,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet,__classPrivateFieldSet},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(tslib_es6);var index_cjs$1={},hasRequiredIndex_cjs$2;function requireIndex_cjs$2(){if(hasRequiredIndex_cjs$2)return index_cjs$1;hasRequiredIndex_cjs$2=1,Object.defineProperty(index_cjs$1,"__esModule",{value:!0});var l=require$$0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var o={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var s=function(fs,vs){if(!fs)throw c(vs)},c=function(fs){return new Error("Firebase Database ("+o.SDK_VERSION+") INTERNAL ASSERT FAILED: "+fs)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var h=function(fs){for(var vs=[],Bs=0,Ls=0;Ls<fs.length;Ls++){var Fs=fs.charCodeAt(Ls);Fs<128?vs[Bs++]=Fs:Fs<2048?(vs[Bs++]=Fs>>6|192,vs[Bs++]=Fs&63|128):(Fs&64512)===55296&&Ls+1<fs.length&&(fs.charCodeAt(Ls+1)&64512)===56320?(Fs=65536+((Fs&1023)<<10)+(fs.charCodeAt(++Ls)&1023),vs[Bs++]=Fs>>18|240,vs[Bs++]=Fs>>12&63|128,vs[Bs++]=Fs>>6&63|128,vs[Bs++]=Fs&63|128):(vs[Bs++]=Fs>>12|224,vs[Bs++]=Fs>>6&63|128,vs[Bs++]=Fs&63|128)}return vs},d=function(fs){for(var vs=[],Bs=0,Ls=0;Bs<fs.length;){var Fs=fs[Bs++];if(Fs<128)vs[Ls++]=String.fromCharCode(Fs);else if(Fs>191&&Fs<224){var zs=fs[Bs++];vs[Ls++]=String.fromCharCode((Fs&31)<<6|zs&63)}else if(Fs>239&&Fs<365){var zs=fs[Bs++],js=fs[Bs++],ma=fs[Bs++],Ws=((Fs&7)<<18|(zs&63)<<12|(js&63)<<6|ma&63)-65536;vs[Ls++]=String.fromCharCode(55296+(Ws>>10)),vs[Ls++]=String.fromCharCode(56320+(Ws&1023))}else{var zs=fs[Bs++],js=fs[Bs++];vs[Ls++]=String.fromCharCode((Fs&15)<<12|(zs&63)<<6|js&63)}}return vs.join("")},p={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray:function(fs,vs){if(!Array.isArray(fs))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var Bs=vs?this.byteToCharMapWebSafe_:this.byteToCharMap_,Ls=[],Fs=0;Fs<fs.length;Fs+=3){var zs=fs[Fs],js=Fs+1<fs.length,ma=js?fs[Fs+1]:0,Ws=Fs+2<fs.length,va=Ws?fs[Fs+2]:0,ca=zs>>2,cl=(zs&3)<<4|ma>>4,Ms=(ma&15)<<2|va>>6,$s=va&63;Ws||($s=64,js||(Ms=64)),Ls.push(Bs[ca],Bs[cl],Bs[Ms],Bs[$s])}return Ls.join("")},encodeString:function(fs,vs){return this.HAS_NATIVE_SUPPORT&&!vs?btoa(fs):this.encodeByteArray(h(fs),vs)},decodeString:function(fs,vs){return this.HAS_NATIVE_SUPPORT&&!vs?atob(fs):d(this.decodeStringToByteArray(fs,vs))},decodeStringToByteArray:function(fs,vs){this.init_();for(var Bs=vs?this.charToByteMapWebSafe_:this.charToByteMap_,Ls=[],Fs=0;Fs<fs.length;){var zs=Bs[fs.charAt(Fs++)],js=Fs<fs.length,ma=js?Bs[fs.charAt(Fs)]:0;++Fs;var Ws=Fs<fs.length,va=Ws?Bs[fs.charAt(Fs)]:64;++Fs;var ca=Fs<fs.length,cl=ca?Bs[fs.charAt(Fs)]:64;if(++Fs,zs==null||ma==null||va==null||cl==null)throw Error();var Ms=zs<<2|ma>>4;if(Ls.push(Ms),va!==64){var $s=ma<<4&240|va>>2;if(Ls.push($s),cl!==64){var ga=va<<6&192|cl;Ls.push(ga)}}}return Ls},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var fs=0;fs<this.ENCODED_VALS.length;fs++)this.byteToCharMap_[fs]=this.ENCODED_VALS.charAt(fs),this.charToByteMap_[this.byteToCharMap_[fs]]=fs,this.byteToCharMapWebSafe_[fs]=this.ENCODED_VALS_WEBSAFE.charAt(fs),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[fs]]=fs,fs>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(fs)]=fs,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(fs)]=fs)}}},Co=function(fs){var vs=h(fs);return p.encodeByteArray(vs,!0)},Bo=function(fs){try{return p.decodeString(fs,!0)}catch(vs){console.error("base64Decode failed: ",vs)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lo(fs){return Uo(void 0,fs)}function Uo(fs,vs){if(!(vs instanceof Object))return vs;switch(vs.constructor){case Date:var Bs=vs;return new Date(Bs.getTime());case Object:fs===void 0&&(fs={});break;case Array:fs=[];break;default:return vs}for(var Ls in vs)!vs.hasOwnProperty(Ls)||(fs[Ls]=Uo(fs[Ls],vs[Ls]));return fs}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qo=function(){function fs(){var vs=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(Bs,Ls){vs.resolve=Bs,vs.reject=Ls})}return fs.prototype.wrapCallback=function(vs){var Bs=this;return function(Ls,Fs){Ls?Bs.reject(Ls):Bs.resolve(Fs),typeof vs=="function"&&(Bs.promise.catch(function(){}),vs.length===1?vs(Ls):vs(Ls,Fs))}},fs}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Mo(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Po())}function Go(){try{return Object.prototype.toString.call(commonjsGlobal$1.process)==="[object process]"}catch{return!1}}function $o(){return typeof self=="object"&&self.self===self}function jo(){var fs=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof fs=="object"&&fs.id!==void 0}function zo(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Xo(){return Po().indexOf("Electron/")>=0}function Zo(){var fs=Po();return fs.indexOf("MSIE ")>=0||fs.indexOf("Trident/")>=0}function Wo(){return Po().indexOf("MSAppHost/")>=0}function es(){return o.NODE_CLIENT===!0||o.NODE_ADMIN===!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var is="FirebaseError",Jo=function(fs){l.__extends(vs,fs);function vs(Bs,Ls){var Fs=fs.call(this,Ls)||this;return Fs.code=Bs,Fs.name=is,Object.setPrototypeOf(Fs,vs.prototype),Error.captureStackTrace&&Error.captureStackTrace(Fs,Ko.prototype.create),Fs}return vs}(Error),Ko=function(){function fs(vs,Bs,Ls){this.service=vs,this.serviceName=Bs,this.errors=Ls}return fs.prototype.create=function(vs){for(var Bs=[],Ls=1;Ls<arguments.length;Ls++)Bs[Ls-1]=arguments[Ls];for(var Fs=Bs[0]||{},zs=this.service+"/"+vs,js=this.errors[vs],ma=js?Yo(js,Fs):"Error",Ws=this.serviceName+": "+ma+" ("+zs+").",va=new Jo(zs,Ws),ca=0,cl=Object.keys(Fs);ca<cl.length;ca++){var Ms=cl[ca];Ms.slice(-1)!=="_"&&(Ms in va&&console.warn('Overwriting FirebaseError base field "'+Ms+'" can cause unexpected behavior.'),va[Ms]=Fs[Ms])}return va},fs}();function Yo(fs,vs){return fs.replace(ts,function(Bs,Ls){var Fs=vs[Ls];return Fs!=null?Fs.toString():"<"+Ls+"?>"})}var ts=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(fs){return JSON.parse(fs)}function cs(fs){return JSON.stringify(fs)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var as=function(fs){var vs={},Bs={},Ls={},Fs="";try{var zs=fs.split(".");vs=ss(Bo(zs[0])||""),Bs=ss(Bo(zs[1])||""),Fs=zs[2],Ls=Bs.d||{},delete Bs.d}catch{}return{header:vs,claims:Bs,data:Ls,signature:Fs}},us=function(fs){var vs=as(fs).claims,Bs=Math.floor(new Date().getTime()/1e3),Ls=0,Fs=0;return typeof vs=="object"&&(vs.hasOwnProperty("nbf")?Ls=vs.nbf:vs.hasOwnProperty("iat")&&(Ls=vs.iat),vs.hasOwnProperty("exp")?Fs=vs.exp:Fs=Ls+86400),!!Bs&&!!Ls&&!!Fs&&Bs>=Ls&&Bs<=Fs},gs=function(fs){var vs=as(fs).claims;return typeof vs=="object"&&vs.hasOwnProperty("iat")?vs.iat:null},Is=function(fs){var vs=as(fs),Bs=vs.claims;return!!Bs&&typeof Bs=="object"&&Bs.hasOwnProperty("iat")},_s=function(fs){var vs=as(fs).claims;return typeof vs=="object"&&vs.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hs(fs,vs){return Object.prototype.hasOwnProperty.call(fs,vs)}function ds(fs,vs){if(Object.prototype.hasOwnProperty.call(fs,vs))return fs[vs]}function hs(fs){for(var vs in fs)if(Object.prototype.hasOwnProperty.call(fs,vs))return!1;return!0}function ys(fs,vs,Bs){var Ls={};for(var Fs in fs)Object.prototype.hasOwnProperty.call(fs,Fs)&&(Ls[Fs]=vs.call(Bs,fs[Fs],Fs,fs));return Ls}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ms(fs){for(var vs=[],Bs=function(Ws,va){Array.isArray(va)?va.forEach(function(ca){vs.push(encodeURIComponent(Ws)+"="+encodeURIComponent(ca))}):vs.push(encodeURIComponent(Ws)+"="+encodeURIComponent(va))},Ls=0,Fs=Object.entries(fs);Ls<Fs.length;Ls++){var zs=Fs[Ls],js=zs[0],ma=zs[1];Bs(js,ma)}return vs.length?"&"+vs.join("&"):""}function Rs(fs){var vs={},Bs=fs.replace(/^\?/,"").split("&");return Bs.forEach(function(Ls){if(Ls){var Fs=Ls.split("=");vs[Fs[0]]=Fs[1]}}),vs}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bs=function(){function fs(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(var vs=1;vs<this.blockSize;++vs)this.pad_[vs]=0;this.reset()}return fs.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},fs.prototype.compress_=function(vs,Bs){Bs||(Bs=0);var Ls=this.W_;if(typeof vs=="string")for(var Fs=0;Fs<16;Fs++)Ls[Fs]=vs.charCodeAt(Bs)<<24|vs.charCodeAt(Bs+1)<<16|vs.charCodeAt(Bs+2)<<8|vs.charCodeAt(Bs+3),Bs+=4;else for(var Fs=0;Fs<16;Fs++)Ls[Fs]=vs[Bs]<<24|vs[Bs+1]<<16|vs[Bs+2]<<8|vs[Bs+3],Bs+=4;for(var Fs=16;Fs<80;Fs++){var zs=Ls[Fs-3]^Ls[Fs-8]^Ls[Fs-14]^Ls[Fs-16];Ls[Fs]=(zs<<1|zs>>>31)&4294967295}for(var js=this.chain_[0],ma=this.chain_[1],Ws=this.chain_[2],va=this.chain_[3],ca=this.chain_[4],cl,Ms,Fs=0;Fs<80;Fs++){Fs<40?Fs<20?(cl=va^ma&(Ws^va),Ms=1518500249):(cl=ma^Ws^va,Ms=1859775393):Fs<60?(cl=ma&Ws|va&(ma|Ws),Ms=2400959708):(cl=ma^Ws^va,Ms=3395469782);var zs=(js<<5|js>>>27)+cl+ca+Ms+Ls[Fs]&4294967295;ca=va,va=Ws,Ws=(ma<<30|ma>>>2)&4294967295,ma=js,js=zs}this.chain_[0]=this.chain_[0]+js&4294967295,this.chain_[1]=this.chain_[1]+ma&4294967295,this.chain_[2]=this.chain_[2]+Ws&4294967295,this.chain_[3]=this.chain_[3]+va&4294967295,this.chain_[4]=this.chain_[4]+ca&4294967295},fs.prototype.update=function(vs,Bs){if(vs!=null){Bs===void 0&&(Bs=vs.length);for(var Ls=Bs-this.blockSize,Fs=0,zs=this.buf_,js=this.inbuf_;Fs<Bs;){if(js===0)for(;Fs<=Ls;)this.compress_(vs,Fs),Fs+=this.blockSize;if(typeof vs=="string"){for(;Fs<Bs;)if(zs[js]=vs.charCodeAt(Fs),++js,++Fs,js===this.blockSize){this.compress_(zs),js=0;break}}else for(;Fs<Bs;)if(zs[js]=vs[Fs],++js,++Fs,js===this.blockSize){this.compress_(zs),js=0;break}}this.inbuf_=js,this.total_+=Bs}},fs.prototype.digest=function(){var vs=[],Bs=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var Ls=this.blockSize-1;Ls>=56;Ls--)this.buf_[Ls]=Bs&255,Bs/=256;this.compress_(this.buf_);for(var Fs=0,Ls=0;Ls<5;Ls++)for(var zs=24;zs>=0;zs-=8)vs[Fs]=this.chain_[Ls]>>zs&255,++Fs;return vs},fs}();function ps(fs,vs){var Bs=new ks(fs,vs);return Bs.subscribe.bind(Bs)}var ks=function(){function fs(vs,Bs){var Ls=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=Bs,this.task.then(function(){vs(Ls)}).catch(function(Fs){Ls.error(Fs)})}return fs.prototype.next=function(vs){this.forEachObserver(function(Bs){Bs.next(vs)})},fs.prototype.error=function(vs){this.forEachObserver(function(Bs){Bs.error(vs)}),this.close(vs)},fs.prototype.complete=function(){this.forEachObserver(function(vs){vs.complete()}),this.close()},fs.prototype.subscribe=function(vs,Bs,Ls){var Fs=this,zs;if(vs===void 0&&Bs===void 0&&Ls===void 0)throw new Error("Missing Observer.");Ss(vs,["next","error","complete"])?zs=vs:zs={next:vs,error:Bs,complete:Ls},zs.next===void 0&&(zs.next=Us),zs.error===void 0&&(zs.error=Us),zs.complete===void 0&&(zs.complete=Us);var js=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{Fs.finalError?zs.error(Fs.finalError):zs.complete()}catch{}}),this.observers.push(zs),js},fs.prototype.unsubscribeOne=function(vs){this.observers===void 0||this.observers[vs]===void 0||(delete this.observers[vs],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},fs.prototype.forEachObserver=function(vs){if(!this.finalized)for(var Bs=0;Bs<this.observers.length;Bs++)this.sendOne(Bs,vs)},fs.prototype.sendOne=function(vs,Bs){var Ls=this;this.task.then(function(){if(Ls.observers!==void 0&&Ls.observers[vs]!==void 0)try{Bs(Ls.observers[vs])}catch(Fs){typeof console<"u"&&console.error&&console.error(Fs)}})},fs.prototype.close=function(vs){var Bs=this;this.finalized||(this.finalized=!0,vs!==void 0&&(this.finalError=vs),this.task.then(function(){Bs.observers=void 0,Bs.onNoObservers=void 0}))},fs}();function xs(fs,vs){return function(){for(var Bs=[],Ls=0;Ls<arguments.length;Ls++)Bs[Ls]=arguments[Ls];Promise.resolve(!0).then(function(){fs.apply(void 0,Bs)}).catch(function(Fs){vs&&vs(Fs)})}}function Ss(fs,vs){if(typeof fs!="object"||fs===null)return!1;for(var Bs=0,Ls=vs;Bs<Ls.length;Bs++){var Fs=Ls[Bs];if(Fs in fs&&typeof fs[Fs]=="function")return!0}return!1}function Us(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ps=function(fs,vs,Bs,Ls){var Fs;if(Ls<vs?Fs="at least "+vs:Ls>Bs&&(Fs=Bs===0?"none":"no more than "+Bs),Fs){var zs=fs+" failed: Was called with "+Ls+(Ls===1?" argument.":" arguments.")+" Expects "+Fs+".";throw new Error(zs)}};function Qs(fs,vs,Bs){var Ls="";switch(vs){case 1:Ls=Bs?"first":"First";break;case 2:Ls=Bs?"second":"Second";break;case 3:Ls=Bs?"third":"Third";break;case 4:Ls=Bs?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var Fs=fs+" failed: ";return Fs+=Ls+" argument ",Fs}function Js(fs,vs,Bs,Ls){if(!(Ls&&!Bs)&&typeof Bs!="string")throw new Error(Qs(fs,vs,Ls)+"must be a valid firebase namespace.")}function qs(fs,vs,Bs,Ls){if(!(Ls&&!Bs)&&typeof Bs!="function")throw new Error(Qs(fs,vs,Ls)+"must be a valid function.")}function Gs(fs,vs,Bs,Ls){if(!(Ls&&!Bs)&&(typeof Bs!="object"||Bs===null))throw new Error(Qs(fs,vs,Ls)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zs=function(fs){for(var vs=[],Bs=0,Ls=0;Ls<fs.length;Ls++){var Fs=fs.charCodeAt(Ls);if(Fs>=55296&&Fs<=56319){var zs=Fs-55296;Ls++,s(Ls<fs.length,"Surrogate pair missing trail surrogate.");var js=fs.charCodeAt(Ls)-56320;Fs=65536+(zs<<10)+js}Fs<128?vs[Bs++]=Fs:Fs<2048?(vs[Bs++]=Fs>>6|192,vs[Bs++]=Fs&63|128):Fs<65536?(vs[Bs++]=Fs>>12|224,vs[Bs++]=Fs>>6&63|128,vs[Bs++]=Fs&63|128):(vs[Bs++]=Fs>>18|240,vs[Bs++]=Fs>>12&63|128,vs[Bs++]=Fs>>6&63|128,vs[Bs++]=Fs&63|128)}return vs},Es=function(fs){for(var vs=0,Bs=0;Bs<fs.length;Bs++){var Ls=fs.charCodeAt(Bs);Ls<128?vs++:Ls<2048?vs+=2:Ls>=55296&&Ls<=56319?(vs+=4,Bs++):vs+=3}return vs};return index_cjs$1.CONSTANTS=o,index_cjs$1.Deferred=Qo,index_cjs$1.ErrorFactory=Ko,index_cjs$1.FirebaseError=Jo,index_cjs$1.Sha1=bs,index_cjs$1.assert=s,index_cjs$1.assertionError=c,index_cjs$1.async=xs,index_cjs$1.base64=p,index_cjs$1.base64Decode=Bo,index_cjs$1.base64Encode=Co,index_cjs$1.contains=Hs,index_cjs$1.createSubscribe=ps,index_cjs$1.decode=as,index_cjs$1.deepCopy=Lo,index_cjs$1.deepExtend=Uo,index_cjs$1.errorPrefix=Qs,index_cjs$1.getUA=Po,index_cjs$1.isAdmin=_s,index_cjs$1.isBrowser=$o,index_cjs$1.isBrowserExtension=jo,index_cjs$1.isElectron=Xo,index_cjs$1.isEmpty=hs,index_cjs$1.isIE=Zo,index_cjs$1.isMobileCordova=Mo,index_cjs$1.isNode=Go,index_cjs$1.isNodeSdk=es,index_cjs$1.isReactNative=zo,index_cjs$1.isUWP=Wo,index_cjs$1.isValidFormat=Is,index_cjs$1.isValidTimestamp=us,index_cjs$1.issuedAtTime=gs,index_cjs$1.jsonEval=ss,index_cjs$1.map=ys,index_cjs$1.querystring=ms,index_cjs$1.querystringDecode=Rs,index_cjs$1.safeGet=ds,index_cjs$1.stringLength=Es,index_cjs$1.stringToByteArray=Zs,index_cjs$1.stringify=cs,index_cjs$1.validateArgCount=Ps,index_cjs$1.validateCallback=qs,index_cjs$1.validateContextObject=Gs,index_cjs$1.validateNamespace=Js,index_cjs$1}var index_cjs={},hasRequiredIndex_cjs$1;function requireIndex_cjs$1(){if(hasRequiredIndex_cjs$1)return index_cjs;hasRequiredIndex_cjs$1=1,Object.defineProperty(index_cjs,"__esModule",{value:!0});var l=require$$0,o=requireIndex_cjs$2(),s=function(){function Bo(Lo,Uo,Qo){this.name=Lo,this.instanceFactory=Uo,this.type=Qo,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return Bo.prototype.setInstantiationMode=function(Lo){return this.instantiationMode=Lo,this},Bo.prototype.setMultipleInstances=function(Lo){return this.multipleInstances=Lo,this},Bo.prototype.setServiceProps=function(Lo){return this.serviceProps=Lo,this},Bo}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var c="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var h=function(){function Bo(Lo,Uo){this.name=Lo,this.container=Uo,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return Bo.prototype.get=function(Lo){Lo===void 0&&(Lo=c);var Uo=this.normalizeInstanceIdentifier(Lo);if(!this.instancesDeferred.has(Uo)){var Qo=new o.Deferred;this.instancesDeferred.set(Uo,Qo);try{var Po=this.getOrInitializeService(Uo);Po&&Qo.resolve(Po)}catch{}}return this.instancesDeferred.get(Uo).promise},Bo.prototype.getImmediate=function(Lo){var Uo=l.__assign({identifier:c,optional:!1},Lo),Qo=Uo.identifier,Po=Uo.optional,Mo=this.normalizeInstanceIdentifier(Qo);try{var Go=this.getOrInitializeService(Mo);if(!Go){if(Po)return null;throw Error("Service "+this.name+" is not available")}return Go}catch($o){if(Po)return null;throw $o}},Bo.prototype.getComponent=function(){return this.component},Bo.prototype.setComponent=function(Lo){var Uo,Qo;if(Lo.name!==this.name)throw Error("Mismatching Component "+Lo.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=Lo,p(Lo))try{this.getOrInitializeService(c)}catch{}try{for(var Po=l.__values(this.instancesDeferred.entries()),Mo=Po.next();!Mo.done;Mo=Po.next()){var Go=l.__read(Mo.value,2),$o=Go[0],jo=Go[1],zo=this.normalizeInstanceIdentifier($o);try{var Xo=this.getOrInitializeService(zo);jo.resolve(Xo)}catch{}}}catch(Zo){Uo={error:Zo}}finally{try{Mo&&!Mo.done&&(Qo=Po.return)&&Qo.call(Po)}finally{if(Uo)throw Uo.error}}},Bo.prototype.clearInstance=function(Lo){Lo===void 0&&(Lo=c),this.instancesDeferred.delete(Lo),this.instances.delete(Lo)},Bo.prototype.delete=function(){return l.__awaiter(this,void 0,void 0,function(){var Lo;return l.__generator(this,function(Uo){switch(Uo.label){case 0:return Lo=Array.from(this.instances.values()),[4,Promise.all(Lo.filter(function(Qo){return"INTERNAL"in Qo}).map(function(Qo){return Qo.INTERNAL.delete()}))];case 1:return Uo.sent(),[2]}})})},Bo.prototype.isComponentSet=function(){return this.component!=null},Bo.prototype.getOrInitializeService=function(Lo){var Uo=this.instances.get(Lo);return!Uo&&this.component&&(Uo=this.component.instanceFactory(this.container,d(Lo)),this.instances.set(Lo,Uo)),Uo||null},Bo.prototype.normalizeInstanceIdentifier=function(Lo){return this.component?this.component.multipleInstances?Lo:c:Lo},Bo}();function d(Bo){return Bo===c?void 0:Bo}function p(Bo){return Bo.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Co=function(){function Bo(Lo){this.name=Lo,this.providers=new Map}return Bo.prototype.addComponent=function(Lo){var Uo=this.getProvider(Lo.name);if(Uo.isComponentSet())throw new Error("Component "+Lo.name+" has already been registered with "+this.name);Uo.setComponent(Lo)},Bo.prototype.addOrOverwriteComponent=function(Lo){var Uo=this.getProvider(Lo.name);Uo.isComponentSet()&&this.providers.delete(Lo.name),this.addComponent(Lo)},Bo.prototype.getProvider=function(Lo){if(this.providers.has(Lo))return this.providers.get(Lo);var Uo=new h(Lo,this);return this.providers.set(Lo,Uo),Uo},Bo.prototype.getProviders=function(){return Array.from(this.providers.values())},Bo}();return index_cjs.Component=s,index_cjs.ComponentContainer=Co,index_cjs.Provider=h,index_cjs}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function __spreadArrays(){for(var l=0,o=0,s=arguments.length;o<s;o++)l+=arguments[o].length;for(var c=Array(l),h=0,o=0;o<s;o++)for(var d=arguments[o],p=0,Co=d.length;p<Co;p++,h++)c[h]=d[p];return c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a,instances$1=[],LogLevel;(function(l){l[l.DEBUG=0]="DEBUG",l[l.VERBOSE=1]="VERBOSE",l[l.INFO=2]="INFO",l[l.WARN=3]="WARN",l[l.ERROR=4]="ERROR",l[l.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));var levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod=(_a={},_a[LogLevel.DEBUG]="log",_a[LogLevel.VERBOSE]="log",_a[LogLevel.INFO]="info",_a[LogLevel.WARN]="warn",_a[LogLevel.ERROR]="error",_a),defaultLogHandler=function(l,o){for(var s=[],c=2;c<arguments.length;c++)s[c-2]=arguments[c];if(!(o<l.logLevel)){var h=new Date().toISOString(),d=ConsoleMethod[o];if(d)console[d].apply(console,__spreadArrays(["["+h+"]  "+l.name+":"],s));else throw new Error("Attempted to log a message with an invalid logType (value: "+o+")")}},Logger$1=function(){function l(o){this.name=o,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null,instances$1.push(this)}return Object.defineProperty(l.prototype,"logLevel",{get:function(){return this._logLevel},set:function(o){if(!(o in LogLevel))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=o},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"logHandler",{get:function(){return this._logHandler},set:function(o){if(typeof o!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=o},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(o){this._userLogHandler=o},enumerable:!0,configurable:!0}),l.prototype.debug=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],o)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],o))},l.prototype.log=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],o)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],o))},l.prototype.info=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.INFO],o)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.INFO],o))},l.prototype.warn=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.WARN],o)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.WARN],o))},l.prototype.error=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],o)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],o))},l}();function setLogLevel(l){var o=typeof l=="string"?levelStringToEnum[l]:l;instances$1.forEach(function(s){s.logLevel=o})}function setUserLogHandler(l,o){for(var s=function(p){var Co=null;o&&o.level&&(Co=levelStringToEnum[o.level]),l===null?p.userLogHandler=null:p.userLogHandler=function(Bo,Lo){for(var Uo=[],Qo=2;Qo<arguments.length;Qo++)Uo[Qo-2]=arguments[Qo];var Po=Uo.map(function(Mo){if(Mo==null)return null;if(typeof Mo=="string")return Mo;if(typeof Mo=="number"||typeof Mo=="boolean")return Mo.toString();if(Mo instanceof Error)return Mo.message;try{return JSON.stringify(Mo)}catch{return null}}).filter(function(Mo){return Mo}).join(" ");Lo>=(Co!=null?Co:Bo.logLevel)&&l({level:LogLevel[Lo].toLowerCase(),message:Po,args:Uo,type:Bo.name})}},c=0,h=instances$1;c<h.length;c++){var d=h[c];s(d)}}const index_esm$1=Object.freeze(Object.defineProperty({__proto__:null,get LogLevel(){return LogLevel},Logger:Logger$1,setLogLevel,setUserLogHandler},Symbol.toStringTag,{value:"Module"})),require$$3=getAugmentedNamespace(index_esm$1);var hasRequiredIndex_cjs;function requireIndex_cjs(){if(hasRequiredIndex_cjs)return index_cjs$2;hasRequiredIndex_cjs=1,Object.defineProperty(index_cjs$2,"__esModule",{value:!0});var l=require$$0,o=requireIndex_cjs$2(),s=requireIndex_cjs$1(),c=require$$3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var h,d=(h={},h["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",h["bad-app-name"]="Illegal App name: '{$appName}",h["duplicate-app"]="Firebase App named '{$appName}' already exists",h["app-deleted"]="Firebase App named '{$appName}' already deleted",h["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",h["invalid-log-argument"]="First argument to `onLog` must be null or a function.",h),p=new o.ErrorFactory("app","Firebase",d),Co="@firebase/app",Bo="0.6.4",Lo="@firebase/analytics",Uo="@firebase/auth",Qo="@firebase/database",Po="@firebase/functions",Mo="@firebase/installations",Go="@firebase/messaging",$o="@firebase/performance",jo="@firebase/remote-config",zo="@firebase/storage",Xo="@firebase/firestore",Zo="firebase-wrapper";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wo,es="[DEFAULT]",is=(Wo={},Wo[Co]="fire-core",Wo[Lo]="fire-analytics",Wo[Uo]="fire-auth",Wo[Qo]="fire-rtdb",Wo[Po]="fire-fn",Wo[Mo]="fire-iid",Wo[Go]="fire-fcm",Wo[$o]="fire-perf",Wo[jo]="fire-rc",Wo[zo]="fire-gcs",Wo[Xo]="fire-fst",Wo["fire-js"]="fire-js",Wo[Zo]="fire-js-all",Wo);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jo=new c.Logger("@firebase/app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ko=function(){function ds(hs,ys,ms){var Rs,bs,ps=this;this.firebase_=ms,this.isDeleted_=!1,this.name_=ys.name,this.automaticDataCollectionEnabled_=ys.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(hs),this.container=new s.ComponentContainer(ys.name),this._addComponent(new s.Component("app",function(){return ps},"PUBLIC"));try{for(var ks=l.__values(this.firebase_.INTERNAL.components.values()),xs=ks.next();!xs.done;xs=ks.next()){var Ss=xs.value;this._addComponent(Ss)}}catch(Us){Rs={error:Us}}finally{try{xs&&!xs.done&&(bs=ks.return)&&bs.call(ks)}finally{if(Rs)throw Rs.error}}}return Object.defineProperty(ds.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(hs){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=hs},enumerable:!0,configurable:!0}),Object.defineProperty(ds.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(ds.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),ds.prototype.delete=function(){var hs=this;return new Promise(function(ys){hs.checkDestroyed_(),ys()}).then(function(){return hs.firebase_.INTERNAL.removeApp(hs.name_),Promise.all(hs.container.getProviders().map(function(ys){return ys.delete()}))}).then(function(){hs.isDeleted_=!0})},ds.prototype._getService=function(hs,ys){return ys===void 0&&(ys=es),this.checkDestroyed_(),this.container.getProvider(hs).getImmediate({identifier:ys})},ds.prototype._removeServiceInstance=function(hs,ys){ys===void 0&&(ys=es),this.container.getProvider(hs).clearInstance(ys)},ds.prototype._addComponent=function(hs){try{this.container.addComponent(hs)}catch(ys){Jo.debug("Component "+hs.name+" failed to register with FirebaseApp "+this.name,ys)}},ds.prototype._addOrOverwriteComponent=function(hs){this.container.addOrOverwriteComponent(hs)},ds.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw p.create("app-deleted",{appName:this.name_})},ds}();Ko.prototype.name&&Ko.prototype.options||Ko.prototype.delete||console.log("dc");var Yo="7.14.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(ds){var hs={},ys=new Map,ms={__esModule:!0,initializeApp:ps,app:bs,registerVersion:Ss,setLogLevel:c.setLogLevel,onLog:Us,apps:null,SDK_VERSION:Yo,INTERNAL:{registerComponent:xs,removeApp:Rs,components:ys,useAsService:Ps}};ms.default=ms,Object.defineProperty(ms,"apps",{get:ks});function Rs(Qs){delete hs[Qs]}function bs(Qs){if(Qs=Qs||es,!o.contains(hs,Qs))throw p.create("no-app",{appName:Qs});return hs[Qs]}bs.App=ds;function ps(Qs,Js){if(Js===void 0&&(Js={}),typeof Js!="object"||Js===null){var qs=Js;Js={name:qs}}var Gs=Js;Gs.name===void 0&&(Gs.name=es);var Zs=Gs.name;if(typeof Zs!="string"||!Zs)throw p.create("bad-app-name",{appName:String(Zs)});if(o.contains(hs,Zs))throw p.create("duplicate-app",{appName:Zs});var Es=new ds(Qs,Gs,ms);return hs[Zs]=Es,Es}function ks(){return Object.keys(hs).map(function(Qs){return hs[Qs]})}function xs(Qs){var Js,qs,Gs=Qs.name;if(ys.has(Gs))return Jo.debug("There were multiple attempts to register component "+Gs+"."),Qs.type==="PUBLIC"?ms[Gs]:null;if(ys.set(Gs,Qs),Qs.type==="PUBLIC"){var Zs=function(Bs){if(Bs===void 0&&(Bs=bs()),typeof Bs[Gs]!="function")throw p.create("invalid-app-argument",{appName:Gs});return Bs[Gs]()};Qs.serviceProps!==void 0&&o.deepExtend(Zs,Qs.serviceProps),ms[Gs]=Zs,ds.prototype[Gs]=function(){for(var Bs=[],Ls=0;Ls<arguments.length;Ls++)Bs[Ls]=arguments[Ls];var Fs=this._getService.bind(this,Gs);return Fs.apply(this,Qs.multipleInstances?Bs:[])}}try{for(var Es=l.__values(Object.keys(hs)),fs=Es.next();!fs.done;fs=Es.next()){var vs=fs.value;hs[vs]._addComponent(Qs)}}catch(Bs){Js={error:Bs}}finally{try{fs&&!fs.done&&(qs=Es.return)&&qs.call(Es)}finally{if(Js)throw Js.error}}return Qs.type==="PUBLIC"?ms[Gs]:null}function Ss(Qs,Js,qs){var Gs,Zs=(Gs=is[Qs])!==null&&Gs!==void 0?Gs:Qs;qs&&(Zs+="-"+qs);var Es=Zs.match(/\s|\//),fs=Js.match(/\s|\//);if(Es||fs){var vs=['Unable to register library "'+Zs+'" with version "'+Js+'":'];Es&&vs.push('library name "'+Zs+'" contains illegal characters (whitespace or "/")'),Es&&fs&&vs.push("and"),fs&&vs.push('version name "'+Js+'" contains illegal characters (whitespace or "/")'),Jo.warn(vs.join(" "));return}xs(new s.Component(Zs+"-version",function(){return{library:Zs,version:Js}},"VERSION"))}function Us(Qs,Js){if(Qs!==null&&typeof Qs!="function")throw p.create("invalid-log-argument",{appName:name});c.setUserLogHandler(Qs,Js)}function Ps(Qs,Js){if(Js==="serverAuth")return null;var qs=Js;return qs}return ms}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(){var ds=ts(Ko);ds.INTERNAL=l.__assign(l.__assign({},ds.INTERNAL),{createFirebaseNamespace:ss,extendNamespace:hs,createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend});function hs(ys){o.deepExtend(ds,ys)}return ds}var cs=ss();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var as=function(){function ds(hs){this.container=hs}return ds.prototype.getPlatformInfoString=function(){var hs=this.container.getProviders();return hs.map(function(ys){if(us(ys)){var ms=ys.getImmediate();return ms.library+"/"+ms.version}else return null}).filter(function(ys){return ys}).join(" ")},ds}();function us(ds){var hs=ds.getComponent();return(hs==null?void 0:hs.type)==="VERSION"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(ds,hs){ds.INTERNAL.registerComponent(new s.Component("platform-logger",function(ys){return new as(ys)},"PRIVATE")),ds.registerVersion(Co,Bo,hs),ds.registerVersion("fire-js","")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(o.isBrowser()&&self.firebase!==void 0){Jo.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);var Is=self.firebase.SDK_VERSION;Is&&Is.indexOf("LITE")>=0&&Jo.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var _s=cs.initializeApp;cs.initializeApp=function(){for(var ds=[],hs=0;hs<arguments.length;hs++)ds[hs]=arguments[hs];return o.isNode()&&Jo.warn(`
      Warning: This is a browser-targeted Firebase bundle but it appears it is being
      run in a Node environment.  If running in a Node environment, make sure you
      are using the bundle specified by the "main" field in package.json.
      
      If you are using Webpack, you can specify "main" as the first item in
      "resolve.mainFields":
      https://webpack.js.org/configuration/resolve/#resolvemainfields
      
      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"
      as the first item in "mainFields", e.g. ['main', 'module'].
      https://github.com/rollup/rollup-plugin-node-resolve
      `),_s.apply(void 0,ds)};var Hs=cs;return gs(Hs),index_cjs$2.default=Hs,index_cjs$2.firebase=Hs,index_cjs$2}var index_cjsExports$2=requireIndex_cjs(),name$2="firebase",version$2="7.14.6";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */index_cjsExports$2.registerVersion(name$2,version$2,"app");var index_cjsExports$1=requireIndex_cjs$2(),index_cjsExports=requireIndex_cjs$1();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function __values(l){var o=typeof Symbol=="function"&&Symbol.iterator,s=o&&l[o],c=0;if(s)return s.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&c>=l.length&&(l=void 0),{value:l&&l[c++],done:!l}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},g,goog=goog||{},k$1=commonjsGlobal||self;function aa(){}function ba(l){var o=typeof l;if(o=="object")if(l){if(l instanceof Array)return"array";if(l instanceof Object)return o;var s=Object.prototype.toString.call(l);if(s=="[object Window]")return"object";if(s=="[object Array]"||typeof l.length=="number"&&typeof l.splice<"u"&&typeof l.propertyIsEnumerable<"u"&&!l.propertyIsEnumerable("splice"))return"array";if(s=="[object Function]"||typeof l.call<"u"&&typeof l.propertyIsEnumerable<"u"&&!l.propertyIsEnumerable("call"))return"function"}else return"null";else if(o=="function"&&typeof l.call>"u")return"object";return o}function da(l){var o=ba(l);return o=="array"||o=="object"&&typeof l.length=="number"}function m(l){var o=typeof l;return o=="object"&&l!=null||o=="function"}function ea(l){return Object.prototype.hasOwnProperty.call(l,fa)&&l[fa]||(l[fa]=++ha)}var fa="closure_uid_"+(1e9*Math.random()>>>0),ha=0;function ia(l,o,s){return l.call.apply(l.bind,arguments)}function ja(l,o,s){if(!l)throw Error();if(2<arguments.length){var c=Array.prototype.slice.call(arguments,2);return function(){var h=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(h,c),l.apply(o,h)}}return function(){return l.apply(o,arguments)}}function n$1(l,o,s){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?n$1=ia:n$1=ja,n$1.apply(null,arguments)}function ka(l,o){var s=Array.prototype.slice.call(arguments,1);return function(){var c=s.slice();return c.push.apply(c,arguments),l.apply(this,c)}}var q$1=Date.now||function(){return+new Date};function r(l,o){function s(){}s.prototype=o.prototype,l.M=o.prototype,l.prototype=new s,l.prototype.constructor=l}function t$1(){this.j=this.j,this.i=this.i}var la=0;t$1.prototype.j=!1;t$1.prototype.da=function(){!this.j&&(this.j=!0,this.C(),la!=0)&&ea(this)};t$1.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var na=Array.prototype.indexOf?function(l,o){return Array.prototype.indexOf.call(l,o,void 0)}:function(l,o){if(typeof l=="string")return typeof o!="string"||o.length!=1?-1:l.indexOf(o,0);for(var s=0;s<l.length;s++)if(s in l&&l[s]===o)return s;return-1},oa=Array.prototype.forEach?function(l,o,s){Array.prototype.forEach.call(l,o,s)}:function(l,o,s){for(var c=l.length,h=typeof l=="string"?l.split(""):l,d=0;d<c;d++)d in h&&o.call(s,h[d],d,l)};function pa(l){e:{for(var o=qa,s=l.length,c=typeof l=="string"?l.split(""):l,h=0;h<s;h++)if(h in c&&o.call(void 0,c[h],h,l)){o=h;break e}o=-1}return 0>o?null:typeof l=="string"?l.charAt(o):l[o]}function ra(l){return Array.prototype.concat.apply([],arguments)}function sa(l){var o=l.length;if(0<o){for(var s=Array(o),c=0;c<o;c++)s[c]=l[c];return s}return[]}function wa(l){return/^[\s\xa0]*$/.test(l)}var xa=String.prototype.trim?function(l){return l.trim()}:function(l){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(l)[1]};function u$1(l,o){return l.indexOf(o)!=-1}function ya(l,o){return l<o?-1:l>o?1:0}var v;e:{var za=k$1.navigator;if(za){var Aa=za.userAgent;if(Aa){v=Aa;break e}}v=""}function Ba(l,o,s){for(var c in l)o.call(s,l[c],c,l)}function Ca(l){var o={};for(var s in l)o[s]=l[s];return o}var Da="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ea(l,o){for(var s,c,h=1;h<arguments.length;h++){c=arguments[h];for(s in c)l[s]=c[s];for(var d=0;d<Da.length;d++)s=Da[d],Object.prototype.hasOwnProperty.call(c,s)&&(l[s]=c[s])}}function Fa(l){return Fa[" "](l),l}Fa[" "]=aa;function Ga(l,o){var s=Ha;return Object.prototype.hasOwnProperty.call(s,l)?s[l]:s[l]=o(l)}var Ia=u$1(v,"Opera"),w=u$1(v,"Trident")||u$1(v,"MSIE"),Ja=u$1(v,"Edge"),Ka=Ja||w,La=u$1(v,"Gecko")&&!(u$1(v.toLowerCase(),"webkit")&&!u$1(v,"Edge"))&&!(u$1(v,"Trident")||u$1(v,"MSIE"))&&!u$1(v,"Edge"),Ma=u$1(v.toLowerCase(),"webkit")&&!u$1(v,"Edge");function Na(){var l=k$1.document;return l?l.documentMode:void 0}var Oa;e:{var Pa="",Qa=function(){var l=v;if(La)return/rv:([^\);]+)(\)|;)/.exec(l);if(Ja)return/Edge\/([\d\.]+)/.exec(l);if(w)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(l);if(Ma)return/WebKit\/(\S+)/.exec(l);if(Ia)return/(?:Version)[ \/]?(\S+)/.exec(l)}();if(Qa&&(Pa=Qa?Qa[1]:""),w){var Ra=Na();if(Ra!=null&&Ra>parseFloat(Pa)){Oa=String(Ra);break e}}Oa=Pa}var Ha={};function Sa(l){return Ga(l,function(){for(var o=0,s=xa(String(Oa)).split("."),c=xa(String(l)).split("."),h=Math.max(s.length,c.length),d=0;o==0&&d<h;d++){var p=s[d]||"",Co=c[d]||"";do{if(p=/(\d*)(\D*)(.*)/.exec(p)||["","","",""],Co=/(\d*)(\D*)(.*)/.exec(Co)||["","","",""],p[0].length==0&&Co[0].length==0)break;o=ya(p[1].length==0?0:parseInt(p[1],10),Co[1].length==0?0:parseInt(Co[1],10))||ya(p[2].length==0,Co[2].length==0)||ya(p[2],Co[2]),p=p[3],Co=Co[3]}while(o==0)}return 0<=o})}var Ta;if(k$1.document&&w){var Ua=Na();Ta=Ua||parseInt(Oa,10)||void 0}else Ta=void 0;var Va=Ta,Wa=!w||9<=Number(Va),Xa=w&&!Sa("9"),Ya=function(){if(!k$1.addEventListener||!Object.defineProperty)return!1;var l=!1,o=Object.defineProperty({},"passive",{get:function(){l=!0}});try{k$1.addEventListener("test",aa,o),k$1.removeEventListener("test",aa,o)}catch{}return l}();function x$1(l,o){this.type=l,this.a=this.target=o,this.defaultPrevented=!1}x$1.prototype.b=function(){this.defaultPrevented=!0};function y(l,o){if(x$1.call(this,l?l.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,l){var s=this.type=l.type,c=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.a=o,o=l.relatedTarget){if(La){e:{try{Fa(o.nodeName);var h=!0;break e}catch{}h=!1}h||(o=null)}}else s=="mouseover"?o=l.fromElement:s=="mouseout"&&(o=l.toElement);this.relatedTarget=o,c?(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Za[l.pointerType]||"",this.c=l,l.defaultPrevented&&this.b()}}r(y,x$1);var Za={2:"touch",3:"pen",4:"mouse"};y.prototype.b=function(){y.M.b.call(this);var l=this.c;if(l.preventDefault)l.preventDefault();else if(l.returnValue=!1,Xa)try{(l.ctrlKey||112<=l.keyCode&&123>=l.keyCode)&&(l.keyCode=-1)}catch{}};var A$2="closure_listenable_"+(1e6*Math.random()|0),$a=0;function ab(l,o,s,c,h){this.listener=l,this.proxy=null,this.src=o,this.type=s,this.capture=!!c,this.aa=h,this.key=++$a,this.V=this.X=!1}function bb(l){l.V=!0,l.listener=null,l.proxy=null,l.src=null,l.aa=null}function cb(l){this.src=l,this.a={},this.b=0}cb.prototype.add=function(l,o,s,c,h){var d=l.toString();l=this.a[d],l||(l=this.a[d]=[],this.b++);var p=db(l,o,c,h);return-1<p?(o=l[p],s||(o.X=!1)):(o=new ab(o,this.src,d,!!c,h),o.X=s,l.push(o)),o};function eb(l,o){var s=o.type;if(s in l.a){var c=l.a[s],h=na(c,o),d;(d=0<=h)&&Array.prototype.splice.call(c,h,1),d&&(bb(o),l.a[s].length==0&&(delete l.a[s],l.b--))}}function db(l,o,s,c){for(var h=0;h<l.length;++h){var d=l[h];if(!d.V&&d.listener==o&&d.capture==!!s&&d.aa==c)return h}return-1}var fb="closure_lm_"+(1e6*Math.random()|0),gb={};function ib(l,o,s,c,h){if(c&&c.once)return jb(l,o,s,c,h);if(Array.isArray(o)){for(var d=0;d<o.length;d++)ib(l,o[d],s,c,h);return null}return s=kb(s),l&&l[A$2]?l.ra(o,s,m(c)?!!c.capture:!!c,h):lb(l,o,s,!1,c,h)}function lb(l,o,s,c,h,d){if(!o)throw Error("Invalid event type");var p=m(h)?!!h.capture:!!h;if(p&&!Wa)return null;var Co=mb(l);if(Co||(l[fb]=Co=new cb(l)),s=Co.add(o,s,c,p,d),s.proxy)return s;if(c=nb(),s.proxy=c,c.src=l,c.listener=s,l.addEventListener)Ya||(h=p),h===void 0&&(h=!1),l.addEventListener(o.toString(),c,h);else if(l.attachEvent)l.attachEvent(ob(o.toString()),c);else if(l.addListener&&l.removeListener)l.addListener(c);else throw Error("addEventListener and attachEvent are unavailable.");return s}function nb(){var l=pb,o=Wa?function(s){return l.call(o.src,o.listener,s)}:function(s){if(s=l.call(o.src,o.listener,s),!s)return s};return o}function jb(l,o,s,c,h){if(Array.isArray(o)){for(var d=0;d<o.length;d++)jb(l,o[d],s,c,h);return null}return s=kb(s),l&&l[A$2]?l.sa(o,s,m(c)?!!c.capture:!!c,h):lb(l,o,s,!0,c,h)}function qb(l,o,s,c,h){if(Array.isArray(o))for(var d=0;d<o.length;d++)qb(l,o[d],s,c,h);else c=m(c)?!!c.capture:!!c,s=kb(s),l&&l[A$2]?(l=l.c,o=String(o).toString(),o in l.a&&(d=l.a[o],s=db(d,s,c,h),-1<s&&(bb(d[s]),Array.prototype.splice.call(d,s,1),d.length==0&&(delete l.a[o],l.b--)))):l&&(l=mb(l))&&(o=l.a[o.toString()],l=-1,o&&(l=db(o,s,c,h)),(s=-1<l?o[l]:null)&&rb(s))}function rb(l){if(typeof l!="number"&&l&&!l.V){var o=l.src;if(o&&o[A$2])eb(o.c,l);else{var s=l.type,c=l.proxy;o.removeEventListener?o.removeEventListener(s,c,l.capture):o.detachEvent?o.detachEvent(ob(s),c):o.addListener&&o.removeListener&&o.removeListener(c),(s=mb(o))?(eb(s,l),s.b==0&&(s.src=null,o[fb]=null)):bb(l)}}}function ob(l){return l in gb?gb[l]:gb[l]="on"+l}function sb(l,o){var s=l.listener,c=l.aa||l.src;return l.X&&rb(l),s.call(c,o)}function pb(l,o){if(l.V)return!0;if(!Wa){if(!o)e:{o=["window","event"];for(var s=k$1,c=0;c<o.length;c++)if(s=s[o[c]],s==null){o=null;break e}o=s}return o=new y(o,this),sb(l,o)}return sb(l,new y(o,this))}function mb(l){return l=l[fb],l instanceof cb?l:null}var tb="__closure_events_fn_"+(1e9*Math.random()>>>0);function kb(l){return ba(l)=="function"?l:(l[tb]||(l[tb]=function(o){return l.handleEvent(o)}),l[tb])}function B$1(){t$1.call(this),this.c=new cb(this),this.J=this,this.A=null}r(B$1,t$1);B$1.prototype[A$2]=!0;g=B$1.prototype;g.addEventListener=function(l,o,s,c){ib(this,l,o,s,c)};g.removeEventListener=function(l,o,s,c){qb(this,l,o,s,c)};g.dispatchEvent=function(l){var o,s=this.A;if(s)for(o=[];s;s=s.A)o.push(s);s=this.J;var c=l.type||l;if(typeof l=="string")l=new x$1(l,s);else if(l instanceof x$1)l.target=l.target||s;else{var h=l;l=new x$1(c,s),Ea(l,h)}if(h=!0,o)for(var d=o.length-1;0<=d;d--){var p=l.a=o[d];h=ub(p,c,!0,l)&&h}if(p=l.a=s,h=ub(p,c,!0,l)&&h,h=ub(p,c,!1,l)&&h,o)for(d=0;d<o.length;d++)p=l.a=o[d],h=ub(p,c,!1,l)&&h;return h};g.C=function(){if(B$1.M.C.call(this),this.c){var l=this.c,o;for(o in l.a){for(var s=l.a[o],c=0;c<s.length;c++)bb(s[c]);delete l.a[o],l.b--}}this.A=null};g.ra=function(l,o,s,c){return this.c.add(String(l),o,!1,s,c)};g.sa=function(l,o,s,c){return this.c.add(String(l),o,!0,s,c)};function ub(l,o,s,c){if(o=l.c.a[String(o)],!o)return!0;o=o.concat();for(var h=!0,d=0;d<o.length;++d){var p=o[d];if(p&&!p.V&&p.capture==s){var Co=p.listener,Bo=p.aa||p.src;p.X&&eb(l.c,p),h=Co.call(Bo,c)!==!1&&h}}return h&&!c.defaultPrevented}var vb=k$1.JSON.stringify;function wb(){this.b=this.a=null}var yb=new(function(){function l(o,s,c){this.f=c,this.c=o,this.g=s,this.b=0,this.a=null}return l.prototype.get=function(){var o;return 0<this.b?(this.b--,o=this.a,this.a=o.next,o.next=null):o=this.c(),o},l}())(function(){return new xb},function(l){l.reset()},100);wb.prototype.add=function(l,o){var s=yb.get();s.set(l,o),this.b?this.b.next=s:this.a=s,this.b=s};function zb(){var l=Ab,o=null;return l.a&&(o=l.a,l.a=l.a.next,l.a||(l.b=null),o.next=null),o}function xb(){this.next=this.b=this.a=null}xb.prototype.set=function(l,o){this.a=l,this.b=o,this.next=null};xb.prototype.reset=function(){this.next=this.b=this.a=null};function Bb(l){k$1.setTimeout(function(){throw l},0)}function Cb(l,o){Db||Eb(),Fb||(Db(),Fb=!0),Ab.add(l,o)}var Db;function Eb(){var l=k$1.Promise.resolve(void 0);Db=function(){l.then(Gb)}}var Fb=!1,Ab=new wb;function Gb(){for(var l;l=zb();){try{l.a.call(l.b)}catch(s){Bb(s)}var o=yb;o.g(l),o.b<o.f&&(o.b++,l.next=o.a,o.a=l)}Fb=!1}function Hb(l,o){B$1.call(this),this.b=l||1,this.a=o||k$1,this.f=n$1(this.Ua,this),this.g=q$1()}r(Hb,B$1);g=Hb.prototype;g.Z=!1;g.L=null;g.Ua=function(){if(this.Z){var l=q$1()-this.g;0<l&&l<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-l):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(Ib(this),this.start()))}};g.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=q$1())};function Ib(l){l.Z=!1,l.L&&(l.a.clearTimeout(l.L),l.L=null)}g.C=function(){Hb.M.C.call(this),Ib(this),delete this.a};function Jb(l,o,s){if(ba(l)=="function")s&&(l=n$1(l,s));else if(l&&typeof l.handleEvent=="function")l=n$1(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(o)?-1:k$1.setTimeout(l,o||0)}function Kb(l,o,s){t$1.call(this),this.f=s!=null?n$1(l,s):l,this.c=o,this.b=n$1(this.Pa,this),this.a=[]}r(Kb,t$1);g=Kb.prototype;g.ba=!1;g.T=null;g.Ia=function(l){this.a=arguments,this.T?this.ba=!0:Lb(this)};g.C=function(){Kb.M.C.call(this),this.T&&(k$1.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])};g.Pa=function(){this.T=null,this.ba&&(this.ba=!1,Lb(this))};function Lb(l){l.T=Jb(l.b,l.c),l.f.apply(null,l.a)}function C$1(l){t$1.call(this),this.b=l,this.a={}}r(C$1,t$1);var Mb=[];function Nb(l,o,s,c){Array.isArray(s)||(s&&(Mb[0]=s.toString()),s=Mb);for(var h=0;h<s.length;h++){var d=ib(o,s[h],c||l.handleEvent,!1,l.b||l);if(!d)break;l.a[d.key]=d}}function Ob(l){Ba(l.a,function(o,s){this.a.hasOwnProperty(s)&&rb(o)},l),l.a={}}C$1.prototype.C=function(){C$1.M.C.call(this),Ob(this)};C$1.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Pb(){}var Qb=null;function Rb(){return Qb=Qb||new B$1}function Sb(l){x$1.call(this,"serverreachability",l)}r(Sb,x$1);function E$2(l){var o=Rb();o.dispatchEvent(new Sb(o))}function Tb(l){x$1.call(this,"statevent",l)}r(Tb,x$1);function F$2(l){var o=Rb();o.dispatchEvent(new Tb(o))}function Ub(l){x$1.call(this,"timingevent",l)}r(Ub,x$1);function Vb(l,o){if(ba(l)!="function")throw Error("Fn must not be null and must be a function");return k$1.setTimeout(function(){l()},o)}var Wb={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Xb={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Yb(){}Yb.prototype.a=null;function Zb(l){var o;return(o=l.a)||(o=l.a={}),o}function $b(){}var G$1={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function ac(){x$1.call(this,"d")}r(ac,x$1);function bc(){x$1.call(this,"c")}r(bc,x$1);var cc;function dc(){}r(dc,Yb);cc=new dc;function H$1(l,o,s){this.g=l,this.W=o,this.U=s||1,this.G=new C$1(this),this.N=ec,l=Ka?125:void 0,this.O=new Hb(l),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}var ec=45e3,fc={},gc={};g=H$1.prototype;g.setTimeout=function(l){this.N=l};function hc(l,o,s){l.B=1,l.f=ic(I$1(o)),l.j=s,l.F=!0,jc(l,null)}function jc(l,o){l.s=q$1(),J$1(l),l.A=I$1(l.f);var s=l.A,c=l.U;Array.isArray(c)||(c=[String(c)]),kc(s.b,"t",c),l.w=0,l.a=lc(l.g,l.g.w?o:null),0<l.J&&(l.D=new Kb(n$1(l.ya,l,l.a),l.J)),Nb(l.G,l.a,"readystatechange",l.Sa),o=l.m?Ca(l.m):{},l.j?(l.v||(l.v="POST"),o["Content-Type"]="application/x-www-form-urlencoded",l.a.$(l.A,l.v,l.j,o)):(l.v="GET",l.a.$(l.A,l.v,null,o)),E$2()}g.Sa=function(l){l=l.target;var o=this.D;o&&K$1(l)==3?o.Ia():this.ya(l)};g.ya=function(l){try{if(l==this.a)e:{var o=K$1(this.a),s=this.a.qa(),c=this.a.S();if(!(3>o||o==3&&!Ka&&!this.a.Y())){this.l||o!=4||s==7||(s==8||0>=c?E$2(3):E$2(2)),mc(this);var h=this.a.S();this.H=h;var d=this.a.Y();if(this.b=h==200){if(this.R&&!this.o){t:{if(this.a){var p,Co=this.a;if((p=Co.a?Co.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!wa(p)){var Bo=p;break t}}Bo=null}if(Bo)this.o=!0,nc(this,Bo);else{this.b=!1,this.c=3,F$2(12),L$2(this),pc(this);break e}}this.F?(qc(this,o,d),Ka&&this.b&&o==3&&(Nb(this.G,this.O,"tick",this.Ra),this.O.start())):nc(this,d),o==4&&L$2(this),this.b&&!this.l&&(o==4?rc(this.g,this):(this.b=!1,J$1(this)))}else h==400&&0<d.indexOf("Unknown SID")?(this.c=3,F$2(12)):(this.c=0,F$2(13)),L$2(this),pc(this)}}}catch{}finally{}};function qc(l,o,s){for(var c=!0;!l.l&&l.w<s.length;){var h=tc(l,s);if(h==gc){o==4&&(l.c=4,F$2(),c=!1);break}else if(h==fc){l.c=4,F$2(),c=!1;break}else nc(l,h)}o==4&&s.length==0&&(l.c=1,F$2(),c=!1),l.b=l.b&&c,c||(L$2(l),pc(l))}g.Ra=function(){if(this.a){var l=K$1(this.a),o=this.a.Y();this.w<o.length&&(mc(this),qc(this,l,o),this.b&&l!=4&&J$1(this))}};function tc(l,o){var s=l.w,c=o.indexOf(`
`,s);return c==-1?gc:(s=Number(o.substring(s,c)),isNaN(s)?fc:(c+=1,c+s>o.length?gc:(o=o.substr(c,s),l.w=c+s,o)))}g.cancel=function(){this.l=!0,L$2(this)};function J$1(l){l.P=q$1()+l.N,uc(l,l.N)}function uc(l,o){if(l.h!=null)throw Error("WatchDog timer not null");l.h=Vb(n$1(l.Qa,l),o)}function mc(l){l.h&&(k$1.clearTimeout(l.h),l.h=null)}g.Qa=function(){this.h=null;var l=q$1();0<=l-this.P?(this.B!=2&&(E$2(),F$2()),L$2(this),this.c=2,pc(this)):uc(this,this.P-l)};function pc(l){l.g.u==0||l.l||rc(l.g,l)}function L$2(l){mc(l);var o=l.D;o&&typeof o.da=="function"&&o.da(),l.D=null,Ib(l.O),Ob(l.G),l.a&&(o=l.a,l.a=null,o.abort(),o.da())}function nc(l,o){try{var s=l.g;if(s.u!=0&&(s.a==l||vc(s.b,l))){if(s.A=l.H,!l.o&&vc(s.b,l)&&s.u==3){try{var c=s.ja.a.parse(o)}catch{c=null}if(Array.isArray(c)&&c.length==3){var h=c;if(h[0]==0){e:if(!s.i){if(s.a)if(s.a.s+3e3<l.s)wc(s),s.a.cancel(),s.a=null;else break e;xc(s),F$2(18)}}else s.ia=h[1],0<s.ia-s.G&&37500>h[2]&&s.U&&s.m==0&&!s.l&&(s.l=Vb(n$1(s.Na,s),6e3));if(1>=yc(s.b)&&s.O){try{s.O()}catch{}s.O=void 0}}else M$1(s,11)}else if((l.o||s.a==l)&&wc(s),!wa(o))for(o=c=s.ja.a.parse(o),c=0;c<o.length;c++)if(h=o[c],s.G=h[0],h=h[1],s.u==2)if(h[0]=="c"){s.B=h[1],s.R=h[2];var d=h[3];d!=null&&(s.oa=d);var p=h[5];p!=null&&typeof p=="number"&&0<p&&(s.D=1.5*p);var Co=s,Bo=l.a;if(Bo){var Lo=Bo.a?Bo.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(Lo){var Uo=Co.b;!Uo.a&&(u$1(Lo,"spdy")||u$1(Lo,"quic")||u$1(Lo,"h2"))&&(Uo.f=Uo.g,Uo.a=new Set,Uo.b&&(zc(Uo,Uo.b),Uo.b=null))}if(Co.s){var Qo=Bo.a?Bo.a.getResponseHeader("X-HTTP-Session-Id"):null;Qo&&(Co.ha=Qo,N$1(Co.v,Co.s,Qo))}}s.u=3,s.c&&s.c.na(),Co=s;var Po=l;if(Co.ea=Ac(Co,Co.w?Co.R:null,Co.P),Po.o){Bc(Co.b,Po);var Mo=Po,Go=Co.D;Go&&Mo.setTimeout(Go),Mo.h&&(mc(Mo),J$1(Mo)),Co.a=Po}else Cc(Co);0<s.f.length&&Dc(s)}else h[0]!="stop"&&h[0]!="close"||M$1(s,7);else s.u==3&&(h[0]=="stop"||h[0]=="close"?h[0]=="stop"?M$1(s,7):Ec(s):h[0]!="noop"&&s.c&&s.c.ma(h),s.m=0)}E$2(4)}catch{}}function Fc(l){if(l.I&&typeof l.I=="function")return l.I();if(typeof l=="string")return l.split("");if(da(l)){for(var o=[],s=l.length,c=0;c<s;c++)o.push(l[c]);return o}o=[],s=0;for(c in l)o[s++]=l[c];return l=o}function Gc(l,o){if(l.forEach&&typeof l.forEach=="function")l.forEach(o,void 0);else if(da(l)||typeof l=="string")oa(l,o,void 0);else{if(l.K&&typeof l.K=="function")var s=l.K();else if(l.I&&typeof l.I=="function")s=void 0;else if(da(l)||typeof l=="string"){s=[];for(var c=l.length,h=0;h<c;h++)s.push(h)}else for(h in s=[],c=0,l)s[c++]=h;c=Fc(l),h=c.length;for(var d=0;d<h;d++)o.call(void 0,c[d],s&&s[d],l)}}function O$1(l,o){this.b={},this.a=[],this.c=0;var s=arguments.length;if(1<s){if(s%2)throw Error("Uneven number of arguments");for(var c=0;c<s;c+=2)this.set(arguments[c],arguments[c+1])}else if(l)if(l instanceof O$1)for(s=l.K(),c=0;c<s.length;c++)this.set(s[c],l.get(s[c]));else for(c in l)this.set(c,l[c])}g=O$1.prototype;g.I=function(){Hc(this);for(var l=[],o=0;o<this.a.length;o++)l.push(this.b[this.a[o]]);return l};g.K=function(){return Hc(this),this.a.concat()};function Hc(l){if(l.c!=l.a.length){for(var o=0,s=0;o<l.a.length;){var c=l.a[o];P$1(l.b,c)&&(l.a[s++]=c),o++}l.a.length=s}if(l.c!=l.a.length){var h={};for(s=o=0;o<l.a.length;)c=l.a[o],P$1(h,c)||(l.a[s++]=c,h[c]=1),o++;l.a.length=s}}g.get=function(l,o){return P$1(this.b,l)?this.b[l]:o};g.set=function(l,o){P$1(this.b,l)||(this.c++,this.a.push(l)),this.b[l]=o};g.forEach=function(l,o){for(var s=this.K(),c=0;c<s.length;c++){var h=s[c],d=this.get(h);l.call(o,d,h,this)}};function P$1(l,o){return Object.prototype.hasOwnProperty.call(l,o)}var Ic=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Jc(l,o){if(l){l=l.split("&");for(var s=0;s<l.length;s++){var c=l[s].indexOf("="),h=null;if(0<=c){var d=l[s].substring(0,c);h=l[s].substring(c+1)}else d=l[s];o(d,h?decodeURIComponent(h.replace(/\+/g," ")):"")}}}function Q$1(l,o){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,l instanceof Q$1){this.a=o!==void 0?o:l.a,Kc(this,l.f),this.j=l.j,Lc(this,l.c),Mc(this,l.h),this.g=l.g,o=l.b;var s=new R$1;s.c=o.c,o.a&&(s.a=new O$1(o.a),s.b=o.b),Nc(this,s),this.i=l.i}else l&&(s=String(l).match(Ic))?(this.a=!!o,Kc(this,s[1]||"",!0),this.j=S$1(s[2]||""),Lc(this,s[3]||"",!0),Mc(this,s[4]),this.g=S$1(s[5]||"",!0),Nc(this,s[6]||"",!0),this.i=S$1(s[7]||"")):(this.a=!!o,this.b=new R$1(null,this.a))}Q$1.prototype.toString=function(){var l=[],o=this.f;o&&l.push(T$2(o,Oc,!0),":");var s=this.c;return(s||o=="file")&&(l.push("//"),(o=this.j)&&l.push(T$2(o,Oc,!0),"@"),l.push(encodeURIComponent(String(s)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s=this.h,s!=null&&l.push(":",String(s))),(s=this.g)&&(this.c&&s.charAt(0)!="/"&&l.push("/"),l.push(T$2(s,s.charAt(0)=="/"?Pc:Qc,!0))),(s=this.b.toString())&&l.push("?",s),(s=this.i)&&l.push("#",T$2(s,Rc)),l.join("")};function I$1(l){return new Q$1(l)}function Kc(l,o,s){l.f=s?S$1(o,!0):o,l.f&&(l.f=l.f.replace(/:$/,""))}function Lc(l,o,s){l.c=s?S$1(o,!0):o}function Mc(l,o){if(o){if(o=Number(o),isNaN(o)||0>o)throw Error("Bad port number "+o);l.h=o}else l.h=null}function Nc(l,o,s){o instanceof R$1?(l.b=o,Sc(l.b,l.a)):(s||(o=T$2(o,Tc)),l.b=new R$1(o,l.a))}function N$1(l,o,s){l.b.set(o,s)}function ic(l){return N$1(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q$1()).toString(36)),l}function Uc(l){return l instanceof Q$1?I$1(l):new Q$1(l,void 0)}function Vc(l,o,s,c){var h=new Q$1(null,void 0);return l&&Kc(h,l),o&&Lc(h,o),s&&Mc(h,s),c&&(h.g=c),h}function S$1(l,o){return l?o?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function T$2(l,o,s){return typeof l=="string"?(l=encodeURI(l).replace(o,Wc),s&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Wc(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Oc=/[#\/\?@]/g,Qc=/[#\?:]/g,Pc=/[#\?]/g,Tc=/[#\?@]/g,Rc=/#/g;function R$1(l,o){this.b=this.a=null,this.c=l||null,this.f=!!o}function U$2(l){l.a||(l.a=new O$1,l.b=0,l.c&&Jc(l.c,function(o,s){l.add(decodeURIComponent(o.replace(/\+/g," ")),s)}))}g=R$1.prototype;g.add=function(l,o){U$2(this),this.c=null,l=V$2(this,l);var s=this.a.get(l);return s||this.a.set(l,s=[]),s.push(o),this.b+=1,this};function Xc(l,o){U$2(l),o=V$2(l,o),P$1(l.a.b,o)&&(l.c=null,l.b-=l.a.get(o).length,l=l.a,P$1(l.b,o)&&(delete l.b[o],l.c--,l.a.length>2*l.c&&Hc(l)))}function Yc(l,o){return U$2(l),o=V$2(l,o),P$1(l.a.b,o)}g.forEach=function(l,o){U$2(this),this.a.forEach(function(s,c){oa(s,function(h){l.call(o,h,c,this)},this)},this)};g.K=function(){U$2(this);for(var l=this.a.I(),o=this.a.K(),s=[],c=0;c<o.length;c++)for(var h=l[c],d=0;d<h.length;d++)s.push(o[c]);return s};g.I=function(l){U$2(this);var o=[];if(typeof l=="string")Yc(this,l)&&(o=ra(o,this.a.get(V$2(this,l))));else{l=this.a.I();for(var s=0;s<l.length;s++)o=ra(o,l[s])}return o};g.set=function(l,o){return U$2(this),this.c=null,l=V$2(this,l),Yc(this,l)&&(this.b-=this.a.get(l).length),this.a.set(l,[o]),this.b+=1,this};g.get=function(l,o){return l?(l=this.I(l),0<l.length?String(l[0]):o):o};function kc(l,o,s){Xc(l,o),0<s.length&&(l.c=null,l.a.set(V$2(l,o),sa(s)),l.b+=s.length)}g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var l=[],o=this.a.K(),s=0;s<o.length;s++){var c=o[s],h=encodeURIComponent(String(c));c=this.I(c);for(var d=0;d<c.length;d++){var p=h;c[d]!==""&&(p+="="+encodeURIComponent(String(c[d]))),l.push(p)}}return this.c=l.join("&")};function V$2(l,o){return o=String(o),l.f&&(o=o.toLowerCase()),o}function Sc(l,o){o&&!l.f&&(U$2(l),l.c=null,l.a.forEach(function(s,c){var h=c.toLowerCase();c!=h&&(Xc(this,c),kc(this,h,s))},l)),l.f=o}function Zc(l,o){this.b=l,this.a=o}function $c(l){this.g=l||ad,k$1.PerformanceNavigationTiming?(l=k$1.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(k$1.ca&&k$1.ca.ua&&k$1.ca.ua()&&k$1.ca.ua().mb),this.f=l?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var ad=10;function bd(l){return l.b?!0:l.a?l.a.size>=l.f:!1}function yc(l){return l.b?1:l.a?l.a.size:0}function vc(l,o){return l.b?l.b==o:l.a?l.a.has(o):!1}function zc(l,o){l.a?l.a.add(o):l.b=o}function Bc(l,o){l.b&&l.b==o?l.b=null:l.a&&l.a.has(o)&&l.a.delete(o)}$c.prototype.cancel=function(){var l,o;if(this.c=cd(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&this.a.size!==0){try{for(var s=__values(this.a.values()),c=s.next();!c.done;c=s.next()){var h=c.value;h.cancel()}}catch(d){l={error:d}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(l)throw l.error}}this.a.clear()}};function cd(l){var o,s;if(l.b!=null)return l.c.concat(l.b.i);if(l.a!=null&&l.a.size!==0){var c=l.c;try{for(var h=__values(l.a.values()),d=h.next();!d.done;d=h.next()){var p=d.value;c=c.concat(p.i)}}catch(Co){o={error:Co}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}return c}return sa(l.c)}function dd(){}dd.prototype.stringify=function(l){return k$1.JSON.stringify(l,void 0)};dd.prototype.parse=function(l){return k$1.JSON.parse(l,void 0)};function ed(){this.a=new dd}function fd(l,o,s){var c=s||"";try{Gc(l,function(h,d){var p=h;m(h)&&(p=vb(h)),o.push(c+d+"="+encodeURIComponent(p))})}catch(h){throw o.push(c+"type="+encodeURIComponent("_badmap")),h}}function gd(l,o){var s=new Pb;if(k$1.Image){var c=new Image;c.onload=ka(hd,s,c,"TestLoadImage: loaded",!0,o),c.onerror=ka(hd,s,c,"TestLoadImage: error",!1,o),c.onabort=ka(hd,s,c,"TestLoadImage: abort",!1,o),c.ontimeout=ka(hd,s,c,"TestLoadImage: timeout",!1,o),k$1.setTimeout(function(){c.ontimeout&&c.ontimeout()},1e4),c.src=l}else o(!1)}function hd(l,o,s,c,h){try{o.onload=null,o.onerror=null,o.onabort=null,o.ontimeout=null,h(c)}catch{}}var id=k$1.JSON.parse;function W$1(l){B$1.call(this),this.headers=new O$1,this.G=l||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=jd,this.B=this.F=!1}r(W$1,B$1);var jd="",kd=/^https?$/i,ld=["POST","PUT"];g=W$1.prototype;g.$=function(l,o,s,c){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);o=o?o.toUpperCase():"GET",this.D=l,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Zb(this.G):Zb(cc),this.a.onreadystatechange=n$1(this.va,this);try{this.w=!0,this.a.open(o,String(l),!0),this.w=!1}catch(d){md(this,d);return}l=s||"";var h=new O$1(this.headers);c&&Gc(c,function(d,p){h.set(p,d)}),c=pa(h.K()),s=k$1.FormData&&l instanceof k$1.FormData,!(0<=na(ld,o))||c||s||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),h.forEach(function(d,p){this.a.setRequestHeader(p,d)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{nd(this),0<this.o&&((this.B=od(this.a))?(this.a.timeout=this.o,this.a.ontimeout=n$1(this.ta,this)):this.m=Jb(this.ta,this.o,this)),this.l=!0,this.a.send(l),this.l=!1}catch(d){md(this,d)}};function od(l){return w&&Sa(9)&&typeof l.timeout=="number"&&l.ontimeout!==void 0}function qa(l){return l.toLowerCase()=="content-type"}g.ta=function(){typeof goog<"u"&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))};function md(l,o){l.b=!1,l.a&&(l.g=!0,l.a.abort(),l.g=!1),l.f=o,l.h=5,pd(l),qd(l)}function pd(l){l.v||(l.v=!0,l.dispatchEvent("complete"),l.dispatchEvent("error"))}g.abort=function(l){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=l||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),qd(this))};g.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qd(this,!0)),W$1.M.C.call(this)};g.va=function(){this.j||(this.w||this.l||this.g?rd(this):this.Oa())};g.Oa=function(){rd(this)};function rd(l){if(l.b&&typeof goog<"u"&&(!l.s[1]||K$1(l)!=4||l.S()!=2)){if(l.l&&K$1(l)==4)Jb(l.va,0,l);else if(l.dispatchEvent("readystatechange"),K$1(l)==4){l.b=!1;try{var o=l.S();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break e;default:s=!1}var c;if(!(c=s)){var h;if(h=o===0){var d=String(l.D).match(Ic)[1]||null;if(!d&&k$1.self&&k$1.self.location){var p=k$1.self.location.protocol;d=p.substr(0,p.length-1)}h=!kd.test(d?d.toLowerCase():"")}c=h}if(c)l.dispatchEvent("complete"),l.dispatchEvent("success");else{l.h=6;try{var Co=2<K$1(l)?l.a.statusText:""}catch{Co=""}l.f=Co+" ["+l.S()+"]",pd(l)}}finally{qd(l)}}}}function qd(l,o){if(l.a){nd(l);var s=l.a,c=l.s[0]?aa:null;l.a=null,l.s=null,o||l.dispatchEvent("ready");try{s.onreadystatechange=c}catch{}}}function nd(l){l.a&&l.B&&(l.a.ontimeout=null),l.m&&(k$1.clearTimeout(l.m),l.m=null)}function K$1(l){return l.a?l.a.readyState:0}g.S=function(){try{return 2<K$1(this)?this.a.status:-1}catch{return-1}};g.Y=function(){try{return this.a?this.a.responseText:""}catch{return""}};g.Ja=function(l){if(this.a){var o=this.a.responseText;return l&&o.indexOf(l)==0&&(o=o.substring(l.length)),id(o)}};g.qa=function(){return this.h};g.Ma=function(){return typeof this.f=="string"?this.f:String(this.f)};function sd(l){var o="";return Ba(l,function(s,c){o+=c,o+=":",o+=s,o+=`\r
`}),o}function td(l,o,s){e:{for(c in s){var c=!1;break e}c=!0}c||(s=sd(s),typeof l=="string"?s!=null&&encodeURIComponent(String(s)):N$1(l,o,s))}function X$1(l,o,s){return s&&s.internalChannelParams&&s.internalChannelParams[l]||o}function ud(l){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=X$1("failFast",!1,l),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=X$1("baseRetryDelayMs",5e3,l),this.Ga=X$1("retryDelaySeedMs",1e4,l),this.Da=X$1("forwardChannelMaxRetries",2,l),this.ga=X$1("forwardChannelRequestTimeoutMs",2e4,l),this.Ea=l&&l.nb||void 0,this.D=void 0,this.w=l&&l.supportsCrossDomainXhr||!1,this.B="",this.b=new $c(l&&l.concurrentRequestLimit),this.ja=new ed,this.fa=l&&l.fastHandshake||!1,l&&l.forceLongPolling&&(this.W=!1),this.O=void 0}g=ud.prototype;g.oa=8;g.u=1;function Ec(l){if(vd(l),l.u==3){var o=l.H++,s=I$1(l.v);N$1(s,"SID",l.B),N$1(s,"RID",o),N$1(s,"TYPE","terminate"),wd(l,s),o=new H$1(l,o,void 0),o.B=2,o.f=ic(I$1(s)),s=!1,k$1.navigator&&k$1.navigator.sendBeacon&&(s=k$1.navigator.sendBeacon(o.f.toString(),"")),!s&&k$1.Image&&(new Image().src=o.f,s=!0),s||(o.a=lc(o.g,null),o.a.$(o.f)),o.s=q$1(),J$1(o)}xd(l)}function vd(l){l.a&&(l.a.cancel(),l.a=null),l.i&&(k$1.clearTimeout(l.i),l.i=null),wc(l),l.b.cancel(),l.g&&(typeof l.g=="number"&&k$1.clearTimeout(l.g),l.g=null)}function yd(l,o){l.f.push(new Zc(l.Fa++,o)),l.u==3&&Dc(l)}function Dc(l){bd(l.b)||l.g||(l.g=!0,Cb(l.xa,l),l.o=0)}function zd(l,o){return yc(l.b)>=l.b.f-(l.g?1:0)?!1:l.g?(l.f=o.i.concat(l.f),!0):l.u==1||l.u==2||l.o>=(l.Ca?0:l.Da)?!1:(l.g=Vb(n$1(l.xa,l,o),Ad(l,l.o)),l.o++,!0)}g.xa=function(l){if(this.g)if(this.g=null,this.u==1){if(!l){this.H=Math.floor(1e5*Math.random()),l=this.H++;var o=new H$1(this,l,void 0),s=this.j;this.F&&(s?(s=Ca(s),Ea(s,this.F)):s=this.F),this.h===null&&(o.m=s);var c;if(this.fa)e:{for(var h=c=0;h<this.f.length;h++){t:{var d=this.f[h];if("__data__"in d.a&&(d=d.a.__data__,typeof d=="string")){d=d.length;break t}d=void 0}if(d===void 0)break;if(c+=d,4096<c){c=h;break e}if(c===4096||h===this.f.length-1){c=h+1;break e}}c=1e3}else c=1e3;c=Bd(this,o,c),h=I$1(this.v),N$1(h,"RID",l),N$1(h,"CVER",22),this.s&&N$1(h,"X-HTTP-Session-Id",this.s),wd(this,h),this.h&&s&&td(h,this.h,s),zc(this.b,o),this.fa?(N$1(h,"$req",c),N$1(h,"SID","null"),o.R=!0,hc(o,h,null)):hc(o,h,c),this.u=2}}else this.u==3&&(l?Cd(this,l):this.f.length==0||bd(this.b)||Cd(this))};function Cd(l,o){var s;o?s=o.W:s=l.H++;var c=I$1(l.v);N$1(c,"SID",l.B),N$1(c,"RID",s),N$1(c,"AID",l.G),wd(l,c),l.h&&l.j&&td(c,l.h,l.j),s=new H$1(l,s,l.o+1),l.h===null&&(s.m=l.j),o&&(l.f=o.i.concat(l.f)),o=Bd(l,s,1e3),s.setTimeout(Math.round(.5*l.ga)+Math.round(.5*l.ga*Math.random())),zc(l.b,s),hc(s,c,o)}function wd(l,o){l.c&&Gc({},function(s,c){N$1(o,c,s)})}function Bd(l,o,s){s=Math.min(l.f.length,s);var c=l.c?n$1(l.c.Ha,l.c,l):null;e:for(var h=l.f,d=-1;;){var p=["count="+s];d==-1?0<s?(d=h[0].b,p.push("ofs="+d)):d=0:p.push("ofs="+d);for(var Co=!0,Bo=0;Bo<s;Bo++){var Lo=h[Bo].b,Uo=h[Bo].a;if(Lo-=d,0>Lo)d=Math.max(0,h[Bo].b-100),Co=!1;else try{fd(Uo,p,"req"+Lo+"_")}catch{c&&c(Uo)}}if(Co){c=p.join("&");break e}}return l=l.f.splice(0,s),o.i=l,c}function Cc(l){l.a||l.i||(l.J=1,Cb(l.wa,l),l.m=0)}function xc(l){return l.a||l.i||3<=l.m?!1:(l.J++,l.i=Vb(n$1(l.wa,l),Ad(l,l.m)),l.m++,!0)}g.wa=function(){this.i=null,this.a=new H$1(this,"rpc",this.J),this.h===null&&(this.a.m=this.j),this.a.J=0;var l=I$1(this.ea);N$1(l,"RID","rpc"),N$1(l,"SID",this.B),N$1(l,"CI",this.U?"0":"1"),N$1(l,"AID",this.G),wd(this,l),N$1(l,"TYPE","xmlhttp"),this.h&&this.j&&td(l,this.h,this.j),this.D&&this.a.setTimeout(this.D);var o=this.a,s=this.R;o.B=1,o.f=ic(I$1(l)),o.j=null,o.F=!0,jc(o,s)};g.Na=function(){this.l!=null&&(this.l=null,this.a.cancel(),this.a=null,xc(this),F$2())};function wc(l){l.l!=null&&(k$1.clearTimeout(l.l),l.l=null)}function rc(l,o){var s=null;if(l.a==o){wc(l),l.a=null;var c=2}else if(vc(l.b,o))s=o.i,Bc(l.b,o),c=1;else return;if(l.A=o.H,l.u!=0){if(o.b)if(c==1){s=o.j?o.j.length:0,o=q$1()-o.s;var h=l.o;c=Rb(),c.dispatchEvent(new Ub(c)),Dc(l)}else Cc(l);else if(h=o.c,h==3||h==0&&0<l.A||!(c==1&&zd(l,o)||c==2&&xc(l)))switch(s&&0<s.length&&(o=l.b,o.c=o.c.concat(s)),h){case 1:M$1(l,5);break;case 4:M$1(l,10);break;case 3:M$1(l,6);break;default:M$1(l,2)}}}function Ad(l,o){var s=l.Ba+Math.floor(Math.random()*l.Ga);return l.c||(s*=2),s*o}function M$1(l,o){if(o==2){var s=null;l.c&&(s=null);var c=n$1(l.Ta,l);s||(s=new Q$1("//www.google.com/images/cleardot.gif"),k$1.location&&k$1.location.protocol=="http"||Kc(s,"https"),ic(s)),gd(s.toString(),c)}else F$2();l.u=0,l.c&&l.c.la(o),xd(l),vd(l)}g.Ta=function(l){F$2()};function xd(l){l.u=0,l.A=-1,l.c&&((cd(l.b).length!=0||l.f.length!=0)&&(l.b.c.length=0,sa(l.f),l.f.length=0),l.c.ka())}function Ac(l,o,s){var c=Uc(s);if(c.c!="")o&&Lc(c,o+"."+c.c),Mc(c,c.h);else{var h=k$1.location;c=Vc(h.protocol,o?o+"."+h.hostname:h.hostname,+h.port,s)}return l.N&&Ba(l.N,function(d,p){N$1(c,p,d)}),o=l.s,s=l.ha,o&&s&&N$1(c,o,s),N$1(c,"VER",l.oa),wd(l,c),c}function lc(l,o){if(o&&!l.w)throw Error("Can't create secondary domain capable XhrIo object.");return o=new W$1(l.Ea),o.F=l.w,o}function Dd(){}g=Dd.prototype;g.na=function(){};g.ma=function(){};g.la=function(){};g.ka=function(){};g.Ha=function(){};function Ed(){if(w&&!(10<=Number(Va)))throw Error("Environmental error: no available transport.")}Ed.prototype.a=function(l,o){return new Y$1(l,o)};function Y$1(l,o){B$1.call(this),this.a=new ud(o),this.l=l,this.b=o&&o.messageUrlParams||null,l=o&&o.messageHeaders||null,o&&o.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.a.j=l,l=o&&o.initMessageHeaders||null,o&&o.messageContentType&&(l?l["X-WebChannel-Content-Type"]=o.messageContentType:l={"X-WebChannel-Content-Type":o.messageContentType}),o&&o.pa&&(l?l["X-WebChannel-Client-Profile"]=o.pa:l={"X-WebChannel-Client-Profile":o.pa}),this.a.F=l,(l=o&&o.httpHeadersOverwriteParam)&&!wa(l)&&(this.a.h=l),this.h=o&&o.supportsCrossDomainXhr||!1,this.g=o&&o.sendRawJson||!1,(o=o&&o.httpSessionIdParam)&&!wa(o)&&(this.a.s=o,l=this.b,l!==null&&o in l&&(l=this.b,o in l&&delete l[o])),this.f=new Z$2(this)}r(Y$1,B$1);g=Y$1.prototype;g.addEventListener=function(l,o,s,c){Y$1.M.addEventListener.call(this,l,o,s,c)};g.removeEventListener=function(l,o,s,c){Y$1.M.removeEventListener.call(this,l,o,s,c)};g.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var l=this.a,o=this.l,s=this.b||void 0;F$2(),l.P=o,l.N=s||{},l.U=l.W,l.v=Ac(l,null,l.P),Dc(l)};g.close=function(){Ec(this.a)};g.La=function(l){if(typeof l=="string"){var o={};o.__data__=l,yd(this.a,o)}else this.g?(o={},o.__data__=vb(l),yd(this.a,o)):yd(this.a,l)};g.C=function(){this.a.c=null,delete this.f,Ec(this.a),delete this.a,Y$1.M.C.call(this)};function Fd(l){ac.call(this);var o=l.__sm__;if(o){e:{for(var s in o){l=s;break e}l=void 0}(this.c=l)?(l=this.c,this.data=o!==null&&l in o?o[l]:void 0):this.data=o}else this.data=l}r(Fd,ac);function Gd(){bc.call(this),this.status=1}r(Gd,bc);function Z$2(l){this.a=l}r(Z$2,Dd);Z$2.prototype.na=function(){this.a.dispatchEvent("a")};Z$2.prototype.ma=function(l){this.a.dispatchEvent(new Fd(l))};Z$2.prototype.la=function(l){this.a.dispatchEvent(new Gd)};Z$2.prototype.ka=function(){this.a.dispatchEvent("b")};Ed.prototype.createWebChannel=Ed.prototype.a;Y$1.prototype.send=Y$1.prototype.La;Y$1.prototype.open=Y$1.prototype.Ka;Y$1.prototype.close=Y$1.prototype.close;Wb.NO_ERROR=0;Wb.TIMEOUT=8;Wb.HTTP_ERROR=6;Xb.COMPLETE="complete";$b.EventType=G$1;G$1.OPEN="a";G$1.CLOSE="b";G$1.ERROR="c";G$1.MESSAGE="d";B$1.prototype.listen=B$1.prototype.ra;W$1.prototype.listenOnce=W$1.prototype.sa;W$1.prototype.getLastError=W$1.prototype.Ma;W$1.prototype.getLastErrorCode=W$1.prototype.qa;W$1.prototype.getStatus=W$1.prototype.S;W$1.prototype.getResponseJson=W$1.prototype.Ja;W$1.prototype.getResponseText=W$1.prototype.Y;W$1.prototype.send=W$1.prototype.$;var esm={createWebChannelTransport:function(){return new Ed},ErrorCode:Wb,EventType:Xb,WebChannel:$b,XhrIo:W$1},esm_1=esm.createWebChannelTransport,esm_2=esm.ErrorCode,esm_3=esm.EventType,esm_4=esm.WebChannel,esm_5=esm.XhrIo;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var E$1=index_cjsExports$2.SDK_VERSION,b=function(){function l(o){this.uid=o}return l.prototype.t=function(){return this.uid!=null},l.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},l.prototype.isEqual=function(o){return o.uid===this.uid},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */b.UNAUTHENTICATED=new b(null),b.i=new b("google-credentials-uid"),b.h=new b("first-party-uid");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var T$1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=function(l){function o(s,c){var h=this;return(h=l.call(this,c)||this).code=s,h.message=c,h.name="FirebaseError",h.toString=function(){return h.name+": [code="+h.code+"]: "+h.message},h}return __extends$1(o,l),o}(Error),N=function(l,o){this.user=o,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+l},A$1=function(){function l(){this.u=null}return l.prototype.getToken=function(){return Promise.resolve(null)},l.prototype._=function(){},l.prototype.l=function(o){this.u=o,o(b.UNAUTHENTICATED)},l.prototype.T=function(){this.u=null},l}(),_=function(){function l(o){var s=this;this.I=null,this.currentUser=b.UNAUTHENTICATED,this.R=!1,this.A=0,this.u=null,this.forceRefresh=!1,this.I=function(){s.A++,s.currentUser=s.m(),s.R=!0,s.u&&s.u(s.currentUser)},this.A=0,this.auth=o.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),o.get().then(function(c){s.auth=c,s.I&&s.auth.addAuthTokenListener(s.I)},function(){}))}return l.prototype.getToken=function(){var o=this,s=this.A,c=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(c).then(function(h){if(o.A!==s)throw new I(T$1.ABORTED,"getToken aborted due to token change.");return h?(Re(typeof h.accessToken=="string"),new N(h.accessToken,o.currentUser)):null}):Promise.resolve(null)},l.prototype._=function(){this.forceRefresh=!0},l.prototype.l=function(o){this.u=o,this.R&&o(this.currentUser)},l.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},l.prototype.m=function(){var o=this.auth&&this.auth.getUid();return Re(o===null||typeof o=="string"),new b(o)},l}(),k=function(){function l(o,s){this.P=o,this.V=s,this.type="FirstParty",this.user=b.h}return Object.defineProperty(l.prototype,"o",{get:function(){var o={"X-Goog-AuthUser":this.V},s=this.P.auth.g([]);return s&&(o.Authorization=s),o},enumerable:!0,configurable:!0}),l}(),D=function(){function l(o,s){this.P=o,this.V=s}return l.prototype.getToken=function(){return Promise.resolve(new k(this.P,this.V))},l.prototype.l=function(o){o(b.h)},l.prototype.T=function(){},l.prototype._=function(){},l}(),S=function(){function l(o,s){if(this.seconds=o,this.nanoseconds=s,s<0)throw new I(T$1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new I(T$1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(o<-62135596800)throw new I(T$1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+o);if(o>=253402300800)throw new I(T$1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+o)}return l.now=function(){return l.fromMillis(Date.now())},l.fromDate=function(o){return l.fromMillis(o.getTime())},l.fromMillis=function(o){var s=Math.floor(o/1e3);return new l(s,1e6*(o-1e3*s))},l.prototype.toDate=function(){return new Date(this.toMillis())},l.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},l.prototype.p=function(o){return this.seconds===o.seconds?Pe(this.nanoseconds,o.nanoseconds):Pe(this.seconds,o.seconds)},l.prototype.isEqual=function(o){return o.seconds===this.seconds&&o.nanoseconds===this.nanoseconds},l.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},l.prototype.valueOf=function(){var o=this.seconds- -62135596800;return String(o).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},l}(),x=function(){function l(o){this.timestamp=o}return l.v=function(o){return new l(o)},l.min=function(){return new l(new S(0,0))},l.prototype.S=function(o){return this.timestamp.p(o.timestamp)},l.prototype.isEqual=function(o){return this.timestamp.isEqual(o.timestamp)},l.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},l.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},l.prototype.C=function(){return this.timestamp},l}(),R=function(){function l(o,s,c){s===void 0?s=0:s>o.length&&xe(),c===void 0?c=o.length-s:c>o.length-s&&xe(),this.segments=o,this.offset=s,this.F=c}return Object.defineProperty(l.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),l.prototype.isEqual=function(o){return l.N(this,o)===0},l.prototype.child=function(o){var s=this.segments.slice(this.offset,this.limit());return o instanceof l?o.forEach(function(c){s.push(c)}):s.push(o),this.$(s)},l.prototype.limit=function(){return this.offset+this.length},l.prototype.k=function(o){return o=o===void 0?1:o,this.$(this.segments,this.offset+o,this.length-o)},l.prototype.L=function(){return this.$(this.segments,this.offset,this.length-1)},l.prototype.M=function(){return this.segments[this.offset]},l.prototype.O=function(){return this.get(this.length-1)},l.prototype.get=function(o){return this.segments[this.offset+o]},l.prototype.B=function(){return this.length===0},l.prototype.q=function(o){if(o.length<this.length)return!1;for(var s=0;s<this.length;s++)if(this.get(s)!==o.get(s))return!1;return!0},l.prototype.U=function(o){if(this.length+1!==o.length)return!1;for(var s=0;s<this.length;s++)if(this.get(s)!==o.get(s))return!1;return!0},l.prototype.forEach=function(o){for(var s=this.offset,c=this.limit();s<c;s++)o(this.segments[s])},l.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},l.N=function(o,s){for(var c=Math.min(o.length,s.length),h=0;h<c;h++){var d=o.get(h),p=s.get(h);if(d<p)return-1;if(d>p)return 1}return o.length<s.length?-1:o.length>s.length?1:0},l}(),V$1=function(l){function o(){return l!==null&&l.apply(this,arguments)||this}return __extends$1(o,l),o.prototype.$=function(s,c,h){return new o(s,c,h)},o.prototype.j=function(){return this.W().join("/")},o.prototype.toString=function(){return this.j()},o.K=function(s){if(s.indexOf("//")>=0)throw new I(T$1.INVALID_ARGUMENT,"Invalid path ("+s+"). Paths must not contain // in them.");return new o(s.split("/").filter(function(c){return c.length>0}))},o}(R);V$1.G=new V$1([]);var O=/^[_a-zA-Z][_a-zA-Z0-9]*$/,P=function(l){function o(){return l!==null&&l.apply(this,arguments)||this}return __extends$1(o,l),o.prototype.$=function(s,c,h){return new o(s,c,h)},o.H=function(s){return O.test(s)},o.prototype.j=function(){return this.W().map(function(s){return s=s.replace("\\","\\\\").replace("`","\\`"),o.H(s)||(s="`"+s+"`"),s}).join(".")},o.prototype.toString=function(){return this.j()},o.prototype.Y=function(){return this.length===1&&this.get(0)==="__name__"},o.J=function(){return new o(["__name__"])},o.X=function(s){for(var c=[],h="",d=0,p=function(){if(h.length===0)throw new I(T$1.INVALID_ARGUMENT,"Invalid field path ("+s+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");c.push(h),h=""},Co=!1;d<s.length;){var Bo=s[d];if(Bo==="\\"){if(d+1===s.length)throw new I(T$1.INVALID_ARGUMENT,"Path has trailing escape character: "+s);var Lo=s[d+1];if(Lo!=="\\"&&Lo!=="."&&Lo!=="`")throw new I(T$1.INVALID_ARGUMENT,"Path has invalid escape sequence: "+s);h+=Lo,d+=2}else Bo==="`"?(Co=!Co,d++):Bo!=="."||Co?(h+=Bo,d++):(p(),d++)}if(p(),Co)throw new I(T$1.INVALID_ARGUMENT,"Unterminated ` in path: "+s);return new o(c)},o}(R);P.G=new P([]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var L$1=function(){function l(o){this.path=o}return l.Z=function(o){return new l(V$1.K(o).k(5))},l.prototype.tt=function(o){return this.path.length>=2&&this.path.get(this.path.length-2)===o},l.prototype.isEqual=function(o){return o!==null&&V$1.N(this.path,o.path)===0},l.prototype.toString=function(){return this.path.toString()},l.N=function(o,s){return V$1.N(o.path,s.path)},l.et=function(o){return o.length%2==0},l.st=function(o){return new l(new V$1(o.slice()))},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U$1(l){var o=0;for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&o++;return o}function C(l,o){for(var s in l)Object.prototype.hasOwnProperty.call(l,s)&&o(s,l[s])}function M(l){for(var o in l)if(Object.prototype.hasOwnProperty.call(l,o))return!1;return!0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */L$1.EMPTY=new L$1(new V$1([]));var q=function(){function l(o){this.it=o}return l.fromBase64String=function(o){return new l(Ie.nt().atob(o))},l.fromUint8Array=function(o){return new l(function(s){for(var c="",h=0;h<s.length;++h)c+=String.fromCharCode(s[h]);return c}(o))},l.prototype.toBase64=function(){return Ie.nt().btoa(this.it)},l.prototype.toUint8Array=function(){return function(o){for(var s=new Uint8Array(o.length),c=0;c<o.length;c++)s[c]=o.charCodeAt(c);return s}(this.it)},l.prototype.rt=function(){return 2*this.it.length},l.prototype.S=function(o){return Pe(this.it,o.it)},l.prototype.isEqual=function(o){return this.it===o.it},l}();function j(l){return l==null}function F$1(l){return l===-0&&1/l==-1/0}function B(l){return typeof l=="number"&&Number.isInteger(l)&&!F$1(l)&&l<=Number.MAX_SAFE_INTEGER&&l>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z$1(l){var o,s;return((s=(((o=l==null?void 0:l.mapValue)===null||o===void 0?void 0:o.fields)||{}).__type__)===null||s===void 0?void 0:s.stringValue)==="server_timestamp"}function G(l){var o=X(l.mapValue.fields.__local_write_time__.timestampValue);return new S(o.seconds,o.nanos)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */q.ht=new q("");var W=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Q(l){return"nullValue"in l?0:"booleanValue"in l?1:"integerValue"in l||"doubleValue"in l?2:"timestampValue"in l?3:"stringValue"in l?5:"bytesValue"in l?6:"referenceValue"in l?7:"geoPointValue"in l?8:"arrayValue"in l?9:"mapValue"in l?z$1(l)?4:10:xe()}function K(l,o){var s=Q(l);if(s!==Q(o))return!1;switch(s){case 0:return!0;case 1:return l.booleanValue===o.booleanValue;case 4:return G(l).isEqual(G(o));case 3:return function(c,h){if(typeof c.timestampValue=="string"&&typeof h.timestampValue=="string"&&c.timestampValue.length===h.timestampValue.length)return c.timestampValue===h.timestampValue;var d=X(c.timestampValue),p=X(h.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos}(l,o);case 5:return l.stringValue===o.stringValue;case 6:return function(c,h){return tt(c.bytesValue).isEqual(tt(h.bytesValue))}(l,o);case 7:return l.referenceValue===o.referenceValue;case 8:return function(c,h){return Z$1(c.geoPointValue.latitude)===Z$1(h.geoPointValue.latitude)&&Z$1(c.geoPointValue.longitude)===Z$1(h.geoPointValue.longitude)}(l,o);case 2:return function(c,h){if("integerValue"in c&&"integerValue"in h)return Z$1(c.integerValue)===Z$1(h.integerValue);if("doubleValue"in c&&"doubleValue"in h){var d=Z$1(c.doubleValue),p=Z$1(h.doubleValue);return d===p?F$1(d)===F$1(p):isNaN(d)&&isNaN(p)}return!1}(l,o);case 9:return Le(l.arrayValue.values||[],o.arrayValue.values||[],K);case 10:return function(c,h){var d=c.mapValue.fields||{},p=h.mapValue.fields||{};if(U$1(d)!==U$1(p))return!1;for(var Co in d)if(d.hasOwnProperty(Co)&&(p[Co]===void 0||!K(d[Co],p[Co])))return!1;return!0}(l,o);default:return xe()}}function Y(l,o){return(l.values||[]).find(function(s){return K(s,o)})!==void 0}function $(l,o){var s=Q(l),c=Q(o);if(s!==c)return Pe(s,c);switch(s){case 0:return 0;case 1:return Pe(l.booleanValue,o.booleanValue);case 2:return function(h,d){var p=Z$1(h.integerValue||h.doubleValue),Co=Z$1(d.integerValue||d.doubleValue);return p<Co?-1:p>Co?1:p===Co?0:isNaN(p)?isNaN(Co)?0:-1:1}(l,o);case 3:return J(l.timestampValue,o.timestampValue);case 4:return J(G(l),G(o));case 5:return Pe(l.stringValue,o.stringValue);case 6:return function(h,d){var p=tt(h),Co=tt(d);return p.S(Co)}(l.bytesValue,o.bytesValue);case 7:return function(h,d){for(var p=h.split("/"),Co=d.split("/"),Bo=0;Bo<p.length&&Bo<Co.length;Bo++){var Lo=Pe(p[Bo],Co[Bo]);if(Lo!==0)return Lo}return Pe(p.length,Co.length)}(l.referenceValue,o.referenceValue);case 8:return function(h,d){var p=Pe(Z$1(h.latitude),Z$1(d.latitude));return p!==0?p:Pe(Z$1(h.longitude),Z$1(d.longitude))}(l.geoPointValue,o.geoPointValue);case 9:return function(h,d){for(var p=h.values||[],Co=d.values||[],Bo=0;Bo<p.length&&Bo<Co.length;++Bo){var Lo=$(p[Bo],Co[Bo]);if(Lo)return Lo}return Pe(p.length,Co.length)}(l.arrayValue,o.arrayValue);case 10:return function(h,d){var p=h.fields||{},Co=Object.keys(p),Bo=d.fields||{},Lo=Object.keys(Bo);Co.sort(),Lo.sort();for(var Uo=0;Uo<Co.length&&Uo<Lo.length;++Uo){var Qo=Pe(Co[Uo],Lo[Uo]);if(Qo!==0)return Qo;var Po=$(p[Co[Uo]],Bo[Lo[Uo]]);if(Po!==0)return Po}return Pe(Co.length,Lo.length)}(l.mapValue,o.mapValue);default:throw xe()}}function J(l,o){if(typeof l=="string"&&typeof o=="string"&&l.length===o.length)return Pe(l,o);var s=X(l),c=X(o),h=Pe(s.seconds,c.seconds);return h!==0?h:Pe(s.nanos,c.nanos)}function H(l){return function o(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(d){var p=X(d);return"time("+p.seconds+","+p.nanos+")"}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?tt(s.bytesValue).toBase64():"referenceValue"in s?(h=s.referenceValue,L$1.Z(h).toString()):"geoPointValue"in s?"geo("+(c=s.geoPointValue).latitude+","+c.longitude+")":"arrayValue"in s?function(d){for(var p="[",Co=!0,Bo=0,Lo=d.values||[];Bo<Lo.length;Bo++){var Uo=Lo[Bo];Co?Co=!1:p+=",",p+=o(Uo)}return p+"]"}(s.arrayValue):"mapValue"in s?function(d){for(var p="{",Co=!0,Bo=0,Lo=Object.keys(d.fields||{}).sort();Bo<Lo.length;Bo++){var Uo=Lo[Bo];Co?Co=!1:p+=",",p+=Uo+":"+o(d.fields[Uo])}return p+"}"}(s.mapValue):xe();var c,h}(l)}function X(l){if(Re(!!l),typeof l=="string"){var o=0,s=W.exec(l);if(Re(!!s),s[1]){var c=s[1];c=(c+"000000000").substr(0,9),o=Number(c)}var h=new Date(l);return{seconds:Math.floor(h.getTime()/1e3),nanos:o}}return{seconds:Z$1(l.seconds),nanos:Z$1(l.nanos)}}function Z$1(l){return typeof l=="number"?l:typeof l=="string"?Number(l):0}function tt(l){return typeof l=="string"?q.fromBase64String(l):q.fromUint8Array(l)}function et(l,o){return{referenceValue:"projects/"+l.projectId+"/databases/"+l.database+"/documents/"+o.path.j()}}function nt(l){return!!l&&"integerValue"in l}function rt(l){return!!l&&"arrayValue"in l}function it(l){return!!l&&"nullValue"in l}function ot(l){return!!l&&"doubleValue"in l&&isNaN(Number(l.doubleValue))}function st(l){return!!l&&"mapValue"in l}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut=function(){function l(){}return l.prototype.ot=function(o,s){return function(c,h){var d={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:c.seconds,nanos:c.nanoseconds}}}};return h&&(d.fields.__previous_value__=h),{mapValue:d}}(s,o)},l.prototype.at=function(o,s){return s},l.prototype.ut=function(o){return null},l.prototype.isEqual=function(o){return o instanceof l},l}();ut.instance=new ut;var at=function(){function l(o){this.elements=o}return l.prototype.ot=function(o,s){return this.apply(o)},l.prototype.at=function(o,s){return this.apply(o)},l.prototype.apply=function(o){for(var s=ft(o),c=function(p){s.some(function(Co){return K(Co,p)})||s.push(p)},h=0,d=this.elements;h<d.length;h++)c(d[h]);return{arrayValue:{values:s}}},l.prototype.ut=function(o){return null},l.prototype.isEqual=function(o){return o instanceof l&&Le(this.elements,o.elements,K)},l}(),ht=function(){function l(o){this.elements=o}return l.prototype.ot=function(o,s){return this.apply(o)},l.prototype.at=function(o,s){return this.apply(o)},l.prototype.apply=function(o){for(var s=ft(o),c=function(p){s=s.filter(function(Co){return!K(Co,p)})},h=0,d=this.elements;h<d.length;h++)c(d[h]);return{arrayValue:{values:s}}},l.prototype.ut=function(o){return null},l.prototype.isEqual=function(o){return o instanceof l&&Le(this.elements,o.elements,K)},l}(),ct=function(){function l(o,s){this.serializer=o,this.ct=s}return l.prototype.ot=function(o,s){var c=this.ut(o),h=this.asNumber(c)+this.asNumber(this.ct);return nt(c)&&nt(this.ct)?this.serializer._t(h):this.serializer.lt(h)},l.prototype.at=function(o,s){return s},l.prototype.ut=function(o){return nt(s=o)||function(c){return!!c&&"doubleValue"in c}(s)?o:{integerValue:0};var s},l.prototype.isEqual=function(o){return o instanceof l&&K(this.ct,o.ct)},l.prototype.asNumber=function(o){return Z$1(o.integerValue||o.doubleValue)},l}();function ft(l){return rt(l)&&l.arrayValue.values?l.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt=function(){function l(o){this.fields=o,o.sort(P.N)}return l.prototype.dt=function(o){for(var s=0,c=this.fields;s<c.length;s++)if(c[s].q(o))return!0;return!1},l.prototype.isEqual=function(o){return Le(this.fields,o.fields,function(s,c){return s.isEqual(c)})},l}(),pt=function(){function l(o,s){this.field=o,this.transform=s}return l.prototype.isEqual=function(o){return this.field.isEqual(o.field)&&this.transform.isEqual(o.transform)},l}(),dt=function(l,o){this.version=l,this.transformResults=o},yt=function(){function l(o,s){this.updateTime=o,this.exists=s}return l.ft=function(){return new l},l.exists=function(o){return new l(void 0,o)},l.updateTime=function(o){return new l(o)},Object.defineProperty(l.prototype,"Tt",{get:function(){return this.updateTime===void 0&&this.exists===void 0},enumerable:!0,configurable:!0}),l.prototype.Et=function(o){return this.updateTime!==void 0?o instanceof Dt&&o.version.isEqual(this.updateTime):this.exists===void 0||this.exists===o instanceof Dt},l.prototype.isEqual=function(o){return this.exists===o.exists&&(this.updateTime?!!o.updateTime&&this.updateTime.isEqual(o.updateTime):!o.updateTime)},l}(),vt=function(){function l(){}return l.prototype.It=function(o){},l.wt=function(o){return o instanceof Dt?o.version:x.min()},l}(),mt=function(l){function o(s,c,h){var d=this;return(d=l.call(this)||this).key=s,d.value=c,d.Rt=h,d.type=0,d}return __extends$1(o,l),o.prototype.at=function(s,c){this.It(s);var h=c.version;return new Dt(this.key,h,this.value,{hasCommittedMutations:!0})},o.prototype.ot=function(s,c,h){if(this.It(s),!this.Rt.Et(s))return s;var d=vt.wt(s);return new Dt(this.key,d,this.value,{At:!0})},o.prototype.Pt=function(s){return null},o.prototype.isEqual=function(s){return s instanceof o&&this.key.isEqual(s.key)&&this.value.isEqual(s.value)&&this.Rt.isEqual(s.Rt)},o}(vt),gt=function(l){function o(s,c,h,d){var p=this;return(p=l.call(this)||this).key=s,p.data=c,p.Vt=h,p.Rt=d,p.type=1,p}return __extends$1(o,l),o.prototype.at=function(s,c){if(this.It(s),!this.Rt.Et(s))return new xt(this.key,c.version);var h=this.gt(s);return new Dt(this.key,c.version,h,{hasCommittedMutations:!0})},o.prototype.ot=function(s,c,h){if(this.It(s),!this.Rt.Et(s))return s;var d=vt.wt(s),p=this.gt(s);return new Dt(this.key,d,p,{At:!0})},o.prototype.Pt=function(s){return null},o.prototype.isEqual=function(s){return s instanceof o&&this.key.isEqual(s.key)&&this.Vt.isEqual(s.Vt)&&this.Rt.isEqual(s.Rt)},o.prototype.gt=function(s){var c;return c=s instanceof Dt?s.data():Tt.empty(),this.pt(c)},o.prototype.pt=function(s){var c=this,h=new It(s);return this.Vt.fields.forEach(function(d){if(!d.B()){var p=c.data.field(d);p!==null?h.set(d,p):h.delete(d)}}),h.yt()},o}(vt),wt=function(l){function o(s,c){var h=this;return(h=l.call(this)||this).key=s,h.fieldTransforms=c,h.type=2,h.Rt=yt.exists(!0),h}return __extends$1(o,l),o.prototype.at=function(s,c){if(this.It(s),Re(c.transformResults!=null),!this.Rt.Et(s))return new xt(this.key,c.version);var h=this.bt(s),d=this.vt(s,c.transformResults),p=c.version,Co=this.St(h.data(),d);return new Dt(this.key,p,Co,{hasCommittedMutations:!0})},o.prototype.ot=function(s,c,h){if(this.It(s),!this.Rt.Et(s))return s;var d=this.bt(s),p=this.Dt(h,s,c),Co=this.St(d.data(),p);return new Dt(this.key,d.version,Co,{At:!0})},o.prototype.Pt=function(s){for(var c=null,h=0,d=this.fieldTransforms;h<d.length;h++){var p=d[h],Co=s instanceof Dt?s.field(p.field):void 0,Bo=p.transform.ut(Co||null);Bo!=null&&(c=c==null?new It().set(p.field,Bo):c.set(p.field,Bo))}return c?c.yt():null},o.prototype.isEqual=function(s){return s instanceof o&&this.key.isEqual(s.key)&&Le(this.fieldTransforms,s.fieldTransforms,function(c,h){return c.isEqual(h)})&&this.Rt.isEqual(s.Rt)},o.prototype.bt=function(s){return s},o.prototype.vt=function(s,c){var h=[];Re(this.fieldTransforms.length===c.length);for(var d=0;d<c.length;d++){var p=this.fieldTransforms[d],Co=p.transform,Bo=null;s instanceof Dt&&(Bo=s.field(p.field)),h.push(Co.at(Bo,c[d]))}return h},o.prototype.Dt=function(s,c,h){for(var d=[],p=0,Co=this.fieldTransforms;p<Co.length;p++){var Bo=Co[p],Lo=Bo.transform,Uo=null;c instanceof Dt&&(Uo=c.field(Bo.field)),Uo===null&&h instanceof Dt&&(Uo=h.field(Bo.field)),d.push(Lo.ot(Uo,s))}return d},o.prototype.St=function(s,c){for(var h=new It(s),d=0;d<this.fieldTransforms.length;d++){var p=this.fieldTransforms[d].field;h.set(p,c[d])}return h.yt()},o}(vt),Et=function(l){function o(s,c){var h=this;return(h=l.call(this)||this).key=s,h.Rt=c,h.type=3,h}return __extends$1(o,l),o.prototype.at=function(s,c){return this.It(s),new St(this.key,c.version,{hasCommittedMutations:!0})},o.prototype.ot=function(s,c,h){return this.It(s),this.Rt.Et(s)?new St(this.key,x.min()):s},o.prototype.Pt=function(s){return null},o.prototype.isEqual=function(s){return s instanceof o&&this.key.isEqual(s.key)&&this.Rt.isEqual(s.Rt)},o}(vt),bt=function(l){function o(s,c){var h=this;return(h=l.call(this)||this).key=s,h.Rt=c,h.type=4,h}return __extends$1(o,l),o.prototype.at=function(s,c){xe()},o.prototype.ot=function(s,c,h){xe()},o.prototype.Pt=function(s){xe()},o.prototype.isEqual=function(s){return s instanceof o&&this.key.isEqual(s.key)&&this.Rt.isEqual(s.Rt)},o}(vt),Tt=function(){function l(o){this.proto=o}return l.empty=function(){return new l({mapValue:{}})},l.prototype.field=function(o){if(o.B())return this.proto;for(var s=this.proto,c=0;c<o.length-1;++c)if(!s.mapValue.fields||!st(s=s.mapValue.fields[o.get(c)]))return null;return(s=(s.mapValue.fields||{})[o.O()])||null},l.prototype.isEqual=function(o){return K(this.proto,o.proto)},l}(),It=function(){function l(o){o===void 0&&(o=Tt.empty()),this.Ct=o,this.Ft=new Map}return l.prototype.set=function(o,s){return this.Nt(o,s),this},l.prototype.delete=function(o){return this.Nt(o,null),this},l.prototype.Nt=function(o,s){for(var c=this.Ft,h=0;h<o.length-1;++h){var d=o.get(h),p=c.get(d);p instanceof Map?c=p:p&&Q(p)===10?(p=new Map(Object.entries(p.mapValue.fields||{})),c.set(d,p),c=p):(p=new Map,c.set(d,p),c=p)}c.set(o.O(),s)},l.prototype.yt=function(){var o=this.$t(P.G,this.Ft);return o!=null?new Tt(o):this.Ct},l.prototype.$t=function(o,s){var c=this,h=!1,d=this.Ct.field(o),p=st(d)?Object.assign({},d.mapValue.fields):{};return s.forEach(function(Co,Bo){if(Co instanceof Map){var Lo=c.$t(o.child(Bo),Co);Lo!=null&&(p[Bo]=Lo,h=!0)}else Co!==null?(p[Bo]=Co,h=!0):p.hasOwnProperty(Bo)&&(delete p[Bo],h=!0)}),h?{mapValue:{fields:p}}:null},l}();function Nt(l){var o=[];return C(l.fields||{},function(s,c){var h=new P([s]);if(st(c)){var d=Nt(c.mapValue).fields;if(d.length===0)o.push(h);else for(var p=0,Co=d;p<Co.length;p++){var Bo=Co[p];o.push(h.child(Bo))}}else o.push(h)}),new lt(o)}var At,_t,kt=function(l,o){this.key=l,this.version=o},Dt=function(l){function o(s,c,h,d){var p=this;return(p=l.call(this,s,c)||this).kt=h,p.At=!!d.At,p.hasCommittedMutations=!!d.hasCommittedMutations,p}return __extends$1(o,l),o.prototype.field=function(s){return this.kt.field(s)},o.prototype.data=function(){return this.kt},o.prototype.Lt=function(){return this.kt.proto},o.prototype.isEqual=function(s){return s instanceof o&&this.key.isEqual(s.key)&&this.version.isEqual(s.version)&&this.At===s.At&&this.hasCommittedMutations===s.hasCommittedMutations&&this.kt.isEqual(s.kt)},o.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.kt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(o.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),o}(kt),St=function(l){function o(s,c,h){var d=this;return(d=l.call(this,s,c)||this).hasCommittedMutations=!(!h||!h.hasCommittedMutations),d}return __extends$1(o,l),o.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(o.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),o.prototype.isEqual=function(s){return s instanceof o&&s.hasCommittedMutations===this.hasCommittedMutations&&s.version.isEqual(this.version)&&s.key.isEqual(this.key)},o}(kt),xt=function(l){function o(){return l!==null&&l.apply(this,arguments)||this}return __extends$1(o,l),o.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(o.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),o.prototype.isEqual=function(s){return s instanceof o&&s.version.isEqual(this.version)&&s.key.isEqual(this.key)},o}(kt),Rt=function(){function l(o,s,c,h,d,p,Co){s===void 0&&(s=null),c===void 0&&(c=[]),h===void 0&&(h=[]),d===void 0&&(d=null),p===void 0&&(p=null),Co===void 0&&(Co=null),this.path=o,this.collectionGroup=s,this.orderBy=c,this.filters=h,this.limit=d,this.startAt=p,this.endAt=Co,this.Mt=null}return l.prototype.canonicalId=function(){if(this.Mt===null){var o=this.path.j();this.collectionGroup!==null&&(o+="|cg:"+this.collectionGroup),o+="|f:",o+=this.filters.map(function(s){return s.canonicalId()}).join(","),o+="|ob:",o+=this.orderBy.map(function(s){return s.canonicalId()}).join(","),j(this.limit)||(o+="|l:",o+=this.limit),this.startAt&&(o+="|lb:",o+=this.startAt.canonicalId()),this.endAt&&(o+="|ub:",o+=this.endAt.canonicalId()),this.Mt=o}return this.Mt},l.prototype.toString=function(){var o=this.path.j();return this.collectionGroup!==null&&(o+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(o+=", filters: ["+this.filters.join(", ")+"]"),j(this.limit)||(o+=", limit: "+this.limit),this.orderBy.length>0&&(o+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(o+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(o+=", endAt: "+this.endAt.canonicalId()),"Target("+o+")"},l.prototype.isEqual=function(o){if(this.limit!==o.limit||this.orderBy.length!==o.orderBy.length)return!1;for(var s=0;s<this.orderBy.length;s++)if(!this.orderBy[s].isEqual(o.orderBy[s]))return!1;if(this.filters.length!==o.filters.length)return!1;for(var c=0;c<this.filters.length;c++)if(!this.filters[c].isEqual(o.filters[c]))return!1;return this.collectionGroup===o.collectionGroup&&!!this.path.isEqual(o.path)&&!!(this.startAt!==null?this.startAt.isEqual(o.startAt):o.startAt===null)&&(this.endAt!==null?this.endAt.isEqual(o.endAt):o.endAt===null)},l.prototype.Ot=function(){return L$1.et(this.path)&&this.collectionGroup===null&&this.filters.length===0},l}(),Vt=function(){function l(o,s,c,h,d,p,Co,Bo){s===void 0&&(s=null),c===void 0&&(c=[]),h===void 0&&(h=[]),d===void 0&&(d=null),p===void 0&&(p="F"),Co===void 0&&(Co=null),Bo===void 0&&(Bo=null),this.path=o,this.collectionGroup=s,this.xt=c,this.filters=h,this.limit=d,this.Bt=p,this.startAt=Co,this.endAt=Bo,this.qt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}return l.Wt=function(o){return new l(o)},Object.defineProperty(l.prototype,"orderBy",{get:function(){if(this.qt===null){this.qt=[];var o=this.jt(),s=this.Kt();if(o!==null&&s===null)o.Y()||this.qt.push(new jt(o)),this.qt.push(new jt(P.J(),"asc"));else{for(var c=!1,h=0,d=this.xt;h<d.length;h++){var p=d[h];this.qt.push(p),p.field.Y()&&(c=!0)}if(!c){var Co=this.xt.length>0?this.xt[this.xt.length-1].dir:"asc";this.qt.push(new jt(P.J(),Co))}}}return this.qt},enumerable:!0,configurable:!0}),l.prototype.Gt=function(o){var s=this.filters.concat([o]);return new l(this.path,this.collectionGroup,this.xt.slice(),s,this.limit,this.Bt,this.startAt,this.endAt)},l.prototype.zt=function(o){var s=this.xt.concat([o]);return new l(this.path,this.collectionGroup,s,this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},l.prototype.Ht=function(o){return new l(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),o,"F",this.startAt,this.endAt)},l.prototype.Yt=function(o){return new l(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),o,"L",this.startAt,this.endAt)},l.prototype.Jt=function(o){return new l(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,o,this.endAt)},l.prototype.Xt=function(o){return new l(this.path,this.collectionGroup,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,o)},l.prototype.Zt=function(o){return new l(o,null,this.xt.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},l.prototype.te=function(){return this.filters.length===0&&this.limit===null&&this.startAt==null&&this.endAt==null&&(this.xt.length===0||this.xt.length===1&&this.xt[0].field.Y())},l.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.Bt},l.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.Bt+")"},l.prototype.isEqual=function(o){return this.ee().isEqual(o.ee())&&this.Bt===o.Bt},l.prototype.se=function(o,s){for(var c=!1,h=0,d=this.orderBy;h<d.length;h++){var p=d[h],Co=p.compare(o,s);if(Co!==0)return Co;c=c||p.field.Y()}return 0},l.prototype.matches=function(o){return this.ie(o)&&this.ne(o)&&this.re(o)&&this.he(o)},l.prototype.oe=function(){return!j(this.limit)&&this.Bt==="F"},l.prototype.ae=function(){return!j(this.limit)&&this.Bt==="L"},l.prototype.Kt=function(){return this.xt.length>0?this.xt[0].field:null},l.prototype.jt=function(){for(var o=0,s=this.filters;o<s.length;o++){var c=s[o];if(c instanceof Ot&&c.ue())return c.field}return null},l.prototype.ce=function(o){for(var s=0,c=this.filters;s<c.length;s++){var h=c[s];if(h instanceof Ot&&o.indexOf(h.op)>=0)return h.op}return null},l.prototype.Ot=function(){return this.ee().Ot()},l.prototype._e=function(){return this.collectionGroup!==null},l.prototype.ee=function(){if(!this.Ut)if(this.Bt==="F")this.Ut=new Rt(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var o=[],s=0,c=this.orderBy;s<c.length;s++){var h=c[s],d=h.dir==="desc"?"asc":"desc";o.push(new jt(h.field,d))}var p=this.endAt?new qt(this.endAt.position,!this.endAt.before):null,Co=this.startAt?new qt(this.startAt.position,!this.startAt.before):null;this.Ut=new Rt(this.path,this.collectionGroup,o,this.filters,this.limit,p,Co)}return this.Ut},l.prototype.ie=function(o){var s=o.key.path;return this.collectionGroup!==null?o.key.tt(this.collectionGroup)&&this.path.q(s):L$1.et(this.path)?this.path.isEqual(s):this.path.U(s)},l.prototype.ne=function(o){for(var s=0,c=this.xt;s<c.length;s++){var h=c[s];if(!h.field.Y()&&o.field(h.field)===null)return!1}return!0},l.prototype.re=function(o){for(var s=0,c=this.filters;s<c.length;s++)if(!c[s].matches(o))return!1;return!0},l.prototype.he=function(o){return!(this.startAt&&!this.startAt.le(this.orderBy,o)||this.endAt&&this.endAt.le(this.orderBy,o))},l.prototype.Qt=function(o){},l}(),Ot=function(l){function o(s,c,h){var d=this;return(d=l.call(this)||this).field=s,d.op=c,d.value=h,d}return __extends$1(o,l),o.create=function(s,c,h){if(s.Y())return c==="in"?new Lt(s,h):new Pt(s,c,h);if(it(h)){if(c!=="==")throw new I(T$1.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new o(s,c,h)}if(ot(h)){if(c!=="==")throw new I(T$1.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new o(s,c,h)}return c==="array-contains"?new Ut(s,h):c==="in"?new Ct(s,h):c==="array-contains-any"?new Mt(s,h):new o(s,c,h)},o.prototype.matches=function(s){var c=s.field(this.field);return c!==null&&Q(this.value)===Q(c)&&this.de($(c,this.value))},o.prototype.de=function(s){switch(this.op){case"<":return s<0;case"<=":return s<=0;case"==":return s===0;case">":return s>0;case">=":return s>=0;default:return xe()}},o.prototype.ue=function(){return["<","<=",">",">="].indexOf(this.op)>=0},o.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+H(this.value)},o.prototype.isEqual=function(s){return s instanceof o&&this.op===s.op&&this.field.isEqual(s.field)&&K(this.value,s.value)},o.prototype.toString=function(){return this.field.j()+" "+this.op+" "+H(this.value)},o}(function(){}),Pt=function(l){function o(s,c,h){var d=this;return(d=l.call(this,s,c,h)||this).key=L$1.Z(h.referenceValue),d}return __extends$1(o,l),o.prototype.matches=function(s){var c=L$1.N(s.key,this.key);return this.de(c)},o}(Ot),Lt=function(l){function o(s,c){var h=this;return(h=l.call(this,s,"in",c)||this).keys=(c.arrayValue.values||[]).map(function(d){return L$1.Z(d.referenceValue)}),h}return __extends$1(o,l),o.prototype.matches=function(s){return this.keys.some(function(c){return c.isEqual(s.key)})},o}(Ot),Ut=function(l){function o(s,c){return l.call(this,s,"array-contains",c)||this}return __extends$1(o,l),o.prototype.matches=function(s){var c=s.field(this.field);return rt(c)&&Y(c.arrayValue,this.value)},o}(Ot),Ct=function(l){function o(s,c){return l.call(this,s,"in",c)||this}return __extends$1(o,l),o.prototype.matches=function(s){var c=s.field(this.field);return c!==null&&Y(this.value.arrayValue,c)},o}(Ot),Mt=function(l){function o(s,c){return l.call(this,s,"array-contains-any",c)||this}return __extends$1(o,l),o.prototype.matches=function(s){var c=this,h=s.field(this.field);return!(!rt(h)||!h.arrayValue.values)&&h.arrayValue.values.some(function(d){return Y(c.value.arrayValue,d)})},o}(Ot),qt=function(){function l(o,s){this.position=o,this.before=s}return l.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(o){return H(o)}).join(",")},l.prototype.le=function(o,s){for(var c=0,h=0;h<this.position.length;h++){var d=o[h],p=this.position[h];if(c=d.field.Y()?L$1.N(L$1.Z(p.referenceValue),s.key):$(p,s.field(d.field)),d.dir==="desc"&&(c*=-1),c!==0)break}return this.before?c<=0:c<0},l.prototype.isEqual=function(o){if(o===null||this.before!==o.before||this.position.length!==o.position.length)return!1;for(var s=0;s<this.position.length;s++)if(!K(this.position[s],o.position[s]))return!1;return!0},l}(),jt=function(){function l(o,s){this.field=o,s===void 0&&(s="asc"),this.dir=s,this.fe=o.Y()}return l.prototype.compare=function(o,s){var c=this.fe?L$1.N(o.key,s.key):function(h,d,p){var Co=d.field(h),Bo=p.field(h);return Co!==null&&Bo!==null?$(Co,Bo):xe()}(this.field,o,s);switch(this.dir){case"asc":return c;case"desc":return-1*c;default:return xe()}},l.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},l.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},l.prototype.isEqual=function(o){return this.dir===o.dir&&this.field.isEqual(o.field)},l}(),Ft=function(){function l(o,s,c,h,d,p,Co){d===void 0&&(d=x.min()),p===void 0&&(p=x.min()),Co===void 0&&(Co=q.ht),this.target=o,this.targetId=s,this.Te=c,this.sequenceNumber=h,this.Ee=d,this.lastLimboFreeSnapshotVersion=p,this.resumeToken=Co}return l.prototype.Ie=function(o){return new l(this.target,this.targetId,this.Te,o,this.Ee,this.lastLimboFreeSnapshotVersion,this.resumeToken)},l.prototype.we=function(o,s){return new l(this.target,this.targetId,this.Te,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,o)},l.prototype.Re=function(o){return new l(this.target,this.targetId,this.Te,this.sequenceNumber,this.Ee,o,this.resumeToken)},l}(),Bt=function(l){this.count=l};function zt(l){switch(l){case T$1.OK:return xe();case T$1.CANCELLED:case T$1.UNKNOWN:case T$1.DEADLINE_EXCEEDED:case T$1.RESOURCE_EXHAUSTED:case T$1.INTERNAL:case T$1.UNAVAILABLE:case T$1.UNAUTHENTICATED:return!1;case T$1.INVALID_ARGUMENT:case T$1.NOT_FOUND:case T$1.ALREADY_EXISTS:case T$1.PERMISSION_DENIED:case T$1.FAILED_PRECONDITION:case T$1.ABORTED:case T$1.OUT_OF_RANGE:case T$1.UNIMPLEMENTED:case T$1.DATA_LOSS:return!0;default:return xe()}}function Gt(l){if(l===void 0)return De("GRPC error has no .code"),T$1.UNKNOWN;switch(l){case At.OK:return T$1.OK;case At.CANCELLED:return T$1.CANCELLED;case At.UNKNOWN:return T$1.UNKNOWN;case At.DEADLINE_EXCEEDED:return T$1.DEADLINE_EXCEEDED;case At.RESOURCE_EXHAUSTED:return T$1.RESOURCE_EXHAUSTED;case At.INTERNAL:return T$1.INTERNAL;case At.UNAVAILABLE:return T$1.UNAVAILABLE;case At.UNAUTHENTICATED:return T$1.UNAUTHENTICATED;case At.INVALID_ARGUMENT:return T$1.INVALID_ARGUMENT;case At.NOT_FOUND:return T$1.NOT_FOUND;case At.ALREADY_EXISTS:return T$1.ALREADY_EXISTS;case At.PERMISSION_DENIED:return T$1.PERMISSION_DENIED;case At.FAILED_PRECONDITION:return T$1.FAILED_PRECONDITION;case At.ABORTED:return T$1.ABORTED;case At.OUT_OF_RANGE:return T$1.OUT_OF_RANGE;case At.UNIMPLEMENTED:return T$1.UNIMPLEMENTED;case At.DATA_LOSS:return T$1.DATA_LOSS;default:return xe()}}(_t=At||(At={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wt=function(){function l(o,s){this.N=o,this.root=s||Kt.EMPTY}return l.prototype.Ae=function(o,s){return new l(this.N,this.root.Ae(o,s,this.N).me(null,null,Kt.Pe,null,null))},l.prototype.remove=function(o){return new l(this.N,this.root.remove(o,this.N).me(null,null,Kt.Pe,null,null))},l.prototype.get=function(o){for(var s=this.root;!s.B();){var c=this.N(o,s.key);if(c===0)return s.value;c<0?s=s.left:c>0&&(s=s.right)}return null},l.prototype.indexOf=function(o){for(var s=0,c=this.root;!c.B();){var h=this.N(o,c.key);if(h===0)return s+c.left.size;h<0?c=c.left:(s+=c.left.size+1,c=c.right)}return-1},l.prototype.B=function(){return this.root.B()},Object.defineProperty(l.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),l.prototype.Ve=function(){return this.root.Ve()},l.prototype.ge=function(){return this.root.ge()},l.prototype.pe=function(o){return this.root.pe(o)},l.prototype.forEach=function(o){this.pe(function(s,c){return o(s,c),!1})},l.prototype.toString=function(){var o=[];return this.pe(function(s,c){return o.push(s+":"+c),!1}),"{"+o.join(", ")+"}"},l.prototype.ye=function(o){return this.root.ye(o)},l.prototype.be=function(){return new Qt(this.root,null,this.N,!1)},l.prototype.ve=function(o){return new Qt(this.root,o,this.N,!1)},l.prototype.Se=function(){return new Qt(this.root,null,this.N,!0)},l.prototype.De=function(o){return new Qt(this.root,o,this.N,!0)},l}(),Qt=function(){function l(o,s,c,h){this.Ce=h,this.Fe=[];for(var d=1;!o.B();)if(d=s?c(o.key,s):1,h&&(d*=-1),d<0)o=this.Ce?o.left:o.right;else{if(d===0){this.Fe.push(o);break}this.Fe.push(o),o=this.Ce?o.right:o.left}}return l.prototype.Ne=function(){var o=this.Fe.pop(),s={key:o.key,value:o.value};if(this.Ce)for(o=o.left;!o.B();)this.Fe.push(o),o=o.right;else for(o=o.right;!o.B();)this.Fe.push(o),o=o.left;return s},l.prototype.$e=function(){return this.Fe.length>0},l.prototype.ke=function(){if(this.Fe.length===0)return null;var o=this.Fe[this.Fe.length-1];return{key:o.key,value:o.value}},l}(),Kt=function(){function l(o,s,c,h,d){this.key=o,this.value=s,this.color=c!=null?c:l.RED,this.left=h!=null?h:l.EMPTY,this.right=d!=null?d:l.EMPTY,this.size=this.left.size+1+this.right.size}return l.prototype.me=function(o,s,c,h,d){return new l(o!=null?o:this.key,s!=null?s:this.value,c!=null?c:this.color,h!=null?h:this.left,d!=null?d:this.right)},l.prototype.B=function(){return!1},l.prototype.pe=function(o){return this.left.pe(o)||o(this.key,this.value)||this.right.pe(o)},l.prototype.ye=function(o){return this.right.ye(o)||o(this.key,this.value)||this.left.ye(o)},l.prototype.min=function(){return this.left.B()?this:this.left.min()},l.prototype.Ve=function(){return this.min().key},l.prototype.ge=function(){return this.right.B()?this.key:this.right.ge()},l.prototype.Ae=function(o,s,c){var h=this,d=c(o,h.key);return(h=d<0?h.me(null,null,null,h.left.Ae(o,s,c),null):d===0?h.me(null,s,null,null,null):h.me(null,null,null,null,h.right.Ae(o,s,c))).Le()},l.prototype.Me=function(){if(this.left.B())return l.EMPTY;var o=this;return o.left.Oe()||o.left.left.Oe()||(o=o.xe()),(o=o.me(null,null,null,o.left.Me(),null)).Le()},l.prototype.remove=function(o,s){var c,h=this;if(s(o,h.key)<0)h.left.B()||h.left.Oe()||h.left.left.Oe()||(h=h.xe()),h=h.me(null,null,null,h.left.remove(o,s),null);else{if(h.left.Oe()&&(h=h.Be()),h.right.B()||h.right.Oe()||h.right.left.Oe()||(h=h.qe()),s(o,h.key)===0){if(h.right.B())return l.EMPTY;c=h.right.min(),h=h.me(c.key,c.value,null,null,h.right.Me())}h=h.me(null,null,null,null,h.right.remove(o,s))}return h.Le()},l.prototype.Oe=function(){return this.color},l.prototype.Le=function(){var o=this;return o.right.Oe()&&!o.left.Oe()&&(o=o.Ue()),o.left.Oe()&&o.left.left.Oe()&&(o=o.Be()),o.left.Oe()&&o.right.Oe()&&(o=o.Qe()),o},l.prototype.xe=function(){var o=this.Qe();return o.right.left.Oe()&&(o=(o=(o=o.me(null,null,null,null,o.right.Be())).Ue()).Qe()),o},l.prototype.qe=function(){var o=this.Qe();return o.left.left.Oe()&&(o=(o=o.Be()).Qe()),o},l.prototype.Ue=function(){var o=this.me(null,null,l.RED,null,this.right.left);return this.right.me(null,null,this.color,o,null)},l.prototype.Be=function(){var o=this.me(null,null,l.RED,this.left.right,null);return this.left.me(null,null,this.color,null,o)},l.prototype.Qe=function(){var o=this.left.me(null,null,!this.left.color,null,null),s=this.right.me(null,null,!this.right.color,null,null);return this.me(null,null,!this.color,o,s)},l.prototype.We=function(){var o=this.je();return Math.pow(2,o)<=this.size+1},l.prototype.je=function(){if(this.Oe()&&this.left.Oe()||this.right.Oe())throw xe();var o=this.left.je();if(o!==this.right.je())throw xe();return o+(this.Oe()?0:1)},l}();Kt.EMPTY=null,Kt.RED=!0,Kt.Pe=!1,Kt.EMPTY=new(function(){function l(){this.size=0}return Object.defineProperty(l.prototype,"key",{get:function(){throw xe()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"value",{get:function(){throw xe()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"color",{get:function(){throw xe()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"left",{get:function(){throw xe()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"right",{get:function(){throw xe()},enumerable:!0,configurable:!0}),l.prototype.me=function(o,s,c,h,d){return this},l.prototype.Ae=function(o,s,c){return new Kt(o,s)},l.prototype.remove=function(o,s){return this},l.prototype.B=function(){return!0},l.prototype.pe=function(o){return!1},l.prototype.ye=function(o){return!1},l.prototype.Ve=function(){return null},l.prototype.ge=function(){return null},l.prototype.Oe=function(){return!1},l.prototype.We=function(){return!0},l.prototype.je=function(){return 0},l}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt=function(){function l(o){this.N=o,this.data=new Wt(this.N)}return l.prototype.has=function(o){return this.data.get(o)!==null},l.prototype.first=function(){return this.data.Ve()},l.prototype.last=function(){return this.data.ge()},Object.defineProperty(l.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),l.prototype.indexOf=function(o){return this.data.indexOf(o)},l.prototype.forEach=function(o){this.data.pe(function(s,c){return o(s),!1})},l.prototype.Ke=function(o,s){for(var c=this.data.ve(o[0]);c.$e();){var h=c.Ne();if(this.N(h.key,o[1])>=0)return;s(h.key)}},l.prototype.Ge=function(o,s){var c;for(c=s!==void 0?this.data.ve(s):this.data.be();c.$e();)if(!o(c.Ne().key))return},l.prototype.ze=function(o){var s=this.data.ve(o);return s.$e()?s.Ne().key:null},l.prototype.be=function(){return new $t(this.data.be())},l.prototype.ve=function(o){return new $t(this.data.ve(o))},l.prototype.add=function(o){return this.me(this.data.remove(o).Ae(o,!0))},l.prototype.delete=function(o){return this.has(o)?this.me(this.data.remove(o)):this},l.prototype.B=function(){return this.data.B()},l.prototype.He=function(o){var s=this;return s.size<o.size&&(s=o,o=this),o.forEach(function(c){s=s.add(c)}),s},l.prototype.isEqual=function(o){if(!(o instanceof l)||this.size!==o.size)return!1;for(var s=this.data.be(),c=o.data.be();s.$e();){var h=s.Ne().key,d=c.Ne().key;if(this.N(h,d)!==0)return!1}return!0},l.prototype.W=function(){var o=[];return this.forEach(function(s){o.push(s)}),o},l.prototype.toString=function(){var o=[];return this.forEach(function(s){return o.push(s)}),"SortedSet("+o.toString()+")"},l.prototype.me=function(o){var s=new l(this.N);return s.data=o,s},l}(),$t=function(){function l(o){this.Ye=o}return l.prototype.Ne=function(){return this.Ye.Ne().key},l.prototype.$e=function(){return this.Ye.$e()},l}(),Jt=new Wt(L$1.N);function Ht(){return Jt}function Xt(){return Ht()}var Zt=new Wt(L$1.N);function te(){return Zt}var ee=new Wt(L$1.N);function ne(){return ee}var re$1=new Yt(L$1.N);function ie(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];for(var s=re$1,c=0,h=l;c<h.length;c++){var d=h[c];s=s.add(d)}return s}var oe=new Yt(Pe);function se(){return oe}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ue=function(){function l(o){this.N=o?function(s,c){return o(s,c)||L$1.N(s.key,c.key)}:function(s,c){return L$1.N(s.key,c.key)},this.Je=te(),this.Xe=new Wt(this.N)}return l.Ze=function(o){return new l(o.N)},l.prototype.has=function(o){return this.Je.get(o)!=null},l.prototype.get=function(o){return this.Je.get(o)},l.prototype.first=function(){return this.Xe.Ve()},l.prototype.last=function(){return this.Xe.ge()},l.prototype.B=function(){return this.Xe.B()},l.prototype.indexOf=function(o){var s=this.Je.get(o);return s?this.Xe.indexOf(s):-1},Object.defineProperty(l.prototype,"size",{get:function(){return this.Xe.size},enumerable:!0,configurable:!0}),l.prototype.forEach=function(o){this.Xe.pe(function(s,c){return o(s),!1})},l.prototype.add=function(o){var s=this.delete(o.key);return s.me(s.Je.Ae(o.key,o),s.Xe.Ae(o,null))},l.prototype.delete=function(o){var s=this.get(o);return s?this.me(this.Je.remove(o),this.Xe.remove(s)):this},l.prototype.isEqual=function(o){if(!(o instanceof l)||this.size!==o.size)return!1;for(var s=this.Xe.be(),c=o.Xe.be();s.$e();){var h=s.Ne().key,d=c.Ne().key;if(!h.isEqual(d))return!1}return!0},l.prototype.toString=function(){var o=[];return this.forEach(function(s){o.push(s.toString())}),o.length===0?"DocumentSet ()":`DocumentSet (
  `+o.join(`  
`)+`
)`},l.prototype.me=function(o,s){var c=new l;return c.N=this.N,c.Je=o,c.Xe=s,c},l}(),ae=function(){function l(){this.ts=new Wt(L$1.N)}return l.prototype.track=function(o){var s=o.doc.key,c=this.ts.get(s);c?o.type!==0&&c.type===3?this.ts=this.ts.Ae(s,o):o.type===3&&c.type!==1?this.ts=this.ts.Ae(s,{type:c.type,doc:o.doc}):o.type===2&&c.type===2?this.ts=this.ts.Ae(s,{type:2,doc:o.doc}):o.type===2&&c.type===0?this.ts=this.ts.Ae(s,{type:0,doc:o.doc}):o.type===1&&c.type===0?this.ts=this.ts.remove(s):o.type===1&&c.type===2?this.ts=this.ts.Ae(s,{type:1,doc:c.doc}):o.type===0&&c.type===1?this.ts=this.ts.Ae(s,{type:2,doc:o.doc}):xe():this.ts=this.ts.Ae(s,o)},l.prototype.es=function(){var o=[];return this.ts.pe(function(s,c){o.push(c)}),o},l}(),he=function(){function l(o,s,c,h,d,p,Co,Bo){this.query=o,this.docs=s,this.ss=c,this.docChanges=h,this.ns=d,this.fromCache=p,this.rs=Co,this.hs=Bo}return l.os=function(o,s,c,h){var d=[];return s.forEach(function(p){d.push({type:0,doc:p})}),new l(o,s,ue.Ze(s),d,c,h,!0,!1)},Object.defineProperty(l.prototype,"hasPendingWrites",{get:function(){return!this.ns.B()},enumerable:!0,configurable:!0}),l.prototype.isEqual=function(o){if(!(this.fromCache===o.fromCache&&this.rs===o.rs&&this.ns.isEqual(o.ns)&&this.query.isEqual(o.query)&&this.docs.isEqual(o.docs)&&this.ss.isEqual(o.ss)))return!1;var s=this.docChanges,c=o.docChanges;if(s.length!==c.length)return!1;for(var h=0;h<s.length;h++)if(s[h].type!==c[h].type||!s[h].doc.isEqual(c[h].doc))return!1;return!0},l}(),ce=function(){function l(o,s,c,h,d){this.Ee=o,this.as=s,this.us=c,this.cs=h,this._s=d}return l.ls=function(o,s){var c=new Map;return c.set(o,fe.ds(o,s)),new l(x.min(),c,se(),Ht(),ie())},l}(),fe=function(){function l(o,s,c,h,d){this.resumeToken=o,this.fs=s,this.Ts=c,this.Es=h,this.Is=d}return l.ds=function(o,s){return new l(q.ht,s,ie(),ie(),ie())},l}(),le=function(l,o,s,c){this.ws=l,this.removedTargetIds=o,this.key=s,this.Rs=c},pe=function(l,o){this.targetId=l,this.As=o},de=function(l,o,s,c){s===void 0&&(s=q.ht),c===void 0&&(c=null),this.state=l,this.targetIds=o,this.resumeToken=s,this.cause=c},ye=function(){function l(){this.ms=0,this.Ps=ge(),this.Vs=q.ht,this.gs=!1,this.ps=!0}return Object.defineProperty(l.prototype,"fs",{get:function(){return this.gs},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"ys",{get:function(){return this.ms!==0},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"bs",{get:function(){return this.ps},enumerable:!0,configurable:!0}),l.prototype.vs=function(o){o.rt()>0&&(this.ps=!0,this.Vs=o)},l.prototype.Ss=function(){var o=ie(),s=ie(),c=ie();return this.Ps.forEach(function(h,d){switch(d){case 0:o=o.add(h);break;case 2:s=s.add(h);break;case 1:c=c.add(h);break;default:xe()}}),new fe(this.Vs,this.gs,o,s,c)},l.prototype.Ds=function(){this.ps=!1,this.Ps=ge()},l.prototype.Cs=function(o,s){this.ps=!0,this.Ps=this.Ps.Ae(o,s)},l.prototype.Fs=function(o){this.ps=!0,this.Ps=this.Ps.remove(o)},l.prototype.Ns=function(){this.ms+=1},l.prototype.$s=function(){this.ms-=1},l.prototype.ks=function(){this.ps=!0,this.gs=!0},l}(),ve=function(){function l(o){this.Ls=o,this.Ms=new Map,this.Os=Ht(),this.xs=me(),this.Bs=new Yt(Pe)}return l.prototype.qs=function(o){for(var s=0,c=o.ws;s<c.length;s++){var h=c[s];o.Rs instanceof Dt?this.Us(h,o.Rs):o.Rs instanceof St&&this.Qs(h,o.key,o.Rs)}for(var d=0,p=o.removedTargetIds;d<p.length;d++){var Co=p[d];this.Qs(Co,o.key,o.Rs)}},l.prototype.Ws=function(o){var s=this;this.js(o,function(c){var h=s.Ks(c);switch(o.state){case 0:s.Gs(c)&&h.vs(o.resumeToken);break;case 1:h.$s(),h.ys||h.Ds(),h.vs(o.resumeToken);break;case 2:h.$s(),h.ys||s.removeTarget(c);break;case 3:s.Gs(c)&&(h.ks(),h.vs(o.resumeToken));break;case 4:s.Gs(c)&&(s.zs(c),h.vs(o.resumeToken));break;default:xe()}})},l.prototype.js=function(o,s){var c=this;o.targetIds.length>0?o.targetIds.forEach(s):this.Ms.forEach(function(h,d){c.Gs(d)&&s(d)})},l.prototype.Hs=function(o){var s=o.targetId,c=o.As.count,h=this.Ys(s);if(h){var d=h.target;if(d.Ot())if(c===0){var p=new L$1(d.path);this.Qs(s,p,new St(p,x.min()))}else Re(c===1);else this.Js(s)!==c&&(this.zs(s),this.Bs=this.Bs.add(s))}},l.prototype.Xs=function(o){var s=this,c=new Map;this.Ms.forEach(function(p,Co){var Bo=s.Ys(Co);if(Bo){if(p.fs&&Bo.target.Ot()){var Lo=new L$1(Bo.target.path);s.Os.get(Lo)!==null||s.Zs(Co,Lo)||s.Qs(Co,Lo,new St(Lo,o))}p.bs&&(c.set(Co,p.Ss()),p.Ds())}});var h=ie();this.xs.forEach(function(p,Co){var Bo=!0;Co.Ge(function(Lo){var Uo=s.Ys(Lo);return!Uo||Uo.Te===2||(Bo=!1,!1)}),Bo&&(h=h.add(p))});var d=new ce(o,c,this.Bs,this.Os,h);return this.Os=Ht(),this.xs=me(),this.Bs=new Yt(Pe),d},l.prototype.Us=function(o,s){if(this.Gs(o)){var c=this.Zs(o,s.key)?2:0;this.Ks(o).Cs(s.key,c),this.Os=this.Os.Ae(s.key,s),this.xs=this.xs.Ae(s.key,this.ti(s.key).add(o))}},l.prototype.Qs=function(o,s,c){if(this.Gs(o)){var h=this.Ks(o);this.Zs(o,s)?h.Cs(s,1):h.Fs(s),this.xs=this.xs.Ae(s,this.ti(s).delete(o)),c&&(this.Os=this.Os.Ae(s,c))}},l.prototype.removeTarget=function(o){this.Ms.delete(o)},l.prototype.Js=function(o){var s=this.Ks(o).Ss();return this.Ls.ei(o).size+s.Ts.size-s.Is.size},l.prototype.Ns=function(o){this.Ks(o).Ns()},l.prototype.Ks=function(o){var s=this.Ms.get(o);return s||(s=new ye,this.Ms.set(o,s)),s},l.prototype.ti=function(o){var s=this.xs.get(o);return s||(s=new Yt(Pe),this.xs=this.xs.Ae(o,s)),s},l.prototype.Gs=function(o){var s=this.Ys(o)!==null;return s||ke("WatchChangeAggregator","Detected inactive target",o),s},l.prototype.Ys=function(o){var s=this.Ms.get(o);return s&&s.ys?null:this.Ls.si(o)},l.prototype.zs=function(o){var s=this;this.Ms.set(o,new ye),this.Ls.ei(o).forEach(function(c){s.Qs(o,c,null)})},l.prototype.Zs=function(o,s){return this.Ls.ei(o).has(s)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(){return new Wt(L$1.N)}function ge(){return new Wt(L$1.N)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var we={asc:"ASCENDING",desc:"DESCENDING"},Ee={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},be=function(){function l(o,s){this.ii=o,this.options=s}return l.prototype.ni=function(o){var s=o.code===void 0?T$1.UNKNOWN:Gt(o.code);return new I(s,o.message||"")},l.prototype.ri=function(o){return this.options.hi||j(o)?o:{value:o}},l.prototype.oi=function(o){var s;return j(s=typeof o=="object"?o.value:o)?null:s},l.prototype._t=function(o){return{integerValue:""+o}},l.prototype.lt=function(o){if(this.options.hi){if(isNaN(o))return{doubleValue:"NaN"};if(o===1/0)return{doubleValue:"Infinity"};if(o===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:F$1(o)?"-0":o}},l.prototype.ai=function(o){return B(o)?this._t(o):this.lt(o)},l.prototype.C=function(o){return this.options.hi?new Date(1e3*o.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+o.nanoseconds).slice(-9)+"Z":{seconds:""+o.seconds,nanos:o.nanoseconds}},l.prototype.v=function(o){var s=X(o);return new S(s.seconds,s.nanos)},l.prototype.ui=function(o){return this.options.hi?o.toBase64():o.toUint8Array()},l.prototype.ci=function(o){return this.options.hi?(Re(o===void 0||typeof o=="string"),q.fromBase64String(o||"")):(Re(o===void 0||o instanceof Uint8Array),q.fromUint8Array(o||new Uint8Array))},l.prototype.toVersion=function(o){return this.C(o.C())},l.prototype.fromVersion=function(o){return Re(!!o),x.v(this.v(o))},l.prototype._i=function(o,s){return this.li(s||this.ii).child("documents").child(o).j()},l.prototype.di=function(o){var s=V$1.K(o);return Re(Te(s)),s},l.prototype.fi=function(o){return this._i(o.path)},l.prototype.Z=function(o){var s=this.di(o);return Re(s.get(1)===this.ii.projectId),Re(!s.get(3)&&!this.ii.database||s.get(3)===this.ii.database),new L$1(this.Ti(s))},l.prototype.Ei=function(o){return this._i(o)},l.prototype.Ii=function(o){var s=this.di(o);return s.length===4?V$1.G:this.Ti(s)},Object.defineProperty(l.prototype,"wi",{get:function(){return new V$1(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),l.prototype.li=function(o){return new V$1(["projects",o.projectId,"databases",o.database])},l.prototype.Ti=function(o){return Re(o.length>4&&o.get(4)==="documents"),o.k(5)},l.prototype.Ri=function(o,s){return{name:this.fi(o),fields:s.proto.mapValue.fields}},l.prototype.Ai=function(o){return{name:this.fi(o.key),fields:o.Lt().mapValue.fields,updateTime:this.C(o.version.C())}},l.prototype.mi=function(o,s){var c=this.Z(o.name),h=this.fromVersion(o.updateTime),d=new Tt({mapValue:{fields:o.fields}});return new Dt(c,h,d,{hasCommittedMutations:!!s})},l.prototype.Pi=function(o){Re(!!o.found),o.found.name,o.found.updateTime;var s=this.Z(o.found.name),c=this.fromVersion(o.found.updateTime),h=new Tt({mapValue:{fields:o.found.fields}});return new Dt(s,c,h,{})},l.prototype.Vi=function(o){Re(!!o.missing),Re(!!o.readTime);var s=this.Z(o.missing),c=this.fromVersion(o.readTime);return new St(s,c)},l.prototype.gi=function(o){return"found"in o?this.Pi(o):"missing"in o?this.Vi(o):xe()},l.prototype.pi=function(o){var s;if("targetChange"in o){o.targetChange;var c=this.yi(o.targetChange.targetChangeType||"NO_CHANGE"),h=o.targetChange.targetIds||[],d=this.ci(o.targetChange.resumeToken),p=o.targetChange.cause,Co=p&&this.ni(p);s=new de(c,h,d,Co||null)}else if("documentChange"in o){o.documentChange;var Bo=o.documentChange;Bo.document,Bo.document.name,Bo.document.updateTime;var Lo=this.Z(Bo.document.name),Uo=this.fromVersion(Bo.document.updateTime),Qo=new Tt({mapValue:{fields:Bo.document.fields}}),Po=new Dt(Lo,Uo,Qo,{}),Mo=Bo.targetIds||[],Go=Bo.removedTargetIds||[];s=new le(Mo,Go,Po.key,Po)}else if("documentDelete"in o){o.documentDelete;var $o=o.documentDelete;$o.document;var jo=this.Z($o.document),zo=$o.readTime?this.fromVersion($o.readTime):x.min(),Xo=new St(jo,zo),Zo=$o.removedTargetIds||[];s=new le([],Zo,Xo.key,Xo)}else if("documentRemove"in o){o.documentRemove;var Wo=o.documentRemove;Wo.document;var es=this.Z(Wo.document),is=Wo.removedTargetIds||[];s=new le([],is,es,null)}else{if(!("filter"in o))return xe();o.filter;var Jo=o.filter;Jo.targetId;var Ko=Jo.count||0,Yo=new Bt(Ko),ts=Jo.targetId;s=new pe(ts,Yo)}return s},l.prototype.yi=function(o){return o==="NO_CHANGE"?0:o==="ADD"?1:o==="REMOVE"?2:o==="CURRENT"?3:o==="RESET"?4:xe()},l.prototype.bi=function(o){if(!("targetChange"in o))return x.min();var s=o.targetChange;return s.targetIds&&s.targetIds.length?x.min():s.readTime?this.fromVersion(s.readTime):x.min()},l.prototype.vi=function(o){var s,c=this;if(o instanceof mt)s={update:this.Ri(o.key,o.value)};else if(o instanceof Et)s={delete:this.fi(o.key)};else if(o instanceof gt)s={update:this.Ri(o.key,o.data),updateMask:this.Si(o.Vt)};else if(o instanceof wt)s={transform:{document:this.fi(o.key),fieldTransforms:o.fieldTransforms.map(function(h){return c.Di(h)})}};else{if(!(o instanceof bt))return xe();s={verify:this.fi(o.key)}}return o.Rt.Tt||(s.currentDocument=this.Ci(o.Rt)),s},l.prototype.Fi=function(o){var s=this,c=o.currentDocument?this.Ni(o.currentDocument):yt.ft();if(o.update){o.update.name;var h=this.Z(o.update.name),d=new Tt({mapValue:{fields:o.update.fields}});if(o.updateMask){var p=this.$i(o.updateMask);return new gt(h,d,p,c)}return new mt(h,d,c)}if(o.delete){var Co=this.Z(o.delete);return new Et(Co,c)}if(o.transform){var Bo=this.Z(o.transform.document),Lo=o.transform.fieldTransforms.map(function(Qo){return s.ki(Qo)});return Re(c.exists===!0),new wt(Bo,Lo)}if(o.verify){var Uo=this.Z(o.verify);return new bt(Uo,c)}return xe()},l.prototype.Ci=function(o){return o.updateTime!==void 0?{updateTime:this.toVersion(o.updateTime)}:o.exists!==void 0?{exists:o.exists}:xe()},l.prototype.Ni=function(o){return o.updateTime!==void 0?yt.updateTime(this.fromVersion(o.updateTime)):o.exists!==void 0?yt.exists(o.exists):yt.ft()},l.prototype.Li=function(o,s){var c=o.updateTime?this.fromVersion(o.updateTime):this.fromVersion(s);c.isEqual(x.min())&&(c=this.fromVersion(s));var h=null;return o.transformResults&&o.transformResults.length>0&&(h=o.transformResults),new dt(c,h)},l.prototype.Mi=function(o,s){var c=this;return o&&o.length>0?(Re(s!==void 0),o.map(function(h){return c.Li(h,s)})):[]},l.prototype.Di=function(o){var s=o.transform;if(s instanceof ut)return{fieldPath:o.field.j(),setToServerValue:"REQUEST_TIME"};if(s instanceof at)return{fieldPath:o.field.j(),appendMissingElements:{values:s.elements}};if(s instanceof ht)return{fieldPath:o.field.j(),removeAllFromArray:{values:s.elements}};if(s instanceof ct)return{fieldPath:o.field.j(),increment:s.ct};throw xe()},l.prototype.ki=function(o){var s=null;if("setToServerValue"in o)Re(o.setToServerValue==="REQUEST_TIME"),s=ut.instance;else if("appendMissingElements"in o){var c=o.appendMissingElements.values||[];s=new at(c)}else if("removeAllFromArray"in o){var h=o.removeAllFromArray.values||[];s=new ht(h)}else"increment"in o?s=new ct(this,o.increment):xe();var d=P.X(o.fieldPath);return new pt(d,s)},l.prototype.Oi=function(o){return{documents:[this.Ei(o.path)]}},l.prototype.xi=function(o){Re(o.documents.length===1);var s=o.documents[0];return Vt.Wt(this.Ii(s)).ee()},l.prototype.Bi=function(o){var s={structuredQuery:{}},c=o.path;o.collectionGroup!==null?(s.parent=this.Ei(c),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=this.Ei(c.L()),s.structuredQuery.from=[{collectionId:c.O()}]);var h=this.qi(o.filters);h&&(s.structuredQuery.where=h);var d=this.Ui(o.orderBy);d&&(s.structuredQuery.orderBy=d);var p=this.ri(o.limit);return p!==null&&(s.structuredQuery.limit=p),o.startAt&&(s.structuredQuery.startAt=this.Qi(o.startAt)),o.endAt&&(s.structuredQuery.endAt=this.Qi(o.endAt)),s},l.prototype.Wi=function(o){var s=this.Ii(o.parent),c=o.structuredQuery,h=c.from?c.from.length:0,d=null;if(h>0){Re(h===1);var p=c.from[0];p.allDescendants?d=p.collectionId:s=s.child(p.collectionId)}var Co=[];c.where&&(Co=this.ji(c.where));var Bo=[];c.orderBy&&(Bo=this.Ki(c.orderBy));var Lo=null;c.limit&&(Lo=this.oi(c.limit));var Uo=null;c.startAt&&(Uo=this.Gi(c.startAt));var Qo=null;return c.endAt&&(Qo=this.Gi(c.endAt)),new Vt(s,d,Bo,Co,Lo,"F",Uo,Qo).ee()},l.prototype.zi=function(o){var s=this.Hi(o.Te);return s==null?null:{"goog-listen-tags":s}},l.prototype.Hi=function(o){switch(o){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xe()}},l.prototype.ee=function(o){var s,c=o.target;return(s=c.Ot()?{documents:this.Oi(c)}:{query:this.Bi(c)}).targetId=o.targetId,o.resumeToken.rt()>0&&(s.resumeToken=this.ui(o.resumeToken)),s},l.prototype.qi=function(o){var s=this;if(o.length!==0){var c=o.map(function(h){return h instanceof Ot?s.Yi(h):xe()});return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}},l.prototype.ji=function(o){var s=this;return o?o.unaryFilter!==void 0?[this.Ji(o)]:o.fieldFilter!==void 0?[this.Xi(o)]:o.compositeFilter!==void 0?o.compositeFilter.filters.map(function(c){return s.ji(c)}).reduce(function(c,h){return c.concat(h)}):xe():[]},l.prototype.Ui=function(o){var s=this;if(o.length!==0)return o.map(function(c){return s.Zi(c)})},l.prototype.Ki=function(o){var s=this;return o.map(function(c){return s.tn(c)})},l.prototype.Qi=function(o){return{before:o.before,values:o.position}},l.prototype.Gi=function(o){var s=!!o.before,c=o.values||[];return new qt(c,s)},l.prototype.en=function(o){return we[o]},l.prototype.sn=function(o){switch(o){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},l.prototype.nn=function(o){return Ee[o]},l.prototype.rn=function(o){switch(o){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return xe()}},l.prototype.hn=function(o){return{fieldPath:o.j()}},l.prototype.on=function(o){return P.X(o.fieldPath)},l.prototype.Zi=function(o){return{field:this.hn(o.field),direction:this.en(o.dir)}},l.prototype.tn=function(o){return new jt(this.on(o.field),this.sn(o.direction))},l.prototype.Xi=function(o){return Ot.create(this.on(o.fieldFilter.field),this.rn(o.fieldFilter.op),o.fieldFilter.value)},l.prototype.Yi=function(o){if(o.op==="=="){if(ot(o.value))return{unaryFilter:{field:this.hn(o.field),op:"IS_NAN"}};if(it(o.value))return{unaryFilter:{field:this.hn(o.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(o.field),op:this.nn(o.op),value:o.value}}},l.prototype.Ji=function(o){switch(o.unaryFilter.op){case"IS_NAN":var s=this.on(o.unaryFilter.field);return Ot.create(s,"==",{doubleValue:NaN});case"IS_NULL":var c=this.on(o.unaryFilter.field);return Ot.create(c,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return xe()}},l.prototype.Si=function(o){var s=[];return o.fields.forEach(function(c){return s.push(c.j())}),{fieldPaths:s}},l.prototype.$i=function(o){var s=o.fieldPaths||[];return new lt(s.map(function(c){return P.X(c)}))},l}();function Te(l){return l.length>=4&&l.get(0)==="projects"&&l.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie=function(){function l(){}return l.an=function(o){l.platform&&xe(),l.platform=o},l.nt=function(){return l.platform||xe(),l.platform},l}(),Ne=new Logger$1("@firebase/firestore");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(){return Ne.logLevel}function _e(l){Ne.logLevel=l}function ke(l){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];if(Ne.logLevel<=LogLevel.DEBUG){var c=o.map(Se);Ne.debug.apply(Ne,__spreadArrays$1(["Firestore ("+E$1+"): "+l],c))}}function De(l){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];if(Ne.logLevel<=LogLevel.ERROR){var c=o.map(Se);Ne.error.apply(Ne,__spreadArrays$1(["Firestore ("+E$1+"): "+l],c))}}function Se(l){if(typeof l=="string")return l;var o=Ie.nt();try{return o.un(l)}catch{return l}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(l){l===void 0&&(l="Unexpected state");var o="FIRESTORE ("+E$1+") INTERNAL ASSERTION FAILED: "+l;throw De(o),new Error(o)}function Re(l,o){l||xe()}function Ve(l,o){return l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oe=function(){function l(){}return l.cn=function(){for(var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=Math.floor(256/o.length)*o.length,c="";c.length<20;)for(var h=Ie.nt()._n(40),d=0;d<h.length;++d)c.length<20&&h[d]<s&&(c+=o.charAt(h[d]%o.length));return c},l}();function Pe(l,o){return l<o?-1:l>o?1:0}function Le(l,o,s){return l.length===o.length&&l.every(function(c,h){return s(c,o[h])})}function Ue(l){return l+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce=function(l,o,s,c,h){this.ii=l,this.persistenceKey=o,this.host=s,this.ssl=c,this.forceLongPolling=h},Me=function(){function l(o,s){this.projectId=o,this.database=s||"(default)"}return Object.defineProperty(l.prototype,"ln",{get:function(){return this.database==="(default)"},enumerable:!0,configurable:!0}),l.prototype.isEqual=function(o){return o instanceof l&&o.projectId===this.projectId&&o.database===this.database},l.prototype.S=function(o){return Pe(this.projectId,o.projectId)||Pe(this.database,o.database)},l}(),qe=function(){function l(o){this.dn=o,this.fn={}}return l.prototype.get=function(o){var s=this.dn(o),c=this.fn[s];if(c!==void 0)for(var h=0,d=c;h<d.length;h++){var p=d[h],Co=p[0],Bo=p[1];if(Co.isEqual(o))return Bo}},l.prototype.has=function(o){return this.get(o)!==void 0},l.prototype.set=function(o,s){var c=this.dn(o),h=this.fn[c];if(h!==void 0){for(var d=0;d<h.length;d++)if(h[d][0].isEqual(o))return void(h[d]=[o,s]);h.push([o,s])}else this.fn[c]=[[o,s]]},l.prototype.delete=function(o){var s=this.dn(o),c=this.fn[s];if(c===void 0)return!1;for(var h=0;h<c.length;h++)if(c[h][0].isEqual(o))return c.length===1?delete this.fn[s]:c.splice(h,1),!0;return!1},l.prototype.forEach=function(o){C(this.fn,function(s,c){for(var h=0,d=c;h<d.length;h++){var p=d[h],Co=p[0],Bo=p[1];o(Co,Bo)}})},l.prototype.B=function(){return M(this.fn)},l}(),je=function(){function l(o,s,c,h){this.batchId=o,this.Tn=s,this.baseMutations=c,this.mutations=h}return l.prototype.at=function(o,s,c){for(var h=c.En,d=0;d<this.mutations.length;d++){var p=this.mutations[d];if(p.key.isEqual(o)){var Co=h[d];s=p.at(s,Co)}}return s},l.prototype.ot=function(o,s){for(var c=0,h=this.baseMutations;c<h.length;c++){var d=h[c];d.key.isEqual(o)&&(s=d.ot(s,s,this.Tn))}for(var p=s,Co=0,Bo=this.mutations;Co<Bo.length;Co++){var Lo=Bo[Co];Lo.key.isEqual(o)&&(s=Lo.ot(s,p,this.Tn))}return s},l.prototype.In=function(o){var s=this,c=o;return this.mutations.forEach(function(h){var d=s.ot(h.key,o.get(h.key));d&&(c=c.Ae(h.key,d))}),c},l.prototype.keys=function(){return this.mutations.reduce(function(o,s){return o.add(s.key)},ie())},l.prototype.isEqual=function(o){return this.batchId===o.batchId&&Le(this.mutations,o.mutations,function(s,c){return s.isEqual(c)})&&Le(this.baseMutations,o.baseMutations,function(s,c){return s.isEqual(c)})},l}(),Fe=function(){function l(o,s,c,h,d){this.batch=o,this.wn=s,this.En=c,this.streamToken=h,this.Rn=d}return l.from=function(o,s,c,h){Re(o.mutations.length===c.length);for(var d=ne(),p=o.mutations,Co=0;Co<p.length;Co++)d=d.Ae(p[Co].key,c[Co].version);return new l(o,s,c,h,d)},l}(),Be=function(){function l(o){var s=this;this.An=null,this.mn=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,o(function(c){s.Pn=!0,s.result=c,s.An&&s.An(c)},function(c){s.Pn=!0,s.error=c,s.mn&&s.mn(c)})}return l.prototype.catch=function(o){return this.next(void 0,o)},l.prototype.next=function(o,s){var c=this;return this.Vn&&xe(),this.Vn=!0,this.Pn?this.error?this.gn(s,this.error):this.pn(o,this.result):new l(function(h,d){c.An=function(p){c.pn(o,p).next(h,d)},c.mn=function(p){c.gn(s,p).next(h,d)}})},l.prototype.yn=function(){var o=this;return new Promise(function(s,c){o.next(s,c)})},l.prototype.bn=function(o){try{var s=o();return s instanceof l?s:l.resolve(s)}catch(c){return l.reject(c)}},l.prototype.pn=function(o,s){return o?this.bn(function(){return o(s)}):l.resolve(s)},l.prototype.gn=function(o,s){return o?this.bn(function(){return o(s)}):l.reject(s)},l.resolve=function(o){return new l(function(s,c){s(o)})},l.reject=function(o){return new l(function(s,c){c(o)})},l.vn=function(o){return new l(function(s,c){var h=0,d=0,p=!1;o.forEach(function(Co){++h,Co.next(function(){++d,p&&d===h&&s()},function(Bo){return c(Bo)})}),p=!0,d===h&&s()})},l.Sn=function(o){for(var s=l.resolve(!1),c=function(p){s=s.next(function(Co){return Co?l.resolve(Co):p()})},h=0,d=o;h<d.length;h++)c(d[h]);return s},l.forEach=function(o,s){var c=this,h=[];return o.forEach(function(d,p){h.push(s.call(c,d,p))}),this.vn(h)},l}(),ze=function(){function l(){this.Dn=new qe(function(o){return o.toString()}),this.Cn=!1}return Object.defineProperty(l.prototype,"readTime",{get:function(){return this.Fn},set:function(o){this.Fn=o},enumerable:!0,configurable:!0}),l.prototype.Nn=function(o,s){this.$n(),this.readTime=s,this.Dn.set(o.key,o)},l.prototype.kn=function(o,s){this.$n(),s&&(this.readTime=s),this.Dn.set(o,null)},l.prototype.Ln=function(o,s){this.$n();var c=this.Dn.get(s);return c!==void 0?Be.resolve(c):this.Mn(o,s)},l.prototype.getEntries=function(o,s){return this.On(o,s)},l.prototype.apply=function(o){return this.$n(),this.Cn=!0,this.xn(o)},l.prototype.$n=function(){},l}(),Ge="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",We=function(){function l(){this.Bn=[]}return l.prototype.qn=function(o){this.Bn.push(o)},l.prototype.Un=function(){this.Bn.forEach(function(o){return o()})},l}(),Qe=function(){function l(o,s,c){this.Qn=o,this.Wn=s,this.jn=c}return l.prototype.Kn=function(o,s){var c=this;return this.Wn.Gn(o,s).next(function(h){return c.zn(o,s,h)})},l.prototype.zn=function(o,s,c){return this.Qn.Ln(o,s).next(function(h){for(var d=0,p=c;d<p.length;d++)h=p[d].ot(s,h);return h})},l.prototype.Hn=function(o,s,c){var h=Xt();return s.forEach(function(d,p){for(var Co=0,Bo=c;Co<Bo.length;Co++)p=Bo[Co].ot(d,p);h=h.Ae(d,p)}),h},l.prototype.Yn=function(o,s){var c=this;return this.Qn.getEntries(o,s).next(function(h){return c.Jn(o,h)})},l.prototype.Jn=function(o,s){var c=this;return this.Wn.Xn(o,s).next(function(h){var d=c.Hn(o,s,h),p=Ht();return d.forEach(function(Co,Bo){Bo||(Bo=new St(Co,x.min())),p=p.Ae(Co,Bo)}),p})},l.prototype.Zn=function(o,s,c){return s.Ot()?this.tr(o,s.path):s._e()?this.er(o,s,c):this.sr(o,s,c)},l.prototype.tr=function(o,s){return this.Kn(o,new L$1(s)).next(function(c){var h=te();return c instanceof Dt&&(h=h.Ae(c.key,c)),h})},l.prototype.er=function(o,s,c){var h=this,d=s.collectionGroup,p=te();return this.jn.ir(o,d).next(function(Co){return Be.forEach(Co,function(Bo){var Lo=s.Zt(Bo.child(d));return h.sr(o,Lo,c).next(function(Uo){Uo.forEach(function(Qo,Po){p=p.Ae(Qo,Po)})})}).next(function(){return p})})},l.prototype.sr=function(o,s,c){var h,d,p=this;return this.Qn.Zn(o,s,c).next(function(Co){return h=Co,p.Wn.nr(o,s)}).next(function(Co){return d=Co,p.rr(o,d,h).next(function(Bo){h=Bo;for(var Lo=0,Uo=d;Lo<Uo.length;Lo++)for(var Qo=Uo[Lo],Po=0,Mo=Qo.mutations;Po<Mo.length;Po++){var Go=Mo[Po],$o=Go.key,jo=h.get($o),zo=Go.ot(jo,jo,Qo.Tn);h=zo instanceof Dt?h.Ae($o,zo):h.remove($o)}})}).next(function(){return h.forEach(function(Co,Bo){s.matches(Bo)||(h=h.remove(Co))}),h})},l.prototype.rr=function(o,s,c){for(var h=ie(),d=0,p=s;d<p.length;d++)for(var Co=0,Bo=p[d].mutations;Co<Bo.length;Co++){var Lo=Bo[Co];Lo instanceof gt&&c.get(Lo.key)===null&&(h=h.add(Lo.key))}var Uo=c;return this.Qn.getEntries(o,h).next(function(Qo){return Qo.forEach(function(Po,Mo){Mo!==null&&Mo instanceof Dt&&(Uo=Uo.Ae(Po,Mo))}),Uo})},l}(),Ke=function(){function l(o,s,c,h){this.targetId=o,this.fromCache=s,this.hr=c,this.or=h}return l.ar=function(o,s){for(var c=ie(),h=ie(),d=0,p=s.docChanges;d<p.length;d++){var Co=p[d];switch(Co.type){case 0:c=c.add(Co.doc.key);break;case 1:h=h.add(Co.doc.key)}}return new l(o,s.fromCache,c,h)},l}(),Ye=function(){function l(o,s){var c=this;this.previousValue=o,s&&(s.ur=function(h){return c.cr(h)},this._r=function(h){return s.lr(h)})}return l.prototype.cr=function(o){return this.previousValue=Math.max(o,this.previousValue),this.previousValue},l.prototype.next=function(){var o=++this.previousValue;return this._r&&this._r(o),o},l}();Ye.dr=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $e=function(){var l=this;this.promise=new Promise(function(o,s){l.resolve=o,l.reject=s})},Je=function(){function l(o,s,c,h,d){c===void 0&&(c=1e3),h===void 0&&(h=1.5),d===void 0&&(d=6e4),this.Tr=o,this.Er=s,this.Ir=c,this.wr=h,this.Rr=d,this.Ar=0,this.mr=null,this.Pr=Date.now(),this.reset()}return l.prototype.reset=function(){this.Ar=0},l.prototype.Vr=function(){this.Ar=this.Rr},l.prototype.gr=function(o){var s=this;this.cancel();var c=Math.floor(this.Ar+this.pr()),h=Math.max(0,Date.now()-this.Pr),d=Math.max(0,c-h);d>0&&ke("ExponentialBackoff","Backing off for "+d+" ms (base delay: "+this.Ar+" ms, delay with jitter: "+c+" ms, last attempt: "+h+" ms ago)"),this.mr=this.Tr.yr(this.Er,d,function(){return s.Pr=Date.now(),o()}),this.Ar*=this.wr,this.Ar<this.Ir&&(this.Ar=this.Ir),this.Ar>this.Rr&&(this.Ar=this.Rr)},l.prototype.br=function(){this.mr!==null&&(this.mr.vr(),this.mr=null)},l.prototype.cancel=function(){this.mr!==null&&(this.mr.cancel(),this.mr=null)},l.prototype.pr=function(){return(Math.random()-.5)*this.Ar},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function He(l){for(var o="",s=0;s<l.length;s++)o.length>0&&(o=Ze(o)),o=Xe(l.get(s),o);return Ze(o)}function Xe(l,o){for(var s=o,c=l.length,h=0;h<c;h++){var d=l.charAt(h);switch(d){case"\0":s+="";break;case"":s+="";break;default:s+=d}}return s}function Ze(l){return l+""}function tn(l){var o=l.length;if(Re(o>=2),o===2)return Re(l.charAt(0)===""&&l.charAt(1)===""),V$1.G;for(var s=o-2,c=[],h="",d=0;d<o;){var p=l.indexOf("",d);switch((p<0||p>s)&&xe(),l.charAt(p+1)){case"":var Co=l.substring(d,p),Bo=void 0;h.length===0?Bo=Co:(Bo=h+=Co,h=""),c.push(Bo);break;case"":h+=l.substring(d,p),h+="\0";break;case"":h+=l.substring(d,p+1);break;default:xe()}d=p+2}return new V$1(c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var en=function(){function l(){this.Sr=new nn}return l.prototype.Dr=function(o,s){return this.Sr.add(s),Be.resolve()},l.prototype.ir=function(o,s){return Be.resolve(this.Sr.getEntries(s))},l}(),nn=function(){function l(){this.index={}}return l.prototype.add=function(o){var s=o.O(),c=o.L(),h=this.index[s]||new Yt(V$1.N),d=!h.has(c);return this.index[s]=h.add(c),d},l.prototype.has=function(o){var s=o.O(),c=o.L(),h=this.index[s];return h&&h.has(c)},l.prototype.getEntries=function(o){return(this.index[o]||new Yt(V$1.N)).W()},l}(),rn=function(){function l(){this.Cr=new nn}return l.prototype.Dr=function(o,s){var c=this;if(!this.Cr.has(s)){var h=s.O(),d=s.L();o.qn(function(){c.Cr.add(s)});var p={collectionId:h,parent:He(d)};return on(o).put(p)}return Be.resolve()},l.prototype.ir=function(o,s){var c=[],h=IDBKeyRange.bound([s,""],[Ue(s),""],!1,!0);return on(o).Fr(h).next(function(d){for(var p=0,Co=d;p<Co.length;p++){var Bo=Co[p];if(Bo.collectionId!==s)break;c.push(tn(Bo.parent))}return c})},l}();function on(l){return wn.Nr(l,Gn.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sn=function(){function l(o,s){this.serializer=o,this.jn=s}return l.prototype.Nn=function(o,s,c){return an(o).put(hn(s),c)},l.prototype.kn=function(o,s){var c=an(o),h=hn(s);return c.delete(h)},l.prototype.updateMetadata=function(o,s){var c=this;return this.getMetadata(o).next(function(h){return h.byteSize+=s,c.$r(o,h)})},l.prototype.Ln=function(o,s){var c=this;return an(o).get(hn(s)).next(function(h){return c.kr(h)})},l.prototype.Lr=function(o,s){var c=this;return an(o).get(hn(s)).next(function(h){var d=c.kr(h);return d?{Mr:d,size:cn(h)}:null})},l.prototype.getEntries=function(o,s){var c=this,h=Xt();return this.Or(o,s,function(d,p){var Co=c.kr(p);h=h.Ae(d,Co)}).next(function(){return h})},l.prototype.xr=function(o,s){var c=this,h=Xt(),d=new Wt(L$1.N);return this.Or(o,s,function(p,Co){var Bo=c.kr(Co);Bo?(h=h.Ae(p,Bo),d=d.Ae(p,cn(Co))):(h=h.Ae(p,null),d=d.Ae(p,0))}).next(function(){return{Br:h,qr:d}})},l.prototype.Or=function(o,s,c){if(s.B())return Be.resolve();var h=IDBKeyRange.bound(s.first().path.W(),s.last().path.W()),d=s.be(),p=d.Ne();return an(o).Ur({range:h},function(Co,Bo,Lo){for(var Uo=L$1.st(Co);p&&L$1.N(p,Uo)<0;)c(p,null),p=d.Ne();p&&p.isEqual(Uo)&&(c(p,Bo),p=d.$e()?d.Ne():null),p?Lo.Qr(p.path.W()):Lo.done()}).next(function(){for(;p;)c(p,null),p=d.$e()?d.Ne():null})},l.prototype.Zn=function(o,s,c){var h=this,d=te(),p=s.path.length+1,Co={};if(c.isEqual(x.min())){var Bo=s.path.W();Co.range=IDBKeyRange.lowerBound(Bo)}else{var Lo=s.path.W(),Uo=this.serializer.Wr(c);Co.range=IDBKeyRange.lowerBound([Lo,Uo],!0),Co.index=qn.collectionReadTimeIndex}return an(o).Ur(Co,function(Qo,Po,Mo){if(Qo.length===p){var Go=h.serializer.jr(Po);s.path.q(Go.key.path)?Go instanceof Dt&&s.matches(Go)&&(d=d.Ae(Go.key,Go)):Mo.done()}}).next(function(){return d})},l.prototype.Kr=function(o,s){var c=this,h=Ht(),d=this.serializer.Wr(s),p=an(o),Co=IDBKeyRange.lowerBound(d,!0);return p.Ur({index:qn.readTimeIndex,range:Co},function(Bo,Lo){var Uo=c.serializer.jr(Lo);h=h.Ae(Uo.key,Uo),d=Lo.readTime}).next(function(){return{Gr:h,readTime:c.serializer.zr(d)}})},l.prototype.Hr=function(o){var s=this,c=an(o),h=x.min();return c.Ur({index:qn.readTimeIndex,reverse:!0},function(d,p,Co){p.readTime&&(h=s.serializer.zr(p.readTime)),Co.done()}).next(function(){return h})},l.prototype.Yr=function(o){return new l.Jr(this,!!o&&o.Xr)},l.prototype.Zr=function(o){return this.getMetadata(o).next(function(s){return s.byteSize})},l.prototype.getMetadata=function(o){return un(o).get(jn.key).next(function(s){return Re(!!s),s})},l.prototype.$r=function(o,s){return un(o).put(jn.key,s)},l.prototype.kr=function(o){if(o){var s=this.serializer.jr(o);return s instanceof St&&s.version.isEqual(x.min())?null:s}return null},l}();function un(l){return wn.Nr(l,jn.store)}function an(l){return wn.Nr(l,qn.store)}function hn(l){return l.path.W()}function cn(l){var o;if(l.document)o=l.document;else if(l.unknownDocument)o=l.unknownDocument;else{if(!l.noDocument)throw xe();o=l.noDocument}return JSON.stringify(o).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.Jr=function(l){function o(s,c){var h=this;return(h=l.call(this)||this).th=s,h.Xr=c,h.eh=new qe(function(d){return d.toString()}),h}return __extends$1(o,l),o.prototype.xn=function(s){var c=this,h=[],d=0,p=new Yt(function(Co,Bo){return Pe(Co.j(),Bo.j())});return this.Dn.forEach(function(Co,Bo){var Lo=c.eh.get(Co);if(Bo){var Uo=c.th.serializer.sh(Bo,c.readTime);p=p.add(Co.path.L());var Qo=cn(Uo);d+=Qo-Lo,h.push(c.th.Nn(s,Co,Uo))}else if(d-=Lo,c.Xr){var Po=c.th.serializer.sh(new St(Co,x.min()),c.readTime);h.push(c.th.Nn(s,Co,Po))}else h.push(c.th.kn(s,Co))}),p.forEach(function(Co){h.push(c.th.jn.Dr(s,Co))}),h.push(this.th.updateMetadata(s,d)),Be.vn(h)},o.prototype.Mn=function(s,c){var h=this;return this.th.Lr(s,c).next(function(d){return d===null?(h.eh.set(c,0),null):(h.eh.set(c,d.size),d.Mr)})},o.prototype.On=function(s,c){var h=this;return this.th.xr(s,c).next(function(d){var p=d.Br;return d.qr.forEach(function(Co,Bo){h.eh.set(Co,Bo)}),p})},o}(ze);var fn=function(){function l(o){this.ih=o}return l.prototype.next=function(){return this.ih+=2,this.ih},l.nh=function(){return new l(0)},l.rh=function(){return new l(-1)},l}(),ln=function(){function l(o,s){this.hh=o,this.serializer=s}return l.prototype.oh=function(o){var s=this;return this.ah(o).next(function(c){var h=new fn(c.highestTargetId);return c.highestTargetId=h.next(),s.uh(o,c).next(function(){return c.highestTargetId})})},l.prototype._h=function(o){return this.ah(o).next(function(s){return x.v(new S(s.lastRemoteSnapshotVersion.seconds,s.lastRemoteSnapshotVersion.nanoseconds))})},l.prototype.lh=function(o){return this.ah(o).next(function(s){return s.highestListenSequenceNumber})},l.prototype.dh=function(o,s,c){var h=this;return this.ah(o).next(function(d){return d.highestListenSequenceNumber=s,c&&(d.lastRemoteSnapshotVersion=c.C()),s>d.highestListenSequenceNumber&&(d.highestListenSequenceNumber=s),h.uh(o,d)})},l.prototype.fh=function(o,s){var c=this;return this.Th(o,s).next(function(){return c.ah(o).next(function(h){return h.targetCount+=1,c.Eh(s,h),c.uh(o,h)})})},l.prototype.Ih=function(o,s){return this.Th(o,s)},l.prototype.wh=function(o,s){var c=this;return this.Rh(o,s.targetId).next(function(){return pn(o).delete(s.targetId)}).next(function(){return c.ah(o)}).next(function(h){return Re(h.targetCount>0),h.targetCount-=1,c.uh(o,h)})},l.prototype.Ah=function(o,s,c){var h=this,d=0,p=[];return pn(o).Ur(function(Co,Bo){var Lo=h.serializer.mh(Bo);Lo.sequenceNumber<=s&&c.get(Lo.targetId)===null&&(d++,p.push(h.wh(o,Lo)))}).next(function(){return Be.vn(p)}).next(function(){return d})},l.prototype.js=function(o,s){var c=this;return pn(o).Ur(function(h,d){var p=c.serializer.mh(d);s(p)})},l.prototype.ah=function(o){return dn(o).get(zn.key).next(function(s){return Re(s!==null),s})},l.prototype.uh=function(o,s){return dn(o).put(zn.key,s)},l.prototype.Th=function(o,s){return pn(o).put(this.serializer.Ph(s))},l.prototype.Eh=function(o,s){var c=!1;return o.targetId>s.highestTargetId&&(s.highestTargetId=o.targetId,c=!0),o.sequenceNumber>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=o.sequenceNumber,c=!0),c},l.prototype.Vh=function(o){return this.ah(o).next(function(s){return s.targetCount})},l.prototype.gh=function(o,s){var c=this,h=s.canonicalId(),d=IDBKeyRange.bound([h,Number.NEGATIVE_INFINITY],[h,Number.POSITIVE_INFINITY]),p=null;return pn(o).Ur({range:d,index:Fn.queryTargetsIndexName},function(Co,Bo,Lo){var Uo=c.serializer.mh(Bo);s.isEqual(Uo.target)&&(p=Uo,Lo.done())}).next(function(){return p})},l.prototype.ph=function(o,s,c){var h=this,d=[],p=yn(o);return s.forEach(function(Co){var Bo=He(Co.path);d.push(p.put(new Bn(c,Bo))),d.push(h.hh.yh(o,c,Co))}),Be.vn(d)},l.prototype.bh=function(o,s,c){var h=this,d=yn(o);return Be.forEach(s,function(p){var Co=He(p.path);return Be.vn([d.delete([c,Co]),h.hh.vh(o,c,p)])})},l.prototype.Rh=function(o,s){var c=yn(o),h=IDBKeyRange.bound([s],[s+1],!1,!0);return c.delete(h)},l.prototype.Sh=function(o,s){var c=IDBKeyRange.bound([s],[s+1],!1,!0),h=yn(o),d=ie();return h.Ur({range:c,Dh:!0},function(p,Co,Bo){var Lo=tn(p[1]),Uo=new L$1(Lo);d=d.add(Uo)}).next(function(){return d})},l.prototype.Ch=function(o,s){var c=He(s.path),h=IDBKeyRange.bound([c],[Ue(c)],!1,!0),d=0;return yn(o).Ur({index:Bn.documentTargetsIndex,Dh:!0,range:h},function(p,Co,Bo){var Lo=p[0];p[1],Lo!==0&&(d++,Bo.done())}).next(function(){return d>0})},l.prototype.si=function(o,s){var c=this;return pn(o).get(s).next(function(h){return h?c.serializer.mh(h):null})},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(l){return wn.Nr(l,Fn.store)}function dn(l){return wn.Nr(l,zn.store)}function yn(l){return wn.Nr(l,Bn.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vn=function(){function l(o){this.Fh=o}return l.prototype.jr=function(o){if(o.document)return this.Fh.mi(o.document,!!o.hasCommittedMutations);if(o.noDocument){var s=L$1.st(o.noDocument.path),c=this.Nh(o.noDocument.readTime);return new St(s,c,{hasCommittedMutations:!!o.hasCommittedMutations})}if(o.unknownDocument){var h=L$1.st(o.unknownDocument.path),d=this.Nh(o.unknownDocument.version);return new xt(h,d)}return xe()},l.prototype.sh=function(o,s){var c=this.Wr(s),h=o.key.path.L().W();if(o instanceof Dt){var d=this.Fh.Ai(o),p=o.hasCommittedMutations;return new qn(null,null,d,p,c,h)}if(o instanceof St){var Co=o.key.path.W(),Bo=this.$h(o.version),Lo=o.hasCommittedMutations;return new qn(null,new Cn(Co,Bo),null,Lo,c,h)}if(o instanceof xt){var Uo=o.key.path.W(),Qo=this.$h(o.version);return new qn(new Mn(Uo,Qo),null,null,!0,c,h)}return xe()},l.prototype.Wr=function(o){var s=o.C();return[s.seconds,s.nanoseconds]},l.prototype.zr=function(o){var s=new S(o[0],o[1]);return x.v(s)},l.prototype.$h=function(o){var s=o.C();return new Vn(s.seconds,s.nanoseconds)},l.prototype.Nh=function(o){var s=new S(o.seconds,o.nanoseconds);return x.v(s)},l.prototype.kh=function(o,s){var c=this,h=s.baseMutations.map(function(p){return c.Fh.vi(p)}),d=s.mutations.map(function(p){return c.Fh.vi(p)});return new Ln(o,s.batchId,s.Tn.toMillis(),h,d)},l.prototype.Lh=function(o){var s=this,c=(o.baseMutations||[]).map(function(p){return s.Fh.Fi(p)}),h=o.mutations.map(function(p){return s.Fh.Fi(p)}),d=S.fromMillis(o.localWriteTimeMs);return new je(o.batchId,d,c,h)},l.prototype.mh=function(o){var s,c=this.Nh(o.readTime),h=o.lastLimboFreeSnapshotVersion!==void 0?this.Nh(o.lastLimboFreeSnapshotVersion):x.min();return s=o.query.documents!==void 0?this.Fh.xi(o.query):this.Fh.Wi(o.query),new Ft(s,o.targetId,0,o.lastListenSequenceNumber,c,h,q.fromBase64String(o.resumeToken))},l.prototype.Ph=function(o){var s,c=this.$h(o.Ee),h=this.$h(o.lastLimboFreeSnapshotVersion);s=o.target.Ot()?this.Fh.Oi(o.target):this.Fh.Bi(o.target);var d=o.resumeToken.toBase64();return new Fn(o.targetId,o.target.canonicalId(),c,d,o.sequenceNumber,h,s)},l}(),mn="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",gn=function(l){function o(s,c){var h=this;return(h=l.call(this)||this).Mh=s,h.Oh=c,h}return __extends$1(o,l),o}(We),wn=function(){function l(o,s,c,h,d,p,Co,Bo){if(this.allowTabSynchronization=o,this.persistenceKey=s,this.clientId=c,this.Tr=p,this.xh=Bo,this.Bh=null,this.qh=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Uh=null,this.inForeground=!1,this.Qh=null,this.Wh=null,this.jh=Number.NEGATIVE_INFINITY,this.Kh=function(Lo){return Promise.resolve()},!l.Gh())throw new I(T$1.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");if(this.hh=new Tn(this,d),this.zh=s+l.Hh,this.serializer=new vn(Co),this.document=h.document,this.Yh=new ln(this.hh,this.serializer),this.jn=new rn,this.Qn=new sn(this.serializer,this.jn),!h.window||!h.window.localStorage)throw new I(T$1.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=h.window,this.Jh=this.window.localStorage}return l.Nr=function(o,s){if(o instanceof gn)return Yn.Nr(o.Mh,s);throw xe()},l.prototype.start=function(){var o=this;return Yn.Xh(this.zh,xn,new Rn(this.serializer)).then(function(s){return o.Zh=s,o.to()}).then(function(){if(!o.isPrimary&&!o.allowTabSynchronization)throw new I(T$1.FAILED_PRECONDITION,mn);return o.eo(),o.so(),o.io(),o.runTransaction("getHighestListenSequenceNumber","readonly",function(s){return o.Yh.lh(s)})}).then(function(s){o.Bh=new Ye(s,o.xh)}).then(function(){o.qh=!0}).catch(function(s){return o.Zh&&o.Zh.close(),Promise.reject(s)})},l.prototype.no=function(o){var s=this;return this.Kh=function(c){return __awaiter$1(s,void 0,void 0,function(){return __generator$1(this,function(h){return this.ro?[2,o(c)]:[2]})})},o(this.isPrimary)},l.prototype.ho=function(o){var s=this;this.Zh.oo(function(c){return __awaiter$1(s,void 0,void 0,function(){return __generator$1(this,function(h){switch(h.label){case 0:return c.newVersion===null?[4,o()]:[3,2];case 1:h.sent(),h.label=2;case 2:return[2]}})})})},l.prototype.ao=function(o){var s=this;this.networkEnabled!==o&&(this.networkEnabled=o,this.Tr.uo(function(){return __awaiter$1(s,void 0,void 0,function(){return __generator$1(this,function(c){switch(c.label){case 0:return this.ro?[4,this.to()]:[3,2];case 1:c.sent(),c.label=2;case 2:return[2]}})})}))},l.prototype.to=function(){var o=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(s){return bn(s).put(new Qn(o.clientId,Date.now(),o.networkEnabled,o.inForeground)).next(function(){if(o.isPrimary)return o.co(s).next(function(c){c||(o.isPrimary=!1,o.Tr.uo(function(){return o.Kh(!1)}))})}).next(function(){return o._o(s)}).next(function(c){return o.isPrimary&&!c?o.lo(s).next(function(){return!1}):!!c&&o.do(s).next(function(){return!0})})}).catch(function(s){if(!o.allowTabSynchronization){if(Hn(s))return ke("IndexedDbPersistence","Failed to extend owner lease: ",s),o.isPrimary;throw s}return ke("IndexedDbPersistence","Releasing owner lease after error during lease refresh",s),!1}).then(function(s){o.isPrimary!==s&&o.Tr.uo(function(){return o.Kh(s)}),o.isPrimary=s})},l.prototype.co=function(o){var s=this;return En(o).get(On.key).next(function(c){return Be.resolve(s.fo(c))})},l.prototype.To=function(o){return bn(o).delete(this.clientId)},l.prototype.Eo=function(){return __awaiter$1(this,void 0,void 0,function(){var o=this;return __generator$1(this,function(s){switch(s.label){case 0:return!this.isPrimary||this.Io(this.jh,18e5)?[3,2]:(this.jh=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(c){var h=l.Nr(c,Qn.store);return h.Fr().next(function(d){var p=o.wo(d,18e5),Co=d.filter(function(Bo){return p.indexOf(Bo)===-1});return Be.forEach(Co,function(Bo){return h.delete(Bo.clientId)}).next(function(){return Co})})}).catch(function(){return[]})]);case 1:s.sent().forEach(function(c){o.window.localStorage.removeItem(o.Ro(c.clientId))}),s.label=2;case 2:return[2]}})})},l.prototype.io=function(){var o=this;this.Wh=this.Tr.yr("client_metadata_refresh",4e3,function(){return o.to().then(function(){return o.Eo()}).then(function(){return o.io()})})},l.prototype.fo=function(o){return!!o&&o.ownerId===this.clientId},l.prototype._o=function(o){var s=this;return En(o).get(On.key).next(function(c){if(c!==null&&s.Io(c.leaseTimestampMs,5e3)&&!s.Ao(c.ownerId)){if(s.fo(c)&&s.networkEnabled)return!0;if(!s.fo(c)){if(!c.allowTabSynchronization)throw new I(T$1.FAILED_PRECONDITION,mn);return!1}}return!(!s.networkEnabled||!s.inForeground)||bn(o).Fr().next(function(h){return s.wo(h,5e3).find(function(d){if(s.clientId!==d.clientId){var p=!s.networkEnabled&&d.networkEnabled,Co=!s.inForeground&&d.inForeground,Bo=s.networkEnabled===d.networkEnabled;if(p||Co&&Bo)return!0}return!1})===void 0})}).next(function(c){return s.isPrimary!==c&&ke("IndexedDbPersistence","Client "+(c?"is":"is not")+" eligible for a primary lease."),c})},l.prototype.mo=function(){return __awaiter$1(this,void 0,void 0,function(){var o=this;return __generator$1(this,function(s){switch(s.label){case 0:return this.qh=!1,this.Po(),this.Wh&&(this.Wh.cancel(),this.Wh=null),this.Vo(),this.po(),[4,this.runTransaction("shutdown","readwrite",function(c){return o.lo(c).next(function(){return o.To(c)})}).catch(function(c){ke("IndexedDbPersistence","Proceeding with shutdown despite failure: ",c)})];case 1:return s.sent(),this.Zh.close(),this.yo(),[2]}})})},l.prototype.wo=function(o,s){var c=this;return o.filter(function(h){return c.Io(h.updateTimeMs,s)&&!c.Ao(h.clientId)})},l.prototype.bo=function(){var o=this;return this.runTransaction("getActiveClients","readonly",function(s){return bn(s).Fr().next(function(c){return o.wo(c,18e5).map(function(h){return h.clientId})})})},l.clearPersistence=function(o){return __awaiter$1(this,void 0,void 0,function(){var s;return __generator$1(this,function(c){switch(c.label){case 0:return l.Gh()?(s=o+l.Hh,[4,Yn.delete(s)]):[2,Promise.resolve()];case 1:return c.sent(),[2]}})})},Object.defineProperty(l.prototype,"ro",{get:function(){return this.qh},enumerable:!0,configurable:!0}),l.prototype.vo=function(o){return Nn.So(o,this.serializer,this.jn,this.hh)},l.prototype.Do=function(){return this.Yh},l.prototype.Co=function(){return this.Qn},l.prototype.Fo=function(){return this.jn},l.prototype.runTransaction=function(o,s,c){var h=this;ke("IndexedDbPersistence","Starting transaction:",o);var d,p=s==="readonly"?"readonly":"readwrite";return this.Zh.runTransaction(p,Kn,function(Co){return d=new gn(Co,h.Bh?h.Bh.next():Ye.dr),s==="readwrite-primary"?h.co(d).next(function(Bo){return!!Bo||h._o(d)}).next(function(Bo){if(!Bo)throw De("Failed to obtain primary lease for action '"+o+"'."),h.isPrimary=!1,h.Tr.uo(function(){return h.Kh(!1)}),new I(T$1.FAILED_PRECONDITION,Ge);return c(d)}).next(function(Bo){return h.do(d).next(function(){return Bo})}):h.No(d).next(function(){return c(d)})}).then(function(Co){return d.Un(),Co})},l.prototype.No=function(o){var s=this;return En(o).get(On.key).next(function(c){if(c!==null&&s.Io(c.leaseTimestampMs,5e3)&&!s.Ao(c.ownerId)&&!s.fo(c)&&(!s.allowTabSynchronization||!c.allowTabSynchronization))throw new I(T$1.FAILED_PRECONDITION,mn)})},l.prototype.do=function(o){var s=new On(this.clientId,this.allowTabSynchronization,Date.now());return En(o).put(On.key,s)},l.Gh=function(){return Yn.Gh()},l.$o=function(o){var s=o.ii.projectId;return o.ii.ln||(s+="."+o.ii.database),"firestore/"+o.persistenceKey+"/"+s+"/"},l.prototype.lo=function(o){var s=this,c=En(o);return c.get(On.key).next(function(h){return s.fo(h)?(ke("IndexedDbPersistence","Releasing primary lease."),c.delete(On.key)):Be.resolve()})},l.prototype.Io=function(o,s){var c=Date.now();return!(o<c-s||o>c&&(De("Detected an update time that is in the future: "+o+" > "+c),1))},l.prototype.eo=function(){var o=this;this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Qh=function(){o.Tr.uo(function(){return o.inForeground=o.document.visibilityState==="visible",o.to()})},this.document.addEventListener("visibilitychange",this.Qh),this.inForeground=this.document.visibilityState==="visible")},l.prototype.Vo=function(){this.Qh&&(this.document.removeEventListener("visibilitychange",this.Qh),this.Qh=null)},l.prototype.so=function(){var o=this;typeof this.window.addEventListener=="function"&&(this.Uh=function(){o.Po(),o.Tr.uo(function(){return o.mo()})},this.window.addEventListener("unload",this.Uh))},l.prototype.po=function(){this.Uh&&(this.window.removeEventListener("unload",this.Uh),this.Uh=null)},l.prototype.Ao=function(o){try{var s=this.Jh.getItem(this.Ro(o))!==null;return ke("IndexedDbPersistence","Client '"+o+"' "+(s?"is":"is not")+" zombied in LocalStorage"),s}catch(c){return De("IndexedDbPersistence","Failed to get zombied client id.",c),!1}},l.prototype.Po=function(){try{this.Jh.setItem(this.Ro(this.clientId),String(Date.now()))}catch(o){De("Failed to set zombie client id.",o)}},l.prototype.yo=function(){try{this.Jh.removeItem(this.Ro(this.clientId))}catch{}},l.prototype.Ro=function(o){return"firestore_zombie_"+this.persistenceKey+"_"+o},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function En(l){return wn.Nr(l,On.store)}function bn(l){return wn.Nr(l,Qn.store)}wn.Hh="main";var Tn=function(){function l(o,s){this.db=o,this.ko=new fr(this,s)}return l.prototype.Lo=function(o){var s=this.Mo(o);return this.db.Do().Vh(o).next(function(c){return s.next(function(h){return c+h})})},l.prototype.Mo=function(o){var s=0;return this.Oo(o,function(c){s++}).next(function(){return s})},l.prototype.js=function(o,s){return this.db.Do().js(o,s)},l.prototype.Oo=function(o,s){return this.xo(o,function(c,h){return s(h)})},l.prototype.yh=function(o,s,c){return In(o,c)},l.prototype.vh=function(o,s,c){return In(o,c)},l.prototype.Ah=function(o,s,c){return this.db.Do().Ah(o,s,c)},l.prototype.Bo=function(o,s){return In(o,s)},l.prototype.qo=function(o,s){return function(c,h){var d=!1;return Sn(c).Uo(function(p){return An(c,p,h).next(function(Co){return Co&&(d=!0),Be.resolve(!Co)})}).next(function(){return d})}(o,s)},l.prototype.Qo=function(o,s){var c=this,h=this.db.Co().Yr(),d=[],p=0;return this.xo(o,function(Co,Bo){if(Bo<=s){var Lo=c.qo(o,Co).next(function(Uo){if(!Uo)return p++,h.Ln(o,Co).next(function(){return h.kn(Co),yn(o).delete([0,He(Co.path)])})});d.push(Lo)}}).next(function(){return Be.vn(d)}).next(function(){return h.apply(o)}).next(function(){return p})},l.prototype.removeTarget=function(o,s){var c=s.Ie(o.Oh);return this.db.Do().Ih(o,c)},l.prototype.Wo=function(o,s){return In(o,s)},l.prototype.xo=function(o,s){var c,h=yn(o),d=Ye.dr;return h.Ur({index:Bn.documentTargetsIndex},function(p,Co){var Bo=p[0],Lo=(p[1],Co.path),Uo=Co.sequenceNumber;Bo===0?(d!==Ye.dr&&s(new L$1(tn(c)),d),d=Uo,c=Lo):d=Ye.dr}).next(function(){d!==Ye.dr&&s(new L$1(tn(c)),d)})},l.prototype.jo=function(o){return this.db.Co().Zr(o)},l}();function In(l,o){return yn(l).put(function(s,c){return new Bn(0,He(s.path),c)}(o,l.Oh))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nn=function(){function l(o,s,c,h){this.userId=o,this.serializer=s,this.jn=c,this.hh=h,this.Ko={}}return l.So=function(o,s,c,h){return Re(o.uid!==""),new l(o.t()?o.uid:"",s,c,h)},l.prototype.Go=function(o){var s=!0,c=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kn(o).Ur({index:Ln.userMutationsIndex,range:c},function(h,d,p){s=!1,p.done()}).next(function(){return s})},l.prototype.zo=function(o,s,c){return this.Ho(o).next(function(h){return h.lastStreamToken=c.toBase64(),Sn(o).put(h)})},l.prototype.Yo=function(o){return this.Ho(o).next(function(s){return q.fromBase64String(s.lastStreamToken)})},l.prototype.Jo=function(o,s){return this.Ho(o).next(function(c){return c.lastStreamToken=s.toBase64(),Sn(o).put(c)})},l.prototype.Xo=function(o,s,c,h){var d=this,p=Dn(o),Co=kn(o);return Co.add({}).next(function(Bo){Re(typeof Bo=="number");for(var Lo=new je(Bo,s,c,h),Uo=d.serializer.kh(d.userId,Lo),Qo=[],Po=new Yt(function(zo,Xo){return Pe(zo.j(),Xo.j())}),Mo=0,Go=h;Mo<Go.length;Mo++){var $o=Go[Mo],jo=Un.key(d.userId,$o.key.path,Bo);Po=Po.add($o.key.path.L()),Qo.push(Co.put(Uo)),Qo.push(p.put(jo,Un.PLACEHOLDER))}return Po.forEach(function(zo){Qo.push(d.jn.Dr(o,zo))}),o.qn(function(){d.Ko[Bo]=Lo.keys()}),Be.vn(Qo).next(function(){return Lo})})},l.prototype.Zo=function(o,s){var c=this;return kn(o).get(s).next(function(h){return h?(Re(h.userId===c.userId),c.serializer.Lh(h)):null})},l.prototype.ta=function(o,s){var c=this;return this.Ko[s]?Be.resolve(this.Ko[s]):this.Zo(o,s).next(function(h){if(h){var d=h.keys();return c.Ko[s]=d,d}return null})},l.prototype.ea=function(o,s){var c=this,h=s+1,d=IDBKeyRange.lowerBound([this.userId,h]),p=null;return kn(o).Ur({index:Ln.userMutationsIndex,range:d},function(Co,Bo,Lo){Bo.userId===c.userId&&(Re(Bo.batchId>=h),p=c.serializer.Lh(Bo)),Lo.done()}).next(function(){return p})},l.prototype.sa=function(o){var s=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),c=-1;return kn(o).Ur({index:Ln.userMutationsIndex,range:s,reverse:!0},function(h,d,p){c=d.batchId,p.done()}).next(function(){return c})},l.prototype.ia=function(o){var s=this,c=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return kn(o).Fr(Ln.userMutationsIndex,c).next(function(h){return h.map(function(d){return s.serializer.Lh(d)})})},l.prototype.Gn=function(o,s){var c=this,h=Un.prefixForPath(this.userId,s.path),d=IDBKeyRange.lowerBound(h),p=[];return Dn(o).Ur({range:d},function(Co,Bo,Lo){var Uo=Co[0],Qo=Co[1],Po=Co[2],Mo=tn(Qo);if(Uo===c.userId&&s.path.isEqual(Mo))return kn(o).get(Po).next(function(Go){if(!Go)throw xe();Re(Go.userId===c.userId),p.push(c.serializer.Lh(Go))});Lo.done()}).next(function(){return p})},l.prototype.Xn=function(o,s){var c=this,h=new Yt(Pe),d=[];return s.forEach(function(p){var Co=Un.prefixForPath(c.userId,p.path),Bo=IDBKeyRange.lowerBound(Co),Lo=Dn(o).Ur({range:Bo},function(Uo,Qo,Po){var Mo=Uo[0],Go=Uo[1],$o=Uo[2],jo=tn(Go);Mo===c.userId&&p.path.isEqual(jo)?h=h.add($o):Po.done()});d.push(Lo)}),Be.vn(d).next(function(){return c.na(o,h)})},l.prototype.nr=function(o,s){var c=this,h=s.path,d=h.length+1,p=Un.prefixForPath(this.userId,h),Co=IDBKeyRange.lowerBound(p),Bo=new Yt(Pe);return Dn(o).Ur({range:Co},function(Lo,Uo,Qo){var Po=Lo[0],Mo=Lo[1],Go=Lo[2],$o=tn(Mo);Po===c.userId&&h.q($o)?$o.length===d&&(Bo=Bo.add(Go)):Qo.done()}).next(function(){return c.na(o,Bo)})},l.prototype.na=function(o,s){var c=this,h=[],d=[];return s.forEach(function(p){d.push(kn(o).get(p).next(function(Co){if(Co===null)throw xe();Re(Co.userId===c.userId),h.push(c.serializer.Lh(Co))}))}),Be.vn(d).next(function(){return h})},l.prototype.ra=function(o,s){var c=this;return _n(o.Mh,this.userId,s).next(function(h){return o.qn(function(){c.ha(s.batchId)}),Be.forEach(h,function(d){return c.hh.Bo(o,d)})})},l.prototype.ha=function(o){delete this.Ko[o]},l.prototype.oa=function(o){var s=this;return this.Go(o).next(function(c){if(!c)return Be.resolve();var h=IDBKeyRange.lowerBound(Un.prefixForUser(s.userId)),d=[];return Dn(o).Ur({range:h},function(p,Co,Bo){if(p[0]===s.userId){var Lo=tn(p[1]);d.push(Lo)}else Bo.done()}).next(function(){Re(d.length===0)})})},l.prototype.Ch=function(o,s){return An(o,this.userId,s)},l.prototype.Ho=function(o){var s=this;return Sn(o).get(this.userId).next(function(c){return c||new Pn(s.userId,-1,"")})},l}();function An(l,o,s){var c=Un.prefixForPath(o,s.path),h=c[1],d=IDBKeyRange.lowerBound(c),p=!1;return Dn(l).Ur({range:d,Dh:!0},function(Co,Bo,Lo){var Uo=Co[0],Qo=Co[1];Co[2],Uo===o&&Qo===h&&(p=!0),Lo.done()}).next(function(){return p})}function _n(l,o,s){var c=l.store(Ln.store),h=l.store(Un.store),d=[],p=IDBKeyRange.only(s.batchId),Co=0,Bo=c.Ur({range:p},function(Go,$o,jo){return Co++,jo.delete()});d.push(Bo.next(function(){Re(Co===1)}));for(var Lo=[],Uo=0,Qo=s.mutations;Uo<Qo.length;Uo++){var Po=Qo[Uo],Mo=Un.key(o,Po.key.path,s.batchId);d.push(h.delete(Mo)),Lo.push(Po.key)}return Be.vn(d).next(function(){return Lo})}function kn(l){return wn.Nr(l,Ln.store)}function Dn(l){return wn.Nr(l,Un.store)}function Sn(l){return wn.Nr(l,Pn.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xn=10,Rn=function(){function l(o){this.serializer=o}return l.prototype.createOrUpgrade=function(o,s,c,h){var d=this;Re(c<h&&c>=0&&h<=xn);var p=new Xn(s);c<1&&h>=1&&(function(Bo){Bo.createObjectStore(On.store)}(o),function(Bo){Bo.createObjectStore(Pn.store,{keyPath:Pn.keyPath}),Bo.createObjectStore(Ln.store,{keyPath:Ln.keyPath,autoIncrement:!0}).createIndex(Ln.userMutationsIndex,Ln.userMutationsKeyPath,{unique:!0}),Bo.createObjectStore(Un.store)}(o),Wn(o),function(Bo){Bo.createObjectStore(qn.store)}(o));var Co=Be.resolve();return c<3&&h>=3&&(c!==0&&(function(Bo){Bo.deleteObjectStore(Bn.store),Bo.deleteObjectStore(Fn.store),Bo.deleteObjectStore(zn.store)}(o),Wn(o)),Co=Co.next(function(){return function(Bo){var Lo=Bo.store(zn.store),Uo=new zn(0,0,x.min().C(),0);return Lo.put(zn.key,Uo)}(p)})),c<4&&h>=4&&(c!==0&&(Co=Co.next(function(){return function(Bo,Lo){return Lo.store(Ln.store).Fr().next(function(Uo){Bo.deleteObjectStore(Ln.store),Bo.createObjectStore(Ln.store,{keyPath:Ln.keyPath,autoIncrement:!0}).createIndex(Ln.userMutationsIndex,Ln.userMutationsKeyPath,{unique:!0});var Qo=Lo.store(Ln.store),Po=Uo.map(function(Mo){return Qo.put(Mo)});return Be.vn(Po)})}(o,p)})),Co=Co.next(function(){(function(Bo){Bo.createObjectStore(Qn.store,{keyPath:Qn.keyPath})})(o)})),c<5&&h>=5&&(Co=Co.next(function(){return d.removeAcknowledgedMutations(p)})),c<6&&h>=6&&(Co=Co.next(function(){return function(Bo){Bo.createObjectStore(jn.store)}(o),d.addDocumentGlobal(p)})),c<7&&h>=7&&(Co=Co.next(function(){return d.ensureSequenceNumbers(p)})),c<8&&h>=8&&(Co=Co.next(function(){return d.createCollectionParentIndex(o,p)})),c<9&&h>=9&&(Co=Co.next(function(){(function(Bo){Bo.objectStoreNames.contains("remoteDocumentChanges")&&Bo.deleteObjectStore("remoteDocumentChanges")})(o),function(Bo){var Lo=Bo.objectStore(qn.store);Lo.createIndex(qn.readTimeIndex,qn.readTimeIndexPath,{unique:!1}),Lo.createIndex(qn.collectionReadTimeIndex,qn.collectionReadTimeIndexPath,{unique:!1})}(s)})),c<10&&h>=10&&(Co=Co.next(function(){return d.rewriteCanonicalIds(p)})),Co},l.prototype.addDocumentGlobal=function(o){var s=0;return o.store(qn.store).Ur(function(c,h){s+=cn(h)}).next(function(){var c=new jn(s);return o.store(jn.store).put(jn.key,c)})},l.prototype.removeAcknowledgedMutations=function(o){var s=this,c=o.store(Pn.store),h=o.store(Ln.store);return c.Fr().next(function(d){return Be.forEach(d,function(p){var Co=IDBKeyRange.bound([p.userId,-1],[p.userId,p.lastAcknowledgedBatchId]);return h.Fr(Ln.userMutationsIndex,Co).next(function(Bo){return Be.forEach(Bo,function(Lo){Re(Lo.userId===p.userId);var Uo=s.serializer.Lh(Lo);return _n(o,p.userId,Uo).next(function(){})})})})})},l.prototype.ensureSequenceNumbers=function(o){var s=o.store(Bn.store),c=o.store(qn.store);return o.store(zn.store).get(zn.key).next(function(h){var d=[];return c.Ur(function(p,Co){var Bo=new V$1(p),Lo=function(Uo){return[0,He(Uo)]}(Bo);d.push(s.get(Lo).next(function(Uo){return Uo?Be.resolve():function(Qo){return s.put(new Bn(0,He(Qo),h.highestListenSequenceNumber))}(Bo)}))}).next(function(){return Be.vn(d)})})},l.prototype.createCollectionParentIndex=function(o,s){o.createObjectStore(Gn.store,{keyPath:Gn.keyPath});var c=s.store(Gn.store),h=new nn,d=function(p){if(h.add(p)){var Co=p.O(),Bo=p.L();return c.put({collectionId:Co,parent:He(Bo)})}};return s.store(qn.store).Ur({Dh:!0},function(p,Co){var Bo=new V$1(p);return d(Bo.L())}).next(function(){return s.store(Un.store).Ur({Dh:!0},function(p,Co){p[0];var Bo=p[1],Lo=(p[2],tn(Bo));return d(Lo.L())})})},l.prototype.rewriteCanonicalIds=function(o){var s=this,c=o.store(Fn.store);return c.Ur(function(h,d){var p=s.serializer.mh(d),Co=s.serializer.Ph(p);return c.put(Co)})},l}(),Vn=function(l,o){this.seconds=l,this.nanoseconds=o},On=function(l,o,s){this.ownerId=l,this.allowTabSynchronization=o,this.leaseTimestampMs=s};On.store="owner",On.key="owner";var Pn=function(l,o,s){this.userId=l,this.lastAcknowledgedBatchId=o,this.lastStreamToken=s};Pn.store="mutationQueues",Pn.keyPath="userId";var Ln=function(l,o,s,c,h){this.userId=l,this.batchId=o,this.localWriteTimeMs=s,this.baseMutations=c,this.mutations=h};Ln.store="mutations",Ln.keyPath="batchId",Ln.userMutationsIndex="userMutationsIndex",Ln.userMutationsKeyPath=["userId","batchId"];var Un=function(){function l(){}return l.prefixForUser=function(o){return[o]},l.prefixForPath=function(o,s){return[o,He(s)]},l.key=function(o,s,c){return[o,He(s),c]},l}();Un.store="documentMutations",Un.PLACEHOLDER=new Un;var Cn=function(l,o){this.path=l,this.readTime=o},Mn=function(l,o){this.path=l,this.version=o},qn=function(l,o,s,c,h,d){this.unknownDocument=l,this.noDocument=o,this.document=s,this.hasCommittedMutations=c,this.readTime=h,this.parentPath=d};qn.store="remoteDocuments",qn.readTimeIndex="readTimeIndex",qn.readTimeIndexPath="readTime",qn.collectionReadTimeIndex="collectionReadTimeIndex",qn.collectionReadTimeIndexPath=["parentPath","readTime"];var jn=function(l){this.byteSize=l};jn.store="remoteDocumentGlobal",jn.key="remoteDocumentGlobalKey";var Fn=function(l,o,s,c,h,d,p){this.targetId=l,this.canonicalId=o,this.readTime=s,this.resumeToken=c,this.lastListenSequenceNumber=h,this.lastLimboFreeSnapshotVersion=d,this.query=p};Fn.store="targets",Fn.keyPath="targetId",Fn.queryTargetsIndexName="queryTargetsIndex",Fn.queryTargetsKeyPath=["canonicalId","targetId"];var Bn=function(l,o,s){this.targetId=l,this.path=o,this.sequenceNumber=s};Bn.store="targetDocuments",Bn.keyPath=["targetId","path"],Bn.documentTargetsIndex="documentTargetsIndex",Bn.documentTargetsKeyPath=["path","targetId"];var zn=function(l,o,s,c){this.highestTargetId=l,this.highestListenSequenceNumber=o,this.lastRemoteSnapshotVersion=s,this.targetCount=c};zn.key="targetGlobalKey",zn.store="targetGlobal";var Gn=function(l,o){this.collectionId=l,this.parent=o};function Wn(l){l.createObjectStore(Bn.store,{keyPath:Bn.keyPath}).createIndex(Bn.documentTargetsIndex,Bn.documentTargetsKeyPath,{unique:!0}),l.createObjectStore(Fn.store,{keyPath:Fn.keyPath}).createIndex(Fn.queryTargetsIndexName,Fn.queryTargetsKeyPath,{unique:!0}),l.createObjectStore(zn.store)}Gn.store="collectionParents",Gn.keyPath=["collectionId","parent"];var Qn=function(l,o,s,c){this.clientId=l,this.updateTimeMs=o,this.networkEnabled=s,this.inForeground=c};Qn.store="clientMetadata",Qn.keyPath="clientId";var Kn=__spreadArrays$1(__spreadArrays$1(__spreadArrays$1([Pn.store,Ln.store,Un.store,qn.store,Fn.store,On.store,zn.store,Bn.store],[Qn.store]),[jn.store]),[Gn.store]),Yn=function(){function l(o){this.db=o,l.aa(index_cjsExports$1.getUA())===12.2&&De("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return l.Xh=function(o,s,c){return ke("SimpleDb","Opening database:",o),new Be(function(h,d){var p=window.indexedDB.open(o,s);p.onsuccess=function(Co){var Bo=Co.target.result;h(new l(Bo))},p.onblocked=function(){d(new I(T$1.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},p.onerror=function(Co){var Bo=Co.target.error;Bo.name==="VersionError"?d(new I(T$1.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):d(Bo)},p.onupgradeneeded=function(Co){ke("SimpleDb",'Database "'+o+'" requires upgrade from version:',Co.oldVersion);var Bo=Co.target.result;c.createOrUpgrade(Bo,p.transaction,Co.oldVersion,xn).next(function(){ke("SimpleDb","Database upgrade to version "+xn+" complete")})}}).yn()},l.delete=function(o){return ke("SimpleDb","Removing database:",o),tr(window.indexedDB.deleteDatabase(o)).yn()},l.Gh=function(){if(typeof window>"u"||window.indexedDB==null)return!1;if(l.ua())return!0;if(window.navigator===void 0)return!1;var o=index_cjsExports$1.getUA(),s=l.aa(o),c=0<s&&s<10,h=l.ca(o),d=0<h&&h<4.5;return!(o.indexOf("MSIE ")>0||o.indexOf("Trident/")>0||o.indexOf("Edge/")>0||c||d)},l.ua=function(){var o;return typeof __PRIVATE_process<"u"&&((o=__PRIVATE_process.__PRIVATE_env)===null||o===void 0?void 0:o._a)==="YES"},l.Nr=function(o,s){return o.store(s)},l.aa=function(o){var s=o.match(/i(?:phone|pad|pod) os ([\d_]+)/i),c=s?s[1].split("_").slice(0,2).join("."):"-1";return Number(c)},l.ca=function(o){var s=o.match(/Android ([\d.]+)/i),c=s?s[1].split(".").slice(0,2).join("."):"-1";return Number(c)},l.prototype.oo=function(o){this.db.onversionchange=function(s){return o(s)}},l.prototype.runTransaction=function(o,s,c){return __awaiter$1(this,void 0,void 0,function(){var h,d,p,Co,Bo;return __generator$1(this,function(Lo){switch(Lo.label){case 0:h=o==="readonly",d=0,p=function(){var Uo,Qo,Po,Mo,Go;return __generator$1(this,function($o){switch($o.label){case 0:++d,Uo=Xn.open(Co.db,h?"readonly":"readwrite",s),$o.label=1;case 1:return $o.trys.push([1,3,,4]),Qo=c(Uo).catch(function(jo){return Uo.abort(jo),Be.reject(jo)}).yn(),Po={},Qo.catch(function(){}),[4,Uo.la];case 2:return[2,(Po.value=($o.sent(),Qo),Po)];case 3:return Mo=$o.sent(),Go=Mo.name!=="FirebaseError"&&d<3,ke("SimpleDb","Transaction failed with error: %s. Retrying: %s.",Mo.message,Go),Go?[3,4]:[2,{value:Promise.reject(Mo)}];case 4:return[2]}})},Co=this,Lo.label=1;case 1:return[5,p()];case 2:if(typeof(Bo=Lo.sent())=="object")return[2,Bo.value];Lo.label=3;case 3:return[3,1];case 4:return[2]}})})},l.prototype.close=function(){this.db.close()},l}(),$n=function(){function l(o){this.da=o,this.fa=!1,this.Ta=null}return Object.defineProperty(l.prototype,"Pn",{get:function(){return this.fa},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"Ea",{get:function(){return this.Ta},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cursor",{set:function(o){this.da=o},enumerable:!0,configurable:!0}),l.prototype.done=function(){this.fa=!0},l.prototype.Qr=function(o){this.Ta=o},l.prototype.delete=function(){return tr(this.da.delete())},l}(),Jn=function(l){function o(s){var c=this;return(c=l.call(this,T$1.UNAVAILABLE,"IndexedDB transaction failed: "+s)||this).name="IndexedDbTransactionError",c}return __extends$1(o,l),o}(I);function Hn(l){return l.name==="IndexedDbTransactionError"}var Xn=function(){function l(o){var s=this;this.transaction=o,this.aborted=!1,this.Ia=new $e,this.transaction.oncomplete=function(){s.Ia.resolve()},this.transaction.onabort=function(){o.error?s.Ia.reject(new Jn(o.error)):s.Ia.resolve()},this.transaction.onerror=function(c){var h=nr(c.target.error);s.Ia.reject(new Jn(h))}}return l.open=function(o,s,c){return new l(o.transaction(c,s))},Object.defineProperty(l.prototype,"la",{get:function(){return this.Ia.promise},enumerable:!0,configurable:!0}),l.prototype.abort=function(o){o&&this.Ia.reject(o),this.aborted||(ke("SimpleDb","Aborting transaction:",o?o.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},l.prototype.store=function(o){var s=this.transaction.objectStore(o);return new Zn(s)},l}(),Zn=function(){function l(o){this.store=o}return l.prototype.put=function(o,s){var c;return s!==void 0?(ke("SimpleDb","PUT",this.store.name,o,s),c=this.store.put(s,o)):(ke("SimpleDb","PUT",this.store.name,"<auto-key>",o),c=this.store.put(o)),tr(c)},l.prototype.add=function(o){return ke("SimpleDb","ADD",this.store.name,o,o),tr(this.store.add(o))},l.prototype.get=function(o){var s=this;return tr(this.store.get(o)).next(function(c){return c===void 0&&(c=null),ke("SimpleDb","GET",s.store.name,o,c),c})},l.prototype.delete=function(o){return ke("SimpleDb","DELETE",this.store.name,o),tr(this.store.delete(o))},l.prototype.count=function(){return ke("SimpleDb","COUNT",this.store.name),tr(this.store.count())},l.prototype.Fr=function(o,s){var c=this.cursor(this.options(o,s)),h=[];return this.wa(c,function(d,p){h.push(p)}).next(function(){return h})},l.prototype.Ra=function(o,s){ke("SimpleDb","DELETE ALL",this.store.name);var c=this.options(o,s);c.Dh=!1;var h=this.cursor(c);return this.wa(h,function(d,p,Co){return Co.delete()})},l.prototype.Ur=function(o,s){var c;s?c=o:(c={},s=o);var h=this.cursor(c);return this.wa(h,s)},l.prototype.Uo=function(o){var s=this.cursor({});return new Be(function(c,h){s.onerror=function(d){var p=nr(d.target.error);h(p)},s.onsuccess=function(d){var p=d.target.result;p?o(p.primaryKey,p.value).next(function(Co){Co?p.continue():c()}):c()}})},l.prototype.wa=function(o,s){var c=[];return new Be(function(h,d){o.onerror=function(p){d(p.target.error)},o.onsuccess=function(p){var Co=p.target.result;if(Co){var Bo=new $n(Co),Lo=s(Co.primaryKey,Co.value,Bo);if(Lo instanceof Be){var Uo=Lo.catch(function(Qo){return Bo.done(),Be.reject(Qo)});c.push(Uo)}Bo.Pn?h():Bo.Ea===null?Co.continue():Co.continue(Bo.Ea)}else h()}}).next(function(){return Be.vn(c)})},l.prototype.options=function(o,s){var c=void 0;return o!==void 0&&(typeof o=="string"?c=o:s=o),{index:c,range:s}},l.prototype.cursor=function(o){var s="next";if(o.reverse&&(s="prev"),o.index){var c=this.store.index(o.index);return o.Dh?c.openKeyCursor(o.range,s):c.openCursor(o.range,s)}return this.store.openCursor(o.range,s)},l}();function tr(l){return new Be(function(o,s){l.onsuccess=function(c){var h=c.target.result;o(h)},l.onerror=function(c){var h=nr(c.target.error);s(h)}})}var er=!1;function nr(l){var o=Yn.aa(index_cjsExports$1.getUA());if(o>=12.2&&o<13){var s="An internal error was encountered in the Indexed Database server";if(l.message.indexOf(s)>=0){var c=new I("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+s+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return er||(er=!0,setTimeout(function(){throw c},0)),c}}return l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rr=function(){function l(o,s,c,h,d){this.Aa=o,this.Er=s,this.ma=c,this.op=h,this.Pa=d,this.Va=new $e,this.then=this.Va.promise.then.bind(this.Va.promise),this.Va.promise.catch(function(p){})}return l.ga=function(o,s,c,h,d){var p=new l(o,s,Date.now()+c,h,d);return p.start(c),p},l.prototype.start=function(o){var s=this;this.pa=setTimeout(function(){return s.ya()},o)},l.prototype.vr=function(){return this.ya()},l.prototype.cancel=function(o){this.pa!==null&&(this.clearTimeout(),this.Va.reject(new I(T$1.CANCELLED,"Operation cancelled"+(o?": "+o:""))))},l.prototype.ya=function(){var o=this;this.Aa.uo(function(){return o.pa!==null?(o.clearTimeout(),o.op().then(function(s){return o.Va.resolve(s)})):Promise.resolve()})},l.prototype.clearTimeout=function(){this.pa!==null&&(this.Pa(this),clearTimeout(this.pa),this.pa=null)},l}(),ir=function(){function l(){var o=this;this.ba=Promise.resolve(),this.va=Promise.resolve(),this.Sa=!1,this.Da=[],this.Ca=null,this.Fa=!1,this.Na=[],this.$a=new Je(this,"async_queue_retry"),this.ka=function(){return o.$a.br()};var s=Ie.nt().window;s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this.ka)}return Object.defineProperty(l.prototype,"La",{get:function(){return this.Sa},enumerable:!0,configurable:!0}),l.prototype.uo=function(o){this.enqueue(o)},l.prototype.Ma=function(o){this.Oa(),this.xa(o)},l.prototype.Ba=function(o){return this.Oa(),this.xa(o)},l.prototype.qa=function(o){return __awaiter$1(this,void 0,void 0,function(){var s;return __generator$1(this,function(c){switch(c.label){case 0:return this.Oa(),this.Sa?[3,2]:(this.Sa=!0,(s=Ie.nt().window)&&s.removeEventListener("visibilitychange",this.ka),[4,this.Ba(o)]);case 1:c.sent(),c.label=2;case 2:return[2]}})})},l.prototype.enqueue=function(o){return this.Oa(),this.Sa?new Promise(function(s){}):this.xa(o)},l.prototype.Ua=function(o){var s=this;this.Oa(),this.Sa||(this.va=this.va.then(function(){var c=new $e,h=function(){return __awaiter$1(s,void 0,void 0,function(){var d;return __generator$1(this,function(p){switch(p.label){case 0:return p.trys.push([0,2,,3]),[4,o()];case 1:return p.sent(),c.resolve(),this.$a.reset(),[3,3];case 2:if(!Hn(d=p.sent()))throw c.resolve(),d;return ke("AsyncQueue","Operation failed with retryable error: "+d),this.$a.gr(h),[3,3];case 3:return[2]}})})};return s.uo(h),c.promise}))},l.prototype.xa=function(o){var s=this,c=this.ba.then(function(){return s.Fa=!0,o().catch(function(h){throw s.Ca=h,s.Fa=!1,De("INTERNAL UNHANDLED ERROR: ",h.stack||h.message||""),h}).then(function(h){return s.Fa=!1,h})});return this.ba=c,c},l.prototype.yr=function(o,s,c){var h=this;this.Oa(),this.Na.indexOf(o)>-1&&(s=0);var d=rr.ga(this,o,s,c,function(p){return h.Qa(p)});return this.Da.push(d),d},l.prototype.Oa=function(){this.Ca&&xe()},l.prototype.Wa=function(){},l.prototype.ja=function(){return __awaiter$1(this,void 0,void 0,function(){var o;return __generator$1(this,function(s){switch(s.label){case 0:return[4,o=this.ba];case 1:s.sent(),s.label=2;case 2:if(o!==this.ba)return[3,0];s.label=3;case 3:return[2]}})})},l.prototype.Ka=function(o){for(var s=0,c=this.Da;s<c.length;s++)if(c[s].Er===o)return!0;return!1},l.prototype.Ga=function(o){var s=this;return this.ja().then(function(){s.Da.sort(function(p,Co){return p.ma-Co.ma});for(var c=0,h=s.Da;c<h.length;c++){var d=h[c];if(d.vr(),o!=="all"&&d.Er===o)break}return s.ja()})},l.prototype.za=function(o){this.Na.push(o)},l.prototype.Qa=function(o){var s=this.Da.indexOf(o);this.Da.splice(s,1)},l}();function or(l,o){if(De("AsyncQueue",o+": "+l),Hn(l))return new I(T$1.UNAVAILABLE,o+": "+l);throw l}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sr(l,o){var s=l[0],c=l[1],h=o[0],d=o[1],p=Pe(s,h);return p===0?Pe(c,d):p}var ur=function(){function l(o){this.Ha=o,this.buffer=new Yt(sr),this.Ya=0}return l.prototype.Ja=function(){return++this.Ya},l.prototype.Xa=function(o){var s=[o,this.Ja()];if(this.buffer.size<this.Ha)this.buffer=this.buffer.add(s);else{var c=this.buffer.last();sr(s,c)<0&&(this.buffer=this.buffer.delete(c).add(s))}},Object.defineProperty(l.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),l}(),ar={Za:!1,tu:0,eu:0,su:0},hr=function(){function l(o,s,c){this.iu=o,this.nu=s,this.ru=c}return l.hu=function(o){return new l(o,l.ou,l.au)},l}();hr.uu=-1,hr.cu=1048576,hr._u=41943040,hr.ou=10,hr.au=1e3,hr.lu=new hr(hr._u,hr.ou,hr.au),hr.DISABLED=new hr(hr.uu,0,0);var cr=function(){function l(o,s){this.ko=o,this.Aa=s,this.du=!1,this.fu=null}return l.prototype.start=function(o){this.ko.Tu.iu!==hr.uu&&this.Eu(o)},l.prototype.stop=function(){this.fu&&(this.fu.cancel(),this.fu=null)},Object.defineProperty(l.prototype,"ro",{get:function(){return this.fu!==null},enumerable:!0,configurable:!0}),l.prototype.Eu=function(o){var s=this,c=this.du?3e5:6e4;ke("LruGarbageCollector","Garbage collection scheduled in "+c+"ms"),this.fu=this.Aa.yr("lru_garbage_collection",c,function(){return __awaiter$1(s,void 0,void 0,function(){var h;return __generator$1(this,function(d){switch(d.label){case 0:this.fu=null,this.du=!0,d.label=1;case 1:return d.trys.push([1,3,,7]),[4,o.Iu(this.ko)];case 2:return d.sent(),[3,7];case 3:return Hn(h=d.sent())?(ke("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",h),[3,6]):[3,4];case 4:return[4,dr(h)];case 5:d.sent(),d.label=6;case 6:return[3,7];case 7:return[4,this.Eu(o)];case 8:return d.sent(),[2]}})})})},l}(),fr=function(){function l(o,s){this.wu=o,this.Tu=s}return l.prototype.Ru=function(o,s){return this.wu.Lo(o).next(function(c){return Math.floor(s/100*c)})},l.prototype.Au=function(o,s){var c=this;if(s===0)return Be.resolve(Ye.dr);var h=new ur(s);return this.wu.js(o,function(d){return h.Xa(d.sequenceNumber)}).next(function(){return c.wu.Oo(o,function(d){return h.Xa(d)})}).next(function(){return h.maxValue})},l.prototype.Ah=function(o,s,c){return this.wu.Ah(o,s,c)},l.prototype.Qo=function(o,s){return this.wu.Qo(o,s)},l.prototype.mu=function(o,s){var c=this;return this.Tu.iu===hr.uu?(ke("LruGarbageCollector","Garbage collection skipped; disabled"),Be.resolve(ar)):this.jo(o).next(function(h){return h<c.Tu.iu?(ke("LruGarbageCollector","Garbage collection skipped; Cache size "+h+" is lower than threshold "+c.Tu.iu),ar):c.Pu(o,s)})},l.prototype.jo=function(o){return this.wu.jo(o)},l.prototype.Pu=function(o,s){var c,h,d,p,Co,Bo,Lo,Uo=this,Qo=Date.now();return this.Ru(o,this.Tu.nu).next(function(Po){return Po>Uo.Tu.ru?(ke("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+Uo.Tu.ru+" from "+Po),h=Uo.Tu.ru):h=Po,p=Date.now(),Uo.Au(o,h)}).next(function(Po){return c=Po,Co=Date.now(),Uo.Ah(o,c,s)}).next(function(Po){return d=Po,Bo=Date.now(),Uo.Qo(o,c)}).next(function(Po){return Lo=Date.now(),Ae()<=LogLevel.DEBUG&&ke("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in `+(p-Qo)+`ms
	Determined least recently used `+h+" in "+(Co-p)+`ms
	Removed `+d+" targets in "+(Bo-Co)+`ms
	Removed `+Po+" documents in "+(Lo-Bo)+`ms
Total Duration: `+(Lo-Qo)+"ms"),Be.resolve({Za:!0,tu:h,eu:d,su:Po})})},l}(),lr=function(){function l(o,s,c){this.persistence=o,this.Vu=s,this.gu=new Wt(Pe),this.pu=new qe(function(h){return h.canonicalId()}),this.yu=x.min(),this.Wn=o.vo(c),this.bu=o.Co(),this.Yh=o.Do(),this.vu=new Qe(this.bu,this.Wn,this.persistence.Fo()),this.Vu.Su(this.vu)}return l.prototype.start=function(){return Promise.resolve()},l.prototype.Du=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h,d=this;return __generator$1(this,function(p){switch(p.label){case 0:return s=this.Wn,c=this.vu,[4,this.persistence.runTransaction("Handle user change","readonly",function(Co){var Bo;return d.Wn.ia(Co).next(function(Lo){return Bo=Lo,s=d.persistence.vo(o),c=new Qe(d.bu,s,d.persistence.Fo()),s.ia(Co)}).next(function(Lo){for(var Uo=[],Qo=[],Po=ie(),Mo=0,Go=Bo;Mo<Go.length;Mo++){var $o=Go[Mo];Uo.push($o.batchId);for(var jo=0,zo=$o.mutations;jo<zo.length;jo++){var Xo=zo[jo];Po=Po.add(Xo.key)}}for(var Zo=0,Wo=Lo;Zo<Wo.length;Zo++){var es=Wo[Zo];Qo.push(es.batchId);for(var is=0,Jo=es.mutations;is<Jo.length;is++){var Ko=Jo[is];Po=Po.add(Ko.key)}}return c.Yn(Co,Po).next(function(Yo){return{Cu:Yo,Fu:Uo,Nu:Qo}})})})];case 1:return h=p.sent(),[2,(this.Wn=s,this.vu=c,this.Vu.Su(this.vu),h)]}})})},l.prototype.$u=function(o){var s,c=this,h=S.now(),d=o.reduce(function(p,Co){return p.add(Co.key)},ie());return this.persistence.runTransaction("Locally write mutations","readwrite",function(p){return c.vu.Yn(p,d).next(function(Co){s=Co;for(var Bo=[],Lo=0,Uo=o;Lo<Uo.length;Lo++){var Qo=Uo[Lo],Po=Qo.Pt(s.get(Qo.key));Po!=null&&Bo.push(new gt(Qo.key,Po,Nt(Po.proto.mapValue),yt.exists(!0)))}return c.Wn.Xo(p,h,Bo,o)})}).then(function(p){var Co=p.In(s);return{batchId:p.batchId,Dn:Co}})},l.prototype.zo=function(o){var s=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(c){var h=o.batch.keys(),d=s.bu.Yr({Xr:!0});return s.Wn.zo(c,o.batch,o.streamToken).next(function(){return s.ku(c,o,d)}).next(function(){return d.apply(c)}).next(function(){return s.Wn.oa(c)}).next(function(){return s.vu.Yn(c,h)})})},l.prototype.Lu=function(o){var s=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(c){var h;return s.Wn.Zo(c,o).next(function(d){return Re(d!==null),h=d.keys(),s.Wn.ra(c,d)}).next(function(){return s.Wn.oa(c)}).next(function(){return s.vu.Yn(c,h)})})},l.prototype.sa=function(){var o=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(s){return o.Wn.sa(s)})},l.prototype.Yo=function(){var o=this;return this.persistence.runTransaction("Get last stream token","readonly",function(s){return o.Wn.Yo(s)})},l.prototype.Jo=function(o){var s=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(c){return s.Wn.Jo(c,o)})},l.prototype._h=function(){var o=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(s){return o.Yh._h(s)})},l.prototype.Mu=function(o){var s=this,c=o.Ee,h=this.gu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(d){var p=s.bu.Yr({Xr:!0});h=s.gu;var Co=[];o.as.forEach(function(Qo,Po){var Mo=h.get(Po);if(Mo){Co.push(s.Yh.bh(d,Qo.Is,Po).next(function(){return s.Yh.ph(d,Qo.Ts,Po)}));var Go=Qo.resumeToken;if(Go.rt()>0){var $o=Mo.we(Go,c).Ie(d.Oh);h=h.Ae(Po,$o),l.Ou(Mo,$o,Qo)&&Co.push(s.Yh.Ih(d,$o))}}});var Bo=Ht(),Lo=ie();if(o.cs.forEach(function(Qo,Po){Lo=Lo.add(Qo)}),Co.push(p.getEntries(d,Lo).next(function(Qo){o.cs.forEach(function(Po,Mo){var Go=Qo.get(Po);Mo instanceof St&&Mo.version.isEqual(x.min())?(p.kn(Po,c),Bo=Bo.Ae(Po,Mo)):Go==null||Mo.version.S(Go.version)>0||Mo.version.S(Go.version)===0&&Go.hasPendingWrites?(p.Nn(Mo,c),Bo=Bo.Ae(Po,Mo)):ke("LocalStore","Ignoring outdated watch update for ",Po,". Current version:",Go.version," Watch version:",Mo.version),o._s.has(Po)&&Co.push(s.persistence.hh.Wo(d,Po))})})),!c.isEqual(x.min())){var Uo=s.Yh._h(d).next(function(Qo){return s.Yh.dh(d,d.Oh,c)});Co.push(Uo)}return Be.vn(Co).next(function(){return p.apply(d)}).next(function(){return s.vu.Jn(d,Bo)})}).then(function(d){return s.gu=h,d})},l.Ou=function(o,s,c){return Re(s.resumeToken.rt()>0),o.resumeToken.rt()===0||s.Ee.D()-o.Ee.D()>=this.xu||c.Ts.size+c.Es.size+c.Is.size>0},l.prototype.Bu=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h,d,p,Co,Bo,Lo,Uo=this;return __generator$1(this,function(Qo){switch(Qo.label){case 0:return Qo.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(Po){return Be.forEach(o,function(Mo){return Be.forEach(Mo.hr,function(Go){return Uo.persistence.hh.yh(Po,Mo.targetId,Go)}).next(function(){return Be.forEach(Mo.or,function(Go){return Uo.persistence.hh.vh(Po,Mo.targetId,Go)})})})})];case 1:return Qo.sent(),[3,3];case 2:if(!Hn(s=Qo.sent()))throw s;return ke("LocalStore","Failed to update sequence numbers: "+s),[3,3];case 3:for(c=0,h=o;c<h.length;c++)d=h[c],p=d.targetId,d.fromCache||(Co=this.gu.get(p),Bo=Co.Ee,Lo=Co.Re(Bo),this.gu=this.gu.Ae(p,Lo));return[2]}})})},l.prototype.qu=function(o){var s=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(c){return o===void 0&&(o=-1),s.Wn.ea(c,o)})},l.prototype.Uu=function(o){var s=this;return this.persistence.runTransaction("read document","readonly",function(c){return s.vu.Kn(c,o)})},l.prototype.Qu=function(o){var s=this;return this.persistence.runTransaction("Allocate target","readwrite",function(c){var h;return s.Yh.gh(c,o).next(function(d){return d?(h=d,Be.resolve(h)):s.Yh.oh(c).next(function(p){return h=new Ft(o,p,0,c.Oh),s.Yh.fh(c,h).next(function(){return h})})})}).then(function(c){return s.gu.get(c.targetId)===null&&(s.gu=s.gu.Ae(c.targetId,c),s.pu.set(o,c.targetId)),c})},l.prototype.gh=function(o,s){var c=this.pu.get(s);return c!==void 0?Be.resolve(this.gu.get(c)):this.Yh.gh(o,s)},l.prototype.Wu=function(o,s){var c=this,h=this.gu.get(o),d=s?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",d,function(p){return s?Be.resolve():c.persistence.hh.removeTarget(p,h)}).then(function(){c.gu=c.gu.remove(o),c.pu.delete(h.target)})},l.prototype.ju=function(o,s){var c=this,h=x.min(),d=ie();return this.persistence.runTransaction("Execute query","readonly",function(p){return c.gh(p,o.ee()).next(function(Co){if(Co)return h=Co.lastLimboFreeSnapshotVersion,c.Yh.Sh(p,Co.targetId).next(function(Bo){d=Bo})}).next(function(){return c.Vu.Zn(p,o,s?h:x.min(),s?d:ie())}).next(function(Co){return{documents:Co,Ku:d}})})},l.prototype.ku=function(o,s,c){var h=this,d=s.batch,p=d.keys(),Co=Be.resolve();return p.forEach(function(Bo){Co=Co.next(function(){return c.Ln(o,Bo)}).next(function(Lo){var Uo=Lo,Qo=s.Rn.get(Bo);Re(Qo!==null),(!Uo||Uo.version.S(Qo)<0)&&(Uo=d.at(Bo,Uo,s))&&c.Nn(Uo,s.wn)})}),Co.next(function(){return h.Wn.ra(o,d)})},l.prototype.Iu=function(o){var s=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(c){return o.mu(c,s.gu)})},l}();lr.xu=3e8;var pr=function(l){function o(s,c,h){var d=this;return(d=l.call(this,s,c,h)||this).persistence=s,d.Wn=s.vo(h),d.bu=s.Co(),d.Yh=s.Do(),d}return __extends$1(o,l),o.prototype.start=function(){return this.Gu()},o.prototype.zu=function(s){var c=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(h){return c.Wn.ta(h,s).next(function(d){return d?c.vu.Yn(h,d):Be.resolve(null)})})},o.prototype.Hu=function(s){this.Wn.ha(s)},o.prototype.ao=function(s){this.persistence.ao(s)},o.prototype.bo=function(){return this.persistence.bo()},o.prototype.Yu=function(s){var c=this,h=this.gu.get(s);return h?Promise.resolve(h.target):this.persistence.runTransaction("Get target data","readonly",function(d){return c.Yh.si(d,s).next(function(p){return p?p.target:null})})},o.prototype.Kr=function(){var s=this;return this.persistence.runTransaction("Get new document changes","readonly",function(c){return s.bu.Kr(c,s.yu)}).then(function(c){var h=c.Gr,d=c.readTime;return s.yu=d,h})},o.prototype.Gu=function(){return __awaiter$1(this,void 0,void 0,function(){var s,c=this;return __generator$1(this,function(h){switch(h.label){case 0:return s=this,[4,this.persistence.runTransaction("Synchronize last document change read time","readonly",function(d){return c.bu.Hr(d)})];case 1:return s.yu=h.sent(),[2]}})})},o}(lr);function dr(l){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){if(l.code!==T$1.FAILED_PRECONDITION||l.message!==Ge)throw l;return ke("LocalStore","Unexpectedly lost primary lease"),[2]})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yr=function(){function l(){this.Ju=new Yt(vr.Xu),this.Zu=new Yt(vr.tc)}return l.prototype.B=function(){return this.Ju.B()},l.prototype.yh=function(o,s){var c=new vr(o,s);this.Ju=this.Ju.add(c),this.Zu=this.Zu.add(c)},l.prototype.ec=function(o,s){var c=this;o.forEach(function(h){return c.yh(h,s)})},l.prototype.vh=function(o,s){this.sc(new vr(o,s))},l.prototype.ic=function(o,s){var c=this;o.forEach(function(h){return c.vh(h,s)})},l.prototype.nc=function(o){var s=this,c=L$1.EMPTY,h=new vr(c,o),d=new vr(c,o+1),p=[];return this.Zu.Ke([h,d],function(Co){s.sc(Co),p.push(Co.key)}),p},l.prototype.rc=function(){var o=this;this.Ju.forEach(function(s){return o.sc(s)})},l.prototype.sc=function(o){this.Ju=this.Ju.delete(o),this.Zu=this.Zu.delete(o)},l.prototype.hc=function(o){var s=L$1.EMPTY,c=new vr(s,o),h=new vr(s,o+1),d=ie();return this.Zu.Ke([c,h],function(p){d=d.add(p.key)}),d},l.prototype.Ch=function(o){var s=new vr(o,0),c=this.Ju.ze(s);return c!==null&&o.isEqual(c.key)},l}(),vr=function(){function l(o,s){this.key=o,this.oc=s}return l.Xu=function(o,s){return L$1.N(o.key,s.key)||Pe(o.oc,s.oc)},l.tc=function(o,s){return Pe(o.oc,s.oc)||L$1.N(o.key,s.key)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(l,o){if(o.length!==0)throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() does not support arguments, but was called with "+Pr(o.length,"argument")+".")}function gr(l,o,s){if(o.length!==s)throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() requires "+Pr(s,"argument")+", but was called with "+Pr(o.length,"argument")+".")}function wr(l,o,s){if(o.length<s)throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() requires at least "+Pr(s,"argument")+", but was called with "+Pr(o.length,"argument")+".")}function Er(l,o,s,c){if(o.length<s||o.length>c)throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() requires between "+s+" and "+c+" arguments, but was called with "+Pr(o.length,"argument")+".")}function br(l,o,s,c){_r(l,o,Or(s)+" argument",c)}function Tr(l,o,s,c){c!==void 0&&br(l,o,s,c)}function Ir(l,o,s,c){_r(l,o,s+" option",c)}function Nr(l,o,s,c){c!==void 0&&Ir(l,o,s,c)}function Ar(l,o,s,c,h){c!==void 0&&function(d,p,Co,Bo,Lo){for(var Uo=[],Qo=0,Po=Lo;Qo<Po.length;Qo++){var Mo=Po[Qo];if(Mo===Bo)return;Uo.push(Dr(Mo))}var Go=Dr(Bo);throw new I(T$1.INVALID_ARGUMENT,"Invalid value "+Go+" provided to function "+d+'() for option "'+Co+'". Acceptable values: '+Uo.join(", "))}(l,0,s,c,h)}function _r(l,o,s,c){if(!(o==="object"?kr(c):o==="non-empty string"?typeof c=="string"&&c!=="":typeof c===o)){var h=Dr(c);throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() requires its "+s+" to be of type "+o+", but it was: "+h)}}function kr(l){return typeof l=="object"&&l!==null&&(Object.getPrototypeOf(l)===Object.prototype||Object.getPrototypeOf(l)===null)}function Dr(l){if(l===void 0)return"undefined";if(l===null)return"null";if(typeof l=="string")return l.length>20&&(l=l.substring(0,20)+"..."),JSON.stringify(l);if(typeof l=="number"||typeof l=="boolean")return""+l;if(typeof l=="object"){if(l instanceof Array)return"an array";var o=function(s){if(s.constructor){var c=/function\s+([^\s(]+)\s*\(/.exec(s.constructor.toString());if(c&&c.length>1)return c[1]}return null}(l);return o?"a custom "+o+" object":"an object"}return typeof l=="function"?"a function":xe()}function Sr(l,o,s){if(s===void 0)throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() requires a valid "+Or(o)+" argument, but it was undefined.")}function xr(l,o,s){C(o,function(c,h){if(s.indexOf(c)<0)throw new I(T$1.INVALID_ARGUMENT,"Unknown option '"+c+"' passed to function "+l+"(). Available options: "+s.join(", "))})}function Rr(l,o,s,c){var h=Dr(c);return new I(T$1.INVALID_ARGUMENT,"Function "+l+"() requires its "+Or(s)+" argument to be a "+o+", but it was: "+h)}function Vr(l,o,s){if(s<=0)throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() requires its "+Or(o)+" argument to be a positive number, but it was: "+s+".")}function Or(l){switch(l){case 1:return"first";case 2:return"second";case 3:return"third";default:return l+"th"}}function Pr(l,o){return l+" "+o+(l===1?"":"s")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(){if(typeof Uint8Array>"u")throw new I(T$1.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ur(){if(!Ie.nt().ac)throw new I(T$1.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Cr=function(){function l(o){Ur(),this.uc=o}return l.fromBase64String=function(o){gr("Blob.fromBase64String",arguments,1),br("Blob.fromBase64String","string",1,o),Ur();try{return new l(q.fromBase64String(o))}catch(s){throw new I(T$1.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+s)}},l.fromUint8Array=function(o){if(gr("Blob.fromUint8Array",arguments,1),Lr(),!(o instanceof Uint8Array))throw Rr("Blob.fromUint8Array","Uint8Array",1,o);return new l(q.fromUint8Array(o))},l.prototype.toBase64=function(){return gr("Blob.toBase64",arguments,0),Ur(),this.uc.toBase64()},l.prototype.toUint8Array=function(){return gr("Blob.toUint8Array",arguments,0),Lr(),this.uc.toUint8Array()},l.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},l.prototype.isEqual=function(o){return this.uc.isEqual(o.uc)},l}(),Mr=function(){function l(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];(function(h,d,p,Co){if(!(d instanceof Array)||d.length<1)throw new I(T$1.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+Pr(1,"element")+".")})(0,o);for(var c=0;c<o.length;++c)if(br("FieldPath","string",c,o[c]),o[c].length===0)throw new I(T$1.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.cc=new P(o)}return l.documentId=function(){return l._c},l.prototype.isEqual=function(o){if(!(o instanceof l))throw Rr("isEqual","FieldPath",1,o);return this.cc.isEqual(o.cc)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mr._c=new Mr(P.J().j());var qr=new RegExp("[~\\*/\\[\\]]"),jr=function(l){this.lc=l},Fr=function(l){function o(){return l.call(this,"FieldValue.delete")||this}return __extends$1(o,l),o.prototype.Di=function(s){if(s.dc!==2)throw s.dc===1?s.fc("FieldValue.delete() can only appear at the top level of your update data"):s.fc("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return s.Vt.push(s.path),null},o.prototype.isEqual=function(s){return s instanceof o},o}(jr),Br=function(l){function o(){return l.call(this,"FieldValue.serverTimestamp")||this}return __extends$1(o,l),o.prototype.Di=function(s){return new pt(s.path,ut.instance)},o.prototype.isEqual=function(s){return s instanceof o},o}(jr),zr=function(l){function o(s){var c=this;return(c=l.call(this,"FieldValue.arrayUnion")||this).Tc=s,c}return __extends$1(o,l),o.prototype.Di=function(s){var c=new Hr({dc:3,methodName:this.lc,Ec:!0},s.ii,s.serializer,s.ignoreUndefinedProperties),h=this.Tc.map(function(p){return Zr(p,c)}),d=new at(h);return new pt(s.path,d)},o.prototype.isEqual=function(s){return this===s},o}(jr),Gr=function(l){function o(s){var c=this;return(c=l.call(this,"FieldValue.arrayRemove")||this).Tc=s,c}return __extends$1(o,l),o.prototype.Di=function(s){var c=new Hr({dc:3,methodName:this.lc,Ec:!0},s.ii,s.serializer,s.ignoreUndefinedProperties),h=this.Tc.map(function(p){return Zr(p,c)}),d=new ht(h);return new pt(s.path,d)},o.prototype.isEqual=function(s){return this===s},o}(jr),Wr=function(l){function o(s){var c=this;return(c=l.call(this,"FieldValue.increment")||this).Ic=s,c}return __extends$1(o,l),o.prototype.Di=function(s){var c=new Hr({dc:3,methodName:this.lc},s.ii,s.serializer,s.ignoreUndefinedProperties),h=Zr(this.Ic,c),d=new ct(s.serializer,h);return new pt(s.path,d)},o.prototype.isEqual=function(s){return this===s},o}(jr),Qr=function(){function l(o,s){if(gr("GeoPoint",arguments,2),br("GeoPoint","number",1,o),br("GeoPoint","number",2,s),!isFinite(o)||o<-90||o>90)throw new I(T$1.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+o);if(!isFinite(s)||s<-180||s>180)throw new I(T$1.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this.wc=o,this.Rc=s}return Object.defineProperty(l.prototype,"latitude",{get:function(){return this.wc},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"longitude",{get:function(){return this.Rc},enumerable:!0,configurable:!0}),l.prototype.isEqual=function(o){return this.wc===o.wc&&this.Rc===o.Rc},l.prototype.p=function(o){return Pe(this.wc,o.wc)||Pe(this.Rc,o.Rc)},l}(),Kr=/^__.*__$/,Yr=function(){function l(o,s,c){this.data=o,this.Vt=s,this.fieldTransforms=c}return l.prototype.Ac=function(o,s){var c=[];return this.Vt!==null?c.push(new gt(o,this.data,this.Vt,s)):c.push(new mt(o,this.data,s)),this.fieldTransforms.length>0&&c.push(new wt(o,this.fieldTransforms)),c},l}(),$r=function(){function l(o,s,c){this.data=o,this.Vt=s,this.fieldTransforms=c}return l.prototype.Ac=function(o,s){var c=[new gt(o,this.data,this.Vt,s)];return this.fieldTransforms.length>0&&c.push(new wt(o,this.fieldTransforms)),c},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(l){switch(l){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xe()}}var Hr=function(){function l(o,s,c,h,d,p){this.settings=o,this.ii=s,this.serializer=c,this.ignoreUndefinedProperties=h,d===void 0&&this.mc(),this.fieldTransforms=d||[],this.Vt=p||[]}return Object.defineProperty(l.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"dc",{get:function(){return this.settings.dc},enumerable:!0,configurable:!0}),l.prototype.Pc=function(o){return new l(Object.assign(Object.assign({},this.settings),o),this.ii,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Vt)},l.prototype.Vc=function(o){var s,c=(s=this.path)===null||s===void 0?void 0:s.child(o),h=this.Pc({path:c,Ec:!1});return h.gc(o),h},l.prototype.pc=function(o){var s,c=(s=this.path)===null||s===void 0?void 0:s.child(o),h=this.Pc({path:c,Ec:!1});return h.mc(),h},l.prototype.yc=function(o){return this.Pc({path:void 0,Ec:!0})},l.prototype.fc=function(o){var s=!this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new I(T$1.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+o+s)},l.prototype.contains=function(o){return this.Vt.find(function(s){return o.q(s)})!==void 0||this.fieldTransforms.find(function(s){return o.q(s.field)})!==void 0},l.prototype.mc=function(){if(this.path)for(var o=0;o<this.path.length;o++)this.gc(this.path.get(o))},l.prototype.gc=function(o){if(o.length===0)throw this.fc("Document fields must not be empty");if(Jr(this.dc)&&Kr.test(o))throw this.fc('Document fields cannot begin and end with "__"')},l}(),Xr=function(){function l(o,s,c){this.ii=o,this.ignoreUndefinedProperties=s,this.serializer=c||Ie.nt().bc(o)}return l.prototype.vc=function(o,s){var c=this.Sc(0,o);ni("Data must be an object, but it was:",c,s);var h=ti(s,c);return new Yr(new Tt(h),null,c.fieldTransforms)},l.prototype.Dc=function(o,s,c){var h=this.Sc(2,o);ni("Data must be an object, but it was:",h,s);var d,p,Co=ti(s,h);if(c){for(var Bo=[],Lo=0,Uo=c;Lo<Uo.length;Lo++){var Qo=Uo[Lo],Po=void 0;if(Qo instanceof Mr)Po=Qo.cc;else{if(typeof Qo!="string")throw xe();Po=ii(o,Qo)}if(!h.contains(Po))throw new I(T$1.INVALID_ARGUMENT,"Field '"+Po+"' is specified in your field mask but missing from your input data.");oi(Bo,Po)||Bo.push(Po)}d=new lt(Bo),p=h.fieldTransforms.filter(function(Mo){return d.dt(Mo.field)})}else d=new lt(h.Vt),p=h.fieldTransforms;return new Yr(new Tt(Co),d,p)},l.prototype.Cc=function(o,s){var c=this.Sc(1,o);ni("Data must be an object, but it was:",c,s);var h=[],d=new It;C(s,function(Co,Bo){var Lo=ii(o,Co),Uo=c.pc(Lo);if(Bo instanceof Fr)h.push(Lo);else{var Qo=Zr(Bo,Uo);Qo!=null&&(h.push(Lo),d.set(Lo,Qo))}});var p=new lt(h);return new $r(d.yt(),p,c.fieldTransforms)},l.prototype.Fc=function(o,s,c,h){var d=this.Sc(1,o),p=[ri(o,s)],Co=[c];if(h.length%2!=0)throw new I(T$1.INVALID_ARGUMENT,"Function "+o+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var Bo=0;Bo<h.length;Bo+=2)p.push(ri(o,h[Bo])),Co.push(h[Bo+1]);for(var Lo=[],Uo=new It,Qo=p.length-1;Qo>=0;--Qo)if(!oi(Lo,p[Qo])){var Po=p[Qo],Mo=Co[Qo],Go=d.pc(Po);if(Mo instanceof Fr)Lo.push(Po);else{var $o=Zr(Mo,Go);$o!=null&&(Lo.push(Po),Uo.set(Po,$o))}}var jo=new lt(Lo);return new $r(Uo.yt(),jo,d.fieldTransforms)},l.prototype.Sc=function(o,s){return new Hr({dc:o,methodName:s,path:P.G,Ec:!1},this.ii,this.serializer,this.ignoreUndefinedProperties)},l.prototype.Nc=function(o,s,c){return c===void 0&&(c=!1),Zr(s,this.Sc(c?4:3,o))},l}();function Zr(l,o){if(ei(l))return ni("Unsupported field value:",o,l),ti(l,o);if(l instanceof jr)return function(s,c){if(!Jr(c.dc))throw c.fc(s.lc+"() can only be used with update() and set()");if(c.path===null)throw c.fc(s.lc+"() is not currently supported inside arrays");var h=s.Di(c);h&&c.fieldTransforms.push(h)}(l,o),null;if(o.path&&o.Vt.push(o.path),l instanceof Array){if(o.settings.Ec&&o.dc!==4)throw o.fc("Nested arrays are not supported");return function(s,c){for(var h=[],d=0,p=0,Co=s;p<Co.length;p++){var Bo=Zr(Co[p],c.yc(d));Bo==null&&(Bo={nullValue:"NULL_VALUE"}),h.push(Bo),d++}return{arrayValue:{values:h}}}(l,o)}return function(s,c){if(s===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return c.serializer.ai(s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){var h=S.fromDate(s);return{timestampValue:c.serializer.C(h)}}if(s instanceof S){var d=new S(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:c.serializer.C(d)}}if(s instanceof Qr)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Cr)return{bytesValue:c.serializer.ui(s)};if(s instanceof Xi){var p=c.ii,Co=s.firestore.$c;if(!Co.isEqual(p))throw c.fc("Document reference is for database "+Co.projectId+"/"+Co.database+" but should be for database "+p.projectId+"/"+p.database);return{referenceValue:c.serializer._i(s.kc.path,s.firestore.$c)}}if(s===void 0&&c.ignoreUndefinedProperties)return null;throw c.fc("Unsupported field value: "+Dr(s))}(l,o)}function ti(l,o){var s={};return M(l)?o.path&&o.path.length>0&&o.Vt.push(o.path):C(l,function(c,h){var d=Zr(h,o.Vc(c));d!=null&&(s[c]=d)}),{mapValue:{fields:s}}}function ei(l){return!(typeof l!="object"||l===null||l instanceof Array||l instanceof Date||l instanceof S||l instanceof Qr||l instanceof Cr||l instanceof Xi||l instanceof jr)}function ni(l,o,s){if(!ei(s)||!kr(s)){var c=Dr(s);throw c==="an object"?o.fc(l+" a custom object"):o.fc(l+" "+c)}}function ri(l,o){if(o instanceof Mr)return o.cc;if(typeof o=="string")return ii(l,o);throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function ii(l,o){try{return function(h){if(h.search(qr)>=0)throw new I(T$1.INVALID_ARGUMENT,"Invalid field path ("+h+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Mr.bind.apply(Mr,__spreadArrays$1([void 0],h.split("."))))}catch{throw new I(T$1.INVALID_ARGUMENT,"Invalid field path ("+h+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(o).cc}catch(h){var s=(c=h)instanceof Error?c.message:c.toString();throw new I(T$1.INVALID_ARGUMENT,"Function "+l+"() called with invalid data. "+s)}var c}function oi(l,o){return l.some(function(s){return s.isEqual(o)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var si=function(){function l(o,s,c,h,d,p){this.Tr=o,this.Lc=c,this.Mc=h,this.Oc=d,this.listener=p,this.state=0,this.xc=0,this.Bc=null,this.stream=null,this.$a=new Je(o,s)}return l.prototype.qc=function(){return this.state===1||this.state===2||this.state===4},l.prototype.Uc=function(){return this.state===2},l.prototype.start=function(){this.state!==3?this.auth():this.Qc()},l.prototype.stop=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){switch(o.label){case 0:return this.qc()?[4,this.close(0)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},l.prototype.Wc=function(){this.state=0,this.$a.reset()},l.prototype.jc=function(){var o=this;this.Uc()&&this.Bc===null&&(this.Bc=this.Tr.yr(this.Lc,6e4,function(){return o.Kc()}))},l.prototype.Gc=function(o){this.zc(),this.stream.send(o)},l.prototype.Kc=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){return this.Uc()?[2,this.close(0)]:[2]})})},l.prototype.zc=function(){this.Bc&&(this.Bc.cancel(),this.Bc=null)},l.prototype.close=function(o,s){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(c){switch(c.label){case 0:return this.zc(),this.$a.cancel(),this.xc++,o!==3?this.$a.reset():s&&s.code===T$1.RESOURCE_EXHAUSTED?(De(s.toString()),De("Using maximum backoff delay to prevent overloading the backend."),this.$a.Vr()):s&&s.code===T$1.UNAUTHENTICATED&&this.Oc._(),this.stream!==null&&(this.Hc(),this.stream.close(),this.stream=null),this.state=o,[4,this.listener.Yc(s)];case 1:return c.sent(),[2]}})})},l.prototype.Hc=function(){},l.prototype.auth=function(){var o=this;this.state=1;var s=this.Jc(this.xc),c=this.xc;this.Oc.getToken().then(function(h){o.xc===c&&o.Xc(h)},function(h){s(function(){var d=new I(T$1.UNKNOWN,"Fetching auth token failed: "+h.message);return o.Zc(d)})})},l.prototype.Xc=function(o){var s=this,c=this.Jc(this.xc);this.stream=this.t_(o),this.stream.e_(function(){c(function(){return s.state=2,s.listener.e_()})}),this.stream.Yc(function(h){c(function(){return s.Zc(h)})}),this.stream.onMessage(function(h){c(function(){return s.onMessage(h)})})},l.prototype.Qc=function(){var o=this;this.state=4,this.$a.gr(function(){return __awaiter$1(o,void 0,void 0,function(){return __generator$1(this,function(s){return this.state=0,this.start(),[2]})})})},l.prototype.Zc=function(o){return ke("PersistentStream","close with error: "+o),this.stream=null,this.close(3,o)},l.prototype.Jc=function(o){var s=this;return function(c){s.Tr.uo(function(){return s.xc===o?c():(ke("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},l}(),ui=function(l){function o(s,c,h,d,p){var Co=this;return(Co=l.call(this,s,"listen_stream_connection_backoff","listen_stream_idle",c,h,p)||this).serializer=d,Co}return __extends$1(o,l),o.prototype.t_=function(s){return this.Mc.s_("Listen",s)},o.prototype.onMessage=function(s){this.$a.reset();var c=this.serializer.pi(s),h=this.serializer.bi(s);return this.listener.i_(c,h)},o.prototype.n_=function(s){var c={};c.database=this.serializer.wi,c.addTarget=this.serializer.ee(s);var h=this.serializer.zi(s);h&&(c.labels=h),this.Gc(c)},o.prototype.r_=function(s){var c={};c.database=this.serializer.wi,c.removeTarget=s,this.Gc(c)},o}(si),ai=function(l){function o(s,c,h,d,p){var Co=this;return(Co=l.call(this,s,"write_stream_connection_backoff","write_stream_idle",c,h,p)||this).serializer=d,Co.h_=!1,Co.lastStreamToken=q.ht,Co}return __extends$1(o,l),Object.defineProperty(o.prototype,"o_",{get:function(){return this.h_},enumerable:!0,configurable:!0}),o.prototype.start=function(){this.h_=!1,l.prototype.start.call(this)},o.prototype.Hc=function(){this.h_&&this.a_([])},o.prototype.t_=function(s){return this.Mc.s_("Write",s)},o.prototype.onMessage=function(s){if(Re(!!s.streamToken),this.lastStreamToken=this.serializer.ci(s.streamToken),this.h_){this.$a.reset();var c=this.serializer.Mi(s.writeResults,s.commitTime),h=this.serializer.fromVersion(s.commitTime);return this.listener.u_(h,c)}return Re(!s.writeResults||s.writeResults.length===0),this.h_=!0,this.listener.c_()},o.prototype.__=function(){var s={};s.database=this.serializer.wi,this.Gc(s)},o.prototype.a_=function(s){var c=this,h={streamToken:this.serializer.ui(this.lastStreamToken),writes:s.map(function(d){return c.serializer.vi(d)})};this.Gc(h)},o}(si),hi=function(l){function o(s,c,h){var d=this;return(d=l.call(this)||this).Mc=s,d.credentials=c,d.serializer=h,d}return __extends$1(o,l),o.prototype.d_=function(s,c){var h=this;return this.credentials.getToken().then(function(d){return h.Mc.d_(s,c,d)}).catch(function(d){throw d.code===T$1.UNAUTHENTICATED&&h.credentials._(),d})},o.prototype.f_=function(s,c){var h=this;return this.credentials.getToken().then(function(d){return h.Mc.f_(s,c,d)}).catch(function(d){throw d.code===T$1.UNAUTHENTICATED&&h.credentials._(),d})},o}(function(){this.l_=void 0}),ci=function(){function l(o){this.T_=o,this.E_=ne(),this.mutations=[],this.I_=!1,this.w_=null,this.R_=new Set}return l.prototype.A_=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c=this;return __generator$1(this,function(h){switch(h.label){case 0:if(this.m_(),this.mutations.length>0)throw new I(T$1.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(d,p){return __awaiter$1(this,void 0,void 0,function(){var Co,Bo,Lo,Uo,Qo;return __generator$1(this,function(Po){switch(Po.label){case 0:return Co=Ve(d),Bo={database:Co.serializer.wi,documents:p.map(function(Mo){return Co.serializer.fi(Mo)})},[4,Co.f_("BatchGetDocuments",Bo)];case 1:return Lo=Po.sent(),Uo=new Map,Lo.forEach(function(Mo){var Go=Co.serializer.gi(Mo);Uo.set(Go.key.toString(),Go)}),Qo=[],[2,(p.forEach(function(Mo){var Go=Uo.get(Mo.toString());Re(!!Go),Qo.push(Go)}),Qo)]}})})}(this.T_,o)];case 1:return[2,((s=h.sent()).forEach(function(d){d instanceof St||d instanceof Dt?c.P_(d):xe()}),s)]}})})},l.prototype.set=function(o,s){this.write(s.Ac(o,this.Rt(o))),this.R_.add(o)},l.prototype.update=function(o,s){try{this.write(s.Ac(o,this.V_(o)))}catch(c){this.w_=c}this.R_.add(o)},l.prototype.delete=function(o){this.write([new Et(o,this.Rt(o))]),this.R_.add(o)},l.prototype.commit=function(){return __awaiter$1(this,void 0,void 0,function(){var o,s=this;return __generator$1(this,function(c){switch(c.label){case 0:if(this.m_(),this.w_)throw this.w_;return o=this.E_,this.mutations.forEach(function(h){o=o.remove(h.key)}),o.forEach(function(h,d){s.mutations.push(new bt(h,s.Rt(h)))}),[4,function(h,d){return __awaiter$1(this,void 0,void 0,function(){var p,Co,Bo;return __generator$1(this,function(Lo){switch(Lo.label){case 0:return p=Ve(h),Co={database:p.serializer.wi,writes:d.map(function(Uo){return p.serializer.vi(Uo)})},[4,p.d_("Commit",Co)];case 1:return Bo=Lo.sent(),[2,p.serializer.Mi(Bo.writeResults,Bo.commitTime)]}})})}(this.T_,this.mutations)];case 1:return c.sent(),this.I_=!0,[2]}})})},l.prototype.P_=function(o){var s;if(o instanceof Dt)s=o.version;else{if(!(o instanceof St))throw xe();s=x.min()}var c=this.E_.get(o.key);if(c!==null){if(!s.isEqual(c))throw new I(T$1.ABORTED,"Document version changed between two reads.")}else this.E_=this.E_.Ae(o.key,s)},l.prototype.Rt=function(o){var s=this.E_.get(o);return!this.R_.has(o)&&s?yt.updateTime(s):yt.ft()},l.prototype.V_=function(o){var s=this.E_.get(o);if(!this.R_.has(o)&&s){if(s.isEqual(x.min()))throw new I(T$1.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return yt.updateTime(s)}return yt.exists(!0)},l.prototype.write=function(o){this.m_(),this.mutations=this.mutations.concat(o)},l.prototype.m_=function(){},l}(),fi=function(){function l(o,s){this.Aa=o,this.g_=s,this.state="Unknown",this.p_=0,this.y_=null,this.b_=!0}return l.prototype.v_=function(){var o=this;this.p_===0&&(this.S_("Unknown"),this.y_=this.Aa.yr("online_state_timeout",1e4,function(){return o.y_=null,o.D_("Backend didn't respond within 10 seconds."),o.S_("Offline"),Promise.resolve()}))},l.prototype.C_=function(o){this.state==="Online"?this.S_("Unknown"):(this.p_++,this.p_>=1&&(this.F_(),this.D_("Connection failed 1 times. Most recent error: "+o.toString()),this.S_("Offline")))},l.prototype.set=function(o){this.F_(),this.p_=0,o==="Online"&&(this.b_=!1),this.S_(o)},l.prototype.S_=function(o){o!==this.state&&(this.state=o,this.g_(o))},l.prototype.D_=function(o){var s="Could not reach Cloud Firestore backend. "+o+`
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.b_?(De(s),this.b_=!1):ke("OnlineStateTracker",s)},l.prototype.F_=function(){this.y_!==null&&(this.y_.cancel(),this.y_=null)},l}(),li=function(){function l(o,s,c,h,d){var p=this;this.N_=o,this.T_=s,this.Aa=c,this.k_=[],this.L_=new Map,this.M_=null,this.networkEnabled=!1,this.isPrimary=!1,this.O_=!1,this.x_=d,this.x_.B_(function(Co){c.uo(function(){return __awaiter$1(p,void 0,void 0,function(){return __generator$1(this,function(Bo){switch(Bo.label){case 0:return this.q_()?(ke("RemoteStore","Restarting streams for network reachability change."),[4,this.U_()]):[3,2];case 1:Bo.sent(),Bo.label=2;case 2:return[2]}})})})}),this.Q_=new fi(c,h),this.W_=function(Co,Bo,Lo){var Uo=Ve(Co);return new ui(Bo,Uo.Mc,Uo.credentials,Uo.serializer,Lo)}(this.T_,c,{e_:this.j_.bind(this),Yc:this.K_.bind(this),i_:this.G_.bind(this)}),this.z_=function(Co,Bo,Lo){var Uo=Ve(Co);return new ai(Bo,Uo.Mc,Uo.credentials,Uo.serializer,Lo)}(this.T_,c,{e_:this.H_.bind(this),Yc:this.Y_.bind(this),c_:this.J_.bind(this),u_:this.u_.bind(this)})}return l.prototype.start=function(){return this.enableNetwork()},l.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.X_()},l.prototype.X_=function(){return __awaiter$1(this,void 0,void 0,function(){var o;return __generator$1(this,function(s){switch(s.label){case 0:return this.q_()?(o=this.z_,[4,this.N_.Yo()]):[3,3];case 1:return o.lastStreamToken=s.sent(),this.Z_()?this.tl():this.Q_.set("Unknown"),[4,this.el()];case 2:s.sent(),s.label=3;case 3:return[2]}})})},l.prototype.disableNetwork=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){switch(o.label){case 0:return this.networkEnabled=!1,[4,this.sl()];case 1:return o.sent(),this.Q_.set("Offline"),[2]}})})},l.prototype.sl=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){switch(o.label){case 0:return[4,this.z_.stop()];case 1:return o.sent(),[4,this.W_.stop()];case 2:return o.sent(),this.k_.length>0&&(ke("RemoteStore","Stopping write stream with "+this.k_.length+" pending writes"),this.k_=[]),this.il(),[2]}})})},l.prototype.mo=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){switch(o.label){case 0:return ke("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.sl()];case 1:return o.sent(),this.x_.mo(),this.Q_.set("Unknown"),[2]}})})},l.prototype.listen=function(o){this.L_.has(o.targetId)||(this.L_.set(o.targetId,o),this.Z_()?this.tl():this.W_.Uc()&&this.nl(o))},l.prototype.rl=function(o){this.L_.delete(o),this.W_.Uc()&&this.hl(o),this.L_.size===0&&(this.W_.Uc()?this.W_.jc():this.q_()&&this.Q_.set("Unknown"))},l.prototype.si=function(o){return this.L_.get(o)||null},l.prototype.ei=function(o){return this.ol.ei(o)},l.prototype.nl=function(o){this.M_.Ns(o.targetId),this.W_.n_(o)},l.prototype.hl=function(o){this.M_.Ns(o),this.W_.r_(o)},l.prototype.tl=function(){this.M_=new ve(this),this.W_.start(),this.Q_.v_()},l.prototype.Z_=function(){return this.q_()&&!this.W_.qc()&&this.L_.size>0},l.prototype.q_=function(){return!this.O_&&this.isPrimary&&this.networkEnabled},l.prototype.il=function(){this.M_=null},l.prototype.j_=function(){return __awaiter$1(this,void 0,void 0,function(){var o=this;return __generator$1(this,function(s){return this.L_.forEach(function(c,h){o.nl(c)}),[2]})})},l.prototype.K_=function(o){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(s){return this.il(),this.Z_()?(this.Q_.C_(o),this.tl()):this.Q_.set("Unknown"),[2]})})},l.prototype.G_=function(o,s){return __awaiter$1(this,void 0,void 0,function(){var c,h,d;return __generator$1(this,function(p){switch(p.label){case 0:if(this.Q_.set("Online"),!(o instanceof de&&o.state===2&&o.cause))return[3,6];p.label=1;case 1:return p.trys.push([1,3,,5]),[4,this.al(o)];case 2:return p.sent(),[3,5];case 3:return c=p.sent(),ke("RemoteStore","Failed to remove targets %s: %s ",o.targetIds.join(","),c),[4,this.ul(c)];case 4:return p.sent(),[3,5];case 5:return[3,13];case 6:if(o instanceof le?this.M_.qs(o):o instanceof pe?this.M_.Hs(o):this.M_.Ws(o),s.isEqual(x.min()))return[3,13];p.label=7;case 7:return p.trys.push([7,11,,13]),[4,this.N_._h()];case 8:return h=p.sent(),s.S(h)>=0?[4,this.cl(s)]:[3,10];case 9:p.sent(),p.label=10;case 10:return[3,13];case 11:return ke("RemoteStore","Failed to raise snapshot:",d=p.sent()),[4,this.ul(d)];case 12:return p.sent(),[3,13];case 13:return[2]}})})},l.prototype.ul=function(o){return __awaiter$1(this,void 0,void 0,function(){var s=this;return __generator$1(this,function(c){switch(c.label){case 0:if(!Hn(o))throw o;return this.O_=!0,[4,this.sl()];case 1:return c.sent(),this.Q_.set("Offline"),this.Aa.Ua(function(){return __awaiter$1(s,void 0,void 0,function(){return __generator$1(this,function(h){switch(h.label){case 0:return ke("RemoteStore","Retrying IndexedDB access"),[4,this.N_._h()];case 1:return h.sent(),this.O_=!1,[4,this.X_()];case 2:return h.sent(),[2]}})})}),[2]}})})},l.prototype.cl=function(o){var s=this,c=this.M_.Xs(o);return c.as.forEach(function(h,d){if(h.resumeToken.rt()>0){var p=s.L_.get(d);p&&s.L_.set(d,p.we(h.resumeToken,o))}}),c.us.forEach(function(h){var d=s.L_.get(h);if(d){s.L_.set(h,d.we(q.ht,d.Ee)),s.hl(h);var p=new Ft(d.target,h,1,d.sequenceNumber);s.nl(p)}}),this.ol.Mu(c)},l.prototype.al=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h,d;return __generator$1(this,function(p){switch(p.label){case 0:s=o.cause,c=0,h=o.targetIds,p.label=1;case 1:return c<h.length?(d=h[c],this.L_.has(d)?[4,this.ol._l(d,s)]:[3,3]):[3,5];case 2:p.sent(),this.L_.delete(d),this.M_.removeTarget(d),p.label=3;case 3:p.label=4;case 4:return c++,[3,1];case 5:return[2]}})})},l.prototype.el=function(){return __awaiter$1(this,void 0,void 0,function(){var o,s;return __generator$1(this,function(c){switch(c.label){case 0:return this.ll()?(o=this.k_.length>0?this.k_[this.k_.length-1].batchId:-1,[4,this.N_.qu(o)]):[3,5];case 1:return(s=c.sent())!==null?[3,2]:(this.k_.length===0&&this.z_.jc(),[3,4]);case 2:return this.dl(s),[4,this.el()];case 3:c.sent(),c.label=4;case 4:c.label=5;case 5:return this.fl()&&this.Tl(),[2]}})})},l.prototype.ll=function(){return this.q_()&&this.k_.length<10},l.prototype.El=function(){return this.k_.length},l.prototype.dl=function(o){this.k_.push(o),this.z_.Uc()&&this.z_.o_&&this.z_.a_(o.mutations)},l.prototype.fl=function(){return this.q_()&&!this.z_.qc()&&this.k_.length>0},l.prototype.Tl=function(){this.z_.start()},l.prototype.H_=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){return this.z_.__(),[2]})})},l.prototype.J_=function(){var o=this;return this.N_.Jo(this.z_.lastStreamToken).then(function(){for(var s=0,c=o.k_;s<c.length;s++){var h=c[s];o.z_.a_(h.mutations)}}).catch(dr)},l.prototype.u_=function(o,s){var c=this,h=this.k_.shift(),d=Fe.from(h,o,s,this.z_.lastStreamToken);return this.ol.Il(d).then(function(){return c.el()})},l.prototype.Y_=function(o){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(s){switch(s.label){case 0:return o&&this.k_.length>0?this.z_.o_?[4,this.wl(o)]:[3,2]:[3,5];case 1:return s.sent(),[3,4];case 2:return[4,this.Rl(o)];case 3:s.sent(),s.label=4;case 4:this.fl()&&this.Tl(),s.label=5;case 5:return[2]}})})},l.prototype.Rl=function(o){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(s){return zt(o.code)?[2,(ke("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.z_.lastStreamToken),this.z_.lastStreamToken=q.ht,this.N_.Jo(q.ht).catch(dr))]:[2]})})},l.prototype.wl=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h=this;return __generator$1(this,function(d){return zt(c=o.code)&&c!==T$1.ABORTED?(s=this.k_.shift(),[2,(this.z_.Wc(),this.ol.Al(s.batchId,o).then(function(){return h.el()}))]):[2]})})},l.prototype.ml=function(){return new ci(this.T_)},l.prototype.U_=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){switch(o.label){case 0:return this.networkEnabled=!1,[4,this.sl()];case 1:return o.sent(),this.Q_.set("Unknown"),[4,this.enableNetwork()];case 2:return o.sent(),[2]}})})},l.prototype.Pl=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){switch(o.label){case 0:return this.q_()?(ke("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.U_()]):[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},l.prototype.Vl=function(o){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(s){switch(s.label){case 0:return this.isPrimary=o,o&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return s.sent(),[3,5];case 2:return o?[3,4]:[4,this.sl()];case 3:s.sent(),this.Q_.set("Unknown"),s.label=4;case 4:s.label=5;case 5:return[2]}})})},l}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(l,o){return"firestore_clients_"+l+"_"+o}function di(l,o,s){var c="firestore_mutations_"+l+"_"+s;return o.t()&&(c+="_"+o.uid),c}function yi(l,o){return"firestore_targets_"+l+"_"+o}var vi=function(){function l(o,s,c,h){this.user=o,this.batchId=s,this.state=c,this.error=h}return l.gl=function(o,s,c){var h=JSON.parse(c),d=typeof h=="object"&&["pending","acknowledged","rejected"].indexOf(h.state)!==-1&&(h.error===void 0||typeof h.error=="object"),p=void 0;return d&&h.error&&(d=typeof h.error.message=="string"&&typeof h.error.code=="string")&&(p=new I(h.error.code,h.error.message)),d?new l(o,s,h.state,p):(De("SharedClientState","Failed to parse mutation state for ID '"+s+"': "+c),null)},l.prototype.pl=function(){var o={state:this.state,updateTimeMs:Date.now()};return this.error&&(o.error={code:this.error.code,message:this.error.message}),JSON.stringify(o)},l}(),mi=function(){function l(o,s,c){this.targetId=o,this.state=s,this.error=c}return l.gl=function(o,s){var c=JSON.parse(s),h=typeof c=="object"&&["not-current","current","rejected"].indexOf(c.state)!==-1&&(c.error===void 0||typeof c.error=="object"),d=void 0;return h&&c.error&&(h=typeof c.error.message=="string"&&typeof c.error.code=="string")&&(d=new I(c.error.code,c.error.message)),h?new l(o,c.state,d):(De("SharedClientState","Failed to parse target state for ID '"+o+"': "+s),null)},l.prototype.pl=function(){var o={state:this.state,updateTimeMs:Date.now()};return this.error&&(o.error={code:this.error.code,message:this.error.message}),JSON.stringify(o)},l}(),gi=function(){function l(o,s){this.clientId=o,this.activeTargetIds=s}return l.gl=function(o,s){for(var c=JSON.parse(s),h=typeof c=="object"&&c.activeTargetIds instanceof Array,d=se(),p=0;h&&p<c.activeTargetIds.length;++p)h=B(c.activeTargetIds[p]),d=d.add(c.activeTargetIds[p]);return h?new l(o,d):(De("SharedClientState","Failed to parse client data for instance '"+o+"': "+s),null)},l}(),wi=function(){function l(o,s){this.clientId=o,this.onlineState=s}return l.gl=function(o){var s=JSON.parse(o);return typeof s=="object"&&["Unknown","Online","Offline"].indexOf(s.onlineState)!==-1&&typeof s.clientId=="string"?new l(s.clientId,s.onlineState):(De("SharedClientState","Failed to parse online state: "+o),null)},l}(),Ei=function(){function l(){this.activeTargetIds=se()}return l.prototype.yl=function(o){this.activeTargetIds=this.activeTargetIds.add(o)},l.prototype.bl=function(o){this.activeTargetIds=this.activeTargetIds.delete(o)},l.prototype.pl=function(){var o={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(o)},l}(),bi=function(){function l(o,s,c,h,d){if(this.Tr=o,this.platform=s,this.persistenceKey=c,this.vl=h,this.ol=null,this.g_=null,this.ur=null,this.Sl=this.Dl.bind(this),this.Cl=new Wt(Pe),this.ro=!1,this.Fl=[],!l.Gh(this.platform))throw new I(T$1.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var p=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=d,this.Nl=pi(this.persistenceKey,this.vl),this.$l=function(Co){return"firestore_sequence_number_"+Co}(this.persistenceKey),this.Cl=this.Cl.Ae(this.vl,new Ei),this.kl=new RegExp("^firestore_clients_"+p+"_([^_]*)$"),this.Ll=new RegExp("^firestore_mutations_"+p+"_(\\d+)(?:_(.*))?$"),this.Ml=new RegExp("^firestore_targets_"+p+"_(\\d+)$"),this.Ol=function(Co){return"firestore_online_state_"+Co}(this.persistenceKey),this.platform.window.addEventListener("storage",this.Sl)}return l.Gh=function(o){return!(!o.window||o.window.localStorage==null)},l.prototype.start=function(){return __awaiter$1(this,void 0,void 0,function(){var o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po=this;return __generator$1(this,function(Mo){switch(Mo.label){case 0:return[4,this.ol.bo()];case 1:for(o=Mo.sent(),s=0,c=o;s<c.length;s++)(h=c[s])!==this.vl&&(d=this.getItem(pi(this.persistenceKey,h)))&&(p=gi.gl(h,d))&&(this.Cl=this.Cl.Ae(p.clientId,p));for(this.xl(),(Co=this.storage.getItem(this.Ol))&&(Bo=this.Bl(Co))&&this.ql(Bo),Lo=0,Uo=this.Fl;Lo<Uo.length;Lo++)Qo=Uo[Lo],this.Dl(Qo);return this.Fl=[],this.platform.window.addEventListener("unload",function(){return Po.mo()}),this.ro=!0,[2]}})})},l.prototype.lr=function(o){this.setItem(this.$l,JSON.stringify(o))},l.prototype.Ul=function(){return this.Ql(this.Cl)},l.prototype.Wl=function(o){var s=!1;return this.Cl.forEach(function(c,h){h.activeTargetIds.has(o)&&(s=!0)}),s},l.prototype.jl=function(o){this.Kl(o,"pending")},l.prototype.Gl=function(o,s,c){this.Kl(o,s,c),this.zl(o)},l.prototype.Hl=function(o){var s="not-current";if(this.Wl(o)){var c=this.storage.getItem(yi(this.persistenceKey,o));if(c){var h=mi.gl(o,c);h&&(s=h.state)}}return this.Yl.yl(o),this.xl(),s},l.prototype.Jl=function(o){this.Yl.bl(o),this.xl()},l.prototype.Xl=function(o){return this.Yl.activeTargetIds.has(o)},l.prototype.Zl=function(o){this.removeItem(yi(this.persistenceKey,o))},l.prototype.td=function(o,s,c){this.ed(o,s,c)},l.prototype.Du=function(o,s,c){var h=this;s.forEach(function(d){h.zl(d)}),this.currentUser=o,c.forEach(function(d){h.jl(d)})},l.prototype.sd=function(o){this.nd(o)},l.prototype.mo=function(){this.ro&&(this.platform.window.removeEventListener("storage",this.Sl),this.removeItem(this.Nl),this.ro=!1)},l.prototype.getItem=function(o){var s=this.storage.getItem(o);return ke("SharedClientState","READ",o,s),s},l.prototype.setItem=function(o,s){ke("SharedClientState","SET",o,s),this.storage.setItem(o,s)},l.prototype.removeItem=function(o){ke("SharedClientState","REMOVE",o),this.storage.removeItem(o)},l.prototype.Dl=function(o){var s=this;if(o.storageArea===this.storage){if(ke("SharedClientState","EVENT",o.key,o.newValue),o.key===this.Nl)return void De("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Tr.Ua(function(){return __awaiter$1(s,void 0,void 0,function(){var c,h,d,p,Co,Bo;return __generator$1(this,function(Lo){if(this.ro){if(o.key!==null)if(this.kl.test(o.key)){if(o.newValue==null)return c=this.rd(o.key),[2,this.hd(c,null)];if(h=this.od(o.key,o.newValue))return[2,this.hd(h.clientId,h)]}else if(this.Ll.test(o.key)){if(o.newValue!==null&&(d=this.ad(o.key,o.newValue)))return[2,this.ud(d)]}else if(this.Ml.test(o.key)){if(o.newValue!==null&&(p=this._d(o.key,o.newValue)))return[2,this.ld(p)]}else if(o.key===this.Ol){if(o.newValue!==null&&(Co=this.Bl(o.newValue)))return[2,this.ql(Co)]}else o.key===this.$l&&(Bo=function(Uo){var Qo=Ye.dr;if(Uo!=null)try{var Po=JSON.parse(Uo);Re(typeof Po=="number"),Qo=Po}catch(Mo){De("SharedClientState","Failed to read sequence number from WebStorage",Mo)}return Qo}(o.newValue))!==Ye.dr&&this.ur(Bo)}else this.Fl.push(o);return[2]})})})}},Object.defineProperty(l.prototype,"Yl",{get:function(){return this.Cl.get(this.vl)},enumerable:!0,configurable:!0}),l.prototype.xl=function(){this.setItem(this.Nl,this.Yl.pl())},l.prototype.Kl=function(o,s,c){var h=new vi(this.currentUser,o,s,c),d=di(this.persistenceKey,this.currentUser,o);this.setItem(d,h.pl())},l.prototype.zl=function(o){var s=di(this.persistenceKey,this.currentUser,o);this.removeItem(s)},l.prototype.nd=function(o){var s={clientId:this.vl,onlineState:o};this.storage.setItem(this.Ol,JSON.stringify(s))},l.prototype.ed=function(o,s,c){var h=yi(this.persistenceKey,o),d=new mi(o,s,c);this.setItem(h,d.pl())},l.prototype.rd=function(o){var s=this.kl.exec(o);return s?s[1]:null},l.prototype.od=function(o,s){var c=this.rd(o);return gi.gl(c,s)},l.prototype.ad=function(o,s){var c=this.Ll.exec(o),h=Number(c[1]),d=c[2]!==void 0?c[2]:null;return vi.gl(new b(d),h,s)},l.prototype._d=function(o,s){var c=this.Ml.exec(o),h=Number(c[1]);return mi.gl(h,s)},l.prototype.Bl=function(o){return wi.gl(o)},l.prototype.ud=function(o){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(s){return o.user.uid===this.currentUser.uid?[2,this.ol.dd(o.batchId,o.state,o.error)]:(ke("SharedClientState","Ignoring mutation for non-active user "+o.user.uid),[2])})})},l.prototype.ld=function(o){return this.ol.fd(o.targetId,o.state,o.error)},l.prototype.hd=function(o,s){var c=this,h=s?this.Cl.Ae(o,s):this.Cl.remove(o),d=this.Ql(this.Cl),p=this.Ql(h),Co=[],Bo=[];return p.forEach(function(Lo){d.has(Lo)||Co.push(Lo)}),d.forEach(function(Lo){p.has(Lo)||Bo.push(Lo)}),this.ol.Td(Co,Bo).then(function(){c.Cl=h})},l.prototype.ql=function(o){this.Cl.get(o.clientId)&&this.g_(o.onlineState)},l.prototype.Ql=function(o){var s=se();return o.forEach(function(c,h){s=s.He(h.activeTargetIds)}),s},l}(),Ti=function(){function l(){this.Ed=new Ei,this.Id={},this.ol=null,this.g_=null,this.ur=null}return l.prototype.jl=function(o){},l.prototype.Gl=function(o,s,c){},l.prototype.Hl=function(o){return this.Ed.yl(o),this.Id[o]||"not-current"},l.prototype.td=function(o,s,c){this.Id[o]=s},l.prototype.Jl=function(o){this.Ed.bl(o)},l.prototype.Xl=function(o){return this.Ed.activeTargetIds.has(o)},l.prototype.Zl=function(o){delete this.Id[o]},l.prototype.Ul=function(){return this.Ed.activeTargetIds},l.prototype.Wl=function(o){return this.Ed.activeTargetIds.has(o)},l.prototype.start=function(){return this.Ed=new Ei,Promise.resolve()},l.prototype.Du=function(o,s,c){},l.prototype.sd=function(o){},l.prototype.mo=function(){},l.prototype.lr=function(o){},l}(),Ii=function(l){this.key=l},Ni=function(l){this.key=l},Ai=function(){function l(o,s){this.query=o,this.wd=s,this.Rd=null,this.fs=!1,this.Ad=ie(),this.ns=ie(),this.md=new ue(o.se.bind(o))}return Object.defineProperty(l.prototype,"Pd",{get:function(){return this.wd},enumerable:!0,configurable:!0}),l.prototype.Vd=function(o,s){var c=this,h=s?s.gd:new ae,d=s?s.md:this.md,p=s?s.ns:this.ns,Co=d,Bo=!1,Lo=this.query.oe()&&d.size===this.query.limit?d.last():null,Uo=this.query.ae()&&d.size===this.query.limit?d.first():null;if(o.pe(function(Po,Mo){var Go=d.get(Po),$o=Mo instanceof Dt?Mo:null;$o&&($o=c.query.matches($o)?$o:null);var jo=!!Go&&c.ns.has(Go.key),zo=!!$o&&($o.At||c.ns.has($o.key)&&$o.hasCommittedMutations),Xo=!1;Go&&$o?Go.data().isEqual($o.data())?jo!==zo&&(h.track({type:3,doc:$o}),Xo=!0):c.pd(Go,$o)||(h.track({type:2,doc:$o}),Xo=!0,(Lo&&c.query.se($o,Lo)>0||Uo&&c.query.se($o,Uo)<0)&&(Bo=!0)):!Go&&$o?(h.track({type:0,doc:$o}),Xo=!0):Go&&!$o&&(h.track({type:1,doc:Go}),Xo=!0,(Lo||Uo)&&(Bo=!0)),Xo&&($o?(Co=Co.add($o),p=zo?p.add(Po):p.delete(Po)):(Co=Co.delete(Po),p=p.delete(Po)))}),this.query.oe()||this.query.ae())for(;Co.size>this.query.limit;){var Qo=this.query.oe()?Co.last():Co.first();Co=Co.delete(Qo.key),p=p.delete(Qo.key),h.track({type:1,doc:Qo})}return{md:Co,gd:h,yd:Bo,ns:p}},l.prototype.pd=function(o,s){return o.At&&s.hasCommittedMutations&&!s.At},l.prototype.xn=function(o,s,c){var h=this,d=this.md;this.md=o.md,this.ns=o.ns;var p=o.gd.es();p.sort(function(Uo,Qo){return function(Po,Mo){var Go=function($o){switch($o){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xe()}};return Go(Po)-Go(Mo)}(Uo.type,Qo.type)||h.query.se(Uo.doc,Qo.doc)}),this.bd(c);var Co=s?this.vd():[],Bo=this.Ad.size===0&&this.fs?1:0,Lo=Bo!==this.Rd;return this.Rd=Bo,p.length!==0||Lo?{snapshot:new he(this.query,o.md,d,p,o.ns,Bo===0,Lo,!1),Sd:Co}:{Sd:Co}},l.prototype.Dd=function(o){return this.fs&&o==="Offline"?(this.fs=!1,this.xn({md:this.md,gd:new ae,ns:this.ns,yd:!1},!1)):{Sd:[]}},l.prototype.Cd=function(o){return!this.wd.has(o)&&!!this.md.has(o)&&!this.md.get(o).At},l.prototype.bd=function(o){var s=this;o&&(o.Ts.forEach(function(c){return s.wd=s.wd.add(c)}),o.Es.forEach(function(c){}),o.Is.forEach(function(c){return s.wd=s.wd.delete(c)}),this.fs=o.fs)},l.prototype.vd=function(){var o=this;if(!this.fs)return[];var s=this.Ad;this.Ad=ie(),this.md.forEach(function(h){o.Cd(h.key)&&(o.Ad=o.Ad.add(h.key))});var c=[];return s.forEach(function(h){o.Ad.has(h)||c.push(new Ni(h))}),this.Ad.forEach(function(h){s.has(h)||c.push(new Ii(h))}),c},l.prototype.Fd=function(o){this.wd=o.Ku,this.Ad=ie();var s=this.Vd(o.documents);return this.xn(s,!0)},l.prototype.Nd=function(){return he.os(this.query,this.md,this.ns,this.Rd===0)},l}(),_i=function(){function l(o,s,c,h){this.Aa=o,this.$d=s,this.updateFunction=c,this.Va=h,this.kd=5,this.$a=new Je(this.Aa,"transaction_retry")}return l.prototype.Ld=function(){this.Md()},l.prototype.Md=function(){var o=this;this.$a.gr(function(){return __awaiter$1(o,void 0,void 0,function(){var s,c,h=this;return __generator$1(this,function(d){return s=this.$d.ml(),(c=this.Od(s))&&c.then(function(p){h.Aa.uo(function(){return s.commit().then(function(){h.Va.resolve(p)}).catch(function(Co){h.xd(Co)})})}).catch(function(p){h.xd(p)}),[2]})})})},l.prototype.Od=function(o){try{var s=this.updateFunction(o);return!j(s)&&s.catch&&s.then?s:(this.Va.reject(Error("Transaction callback must return a Promise")),null)}catch(c){return this.Va.reject(c),null}},l.prototype.xd=function(o){var s=this;this.kd>0&&this.Bd(o)?(this.kd-=1,this.Aa.uo(function(){return s.Md(),Promise.resolve()})):this.Va.reject(o)},l.prototype.Bd=function(o){if(o.name==="FirebaseError"){var s=o.code;return s==="aborted"||s==="failed-precondition"||!zt(s)}return!1},l}(),ki=function(l,o,s){this.query=l,this.targetId=o,this.view=s},Di=function(l){this.key=l,this.qd=!1},Si=function(){function l(o,s,c,h,d){this.N_=o,this.$d=s,this.Ud=c,this.currentUser=h,this.Qd=d,this.Wd=null,this.jd=new qe(function(p){return p.canonicalId()}),this.Kd=new Map,this.Gd=[],this.zd=new Wt(L$1.N),this.Hd=new Map,this.Yd=new yr,this.Jd={},this.Xd=new Map,this.Zd=fn.rh(),this.onlineState="Unknown"}return Object.defineProperty(l.prototype,"tf",{get:function(){return!0},enumerable:!0,configurable:!0}),l.prototype.subscribe=function(o){this.Wd=o},l.prototype.listen=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h,d,p;return __generator$1(this,function(Co){switch(Co.label){case 0:return this.ef("listen()"),(h=this.jd.get(o))?(s=h.targetId,this.Ud.Hl(s),c=h.view.Nd(),[3,4]):[3,1];case 1:return[4,this.N_.Qu(o.ee())];case 2:return d=Co.sent(),p=this.Ud.Hl(d.targetId),s=d.targetId,[4,this.sf(o,s,p==="current")];case 3:c=Co.sent(),this.tf&&this.$d.listen(d),Co.label=4;case 4:return[2,c]}})})},l.prototype.sf=function(o,s,c){return __awaiter$1(this,void 0,void 0,function(){var h,d,p,Co,Bo,Lo;return __generator$1(this,function(Uo){switch(Uo.label){case 0:return[4,this.N_.ju(o,!0)];case 1:return h=Uo.sent(),d=new Ai(o,h.Ku),p=d.Vd(h.documents),Co=fe.ds(s,c&&this.onlineState!=="Offline"),Bo=d.xn(p,this.tf,Co),this.if(s,Bo.Sd),Lo=new ki(o,s,d),[2,(this.jd.set(o,Lo),this.Kd.has(s)?this.Kd.get(s).push(o):this.Kd.set(s,[o]),Bo.snapshot)]}})})},l.prototype.rl=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h=this;return __generator$1(this,function(d){switch(d.label){case 0:return this.ef("unlisten()"),s=this.jd.get(o),(c=this.Kd.get(s.targetId)).length>1?[2,(this.Kd.set(s.targetId,c.filter(function(p){return!p.isEqual(o)})),void this.jd.delete(o))]:this.tf?(this.Ud.Jl(s.targetId),this.Ud.Wl(s.targetId)?[3,2]:[4,this.N_.Wu(s.targetId,!1).then(function(){h.Ud.Zl(s.targetId),h.$d.rl(s.targetId),h.nf(s.targetId)}).catch(dr)]):[3,3];case 1:d.sent(),d.label=2;case 2:return[3,5];case 3:return this.nf(s.targetId),[4,this.N_.Wu(s.targetId,!0)];case 4:d.sent(),d.label=5;case 5:return[2]}})})},l.prototype.write=function(o,s){return __awaiter$1(this,void 0,void 0,function(){var c,h,d;return __generator$1(this,function(p){switch(p.label){case 0:this.ef("write()"),p.label=1;case 1:return p.trys.push([1,5,,6]),[4,this.N_.$u(o)];case 2:return c=p.sent(),this.Ud.jl(c.batchId),this.rf(c.batchId,s),[4,this.hf(c.Dn)];case 3:return p.sent(),[4,this.$d.el()];case 4:return p.sent(),[3,6];case 5:return h=p.sent(),d=or(h,"Failed to persist write"),s.reject(d),[3,6];case 6:return[2]}})})},l.prototype.runTransaction=function(o,s,c){new _i(o,this.$d,s,c).Ld()},l.prototype.Mu=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c=this;return __generator$1(this,function(h){switch(h.label){case 0:this.ef("applyRemoteEvent()"),h.label=1;case 1:return h.trys.push([1,4,,6]),[4,this.N_.Mu(o)];case 2:return s=h.sent(),o.as.forEach(function(d,p){var Co=c.Hd.get(p);Co&&(Re(d.Ts.size+d.Es.size+d.Is.size<=1),d.Ts.size>0?Co.qd=!0:d.Es.size>0?Re(Co.qd):d.Is.size>0&&(Re(Co.qd),Co.qd=!1))}),[4,this.hf(s,o)];case 3:return h.sent(),[3,6];case 4:return[4,dr(h.sent())];case 5:return h.sent(),[3,6];case 6:return[2]}})})},l.prototype.Dd=function(o,s){this.ef("applyOnlineStateChange()");var c=[];this.jd.forEach(function(h,d){var p=d.view.Dd(o);p.snapshot&&c.push(p.snapshot)}),this.Wd.af(o),this.Wd.i_(c),this.onlineState=o},l.prototype._l=function(o,s){return __awaiter$1(this,void 0,void 0,function(){var c,h,d,p,Co,Bo=this;return __generator$1(this,function(Lo){switch(Lo.label){case 0:return this.ef("rejectListens()"),this.Ud.td(o,"rejected",s),c=this.Hd.get(o),(h=c&&c.key)?(d=(d=new Wt(L$1.N)).Ae(h,new St(h,x.min())),p=ie().add(h),Co=new ce(x.min(),new Map,new Yt(Pe),d,p),[4,this.Mu(Co)]):[3,2];case 1:return Lo.sent(),this.zd=this.zd.remove(h),this.Hd.delete(o),this.uf(),[3,4];case 2:return[4,this.N_.Wu(o,!1).then(function(){return Bo.nf(o,s)}).catch(dr)];case 3:Lo.sent(),Lo.label=4;case 4:return[2]}})})},l.prototype.Il=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c;return __generator$1(this,function(h){switch(h.label){case 0:this.ef("applySuccessfulWrite()"),s=o.batch.batchId,this.cf(s,null),this._f(s),h.label=1;case 1:return h.trys.push([1,4,,6]),[4,this.N_.zo(o)];case 2:return c=h.sent(),this.Ud.Gl(s,"acknowledged"),[4,this.hf(c)];case 3:return h.sent(),[3,6];case 4:return[4,dr(h.sent())];case 5:return h.sent(),[3,6];case 6:return[2]}})})},l.prototype.Al=function(o,s){return __awaiter$1(this,void 0,void 0,function(){var c;return __generator$1(this,function(h){switch(h.label){case 0:this.ef("rejectFailedWrite()"),this.cf(o,s),this._f(o),h.label=1;case 1:return h.trys.push([1,4,,6]),[4,this.N_.Lu(o)];case 2:return c=h.sent(),this.Ud.Gl(o,"rejected",s),[4,this.hf(c)];case 3:return h.sent(),[3,6];case 4:return[4,dr(h.sent())];case 5:return h.sent(),[3,6];case 6:return[2]}})})},l.prototype.lf=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h,d;return __generator$1(this,function(p){switch(p.label){case 0:this.$d.q_()||ke("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.N_.sa()];case 2:return(s=p.sent())===-1?[2,void o.resolve()]:((c=this.Xd.get(s)||[]).push(o),this.Xd.set(s,c),[3,4]);case 3:return h=p.sent(),d=or(h,"Initialization of waitForPendingWrites() operation failed"),o.reject(d),[3,4];case 4:return[2]}})})},l.prototype._f=function(o){(this.Xd.get(o)||[]).forEach(function(s){s.resolve()}),this.Xd.delete(o)},l.prototype.df=function(o){this.Xd.forEach(function(s){s.forEach(function(c){c.reject(new I(T$1.CANCELLED,o))})}),this.Xd.clear()},l.prototype.rf=function(o,s){var c=this.Jd[this.currentUser.s()];c||(c=new Wt(Pe)),c=c.Ae(o,s),this.Jd[this.currentUser.s()]=c},l.prototype.cf=function(o,s){var c=this.Jd[this.currentUser.s()];if(c){var h=c.get(o);h&&(s?h.reject(s):h.resolve(),c=c.remove(o)),this.Jd[this.currentUser.s()]=c}},l.prototype.nf=function(o,s){var c=this;s===void 0&&(s=null),this.Ud.Jl(o);for(var h=0,d=this.Kd.get(o);h<d.length;h++){var p=d[h];this.jd.delete(p),s&&this.Wd.ff(p,s)}this.Kd.delete(o),this.tf&&this.Yd.nc(o).forEach(function(Co){c.Yd.Ch(Co)||c.Tf(Co)})},l.prototype.Tf=function(o){var s=this.zd.get(o);s!==null&&(this.$d.rl(s),this.zd=this.zd.remove(o),this.Hd.delete(s),this.uf())},l.prototype.if=function(o,s){for(var c=0,h=s;c<h.length;c++){var d=h[c];d instanceof Ii?(this.Yd.yh(d.key,o),this.Ef(d)):d instanceof Ni?(ke("SyncEngine","Document no longer in limbo: "+d.key),this.Yd.vh(d.key,o),this.Yd.Ch(d.key)||this.Tf(d.key)):xe()}},l.prototype.Ef=function(o){var s=o.key;this.zd.get(s)||(ke("SyncEngine","New document in limbo: "+s),this.Gd.push(s),this.uf())},l.prototype.uf=function(){for(;this.Gd.length>0&&this.zd.size<this.Qd;){var o=this.Gd.shift(),s=this.Zd.next();this.Hd.set(s,new Di(o)),this.zd=this.zd.Ae(o,s),this.$d.listen(new Ft(Vt.Wt(o.path).ee(),s,2,Ye.dr))}},l.prototype.If=function(){return this.zd},l.prototype.wf=function(){return this.Gd},l.prototype.hf=function(o,s){return __awaiter$1(this,void 0,void 0,function(){var c,h,d,p=this;return __generator$1(this,function(Co){switch(Co.label){case 0:return c=[],h=[],d=[],this.jd.forEach(function(Bo,Lo){d.push(Promise.resolve().then(function(){var Uo=Lo.view.Vd(o);return Uo.yd?p.N_.ju(Lo.query,!1).then(function(Qo){var Po=Qo.documents;return Lo.view.Vd(Po,Uo)}):Uo}).then(function(Uo){var Qo=s&&s.as.get(Lo.targetId),Po=Lo.view.xn(Uo,p.tf,Qo);if(p.if(Lo.targetId,Po.Sd),Po.snapshot){p.tf&&p.Ud.td(Lo.targetId,Po.snapshot.fromCache?"not-current":"current"),c.push(Po.snapshot);var Mo=Ke.ar(Lo.targetId,Po.snapshot);h.push(Mo)}}))}),[4,Promise.all(d)];case 1:return Co.sent(),this.Wd.i_(c),[4,this.N_.Bu(h)];case 2:return Co.sent(),[2]}})})},l.prototype.ef=function(o){},l.prototype.Pl=function(o){return __awaiter$1(this,void 0,void 0,function(){var s;return __generator$1(this,function(c){switch(c.label){case 0:return this.currentUser.isEqual(o)?[3,3]:[4,this.N_.Du(o)];case 1:return s=c.sent(),this.currentUser=o,this.df("'waitForPendingWrites' promise is rejected due to a user change."),this.Ud.Du(o,s.Fu,s.Nu),[4,this.hf(s.Cu)];case 2:c.sent(),c.label=3;case 3:return[4,this.$d.Pl()];case 4:return c.sent(),[2]}})})},l.prototype.enableNetwork=function(){return this.$d.enableNetwork()},l.prototype.disableNetwork=function(){return this.$d.disableNetwork()},l.prototype.ei=function(o){var s=this.Hd.get(o);if(s&&s.qd)return ie().add(s.key);var c=ie(),h=this.Kd.get(o);if(!h)return c;for(var d=0,p=h;d<p.length;d++){var Co=p[d],Bo=this.jd.get(Co);c=c.He(Bo.view.Pd)}return c},l}(),xi=function(l){function o(s,c,h,d,p){var Co=this;return(Co=l.call(this,s,c,h,d,p)||this).N_=s,Co.Rf=void 0,Co}return __extends$1(o,l),Object.defineProperty(o.prototype,"tf",{get:function(){return this.Rf===!0},enumerable:!0,configurable:!0}),o.prototype.enableNetwork=function(){return this.N_.ao(!0),l.prototype.enableNetwork.call(this)},o.prototype.disableNetwork=function(){return this.N_.ao(!1),l.prototype.disableNetwork.call(this)},o.prototype.Af=function(s){return __awaiter$1(this,void 0,void 0,function(){var c,h;return __generator$1(this,function(d){switch(d.label){case 0:return[4,this.N_.ju(s.query,!0)];case 1:return c=d.sent(),h=s.view.Fd(c),[2,(this.Rf&&this.if(s.targetId,h.Sd),h)]}})})},o.prototype.Dd=function(s,c){this.tf&&c===0&&(l.prototype.Dd.call(this,s,c),this.Ud.sd(s)),this.tf||c!==1||l.prototype.Dd.call(this,s,c)},o.prototype.dd=function(s,c,h){return __awaiter$1(this,void 0,void 0,function(){var d;return __generator$1(this,function(p){switch(p.label){case 0:return this.ef("applyBatchState()"),[4,this.N_.zu(s)];case 1:return(d=p.sent())===null?[3,6]:c!=="pending"?[3,3]:[4,this.$d.el()];case 2:return p.sent(),[3,4];case 3:c==="acknowledged"||c==="rejected"?(this.cf(s,h||null),this.N_.Hu(s)):xe(),p.label=4;case 4:return[4,this.hf(d)];case 5:return p.sent(),[3,7];case 6:ke("SyncEngine","Cannot apply mutation batch with id: "+s),p.label=7;case 7:return[2]}})})},o.prototype.Vl=function(s){return __awaiter$1(this,void 0,void 0,function(){var c,h,d,p,Co,Bo,Lo,Uo=this;return __generator$1(this,function(Qo){switch(Qo.label){case 0:return s!==!0||this.Rf===!0?[3,3]:(c=this.Ud.Ul(),[4,this.mf(c.W(),!0)]);case 1:return h=Qo.sent(),this.Rf=!0,[4,this.$d.Vl(!0)];case 2:for(Qo.sent(),d=0,p=h;d<p.length;d++)Co=p[d],this.$d.listen(Co);return[3,7];case 3:return s!==!1||this.Rf===!1?[3,7]:(Bo=[],Lo=Promise.resolve(),this.Kd.forEach(function(Po,Mo){Uo.Ud.Xl(Mo)?Bo.push(Mo):Lo=Lo.then(function(){return Uo.nf(Mo),Uo.N_.Wu(Mo,!0)}),Uo.$d.rl(Mo)}),[4,Lo]);case 4:return Qo.sent(),[4,this.mf(Bo,!1)];case 5:return Qo.sent(),this.Pf(),this.Rf=!1,[4,this.$d.Vl(!1)];case 6:Qo.sent(),Qo.label=7;case 7:return[2]}})})},o.prototype.Pf=function(){var s=this;this.Hd.forEach(function(c,h){s.$d.rl(h)}),this.Yd.rc(),this.Hd=new Map,this.zd=new Wt(L$1.N)},o.prototype.mf=function(s,c){return __awaiter$1(this,void 0,void 0,function(){var h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo;return __generator$1(this,function(zo){switch(zo.label){case 0:h=[],d=[],p=0,Co=s,zo.label=1;case 1:return p<Co.length?(Bo=Co[p],Lo=void 0,(Uo=this.Kd.get(Bo))&&Uo.length!==0?[4,this.N_.Wu(Bo,!0)]:[3,8]):[3,14];case 2:return zo.sent(),[4,this.N_.Qu(Uo[0].ee())];case 3:Lo=zo.sent(),Qo=0,Po=Uo,zo.label=4;case 4:return Qo<Po.length?(Mo=Po[Qo],Go=this.jd.get(Mo),[4,this.Af(Go)]):[3,7];case 5:($o=zo.sent()).snapshot&&d.push($o.snapshot),zo.label=6;case 6:return Qo++,[3,4];case 7:return[3,12];case 8:return[4,this.N_.Yu(Bo)];case 9:return jo=zo.sent(),[4,this.N_.Qu(jo)];case 10:return Lo=zo.sent(),[4,this.sf(this.Vf(jo),Bo,!1)];case 11:zo.sent(),zo.label=12;case 12:h.push(Lo),zo.label=13;case 13:return p++,[3,1];case 14:return[2,(this.Wd.i_(d),h)]}})})},o.prototype.Vf=function(s){return new Vt(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)},o.prototype.bo=function(){return this.N_.bo()},o.prototype.fd=function(s,c,h){return __awaiter$1(this,void 0,void 0,function(){var d,p;return __generator$1(this,function(Co){switch(Co.label){case 0:return this.Rf?(ke("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.Kd.has(s))return[3,8];switch(c){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.N_.Kr()];case 3:return d=Co.sent(),p=ce.ls(s,c==="current"),[4,this.hf(d,p)];case 4:return Co.sent(),[3,8];case 5:return[4,this.N_.Wu(s,!0)];case 6:return Co.sent(),this.nf(s,h),[3,8];case 7:xe(),Co.label=8;case 8:return[2]}})})},o.prototype.Td=function(s,c){return __awaiter$1(this,void 0,void 0,function(){var h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go=this;return __generator$1(this,function($o){switch($o.label){case 0:if(!this.Rf)return[3,10];h=0,d=s,$o.label=1;case 1:return h<d.length?(p=d[h],this.Kd.has(p)?(ke("SyncEngine","Adding an already active target "+p),[3,5]):[4,this.N_.Yu(p)]):[3,6];case 2:return Co=$o.sent(),[4,this.N_.Qu(Co)];case 3:return Bo=$o.sent(),[4,this.sf(this.Vf(Co),Bo.targetId,!1)];case 4:$o.sent(),this.$d.listen(Bo),$o.label=5;case 5:return h++,[3,1];case 6:Lo=function(jo){return __generator$1(this,function(zo){switch(zo.label){case 0:return Uo.Kd.has(jo)?[4,Uo.N_.Wu(jo,!1).then(function(){Go.$d.rl(jo),Go.nf(jo)}).catch(dr)]:[3,2];case 1:zo.sent(),zo.label=2;case 2:return[2]}})},Uo=this,Qo=0,Po=c,$o.label=7;case 7:return Qo<Po.length?(Mo=Po[Qo],[5,Lo(Mo)]):[3,10];case 8:$o.sent(),$o.label=9;case 9:return Qo++,[3,7];case 10:return[2]}})})},o}(Si),Ri=function(){this.gf=void 0,this.pf=[]},Vi=function(){function l(o){this.ol=o,this.yf=new qe(function(s){return s.canonicalId()}),this.onlineState="Unknown",this.bf=new Set,this.ol.subscribe(this)}return l.prototype.listen=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h,d,p,Co;return __generator$1(this,function(Bo){switch(Bo.label){case 0:if(s=o.query,c=!1,(h=this.yf.get(s))||(c=!0,h=new Ri),!c)return[3,4];Bo.label=1;case 1:return Bo.trys.push([1,3,,4]),d=h,[4,this.ol.listen(s)];case 2:return d.gf=Bo.sent(),[3,4];case 3:return p=Bo.sent(),Co=or(p,"Initialization of query '"+o.query+"' failed"),[2,void o.onError(Co)];case 4:return this.yf.set(s,h),h.pf.push(o),o.Dd(this.onlineState),h.gf&&o.vf(h.gf)&&this.Sf(),[2]}})})},l.prototype.rl=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c,h,d;return __generator$1(this,function(p){return s=o.query,c=!1,(h=this.yf.get(s))&&(d=h.pf.indexOf(o))>=0&&(h.pf.splice(d,1),c=h.pf.length===0),c?[2,(this.yf.delete(s),this.ol.rl(s))]:[2]})})},l.prototype.i_=function(o){for(var s=!1,c=0,h=o;c<h.length;c++){var d=h[c],p=d.query,Co=this.yf.get(p);if(Co){for(var Bo=0,Lo=Co.pf;Bo<Lo.length;Bo++)Lo[Bo].vf(d)&&(s=!0);Co.gf=d}}s&&this.Sf()},l.prototype.ff=function(o,s){var c=this.yf.get(o);if(c)for(var h=0,d=c.pf;h<d.length;h++)d[h].onError(s);this.yf.delete(o)},l.prototype.af=function(o){this.onlineState=o;var s=!1;this.yf.forEach(function(c,h){for(var d=0,p=h.pf;d<p.length;d++)p[d].Dd(o)&&(s=!0)}),s&&this.Sf()},l.prototype.Df=function(o){this.bf.add(o),o.next()},l.prototype.Cf=function(o){this.bf.delete(o)},l.prototype.Sf=function(){this.bf.forEach(function(o){o.next()})},l}(),Oi=function(){function l(o,s,c){this.query=o,this.Ff=s,this.Nf=!1,this.$f=null,this.onlineState="Unknown",this.options=c||{}}return l.prototype.vf=function(o){if(!this.options.includeMetadataChanges){for(var s=[],c=0,h=o.docChanges;c<h.length;c++){var d=h[c];d.type!==3&&s.push(d)}o=new he(o.query,o.docs,o.ss,s,o.ns,o.fromCache,o.rs,!0)}var p=!1;return this.Nf?this.kf(o)&&(this.Ff.next(o),p=!0):this.Lf(o,this.onlineState)&&(this.Mf(o),p=!0),this.$f=o,p},l.prototype.onError=function(o){this.Ff.error(o)},l.prototype.Dd=function(o){this.onlineState=o;var s=!1;return this.$f&&!this.Nf&&this.Lf(this.$f,o)&&(this.Mf(this.$f),s=!0),s},l.prototype.Lf=function(o,s){if(!o.fromCache)return!0;var c=s!=="Offline";return!(this.options.Of&&c||o.docs.B()&&s!=="Offline")},l.prototype.kf=function(o){if(o.docChanges.length>0)return!0;var s=this.$f&&this.$f.hasPendingWrites!==o.hasPendingWrites;return!(!o.rs&&!s)&&this.options.includeMetadataChanges===!0},l.prototype.Mf=function(o){o=he.os(o.query,o.docs,o.ns,o.fromCache),this.Nf=!0,this.Ff.next(o)},l}(),Pi=function(){function l(){}return l.prototype.Su=function(o){this.xf=o},l.prototype.Zn=function(o,s,c,h){var d=this;return s.te()||c.isEqual(x.min())?this.Bf(o,s):this.xf.Yn(o,h).next(function(p){var Co=d.qf(s,p);return(s.oe()||s.ae())&&d.yd(s.Bt,Co,h,c)?d.Bf(o,s):(Ae()<=LogLevel.DEBUG&&ke("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",c.toString(),s.toString()),d.xf.Zn(o,s,c).next(function(Bo){return Co.forEach(function(Lo){Bo=Bo.Ae(Lo.key,Lo)}),Bo}))})},l.prototype.qf=function(o,s){var c=new Yt(function(h,d){return o.se(h,d)});return s.forEach(function(h,d){d instanceof Dt&&o.matches(d)&&(c=c.add(d))}),c},l.prototype.yd=function(o,s,c,h){if(c.size!==s.size)return!0;var d=o==="F"?s.last():s.first();return!!d&&(d.hasPendingWrites||d.version.S(h)>0)},l.prototype.Bf=function(o,s){return Ae()<=LogLevel.DEBUG&&ke("IndexFreeQueryEngine","Using full collection scan to execute query:",s.toString()),this.xf.Zn(o,s,x.min())},l}(),Li=function(){function l(o,s){this.jn=o,this.hh=s,this.Wn=[],this.Uf=1,this.lastStreamToken=q.ht,this.Qf=new Yt(vr.Xu)}return l.prototype.Go=function(o){return Be.resolve(this.Wn.length===0)},l.prototype.zo=function(o,s,c){var h=s.batchId,d=this.Wf(h,"acknowledged");return Re(d===0),this.Wn[d],this.lastStreamToken=c,Be.resolve()},l.prototype.Yo=function(o){return Be.resolve(this.lastStreamToken)},l.prototype.Jo=function(o,s){return this.lastStreamToken=s,Be.resolve()},l.prototype.Xo=function(o,s,c,h){var d=this.Uf;this.Uf++,this.Wn.length>0&&this.Wn[this.Wn.length-1];var p=new je(d,s,c,h);this.Wn.push(p);for(var Co=0,Bo=h;Co<Bo.length;Co++){var Lo=Bo[Co];this.Qf=this.Qf.add(new vr(Lo.key,d)),this.jn.Dr(o,Lo.key.path.L())}return Be.resolve(p)},l.prototype.Zo=function(o,s){return Be.resolve(this.jf(s))},l.prototype.ea=function(o,s){var c=s+1,h=this.Kf(c),d=h<0?0:h;return Be.resolve(this.Wn.length>d?this.Wn[d]:null)},l.prototype.sa=function(){return Be.resolve(this.Wn.length===0?-1:this.Uf-1)},l.prototype.ia=function(o){return Be.resolve(this.Wn.slice())},l.prototype.Gn=function(o,s){var c=this,h=new vr(s,0),d=new vr(s,Number.POSITIVE_INFINITY),p=[];return this.Qf.Ke([h,d],function(Co){var Bo=c.jf(Co.oc);p.push(Bo)}),Be.resolve(p)},l.prototype.Xn=function(o,s){var c=this,h=new Yt(Pe);return s.forEach(function(d){var p=new vr(d,0),Co=new vr(d,Number.POSITIVE_INFINITY);c.Qf.Ke([p,Co],function(Bo){h=h.add(Bo.oc)})}),Be.resolve(this.Gf(h))},l.prototype.nr=function(o,s){var c=s.path,h=c.length+1,d=c;L$1.et(d)||(d=d.child(""));var p=new vr(new L$1(d),0),Co=new Yt(Pe);return this.Qf.Ge(function(Bo){var Lo=Bo.key.path;return!!c.q(Lo)&&(Lo.length===h&&(Co=Co.add(Bo.oc)),!0)},p),Be.resolve(this.Gf(Co))},l.prototype.Gf=function(o){var s=this,c=[];return o.forEach(function(h){var d=s.jf(h);d!==null&&c.push(d)}),c},l.prototype.ra=function(o,s){var c=this;Re(this.Wf(s.batchId,"removed")===0),this.Wn.shift();var h=this.Qf;return Be.forEach(s.mutations,function(d){var p=new vr(d.key,s.batchId);return h=h.delete(p),c.hh.Bo(o,d.key)}).next(function(){c.Qf=h})},l.prototype.ha=function(o){},l.prototype.Ch=function(o,s){var c=new vr(s,0),h=this.Qf.ze(c);return Be.resolve(s.isEqual(h&&h.key))},l.prototype.oa=function(o){return this.Wn.length,Be.resolve()},l.prototype.Wf=function(o,s){return this.Kf(o)},l.prototype.Kf=function(o){return this.Wn.length===0?0:o-this.Wn[0].batchId},l.prototype.jf=function(o){var s=this.Kf(o);return s<0||s>=this.Wn.length?null:this.Wn[s]},l}(),Ui=function(){function l(o,s){this.jn=o,this.zf=s,this.docs=new Wt(L$1.N),this.size=0}return l.prototype.Nn=function(o,s,c){var h=s.key,d=this.docs.get(h),p=d?d.size:0,Co=this.zf(s);return this.docs=this.docs.Ae(h,{Mr:s,size:Co,readTime:c}),this.size+=Co-p,this.jn.Dr(o,h.path.L())},l.prototype.kn=function(o){var s=this.docs.get(o);s&&(this.docs=this.docs.remove(o),this.size-=s.size)},l.prototype.Ln=function(o,s){var c=this.docs.get(s);return Be.resolve(c?c.Mr:null)},l.prototype.getEntries=function(o,s){var c=this,h=Xt();return s.forEach(function(d){var p=c.docs.get(d);h=h.Ae(d,p?p.Mr:null)}),Be.resolve(h)},l.prototype.Zn=function(o,s,c){for(var h=te(),d=new L$1(s.path.child("")),p=this.docs.ve(d);p.$e();){var Co=p.Ne(),Bo=Co.key,Lo=Co.value,Uo=Lo.Mr,Qo=Lo.readTime;if(!s.path.q(Bo.path))break;Qo.S(c)<=0||Uo instanceof Dt&&s.matches(Uo)&&(h=h.Ae(Uo.key,Uo))}return Be.resolve(h)},l.prototype.Hf=function(o,s){return Be.forEach(this.docs,function(c){return s(c)})},l.prototype.Yr=function(o){return new l.Jr(this)},l.prototype.Zr=function(o){return Be.resolve(this.size)},l}();Ui.Jr=function(l){function o(s){var c=this;return(c=l.call(this)||this).th=s,c}return __extends$1(o,l),o.prototype.xn=function(s){var c=this,h=[];return this.Dn.forEach(function(d,p){p?h.push(c.th.Nn(s,p,c.readTime)):c.th.kn(d)}),Be.vn(h)},o.prototype.Mn=function(s,c){return this.th.Ln(s,c)},o.prototype.On=function(s,c){return this.th.getEntries(s,c)},o}(ze);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ci=function(){function l(o){this.persistence=o,this.Yf=new qe(function(s){return s.canonicalId()}),this.lastRemoteSnapshotVersion=x.min(),this.highestTargetId=0,this.Jf=0,this.Xf=new yr,this.targetCount=0,this.Zf=fn.nh()}return l.prototype.js=function(o,s){return this.Yf.forEach(function(c,h){return s(h)}),Be.resolve()},l.prototype._h=function(o){return Be.resolve(this.lastRemoteSnapshotVersion)},l.prototype.lh=function(o){return Be.resolve(this.Jf)},l.prototype.oh=function(o){return this.highestTargetId=this.Zf.next(),Be.resolve(this.highestTargetId)},l.prototype.dh=function(o,s,c){return c&&(this.lastRemoteSnapshotVersion=c),s>this.Jf&&(this.Jf=s),Be.resolve()},l.prototype.Th=function(o){this.Yf.set(o.target,o);var s=o.targetId;s>this.highestTargetId&&(this.Zf=new fn(s),this.highestTargetId=s),o.sequenceNumber>this.Jf&&(this.Jf=o.sequenceNumber)},l.prototype.fh=function(o,s){return this.Th(s),this.targetCount+=1,Be.resolve()},l.prototype.Ih=function(o,s){return this.Th(s),Be.resolve()},l.prototype.wh=function(o,s){return this.Yf.delete(s.target),this.Xf.nc(s.targetId),this.targetCount-=1,Be.resolve()},l.prototype.Ah=function(o,s,c){var h=this,d=0,p=[];return this.Yf.forEach(function(Co,Bo){Bo.sequenceNumber<=s&&c.get(Bo.targetId)===null&&(h.Yf.delete(Co),p.push(h.Rh(o,Bo.targetId)),d++)}),Be.vn(p).next(function(){return d})},l.prototype.Vh=function(o){return Be.resolve(this.targetCount)},l.prototype.gh=function(o,s){var c=this.Yf.get(s)||null;return Be.resolve(c)},l.prototype.ph=function(o,s,c){return this.Xf.ec(s,c),Be.resolve()},l.prototype.bh=function(o,s,c){this.Xf.ic(s,c);var h=this.persistence.hh,d=[];return h&&s.forEach(function(p){d.push(h.Bo(o,p))}),Be.vn(d)},l.prototype.Rh=function(o,s){return this.Xf.nc(s),Be.resolve()},l.prototype.Sh=function(o,s){var c=this.Xf.hc(s);return Be.resolve(c)},l.prototype.Ch=function(o,s){return Be.resolve(this.Xf.Ch(s))},l}(),Mi=function(){function l(o){var s=this;this.tT={},this.Bh=new Ye(0),this.qh=!1,this.qh=!0,this.hh=o(this),this.Yh=new Ci(this),this.jn=new en,this.Qn=new Ui(this.jn,function(c){return s.hh.eT(c)})}return l.prototype.start=function(){return Promise.resolve()},l.prototype.mo=function(){return this.qh=!1,Promise.resolve()},Object.defineProperty(l.prototype,"ro",{get:function(){return this.qh},enumerable:!0,configurable:!0}),l.prototype.ho=function(){},l.prototype.Fo=function(){return this.jn},l.prototype.vo=function(o){var s=this.tT[o.s()];return s||(s=new Li(this.jn,this.hh),this.tT[o.s()]=s),s},l.prototype.Do=function(){return this.Yh},l.prototype.Co=function(){return this.Qn},l.prototype.runTransaction=function(o,s,c){var h=this;ke("MemoryPersistence","Starting transaction:",o);var d=new qi(this.Bh.next());return this.hh.sT(),c(d).next(function(p){return h.hh.iT(d).next(function(){return p})}).yn().then(function(p){return d.Un(),p})},l.prototype.nT=function(o,s){return Be.Sn(Object.values(this.tT).map(function(c){return function(){return c.Ch(o,s)}}))},l}(),qi=function(l){function o(s){var c=this;return(c=l.call(this)||this).Oh=s,c}return __extends$1(o,l),o}(We),ji=function(){function l(o){this.persistence=o,this.rT=new yr,this.hT=null}return l.oT=function(o){return new l(o)},Object.defineProperty(l.prototype,"aT",{get:function(){if(this.hT)return this.hT;throw xe()},enumerable:!0,configurable:!0}),l.prototype.yh=function(o,s,c){return this.rT.yh(c,s),this.aT.delete(c),Be.resolve()},l.prototype.vh=function(o,s,c){return this.rT.vh(c,s),this.aT.add(c),Be.resolve()},l.prototype.Bo=function(o,s){return this.aT.add(s),Be.resolve()},l.prototype.removeTarget=function(o,s){var c=this;this.rT.nc(s.targetId).forEach(function(d){return c.aT.add(d)});var h=this.persistence.Do();return h.Sh(o,s.targetId).next(function(d){d.forEach(function(p){return c.aT.add(p)})}).next(function(){return h.wh(o,s)})},l.prototype.sT=function(){this.hT=new Set},l.prototype.iT=function(o){var s=this,c=this.persistence.Co().Yr();return Be.forEach(this.aT,function(h){return s.uT(o,h).next(function(d){d||c.kn(h)})}).next(function(){return s.hT=null,c.apply(o)})},l.prototype.Wo=function(o,s){var c=this;return this.uT(o,s).next(function(h){h?c.aT.delete(s):c.aT.add(s)})},l.prototype.eT=function(o){return 0},l.prototype.uT=function(o,s){var c=this;return Be.Sn([function(){return Be.resolve(c.rT.Ch(s))},function(){return c.persistence.Do().Ch(o,s)},function(){return c.persistence.nT(o,s)}])},l}(),Fi=function(){function l(){}return l.prototype.initialize=function(o){return __awaiter$1(this,void 0,void 0,function(){var s=this;return __generator$1(this,function(c){switch(c.label){case 0:return this.Ud=this.cT(o),this.persistence=this._T(o),[4,this.persistence.start()];case 1:return c.sent(),this.lT=this.dT(o),this.N_=this.fT(o),this.$d=this.TT(o),this.ol=this.ET(o),this.IT=this.wT(o),this.Ud.g_=function(h){return s.ol.Dd(h,1)},this.$d.ol=this.ol,[4,this.N_.start()];case 2:return c.sent(),[4,this.Ud.start()];case 3:return c.sent(),[4,this.$d.start()];case 4:return c.sent(),[4,this.$d.Vl(this.ol.tf)];case 5:return c.sent(),[2]}})})},l.prototype.wT=function(o){return new Vi(this.ol)},l.prototype.dT=function(o){return null},l.prototype.fT=function(o){return new lr(this.persistence,new Pi,o.RT)},l.prototype._T=function(o){return new Mi(ji.oT)},l.prototype.TT=function(o){var s=this;return new li(this.N_,o.T_,o.Aa,function(c){return s.ol.Dd(c,0)},o.platform.AT())},l.prototype.cT=function(o){return new Ti},l.prototype.ET=function(o){return new Si(this.N_,this.$d,this.Ud,o.RT,o.Qd)},l.prototype.clearPersistence=function(o){throw new I(T$1.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},l}(),Bi=function(l){function o(){return l!==null&&l.apply(this,arguments)||this}return __extends$1(o,l),o.prototype.initialize=function(s){return __awaiter$1(this,void 0,void 0,function(){var c=this;return __generator$1(this,function(h){switch(h.label){case 0:return[4,l.prototype.initialize.call(this,s)];case 1:return h.sent(),[4,this.persistence.no(function(d){return __awaiter$1(c,void 0,void 0,function(){return __generator$1(this,function(p){switch(p.label){case 0:return[4,this.ol.Vl(d)];case 1:return p.sent(),this.lT&&(d&&!this.lT.ro?this.lT.start(this.N_):d||this.lT.stop()),[2]}})})})];case 2:return h.sent(),[2]}})})},o.prototype.fT=function(s){return new pr(this.persistence,new Pi,s.RT)},o.prototype.ET=function(s){var c=new xi(this.N_,this.$d,this.Ud,s.RT,s.Qd);return this.Ud instanceof bi&&(this.Ud.ol=c),c},o.prototype.dT=function(s){var c=this.persistence.hh.ko;return new cr(c,s.Aa)},o.prototype._T=function(s){var c=wn.$o(s.mT),h=s.platform.bc(s.mT.ii);return new wn(s.PT.synchronizeTabs,c,s.clientId,s.platform,hr.hu(s.PT.cacheSizeBytes),s.Aa,h,this.Ud)},o.prototype.cT=function(s){if(s.PT.VT&&s.PT.synchronizeTabs){if(!bi.Gh(s.platform))throw new I(T$1.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var c=wn.$o(s.mT);return new bi(s.Aa,s.platform,c,s.clientId,s.RT)}return new Ti},o.prototype.clearPersistence=function(s){var c=wn.$o(s);return wn.clearPersistence(c)},o}(Fi),zi=function(){function l(o,s,c,h){this.platform=o,this.mT=s,this.credentials=c,this.Aa=h,this.clientId=Oe.cn()}return l.prototype.start=function(o,s){var c=this;this.gT();var h=new $e,d=new $e,p=!1;return this.credentials.l(function(Co){if(!p)return p=!0,ke("FirestoreClient","Initializing. user=",Co.uid),c.pT(o,s,Co,d).then(h.resolve,h.reject);c.Aa.Ua(function(){return c.Pl(Co)})}),this.Aa.uo(function(){return h.promise}),d.promise},l.prototype.enableNetwork=function(){var o=this;return this.gT(),this.Aa.enqueue(function(){return o.ol.enableNetwork()})},l.prototype.pT=function(o,s,c,h){return __awaiter$1(this,void 0,void 0,function(){var d,p,Co,Bo,Lo=this;return __generator$1(this,function(Uo){switch(Uo.label){case 0:return Uo.trys.push([0,3,,4]),[4,this.platform.yT(this.mT)];case 1:return d=Uo.sent(),p=this.platform.bc(this.mT.ii),Co=function(Qo,Po,Mo){return new hi(Qo,Po,Mo)}(d,this.credentials,p),[4,o.initialize({Aa:this.Aa,mT:this.mT,platform:this.platform,T_:Co,clientId:this.clientId,RT:c,Qd:100,PT:s})];case 2:return Uo.sent(),this.persistence=o.persistence,this.Ud=o.Ud,this.N_=o.N_,this.$d=o.$d,this.ol=o.ol,this.lT=o.lT,this.bT=o.IT,this.persistence.ho(function(){return __awaiter$1(Lo,void 0,void 0,function(){return __generator$1(this,function(Qo){switch(Qo.label){case 0:return[4,this.terminate()];case 1:return Qo.sent(),[2]}})})}),h.resolve(),[3,4];case 3:if(Bo=Uo.sent(),h.reject(Bo),!this.vT(Bo))throw Bo;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+Bo),this.pT(new Fi,{VT:!1},c,h))];case 4:return[2]}})})},l.prototype.vT=function(o){return o.name==="FirebaseError"?o.code===T$1.FAILED_PRECONDITION||o.code===T$1.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11},l.prototype.gT=function(){if(this.Aa.La)throw new I(T$1.FAILED_PRECONDITION,"The client has already been terminated.")},l.prototype.Pl=function(o){return this.Aa.Wa(),ke("FirestoreClient","Credential Changed. Current user: "+o.uid),this.ol.Pl(o)},l.prototype.disableNetwork=function(){var o=this;return this.gT(),this.Aa.enqueue(function(){return o.ol.disableNetwork()})},l.prototype.terminate=function(){var o=this;return this.Aa.qa(function(){return __awaiter$1(o,void 0,void 0,function(){return __generator$1(this,function(s){switch(s.label){case 0:return this.lT&&this.lT.stop(),[4,this.$d.mo()];case 1:return s.sent(),[4,this.Ud.mo()];case 2:return s.sent(),[4,this.persistence.mo()];case 3:return s.sent(),this.credentials.T(),[2]}})})})},l.prototype.waitForPendingWrites=function(){var o=this;this.gT();var s=new $e;return this.Aa.uo(function(){return o.ol.lf(s)}),s.promise},l.prototype.listen=function(o,s,c){var h=this;this.gT();var d=new Oi(o,s,c);return this.Aa.uo(function(){return h.bT.listen(d)}),d},l.prototype.rl=function(o){var s=this;this.ST||this.Aa.uo(function(){return s.bT.rl(o)})},l.prototype.DT=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c=this;return __generator$1(this,function(h){switch(h.label){case 0:return this.gT(),s=new $e,[4,this.Aa.enqueue(function(){return __awaiter$1(c,void 0,void 0,function(){var d,p,Co;return __generator$1(this,function(Bo){switch(Bo.label){case 0:return Bo.trys.push([0,2,,3]),[4,this.N_.Uu(o)];case 1:return(d=Bo.sent())instanceof Dt?s.resolve(d):d instanceof St?s.resolve(null):s.reject(new I(T$1.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return p=Bo.sent(),Co=or(p,"Failed to get document '"+o+" from cache"),s.reject(Co),[3,3];case 3:return[2]}})})})];case 1:return[2,(h.sent(),s.promise)]}})})},l.prototype.CT=function(o){return __awaiter$1(this,void 0,void 0,function(){var s,c=this;return __generator$1(this,function(h){switch(h.label){case 0:return this.gT(),s=new $e,[4,this.Aa.enqueue(function(){return __awaiter$1(c,void 0,void 0,function(){var d,p,Co,Bo,Lo,Uo;return __generator$1(this,function(Qo){switch(Qo.label){case 0:return Qo.trys.push([0,2,,3]),[4,this.N_.ju(o,!0)];case 1:return d=Qo.sent(),p=new Ai(o,d.Ku),Co=p.Vd(d.documents),Bo=p.xn(Co,!1),s.resolve(Bo.snapshot),[3,3];case 2:return Lo=Qo.sent(),Uo=or(Lo,"Failed to execute query '"+o+" against cache"),s.reject(Uo),[3,3];case 3:return[2]}})})})];case 1:return[2,(h.sent(),s.promise)]}})})},l.prototype.write=function(o){var s=this;this.gT();var c=new $e;return this.Aa.uo(function(){return s.ol.write(o,c)}),c.promise},l.prototype.ii=function(){return this.mT.ii},l.prototype.Df=function(o){var s=this;this.gT(),this.Aa.uo(function(){return s.bT.Df(o),Promise.resolve()})},l.prototype.Cf=function(o){var s=this;this.ST||this.Aa.uo(function(){return s.bT.Cf(o),Promise.resolve()})},Object.defineProperty(l.prototype,"ST",{get:function(){return this.Aa.La},enumerable:!0,configurable:!0}),l.prototype.transaction=function(o){var s=this;this.gT();var c=new $e;return this.Aa.uo(function(){return s.ol.runTransaction(s.Aa,o,c),Promise.resolve()}),c.promise},l}(),Gi=function(){function l(o){this.observer=o,this.muted=!1}return l.prototype.next=function(o){this.FT(this.observer.next,o)},l.prototype.error=function(o){this.FT(this.observer.error,o)},l.prototype.NT=function(){this.muted=!0},l.prototype.FT=function(o,s){var c=this;this.muted||setTimeout(function(){c.muted||o(s)},0)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(l){return function(o,s){if(typeof o!="object"||o===null)return!1;for(var c=o,h=0,d=["next","error","complete"];h<d.length;h++){var p=d[h];if(p in c&&typeof c[p]=="function")return!0}return!1}(l)}var Qi=function(){function l(o,s,c,h){this.firestore=o,this.timestampsInSnapshots=s,this.$T=c,this.converter=h}return l.prototype.kT=function(o){switch(Q(o)){case 0:return null;case 1:return o.booleanValue;case 2:return Z$1(o.integerValue||o.doubleValue);case 3:return this.LT(o.timestampValue);case 4:return this.MT(o);case 5:return o.stringValue;case 6:return new Cr(tt(o.bytesValue));case 7:return this.OT(o.referenceValue);case 8:return this.xT(o.geoPointValue);case 9:return this.BT(o.arrayValue);case 10:return this.qT(o.mapValue);default:throw xe()}},l.prototype.qT=function(o){var s=this,c={};return C(o.fields||{},function(h,d){c[h]=s.kT(d)}),c},l.prototype.xT=function(o){return new Qr(Z$1(o.latitude),Z$1(o.longitude))},l.prototype.BT=function(o){var s=this;return(o.values||[]).map(function(c){return s.kT(c)})},l.prototype.MT=function(o){switch(this.$T){case"previous":var s=function c(h){var d=h.mapValue.fields.__previous_value__;return z$1(d)?c(d):d}(o);return s==null?null:this.kT(s);case"estimate":return this.LT(G(o));default:return null}},l.prototype.LT=function(o){var s=X(o),c=new S(s.seconds,s.nanos);return this.timestampsInSnapshots?c:c.toDate()},l.prototype.OT=function(o){var s=V$1.K(o);Re(Te(s));var c=new Me(s.get(1),s.get(3)),h=new L$1(s.k(5));return c.isEqual(this.firestore.$c)||De("Document "+h+" contains a document reference within a different database ("+c.projectId+"/"+c.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.$c.projectId+"/"+this.firestore.$c.database+") instead."),new Xi(h,this.firestore,this.converter)},l}(),Ki=hr.uu,Yi=function(){function l(o){var s,c,h,d;if(o.host===void 0){if(o.ssl!==void 0)throw new I(T$1.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Ir("settings","non-empty string","host",o.host),this.host=o.host,Nr("settings","boolean","ssl",o.ssl),this.ssl=(s=o.ssl)===null||s===void 0||s;if(xr("settings",o,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Nr("settings","object","credentials",o.credentials),this.credentials=o.credentials,Nr("settings","boolean","timestampsInSnapshots",o.timestampsInSnapshots),Nr("settings","boolean","ignoreUndefinedProperties",o.ignoreUndefinedProperties),o.timestampsInSnapshots===!0?De("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):o.timestampsInSnapshots===!1&&De("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=(c=o.timestampsInSnapshots)===null||c===void 0||c,this.ignoreUndefinedProperties=(h=o.ignoreUndefinedProperties)!==null&&h!==void 0&&h,Nr("settings","number","cacheSizeBytes",o.cacheSizeBytes),o.cacheSizeBytes===void 0)this.cacheSizeBytes=hr._u;else{if(o.cacheSizeBytes!==Ki&&o.cacheSizeBytes<hr.cu)throw new I(T$1.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+hr.cu);this.cacheSizeBytes=o.cacheSizeBytes}Nr("settings","boolean","experimentalForceLongPolling",o.experimentalForceLongPolling),this.forceLongPolling=(d=o.experimentalForceLongPolling)!==null&&d!==void 0&&d}return l.prototype.isEqual=function(o){return this.host===o.host&&this.ssl===o.ssl&&this.timestampsInSnapshots===o.timestampsInSnapshots&&this.credentials===o.credentials&&this.cacheSizeBytes===o.cacheSizeBytes&&this.forceLongPolling===o.forceLongPolling&&this.ignoreUndefinedProperties===o.ignoreUndefinedProperties},l}(),$i=function(){function l(o,s,c){var h=this;if(c===void 0&&(c=new Fi),this.UT=null,this.QT=new ir,this.INTERNAL={delete:function(){return __awaiter$1(h,void 0,void 0,function(){return __generator$1(this,function(Co){switch(Co.label){case 0:return this.WT(),[4,this.jT.terminate()];case 1:return Co.sent(),[2]}})})}},typeof o.options=="object"){var d=o;this.UT=d,this.$c=l.KT(d),this.GT=d.name,this.zT=new _(s)}else{var p=o;if(!p.projectId)throw new I(T$1.INVALID_ARGUMENT,"Must provide projectId");this.$c=new Me(p.projectId,p.database),this.GT="[DEFAULT]",this.zT=new A$1}this.HT=c,this.YT=new Yi({})}return Object.defineProperty(l.prototype,"JT",{get:function(){return this.XT||(this.XT=new Xr(this.$c,this.YT.ignoreUndefinedProperties)),this.XT},enumerable:!0,configurable:!0}),l.prototype.settings=function(o){gr("Firestore.settings",arguments,1),br("Firestore.settings","object",1,o);var s=new Yi(o);if(this.jT&&!this.YT.isEqual(s))throw new I(T$1.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.YT=s,s.credentials!==void 0&&(this.zT=function(c){if(!c)return new A$1;switch(c.type){case"gapi":var h=c.ZT;return Re(!(typeof h!="object"||h===null||!h.auth||!h.auth.getAuthHeaderValueForFirstParty)),new D(h,c.V||"0");case"provider":return c.ZT;default:throw new I(T$1.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(s.credentials))},l.prototype.enableNetwork=function(){return this.WT(),this.jT.enableNetwork()},l.prototype.disableNetwork=function(){return this.WT(),this.jT.disableNetwork()},l.prototype.enablePersistence=function(o){var s,c;if(this.jT)throw new I(T$1.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var h=!1;return o&&(o.experimentalTabSynchronization!==void 0&&De("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),h=(c=(s=o.synchronizeTabs)!==null&&s!==void 0?s:o.experimentalTabSynchronization)!==null&&c!==void 0&&c),this.tE(this.HT,{VT:!0,cacheSizeBytes:this.YT.cacheSizeBytes,synchronizeTabs:h})},l.prototype.clearPersistence=function(){return __awaiter$1(this,void 0,void 0,function(){var o,s=this;return __generator$1(this,function(c){if(this.jT!==void 0&&!this.jT.ST)throw new I(T$1.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return o=new $e,[2,(this.QT.Ma(function(){return __awaiter$1(s,void 0,void 0,function(){var h,d;return __generator$1(this,function(p){switch(p.label){case 0:return p.trys.push([0,2,,3]),h=this.eE(),[4,this.HT.clearPersistence(h)];case 1:return p.sent(),o.resolve(),[3,3];case 2:return d=p.sent(),o.reject(d),[3,3];case 3:return[2]}})})}),o.promise)]})})},l.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(l.prototype,"sE",{get:function(){return this.WT(),this.jT.ST},enumerable:!0,configurable:!0}),l.prototype.waitForPendingWrites=function(){return this.WT(),this.jT.waitForPendingWrites()},l.prototype.onSnapshotsInSync=function(o){if(this.WT(),Wi(o))return this.iE(o);br("Firestore.onSnapshotsInSync","function",1,o);var s={next:o};return this.iE(s)},l.prototype.iE=function(o){var s=this,c=new Gi({next:function(){o.next&&o.next()},error:function(h){throw xe()}});return this.jT.Df(c),function(){c.NT(),s.jT.Cf(c)}},l.prototype.WT=function(){return this.jT||this.tE(new Fi,{VT:!1}),this.jT},l.prototype.eE=function(){return new Ce(this.$c,this.GT,this.YT.host,this.YT.ssl,this.YT.forceLongPolling)},l.prototype.tE=function(o,s){var c=this.eE();return this.jT=new zi(Ie.nt(),c,this.zT,this.QT),this.jT.start(o,s)},l.KT=function(o){if(s=o.options,!Object.prototype.hasOwnProperty.call(s,"projectId"))throw new I(T$1.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var s,c=o.options.projectId;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/if(!c||typeof c!="string")throw new I(T$1.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Me(c)},Object.defineProperty(l.prototype,"app",{get:function(){if(!this.UT)throw new I(T$1.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.UT},enumerable:!0,configurable:!0}),l.prototype.collection=function(o){return gr("Firestore.collection",arguments,1),br("Firestore.collection","non-empty string",1,o),this.WT(),new io(V$1.K(o),this)},l.prototype.doc=function(o){return gr("Firestore.doc",arguments,1),br("Firestore.doc","non-empty string",1,o),this.WT(),Xi.nE(V$1.K(o),this)},l.prototype.collectionGroup=function(o){if(gr("Firestore.collectionGroup",arguments,1),br("Firestore.collectionGroup","non-empty string",1,o),o.indexOf("/")>=0)throw new I(T$1.INVALID_ARGUMENT,"Invalid collection ID '"+o+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.WT(),new no(new Vt(V$1.G,o),this)},l.prototype.runTransaction=function(o){var s=this;return gr("Firestore.runTransaction",arguments,1),br("Firestore.runTransaction","function",1,o),this.WT().transaction(function(c){return o(new Ji(s,c))})},l.prototype.batch=function(){return this.WT(),new Hi(this)},Object.defineProperty(l,"logLevel",{get:function(){switch(Ae()){case LogLevel.DEBUG:return"debug";case LogLevel.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),l.setLogLevel=function(o){switch(gr("Firestore.setLogLevel",arguments,1),br("Firestore.setLogLevel","non-empty string",1,o),o){case"debug":_e(LogLevel.DEBUG);break;case"error":_e(LogLevel.ERROR);break;case"silent":_e(LogLevel.SILENT);break;default:throw new I(T$1.INVALID_ARGUMENT,"Invalid log level: "+o)}},l.prototype.rE=function(){return this.YT.timestampsInSnapshots},l}(),Ji=function(){function l(o,s){this.hE=o,this.oE=s}return l.prototype.get=function(o){var s=this;gr("Transaction.get",arguments,1);var c=ao("Transaction.get",o,this.hE);return this.oE.A_([c.kc]).then(function(h){if(!h||h.length!==1)return xe();var d=h[0];if(d instanceof St)return new to(s.hE,c.kc,null,!1,!1,c.aE);if(d instanceof Dt)return new to(s.hE,c.kc,d,!1,!1,c.aE);throw xe()})},l.prototype.set=function(o,s,c){Er("Transaction.set",arguments,2,3);var h=ao("Transaction.set",o,this.hE);c=oo("Transaction.set",c);var d=co(h.aE,s,"Transaction.set"),p=d[0],Co=d[1],Bo=c.merge||c.mergeFields?this.hE.JT.Dc(Co,p,c.mergeFields):this.hE.JT.vc(Co,p);return this.oE.set(h.kc,Bo),this},l.prototype.update=function(o,s,c){for(var h,d,p=[],Co=3;Co<arguments.length;Co++)p[Co-3]=arguments[Co];return typeof s=="string"||s instanceof Mr?(wr("Transaction.update",arguments,3),h=ao("Transaction.update",o,this.hE),d=this.hE.JT.Fc("Transaction.update",s,c,p)):(gr("Transaction.update",arguments,2),h=ao("Transaction.update",o,this.hE),d=this.hE.JT.Cc("Transaction.update",s)),this.oE.update(h.kc,d),this},l.prototype.delete=function(o){gr("Transaction.delete",arguments,1);var s=ao("Transaction.delete",o,this.hE);return this.oE.delete(s.kc),this},l}(),Hi=function(){function l(o){this.hE=o,this.uE=[],this.cE=!1}return l.prototype.set=function(o,s,c){Er("WriteBatch.set",arguments,2,3),this._E();var h=ao("WriteBatch.set",o,this.hE);c=oo("WriteBatch.set",c);var d=co(h.aE,s,"WriteBatch.set"),p=d[0],Co=d[1],Bo=c.merge||c.mergeFields?this.hE.JT.Dc(Co,p,c.mergeFields):this.hE.JT.vc(Co,p);return this.uE=this.uE.concat(Bo.Ac(h.kc,yt.ft())),this},l.prototype.update=function(o,s,c){for(var h,d,p=[],Co=3;Co<arguments.length;Co++)p[Co-3]=arguments[Co];return this._E(),typeof s=="string"||s instanceof Mr?(wr("WriteBatch.update",arguments,3),h=ao("WriteBatch.update",o,this.hE),d=this.hE.JT.Fc("WriteBatch.update",s,c,p)):(gr("WriteBatch.update",arguments,2),h=ao("WriteBatch.update",o,this.hE),d=this.hE.JT.Cc("WriteBatch.update",s)),this.uE=this.uE.concat(d.Ac(h.kc,yt.exists(!0))),this},l.prototype.delete=function(o){gr("WriteBatch.delete",arguments,1),this._E();var s=ao("WriteBatch.delete",o,this.hE);return this.uE=this.uE.concat(new Et(s.kc,yt.ft())),this},l.prototype.commit=function(){return this._E(),this.cE=!0,this.uE.length>0?this.hE.WT().write(this.uE):Promise.resolve()},l.prototype._E=function(){if(this.cE)throw new I(T$1.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},l}(),Xi=function(){function l(o,s,c){this.kc=o,this.firestore=s,this.aE=c,this.jT=this.firestore.WT()}return l.nE=function(o,s,c){if(o.length%2!=0)throw new I(T$1.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+o.j()+" has "+o.length);return new l(new L$1(o),s,c)},Object.defineProperty(l.prototype,"id",{get:function(){return this.kc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"parent",{get:function(){return new io(this.kc.path.L(),this.firestore,this.aE)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"path",{get:function(){return this.kc.path.j()},enumerable:!0,configurable:!0}),l.prototype.collection=function(o){if(gr("DocumentReference.collection",arguments,1),br("DocumentReference.collection","non-empty string",1,o),!o)throw new I(T$1.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var s=V$1.K(o);return new io(this.kc.path.child(s),this.firestore)},l.prototype.isEqual=function(o){if(!(o instanceof l))throw Rr("isEqual","DocumentReference",1,o);return this.firestore===o.firestore&&this.kc.isEqual(o.kc)&&this.aE===o.aE},l.prototype.set=function(o,s){Er("DocumentReference.set",arguments,1,2),s=oo("DocumentReference.set",s);var c=co(this.aE,o,"DocumentReference.set"),h=c[0],d=c[1],p=s.merge||s.mergeFields?this.firestore.JT.Dc(d,h,s.mergeFields):this.firestore.JT.vc(d,h);return this.jT.write(p.Ac(this.kc,yt.ft()))},l.prototype.update=function(o,s){for(var c,h=[],d=2;d<arguments.length;d++)h[d-2]=arguments[d];return typeof o=="string"||o instanceof Mr?(wr("DocumentReference.update",arguments,2),c=this.firestore.JT.Fc("DocumentReference.update",o,s,h)):(gr("DocumentReference.update",arguments,1),c=this.firestore.JT.Cc("DocumentReference.update",o)),this.jT.write(c.Ac(this.kc,yt.exists(!0)))},l.prototype.delete=function(){return gr("DocumentReference.delete",arguments,0),this.jT.write([new Et(this.kc,yt.ft())])},l.prototype.onSnapshot=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];Er("DocumentReference.onSnapshot",arguments,1,4);var c,h={includeMetadataChanges:!1},d=0;typeof o[d]!="object"||Wi(o[d])||(xr("DocumentReference.onSnapshot",h=o[d],["includeMetadataChanges"]),Nr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",h.includeMetadataChanges),d++);var p={includeMetadataChanges:h.includeMetadataChanges};return Wi(o[d])?c=o[d]:(br("DocumentReference.onSnapshot","function",d,o[d]),Tr("DocumentReference.onSnapshot","function",d+1,o[d+1]),Tr("DocumentReference.onSnapshot","function",d+2,o[d+2]),c={next:o[d],error:o[d+1],complete:o[d+2]}),this.lE(p,c)},l.prototype.lE=function(o,s){var c=this,h=function(Co){console.error("Uncaught Error in onSnapshot:",Co)};s.error&&(h=s.error.bind(s));var d=new Gi({next:function(Co){if(s.next){var Bo=Co.docs.get(c.kc);s.next(new to(c.firestore,c.kc,Bo,Co.fromCache,Co.hasPendingWrites,c.aE))}},error:h}),p=this.jT.listen(Vt.Wt(this.kc.path),d,o);return function(){d.NT(),c.jT.rl(p)}},l.prototype.get=function(o){var s=this;return Er("DocumentReference.get",arguments,0,1),uo("DocumentReference.get",o),new Promise(function(c,h){o&&o.source==="cache"?s.firestore.WT().DT(s.kc).then(function(d){c(new to(s.firestore,s.kc,d,!0,d instanceof Dt&&d.At,s.aE))},h):s.dE(c,h,o)})},l.prototype.dE=function(o,s,c){var h=this.lE({includeMetadataChanges:!0,Of:!0},{next:function(d){h(),!d.exists&&d.metadata.fromCache?s(new I(T$1.UNAVAILABLE,"Failed to get document because the client is offline.")):d.exists&&d.metadata.fromCache&&c&&c.source==="server"?s(new I(T$1.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o(d)},error:s})},l.prototype.withConverter=function(o){return new l(this.kc,this.firestore,o)},l}(),Zi=function(){function l(o,s){this.hasPendingWrites=o,this.fromCache=s}return l.prototype.isEqual=function(o){return this.hasPendingWrites===o.hasPendingWrites&&this.fromCache===o.fromCache},l}(),to=function(){function l(o,s,c,h,d,p){this.hE=o,this.kc=s,this.fE=c,this.TE=h,this.EE=d,this.aE=p}return l.prototype.data=function(o){if(Er("DocumentSnapshot.data",arguments,0,1),o=so("DocumentSnapshot.data",o),this.fE){if(this.aE){var s=new eo(this.hE,this.kc,this.fE,this.TE,this.EE);return this.aE.fromFirestore(s,o)}return new Qi(this.hE,this.hE.rE(),o.serverTimestamps,void 0).kT(this.fE.Lt())}},l.prototype.get=function(o,s){if(Er("DocumentSnapshot.get",arguments,1,2),s=so("DocumentSnapshot.get",s),this.fE){var c=this.fE.data().field(ri("DocumentSnapshot.get",o));if(c!==null)return new Qi(this.hE,this.hE.rE(),s.serverTimestamps,this.aE).kT(c)}},Object.defineProperty(l.prototype,"id",{get:function(){return this.kc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"ref",{get:function(){return new Xi(this.kc,this.hE,this.aE)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"exists",{get:function(){return this.fE!==null},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"metadata",{get:function(){return new Zi(this.EE,this.TE)},enumerable:!0,configurable:!0}),l.prototype.isEqual=function(o){if(!(o instanceof l))throw Rr("isEqual","DocumentSnapshot",1,o);return this.hE===o.hE&&this.TE===o.TE&&this.kc.isEqual(o.kc)&&(this.fE===null?o.fE===null:this.fE.isEqual(o.fE))&&this.aE===o.aE},l}(),eo=function(l){function o(){return l!==null&&l.apply(this,arguments)||this}return __extends$1(o,l),o.prototype.data=function(s){return l.prototype.data.call(this,s)},o}(to),no=function(){function l(o,s,c){this.IE=o,this.firestore=s,this.aE=c}return l.prototype.where=function(o,s,c){gr("Query.where",arguments,3),Sr("Query.where",3,c);var h,d=function(Po,Mo,Go,$o){if(!Mo.some(function(jo){return jo===$o}))throw new I(T$1.INVALID_ARGUMENT,"Invalid value "+Dr($o)+" provided to function Query.where() for its "+Or(2)+" argument. Acceptable values: "+Mo.join(", "));return $o}(0,["<","<=","==",">=",">","array-contains","in","array-contains-any"],0,s),p=ri("Query.where",o);if(p.Y()){if(d==="array-contains"||d==="array-contains-any")throw new I(T$1.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+d+"' queries on FieldPath.documentId().");if(d==="in"){this.wE(c,d);for(var Co=[],Bo=0,Lo=c;Bo<Lo.length;Bo++){var Uo=Lo[Bo];Co.push(this.RE(Uo))}h={arrayValue:{values:Co}}}else h=this.RE(c)}else d!=="in"&&d!=="array-contains-any"||this.wE(c,d),h=this.firestore.JT.Nc("Query.where",c,d==="in");var Qo=Ot.create(p,d,h);return this.AE(Qo),new l(this.IE.Gt(Qo),this.firestore,this.aE)},l.prototype.orderBy=function(o,s){var c;if(Er("Query.orderBy",arguments,1,2),Tr("Query.orderBy","non-empty string",2,s),s===void 0||s==="asc")c="asc";else{if(s!=="desc")throw new I(T$1.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+s+"', expected 'asc' or 'desc'.");c="desc"}if(this.IE.startAt!==null)throw new I(T$1.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(this.IE.endAt!==null)throw new I(T$1.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var h=ri("Query.orderBy",o),d=new jt(h,c);return this.mE(d),new l(this.IE.zt(d),this.firestore,this.aE)},l.prototype.limit=function(o){return gr("Query.limit",arguments,1),br("Query.limit","number",1,o),Vr("Query.limit",1,o),new l(this.IE.Ht(o),this.firestore,this.aE)},l.prototype.limitToLast=function(o){return gr("Query.limitToLast",arguments,1),br("Query.limitToLast","number",1,o),Vr("Query.limitToLast",1,o),new l(this.IE.Yt(o),this.firestore,this.aE)},l.prototype.startAt=function(o){for(var s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];wr("Query.startAt",arguments,1);var h=this.PE("Query.startAt",o,s,!0);return new l(this.IE.Jt(h),this.firestore,this.aE)},l.prototype.startAfter=function(o){for(var s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];wr("Query.startAfter",arguments,1);var h=this.PE("Query.startAfter",o,s,!1);return new l(this.IE.Jt(h),this.firestore,this.aE)},l.prototype.endBefore=function(o){for(var s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];wr("Query.endBefore",arguments,1);var h=this.PE("Query.endBefore",o,s,!0);return new l(this.IE.Xt(h),this.firestore,this.aE)},l.prototype.endAt=function(o){for(var s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];wr("Query.endAt",arguments,1);var h=this.PE("Query.endAt",o,s,!1);return new l(this.IE.Xt(h),this.firestore,this.aE)},l.prototype.isEqual=function(o){if(!(o instanceof l))throw Rr("isEqual","Query",1,o);return this.firestore===o.firestore&&this.IE.isEqual(o.IE)},l.prototype.withConverter=function(o){return new l(this.IE,this.firestore,o)},l.prototype.PE=function(o,s,c,h){if(Sr(o,1,s),s instanceof to){if(c.length>0)throw new I(T$1.INVALID_ARGUMENT,"Too many arguments provided to "+o+"().");var d=s;if(!d.exists)throw new I(T$1.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+o+"().");return this.VE(d.fE,h)}var p=[s].concat(c);return this.gE(o,p,h)},l.prototype.VE=function(o,s){for(var c=[],h=0,d=this.IE.orderBy;h<d.length;h++){var p=d[h];if(p.field.Y())c.push(et(this.firestore.$c,o.key));else{var Co=o.field(p.field);if(z$1(Co))throw new I(T$1.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(Co===null){var Bo=p.field.j();throw new I(T$1.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+Bo+"' (used as the orderBy) does not exist.")}c.push(Co)}}return new qt(c,s)},l.prototype.gE=function(o,s,c){var h=this.IE.xt;if(s.length>h.length)throw new I(T$1.INVALID_ARGUMENT,"Too many arguments provided to "+o+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var d=[],p=0;p<s.length;p++){var Co=s[p];if(h[p].field.Y()){if(typeof Co!="string")throw new I(T$1.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+o+"(), but got a "+typeof Co);if(!this.IE._e()&&Co.indexOf("/")!==-1)throw new I(T$1.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+o+"() must be a plain document ID, but '"+Co+"' contains a slash.");var Bo=this.IE.path.child(V$1.K(Co));if(!L$1.et(Bo))throw new I(T$1.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+o+"() must result in a valid document path, but '"+Bo+"' is not because it contains an odd number of segments.");var Lo=new L$1(Bo);d.push(et(this.firestore.$c,Lo))}else{var Uo=this.firestore.JT.Nc(o,Co);d.push(Uo)}}return new qt(d,c)},l.prototype.onSnapshot=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];Er("Query.onSnapshot",arguments,1,4);var c,h={},d=0;return typeof o[d]!="object"||Wi(o[d])||(xr("Query.onSnapshot",h=o[d],["includeMetadataChanges"]),Nr("Query.onSnapshot","boolean","includeMetadataChanges",h.includeMetadataChanges),d++),Wi(o[d])?c=o[d]:(br("Query.onSnapshot","function",d,o[d]),Tr("Query.onSnapshot","function",d+1,o[d+1]),Tr("Query.onSnapshot","function",d+2,o[d+2]),c={next:o[d],error:o[d+1],complete:o[d+2]}),this.pE(this.IE),this.lE(h,c)},l.prototype.lE=function(o,s){var c=this,h=function(Bo){console.error("Uncaught Error in onSnapshot:",Bo)};s.error&&(h=s.error.bind(s));var d=new Gi({next:function(Bo){s.next&&s.next(new ro(c.firestore,c.IE,Bo,c.aE))},error:h}),p=this.firestore.WT(),Co=p.listen(this.IE,d,o);return function(){d.NT(),p.rl(Co)}},l.prototype.pE=function(o){if(o.ae()&&o.xt.length===0)throw new I(T$1.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},l.prototype.get=function(o){var s=this;return Er("Query.get",arguments,0,1),uo("Query.get",o),this.pE(this.IE),new Promise(function(c,h){o&&o.source==="cache"?s.firestore.WT().CT(s.IE).then(function(d){c(new ro(s.firestore,s.IE,d,s.aE))},h):s.dE(c,h,o)})},l.prototype.dE=function(o,s,c){var h=this.lE({includeMetadataChanges:!0,Of:!0},{next:function(d){h(),d.metadata.fromCache&&c&&c.source==="server"?s(new I(T$1.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o(d)},error:s})},l.prototype.RE=function(o){if(typeof o=="string"){if(o==="")throw new I(T$1.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.IE._e()&&o.indexOf("/")!==-1)throw new I(T$1.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+o+"' contains a '/' character.");var s=this.IE.path.child(V$1.K(o));if(!L$1.et(s))throw new I(T$1.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+s+"' is not because it has an odd number of segments ("+s.length+").");return et(this.firestore.$c,new L$1(s))}if(o instanceof Xi){var c=o;return et(this.firestore.$c,c.kc)}throw new I(T$1.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Dr(o)+".")},l.prototype.wE=function(o,s){if(!Array.isArray(o)||o.length===0)throw new I(T$1.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+s.toString()+"' filters.");if(o.length>10)throw new I(T$1.INVALID_ARGUMENT,"Invalid Query. '"+s.toString()+"' filters support a maximum of 10 elements in the value array.");if(o.indexOf(null)>=0)throw new I(T$1.INVALID_ARGUMENT,"Invalid Query. '"+s.toString()+"' filters cannot contain 'null' in the value array.");if(o.filter(function(c){return Number.isNaN(c)}).length>0)throw new I(T$1.INVALID_ARGUMENT,"Invalid Query. '"+s.toString()+"' filters cannot contain 'NaN' in the value array.")},l.prototype.AE=function(o){if(o instanceof Ot){var s=["array-contains","array-contains-any"],c=["in","array-contains-any"],h=s.indexOf(o.op)>=0,d=c.indexOf(o.op)>=0;if(o.ue()){var p=this.IE.jt();if(p!==null&&!p.isEqual(o.field))throw new I(T$1.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+p.toString()+"' and '"+o.field.toString()+"'");var Co=this.IE.Kt();Co!==null&&this.yE(o.field,Co)}else if(d||h){var Bo=null;if(d&&(Bo=this.IE.ce(c)),Bo===null&&h&&(Bo=this.IE.ce(s)),Bo!=null)throw Bo===o.op?new I(T$1.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+o.op.toString()+"' filter."):new I(T$1.INVALID_ARGUMENT,"Invalid query. You cannot use '"+o.op.toString()+"' filters with '"+Bo.toString()+"' filters.")}}},l.prototype.mE=function(o){if(this.IE.Kt()===null){var s=this.IE.jt();s!==null&&this.yE(s,o.field)}},l.prototype.yE=function(o,s){if(!s.isEqual(o))throw new I(T$1.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+o.toString()+"' and so you must also use '"+o.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+s.toString()+"' instead.")},l}(),ro=function(){function l(o,s,c,h){this.hE=o,this.bE=s,this.vE=c,this.aE=h,this.SE=null,this.DE=null,this.metadata=new Zi(c.hasPendingWrites,c.fromCache)}return Object.defineProperty(l.prototype,"docs",{get:function(){var o=[];return this.forEach(function(s){return o.push(s)}),o},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"empty",{get:function(){return this.vE.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"size",{get:function(){return this.vE.docs.size},enumerable:!0,configurable:!0}),l.prototype.forEach=function(o,s){var c=this;Er("QuerySnapshot.forEach",arguments,1,2),br("QuerySnapshot.forEach","function",1,o),this.vE.docs.forEach(function(h){o.call(s,c.CE(h))})},Object.defineProperty(l.prototype,"query",{get:function(){return new no(this.bE,this.hE,this.aE)},enumerable:!0,configurable:!0}),l.prototype.docChanges=function(o){o&&(xr("QuerySnapshot.docChanges",o,["includeMetadataChanges"]),Nr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",o.includeMetadataChanges));var s=!(!o||!o.includeMetadataChanges);if(s&&this.vE.hs)throw new I(T$1.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.SE&&this.DE===s||(this.SE=function(c,h,d,p){if(d.ss.B()){var Co=0;return d.docChanges.map(function(Lo){var Uo=new eo(c,Lo.doc.key,Lo.doc,d.fromCache,d.ns.has(Lo.doc.key),p);return Lo.doc,{type:"added",doc:Uo,oldIndex:-1,newIndex:Co++}})}var Bo=d.ss;return d.docChanges.filter(function(Lo){return h||Lo.type!==3}).map(function(Lo){var Uo=new eo(c,Lo.doc.key,Lo.doc,d.fromCache,d.ns.has(Lo.doc.key),p),Qo=-1,Po=-1;return Lo.type!==0&&(Qo=Bo.indexOf(Lo.doc.key),Bo=Bo.delete(Lo.doc.key)),Lo.type!==1&&(Po=(Bo=Bo.add(Lo.doc)).indexOf(Lo.doc.key)),{type:ho(Lo.type),doc:Uo,oldIndex:Qo,newIndex:Po}})}(this.hE,s,this.vE,this.aE),this.DE=s),this.SE},l.prototype.isEqual=function(o){if(!(o instanceof l))throw Rr("isEqual","QuerySnapshot",1,o);return this.hE===o.hE&&this.bE.isEqual(o.bE)&&this.vE.isEqual(o.vE)&&this.aE===o.aE},l.prototype.CE=function(o){return new eo(this.hE,o.key,o,this.metadata.fromCache,this.vE.ns.has(o.key),this.aE)},l}(),io=function(l){function o(s,c,h){var d=this;if((d=l.call(this,Vt.Wt(s),c,h)||this).FE=s,s.length%2!=1)throw new I(T$1.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+s.j()+" has "+s.length);return d}return __extends$1(o,l),Object.defineProperty(o.prototype,"id",{get:function(){return this.IE.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"parent",{get:function(){var s=this.IE.path.L();return s.B()?null:new Xi(new L$1(s),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"path",{get:function(){return this.IE.path.j()},enumerable:!0,configurable:!0}),o.prototype.doc=function(s){if(Er("CollectionReference.doc",arguments,0,1),arguments.length===0&&(s=Oe.cn()),br("CollectionReference.doc","non-empty string",1,s),s==="")throw new I(T$1.INVALID_ARGUMENT,"Document path must be a non-empty string");var c=V$1.K(s);return Xi.nE(this.IE.path.child(c),this.firestore,this.aE)},o.prototype.add=function(s){gr("CollectionReference.add",arguments,1),br("CollectionReference.add","object",1,this.aE?this.aE.toFirestore(s):s);var c=this.doc();return c.set(s).then(function(){return c})},o.prototype.withConverter=function(s){return new o(this.FE,this.firestore,s)},o}(no);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oo(l,o){if(o===void 0)return{merge:!1};if(xr(l,o,["merge","mergeFields"]),Nr(l,"boolean","merge",o.merge),function(s,c,h,d,p){d!==void 0&&function(Co,Bo,Lo,Uo,Qo){if(!(Uo instanceof Array))throw new I(T$1.INVALID_ARGUMENT,"Function "+Co+"() requires its "+Bo+" option to be an array, but it was: "+Dr(Uo));for(var Po=0;Po<Uo.length;++Po)if(!Qo(Uo[Po]))throw new I(T$1.INVALID_ARGUMENT,"Function "+Co+"() requires all "+Bo+" elements to be "+Lo+", but the value at index "+Po+" was: "+Dr(Uo[Po]))}(s,c,h,d,p)}(l,"mergeFields","a string or a FieldPath",o.mergeFields,function(s){return typeof s=="string"||s instanceof Mr}),o.mergeFields!==void 0&&o.merge!==void 0)throw new I(T$1.INVALID_ARGUMENT,"Invalid options passed to function "+l+'(): You cannot specify both "merge" and "mergeFields".');return o}function so(l,o){return o===void 0?{}:(xr(l,o,["serverTimestamps"]),Ar(l,0,"serverTimestamps",o.serverTimestamps,["estimate","previous","none"]),o)}function uo(l,o){Tr(l,"object",1,o),o&&(xr(l,o,["source"]),Ar(l,0,"source",o.source,["default","server","cache"]))}function ao(l,o,s){if(o instanceof Xi){if(o.firestore!==s)throw new I(T$1.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return o}throw Rr(l,"DocumentReference",1,o)}function ho(l){switch(l){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xe()}}function co(l,o,s){var c;return l?(c=l.toFirestore(o),s="toFirestore() in "+s):c=o,[c,s]}function fo(l,o){function s(){var c="This constructor is private.";throw o&&(c+=" ",c+=o),new I(T$1.INVALID_ARGUMENT,c)}return s.prototype=l.prototype,Object.assign(s,l),s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lo=fo($i,"Use firebase.firestore() instead."),po=fo(Ji,"Use firebase.firestore().runTransaction() instead."),yo=fo(Hi,"Use firebase.firestore().batch() instead."),vo=fo(Xi,"Use firebase.firestore().doc() instead."),mo=fo(to),go=fo(eo),wo=fo(no),Eo=fo(ro),bo=fo(io,"Use firebase.firestore().collection() instead."),To=fo(function(){function l(){}return l.delete=function(){return mr("FieldValue.delete",arguments),new Fr},l.serverTimestamp=function(){return mr("FieldValue.serverTimestamp",arguments),new Br},l.arrayUnion=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return wr("FieldValue.arrayUnion",arguments,1),new zr(o)},l.arrayRemove=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return wr("FieldValue.arrayRemove",arguments,1),new Gr(o)},l.increment=function(o){return br("FieldValue.increment","number",1,o),gr("FieldValue.increment",arguments,1),new Wr(o)},l.prototype.isEqual=function(o){return this===o},l}(),"Use FieldValue.<field>() instead."),Io=fo(Cr,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),No={Firestore:lo,GeoPoint:Qr,Timestamp:S,Blob:Io,Transaction:po,WriteBatch:yo,DocumentReference:vo,DocumentSnapshot:mo,Query:wo,QueryDocumentSnapshot:go,QuerySnapshot:Eo,CollectionReference:bo,FieldPath:Mr,FieldValue:To,setLogLevel:$i.setLogLevel,CACHE_SIZE_UNLIMITED:Ki},Ao=function(){function l(){}return l.prototype.B_=function(o){},l.prototype.mo=function(){},l}(),_o=function(){function l(){var o=this;this.NE=function(){return o.$E()},this.kE=function(){return o.LE()},this.ME=[],this.OE()}return l.prototype.B_=function(o){this.ME.push(o)},l.prototype.mo=function(){window.removeEventListener("online",this.NE),window.removeEventListener("offline",this.kE)},l.prototype.OE=function(){window.addEventListener("online",this.NE),window.addEventListener("offline",this.kE)},l.prototype.$E=function(){ke("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var o=0,s=this.ME;o<s.length;o++)(0,s[o])(0)},l.prototype.LE=function(){ke("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var o=0,s=this.ME;o<s.length;o++)(0,s[o])(1)},l.Gh=function(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0},l}(),ko=function(){function l(o){this.xE=o.xE,this.BE=o.BE}return l.prototype.e_=function(o){this.qE=o},l.prototype.Yc=function(o){this.UE=o},l.prototype.onMessage=function(o){this.QE=o},l.prototype.close=function(){this.BE()},l.prototype.send=function(o){this.xE(o)},l.prototype.WE=function(){this.qE()},l.prototype.jE=function(o){this.UE(o)},l.prototype.KE=function(o){this.QE(o)},l}(),Do={BatchGetDocuments:"batchGet",Commit:"commit"},So="gl-js/ fire/"+E$1,xo=function(){function l(o){this.ii=o.ii;var s=o.ssl?"https":"http";this.GE=s+"://"+o.host,this.forceLongPolling=o.forceLongPolling}return l.prototype.zE=function(o,s){if(s)for(var c in s.o)s.o.hasOwnProperty(c)&&(o[c]=s.o[c]);o["X-Goog-Api-Client"]=So},l.prototype.d_=function(o,s,c){var h=this,d=this.HE(o);return new Promise(function(p,Co){var Bo=new esm_5;Bo.listenOnce(esm_3.COMPLETE,function(){try{switch(Bo.getLastErrorCode()){case esm_2.NO_ERROR:var Po=Bo.getResponseJson();ke("Connection","XHR received:",JSON.stringify(Po)),p(Po);break;case esm_2.TIMEOUT:ke("Connection",'RPC "'+o+'" timed out'),Co(new I(T$1.DEADLINE_EXCEEDED,"Request time out"));break;case esm_2.HTTP_ERROR:var Mo=Bo.getStatus();if(ke("Connection",'RPC "'+o+'" failed with status:',Mo,"response text:",Bo.getResponseText()),Mo>0){var Go=Bo.getResponseJson().error;if(Go&&Go.status&&Go.message){var $o=function(jo){var zo=jo.toLowerCase().replace("_","-");return Object.values(T$1).indexOf(zo)>=0?zo:T$1.UNKNOWN}(Go.status);Co(new I($o,Go.message))}else Co(new I(T$1.UNKNOWN,"Server responded with status "+Bo.getStatus()))}else ke("Connection",'RPC "'+o+'" failed'),Co(new I(T$1.UNAVAILABLE,"Connection failed."));break;default:xe()}}finally{ke("Connection",'RPC "'+o+'" completed.')}});var Lo=Object.assign({},s);delete Lo.database;var Uo=JSON.stringify(Lo);ke("Connection","XHR sending: ",d+" "+Uo);var Qo={"Content-Type":"text/plain"};h.zE(Qo,c),Bo.send(d,"POST",Uo,Qo,15)})},l.prototype.f_=function(o,s,c){return this.d_(o,s,c)},l.prototype.s_=function(o,s){var c=[this.GE,"/","google.firestore.v1.Firestore","/",o,"/channel"],h=esm_1(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.zE(d.initMessageHeaders,s),index_cjsExports$1.isMobileCordova()||index_cjsExports$1.isReactNative()||index_cjsExports$1.isElectron()||index_cjsExports$1.isIE()||index_cjsExports$1.isUWP()||index_cjsExports$1.isBrowserExtension()||(d.httpHeadersOverwriteParam="$httpHeaders");var p=c.join("");ke("Connection","Creating WebChannel: "+p+" "+d);var Co=h.createWebChannel(p,d),Bo=!1,Lo=!1,Uo=new ko({xE:function(Po){Lo?ke("Connection","Not sending because WebChannel is closed:",Po):(Bo||(ke("Connection","Opening WebChannel transport."),Co.open(),Bo=!0),ke("Connection","WebChannel sending:",Po),Co.send(Po))},BE:function(){return Co.close()}}),Qo=function(Po,Mo){Co.listen(Po,function(Go){try{Mo(Go)}catch($o){setTimeout(function(){throw $o},0)}})};return Qo(esm_4.EventType.OPEN,function(){Lo||ke("Connection","WebChannel transport opened.")}),Qo(esm_4.EventType.CLOSE,function(){Lo||(Lo=!0,ke("Connection","WebChannel transport closed"),Uo.jE())}),Qo(esm_4.EventType.ERROR,function(Po){Lo||(Lo=!0,ke("Connection","WebChannel transport errored:",Po),Uo.jE(new I(T$1.UNAVAILABLE,"The operation could not be completed")))}),Qo(esm_4.EventType.MESSAGE,function(Po){var Mo;if(!Lo){var Go=Po.data[0];Re(!!Go);var $o=Go,jo=$o.error||((Mo=$o[0])===null||Mo===void 0?void 0:Mo.error);if(jo){ke("Connection","WebChannel received error:",jo);var zo=jo.status,Xo=function(Wo){var es=At[Wo];if(es!==void 0)return Gt(es)}(zo),Zo=jo.message;Xo===void 0&&(Xo=T$1.INTERNAL,Zo="Unknown error status: "+zo+" with message "+jo.message),Lo=!0,Uo.jE(new I(Xo,Zo)),Co.close()}else ke("Connection","WebChannel received:",Go),Uo.KE(Go)}}),setTimeout(function(){Uo.WE()},0),Uo},l.prototype.HE=function(o){var s=Do[o];return this.GE+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+s},l}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ro(l){(function(o,s){o.INTERNAL.registerComponent(new index_cjsExports.Component("firestore",function(c){return function(h,d){return new $i(h,d,new Bi)}(c.getProvider("app").getImmediate(),c.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},No)))})(l),l.registerVersion("@firebase/firestore","1.14.6")}Ie.an(new(function(){function l(){this.ac=typeof atob<"u"}return Object.defineProperty(l.prototype,"document",{get:function(){return typeof document<"u"?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"window",{get:function(){return typeof window<"u"?window:null},enumerable:!0,configurable:!0}),l.prototype.yT=function(o){return Promise.resolve(new xo(o))},l.prototype.AT=function(){return _o.Gh()?new _o:new Ao},l.prototype.bc=function(o){return new be(o,{hi:!0})},l.prototype.un=function(o){return JSON.stringify(o)},l.prototype.atob=function(o){return atob(o)},l.prototype.btoa=function(o){return btoa(o)},l.prototype._n=function(o){var s=typeof self<"u"&&(self.crypto||self.msCrypto),c=new Uint8Array(o);if(s)s.getRandomValues(c);else for(var h=0;h<o;h++)c[h]=Math.floor(256*Math.random());return c},l}())),Ro(index_cjsExports$2);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var DOMStorageWrapper=function(){function l(o){this.domStorage_=o,this.prefix_="firebase:"}return l.prototype.set=function(o,s){s==null?this.domStorage_.removeItem(this.prefixedName_(o)):this.domStorage_.setItem(this.prefixedName_(o),index_cjsExports$1.stringify(s))},l.prototype.get=function(o){var s=this.domStorage_.getItem(this.prefixedName_(o));return s==null?null:index_cjsExports$1.jsonEval(s)},l.prototype.remove=function(o){this.domStorage_.removeItem(this.prefixedName_(o))},l.prototype.prefixedName_=function(o){return this.prefix_+o},l.prototype.toString=function(){return this.domStorage_.toString()},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var MemoryStorage=function(){function l(){this.cache_={},this.isInMemoryStorage=!0}return l.prototype.set=function(o,s){s==null?delete this.cache_[o]:this.cache_[o]=s},l.prototype.get=function(o){return index_cjsExports$1.contains(this.cache_,o)?this.cache_[o]:null},l.prototype.remove=function(o){delete this.cache_[o]},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var createStoragefor=function(l){try{if(typeof window<"u"&&typeof window[l]<"u"){var o=window[l];return o.setItem("firebase:sentinel","cache"),o.removeItem("firebase:sentinel"),new DOMStorageWrapper(o)}}catch{}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var logClient=new Logger$1("@firebase/database"),LUIDGenerator=function(){var l=1;return function(){return l++}}(),sha1=function(l){var o=index_cjsExports$1.stringToByteArray(l),s=new index_cjsExports$1.Sha1;s.update(o);var c=s.digest();return index_cjsExports$1.base64.encodeByteArray(c)},buildLogMessage_=function(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];for(var s="",c=0;c<l.length;c++){var h=l[c];Array.isArray(h)||h&&typeof h=="object"&&typeof h.length=="number"?s+=buildLogMessage_.apply(null,h):typeof h=="object"?s+=index_cjsExports$1.stringify(h):s+=h,s+=" "}return s},logger=null,firstLog_=!0,enableLogging=function(l,o){index_cjsExports$1.assert(!o||l===!0||l===!1,"Can't turn on custom loggers persistently."),l===!0?(logClient.logLevel=LogLevel.VERBOSE,logger=logClient.log.bind(logClient),o&&SessionStorage.set("logging_enabled",!0)):typeof l=="function"?logger=l:(logger=null,SessionStorage.remove("logging_enabled"))},log=function(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];if(firstLog_===!0&&(firstLog_=!1,logger===null&&SessionStorage.get("logging_enabled")===!0&&enableLogging(!0)),logger){var s=buildLogMessage_.apply(null,l);logger(s)}},logWrapper=function(l){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];log.apply(void 0,__spread([l],o))}},error$1=function(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];var s="FIREBASE INTERNAL ERROR: "+buildLogMessage_.apply(void 0,__spread(l));logClient.error(s)},fatal=function(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];var s="FIREBASE FATAL ERROR: "+buildLogMessage_.apply(void 0,__spread(l));throw logClient.error(s),new Error(s)},warn=function(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];var s="FIREBASE WARNING: "+buildLogMessage_.apply(void 0,__spread(l));logClient.warn(s)},warnIfPageIsSecure=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(l){return typeof l=="number"&&(l!==l||l===Number.POSITIVE_INFINITY||l===Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(l){if(index_cjsExports$1.isNodeSdk()||document.readyState==="complete")l();else{var o=!1,s=function(){if(!document.body){setTimeout(s,Math.floor(10));return}o||(o=!0,l())};document.addEventListener?(document.addEventListener("DOMContentLoaded",s,!1),window.addEventListener("load",s,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){document.readyState==="complete"&&s()}),window.attachEvent("onload",s))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(l,o){if(l===o)return 0;if(l===MIN_NAME||o===MAX_NAME)return-1;if(o===MIN_NAME||l===MAX_NAME)return 1;var s=tryParseInt(l),c=tryParseInt(o);return s!==null?c!==null?s-c===0?l.length-o.length:s-c:-1:c!==null?1:l<o?-1:1},stringCompare=function(l,o){return l===o?0:l<o?-1:1},requireKey=function(l,o){if(o&&l in o)return o[l];throw new Error("Missing required key ("+l+") in object: "+index_cjsExports$1.stringify(o))},ObjectToUniqueKey=function(l){if(typeof l!="object"||l===null)return index_cjsExports$1.stringify(l);var o=[];for(var s in l)o.push(s);o.sort();for(var c="{",h=0;h<o.length;h++)h!==0&&(c+=","),c+=index_cjsExports$1.stringify(o[h]),c+=":",c+=ObjectToUniqueKey(l[o[h]]);return c+="}",c},splitStringBySize=function(l,o){var s=l.length;if(s<=o)return[l];for(var c=[],h=0;h<s;h+=o)h+o>s?c.push(l.substring(h,s)):c.push(l.substring(h,h+o));return c};function each$1(l,o){for(var s in l)l.hasOwnProperty(s)&&o(s,l[s])}var doubleToIEEE754String=function(l){index_cjsExports$1.assert(!isInvalidJSONNumber(l),"Invalid JSON number");var o=11,s=52,c=(1<<o-1)-1,h,d,p,Co,Bo;l===0?(d=0,p=0,h=1/l===-1/0?1:0):(h=l<0,l=Math.abs(l),l>=Math.pow(2,1-c)?(Co=Math.min(Math.floor(Math.log(l)/Math.LN2),c),d=Co+c,p=Math.round(l*Math.pow(2,s-Co)-Math.pow(2,s))):(d=0,p=Math.round(l/Math.pow(2,1-c-s))));var Lo=[];for(Bo=s;Bo;Bo-=1)Lo.push(p%2?1:0),p=Math.floor(p/2);for(Bo=o;Bo;Bo-=1)Lo.push(d%2?1:0),d=Math.floor(d/2);Lo.push(h?1:0),Lo.reverse();var Uo=Lo.join(""),Qo="";for(Bo=0;Bo<64;Bo+=8){var Po=parseInt(Uo.substr(Bo,8),2).toString(16);Po.length===1&&(Po="0"+Po),Qo=Qo+Po}return Qo.toLowerCase()},isChromeExtensionContentScript=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},errorForServerCode=function(l,o){var s="Unknown Error";l==="too_big"?s="The data requested exceeds the maximum size that can be accessed with a single request.":l==="permission_denied"?s="Client doesn't have permission to access the desired data.":l==="unavailable"&&(s="The service is unavailable");var c=new Error(l+" at "+o.path.toString()+": "+s);return c.code=l.toUpperCase(),c},INTEGER_REGEXP_=new RegExp("^-?(0*)\\d{1,10}$"),tryParseInt=function(l){if(INTEGER_REGEXP_.test(l)){var o=Number(l);if(o>=-2147483648&&o<=2147483647)return o}return null},exceptionGuard=function(l){try{l()}catch(o){setTimeout(function(){var s=o.stack||"";throw warn("Exception was thrown by user callback.",s),o},Math.floor(0))}},beingCrawled=function(){var l=typeof window=="object"&&window.navigator&&window.navigator.userAgent||"";return l.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},setTimeoutNonBlocking=function(l,o){var s=setTimeout(l,o);return typeof s=="object"&&s.unref&&s.unref(),s};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Path=function(){function l(o,s){if(s===void 0){this.pieces_=o.split("/");for(var c=0,h=0;h<this.pieces_.length;h++)this.pieces_[h].length>0&&(this.pieces_[c]=this.pieces_[h],c++);this.pieces_.length=c,this.pieceNum_=0}else this.pieces_=o,this.pieceNum_=s}return Object.defineProperty(l,"Empty",{get:function(){return new l("")},enumerable:!0,configurable:!0}),l.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},l.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},l.prototype.popFront=function(){var o=this.pieceNum_;return o<this.pieces_.length&&o++,new l(this.pieces_,o)},l.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},l.prototype.toString=function(){for(var o="",s=this.pieceNum_;s<this.pieces_.length;s++)this.pieces_[s]!==""&&(o+="/"+this.pieces_[s]);return o||"/"},l.prototype.toUrlEncodedString=function(){for(var o="",s=this.pieceNum_;s<this.pieces_.length;s++)this.pieces_[s]!==""&&(o+="/"+encodeURIComponent(String(this.pieces_[s])));return o||"/"},l.prototype.slice=function(o){return o===void 0&&(o=0),this.pieces_.slice(this.pieceNum_+o)},l.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var o=[],s=this.pieceNum_;s<this.pieces_.length-1;s++)o.push(this.pieces_[s]);return new l(o,0)},l.prototype.child=function(o){for(var s=[],c=this.pieceNum_;c<this.pieces_.length;c++)s.push(this.pieces_[c]);if(o instanceof l)for(var c=o.pieceNum_;c<o.pieces_.length;c++)s.push(o.pieces_[c]);else for(var h=o.split("/"),c=0;c<h.length;c++)h[c].length>0&&s.push(h[c]);return new l(s,0)},l.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},l.relativePath=function(o,s){var c=o.getFront(),h=s.getFront();if(c===null)return s;if(c===h)return l.relativePath(o.popFront(),s.popFront());throw new Error("INTERNAL ERROR: innerPath ("+s+") is not within outerPath ("+o+")")},l.comparePaths=function(o,s){for(var c=o.slice(),h=s.slice(),d=0;d<c.length&&d<h.length;d++){var p=nameCompare(c[d],h[d]);if(p!==0)return p}return c.length===h.length?0:c.length<h.length?-1:1},l.prototype.equals=function(o){if(this.getLength()!==o.getLength())return!1;for(var s=this.pieceNum_,c=o.pieceNum_;s<=this.pieces_.length;s++,c++)if(this.pieces_[s]!==o.pieces_[c])return!1;return!0},l.prototype.contains=function(o){var s=this.pieceNum_,c=o.pieceNum_;if(this.getLength()>o.getLength())return!1;for(;s<this.pieces_.length;){if(this.pieces_[s]!==o.pieces_[c])return!1;++s,++c}return!0},l}(),ValidationPath=function(){function l(o,s){this.errorPrefix_=s,this.parts_=o.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var c=0;c<this.parts_.length;c++)this.byteLength_+=index_cjsExports$1.stringLength(this.parts_[c]);this.checkValid_()}return Object.defineProperty(l,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(l,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),l.prototype.push=function(o){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(o),this.byteLength_+=index_cjsExports$1.stringLength(o),this.checkValid_()},l.prototype.pop=function(){var o=this.parts_.pop();this.byteLength_-=index_cjsExports$1.stringLength(o),this.parts_.length>0&&(this.byteLength_-=1)},l.prototype.checkValid_=function(){if(this.byteLength_>l.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+l.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>l.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+l.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},l.prototype.toErrorString=function(){return this.parts_.length===0?"":"in property '"+this.parts_.join(".")+"'"},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var PROTOCOL_VERSION="5",VERSION_PARAM="v",TRANSPORT_SESSION_PARAM="s",REFERER_PARAM="r",FORGE_REF="f",FORGE_DOMAIN="firebaseio.com",LAST_SESSION_PARAM="ls",WEBSOCKET="websocket",LONG_POLLING="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var RepoInfo=function(){function l(o,s,c,h,d,p){d===void 0&&(d=""),p===void 0&&(p=!1),this.secure=s,this.namespace=c,this.webSocketOnly=h,this.persistenceKey=d,this.includeNamespaceInQueryParams=p,this.host=o.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+o)||this.host}return l.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},l.prototype.isCacheableHost=function(){return this.internalHost.substr(0,2)==="s-"},l.prototype.isDemoHost=function(){return this.domain==="firebaseio-demo.com"},l.prototype.isCustomHost=function(){return this.domain!=="firebaseio.com"&&this.domain!=="firebaseio-demo.com"},l.prototype.updateHost=function(o){o!==this.internalHost&&(this.internalHost=o,this.isCacheableHost()&&PersistentStorage.set("host:"+this.host,this.internalHost))},l.prototype.connectionURL=function(o,s){index_cjsExports$1.assert(typeof o=="string","typeof type must == string"),index_cjsExports$1.assert(typeof s=="object","typeof params must == object");var c;if(o===WEBSOCKET)c=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else if(o===LONG_POLLING)c=(this.secure?"https://":"http://")+this.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+o);this.needsQueryParam()&&(s.ns=this.namespace);var h=[];return each$1(s,function(d,p){h.push(d+"="+p)}),c+h.join("&")},l.prototype.toString=function(){var o=this.toURLString();return this.persistenceKey&&(o+="<"+this.persistenceKey+">"),o},l.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function decodePath(l){for(var o="",s=l.split("/"),c=0;c<s.length;c++)if(s[c].length>0){var h=s[c];try{h=decodeURIComponent(h.replace(/\+/g," "))}catch{}o+="/"+h}return o}function decodeQuery(l){var o,s,c={};l.charAt(0)==="?"&&(l=l.substring(1));try{for(var h=__values$1(l.split("&")),d=h.next();!d.done;d=h.next()){var p=d.value;if(p.length!==0){var Co=p.split("=");Co.length===2?c[decodeURIComponent(Co[0])]=decodeURIComponent(Co[1]):warn("Invalid query segment '"+p+"' in query '"+l+"'")}}}catch(Bo){o={error:Bo}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}return c}var parseRepoInfo=function(l){var o=parseDatabaseURL(l),s=o.namespace;o.domain==="firebase.com"&&fatal(o.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&o.domain!=="localhost"&&fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),o.secure||warnIfPageIsSecure();var c=o.scheme==="ws"||o.scheme==="wss";return{repoInfo:new RepoInfo(o.host,o.secure,s,c,"",s!==o.subdomain),path:new Path(o.pathString)}},parseDatabaseURL=function(l){var o="",s="",c="",h="",d="",p=!0,Co="https",Bo=443;if(typeof l=="string"){var Lo=l.indexOf("//");Lo>=0&&(Co=l.substring(0,Lo-1),l=l.substring(Lo+2));var Uo=l.indexOf("/");Uo===-1&&(Uo=l.length);var Qo=l.indexOf("?");Qo===-1&&(Qo=l.length),o=l.substring(0,Math.min(Uo,Qo)),Uo<Qo&&(h=decodePath(l.substring(Uo,Qo)));var Po=decodeQuery(l.substring(Math.min(l.length,Qo)));Lo=o.indexOf(":"),Lo>=0?(p=Co==="https"||Co==="wss",Bo=parseInt(o.substring(Lo+1),10)):Lo=o.length;var Mo=o.slice(0,Lo);if(Mo.toLowerCase()==="localhost")s="localhost";else if(Mo.split(".").length<=2)s=Mo;else{var Go=o.indexOf(".");c=o.substring(0,Go).toLowerCase(),s=o.substring(Go+1),d=c}"ns"in Po&&(d=Po.ns)}return{host:o,port:Bo,domain:s,subdomain:c,secure:p,scheme:Co,pathString:h,namespace:d}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,MAX_LEAF_SIZE_=10*1024*1024,isValidKey$1=function(l){return typeof l=="string"&&l.length!==0&&!INVALID_KEY_REGEX_.test(l)},isValidPathString=function(l){return typeof l=="string"&&l.length!==0&&!INVALID_PATH_REGEX_.test(l)},isValidRootPathString=function(l){return l&&(l=l.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(l)},isValidPriority=function(l){return l===null||typeof l=="string"||typeof l=="number"&&!isInvalidJSONNumber(l)||l&&typeof l=="object"&&index_cjsExports$1.contains(l,".sv")},validateFirebaseDataArg=function(l,o,s,c,h){h&&s===void 0||validateFirebaseData(index_cjsExports$1.errorPrefix(l,o,h),s,c)},validateFirebaseData=function(l,o,s){var c=s instanceof Path?new ValidationPath(s,l):s;if(o===void 0)throw new Error(l+"contains undefined "+c.toErrorString());if(typeof o=="function")throw new Error(l+"contains a function "+c.toErrorString()+" with contents = "+o.toString());if(isInvalidJSONNumber(o))throw new Error(l+"contains "+o.toString()+" "+c.toErrorString());if(typeof o=="string"&&o.length>MAX_LEAF_SIZE_/3&&index_cjsExports$1.stringLength(o)>MAX_LEAF_SIZE_)throw new Error(l+"contains a string greater than "+MAX_LEAF_SIZE_+" utf8 bytes "+c.toErrorString()+" ('"+o.substring(0,50)+"...')");if(o&&typeof o=="object"){var h=!1,d=!1;if(each$1(o,function(p,Co){if(p===".value")h=!0;else if(p!==".priority"&&p!==".sv"&&(d=!0,!isValidKey$1(p)))throw new Error(l+" contains an invalid key ("+p+") "+c.toErrorString()+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);c.push(p),validateFirebaseData(l,Co,c),c.pop()}),h&&d)throw new Error(l+' contains ".value" child '+c.toErrorString()+" in addition to actual children.")}},validateFirebaseMergePaths=function(l,o){var s,c;for(s=0;s<o.length;s++){c=o[s];for(var h=c.slice(),d=0;d<h.length;d++)if(!(h[d]===".priority"&&d===h.length-1)){if(!isValidKey$1(h[d]))throw new Error(l+"contains an invalid key ("+h[d]+") in path "+c.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}o.sort(Path.comparePaths);var p=null;for(s=0;s<o.length;s++){if(c=o[s],p!==null&&p.contains(c))throw new Error(l+"contains a path "+p.toString()+" that is ancestor of another path "+c.toString());p=c}},validateFirebaseMergeDataArg=function(l,o,s,c,h){if(!(h&&s===void 0)){var d=index_cjsExports$1.errorPrefix(l,o,h);if(!(s&&typeof s=="object")||Array.isArray(s))throw new Error(d+" must be an object containing the children to replace.");var p=[];each$1(s,function(Co,Bo){var Lo=new Path(Co);if(validateFirebaseData(d,Bo,c.child(Lo)),Lo.getBack()===".priority"&&!isValidPriority(Bo))throw new Error(d+"contains an invalid value for '"+Lo.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");p.push(Lo)}),validateFirebaseMergePaths(d,p)}},validatePriority=function(l,o,s,c){if(!(c&&s===void 0)){if(isInvalidJSONNumber(s))throw new Error(index_cjsExports$1.errorPrefix(l,o,c)+"is "+s.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!isValidPriority(s))throw new Error(index_cjsExports$1.errorPrefix(l,o,c)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},validateEventType=function(l,o,s,c){if(!(c&&s===void 0))switch(s){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(index_cjsExports$1.errorPrefix(l,o,c)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},validateKey=function(l,o,s,c){if(!(c&&s===void 0)&&!isValidKey$1(s))throw new Error(index_cjsExports$1.errorPrefix(l,o,c)+'was an invalid key = "'+s+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},validatePathString=function(l,o,s,c){if(!(c&&s===void 0)&&!isValidPathString(s))throw new Error(index_cjsExports$1.errorPrefix(l,o,c)+'was an invalid path = "'+s+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},validateRootPathString=function(l,o,s,c){s&&(s=s.replace(/^\/*\.info(\/|$)/,"/")),validatePathString(l,o,s,c)},validateWritablePath=function(l,o){if(o.getFront()===".info")throw new Error(l+" failed = Can't modify data under /.info/")},validateUrl=function(l,o,s){var c=s.path.toString();if(typeof s.repoInfo.host!="string"||s.repoInfo.host.length===0||!isValidKey$1(s.repoInfo.namespace)&&s.repoInfo.host.split(":")[0]!=="localhost"||c.length!==0&&!isValidRootPathString(c))throw new Error(index_cjsExports$1.errorPrefix(l,o,!1)+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)},validateBoolean=function(l,o,s,c){if(!(c&&s===void 0)&&typeof s!="boolean")throw new Error(index_cjsExports$1.errorPrefix(l,o,c)+"must be a boolean.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OnDisconnect=function(){function l(o,s){this.repo_=o,this.path_=s}return l.prototype.cancel=function(o){index_cjsExports$1.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),index_cjsExports$1.validateCallback("OnDisconnect.cancel",1,o,!0);var s=new index_cjsExports$1.Deferred;return this.repo_.onDisconnectCancel(this.path_,s.wrapCallback(o)),s.promise},l.prototype.remove=function(o){index_cjsExports$1.validateArgCount("OnDisconnect.remove",0,1,arguments.length),validateWritablePath("OnDisconnect.remove",this.path_),index_cjsExports$1.validateCallback("OnDisconnect.remove",1,o,!0);var s=new index_cjsExports$1.Deferred;return this.repo_.onDisconnectSet(this.path_,null,s.wrapCallback(o)),s.promise},l.prototype.set=function(o,s){index_cjsExports$1.validateArgCount("OnDisconnect.set",1,2,arguments.length),validateWritablePath("OnDisconnect.set",this.path_),validateFirebaseDataArg("OnDisconnect.set",1,o,this.path_,!1),index_cjsExports$1.validateCallback("OnDisconnect.set",2,s,!0);var c=new index_cjsExports$1.Deferred;return this.repo_.onDisconnectSet(this.path_,o,c.wrapCallback(s)),c.promise},l.prototype.setWithPriority=function(o,s,c){index_cjsExports$1.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),validateWritablePath("OnDisconnect.setWithPriority",this.path_),validateFirebaseDataArg("OnDisconnect.setWithPriority",1,o,this.path_,!1),validatePriority("OnDisconnect.setWithPriority",2,s,!1),index_cjsExports$1.validateCallback("OnDisconnect.setWithPriority",3,c,!0);var h=new index_cjsExports$1.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,o,s,h.wrapCallback(c)),h.promise},l.prototype.update=function(o,s){if(index_cjsExports$1.validateArgCount("OnDisconnect.update",1,2,arguments.length),validateWritablePath("OnDisconnect.update",this.path_),Array.isArray(o)){for(var c={},h=0;h<o.length;++h)c[""+h]=o[h];o=c,warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateFirebaseMergeDataArg("OnDisconnect.update",1,o,this.path_,!1),index_cjsExports$1.validateCallback("OnDisconnect.update",2,s,!0);var d=new index_cjsExports$1.Deferred;return this.repo_.onDisconnectUpdate(this.path_,o,d.wrapCallback(s)),d.promise},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var TransactionResult=function(){function l(o,s){this.committed=o,this.snapshot=s}return l.prototype.toJSON=function(){return index_cjsExports$1.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nextPushId=function(){var l="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",o=0,s=[];return function(c){var h=c===o;o=c;var d,p=new Array(8);for(d=7;d>=0;d--)p[d]=l.charAt(c%64),c=Math.floor(c/64);index_cjsExports$1.assert(c===0,"Cannot push at time == 0");var Co=p.join("");if(h){for(d=11;d>=0&&s[d]===63;d--)s[d]=0;s[d]++}else for(d=0;d<12;d++)s[d]=Math.floor(Math.random()*64);for(d=0;d<12;d++)Co+=l.charAt(s[d]);return index_cjsExports$1.assert(Co.length===20,"nextPushId: Length should be 20."),Co}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var NamedNode=function(){function l(o,s){this.name=o,this.node=s}return l.Wrap=function(o,s){return new l(o,s)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Index=function(){function l(){}return l.prototype.getCompare=function(){return this.compare.bind(this)},l.prototype.indexedValueChanged=function(o,s){var c=new NamedNode(MIN_NAME,o),h=new NamedNode(MIN_NAME,s);return this.compare(c,h)!==0},l.prototype.minPost=function(){return NamedNode.MIN},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __EMPTY_NODE,KeyIndex=function(l){__extends$1(o,l);function o(){return l!==null&&l.apply(this,arguments)||this}return Object.defineProperty(o,"__EMPTY_NODE",{get:function(){return __EMPTY_NODE},set:function(s){__EMPTY_NODE=s},enumerable:!0,configurable:!0}),o.prototype.compare=function(s,c){return nameCompare(s.name,c.name)},o.prototype.isDefinedOn=function(s){throw index_cjsExports$1.assertionError("KeyIndex.isDefinedOn not expected to be called.")},o.prototype.indexedValueChanged=function(s,c){return!1},o.prototype.minPost=function(){return NamedNode.MIN},o.prototype.maxPost=function(){return new NamedNode(MAX_NAME,__EMPTY_NODE)},o.prototype.makePost=function(s,c){return index_cjsExports$1.assert(typeof s=="string","KeyIndex indexValue must always be a string."),new NamedNode(s,__EMPTY_NODE)},o.prototype.toString=function(){return".key"},o}(Index),KEY_INDEX=new KeyIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var MAX_NODE;function setMaxNode(l){MAX_NODE=l}var priorityHashText=function(l){return typeof l=="number"?"number:"+doubleToIEEE754String(l):"string:"+l},validatePriorityNode=function(l){if(l.isLeafNode()){var o=l.val();index_cjsExports$1.assert(typeof o=="string"||typeof o=="number"||typeof o=="object"&&index_cjsExports$1.contains(o,".sv"),"Priority must be a string or number.")}else index_cjsExports$1.assert(l===MAX_NODE||l.isEmpty(),"priority of unexpected type.");index_cjsExports$1.assert(l===MAX_NODE||l.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __childrenNodeConstructor,LeafNode=function(){function l(o,s){s===void 0&&(s=l.__childrenNodeConstructor.EMPTY_NODE),this.value_=o,this.priorityNode_=s,this.lazyHash_=null,index_cjsExports$1.assert(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}return Object.defineProperty(l,"__childrenNodeConstructor",{get:function(){return __childrenNodeConstructor},set:function(o){__childrenNodeConstructor=o},enumerable:!0,configurable:!0}),l.prototype.isLeafNode=function(){return!0},l.prototype.getPriority=function(){return this.priorityNode_},l.prototype.updatePriority=function(o){return new l(this.value_,o)},l.prototype.getImmediateChild=function(o){return o===".priority"?this.priorityNode_:l.__childrenNodeConstructor.EMPTY_NODE},l.prototype.getChild=function(o){return o.isEmpty()?this:o.getFront()===".priority"?this.priorityNode_:l.__childrenNodeConstructor.EMPTY_NODE},l.prototype.hasChild=function(){return!1},l.prototype.getPredecessorChildName=function(o,s){return null},l.prototype.updateImmediateChild=function(o,s){return o===".priority"?this.updatePriority(s):s.isEmpty()&&o!==".priority"?this:l.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(o,s).updatePriority(this.priorityNode_)},l.prototype.updateChild=function(o,s){var c=o.getFront();return c===null?s:s.isEmpty()&&c!==".priority"?this:(index_cjsExports$1.assert(c!==".priority"||o.getLength()===1,".priority must be the last token in a path"),this.updateImmediateChild(c,l.__childrenNodeConstructor.EMPTY_NODE.updateChild(o.popFront(),s)))},l.prototype.isEmpty=function(){return!1},l.prototype.numChildren=function(){return 0},l.prototype.forEachChild=function(o,s){return!1},l.prototype.val=function(o){return o&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},l.prototype.hash=function(){if(this.lazyHash_===null){var o="";this.priorityNode_.isEmpty()||(o+="priority:"+priorityHashText(this.priorityNode_.val())+":");var s=typeof this.value_;o+=s+":",s==="number"?o+=doubleToIEEE754String(this.value_):o+=this.value_,this.lazyHash_=sha1(o)}return this.lazyHash_},l.prototype.getValue=function(){return this.value_},l.prototype.compareTo=function(o){return o===l.__childrenNodeConstructor.EMPTY_NODE?1:o instanceof l.__childrenNodeConstructor?-1:(index_cjsExports$1.assert(o.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(o))},l.prototype.compareToLeafNode_=function(o){var s=typeof o.value_,c=typeof this.value_,h=l.VALUE_TYPE_ORDER.indexOf(s),d=l.VALUE_TYPE_ORDER.indexOf(c);return index_cjsExports$1.assert(h>=0,"Unknown leaf type: "+s),index_cjsExports$1.assert(d>=0,"Unknown leaf type: "+c),h===d?c==="object"?0:this.value_<o.value_?-1:this.value_===o.value_?0:1:d-h},l.prototype.withIndex=function(){return this},l.prototype.isIndexed=function(){return!0},l.prototype.equals=function(o){if(o===this)return!0;if(o.isLeafNode()){var s=o;return this.value_===s.value_&&this.priorityNode_.equals(s.priorityNode_)}else return!1},l.VALUE_TYPE_ORDER=["object","boolean","number","string"],l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nodeFromJSON,MAX_NODE$1;function setNodeFromJSON(l){nodeFromJSON=l}function setMaxNode$1(l){MAX_NODE$1=l}var PriorityIndex=function(l){__extends$1(o,l);function o(){return l!==null&&l.apply(this,arguments)||this}return o.prototype.compare=function(s,c){var h=s.node.getPriority(),d=c.node.getPriority(),p=h.compareTo(d);return p===0?nameCompare(s.name,c.name):p},o.prototype.isDefinedOn=function(s){return!s.getPriority().isEmpty()},o.prototype.indexedValueChanged=function(s,c){return!s.getPriority().equals(c.getPriority())},o.prototype.minPost=function(){return NamedNode.MIN},o.prototype.maxPost=function(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))},o.prototype.makePost=function(s,c){var h=nodeFromJSON(s);return new NamedNode(c,new LeafNode("[PRIORITY-POST]",h))},o.prototype.toString=function(){return".priority"},o}(Index),PRIORITY_INDEX=new PriorityIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var SortedMapIterator=function(){function l(o,s,c,h,d){d===void 0&&(d=null),this.isReverse_=h,this.resultGenerator_=d,this.nodeStack_=[];for(var p=1;!o.isEmpty();)if(o=o,p=s?c(o.key,s):1,h&&(p*=-1),p<0)this.isReverse_?o=o.left:o=o.right;else if(p===0){this.nodeStack_.push(o);break}else this.nodeStack_.push(o),this.isReverse_?o=o.right:o=o.left}return l.prototype.getNext=function(){if(this.nodeStack_.length===0)return null;var o=this.nodeStack_.pop(),s;if(this.resultGenerator_?s=this.resultGenerator_(o.key,o.value):s={key:o.key,value:o.value},this.isReverse_)for(o=o.left;!o.isEmpty();)this.nodeStack_.push(o),o=o.right;else for(o=o.right;!o.isEmpty();)this.nodeStack_.push(o),o=o.left;return s},l.prototype.hasNext=function(){return this.nodeStack_.length>0},l.prototype.peek=function(){if(this.nodeStack_.length===0)return null;var o=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(o.key,o.value):{key:o.key,value:o.value}},l}(),LLRBNode=function(){function l(o,s,c,h,d){this.key=o,this.value=s,this.color=c!=null?c:l.RED,this.left=h!=null?h:SortedMap.EMPTY_NODE,this.right=d!=null?d:SortedMap.EMPTY_NODE}return l.prototype.copy=function(o,s,c,h,d){return new l(o!=null?o:this.key,s!=null?s:this.value,c!=null?c:this.color,h!=null?h:this.left,d!=null?d:this.right)},l.prototype.count=function(){return this.left.count()+1+this.right.count()},l.prototype.isEmpty=function(){return!1},l.prototype.inorderTraversal=function(o){return this.left.inorderTraversal(o)||!!o(this.key,this.value)||this.right.inorderTraversal(o)},l.prototype.reverseTraversal=function(o){return this.right.reverseTraversal(o)||o(this.key,this.value)||this.left.reverseTraversal(o)},l.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},l.prototype.minKey=function(){return this.min_().key},l.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},l.prototype.insert=function(o,s,c){var h=this,d=c(o,h.key);return d<0?h=h.copy(null,null,null,h.left.insert(o,s,c),null):d===0?h=h.copy(null,s,null,null,null):h=h.copy(null,null,null,null,h.right.insert(o,s,c)),h.fixUp_()},l.prototype.removeMin_=function(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;var o=this;return!o.left.isRed_()&&!o.left.left.isRed_()&&(o=o.moveRedLeft_()),o=o.copy(null,null,null,o.left.removeMin_(),null),o.fixUp_()},l.prototype.remove=function(o,s){var c,h;if(c=this,s(o,c.key)<0)!c.left.isEmpty()&&!c.left.isRed_()&&!c.left.left.isRed_()&&(c=c.moveRedLeft_()),c=c.copy(null,null,null,c.left.remove(o,s),null);else{if(c.left.isRed_()&&(c=c.rotateRight_()),!c.right.isEmpty()&&!c.right.isRed_()&&!c.right.left.isRed_()&&(c=c.moveRedRight_()),s(o,c.key)===0){if(c.right.isEmpty())return SortedMap.EMPTY_NODE;h=c.right.min_(),c=c.copy(h.key,h.value,null,null,c.right.removeMin_())}c=c.copy(null,null,null,null,c.right.remove(o,s))}return c.fixUp_()},l.prototype.isRed_=function(){return this.color},l.prototype.fixUp_=function(){var o=this;return o.right.isRed_()&&!o.left.isRed_()&&(o=o.rotateLeft_()),o.left.isRed_()&&o.left.left.isRed_()&&(o=o.rotateRight_()),o.left.isRed_()&&o.right.isRed_()&&(o=o.colorFlip_()),o},l.prototype.moveRedLeft_=function(){var o=this.colorFlip_();return o.right.left.isRed_()&&(o=o.copy(null,null,null,null,o.right.rotateRight_()),o=o.rotateLeft_(),o=o.colorFlip_()),o},l.prototype.moveRedRight_=function(){var o=this.colorFlip_();return o.left.left.isRed_()&&(o=o.rotateRight_(),o=o.colorFlip_()),o},l.prototype.rotateLeft_=function(){var o=this.copy(null,null,l.RED,null,this.right.left);return this.right.copy(null,null,this.color,o,null)},l.prototype.rotateRight_=function(){var o=this.copy(null,null,l.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,o)},l.prototype.colorFlip_=function(){var o=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,o,s)},l.prototype.checkMaxDepth_=function(){var o=this.check_();return Math.pow(2,o)<=this.count()+1},l.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var o=this.left.check_();if(o!==this.right.check_())throw new Error("Black depths differ");return o+(this.isRed_()?0:1)},l.RED=!0,l.BLACK=!1,l}(),LLRBEmptyNode=function(){function l(){}return l.prototype.copy=function(o,s,c,h,d){return this},l.prototype.insert=function(o,s,c){return new LLRBNode(o,s,null)},l.prototype.remove=function(o,s){return this},l.prototype.count=function(){return 0},l.prototype.isEmpty=function(){return!0},l.prototype.inorderTraversal=function(o){return!1},l.prototype.reverseTraversal=function(o){return!1},l.prototype.minKey=function(){return null},l.prototype.maxKey=function(){return null},l.prototype.check_=function(){return 0},l.prototype.isRed_=function(){return!1},l}(),SortedMap=function(){function l(o,s){s===void 0&&(s=l.EMPTY_NODE),this.comparator_=o,this.root_=s}return l.prototype.insert=function(o,s){return new l(this.comparator_,this.root_.insert(o,s,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},l.prototype.remove=function(o){return new l(this.comparator_,this.root_.remove(o,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},l.prototype.get=function(o){for(var s,c=this.root_;!c.isEmpty();){if(s=this.comparator_(o,c.key),s===0)return c.value;s<0?c=c.left:s>0&&(c=c.right)}return null},l.prototype.getPredecessorKey=function(o){for(var s,c=this.root_,h=null;!c.isEmpty();)if(s=this.comparator_(o,c.key),s===0){if(c.left.isEmpty())return h?h.key:null;for(c=c.left;!c.right.isEmpty();)c=c.right;return c.key}else s<0?c=c.left:s>0&&(h=c,c=c.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},l.prototype.isEmpty=function(){return this.root_.isEmpty()},l.prototype.count=function(){return this.root_.count()},l.prototype.minKey=function(){return this.root_.minKey()},l.prototype.maxKey=function(){return this.root_.maxKey()},l.prototype.inorderTraversal=function(o){return this.root_.inorderTraversal(o)},l.prototype.reverseTraversal=function(o){return this.root_.reverseTraversal(o)},l.prototype.getIterator=function(o){return new SortedMapIterator(this.root_,null,this.comparator_,!1,o)},l.prototype.getIteratorFrom=function(o,s){return new SortedMapIterator(this.root_,o,this.comparator_,!1,s)},l.prototype.getReverseIteratorFrom=function(o,s){return new SortedMapIterator(this.root_,o,this.comparator_,!0,s)},l.prototype.getReverseIterator=function(o){return new SortedMapIterator(this.root_,null,this.comparator_,!0,o)},l.EMPTY_NODE=new LLRBEmptyNode,l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LOG_2=Math.log(2),Base12Num=function(){function l(o){var s=function(d){return parseInt(Math.log(d)/LOG_2,10)},c=function(d){return parseInt(Array(d+1).join("1"),2)};this.count=s(o+1),this.current_=this.count-1;var h=c(this.count);this.bits_=o+1&h}return l.prototype.nextBitIsOne=function(){var o=!(this.bits_&1<<this.current_);return this.current_--,o},l}(),buildChildSet=function(l,o,s,c){l.sort(o);var h=function(Bo,Lo){var Uo=Lo-Bo,Qo,Po;if(Uo===0)return null;if(Uo===1)return Qo=l[Bo],Po=s?s(Qo):Qo,new LLRBNode(Po,Qo.node,LLRBNode.BLACK,null,null);var Mo=parseInt(Uo/2,10)+Bo,Go=h(Bo,Mo),$o=h(Mo+1,Lo);return Qo=l[Mo],Po=s?s(Qo):Qo,new LLRBNode(Po,Qo.node,LLRBNode.BLACK,Go,$o)},d=function(Bo){for(var Lo=null,Uo=null,Qo=l.length,Po=function(zo,Xo){var Zo=Qo-zo,Wo=Qo;Qo-=zo;var es=h(Zo+1,Wo),is=l[Zo],Jo=s?s(is):is;Mo(new LLRBNode(Jo,is.node,Xo,null,es))},Mo=function(zo){Lo?(Lo.left=zo,Lo=zo):(Uo=zo,Lo=zo)},Go=0;Go<Bo.count;++Go){var $o=Bo.nextBitIsOne(),jo=Math.pow(2,Bo.count-(Go+1));$o?Po(jo,LLRBNode.BLACK):(Po(jo,LLRBNode.BLACK),Po(jo,LLRBNode.RED))}return Uo},p=new Base12Num(l.length),Co=d(p);return new SortedMap(c||o,Co)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _defaultIndexMap,fallbackObject={},IndexMap=function(){function l(o,s){this.indexes_=o,this.indexSet_=s}return Object.defineProperty(l,"Default",{get:function(){return index_cjsExports$1.assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new l({".priority":fallbackObject},{".priority":PRIORITY_INDEX}),_defaultIndexMap},enumerable:!0,configurable:!0}),l.prototype.get=function(o){var s=index_cjsExports$1.safeGet(this.indexes_,o);if(!s)throw new Error("No index defined for "+o);return s instanceof SortedMap?s:null},l.prototype.hasIndex=function(o){return index_cjsExports$1.contains(this.indexSet_,o.toString())},l.prototype.addIndex=function(o,s){index_cjsExports$1.assert(o!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var c=[],h=!1,d=s.getIterator(NamedNode.Wrap),p=d.getNext();p;)h=h||o.isDefinedOn(p.node),c.push(p),p=d.getNext();var Co;h?Co=buildChildSet(c,o.getCompare()):Co=fallbackObject;var Bo=o.toString(),Lo=__assign$1({},this.indexSet_);Lo[Bo]=o;var Uo=__assign$1({},this.indexes_);return Uo[Bo]=Co,new l(Uo,Lo)},l.prototype.addToIndexes=function(o,s){var c=this,h=index_cjsExports$1.map(this.indexes_,function(d,p){var Co=index_cjsExports$1.safeGet(c.indexSet_,p);if(index_cjsExports$1.assert(Co,"Missing index implementation for "+p),d===fallbackObject)if(Co.isDefinedOn(o.node)){for(var Bo=[],Lo=s.getIterator(NamedNode.Wrap),Uo=Lo.getNext();Uo;)Uo.name!==o.name&&Bo.push(Uo),Uo=Lo.getNext();return Bo.push(o),buildChildSet(Bo,Co.getCompare())}else return fallbackObject;else{var Qo=s.get(o.name),Po=d;return Qo&&(Po=Po.remove(new NamedNode(o.name,Qo))),Po.insert(o,o.node)}});return new l(h,this.indexSet_)},l.prototype.removeFromIndexes=function(o,s){var c=index_cjsExports$1.map(this.indexes_,function(h){if(h===fallbackObject)return h;var d=s.get(o.name);return d?h.remove(new NamedNode(o.name,d)):h});return new l(c,this.indexSet_)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NAME_ONLY_COMPARATOR(l,o){return nameCompare(l.name,o.name)}function NAME_COMPARATOR(l,o){return nameCompare(l,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var EMPTY_NODE,ChildrenNode=function(){function l(o,s,c){this.children_=o,this.priorityNode_=s,this.indexMap_=c,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&index_cjsExports$1.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(l,"EMPTY_NODE",{get:function(){return EMPTY_NODE||(EMPTY_NODE=new l(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))},enumerable:!0,configurable:!0}),l.prototype.isLeafNode=function(){return!1},l.prototype.getPriority=function(){return this.priorityNode_||EMPTY_NODE},l.prototype.updatePriority=function(o){return this.children_.isEmpty()?this:new l(this.children_,o,this.indexMap_)},l.prototype.getImmediateChild=function(o){if(o===".priority")return this.getPriority();var s=this.children_.get(o);return s===null?EMPTY_NODE:s},l.prototype.getChild=function(o){var s=o.getFront();return s===null?this:this.getImmediateChild(s).getChild(o.popFront())},l.prototype.hasChild=function(o){return this.children_.get(o)!==null},l.prototype.updateImmediateChild=function(o,s){if(index_cjsExports$1.assert(s,"We should always be passing snapshot nodes"),o===".priority")return this.updatePriority(s);var c=new NamedNode(o,s),h=void 0,d=void 0;s.isEmpty()?(h=this.children_.remove(o),d=this.indexMap_.removeFromIndexes(c,this.children_)):(h=this.children_.insert(o,s),d=this.indexMap_.addToIndexes(c,this.children_));var p=h.isEmpty()?EMPTY_NODE:this.priorityNode_;return new l(h,p,d)},l.prototype.updateChild=function(o,s){var c=o.getFront();if(c===null)return s;index_cjsExports$1.assert(o.getFront()!==".priority"||o.getLength()===1,".priority must be the last token in a path");var h=this.getImmediateChild(c).updateChild(o.popFront(),s);return this.updateImmediateChild(c,h)},l.prototype.isEmpty=function(){return this.children_.isEmpty()},l.prototype.numChildren=function(){return this.children_.count()},l.prototype.val=function(o){if(this.isEmpty())return null;var s={},c=0,h=0,d=!0;if(this.forEachChild(PRIORITY_INDEX,function(Bo,Lo){s[Bo]=Lo.val(o),c++,d&&l.INTEGER_REGEXP_.test(Bo)?h=Math.max(h,Number(Bo)):d=!1}),!o&&d&&h<2*c){var p=[];for(var Co in s)p[Co]=s[Co];return p}else return o&&!this.getPriority().isEmpty()&&(s[".priority"]=this.getPriority().val()),s},l.prototype.hash=function(){if(this.lazyHash_===null){var o="";this.getPriority().isEmpty()||(o+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,function(s,c){var h=c.hash();h!==""&&(o+=":"+s+":"+h)}),this.lazyHash_=o===""?"":sha1(o)}return this.lazyHash_},l.prototype.getPredecessorChildName=function(o,s,c){var h=this.resolveIndex_(c);if(h){var d=h.getPredecessorKey(new NamedNode(o,s));return d?d.name:null}else return this.children_.getPredecessorKey(o)},l.prototype.getFirstChildName=function(o){var s=this.resolveIndex_(o);if(s){var c=s.minKey();return c&&c.name}else return this.children_.minKey()},l.prototype.getFirstChild=function(o){var s=this.getFirstChildName(o);return s?new NamedNode(s,this.children_.get(s)):null},l.prototype.getLastChildName=function(o){var s=this.resolveIndex_(o);if(s){var c=s.maxKey();return c&&c.name}else return this.children_.maxKey()},l.prototype.getLastChild=function(o){var s=this.getLastChildName(o);return s?new NamedNode(s,this.children_.get(s)):null},l.prototype.forEachChild=function(o,s){var c=this.resolveIndex_(o);return c?c.inorderTraversal(function(h){return s(h.name,h.node)}):this.children_.inorderTraversal(s)},l.prototype.getIterator=function(o){return this.getIteratorFrom(o.minPost(),o)},l.prototype.getIteratorFrom=function(o,s){var c=this.resolveIndex_(s);if(c)return c.getIteratorFrom(o,function(p){return p});for(var h=this.children_.getIteratorFrom(o.name,NamedNode.Wrap),d=h.peek();d!=null&&s.compare(d,o)<0;)h.getNext(),d=h.peek();return h},l.prototype.getReverseIterator=function(o){return this.getReverseIteratorFrom(o.maxPost(),o)},l.prototype.getReverseIteratorFrom=function(o,s){var c=this.resolveIndex_(s);if(c)return c.getReverseIteratorFrom(o,function(p){return p});for(var h=this.children_.getReverseIteratorFrom(o.name,NamedNode.Wrap),d=h.peek();d!=null&&s.compare(d,o)>0;)h.getNext(),d=h.peek();return h},l.prototype.compareTo=function(o){return this.isEmpty()?o.isEmpty()?0:-1:o.isLeafNode()||o.isEmpty()?1:o===MAX_NODE$2?-1:0},l.prototype.withIndex=function(o){if(o===KEY_INDEX||this.indexMap_.hasIndex(o))return this;var s=this.indexMap_.addIndex(o,this.children_);return new l(this.children_,this.priorityNode_,s)},l.prototype.isIndexed=function(o){return o===KEY_INDEX||this.indexMap_.hasIndex(o)},l.prototype.equals=function(o){if(o===this)return!0;if(o.isLeafNode())return!1;var s=o;if(this.getPriority().equals(s.getPriority()))if(this.children_.count()===s.children_.count()){for(var c=this.getIterator(PRIORITY_INDEX),h=s.getIterator(PRIORITY_INDEX),d=c.getNext(),p=h.getNext();d&&p;){if(d.name!==p.name||!d.node.equals(p.node))return!1;d=c.getNext(),p=h.getNext()}return d===null&&p===null}else return!1;else return!1},l.prototype.resolveIndex_=function(o){return o===KEY_INDEX?null:this.indexMap_.get(o.toString())},l.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,l}(),MaxNode=function(l){__extends$1(o,l);function o(){return l.call(this,new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)||this}return o.prototype.compareTo=function(s){return s===this?0:1},o.prototype.equals=function(s){return s===this},o.prototype.getPriority=function(){return this},o.prototype.getImmediateChild=function(s){return ChildrenNode.EMPTY_NODE},o.prototype.isEmpty=function(){return!1},o}(ChildrenNode),MAX_NODE$2=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE$2)}});KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE;LeafNode.__childrenNodeConstructor=ChildrenNode;setMaxNode(MAX_NODE$2);setMaxNode$1(MAX_NODE$2);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var USE_HINZE=!0;function nodeFromJSON$1(l,o){if(o===void 0&&(o=null),l===null)return ChildrenNode.EMPTY_NODE;if(typeof l=="object"&&".priority"in l&&(o=l[".priority"]),index_cjsExports$1.assert(o===null||typeof o=="string"||typeof o=="number"||typeof o=="object"&&".sv"in o,"Invalid priority type found: "+typeof o),typeof l=="object"&&".value"in l&&l[".value"]!==null&&(l=l[".value"]),typeof l!="object"||".sv"in l){var s=l;return new LeafNode(s,nodeFromJSON$1(o))}if(!(l instanceof Array)&&USE_HINZE){var c=[],h=!1,d=l;if(each$1(d,function(Lo,Uo){if(Lo.substring(0,1)!=="."){var Qo=nodeFromJSON$1(Uo);Qo.isEmpty()||(h=h||!Qo.getPriority().isEmpty(),c.push(new NamedNode(Lo,Qo)))}}),c.length===0)return ChildrenNode.EMPTY_NODE;var p=buildChildSet(c,NAME_ONLY_COMPARATOR,function(Lo){return Lo.name},NAME_COMPARATOR);if(h){var Co=buildChildSet(c,PRIORITY_INDEX.getCompare());return new ChildrenNode(p,nodeFromJSON$1(o),new IndexMap({".priority":Co},{".priority":PRIORITY_INDEX}))}else return new ChildrenNode(p,nodeFromJSON$1(o),IndexMap.Default)}else{var Bo=ChildrenNode.EMPTY_NODE;return each$1(l,function(Lo,Uo){if(index_cjsExports$1.contains(l,Lo)&&Lo.substring(0,1)!=="."){var Qo=nodeFromJSON$1(Uo);(Qo.isLeafNode()||!Qo.isEmpty())&&(Bo=Bo.updateImmediateChild(Lo,Qo))}}),Bo.updatePriority(nodeFromJSON$1(o))}}setNodeFromJSON(nodeFromJSON$1);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ValueIndex=function(l){__extends$1(o,l);function o(){return l!==null&&l.apply(this,arguments)||this}return o.prototype.compare=function(s,c){var h=s.node.compareTo(c.node);return h===0?nameCompare(s.name,c.name):h},o.prototype.isDefinedOn=function(s){return!0},o.prototype.indexedValueChanged=function(s,c){return!s.equals(c)},o.prototype.minPost=function(){return NamedNode.MIN},o.prototype.maxPost=function(){return NamedNode.MAX},o.prototype.makePost=function(s,c){var h=nodeFromJSON$1(s);return new NamedNode(c,h)},o.prototype.toString=function(){return".value"},o}(Index),VALUE_INDEX=new ValueIndex;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var PathIndex=function(l){__extends$1(o,l);function o(s){var c=l.call(this)||this;return c.indexPath_=s,index_cjsExports$1.assert(!s.isEmpty()&&s.getFront()!==".priority","Can't create PathIndex with empty path or .priority key"),c}return o.prototype.extractChild=function(s){return s.getChild(this.indexPath_)},o.prototype.isDefinedOn=function(s){return!s.getChild(this.indexPath_).isEmpty()},o.prototype.compare=function(s,c){var h=this.extractChild(s.node),d=this.extractChild(c.node),p=h.compareTo(d);return p===0?nameCompare(s.name,c.name):p},o.prototype.makePost=function(s,c){var h=nodeFromJSON$1(s),d=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,h);return new NamedNode(c,d)},o.prototype.maxPost=function(){var s=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE$2);return new NamedNode(MAX_NAME,s)},o.prototype.toString=function(){return this.indexPath_.slice().join("/")},o}(Index);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var DataSnapshot=function(){function l(o,s,c){this.node_=o,this.ref_=s,this.index_=c}return l.prototype.val=function(){return index_cjsExports$1.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},l.prototype.exportVal=function(){return index_cjsExports$1.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},l.prototype.toJSON=function(){return index_cjsExports$1.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},l.prototype.exists=function(){return index_cjsExports$1.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},l.prototype.child=function(o){index_cjsExports$1.validateArgCount("DataSnapshot.child",0,1,arguments.length),o=String(o),validatePathString("DataSnapshot.child",1,o,!1);var s=new Path(o),c=this.ref_.child(s);return new l(this.node_.getChild(s),c,PRIORITY_INDEX)},l.prototype.hasChild=function(o){index_cjsExports$1.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),validatePathString("DataSnapshot.hasChild",1,o,!1);var s=new Path(o);return!this.node_.getChild(s).isEmpty()},l.prototype.getPriority=function(){return index_cjsExports$1.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},l.prototype.forEach=function(o){var s=this;if(index_cjsExports$1.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),index_cjsExports$1.validateCallback("DataSnapshot.forEach",1,o,!1),this.node_.isLeafNode())return!1;var c=this.node_;return!!c.forEachChild(this.index_,function(h,d){return o(new l(d,s.ref_.child(h),PRIORITY_INDEX))})},l.prototype.hasChildren=function(){return index_cjsExports$1.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),this.node_.isLeafNode()?!1:!this.node_.isEmpty()},Object.defineProperty(l.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),l.prototype.numChildren=function(){return index_cjsExports$1.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},l.prototype.getRef=function(){return index_cjsExports$1.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(l.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var DataEvent=function(){function l(o,s,c,h){this.eventType=o,this.eventRegistration=s,this.snapshot=c,this.prevName=h}return l.prototype.getPath=function(){var o=this.snapshot.getRef();return this.eventType==="value"?o.path:o.getParent().path},l.prototype.getEventType=function(){return this.eventType},l.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},l.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+index_cjsExports$1.stringify(this.snapshot.exportVal())},l}(),CancelEvent=function(){function l(o,s,c){this.eventRegistration=o,this.error=s,this.path=c}return l.prototype.getPath=function(){return this.path},l.prototype.getEventType=function(){return"cancel"},l.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},l.prototype.toString=function(){return this.path.toString()+":cancel"},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ValueEventRegistration=function(){function l(o,s,c){this.callback_=o,this.cancelCallback_=s,this.context_=c}return l.prototype.respondsTo=function(o){return o==="value"},l.prototype.createEvent=function(o,s){var c=s.getQueryParams().getIndex();return new DataEvent("value",this,new DataSnapshot(o.snapshotNode,s.getRef(),c))},l.prototype.getEventRunner=function(o){var s=this.context_;if(o.getEventType()==="cancel"){index_cjsExports$1.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var c=this.cancelCallback_;return function(){c.call(s,o.error)}}else{var h=this.callback_;return function(){h.call(s,o.snapshot)}}},l.prototype.createCancelEvent=function(o,s){return this.cancelCallback_?new CancelEvent(this,o,s):null},l.prototype.matches=function(o){return o instanceof l?!o.callback_||!this.callback_?!0:o.callback_===this.callback_&&o.context_===this.context_:!1},l.prototype.hasAnyCallback=function(){return this.callback_!==null},l}(),ChildEventRegistration=function(){function l(o,s,c){this.callbacks_=o,this.cancelCallback_=s,this.context_=c}return l.prototype.respondsTo=function(o){var s=o==="children_added"?"child_added":o;return s=s==="children_removed"?"child_removed":s,index_cjsExports$1.contains(this.callbacks_,s)},l.prototype.createCancelEvent=function(o,s){return this.cancelCallback_?new CancelEvent(this,o,s):null},l.prototype.createEvent=function(o,s){index_cjsExports$1.assert(o.childName!=null,"Child events should have a childName.");var c=s.getRef().child(o.childName),h=s.getQueryParams().getIndex();return new DataEvent(o.type,this,new DataSnapshot(o.snapshotNode,c,h),o.prevName)},l.prototype.getEventRunner=function(o){var s=this.context_;if(o.getEventType()==="cancel"){index_cjsExports$1.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var c=this.cancelCallback_;return function(){c.call(s,o.error)}}else{var h=this.callbacks_[o.eventType];return function(){h.call(s,o.snapshot,o.prevName)}}},l.prototype.matches=function(o){var s=this;if(o instanceof l){if(!this.callbacks_||!o.callbacks_)return!0;if(this.context_===o.context_){var c=Object.keys(o.callbacks_),h=Object.keys(this.callbacks_),d=c.length,p=h.length;if(d===p)if(d===1){var Co=c[0],Bo=h[0];return Bo===Co&&(!o.callbacks_[Co]||!this.callbacks_[Bo]||o.callbacks_[Co]===this.callbacks_[Bo])}else return h.every(function(Lo){return o.callbacks_[Lo]===s.callbacks_[Lo]})}}return!1},l.prototype.hasAnyCallback=function(){return this.callbacks_!==null},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __referenceConstructor,Query=function(){function l(o,s,c,h){this.repo=o,this.path=s,this.queryParams_=c,this.orderByCalled_=h}return Object.defineProperty(l,"__referenceConstructor",{get:function(){return index_cjsExports$1.assert(__referenceConstructor,"Reference.ts has not been loaded"),__referenceConstructor},set:function(o){__referenceConstructor=o},enumerable:!0,configurable:!0}),l.validateQueryEndpoints_=function(o){var s=null,c=null;if(o.hasStart()&&(s=o.getIndexStartValue()),o.hasEnd()&&(c=o.getIndexEndValue()),o.getIndex()===KEY_INDEX){var h="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",d="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(o.hasStart()){var p=o.getIndexStartName();if(p!==MIN_NAME)throw new Error(h);if(typeof s!="string")throw new Error(d)}if(o.hasEnd()){var Co=o.getIndexEndName();if(Co!==MAX_NAME)throw new Error(h);if(typeof c!="string")throw new Error(d)}}else if(o.getIndex()===PRIORITY_INDEX){if(s!=null&&!isValidPriority(s)||c!=null&&!isValidPriority(c))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(index_cjsExports$1.assert(o.getIndex()instanceof PathIndex||o.getIndex()===VALUE_INDEX,"unknown index type."),s!=null&&typeof s=="object"||c!=null&&typeof c=="object")throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},l.validateLimit_=function(o){if(o.hasStart()&&o.hasEnd()&&o.hasLimit()&&!o.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},l.prototype.validateNoPreviousOrderByCall_=function(o){if(this.orderByCalled_===!0)throw new Error(o+": You can't combine multiple orderBy calls.")},l.prototype.getQueryParams=function(){return this.queryParams_},l.prototype.getRef=function(){return index_cjsExports$1.validateArgCount("Query.ref",0,0,arguments.length),new l.__referenceConstructor(this.repo,this.path)},l.prototype.on=function(o,s,c,h){index_cjsExports$1.validateArgCount("Query.on",2,4,arguments.length),validateEventType("Query.on",1,o,!1),index_cjsExports$1.validateCallback("Query.on",2,s,!1);var d=l.getCancelAndContextArgs_("Query.on",c,h);if(o==="value")this.onValueEvent(s,d.cancel,d.context);else{var p={};p[o]=s,this.onChildEvent(p,d.cancel,d.context)}return s},l.prototype.onValueEvent=function(o,s,c){var h=new ValueEventRegistration(o,s||null,c||null);this.repo.addEventCallbackForQuery(this,h)},l.prototype.onChildEvent=function(o,s,c){var h=new ChildEventRegistration(o,s,c);this.repo.addEventCallbackForQuery(this,h)},l.prototype.off=function(o,s,c){index_cjsExports$1.validateArgCount("Query.off",0,3,arguments.length),validateEventType("Query.off",1,o,!0),index_cjsExports$1.validateCallback("Query.off",2,s,!0),index_cjsExports$1.validateContextObject("Query.off",3,c,!0);var h=null,d=null;if(o==="value"){var p=s||null;h=new ValueEventRegistration(p,null,c||null)}else o&&(s&&(d={},d[o]=s),h=new ChildEventRegistration(d,null,c||null));this.repo.removeEventCallbackForQuery(this,h)},l.prototype.once=function(o,s,c,h){var d=this;index_cjsExports$1.validateArgCount("Query.once",1,4,arguments.length),validateEventType("Query.once",1,o,!1),index_cjsExports$1.validateCallback("Query.once",2,s,!0);var p=l.getCancelAndContextArgs_("Query.once",c,h),Co=!0,Bo=new index_cjsExports$1.Deferred;Bo.promise.catch(function(){});var Lo=function(Uo){Co&&(Co=!1,d.off(o,Lo),s&&s.bind(p.context)(Uo),Bo.resolve(Uo))};return this.on(o,Lo,function(Uo){d.off(o,Lo),p.cancel&&p.cancel.bind(p.context)(Uo),Bo.reject(Uo)}),Bo.promise},l.prototype.limitToFirst=function(o){if(index_cjsExports$1.validateArgCount("Query.limitToFirst",1,1,arguments.length),typeof o!="number"||Math.floor(o)!==o||o<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new l(this.repo,this.path,this.queryParams_.limitToFirst(o),this.orderByCalled_)},l.prototype.limitToLast=function(o){if(index_cjsExports$1.validateArgCount("Query.limitToLast",1,1,arguments.length),typeof o!="number"||Math.floor(o)!==o||o<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new l(this.repo,this.path,this.queryParams_.limitToLast(o),this.orderByCalled_)},l.prototype.orderByChild=function(o){if(index_cjsExports$1.validateArgCount("Query.orderByChild",1,1,arguments.length),o==="$key")throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if(o==="$priority")throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if(o==="$value")throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');validatePathString("Query.orderByChild",1,o,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var s=new Path(o);if(s.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var c=new PathIndex(s),h=this.queryParams_.orderBy(c);return l.validateQueryEndpoints_(h),new l(this.repo,this.path,h,!0)},l.prototype.orderByKey=function(){index_cjsExports$1.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var o=this.queryParams_.orderBy(KEY_INDEX);return l.validateQueryEndpoints_(o),new l(this.repo,this.path,o,!0)},l.prototype.orderByPriority=function(){index_cjsExports$1.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var o=this.queryParams_.orderBy(PRIORITY_INDEX);return l.validateQueryEndpoints_(o),new l(this.repo,this.path,o,!0)},l.prototype.orderByValue=function(){index_cjsExports$1.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var o=this.queryParams_.orderBy(VALUE_INDEX);return l.validateQueryEndpoints_(o),new l(this.repo,this.path,o,!0)},l.prototype.startAt=function(o,s){o===void 0&&(o=null),index_cjsExports$1.validateArgCount("Query.startAt",0,2,arguments.length),validateFirebaseDataArg("Query.startAt",1,o,this.path,!0),validateKey("Query.startAt",2,s,!0);var c=this.queryParams_.startAt(o,s);if(l.validateLimit_(c),l.validateQueryEndpoints_(c),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return o===void 0&&(o=null,s=null),new l(this.repo,this.path,c,this.orderByCalled_)},l.prototype.endAt=function(o,s){o===void 0&&(o=null),index_cjsExports$1.validateArgCount("Query.endAt",0,2,arguments.length),validateFirebaseDataArg("Query.endAt",1,o,this.path,!0),validateKey("Query.endAt",2,s,!0);var c=this.queryParams_.endAt(o,s);if(l.validateLimit_(c),l.validateQueryEndpoints_(c),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new l(this.repo,this.path,c,this.orderByCalled_)},l.prototype.equalTo=function(o,s){if(index_cjsExports$1.validateArgCount("Query.equalTo",1,2,arguments.length),validateFirebaseDataArg("Query.equalTo",1,o,this.path,!1),validateKey("Query.equalTo",2,s,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(o,s).endAt(o,s)},l.prototype.toString=function(){return index_cjsExports$1.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},l.prototype.toJSON=function(){return index_cjsExports$1.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},l.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},l.prototype.queryIdentifier=function(){var o=this.queryObject(),s=ObjectToUniqueKey(o);return s==="{}"?"default":s},l.prototype.isEqual=function(o){if(index_cjsExports$1.validateArgCount("Query.isEqual",1,1,arguments.length),!(o instanceof l)){var s="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(s)}var c=this.repo===o.repo,h=this.path.equals(o.path),d=this.queryIdentifier()===o.queryIdentifier();return c&&h&&d},l.getCancelAndContextArgs_=function(o,s,c){var h={cancel:null,context:null};if(s&&c)h.cancel=s,index_cjsExports$1.validateCallback(o,3,h.cancel,!0),h.context=c,index_cjsExports$1.validateContextObject(o,4,h.context,!0);else if(s)if(typeof s=="object"&&s!==null)h.context=s;else if(typeof s=="function")h.cancel=s;else throw new Error(index_cjsExports$1.errorPrefix(o,3,!0)+" must either be a cancel callback or a context object.");return h},Object.defineProperty(l.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ExistingValueProvider=function(){function l(o){this.node_=o}return l.prototype.getImmediateChild=function(o){var s=this.node_.getImmediateChild(o);return new l(s)},l.prototype.node=function(){return this.node_},l}(),DeferredValueProvider=function(){function l(o,s){this.syncTree_=o,this.path_=s}return l.prototype.getImmediateChild=function(o){var s=this.path_.child(o);return new l(this.syncTree_,s)},l.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},l}(),generateWithValues=function(l){return l=l||{},l.timestamp=l.timestamp||new Date().getTime(),l},resolveDeferredLeafValue=function(l,o,s){if(!l||typeof l!="object")return l;if(index_cjsExports$1.assert(".sv"in l,"Unexpected leaf node or priority contents"),typeof l[".sv"]=="string")return resolveScalarDeferredValue(l[".sv"],o,s);if(typeof l[".sv"]=="object")return resolveComplexDeferredValue(l[".sv"],o);index_cjsExports$1.assert(!1,"Unexpected server value: "+JSON.stringify(l,null,2))},resolveScalarDeferredValue=function(l,o,s){switch(l){case"timestamp":return s.timestamp;default:index_cjsExports$1.assert(!1,"Unexpected server value: "+l)}},resolveComplexDeferredValue=function(l,o,s){l.hasOwnProperty("increment")||index_cjsExports$1.assert(!1,"Unexpected server value: "+JSON.stringify(l,null,2));var c=l.increment;typeof c!="number"&&index_cjsExports$1.assert(!1,"Unexpected increment value: "+c);var h=o.node();if(index_cjsExports$1.assert(h!==null&&typeof h<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!h.isLeafNode())return c;var d=h,p=d.getValue();return typeof p!="number"?c:p+c},resolveDeferredValueTree=function(l,o,s,c){return resolveDeferredValue(o,new DeferredValueProvider(s,l),c)},resolveDeferredValueSnapshot=function(l,o,s){return resolveDeferredValue(l,new ExistingValueProvider(o),s)};function resolveDeferredValue(l,o,s){var c=l.getPriority().val(),h=resolveDeferredLeafValue(c,o.getImmediateChild(".priority"),s),d;if(l.isLeafNode()){var p=l,Co=resolveDeferredLeafValue(p.getValue(),o,s);return Co!==p.getValue()||h!==p.getPriority().val()?new LeafNode(Co,nodeFromJSON$1(h)):l}else{var Bo=l;return d=Bo,h!==Bo.getPriority().val()&&(d=d.updatePriority(new LeafNode(h))),Bo.forEachChild(PRIORITY_INDEX,function(Lo,Uo){var Qo=resolveDeferredValue(Uo,o.getImmediateChild(Lo),s);Qo!==Uo&&(d=d.updateImmediateChild(Lo,Qo))}),d}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var SparseSnapshotTree=function(){function l(){this.value=null,this.children=new Map}return l.prototype.find=function(o){if(this.value!=null)return this.value.getChild(o);if(!o.isEmpty()&&this.children.size>0){var s=o.getFront();if(o=o.popFront(),this.children.has(s)){var c=this.children.get(s);return c.find(o)}else return null}else return null},l.prototype.remember=function(o,s){if(o.isEmpty())this.value=s,this.children.clear();else if(this.value!==null)this.value=this.value.updateChild(o,s);else{var c=o.getFront();this.children.has(c)||this.children.set(c,new l);var h=this.children.get(c);o=o.popFront(),h.remember(o,s)}},l.prototype.forget=function(o){if(o.isEmpty())return this.value=null,this.children.clear(),!0;if(this.value!==null){if(this.value.isLeafNode())return!1;var s=this.value;this.value=null;var c=this;return s.forEachChild(PRIORITY_INDEX,function(p,Co){c.remember(new Path(p),Co)}),this.forget(o)}else if(this.children.size>0){var h=o.getFront();if(o=o.popFront(),this.children.has(h)){var d=this.children.get(h).forget(o);d&&this.children.delete(h)}return this.children.size===0}else return!0},l.prototype.forEachTree=function(o,s){this.value!==null?s(o,this.value):this.forEachChild(function(c,h){var d=new Path(o.toString()+"/"+c);h.forEachTree(d,s)})},l.prototype.forEachChild=function(o){this.children.forEach(function(s,c){o(c,s)})},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OperationType;(function(l){l[l.OVERWRITE=0]="OVERWRITE",l[l.MERGE=1]="MERGE",l[l.ACK_USER_WRITE=2]="ACK_USER_WRITE",l[l.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(OperationType||(OperationType={}));var OperationSource=function(){function l(o,s,c,h){this.fromUser=o,this.fromServer=s,this.queryId=c,this.tagged=h,index_cjsExports$1.assert(!h||s,"Tagged queries must be from server.")}return l.User=new l(!0,!1,null,!1),l.Server=new l(!1,!0,null,!1),l.forServerTaggedQuery=function(o){return new l(!1,!0,o,!0)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var AckUserWrite=function(){function l(o,s,c){this.path=o,this.affectedTree=s,this.revert=c,this.type=OperationType.ACK_USER_WRITE,this.source=OperationSource.User}return l.prototype.operationForChild=function(o){if(this.path.isEmpty()){if(this.affectedTree.value!=null)return index_cjsExports$1.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var s=this.affectedTree.subtree(new Path(o));return new l(Path.Empty,s,this.revert)}else return index_cjsExports$1.assert(this.path.getFront()===o,"operationForChild called for unrelated child."),new l(this.path.popFront(),this.affectedTree,this.revert)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var emptyChildrenSingleton,EmptyChildren=function(){return emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton},ImmutableTree=function(){function l(o,s){s===void 0&&(s=EmptyChildren()),this.value=o,this.children=s}return l.fromObject=function(o){var s=l.Empty;return each$1(o,function(c,h){s=s.set(new Path(c),h)}),s},l.prototype.isEmpty=function(){return this.value===null&&this.children.isEmpty()},l.prototype.findRootMostMatchingPathAndValue=function(o,s){if(this.value!=null&&s(this.value))return{path:Path.Empty,value:this.value};if(o.isEmpty())return null;var c=o.getFront(),h=this.children.get(c);if(h!==null){var d=h.findRootMostMatchingPathAndValue(o.popFront(),s);if(d!=null){var p=new Path(c).child(d.path);return{path:p,value:d.value}}else return null}else return null},l.prototype.findRootMostValueAndPath=function(o){return this.findRootMostMatchingPathAndValue(o,function(){return!0})},l.prototype.subtree=function(o){if(o.isEmpty())return this;var s=o.getFront(),c=this.children.get(s);return c!==null?c.subtree(o.popFront()):l.Empty},l.prototype.set=function(o,s){if(o.isEmpty())return new l(s,this.children);var c=o.getFront(),h=this.children.get(c)||l.Empty,d=h.set(o.popFront(),s),p=this.children.insert(c,d);return new l(this.value,p)},l.prototype.remove=function(o){if(o.isEmpty())return this.children.isEmpty()?l.Empty:new l(null,this.children);var s=o.getFront(),c=this.children.get(s);if(c){var h=c.remove(o.popFront()),d=void 0;return h.isEmpty()?d=this.children.remove(s):d=this.children.insert(s,h),this.value===null&&d.isEmpty()?l.Empty:new l(this.value,d)}else return this},l.prototype.get=function(o){if(o.isEmpty())return this.value;var s=o.getFront(),c=this.children.get(s);return c?c.get(o.popFront()):null},l.prototype.setTree=function(o,s){if(o.isEmpty())return s;var c=o.getFront(),h=this.children.get(c)||l.Empty,d=h.setTree(o.popFront(),s),p=void 0;return d.isEmpty()?p=this.children.remove(c):p=this.children.insert(c,d),new l(this.value,p)},l.prototype.fold=function(o){return this.fold_(Path.Empty,o)},l.prototype.fold_=function(o,s){var c={};return this.children.inorderTraversal(function(h,d){c[h]=d.fold_(o.child(h),s)}),s(o,this.value,c)},l.prototype.findOnPath=function(o,s){return this.findOnPath_(o,Path.Empty,s)},l.prototype.findOnPath_=function(o,s,c){var h=this.value?c(s,this.value):!1;if(h)return h;if(o.isEmpty())return null;var d=o.getFront(),p=this.children.get(d);return p?p.findOnPath_(o.popFront(),s.child(d),c):null},l.prototype.foreachOnPath=function(o,s){return this.foreachOnPath_(o,Path.Empty,s)},l.prototype.foreachOnPath_=function(o,s,c){if(o.isEmpty())return this;this.value&&c(s,this.value);var h=o.getFront(),d=this.children.get(h);return d?d.foreachOnPath_(o.popFront(),s.child(h),c):l.Empty},l.prototype.foreach=function(o){this.foreach_(Path.Empty,o)},l.prototype.foreach_=function(o,s){this.children.inorderTraversal(function(c,h){h.foreach_(o.child(c),s)}),this.value&&s(o,this.value)},l.prototype.foreachChild=function(o){this.children.inorderTraversal(function(s,c){c.value&&o(s,c.value)})},l.Empty=new l(null),l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ListenComplete=function(){function l(o,s){this.source=o,this.path=s,this.type=OperationType.LISTEN_COMPLETE}return l.prototype.operationForChild=function(o){return this.path.isEmpty()?new l(this.source,Path.Empty):new l(this.source,this.path.popFront())},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Overwrite=function(){function l(o,s,c){this.source=o,this.path=s,this.snap=c,this.type=OperationType.OVERWRITE}return l.prototype.operationForChild=function(o){return this.path.isEmpty()?new l(this.source,Path.Empty,this.snap.getImmediateChild(o)):new l(this.source,this.path.popFront(),this.snap)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Merge=function(){function l(o,s,c){this.source=o,this.path=s,this.children=c,this.type=OperationType.MERGE}return l.prototype.operationForChild=function(o){if(this.path.isEmpty()){var s=this.children.subtree(new Path(o));return s.isEmpty()?null:s.value?new Overwrite(this.source,Path.Empty,s.value):new l(this.source,Path.Empty,s)}else return index_cjsExports$1.assert(this.path.getFront()===o,"Can't get a merge for a child not on the path of the operation"),new l(this.source,this.path.popFront(),this.children)},l.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var CacheNode=function(){function l(o,s,c){this.node_=o,this.fullyInitialized_=s,this.filtered_=c}return l.prototype.isFullyInitialized=function(){return this.fullyInitialized_},l.prototype.isFiltered=function(){return this.filtered_},l.prototype.isCompleteForPath=function(o){if(o.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var s=o.getFront();return this.isCompleteForChild(s)},l.prototype.isCompleteForChild=function(o){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(o)},l.prototype.getNode=function(){return this.node_},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ViewCache=function(){function l(o,s){this.eventCache_=o,this.serverCache_=s}return l.prototype.updateEventSnap=function(o,s,c){return new l(new CacheNode(o,s,c),this.serverCache_)},l.prototype.updateServerSnap=function(o,s,c){return new l(this.eventCache_,new CacheNode(o,s,c))},l.prototype.getEventCache=function(){return this.eventCache_},l.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},l.prototype.getServerCache=function(){return this.serverCache_},l.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},l.Empty=new l(new CacheNode(ChildrenNode.EMPTY_NODE,!1,!1),new CacheNode(ChildrenNode.EMPTY_NODE,!1,!1)),l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Change=function(){function l(o,s,c,h,d){this.type=o,this.snapshotNode=s,this.childName=c,this.oldSnap=h,this.prevName=d}return l.valueChange=function(o){return new l(l.VALUE,o)},l.childAddedChange=function(o,s){return new l(l.CHILD_ADDED,s,o)},l.childRemovedChange=function(o,s){return new l(l.CHILD_REMOVED,s,o)},l.childChangedChange=function(o,s,c){return new l(l.CHILD_CHANGED,s,o,c)},l.childMovedChange=function(o,s){return new l(l.CHILD_MOVED,s,o)},l.CHILD_ADDED="child_added",l.CHILD_REMOVED="child_removed",l.CHILD_CHANGED="child_changed",l.CHILD_MOVED="child_moved",l.VALUE="value",l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var IndexedFilter=function(){function l(o){this.index_=o}return l.prototype.updateChild=function(o,s,c,h,d,p){index_cjsExports$1.assert(o.isIndexed(this.index_),"A node must be indexed if only a child is updated");var Co=o.getImmediateChild(s);return Co.getChild(h).equals(c.getChild(h))&&Co.isEmpty()===c.isEmpty()||(p!=null&&(c.isEmpty()?o.hasChild(s)?p.trackChildChange(Change.childRemovedChange(s,Co)):index_cjsExports$1.assert(o.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):Co.isEmpty()?p.trackChildChange(Change.childAddedChange(s,c)):p.trackChildChange(Change.childChangedChange(s,c,Co))),o.isLeafNode()&&c.isEmpty())?o:o.updateImmediateChild(s,c).withIndex(this.index_)},l.prototype.updateFullNode=function(o,s,c){return c!=null&&(o.isLeafNode()||o.forEachChild(PRIORITY_INDEX,function(h,d){s.hasChild(h)||c.trackChildChange(Change.childRemovedChange(h,d))}),s.isLeafNode()||s.forEachChild(PRIORITY_INDEX,function(h,d){if(o.hasChild(h)){var p=o.getImmediateChild(h);p.equals(d)||c.trackChildChange(Change.childChangedChange(h,d,p))}else c.trackChildChange(Change.childAddedChange(h,d))})),s.withIndex(this.index_)},l.prototype.updatePriority=function(o,s){return o.isEmpty()?ChildrenNode.EMPTY_NODE:o.updatePriority(s)},l.prototype.filtersNodes=function(){return!1},l.prototype.getIndexedFilter=function(){return this},l.prototype.getIndex=function(){return this.index_},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ChildChangeAccumulator=function(){function l(){this.changeMap=new Map}return l.prototype.trackChildChange=function(o){var s=o.type,c=o.childName;index_cjsExports$1.assert(s===Change.CHILD_ADDED||s===Change.CHILD_CHANGED||s===Change.CHILD_REMOVED,"Only child changes supported for tracking"),index_cjsExports$1.assert(c!==".priority","Only non-priority child changes can be tracked.");var h=this.changeMap.get(c);if(h){var d=h.type;if(s===Change.CHILD_ADDED&&d===Change.CHILD_REMOVED)this.changeMap.set(c,Change.childChangedChange(c,o.snapshotNode,h.snapshotNode));else if(s===Change.CHILD_REMOVED&&d===Change.CHILD_ADDED)this.changeMap.delete(c);else if(s===Change.CHILD_REMOVED&&d===Change.CHILD_CHANGED)this.changeMap.set(c,Change.childRemovedChange(c,h.oldSnap));else if(s===Change.CHILD_CHANGED&&d===Change.CHILD_ADDED)this.changeMap.set(c,Change.childAddedChange(c,o.snapshotNode));else if(s===Change.CHILD_CHANGED&&d===Change.CHILD_CHANGED)this.changeMap.set(c,Change.childChangedChange(c,o.snapshotNode,h.oldSnap));else throw index_cjsExports$1.assertionError("Illegal combination of changes: "+o+" occurred after "+h)}else this.changeMap.set(c,o)},l.prototype.getChanges=function(){return Array.from(this.changeMap.values())},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var NoCompleteChildSource_=function(){function l(){}return l.prototype.getCompleteChild=function(o){return null},l.prototype.getChildAfterChild=function(o,s,c){return null},l}(),NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_,WriteTreeCompleteChildSource=function(){function l(o,s,c){c===void 0&&(c=null),this.writes_=o,this.viewCache_=s,this.optCompleteServerCache_=c}return l.prototype.getCompleteChild=function(o){var s=this.viewCache_.getEventCache();if(s.isCompleteForChild(o))return s.getNode().getImmediateChild(o);var c=this.optCompleteServerCache_!=null?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(o,c)},l.prototype.getChildAfterChild=function(o,s,c){var h=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),d=this.writes_.calcIndexedSlice(h,s,1,c,o);return d.length===0?null:d[0]},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ProcessorResult=function(){function l(o,s){this.viewCache=o,this.changes=s}return l}(),ViewProcessor=function(){function l(o){this.filter_=o}return l.prototype.assertIndexed=function(o){index_cjsExports$1.assert(o.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),index_cjsExports$1.assert(o.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},l.prototype.applyOperation=function(o,s,c,h){var d=new ChildChangeAccumulator,p,Co;if(s.type===OperationType.OVERWRITE){var Bo=s;Bo.source.fromUser?p=this.applyUserOverwrite_(o,Bo.path,Bo.snap,c,h,d):(index_cjsExports$1.assert(Bo.source.fromServer,"Unknown source."),Co=Bo.source.tagged||o.getServerCache().isFiltered()&&!Bo.path.isEmpty(),p=this.applyServerOverwrite_(o,Bo.path,Bo.snap,c,h,Co,d))}else if(s.type===OperationType.MERGE){var Lo=s;Lo.source.fromUser?p=this.applyUserMerge_(o,Lo.path,Lo.children,c,h,d):(index_cjsExports$1.assert(Lo.source.fromServer,"Unknown source."),Co=Lo.source.tagged||o.getServerCache().isFiltered(),p=this.applyServerMerge_(o,Lo.path,Lo.children,c,h,Co,d))}else if(s.type===OperationType.ACK_USER_WRITE){var Uo=s;Uo.revert?p=this.revertUserWrite_(o,Uo.path,c,h,d):p=this.ackUserWrite_(o,Uo.path,Uo.affectedTree,c,h,d)}else if(s.type===OperationType.LISTEN_COMPLETE)p=this.listenComplete_(o,s.path,c,d);else throw index_cjsExports$1.assertionError("Unknown operation type: "+s.type);var Qo=d.getChanges();return l.maybeAddValueEvent_(o,p,Qo),new ProcessorResult(p,Qo)},l.maybeAddValueEvent_=function(o,s,c){var h=s.getEventCache();if(h.isFullyInitialized()){var d=h.getNode().isLeafNode()||h.getNode().isEmpty(),p=o.getCompleteEventSnap();(c.length>0||!o.getEventCache().isFullyInitialized()||d&&!h.getNode().equals(p)||!h.getNode().getPriority().equals(p.getPriority()))&&c.push(Change.valueChange(s.getCompleteEventSnap()))}},l.prototype.generateEventCacheAfterServerEvent_=function(o,s,c,h,d){var p=o.getEventCache();if(c.shadowingWrite(s)!=null)return o;var Co=void 0,Bo=void 0;if(s.isEmpty())if(index_cjsExports$1.assert(o.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),o.getServerCache().isFiltered()){var Lo=o.getCompleteServerSnap(),Uo=Lo instanceof ChildrenNode?Lo:ChildrenNode.EMPTY_NODE,Qo=c.calcCompleteEventChildren(Uo);Co=this.filter_.updateFullNode(o.getEventCache().getNode(),Qo,d)}else{var Po=c.calcCompleteEventCache(o.getCompleteServerSnap());Co=this.filter_.updateFullNode(o.getEventCache().getNode(),Po,d)}else{var Mo=s.getFront();if(Mo===".priority"){index_cjsExports$1.assert(s.getLength()===1,"Can't have a priority with additional path components");var Go=p.getNode();Bo=o.getServerCache().getNode();var $o=c.calcEventCacheAfterServerOverwrite(s,Go,Bo);$o!=null?Co=this.filter_.updatePriority(Go,$o):Co=p.getNode()}else{var jo=s.popFront(),zo=void 0;if(p.isCompleteForChild(Mo)){Bo=o.getServerCache().getNode();var Xo=c.calcEventCacheAfterServerOverwrite(s,p.getNode(),Bo);Xo!=null?zo=p.getNode().getImmediateChild(Mo).updateChild(jo,Xo):zo=p.getNode().getImmediateChild(Mo)}else zo=c.calcCompleteChild(Mo,o.getServerCache());zo!=null?Co=this.filter_.updateChild(p.getNode(),Mo,zo,jo,h,d):Co=p.getNode()}}return o.updateEventSnap(Co,p.isFullyInitialized()||s.isEmpty(),this.filter_.filtersNodes())},l.prototype.applyServerOverwrite_=function(o,s,c,h,d,p,Co){var Bo=o.getServerCache(),Lo,Uo=p?this.filter_:this.filter_.getIndexedFilter();if(s.isEmpty())Lo=Uo.updateFullNode(Bo.getNode(),c,null);else if(Uo.filtersNodes()&&!Bo.isFiltered()){var Qo=Bo.getNode().updateChild(s,c);Lo=Uo.updateFullNode(Bo.getNode(),Qo,null)}else{var Po=s.getFront();if(!Bo.isCompleteForPath(s)&&s.getLength()>1)return o;var Mo=s.popFront(),Go=Bo.getNode().getImmediateChild(Po),$o=Go.updateChild(Mo,c);Po===".priority"?Lo=Uo.updatePriority(Bo.getNode(),$o):Lo=Uo.updateChild(Bo.getNode(),Po,$o,Mo,NO_COMPLETE_CHILD_SOURCE,null)}var jo=o.updateServerSnap(Lo,Bo.isFullyInitialized()||s.isEmpty(),Uo.filtersNodes()),zo=new WriteTreeCompleteChildSource(h,jo,d);return this.generateEventCacheAfterServerEvent_(jo,s,h,zo,Co)},l.prototype.applyUserOverwrite_=function(o,s,c,h,d,p){var Co=o.getEventCache(),Bo,Lo,Uo=new WriteTreeCompleteChildSource(h,o,d);if(s.isEmpty())Lo=this.filter_.updateFullNode(o.getEventCache().getNode(),c,p),Bo=o.updateEventSnap(Lo,!0,this.filter_.filtersNodes());else{var Qo=s.getFront();if(Qo===".priority")Lo=this.filter_.updatePriority(o.getEventCache().getNode(),c),Bo=o.updateEventSnap(Lo,Co.isFullyInitialized(),Co.isFiltered());else{var Po=s.popFront(),Mo=Co.getNode().getImmediateChild(Qo),Go=void 0;if(Po.isEmpty())Go=c;else{var $o=Uo.getCompleteChild(Qo);$o!=null?Po.getBack()===".priority"&&$o.getChild(Po.parent()).isEmpty()?Go=$o:Go=$o.updateChild(Po,c):Go=ChildrenNode.EMPTY_NODE}if(Mo.equals(Go))Bo=o;else{var jo=this.filter_.updateChild(Co.getNode(),Qo,Go,Po,Uo,p);Bo=o.updateEventSnap(jo,Co.isFullyInitialized(),this.filter_.filtersNodes())}}}return Bo},l.cacheHasChild_=function(o,s){return o.getEventCache().isCompleteForChild(s)},l.prototype.applyUserMerge_=function(o,s,c,h,d,p){var Co=this,Bo=o;return c.foreach(function(Lo,Uo){var Qo=s.child(Lo);l.cacheHasChild_(o,Qo.getFront())&&(Bo=Co.applyUserOverwrite_(Bo,Qo,Uo,h,d,p))}),c.foreach(function(Lo,Uo){var Qo=s.child(Lo);l.cacheHasChild_(o,Qo.getFront())||(Bo=Co.applyUserOverwrite_(Bo,Qo,Uo,h,d,p))}),Bo},l.prototype.applyMerge_=function(o,s){return s.foreach(function(c,h){o=o.updateChild(c,h)}),o},l.prototype.applyServerMerge_=function(o,s,c,h,d,p,Co){var Bo=this;if(o.getServerCache().getNode().isEmpty()&&!o.getServerCache().isFullyInitialized())return o;var Lo=o,Uo;s.isEmpty()?Uo=c:Uo=ImmutableTree.Empty.setTree(s,c);var Qo=o.getServerCache().getNode();return Uo.children.inorderTraversal(function(Po,Mo){if(Qo.hasChild(Po)){var Go=o.getServerCache().getNode().getImmediateChild(Po),$o=Bo.applyMerge_(Go,Mo);Lo=Bo.applyServerOverwrite_(Lo,new Path(Po),$o,h,d,p,Co)}}),Uo.children.inorderTraversal(function(Po,Mo){var Go=!o.getServerCache().isCompleteForChild(Po)&&Mo.value==null;if(!Qo.hasChild(Po)&&!Go){var $o=o.getServerCache().getNode().getImmediateChild(Po),jo=Bo.applyMerge_($o,Mo);Lo=Bo.applyServerOverwrite_(Lo,new Path(Po),jo,h,d,p,Co)}}),Lo},l.prototype.ackUserWrite_=function(o,s,c,h,d,p){if(h.shadowingWrite(s)!=null)return o;var Co=o.getServerCache().isFiltered(),Bo=o.getServerCache();if(c.value!=null){if(s.isEmpty()&&Bo.isFullyInitialized()||Bo.isCompleteForPath(s))return this.applyServerOverwrite_(o,s,Bo.getNode().getChild(s),h,d,Co,p);if(s.isEmpty()){var Lo=ImmutableTree.Empty;return Bo.getNode().forEachChild(KEY_INDEX,function(Qo,Po){Lo=Lo.set(new Path(Qo),Po)}),this.applyServerMerge_(o,s,Lo,h,d,Co,p)}else return o}else{var Uo=ImmutableTree.Empty;return c.foreach(function(Qo,Po){var Mo=s.child(Qo);Bo.isCompleteForPath(Mo)&&(Uo=Uo.set(Qo,Bo.getNode().getChild(Mo)))}),this.applyServerMerge_(o,s,Uo,h,d,Co,p)}},l.prototype.listenComplete_=function(o,s,c,h){var d=o.getServerCache(),p=o.updateServerSnap(d.getNode(),d.isFullyInitialized()||s.isEmpty(),d.isFiltered());return this.generateEventCacheAfterServerEvent_(p,s,c,NO_COMPLETE_CHILD_SOURCE,h)},l.prototype.revertUserWrite_=function(o,s,c,h,d){var p;if(c.shadowingWrite(s)!=null)return o;var Co=new WriteTreeCompleteChildSource(c,o,h),Bo=o.getEventCache().getNode(),Lo=void 0;if(s.isEmpty()||s.getFront()===".priority"){var Uo=void 0;if(o.getServerCache().isFullyInitialized())Uo=c.calcCompleteEventCache(o.getCompleteServerSnap());else{var Qo=o.getServerCache().getNode();index_cjsExports$1.assert(Qo instanceof ChildrenNode,"serverChildren would be complete if leaf node"),Uo=c.calcCompleteEventChildren(Qo)}Uo=Uo,Lo=this.filter_.updateFullNode(Bo,Uo,d)}else{var Po=s.getFront(),Mo=c.calcCompleteChild(Po,o.getServerCache());Mo==null&&o.getServerCache().isCompleteForChild(Po)&&(Mo=Bo.getImmediateChild(Po)),Mo!=null?Lo=this.filter_.updateChild(Bo,Po,Mo,s.popFront(),Co,d):o.getEventCache().getNode().hasChild(Po)?Lo=this.filter_.updateChild(Bo,Po,ChildrenNode.EMPTY_NODE,s.popFront(),Co,d):Lo=Bo,Lo.isEmpty()&&o.getServerCache().isFullyInitialized()&&(p=c.calcCompleteEventCache(o.getCompleteServerSnap()),p.isLeafNode()&&(Lo=this.filter_.updateFullNode(Lo,p,d)))}return p=o.getServerCache().isFullyInitialized()||c.shadowingWrite(Path.Empty)!=null,o.updateEventSnap(Lo,p,this.filter_.filtersNodes())},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var EventGenerator=function(){function l(o){this.query_=o,this.index_=this.query_.getQueryParams().getIndex()}return l.prototype.generateEventsForChanges=function(o,s,c){var h=this,d=[],p=[];return o.forEach(function(Co){Co.type===Change.CHILD_CHANGED&&h.index_.indexedValueChanged(Co.oldSnap,Co.snapshotNode)&&p.push(Change.childMovedChange(Co.childName,Co.snapshotNode))}),this.generateEventsForType_(d,Change.CHILD_REMOVED,o,c,s),this.generateEventsForType_(d,Change.CHILD_ADDED,o,c,s),this.generateEventsForType_(d,Change.CHILD_MOVED,p,c,s),this.generateEventsForType_(d,Change.CHILD_CHANGED,o,c,s),this.generateEventsForType_(d,Change.VALUE,o,c,s),d},l.prototype.generateEventsForType_=function(o,s,c,h,d){var p=this,Co=c.filter(function(Bo){return Bo.type===s});Co.sort(this.compareChanges_.bind(this)),Co.forEach(function(Bo){var Lo=p.materializeSingleChange_(Bo,d);h.forEach(function(Uo){Uo.respondsTo(Bo.type)&&o.push(Uo.createEvent(Lo,p.query_))})})},l.prototype.materializeSingleChange_=function(o,s){return o.type==="value"||o.type==="child_removed"||(o.prevName=s.getPredecessorChildName(o.childName,o.snapshotNode,this.index_)),o},l.prototype.compareChanges_=function(o,s){if(o.childName==null||s.childName==null)throw index_cjsExports$1.assertionError("Should only compare child_ events.");var c=new NamedNode(o.childName,o.snapshotNode),h=new NamedNode(s.childName,s.snapshotNode);return this.index_.compare(c,h)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var View=function(){function l(o,s){this.query_=o,this.eventRegistrations_=[];var c=this.query_.getQueryParams(),h=new IndexedFilter(c.getIndex()),d=c.getNodeFilter();this.processor_=new ViewProcessor(d);var p=s.getServerCache(),Co=s.getEventCache(),Bo=h.updateFullNode(ChildrenNode.EMPTY_NODE,p.getNode(),null),Lo=d.updateFullNode(ChildrenNode.EMPTY_NODE,Co.getNode(),null),Uo=new CacheNode(Bo,p.isFullyInitialized(),h.filtersNodes()),Qo=new CacheNode(Lo,Co.isFullyInitialized(),d.filtersNodes());this.viewCache_=new ViewCache(Qo,Uo),this.eventGenerator_=new EventGenerator(this.query_)}return l.prototype.getQuery=function(){return this.query_},l.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},l.prototype.getCompleteServerCache=function(o){var s=this.viewCache_.getCompleteServerSnap();return s&&(this.query_.getQueryParams().loadsAllData()||!o.isEmpty()&&!s.getImmediateChild(o.getFront()).isEmpty())?s.getChild(o):null},l.prototype.isEmpty=function(){return this.eventRegistrations_.length===0},l.prototype.addEventRegistration=function(o){this.eventRegistrations_.push(o)},l.prototype.removeEventRegistration=function(o,s){var c=[];if(s){index_cjsExports$1.assert(o==null,"A cancel should cancel all event registrations.");var h=this.query_.path;this.eventRegistrations_.forEach(function(Bo){s=s;var Lo=Bo.createCancelEvent(s,h);Lo&&c.push(Lo)})}if(o){for(var d=[],p=0;p<this.eventRegistrations_.length;++p){var Co=this.eventRegistrations_[p];if(!Co.matches(o))d.push(Co);else if(o.hasAnyCallback()){d=d.concat(this.eventRegistrations_.slice(p+1));break}}this.eventRegistrations_=d}else this.eventRegistrations_=[];return c},l.prototype.applyOperation=function(o,s,c){o.type===OperationType.MERGE&&o.source.queryId!==null&&(index_cjsExports$1.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),index_cjsExports$1.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var h=this.viewCache_,d=this.processor_.applyOperation(h,o,s,c);return this.processor_.assertIndexed(d.viewCache),index_cjsExports$1.assert(d.viewCache.getServerCache().isFullyInitialized()||!h.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=d.viewCache,this.generateEventsForChanges_(d.changes,d.viewCache.getEventCache().getNode(),null)},l.prototype.getInitialEvents=function(o){var s=this.viewCache_.getEventCache(),c=[];if(!s.getNode().isLeafNode()){var h=s.getNode();h.forEachChild(PRIORITY_INDEX,function(d,p){c.push(Change.childAddedChange(d,p))})}return s.isFullyInitialized()&&c.push(Change.valueChange(s.getNode())),this.generateEventsForChanges_(c,s.getNode(),o)},l.prototype.generateEventsForChanges_=function(o,s,c){var h=c?[c]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(o,s,h)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var __referenceConstructor$1,SyncPoint=function(){function l(){this.views=new Map}return Object.defineProperty(l,"__referenceConstructor",{get:function(){return index_cjsExports$1.assert(__referenceConstructor$1,"Reference.ts has not been loaded"),__referenceConstructor$1},set:function(o){index_cjsExports$1.assert(!__referenceConstructor$1,"__referenceConstructor has already been defined"),__referenceConstructor$1=o},enumerable:!0,configurable:!0}),l.prototype.isEmpty=function(){return this.views.size===0},l.prototype.applyOperation=function(o,s,c){var h,d,p=o.source.queryId;if(p!==null){var Co=this.views.get(p);return index_cjsExports$1.assert(Co!=null,"SyncTree gave us an op for an invalid query."),Co.applyOperation(o,s,c)}else{var Bo=[];try{for(var Lo=__values$1(this.views.values()),Uo=Lo.next();!Uo.done;Uo=Lo.next()){var Co=Uo.value;Bo=Bo.concat(Co.applyOperation(o,s,c))}}catch(Qo){h={error:Qo}}finally{try{Uo&&!Uo.done&&(d=Lo.return)&&d.call(Lo)}finally{if(h)throw h.error}}return Bo}},l.prototype.addEventRegistration=function(o,s,c,h,d){var p=o.queryIdentifier(),Co=this.views.get(p);if(!Co){var Bo=c.calcCompleteEventCache(d?h:null),Lo=!1;Bo?Lo=!0:h instanceof ChildrenNode?(Bo=c.calcCompleteEventChildren(h),Lo=!1):(Bo=ChildrenNode.EMPTY_NODE,Lo=!1);var Uo=new ViewCache(new CacheNode(Bo,Lo,!1),new CacheNode(h,d,!1));Co=new View(o,Uo),this.views.set(p,Co)}return Co.addEventRegistration(s),Co.getInitialEvents(s)},l.prototype.removeEventRegistration=function(o,s,c){var h,d,p=o.queryIdentifier(),Co=[],Bo=[],Lo=this.hasCompleteView();if(p==="default")try{for(var Uo=__values$1(this.views.entries()),Qo=Uo.next();!Qo.done;Qo=Uo.next()){var Po=__read(Qo.value,2),Mo=Po[0],Go=Po[1];Bo=Bo.concat(Go.removeEventRegistration(s,c)),Go.isEmpty()&&(this.views.delete(Mo),Go.getQuery().getQueryParams().loadsAllData()||Co.push(Go.getQuery()))}}catch($o){h={error:$o}}finally{try{Qo&&!Qo.done&&(d=Uo.return)&&d.call(Uo)}finally{if(h)throw h.error}}else{var Go=this.views.get(p);Go&&(Bo=Bo.concat(Go.removeEventRegistration(s,c)),Go.isEmpty()&&(this.views.delete(p),Go.getQuery().getQueryParams().loadsAllData()||Co.push(Go.getQuery())))}return Lo&&!this.hasCompleteView()&&Co.push(new l.__referenceConstructor(o.repo,o.path)),{removed:Co,events:Bo}},l.prototype.getQueryViews=function(){var o,s,c=[];try{for(var h=__values$1(this.views.values()),d=h.next();!d.done;d=h.next()){var p=d.value;p.getQuery().getQueryParams().loadsAllData()||c.push(p)}}catch(Co){o={error:Co}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}return c},l.prototype.getCompleteServerCache=function(o){var s,c,h=null;try{for(var d=__values$1(this.views.values()),p=d.next();!p.done;p=d.next()){var Co=p.value;h=h||Co.getCompleteServerCache(o)}}catch(Bo){s={error:Bo}}finally{try{p&&!p.done&&(c=d.return)&&c.call(d)}finally{if(s)throw s.error}}return h},l.prototype.viewForQuery=function(o){var s=o.getQueryParams();if(s.loadsAllData())return this.getCompleteView();var c=o.queryIdentifier();return this.views.get(c)},l.prototype.viewExistsForQuery=function(o){return this.viewForQuery(o)!=null},l.prototype.hasCompleteView=function(){return this.getCompleteView()!=null},l.prototype.getCompleteView=function(){var o,s;try{for(var c=__values$1(this.views.values()),h=c.next();!h.done;h=c.next()){var d=h.value;if(d.getQuery().getQueryParams().loadsAllData())return d}}catch(p){o={error:p}}finally{try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(o)throw o.error}}return null},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var CompoundWrite=function(){function l(o){this.writeTree_=o}return l.prototype.addWrite=function(o,s){if(o.isEmpty())return new l(new ImmutableTree(s));var c=this.writeTree_.findRootMostValueAndPath(o);if(c!=null){var h=c.path,d=c.value,p=Path.relativePath(h,o);return d=d.updateChild(p,s),new l(this.writeTree_.set(h,d))}else{var Co=new ImmutableTree(s),Bo=this.writeTree_.setTree(o,Co);return new l(Bo)}},l.prototype.addWrites=function(o,s){var c=this;return each$1(s,function(h,d){c=c.addWrite(o.child(h),d)}),c},l.prototype.removeWrite=function(o){if(o.isEmpty())return l.Empty;var s=this.writeTree_.setTree(o,ImmutableTree.Empty);return new l(s)},l.prototype.hasCompleteWrite=function(o){return this.getCompleteNode(o)!=null},l.prototype.getCompleteNode=function(o){var s=this.writeTree_.findRootMostValueAndPath(o);return s!=null?this.writeTree_.get(s.path).getChild(Path.relativePath(s.path,o)):null},l.prototype.getCompleteChildren=function(){var o=[],s=this.writeTree_.value;return s!=null?s.isLeafNode()||s.forEachChild(PRIORITY_INDEX,function(c,h){o.push(new NamedNode(c,h))}):this.writeTree_.children.inorderTraversal(function(c,h){h.value!=null&&o.push(new NamedNode(c,h.value))}),o},l.prototype.childCompoundWrite=function(o){if(o.isEmpty())return this;var s=this.getCompleteNode(o);return s!=null?new l(new ImmutableTree(s)):new l(this.writeTree_.subtree(o))},l.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},l.prototype.apply=function(o){return applySubtreeWrite(Path.Empty,this.writeTree_,o)},l.Empty=new l(new ImmutableTree(null)),l}();function applySubtreeWrite(l,o,s){if(o.value!=null)return s.updateChild(l,o.value);var c=null;return o.children.inorderTraversal(function(h,d){h===".priority"?(index_cjsExports$1.assert(d.value!==null,"Priority writes must always be leaf nodes"),c=d.value):s=applySubtreeWrite(l.child(h),d,s)}),!s.getChild(l).isEmpty()&&c!==null&&(s=s.updateChild(l.child(".priority"),c)),s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var WriteTree=function(){function l(){this.visibleWrites_=CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return l.prototype.childWrites=function(o){return new WriteTreeRef(o,this)},l.prototype.addOverwrite=function(o,s,c,h){index_cjsExports$1.assert(c>this.lastWriteId_,"Stacking an older write on top of newer ones"),h===void 0&&(h=!0),this.allWrites_.push({path:o,snap:s,writeId:c,visible:h}),h&&(this.visibleWrites_=this.visibleWrites_.addWrite(o,s)),this.lastWriteId_=c},l.prototype.addMerge=function(o,s,c){index_cjsExports$1.assert(c>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:o,children:s,writeId:c,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(o,s),this.lastWriteId_=c},l.prototype.getWrite=function(o){for(var s=0;s<this.allWrites_.length;s++){var c=this.allWrites_[s];if(c.writeId===o)return c}return null},l.prototype.removeWrite=function(o){var s=this,c=this.allWrites_.findIndex(function(Uo){return Uo.writeId===o});index_cjsExports$1.assert(c>=0,"removeWrite called with nonexistent writeId.");var h=this.allWrites_[c];this.allWrites_.splice(c,1);for(var d=h.visible,p=!1,Co=this.allWrites_.length-1;d&&Co>=0;){var Bo=this.allWrites_[Co];Bo.visible&&(Co>=c&&this.recordContainsPath_(Bo,h.path)?d=!1:h.path.contains(Bo.path)&&(p=!0)),Co--}if(d){if(p)return this.resetTree_(),!0;if(h.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(h.path);else{var Lo=h.children;each$1(Lo,function(Uo){s.visibleWrites_=s.visibleWrites_.removeWrite(h.path.child(Uo))})}return!0}else return!1},l.prototype.getCompleteWriteData=function(o){return this.visibleWrites_.getCompleteNode(o)},l.prototype.calcCompleteEventCache=function(o,s,c,h){if(!c&&!h){var d=this.visibleWrites_.getCompleteNode(o);if(d!=null)return d;var p=this.visibleWrites_.childCompoundWrite(o);if(p.isEmpty())return s;if(s==null&&!p.hasCompleteWrite(Path.Empty))return null;var Co=s||ChildrenNode.EMPTY_NODE;return p.apply(Co)}else{var Bo=this.visibleWrites_.childCompoundWrite(o);if(!h&&Bo.isEmpty())return s;if(!h&&s==null&&!Bo.hasCompleteWrite(Path.Empty))return null;var Lo=function(Po){return(Po.visible||h)&&(!c||!~c.indexOf(Po.writeId))&&(Po.path.contains(o)||o.contains(Po.path))},Uo=l.layerTree_(this.allWrites_,Lo,o),Co=s||ChildrenNode.EMPTY_NODE;return Uo.apply(Co)}},l.prototype.calcCompleteEventChildren=function(o,s){var c=ChildrenNode.EMPTY_NODE,h=this.visibleWrites_.getCompleteNode(o);if(h)return h.isLeafNode()||h.forEachChild(PRIORITY_INDEX,function(Co,Bo){c=c.updateImmediateChild(Co,Bo)}),c;if(s){var d=this.visibleWrites_.childCompoundWrite(o);return s.forEachChild(PRIORITY_INDEX,function(Co,Bo){var Lo=d.childCompoundWrite(new Path(Co)).apply(Bo);c=c.updateImmediateChild(Co,Lo)}),d.getCompleteChildren().forEach(function(Co){c=c.updateImmediateChild(Co.name,Co.node)}),c}else{var p=this.visibleWrites_.childCompoundWrite(o);return p.getCompleteChildren().forEach(function(Co){c=c.updateImmediateChild(Co.name,Co.node)}),c}},l.prototype.calcEventCacheAfterServerOverwrite=function(o,s,c,h){index_cjsExports$1.assert(c||h,"Either existingEventSnap or existingServerSnap must exist");var d=o.child(s);if(this.visibleWrites_.hasCompleteWrite(d))return null;var p=this.visibleWrites_.childCompoundWrite(d);return p.isEmpty()?h.getChild(s):p.apply(h.getChild(s))},l.prototype.calcCompleteChild=function(o,s,c){var h=o.child(s),d=this.visibleWrites_.getCompleteNode(h);if(d!=null)return d;if(c.isCompleteForChild(s)){var p=this.visibleWrites_.childCompoundWrite(h);return p.apply(c.getNode().getImmediateChild(s))}else return null},l.prototype.shadowingWrite=function(o){return this.visibleWrites_.getCompleteNode(o)},l.prototype.calcIndexedSlice=function(o,s,c,h,d,p){var Co,Bo=this.visibleWrites_.childCompoundWrite(o),Lo=Bo.getCompleteNode(Path.Empty);if(Lo!=null)Co=Lo;else if(s!=null)Co=Bo.apply(s);else return[];if(Co=Co.withIndex(p),!Co.isEmpty()&&!Co.isLeafNode()){for(var Uo=[],Qo=p.getCompare(),Po=d?Co.getReverseIteratorFrom(c,p):Co.getIteratorFrom(c,p),Mo=Po.getNext();Mo&&Uo.length<h;)Qo(Mo,c)!==0&&Uo.push(Mo),Mo=Po.getNext();return Uo}else return[]},l.prototype.recordContainsPath_=function(o,s){if(o.snap)return o.path.contains(s);for(var c in o.children)if(o.children.hasOwnProperty(c)&&o.path.child(c).contains(s))return!0;return!1},l.prototype.resetTree_=function(){this.visibleWrites_=l.layerTree_(this.allWrites_,l.DefaultFilter_,Path.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},l.DefaultFilter_=function(o){return o.visible},l.layerTree_=function(o,s,c){for(var h=CompoundWrite.Empty,d=0;d<o.length;++d){var p=o[d];if(s(p)){var Co=p.path,Bo=void 0;if(p.snap)c.contains(Co)?(Bo=Path.relativePath(c,Co),h=h.addWrite(Bo,p.snap)):Co.contains(c)&&(Bo=Path.relativePath(Co,c),h=h.addWrite(Path.Empty,p.snap.getChild(Bo)));else if(p.children){if(c.contains(Co))Bo=Path.relativePath(c,Co),h=h.addWrites(Bo,p.children);else if(Co.contains(c))if(Bo=Path.relativePath(Co,c),Bo.isEmpty())h=h.addWrites(Path.Empty,p.children);else{var Lo=index_cjsExports$1.safeGet(p.children,Bo.getFront());if(Lo){var Uo=Lo.getChild(Bo.popFront());h=h.addWrite(Path.Empty,Uo)}}}else throw index_cjsExports$1.assertionError("WriteRecord should have .snap or .children")}}return h},l}(),WriteTreeRef=function(){function l(o,s){this.treePath_=o,this.writeTree_=s}return l.prototype.calcCompleteEventCache=function(o,s,c){return this.writeTree_.calcCompleteEventCache(this.treePath_,o,s,c)},l.prototype.calcCompleteEventChildren=function(o){return this.writeTree_.calcCompleteEventChildren(this.treePath_,o)},l.prototype.calcEventCacheAfterServerOverwrite=function(o,s,c){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,o,s,c)},l.prototype.shadowingWrite=function(o){return this.writeTree_.shadowingWrite(this.treePath_.child(o))},l.prototype.calcIndexedSlice=function(o,s,c,h,d){return this.writeTree_.calcIndexedSlice(this.treePath_,o,s,c,h,d)},l.prototype.calcCompleteChild=function(o,s){return this.writeTree_.calcCompleteChild(this.treePath_,o,s)},l.prototype.child=function(o){return new l(this.treePath_.child(o),this.writeTree_)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var SyncTree=function(){function l(o){this.listenProvider_=o,this.syncPointTree_=ImmutableTree.Empty,this.pendingWriteTree_=new WriteTree,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return l.prototype.applyUserOverwrite=function(o,s,c,h){return this.pendingWriteTree_.addOverwrite(o,s,c,h),h?this.applyOperationToSyncPoints_(new Overwrite(OperationSource.User,o,s)):[]},l.prototype.applyUserMerge=function(o,s,c){this.pendingWriteTree_.addMerge(o,s,c);var h=ImmutableTree.fromObject(s);return this.applyOperationToSyncPoints_(new Merge(OperationSource.User,o,h))},l.prototype.ackUserWrite=function(o,s){s===void 0&&(s=!1);var c=this.pendingWriteTree_.getWrite(o),h=this.pendingWriteTree_.removeWrite(o);if(h){var d=ImmutableTree.Empty;return c.snap!=null?d=d.set(Path.Empty,!0):each$1(c.children,function(p,Co){d=d.set(new Path(p),Co)}),this.applyOperationToSyncPoints_(new AckUserWrite(c.path,d,s))}else return[]},l.prototype.applyServerOverwrite=function(o,s){return this.applyOperationToSyncPoints_(new Overwrite(OperationSource.Server,o,s))},l.prototype.applyServerMerge=function(o,s){var c=ImmutableTree.fromObject(s);return this.applyOperationToSyncPoints_(new Merge(OperationSource.Server,o,c))},l.prototype.applyListenComplete=function(o){return this.applyOperationToSyncPoints_(new ListenComplete(OperationSource.Server,o))},l.prototype.applyTaggedQueryOverwrite=function(o,s,c){var h=this.queryKeyForTag_(c);if(h!=null){var d=l.parseQueryKey_(h),p=d.path,Co=d.queryId,Bo=Path.relativePath(p,o),Lo=new Overwrite(OperationSource.forServerTaggedQuery(Co),Bo,s);return this.applyTaggedOperation_(p,Lo)}else return[]},l.prototype.applyTaggedQueryMerge=function(o,s,c){var h=this.queryKeyForTag_(c);if(h){var d=l.parseQueryKey_(h),p=d.path,Co=d.queryId,Bo=Path.relativePath(p,o),Lo=ImmutableTree.fromObject(s),Uo=new Merge(OperationSource.forServerTaggedQuery(Co),Bo,Lo);return this.applyTaggedOperation_(p,Uo)}else return[]},l.prototype.applyTaggedListenComplete=function(o,s){var c=this.queryKeyForTag_(s);if(c){var h=l.parseQueryKey_(c),d=h.path,p=h.queryId,Co=Path.relativePath(d,o),Bo=new ListenComplete(OperationSource.forServerTaggedQuery(p),Co);return this.applyTaggedOperation_(d,Bo)}else return[]},l.prototype.addEventRegistration=function(o,s){var c=o.path,h=null,d=!1;this.syncPointTree_.foreachOnPath(c,function($o,jo){var zo=Path.relativePath($o,c);h=h||jo.getCompleteServerCache(zo),d=d||jo.hasCompleteView()});var p=this.syncPointTree_.get(c);p?(d=d||p.hasCompleteView(),h=h||p.getCompleteServerCache(Path.Empty)):(p=new SyncPoint,this.syncPointTree_=this.syncPointTree_.set(c,p));var Co;if(h!=null)Co=!0;else{Co=!1,h=ChildrenNode.EMPTY_NODE;var Bo=this.syncPointTree_.subtree(c);Bo.foreachChild(function($o,jo){var zo=jo.getCompleteServerCache(Path.Empty);zo&&(h=h.updateImmediateChild($o,zo))})}var Lo=p.viewExistsForQuery(o);if(!Lo&&!o.getQueryParams().loadsAllData()){var Uo=l.makeQueryKey_(o);index_cjsExports$1.assert(!this.queryToTagMap.has(Uo),"View does not exist, but we have a tag");var Qo=l.getNextQueryTag_();this.queryToTagMap.set(Uo,Qo),this.tagToQueryMap.set(Qo,Uo)}var Po=this.pendingWriteTree_.childWrites(c),Mo=p.addEventRegistration(o,s,Po,h,Co);if(!Lo&&!d){var Go=p.viewForQuery(o);Mo=Mo.concat(this.setupListener_(o,Go))}return Mo},l.prototype.removeEventRegistration=function(o,s,c){var h=this,d=o.path,p=this.syncPointTree_.get(d),Co=[];if(p&&(o.queryIdentifier()==="default"||p.viewExistsForQuery(o))){var Bo=p.removeEventRegistration(o,s,c);p.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(d));var Lo=Bo.removed;Co=Bo.events;var Uo=Lo.findIndex(function(Zo){return Zo.getQueryParams().loadsAllData()})!==-1,Qo=this.syncPointTree_.findOnPath(d,function(Zo,Wo){return Wo.hasCompleteView()});if(Uo&&!Qo){var Po=this.syncPointTree_.subtree(d);if(!Po.isEmpty())for(var Mo=this.collectDistinctViewsForSubTree_(Po),Go=0;Go<Mo.length;++Go){var $o=Mo[Go],jo=$o.getQuery(),zo=this.createListenerForView_($o);this.listenProvider_.startListening(l.queryForListening_(jo),this.tagForQuery_(jo),zo.hashFn,zo.onComplete)}}if(!Qo&&Lo.length>0&&!c)if(Uo){var Xo=null;this.listenProvider_.stopListening(l.queryForListening_(o),Xo)}else Lo.forEach(function(Zo){var Wo=h.queryToTagMap.get(l.makeQueryKey_(Zo));h.listenProvider_.stopListening(l.queryForListening_(Zo),Wo)});this.removeTags_(Lo)}return Co},l.prototype.calcCompleteEventCache=function(o,s){var c=!0,h=this.pendingWriteTree_,d=this.syncPointTree_.findOnPath(o,function(p,Co){var Bo=Path.relativePath(p,o),Lo=Co.getCompleteServerCache(Bo);if(Lo)return Lo});return h.calcCompleteEventCache(o,d,s,c)},l.prototype.collectDistinctViewsForSubTree_=function(o){return o.fold(function(s,c,h){if(c&&c.hasCompleteView()){var d=c.getCompleteView();return[d]}else{var p=[];return c&&(p=c.getQueryViews()),each$1(h,function(Co,Bo){p=p.concat(Bo)}),p}})},l.prototype.removeTags_=function(o){for(var s=0;s<o.length;++s){var c=o[s];if(!c.getQueryParams().loadsAllData()){var h=l.makeQueryKey_(c),d=this.queryToTagMap.get(h);this.queryToTagMap.delete(h),this.tagToQueryMap.delete(d)}}},l.queryForListening_=function(o){return o.getQueryParams().loadsAllData()&&!o.getQueryParams().isDefault()?o.getRef():o},l.prototype.setupListener_=function(o,s){var c=o.path,h=this.tagForQuery_(o),d=this.createListenerForView_(s),p=this.listenProvider_.startListening(l.queryForListening_(o),h,d.hashFn,d.onComplete),Co=this.syncPointTree_.subtree(c);if(h)index_cjsExports$1.assert(!Co.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var Bo=Co.fold(function(Qo,Po,Mo){if(!Qo.isEmpty()&&Po&&Po.hasCompleteView())return[Po.getCompleteView().getQuery()];var Go=[];return Po&&(Go=Go.concat(Po.getQueryViews().map(function($o){return $o.getQuery()}))),each$1(Mo,function($o,jo){Go=Go.concat(jo)}),Go}),Lo=0;Lo<Bo.length;++Lo){var Uo=Bo[Lo];this.listenProvider_.stopListening(l.queryForListening_(Uo),this.tagForQuery_(Uo))}return p},l.prototype.createListenerForView_=function(o){var s=this,c=o.getQuery(),h=this.tagForQuery_(c);return{hashFn:function(){var d=o.getServerCache()||ChildrenNode.EMPTY_NODE;return d.hash()},onComplete:function(d){if(d==="ok")return h?s.applyTaggedListenComplete(c.path,h):s.applyListenComplete(c.path);var p=errorForServerCode(d,c);return s.removeEventRegistration(c,null,p)}}},l.makeQueryKey_=function(o){return o.path.toString()+"$"+o.queryIdentifier()},l.parseQueryKey_=function(o){var s=o.indexOf("$");return index_cjsExports$1.assert(s!==-1&&s<o.length-1,"Bad queryKey."),{queryId:o.substr(s+1),path:new Path(o.substr(0,s))}},l.prototype.queryKeyForTag_=function(o){return this.tagToQueryMap.get(o)},l.prototype.tagForQuery_=function(o){var s=l.makeQueryKey_(o);return this.queryToTagMap.get(s)},l.getNextQueryTag_=function(){return l.nextQueryTag_++},l.prototype.applyTaggedOperation_=function(o,s){var c=this.syncPointTree_.get(o);index_cjsExports$1.assert(c,"Missing sync point for query tag that we're tracking");var h=this.pendingWriteTree_.childWrites(o);return c.applyOperation(s,h,null)},l.prototype.applyOperationToSyncPoints_=function(o){return this.applyOperationHelper_(o,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Path.Empty))},l.prototype.applyOperationHelper_=function(o,s,c,h){if(o.path.isEmpty())return this.applyOperationDescendantsHelper_(o,s,c,h);var d=s.get(Path.Empty);c==null&&d!=null&&(c=d.getCompleteServerCache(Path.Empty));var p=[],Co=o.path.getFront(),Bo=o.operationForChild(Co),Lo=s.children.get(Co);if(Lo&&Bo){var Uo=c?c.getImmediateChild(Co):null,Qo=h.child(Co);p=p.concat(this.applyOperationHelper_(Bo,Lo,Uo,Qo))}return d&&(p=p.concat(d.applyOperation(o,h,c))),p},l.prototype.applyOperationDescendantsHelper_=function(o,s,c,h){var d=this,p=s.get(Path.Empty);c==null&&p!=null&&(c=p.getCompleteServerCache(Path.Empty));var Co=[];return s.children.inorderTraversal(function(Bo,Lo){var Uo=c?c.getImmediateChild(Bo):null,Qo=h.child(Bo),Po=o.operationForChild(Bo);Po&&(Co=Co.concat(d.applyOperationDescendantsHelper_(Po,Lo,Uo,Qo)))}),p&&(Co=Co.concat(p.applyOperation(o,h,c))),Co},l.nextQueryTag_=1,l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var SnapshotHolder=function(){function l(){this.rootNode_=ChildrenNode.EMPTY_NODE}return l.prototype.getNode=function(o){return this.rootNode_.getChild(o)},l.prototype.updateSnapshot=function(o,s){this.rootNode_=this.rootNode_.updateChild(o,s)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var AuthTokenProvider=function(){function l(o,s){var c=this;this.app_=o,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.get().then(function(h){return c.auth_=h})}return l.prototype.getToken=function(o){return this.auth_?this.auth_.getToken(o).catch(function(s){return s&&s.code==="auth/token-not-initialized"?(log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(s)}):Promise.resolve(null)},l.prototype.addTokenChangeListener=function(o){this.auth_?this.auth_.addAuthTokenListener(o):(setTimeout(function(){return o(null)},0),this.authProvider_.get().then(function(s){return s.addAuthTokenListener(o)}))},l.prototype.removeTokenChangeListener=function(o){this.authProvider_.get().then(function(s){return s.removeAuthTokenListener(o)})},l.prototype.notifyForInvalidToken=function(){var o='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?o+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?o+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':o+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn(o)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var StatsCollection=function(){function l(){this.counters_={}}return l.prototype.incrementCounter=function(o,s){s===void 0&&(s=1),index_cjsExports$1.contains(this.counters_,o)||(this.counters_[o]=0),this.counters_[o]+=s},l.prototype.get=function(){return index_cjsExports$1.deepCopy(this.counters_)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var StatsManager=function(){function l(){}return l.getCollection=function(o){var s=o.toString();return this.collections_[s]||(this.collections_[s]=new StatsCollection),this.collections_[s]},l.getOrCreateReporter=function(o,s){var c=o.toString();return this.reporters_[c]||(this.reporters_[c]=s()),this.reporters_[c]},l.collections_={},l.reporters_={},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var StatsListener=function(){function l(o){this.collection_=o,this.last_=null}return l.prototype.get=function(){var o=this.collection_.get(),s=__assign$1({},o);return this.last_&&each$1(this.last_,function(c,h){s[c]=s[c]-h}),this.last_=o,s},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var FIRST_STATS_MIN_TIME=10*1e3,FIRST_STATS_MAX_TIME=30*1e3,REPORT_STATS_INTERVAL=5*60*1e3,StatsReporter=function(){function l(o,s){this.server_=s,this.statsToReport_={},this.statsListener_=new StatsListener(o);var c=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(c))}return l.prototype.includeStat=function(o){this.statsToReport_[o]=!0},l.prototype.reportStats_=function(){var o=this,s=this.statsListener_.get(),c={},h=!1;each$1(s,function(d,p){p>0&&index_cjsExports$1.contains(o.statsToReport_,d)&&(c[d]=p,h=!0)}),h&&this.server_.reportStats(c),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(Math.random()*2*REPORT_STATS_INTERVAL))},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var EventQueue=function(){function l(){this.eventLists_=[],this.recursionDepth_=0}return l.prototype.queueEvents=function(o){for(var s=null,c=0;c<o.length;c++){var h=o[c],d=h.getPath();s!==null&&!d.equals(s.getPath())&&(this.eventLists_.push(s),s=null),s===null&&(s=new EventList(d)),s.add(h)}s&&this.eventLists_.push(s)},l.prototype.raiseEventsAtPath=function(o,s){this.queueEvents(s),this.raiseQueuedEventsMatchingPredicate_(function(c){return c.equals(o)})},l.prototype.raiseEventsForChangedPath=function(o,s){this.queueEvents(s),this.raiseQueuedEventsMatchingPredicate_(function(c){return c.contains(o)||o.contains(c)})},l.prototype.raiseQueuedEventsMatchingPredicate_=function(o){this.recursionDepth_++;for(var s=!0,c=0;c<this.eventLists_.length;c++){var h=this.eventLists_[c];if(h){var d=h.getPath();o(d)?(this.eventLists_[c].raise(),this.eventLists_[c]=null):s=!1}}s&&(this.eventLists_=[]),this.recursionDepth_--},l}(),EventList=function(){function l(o){this.path_=o,this.events_=[]}return l.prototype.add=function(o){this.events_.push(o)},l.prototype.raise=function(){for(var o=0;o<this.events_.length;o++){var s=this.events_[o];if(s!==null){this.events_[o]=null;var c=s.getEventRunner();logger&&log("event: "+s.toString()),exceptionGuard(c)}}},l.prototype.getPath=function(){return this.path_},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var EventEmitter=function(){function l(o){this.allowedEvents_=o,this.listeners_={},index_cjsExports$1.assert(Array.isArray(o)&&o.length>0,"Requires a non-empty array")}return l.prototype.trigger=function(o){for(var s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];if(Array.isArray(this.listeners_[o]))for(var h=__spread(this.listeners_[o]),d=0;d<h.length;d++)h[d].callback.apply(h[d].context,s)},l.prototype.on=function(o,s,c){this.validateEventType_(o),this.listeners_[o]=this.listeners_[o]||[],this.listeners_[o].push({callback:s,context:c});var h=this.getInitialEvent(o);h&&s.apply(c,h)},l.prototype.off=function(o,s,c){this.validateEventType_(o);for(var h=this.listeners_[o]||[],d=0;d<h.length;d++)if(h[d].callback===s&&(!c||c===h[d].context)){h.splice(d,1);return}},l.prototype.validateEventType_=function(o){index_cjsExports$1.assert(this.allowedEvents_.find(function(s){return s===o}),"Unknown event: "+o)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var VisibilityMonitor=function(l){__extends$1(o,l);function o(){var s=l.call(this,["visible"])||this,c,h;return typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(h="visibilitychange",c="hidden"):typeof document.mozHidden<"u"?(h="mozvisibilitychange",c="mozHidden"):typeof document.msHidden<"u"?(h="msvisibilitychange",c="msHidden"):typeof document.webkitHidden<"u"&&(h="webkitvisibilitychange",c="webkitHidden")),s.visible_=!0,h&&document.addEventListener(h,function(){var d=!document[c];d!==s.visible_&&(s.visible_=d,s.trigger("visible",d))},!1),s}return o.getInstance=function(){return new o},o.prototype.getInitialEvent=function(s){return index_cjsExports$1.assert(s==="visible","Unknown event type: "+s),[this.visible_]},o}(EventEmitter);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var OnlineMonitor=function(l){__extends$1(o,l);function o(){var s=l.call(this,["online"])||this;return s.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!index_cjsExports$1.isMobileCordova()&&(window.addEventListener("online",function(){s.online_||(s.online_=!0,s.trigger("online",!0))},!1),window.addEventListener("offline",function(){s.online_&&(s.online_=!1,s.trigger("online",!1))},!1)),s}return o.getInstance=function(){return new o},o.prototype.getInitialEvent=function(s){return index_cjsExports$1.assert(s==="online","Unknown event type: "+s),[this.online_]},o.prototype.currentlyOnline=function(){return this.online_},o}(EventEmitter);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var PacketReceiver=function(){function l(o){this.onMessage_=o,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return l.prototype.closeAfter=function(o,s){this.closeAfterResponse=o,this.onClose=s,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},l.prototype.handleResponse=function(o,s){var c=this;this.pendingResponses[o]=s;for(var h=function(){var Co=d.pendingResponses[d.currentResponseNum];delete d.pendingResponses[d.currentResponseNum];for(var Bo=function(Uo){Co[Uo]&&exceptionGuard(function(){c.onMessage_(Co[Uo])})},Lo=0;Lo<Co.length;++Lo)Bo(Lo);if(d.currentResponseNum===d.closeAfterResponse)return d.onClose&&(d.onClose(),d.onClose=null),"break";d.currentResponseNum++},d=this;this.pendingResponses[this.currentResponseNum];){var p=h();if(p==="break")break}},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var FIREBASE_LONGPOLL_START_PARAM="start",FIREBASE_LONGPOLL_CLOSE_COMMAND="close",FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",FIREBASE_LONGPOLL_ID_PARAM="id",FIREBASE_LONGPOLL_PW_PARAM="pw",FIREBASE_LONGPOLL_SERIAL_PARAM="ser",FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",FIREBASE_LONGPOLL_DATA_PARAM="d",FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",MAX_URL_DATA_SIZE=1870,SEG_HEADER_SIZE=30,MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE,KEEPALIVE_REQUEST_INTERVAL=25e3,LP_CONNECT_TIMEOUT=3e4,BrowserPollConnection=function(){function l(o,s,c,h){this.connId=o,this.repoInfo=s,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(o),this.stats_=StatsManager.getCollection(s),this.urlFn=function(d){return s.connectionURL(LONG_POLLING,d)}}return l.prototype.open=function(o,s){var c=this;this.curSegmentNum=0,this.onDisconnect_=s,this.myPacketOrderer=new PacketReceiver(o),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){c.log_("Timed out trying to connect."),c.onClosed_(),c.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT)),executeWhenDOMReady(function(){if(!c.isClosed_){c.scriptTagHolder=new FirebaseIFrameScriptHolder(function(){for(var p=[],Co=0;Co<arguments.length;Co++)p[Co]=arguments[Co];var Bo=__read(p,5),Lo=Bo[0],Uo=Bo[1],Qo=Bo[2];if(Bo[3],Bo[4],c.incrementIncomingBytes_(p),!!c.scriptTagHolder)if(c.connectTimeoutTimer_&&(clearTimeout(c.connectTimeoutTimer_),c.connectTimeoutTimer_=null),c.everConnected_=!0,Lo===FIREBASE_LONGPOLL_START_PARAM)c.id=Uo,c.password=Qo;else if(Lo===FIREBASE_LONGPOLL_CLOSE_COMMAND)Uo?(c.scriptTagHolder.sendNewPolls=!1,c.myPacketOrderer.closeAfter(Uo,function(){c.onClosed_()})):c.onClosed_();else throw new Error("Unrecognized command received: "+Lo)},function(){for(var p=[],Co=0;Co<arguments.length;Co++)p[Co]=arguments[Co];var Bo=__read(p,2),Lo=Bo[0],Uo=Bo[1];c.incrementIncomingBytes_(p),c.myPacketOrderer.handleResponse(Lo,Uo)},function(){c.onClosed_()},c.urlFn);var h={};h[FIREBASE_LONGPOLL_START_PARAM]="t",h[FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(Math.random()*1e8),c.scriptTagHolder.uniqueCallbackIdentifier&&(h[FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=c.scriptTagHolder.uniqueCallbackIdentifier),h[VERSION_PARAM]=PROTOCOL_VERSION,c.transportSessionId&&(h[TRANSPORT_SESSION_PARAM]=c.transportSessionId),c.lastSessionId&&(h[LAST_SESSION_PARAM]=c.lastSessionId),typeof location<"u"&&location.href&&location.href.indexOf(FORGE_DOMAIN)!==-1&&(h[REFERER_PARAM]=FORGE_REF);var d=c.urlFn(h);c.log_("Connecting via long-poll to "+d),c.scriptTagHolder.addTag(d,function(){})}})},l.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},l.forceAllow=function(){l.forceAllow_=!0},l.forceDisallow=function(){l.forceDisallow_=!0},l.isAvailable=function(){return index_cjsExports$1.isNodeSdk()?!1:l.forceAllow_?!0:!l.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()},l.prototype.markConnectionHealthy=function(){},l.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},l.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},l.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},l.prototype.send=function(o){var s=index_cjsExports$1.stringify(o);this.bytesSent+=s.length,this.stats_.incrementCounter("bytes_sent",s.length);for(var c=index_cjsExports$1.base64Encode(s),h=splitStringBySize(c,MAX_PAYLOAD_SIZE),d=0;d<h.length;d++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,h.length,h[d]),this.curSegmentNum++},l.prototype.addDisconnectPingFrame=function(o,s){if(!index_cjsExports$1.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var c={};c[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",c[FIREBASE_LONGPOLL_ID_PARAM]=o,c[FIREBASE_LONGPOLL_PW_PARAM]=s,this.myDisconnFrame.src=this.urlFn(c),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},l.prototype.incrementIncomingBytes_=function(o){var s=index_cjsExports$1.stringify(o).length;this.bytesReceived+=s,this.stats_.incrementCounter("bytes_received",s)},l}(),FirebaseIFrameScriptHolder=function(){function l(o,s,c,h){if(this.onDisconnect=c,this.urlFn=h,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,index_cjsExports$1.isNodeSdk())this.commandCB=o,this.onMessageCB=s;else{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=o,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=s,this.myIFrame=l.createIFrame_();var d="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){var p=document.domain;d='<script>document.domain="'+p+'";<\/script>'}var Co="<html><body>"+d+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(Co),this.myIFrame.doc.close()}catch(Bo){log("frame writing exception"),Bo.stack&&log(Bo.stack),log(Bo)}}}return l.createIFrame_=function(){var o=document.createElement("iframe");if(o.style.display="none",document.body){document.body.appendChild(o);try{var s=o.contentWindow.document;s||log("No IE domain setting required")}catch{var c=document.domain;o.src="javascript:void((function(){document.open();document.domain='"+c+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return o.contentDocument?o.doc=o.contentDocument:o.contentWindow?o.doc=o.contentWindow.document:o.document&&(o.doc=o.document),o},l.prototype.close=function(){var o=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){o.myIFrame!==null&&(document.body.removeChild(o.myIFrame),o.myIFrame=null)},Math.floor(0)));var s=this.onDisconnect;s&&(this.onDisconnect=null,s())},l.prototype.startLongPoll=function(o,s){for(this.myID=o,this.myPW=s,this.alive=!0;this.newRequest_(););},l.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var o={};o[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,o[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,o[FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;for(var s=this.urlFn(o),c="",h=0;this.pendingSegs.length>0;){var d=this.pendingSegs[0];if(d.d.length+SEG_HEADER_SIZE+c.length<=MAX_URL_DATA_SIZE){var p=this.pendingSegs.shift();c=c+"&"+FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+h+"="+p.seg+"&"+FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+h+"="+p.ts+"&"+FIREBASE_LONGPOLL_DATA_PARAM+h+"="+p.d,h++}else break}return s=s+c,this.addLongPollTag_(s,this.currentSerial),!0}else return!1},l.prototype.enqueueSegment=function(o,s,c){this.pendingSegs.push({seg:o,ts:s,d:c}),this.alive&&this.newRequest_()},l.prototype.addLongPollTag_=function(o,s){var c=this;this.outstandingRequests.add(s);var h=function(){c.outstandingRequests.delete(s),c.newRequest_()},d=setTimeout(h,Math.floor(KEEPALIVE_REQUEST_INTERVAL)),p=function(){clearTimeout(d),h()};this.addTag(o,p)},l.prototype.addTag=function(o,s){var c=this;index_cjsExports$1.isNodeSdk()?this.doNodeLongPoll(o,s):setTimeout(function(){try{if(!c.sendNewPolls)return;var h=c.myIFrame.doc.createElement("script");h.type="text/javascript",h.async=!0,h.src=o,h.onload=h.onreadystatechange=function(){var d=h.readyState;(!d||d==="loaded"||d==="complete")&&(h.onload=h.onreadystatechange=null,h.parentNode&&h.parentNode.removeChild(h),s())},h.onerror=function(){log("Long-poll script failed to load: "+o),c.sendNewPolls=!1,c.close()},c.myIFrame.doc.body.appendChild(h)}catch{}},Math.floor(1))},l}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var SDK_VERSION="";function setSDKVersion(l){SDK_VERSION=l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var WEBSOCKET_MAX_FRAME_SIZE=16384,WEBSOCKET_KEEPALIVE_INTERVAL=45e3,WebSocketImpl=null;typeof MozWebSocket<"u"?WebSocketImpl=MozWebSocket:typeof WebSocket<"u"&&(WebSocketImpl=WebSocket);var WebSocketConnection=function(){function l(o,s,c,h){this.connId=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=StatsManager.getCollection(s),this.connURL=l.connectionURL_(s,c,h)}return l.connectionURL_=function(o,s,c){var h={};return h[VERSION_PARAM]=PROTOCOL_VERSION,!index_cjsExports$1.isNodeSdk()&&typeof location<"u"&&location.href&&location.href.indexOf(FORGE_DOMAIN)!==-1&&(h[REFERER_PARAM]=FORGE_REF),s&&(h[TRANSPORT_SESSION_PARAM]=s),c&&(h[LAST_SESSION_PARAM]=c),o.connectionURL(WEBSOCKET,h)},l.prototype.open=function(o,s){var c=this;this.onDisconnect=s,this.onMessage=o,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{if(index_cjsExports$1.isNodeSdk()){var h=index_cjsExports$1.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",d={headers:{"User-Agent":"Firebase/"+PROTOCOL_VERSION+"/"+SDK_VERSION+"/"+process.platform+"/"+h}},p=process.env,Co=this.connURL.indexOf("wss://")===0?p.HTTPS_PROXY||p.https_proxy:p.HTTP_PROXY||p.http_proxy;Co&&(d.proxy={origin:Co}),this.mySock=new WebSocketImpl(this.connURL,[],d)}else this.mySock=new WebSocketImpl(this.connURL)}catch(Lo){this.log_("Error instantiating WebSocket.");var Bo=Lo.message||Lo.data;Bo&&this.log_(Bo),this.onClosed_();return}this.mySock.onopen=function(){c.log_("Websocket connected."),c.everConnected_=!0},this.mySock.onclose=function(){c.log_("Websocket connection was disconnected."),c.mySock=null,c.onClosed_()},this.mySock.onmessage=function(Lo){c.handleIncomingFrame(Lo)},this.mySock.onerror=function(Lo){c.log_("WebSocket error.  Closing connection.");var Uo=Lo.message||Lo.data;Uo&&c.log_(Uo),c.onClosed_()}},l.prototype.start=function(){},l.forceDisallow=function(){l.forceDisallow_=!0},l.isAvailable=function(){var o=!1;if(typeof navigator<"u"&&navigator.userAgent){var s=/Android ([0-9]{0,}\.[0-9]{0,})/,c=navigator.userAgent.match(s);c&&c.length>1&&parseFloat(c[1])<4.4&&(o=!0)}return!o&&WebSocketImpl!==null&&!l.forceDisallow_},l.previouslyFailed=function(){return PersistentStorage.isInMemoryStorage||PersistentStorage.get("previous_websocket_failure")===!0},l.prototype.markConnectionHealthy=function(){PersistentStorage.remove("previous_websocket_failure")},l.prototype.appendFrame_=function(o){if(this.frames.push(o),this.frames.length===this.totalFrames){var s=this.frames.join("");this.frames=null;var c=index_cjsExports$1.jsonEval(s);this.onMessage(c)}},l.prototype.handleNewFrameCount_=function(o){this.totalFrames=o,this.frames=[]},l.prototype.extractFrameCount_=function(o){if(index_cjsExports$1.assert(this.frames===null,"We already have a frame buffer"),o.length<=6){var s=Number(o);if(!isNaN(s))return this.handleNewFrameCount_(s),null}return this.handleNewFrameCount_(1),o},l.prototype.handleIncomingFrame=function(o){if(this.mySock!==null){var s=o.data;if(this.bytesReceived+=s.length,this.stats_.incrementCounter("bytes_received",s.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(s);else{var c=this.extractFrameCount_(s);c!==null&&this.appendFrame_(c)}}},l.prototype.send=function(o){this.resetKeepAlive();var s=index_cjsExports$1.stringify(o);this.bytesSent+=s.length,this.stats_.incrementCounter("bytes_sent",s.length);var c=splitStringBySize(s,WEBSOCKET_MAX_FRAME_SIZE);c.length>1&&this.sendString_(String(c.length));for(var h=0;h<c.length;h++)this.sendString_(c[h])},l.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},l.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},l.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},l.prototype.resetKeepAlive=function(){var o=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){o.mySock&&o.sendString_("0"),o.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))},l.prototype.sendString_=function(o){try{this.mySock.send(o)}catch(s){this.log_("Exception thrown from WebSocket.send():",s.message||s.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},l.responsesRequiredToBeHealthy=2,l.healthyTimeout=3e4,l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var TransportManager=function(){function l(o){this.initTransports_(o)}return Object.defineProperty(l,"ALL_TRANSPORTS",{get:function(){return[BrowserPollConnection,WebSocketConnection]},enumerable:!0,configurable:!0}),l.prototype.initTransports_=function(o){var s,c,h=WebSocketConnection&&WebSocketConnection.isAvailable(),d=h&&!WebSocketConnection.previouslyFailed();if(o.webSocketOnly&&(h||warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),d=!0),d)this.transports_=[WebSocketConnection];else{var p=this.transports_=[];try{for(var Co=__values$1(l.ALL_TRANSPORTS),Bo=Co.next();!Bo.done;Bo=Co.next()){var Lo=Bo.value;Lo&&Lo.isAvailable()&&p.push(Lo)}}catch(Uo){s={error:Uo}}finally{try{Bo&&!Bo.done&&(c=Co.return)&&c.call(Co)}finally{if(s)throw s.error}}}},l.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},l.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var UPGRADE_TIMEOUT=6e4,DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3,BYTES_SENT_HEALTHY_OVERRIDE=10*1024,BYTES_RECEIVED_HEALTHY_OVERRIDE=100*1024,MESSAGE_TYPE="t",MESSAGE_DATA="d",CONTROL_SHUTDOWN="s",CONTROL_RESET="r",CONTROL_ERROR="e",CONTROL_PONG="o",SWITCH_ACK="a",END_TRANSMISSION="n",PING="p",SERVER_HELLO="h",Connection=function(){function l(o,s,c,h,d,p,Co){this.id=o,this.repoInfo_=s,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=d,this.onKill_=p,this.lastSessionId=Co,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(s),this.log_("Connection created"),this.start_()}return l.prototype.start_=function(){var o=this,s=this.transportManager_.initialTransport();this.conn_=new s(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=s.responsesRequiredToBeHealthy||0;var c=this.connReceiver_(this.conn_),h=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){o.conn_&&o.conn_.open(c,h)},Math.floor(0));var d=s.healthyTimeout||0;d>0&&(this.healthyTimeout_=setTimeoutNonBlocking(function(){o.healthyTimeout_=null,o.isHealthy_||(o.conn_&&o.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE?(o.log_("Connection exceeded healthy timeout but has received "+o.conn_.bytesReceived+" bytes.  Marking connection healthy."),o.isHealthy_=!0,o.conn_.markConnectionHealthy()):o.conn_&&o.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE?o.log_("Connection exceeded healthy timeout but has sent "+o.conn_.bytesSent+" bytes.  Leaving connection alive."):(o.log_("Closing unhealthy connection after timeout."),o.close()))},Math.floor(d)))},l.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},l.prototype.disconnReceiver_=function(o){var s=this;return function(c){o===s.conn_?s.onConnectionLost_(c):o===s.secondaryConn_?(s.log_("Secondary connection lost."),s.onSecondaryConnectionLost_()):s.log_("closing an old connection")}},l.prototype.connReceiver_=function(o){var s=this;return function(c){s.state_!==2&&(o===s.rx_?s.onPrimaryMessageReceived_(c):o===s.secondaryConn_?s.onSecondaryMessageReceived_(c):s.log_("message on old connection"))}},l.prototype.sendRequest=function(o){var s={t:"d",d:o};this.sendData_(s)},l.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},l.prototype.onSecondaryControl_=function(o){if(MESSAGE_TYPE in o){var s=o[MESSAGE_TYPE];s===SWITCH_ACK?this.upgradeIfSecondaryHealthy_():s===CONTROL_RESET?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):s===CONTROL_PONG&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},l.prototype.onSecondaryMessageReceived_=function(o){var s=requireKey("t",o),c=requireKey("d",o);if(s==="c")this.onSecondaryControl_(c);else if(s==="d")this.pendingDataMessages.push(c);else throw new Error("Unknown protocol layer: "+s)},l.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}}))},l.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},l.prototype.onPrimaryMessageReceived_=function(o){var s=requireKey("t",o),c=requireKey("d",o);s==="c"?this.onControl_(c):s==="d"&&this.onDataMessage_(c)},l.prototype.onDataMessage_=function(o){this.onPrimaryResponse_(),this.onMessage_(o)},l.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},l.prototype.onControl_=function(o){var s=requireKey(MESSAGE_TYPE,o);if(MESSAGE_DATA in o){var c=o[MESSAGE_DATA];if(s===SERVER_HELLO)this.onHandshake_(c);else if(s===END_TRANSMISSION){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var h=0;h<this.pendingDataMessages.length;++h)this.onDataMessage_(this.pendingDataMessages[h]);this.pendingDataMessages=[],this.tryCleanupConnection()}else s===CONTROL_SHUTDOWN?this.onConnectionShutdown_(c):s===CONTROL_RESET?this.onReset_(c):s===CONTROL_ERROR?error$1("Server Error: "+c):s===CONTROL_PONG?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error$1("Unknown control packet command: "+s)}},l.prototype.onHandshake_=function(o){var s=o.ts,c=o.v,h=o.h;this.sessionId=o.s,this.repoInfo_.updateHost(h),this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,s),PROTOCOL_VERSION!==c&&warn("Protocol version mismatch detected"),this.tryStartUpgrade_())},l.prototype.tryStartUpgrade_=function(){var o=this.transportManager_.upgradeTransport();o&&this.startUpgrade_(o)},l.prototype.startUpgrade_=function(o){var s=this;this.secondaryConn_=new o(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=o.responsesRequiredToBeHealthy||0;var c=this.connReceiver_(this.secondaryConn_),h=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(c,h),setTimeoutNonBlocking(function(){s.secondaryConn_&&(s.log_("Timed out trying to upgrade."),s.secondaryConn_.close())},Math.floor(UPGRADE_TIMEOUT))},l.prototype.onReset_=function(o){this.log_("Reset packet received.  New host: "+o),this.repoInfo_.updateHost(o),this.state_===1?this.close():(this.closeConnections_(),this.start_())},l.prototype.onConnectionEstablished_=function(o,s){var c=this;this.log_("Realtime connection established."),this.conn_=o,this.state_=1,this.onReady_&&(this.onReady_(s,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(function(){c.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))},l.prototype.sendPingOnPrimaryIfNecessary_=function(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PING,d:{}}}))},l.prototype.onSecondaryConnectionLost_=function(){var o=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===o||this.rx_===o)&&this.close()},l.prototype.onConnectionLost_=function(o){this.conn_=null,!o&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()},l.prototype.onConnectionShutdown_=function(o){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(o),this.onKill_=null),this.onDisconnect_=null,this.close()},l.prototype.sendData_=function(o){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(o)},l.prototype.close=function(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},l.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ServerActions=function(){function l(){}return l.prototype.put=function(o,s,c,h){},l.prototype.merge=function(o,s,c,h){},l.prototype.refreshAuthToken=function(o){},l.prototype.onDisconnectPut=function(o,s,c){},l.prototype.onDisconnectMerge=function(o,s,c){},l.prototype.onDisconnectCancel=function(o,s){},l.prototype.reportStats=function(o){},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=60*5*1e3,RECONNECT_MAX_DELAY_FOR_ADMINS=30*1e3,RECONNECT_DELAY_MULTIPLIER=1.3,RECONNECT_DELAY_RESET_TIMEOUT=3e4,SERVER_KILL_INTERRUPT_REASON="server_kill",INVALID_AUTH_TOKEN_THRESHOLD=3,PersistentConnection=function(l){__extends$1(o,l);function o(s,c,h,d,p,Co){var Bo=l.call(this)||this;if(Bo.repoInfo_=s,Bo.onDataUpdate_=c,Bo.onConnectStatus_=h,Bo.onServerInfoUpdate_=d,Bo.authTokenProvider_=p,Bo.authOverride_=Co,Bo.id=o.nextPersistentConnectionId_++,Bo.log_=logWrapper("p:"+Bo.id+":"),Bo.interruptReasons_={},Bo.listens=new Map,Bo.outstandingPuts_=[],Bo.outstandingPutCount_=0,Bo.onDisconnectRequestQueue_=[],Bo.connected_=!1,Bo.reconnectDelay_=RECONNECT_MIN_DELAY,Bo.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,Bo.securityDebugCallback_=null,Bo.lastSessionId=null,Bo.establishConnectionTimer_=null,Bo.visible_=!1,Bo.requestCBHash_={},Bo.requestNumber_=0,Bo.realtime_=null,Bo.authToken_=null,Bo.forceTokenRefresh_=!1,Bo.invalidAuthTokenCount_=0,Bo.firstConnection_=!0,Bo.lastConnectionAttemptTime_=null,Bo.lastConnectionEstablishedTime_=null,Co&&!index_cjsExports$1.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Bo.scheduleConnect_(0),VisibilityMonitor.getInstance().on("visible",Bo.onVisible_,Bo),s.host.indexOf("fblocal")===-1&&OnlineMonitor.getInstance().on("online",Bo.onOnline_,Bo),Bo}return o.prototype.sendRequest=function(s,c,h){var d=++this.requestNumber_,p={r:d,a:s,b:c};this.log_(index_cjsExports$1.stringify(p)),index_cjsExports$1.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(p),h&&(this.requestCBHash_[d]=h)},o.prototype.listen=function(s,c,h,d){var p=s.queryIdentifier(),Co=s.path.toString();this.log_("Listen called for "+Co+" "+p),this.listens.has(Co)||this.listens.set(Co,new Map),index_cjsExports$1.assert(s.getQueryParams().isDefault()||!s.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),index_cjsExports$1.assert(!this.listens.get(Co).has(p),"listen() called twice for same path/queryId.");var Bo={onComplete:d,hashFn:c,query:s,tag:h};this.listens.get(Co).set(p,Bo),this.connected_&&this.sendListen_(Bo)},o.prototype.sendListen_=function(s){var c=this,h=s.query,d=h.path.toString(),p=h.queryIdentifier();this.log_("Listen on "+d+" for "+p);var Co={p:d},Bo="q";s.tag&&(Co.q=h.queryObject(),Co.t=s.tag),Co.h=s.hashFn(),this.sendRequest(Bo,Co,function(Lo){var Uo=Lo.d,Qo=Lo.s;o.warnOnListenWarnings_(Uo,h);var Po=c.listens.get(d)&&c.listens.get(d).get(p);Po===s&&(c.log_("listen response",Lo),Qo!=="ok"&&c.removeListen_(d,p),s.onComplete&&s.onComplete(Qo,Uo))})},o.warnOnListenWarnings_=function(s,c){if(s&&typeof s=="object"&&index_cjsExports$1.contains(s,"w")){var h=index_cjsExports$1.safeGet(s,"w");if(Array.isArray(h)&&~h.indexOf("no_index")){var d='".indexOn": "'+c.getQueryParams().getIndex().toString()+'"',p=c.path.toString();warn("Using an unspecified index. Your data will be downloaded and "+("filtered on the client. Consider adding "+d+" at ")+(p+" to your security rules for better performance."))}}},o.prototype.refreshAuthToken=function(s){this.authToken_=s,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(s)},o.prototype.reduceReconnectDelayIfAdminCredential_=function(s){var c=s&&s.length===40;(c||index_cjsExports$1.isAdmin(s))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS)},o.prototype.tryAuth=function(){var s=this;if(this.connected_&&this.authToken_){var c=this.authToken_,h=index_cjsExports$1.isValidFormat(c)?"auth":"gauth",d={cred:c};this.authOverride_===null?d.noauth=!0:typeof this.authOverride_=="object"&&(d.authvar=this.authOverride_),this.sendRequest(h,d,function(p){var Co=p.s,Bo=p.d||"error";s.authToken_===c&&(Co==="ok"?s.invalidAuthTokenCount_=0:s.onAuthRevoked_(Co,Bo))})}},o.prototype.unlisten=function(s,c){var h=s.path.toString(),d=s.queryIdentifier();this.log_("Unlisten called for "+h+" "+d),index_cjsExports$1.assert(s.getQueryParams().isDefault()||!s.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query");var p=this.removeListen_(h,d);p&&this.connected_&&this.sendUnlisten_(h,d,s.queryObject(),c)},o.prototype.sendUnlisten_=function(s,c,h,d){this.log_("Unlisten on "+s+" for "+c);var p={p:s},Co="n";d&&(p.q=h,p.t=d),this.sendRequest(Co,p)},o.prototype.onDisconnectPut=function(s,c,h){this.connected_?this.sendOnDisconnect_("o",s,c,h):this.onDisconnectRequestQueue_.push({pathString:s,action:"o",data:c,onComplete:h})},o.prototype.onDisconnectMerge=function(s,c,h){this.connected_?this.sendOnDisconnect_("om",s,c,h):this.onDisconnectRequestQueue_.push({pathString:s,action:"om",data:c,onComplete:h})},o.prototype.onDisconnectCancel=function(s,c){this.connected_?this.sendOnDisconnect_("oc",s,null,c):this.onDisconnectRequestQueue_.push({pathString:s,action:"oc",data:null,onComplete:c})},o.prototype.sendOnDisconnect_=function(s,c,h,d){var p={p:c,d:h};this.log_("onDisconnect "+s,p),this.sendRequest(s,p,function(Co){d&&setTimeout(function(){d(Co.s,Co.d)},Math.floor(0))})},o.prototype.put=function(s,c,h,d){this.putInternal("p",s,c,h,d)},o.prototype.merge=function(s,c,h,d){this.putInternal("m",s,c,h,d)},o.prototype.putInternal=function(s,c,h,d,p){var Co={p:c,d:h};p!==void 0&&(Co.h=p),this.outstandingPuts_.push({action:s,request:Co,onComplete:d}),this.outstandingPutCount_++;var Bo=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(Bo):this.log_("Buffering put: "+c)},o.prototype.sendPut_=function(s){var c=this,h=this.outstandingPuts_[s].action,d=this.outstandingPuts_[s].request,p=this.outstandingPuts_[s].onComplete;this.outstandingPuts_[s].queued=this.connected_,this.sendRequest(h,d,function(Co){c.log_(h+" response",Co),delete c.outstandingPuts_[s],c.outstandingPutCount_--,c.outstandingPutCount_===0&&(c.outstandingPuts_=[]),p&&p(Co.s,Co.d)})},o.prototype.reportStats=function(s){var c=this;if(this.connected_){var h={c:s};this.log_("reportStats",h),this.sendRequest("s",h,function(d){var p=d.s;if(p!=="ok"){var Co=d.d;c.log_("reportStats","Error sending stats: "+Co)}})}},o.prototype.onDataMessage_=function(s){if("r"in s){this.log_("from server: "+index_cjsExports$1.stringify(s));var c=s.r,h=this.requestCBHash_[c];h&&(delete this.requestCBHash_[c],h(s.b))}else{if("error"in s)throw"A server-side error has occurred: "+s.error;"a"in s&&this.onDataPush_(s.a,s.b)}},o.prototype.onDataPush_=function(s,c){this.log_("handleServerMessage",s,c),s==="d"?this.onDataUpdate_(c.p,c.d,!1,c.t):s==="m"?this.onDataUpdate_(c.p,c.d,!0,c.t):s==="c"?this.onListenRevoked_(c.p,c.q):s==="ac"?this.onAuthRevoked_(c.s,c.d):s==="sd"?this.onSecurityDebugPacket_(c):error$1("Unrecognized action received from server: "+index_cjsExports$1.stringify(s)+`
Are you using the latest client?`)},o.prototype.onReady_=function(s,c){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(s),this.lastSessionId=c,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},o.prototype.scheduleConnect_=function(s){var c=this;index_cjsExports$1.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){c.establishConnectionTimer_=null,c.establishConnection_()},Math.floor(s))},o.prototype.onVisible_=function(s){s&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=s},o.prototype.onOnline_=function(s){s?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},o.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(!this.visible_)this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime();else if(this.lastConnectionEstablishedTime_){var s=new Date().getTime()-this.lastConnectionEstablishedTime_;s>RECONNECT_DELAY_RESET_TIMEOUT&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null}var c=new Date().getTime()-this.lastConnectionAttemptTime_,h=Math.max(0,this.reconnectDelay_-c);h=Math.random()*h,this.log_("Trying to reconnect in "+h+"ms"),this.scheduleConnect_(h),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(!1)},o.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;var s=this.onDataMessage_.bind(this),c=this.onReady_.bind(this),h=this.onRealtimeDisconnect_.bind(this),d=this.id+":"+o.nextConnectionId_++,p=this,Co=this.lastSessionId,Bo=!1,Lo=null,Uo=function(){Lo?Lo.close():(Bo=!0,h())},Qo=function(Mo){index_cjsExports$1.assert(Lo,"sendRequest call when we're not connected not allowed."),Lo.sendRequest(Mo)};this.realtime_={close:Uo,sendRequest:Qo};var Po=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(Po).then(function(Mo){Bo?log("getToken() completed but was canceled"):(log("getToken() completed. Creating connection."),p.authToken_=Mo&&Mo.accessToken,Lo=new Connection(d,p.repoInfo_,s,c,h,function(Go){warn(Go+" ("+p.repoInfo_.toString()+")"),p.interrupt(SERVER_KILL_INTERRUPT_REASON)},Co))}).then(null,function(Mo){p.log_("Failed to get token: "+Mo),Bo||(index_cjsExports$1.CONSTANTS.NODE_ADMIN&&warn(Mo),Uo())})}},o.prototype.interrupt=function(s){log("Interrupting connection for reason: "+s),this.interruptReasons_[s]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},o.prototype.resume=function(s){log("Resuming connection for reason: "+s),delete this.interruptReasons_[s],index_cjsExports$1.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))},o.prototype.handleTimestamp_=function(s){var c=s-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:c})},o.prototype.cancelSentTransactions_=function(){for(var s=0;s<this.outstandingPuts_.length;s++){var c=this.outstandingPuts_[s];c&&"h"in c.request&&c.queued&&(c.onComplete&&c.onComplete("disconnect"),delete this.outstandingPuts_[s],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])},o.prototype.onListenRevoked_=function(s,c){var h;c?h=c.map(function(p){return ObjectToUniqueKey(p)}).join("$"):h="default";var d=this.removeListen_(s,h);d&&d.onComplete&&d.onComplete("permission_denied")},o.prototype.removeListen_=function(s,c){var h=new Path(s).toString(),d;if(this.listens.has(h)){var p=this.listens.get(h);d=p.get(c),p.delete(c),p.size===0&&this.listens.delete(h)}else d=void 0;return d},o.prototype.onAuthRevoked_=function(s,c){log("Auth token revoked: "+s+"/"+c),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(s==="invalid_token"||s==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=INVALID_AUTH_TOKEN_THRESHOLD&&(this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS,this.authTokenProvider_.notifyForInvalidToken()))},o.prototype.onSecurityDebugPacket_=function(s){this.securityDebugCallback_?this.securityDebugCallback_(s):"msg"in s&&console.log("FIREBASE: "+s.msg.replace(`
`,`
FIREBASE: `))},o.prototype.restoreState_=function(){var s,c,h,d;this.tryAuth();try{for(var p=__values$1(this.listens.values()),Co=p.next();!Co.done;Co=p.next()){var Bo=Co.value;try{for(var Lo=(h=void 0,__values$1(Bo.values())),Uo=Lo.next();!Uo.done;Uo=Lo.next()){var Qo=Uo.value;this.sendListen_(Qo)}}catch(Go){h={error:Go}}finally{try{Uo&&!Uo.done&&(d=Lo.return)&&d.call(Lo)}finally{if(h)throw h.error}}}}catch(Go){s={error:Go}}finally{try{Co&&!Co.done&&(c=p.return)&&c.call(p)}finally{if(s)throw s.error}}for(var Po=0;Po<this.outstandingPuts_.length;Po++)this.outstandingPuts_[Po]&&this.sendPut_(Po);for(;this.onDisconnectRequestQueue_.length;){var Mo=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(Mo.action,Mo.pathString,Mo.data,Mo.onComplete)}},o.prototype.sendConnectStats_=function(){var s={},c="js";index_cjsExports$1.CONSTANTS.NODE_ADMIN?c="admin_node":index_cjsExports$1.CONSTANTS.NODE_CLIENT&&(c="node"),s["sdk."+c+"."+SDK_VERSION.replace(/\./g,"-")]=1,index_cjsExports$1.isMobileCordova()?s["framework.cordova"]=1:index_cjsExports$1.isReactNative()&&(s["framework.reactnative"]=1),this.reportStats(s)},o.prototype.shouldReconnect_=function(){var s=OnlineMonitor.getInstance().currentlyOnline();return index_cjsExports$1.isEmpty(this.interruptReasons_)&&s},o.nextPersistentConnectionId_=0,o.nextConnectionId_=0,o}(ServerActions);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ReadonlyRestClient=function(l){__extends$1(o,l);function o(s,c,h){var d=l.call(this)||this;return d.repoInfo_=s,d.onDataUpdate_=c,d.authTokenProvider_=h,d.log_=logWrapper("p:rest:"),d.listens_={},d}return o.prototype.reportStats=function(s){throw new Error("Method not implemented.")},o.getListenId_=function(s,c){return c!==void 0?"tag$"+c:(index_cjsExports$1.assert(s.getQueryParams().isDefault(),"should have a tag if it's not a default query."),s.path.toString())},o.prototype.listen=function(s,c,h,d){var p=this,Co=s.path.toString();this.log_("Listen called for "+Co+" "+s.queryIdentifier());var Bo=o.getListenId_(s,h),Lo={};this.listens_[Bo]=Lo;var Uo=s.getQueryParams().toRestQueryStringParameters();this.restRequest_(Co+".json",Uo,function(Qo,Po){var Mo=Po;if(Qo===404&&(Mo=null,Qo=null),Qo===null&&p.onDataUpdate_(Co,Mo,!1,h),index_cjsExports$1.safeGet(p.listens_,Bo)===Lo){var Go;Qo?Qo===401?Go="permission_denied":Go="rest_error:"+Qo:Go="ok",d(Go,null)}})},o.prototype.unlisten=function(s,c){var h=o.getListenId_(s,c);delete this.listens_[h]},o.prototype.refreshAuthToken=function(s){},o.prototype.restRequest_=function(s,c,h){var d=this;c===void 0&&(c={}),c.format="export",this.authTokenProvider_.getToken(!1).then(function(p){var Co=p&&p.accessToken;Co&&(c.auth=Co);var Bo=(d.repoInfo_.secure?"https://":"http://")+d.repoInfo_.host+s+"?ns="+d.repoInfo_.namespace+index_cjsExports$1.querystring(c);d.log_("Sending REST request for "+Bo);var Lo=new XMLHttpRequest;Lo.onreadystatechange=function(){if(h&&Lo.readyState===4){d.log_("REST Response for "+Bo+" received. status:",Lo.status,"response:",Lo.responseText);var Uo=null;if(Lo.status>=200&&Lo.status<300){try{Uo=index_cjsExports$1.jsonEval(Lo.responseText)}catch{warn("Failed to parse JSON response for "+Bo+": "+Lo.responseText)}h(null,Uo)}else Lo.status!==401&&Lo.status!==404&&warn("Got unsuccessful REST response for "+Bo+" Status: "+Lo.status),h(Lo.status);h=null}},Lo.open("GET",Bo,!0),Lo.send()})},o}(ServerActions);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var INTERRUPT_REASON="repo_interrupt",Repo=function(){function l(o,s,c,h){var d=this;this.repoInfo_=o,this.app=c,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new SparseSnapshotTree,this.persistentConnection_=null;var p=new AuthTokenProvider(c,h);if(this.stats_=StatsManager.getCollection(o),s||beingCrawled())this.server_=new ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),p),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var Co=c.options.databaseAuthVariableOverride;if(typeof Co<"u"&&Co!==null){if(typeof Co!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{index_cjsExports$1.stringify(Co)}catch(Bo){throw new Error("Invalid authOverride provided: "+Bo)}}this.persistentConnection_=new PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),p,Co),this.server_=this.persistentConnection_}p.addTokenChangeListener(function(Bo){d.server_.refreshAuthToken(Bo)}),this.statsReporter_=StatsManager.getOrCreateReporter(o,function(){return new StatsReporter(d.stats_,d.server_)}),this.transactionsInit_(),this.infoData_=new SnapshotHolder,this.infoSyncTree_=new SyncTree({startListening:function(Bo,Lo,Uo,Qo){var Po=[],Mo=d.infoData_.getNode(Bo.path);return Mo.isEmpty()||(Po=d.infoSyncTree_.applyServerOverwrite(Bo.path,Mo),setTimeout(function(){Qo("ok")},0)),Po},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new SyncTree({startListening:function(Bo,Lo,Uo,Qo){return d.server_.listen(Bo,Uo,Lo,function(Po,Mo){var Go=Qo(Po,Mo);d.eventQueue_.raiseEventsForChangedPath(Bo.path,Go)}),[]},stopListening:function(Bo,Lo){d.server_.unlisten(Bo,Lo)}})}return l.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},l.prototype.name=function(){return this.repoInfo_.namespace},l.prototype.serverTime=function(){var o=this.infoData_.getNode(new Path(".info/serverTimeOffset")),s=o.val()||0;return new Date().getTime()+s},l.prototype.generateServerValues=function(){return generateWithValues({timestamp:this.serverTime()})},l.prototype.onDataUpdate_=function(o,s,c,h){this.dataUpdateCount++;var d=new Path(o);s=this.interceptServerDataCallback_?this.interceptServerDataCallback_(o,s):s;var p=[];if(h)if(c){var Co=index_cjsExports$1.map(s,function(Po){return nodeFromJSON$1(Po)});p=this.serverSyncTree_.applyTaggedQueryMerge(d,Co,h)}else{var Bo=nodeFromJSON$1(s);p=this.serverSyncTree_.applyTaggedQueryOverwrite(d,Bo,h)}else if(c){var Lo=index_cjsExports$1.map(s,function(Po){return nodeFromJSON$1(Po)});p=this.serverSyncTree_.applyServerMerge(d,Lo)}else{var Uo=nodeFromJSON$1(s);p=this.serverSyncTree_.applyServerOverwrite(d,Uo)}var Qo=d;p.length>0&&(Qo=this.rerunTransactions_(d)),this.eventQueue_.raiseEventsForChangedPath(Qo,p)},l.prototype.interceptServerData_=function(o){this.interceptServerDataCallback_=o},l.prototype.onConnectStatus_=function(o){this.updateInfo_("connected",o),o===!1&&this.runOnDisconnectEvents_()},l.prototype.onServerInfoUpdate_=function(o){var s=this;each$1(o,function(c,h){s.updateInfo_(c,h)})},l.prototype.updateInfo_=function(o,s){var c=new Path("/.info/"+o),h=nodeFromJSON$1(s);this.infoData_.updateSnapshot(c,h);var d=this.infoSyncTree_.applyServerOverwrite(c,h);this.eventQueue_.raiseEventsForChangedPath(c,d)},l.prototype.getNextWriteId_=function(){return this.nextWriteId_++},l.prototype.setWithPriority=function(o,s,c,h){var d=this;this.log_("set",{path:o.toString(),value:s,priority:c});var p=this.generateServerValues(),Co=nodeFromJSON$1(s,c),Bo=this.serverSyncTree_.calcCompleteEventCache(o),Lo=resolveDeferredValueSnapshot(Co,Bo,p),Uo=this.getNextWriteId_(),Qo=this.serverSyncTree_.applyUserOverwrite(o,Lo,Uo,!0);this.eventQueue_.queueEvents(Qo),this.server_.put(o.toString(),Co.val(!0),function(Mo,Go){var $o=Mo==="ok";$o||warn("set at "+o+" failed: "+Mo);var jo=d.serverSyncTree_.ackUserWrite(Uo,!$o);d.eventQueue_.raiseEventsForChangedPath(o,jo),d.callOnCompleteCallback(h,Mo,Go)});var Po=this.abortTransactions_(o);this.rerunTransactions_(Po),this.eventQueue_.raiseEventsForChangedPath(Po,[])},l.prototype.update=function(o,s,c){var h=this;this.log_("update",{path:o.toString(),value:s});var d=!0,p=this.generateServerValues(),Co={};if(each$1(s,function(Uo,Qo){d=!1,Co[Uo]=resolveDeferredValueTree(o.child(Uo),nodeFromJSON$1(Qo),h.serverSyncTree_,p)}),d)log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(c,"ok");else{var Bo=this.getNextWriteId_(),Lo=this.serverSyncTree_.applyUserMerge(o,Co,Bo);this.eventQueue_.queueEvents(Lo),this.server_.merge(o.toString(),s,function(Uo,Qo){var Po=Uo==="ok";Po||warn("update at "+o+" failed: "+Uo);var Mo=h.serverSyncTree_.ackUserWrite(Bo,!Po),Go=Mo.length>0?h.rerunTransactions_(o):o;h.eventQueue_.raiseEventsForChangedPath(Go,Mo),h.callOnCompleteCallback(c,Uo,Qo)}),each$1(s,function(Uo){var Qo=h.abortTransactions_(o.child(Uo));h.rerunTransactions_(Qo)}),this.eventQueue_.raiseEventsForChangedPath(o,[])}},l.prototype.runOnDisconnectEvents_=function(){var o=this;this.log_("onDisconnectEvents");var s=this.generateServerValues(),c=new SparseSnapshotTree;this.onDisconnect_.forEachTree(Path.Empty,function(d,p){var Co=resolveDeferredValueTree(d,p,o.serverSyncTree_,s);c.remember(d,Co)});var h=[];c.forEachTree(Path.Empty,function(d,p){h=h.concat(o.serverSyncTree_.applyServerOverwrite(d,p));var Co=o.abortTransactions_(d);o.rerunTransactions_(Co)}),this.onDisconnect_=new SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(Path.Empty,h)},l.prototype.onDisconnectCancel=function(o,s){var c=this;this.server_.onDisconnectCancel(o.toString(),function(h,d){h==="ok"&&c.onDisconnect_.forget(o),c.callOnCompleteCallback(s,h,d)})},l.prototype.onDisconnectSet=function(o,s,c){var h=this,d=nodeFromJSON$1(s);this.server_.onDisconnectPut(o.toString(),d.val(!0),function(p,Co){p==="ok"&&h.onDisconnect_.remember(o,d),h.callOnCompleteCallback(c,p,Co)})},l.prototype.onDisconnectSetWithPriority=function(o,s,c,h){var d=this,p=nodeFromJSON$1(s,c);this.server_.onDisconnectPut(o.toString(),p.val(!0),function(Co,Bo){Co==="ok"&&d.onDisconnect_.remember(o,p),d.callOnCompleteCallback(h,Co,Bo)})},l.prototype.onDisconnectUpdate=function(o,s,c){var h=this;if(index_cjsExports$1.isEmpty(s)){log("onDisconnect().update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(c,"ok");return}this.server_.onDisconnectMerge(o.toString(),s,function(d,p){d==="ok"&&each$1(s,function(Co,Bo){var Lo=nodeFromJSON$1(Bo);h.onDisconnect_.remember(o.child(Co),Lo)}),h.callOnCompleteCallback(c,d,p)})},l.prototype.addEventCallbackForQuery=function(o,s){var c;o.path.getFront()===".info"?c=this.infoSyncTree_.addEventRegistration(o,s):c=this.serverSyncTree_.addEventRegistration(o,s),this.eventQueue_.raiseEventsAtPath(o.path,c)},l.prototype.removeEventCallbackForQuery=function(o,s){var c;o.path.getFront()===".info"?c=this.infoSyncTree_.removeEventRegistration(o,s):c=this.serverSyncTree_.removeEventRegistration(o,s),this.eventQueue_.raiseEventsAtPath(o.path,c)},l.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(INTERRUPT_REASON)},l.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(INTERRUPT_REASON)},l.prototype.stats=function(o){if(o===void 0&&(o=!1),!(typeof console>"u")){var s;o?(this.statsListener_||(this.statsListener_=new StatsListener(this.stats_)),s=this.statsListener_.get()):s=this.stats_.get();var c=Object.keys(s).reduce(function(h,d){return Math.max(d.length,h)},0);each$1(s,function(h,d){for(var p=h,Co=h.length;Co<c+2;Co++)p+=" ";console.log(p+d)})}},l.prototype.statsIncrementCounter=function(o){this.stats_.incrementCounter(o),this.statsReporter_.includeStat(o)},l.prototype.log_=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var c="";this.persistentConnection_&&(c=this.persistentConnection_.id+":"),log.apply(void 0,__spread([c],o))},l.prototype.callOnCompleteCallback=function(o,s,c){o&&exceptionGuard(function(){if(s==="ok")o(null);else{var h=(s||"error").toUpperCase(),d=h;c&&(d+=": "+c);var p=new Error(d);p.code=h,o(p)}})},Object.defineProperty(l.prototype,"database",{get:function(){return this.__database||(this.__database=new Database(this))},enumerable:!0,configurable:!0}),l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var RangedFilter=function(){function l(o){this.indexedFilter_=new IndexedFilter(o.getIndex()),this.index_=o.getIndex(),this.startPost_=l.getStartPost_(o),this.endPost_=l.getEndPost_(o)}return l.prototype.getStartPost=function(){return this.startPost_},l.prototype.getEndPost=function(){return this.endPost_},l.prototype.matches=function(o){return this.index_.compare(this.getStartPost(),o)<=0&&this.index_.compare(o,this.getEndPost())<=0},l.prototype.updateChild=function(o,s,c,h,d,p){return this.matches(new NamedNode(s,c))||(c=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(o,s,c,h,d,p)},l.prototype.updateFullNode=function(o,s,c){s.isLeafNode()&&(s=ChildrenNode.EMPTY_NODE);var h=s.withIndex(this.index_);h=h.updatePriority(ChildrenNode.EMPTY_NODE);var d=this;return s.forEachChild(PRIORITY_INDEX,function(p,Co){d.matches(new NamedNode(p,Co))||(h=h.updateImmediateChild(p,ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(o,h,c)},l.prototype.updatePriority=function(o,s){return o},l.prototype.filtersNodes=function(){return!0},l.prototype.getIndexedFilter=function(){return this.indexedFilter_},l.prototype.getIndex=function(){return this.index_},l.getStartPost_=function(o){if(o.hasStart()){var s=o.getIndexStartName();return o.getIndex().makePost(o.getIndexStartValue(),s)}else return o.getIndex().minPost()},l.getEndPost_=function(o){if(o.hasEnd()){var s=o.getIndexEndName();return o.getIndex().makePost(o.getIndexEndValue(),s)}else return o.getIndex().maxPost()},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LimitedFilter=function(){function l(o){this.rangedFilter_=new RangedFilter(o),this.index_=o.getIndex(),this.limit_=o.getLimit(),this.reverse_=!o.isViewFromLeft()}return l.prototype.updateChild=function(o,s,c,h,d,p){return this.rangedFilter_.matches(new NamedNode(s,c))||(c=ChildrenNode.EMPTY_NODE),o.getImmediateChild(s).equals(c)?o:o.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(o,s,c,h,d,p):this.fullLimitUpdateChild_(o,s,c,d,p)},l.prototype.updateFullNode=function(o,s,c){var h;if(s.isLeafNode()||s.isEmpty())h=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<s.numChildren()&&s.isIndexed(this.index_)){h=ChildrenNode.EMPTY_NODE.withIndex(this.index_);var d=void 0;this.reverse_?d=s.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):d=s.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var p=0;d.hasNext()&&p<this.limit_;){var Co=d.getNext(),Bo=void 0;if(this.reverse_?Bo=this.index_.compare(this.rangedFilter_.getStartPost(),Co)<=0:Bo=this.index_.compare(Co,this.rangedFilter_.getEndPost())<=0,Bo)h=h.updateImmediateChild(Co.name,Co.node),p++;else break}}else{h=s.withIndex(this.index_),h=h.updatePriority(ChildrenNode.EMPTY_NODE);var Lo=void 0,Uo=void 0,Qo=void 0,d=void 0;if(this.reverse_){d=h.getReverseIterator(this.index_),Lo=this.rangedFilter_.getEndPost(),Uo=this.rangedFilter_.getStartPost();var Po=this.index_.getCompare();Qo=function(jo,zo){return Po(zo,jo)}}else d=h.getIterator(this.index_),Lo=this.rangedFilter_.getStartPost(),Uo=this.rangedFilter_.getEndPost(),Qo=this.index_.getCompare();for(var p=0,Mo=!1;d.hasNext();){var Co=d.getNext();!Mo&&Qo(Lo,Co)<=0&&(Mo=!0);var Bo=Mo&&p<this.limit_&&Qo(Co,Uo)<=0;Bo?p++:h=h.updateImmediateChild(Co.name,ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(o,h,c)},l.prototype.updatePriority=function(o,s){return o},l.prototype.filtersNodes=function(){return!0},l.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},l.prototype.getIndex=function(){return this.index_},l.prototype.fullLimitUpdateChild_=function(o,s,c,h,d){var p;if(this.reverse_){var Co=this.index_.getCompare();p=function(Xo,Zo){return Co(Zo,Xo)}}else p=this.index_.getCompare();var Bo=o;index_cjsExports$1.assert(Bo.numChildren()===this.limit_,"");var Lo=new NamedNode(s,c),Uo=this.reverse_?Bo.getFirstChild(this.index_):Bo.getLastChild(this.index_),Qo=this.rangedFilter_.matches(Lo);if(Bo.hasChild(s)){for(var Po=Bo.getImmediateChild(s),Mo=h.getChildAfterChild(this.index_,Uo,this.reverse_);Mo!=null&&(Mo.name===s||Bo.hasChild(Mo.name));)Mo=h.getChildAfterChild(this.index_,Mo,this.reverse_);var Go=Mo==null?1:p(Mo,Lo),$o=Qo&&!c.isEmpty()&&Go>=0;if($o)return d!=null&&d.trackChildChange(Change.childChangedChange(s,c,Po)),Bo.updateImmediateChild(s,c);d!=null&&d.trackChildChange(Change.childRemovedChange(s,Po));var jo=Bo.updateImmediateChild(s,ChildrenNode.EMPTY_NODE),zo=Mo!=null&&this.rangedFilter_.matches(Mo);return zo?(d!=null&&d.trackChildChange(Change.childAddedChange(Mo.name,Mo.node)),jo.updateImmediateChild(Mo.name,Mo.node)):jo}else return c.isEmpty()?o:Qo&&p(Uo,Lo)>=0?(d!=null&&(d.trackChildChange(Change.childRemovedChange(Uo.name,Uo.node)),d.trackChildChange(Change.childAddedChange(s,c))),Bo.updateImmediateChild(s,c).updateImmediateChild(Uo.name,ChildrenNode.EMPTY_NODE)):o},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var QueryParams=function(){function l(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}return l.prototype.hasStart=function(){return this.startSet_},l.prototype.isViewFromLeft=function(){return this.viewFrom_===""?this.startSet_:this.viewFrom_===l.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},l.prototype.getIndexStartValue=function(){return index_cjsExports$1.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},l.prototype.getIndexStartName=function(){return index_cjsExports$1.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME},l.prototype.hasEnd=function(){return this.endSet_},l.prototype.getIndexEndValue=function(){return index_cjsExports$1.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},l.prototype.getIndexEndName=function(){return index_cjsExports$1.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME},l.prototype.hasLimit=function(){return this.limitSet_},l.prototype.hasAnchoredLimit=function(){return this.limitSet_&&this.viewFrom_!==""},l.prototype.getLimit=function(){return index_cjsExports$1.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},l.prototype.getIndex=function(){return this.index_},l.prototype.copy_=function(){var o=new l;return o.limitSet_=this.limitSet_,o.limit_=this.limit_,o.startSet_=this.startSet_,o.indexStartValue_=this.indexStartValue_,o.startNameSet_=this.startNameSet_,o.indexStartName_=this.indexStartName_,o.endSet_=this.endSet_,o.indexEndValue_=this.indexEndValue_,o.endNameSet_=this.endNameSet_,o.indexEndName_=this.indexEndName_,o.index_=this.index_,o.viewFrom_=this.viewFrom_,o},l.prototype.limit=function(o){var s=this.copy_();return s.limitSet_=!0,s.limit_=o,s.viewFrom_="",s},l.prototype.limitToFirst=function(o){var s=this.copy_();return s.limitSet_=!0,s.limit_=o,s.viewFrom_=l.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,s},l.prototype.limitToLast=function(o){var s=this.copy_();return s.limitSet_=!0,s.limit_=o,s.viewFrom_=l.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,s},l.prototype.startAt=function(o,s){var c=this.copy_();return c.startSet_=!0,o===void 0&&(o=null),c.indexStartValue_=o,s!=null?(c.startNameSet_=!0,c.indexStartName_=s):(c.startNameSet_=!1,c.indexStartName_=""),c},l.prototype.endAt=function(o,s){var c=this.copy_();return c.endSet_=!0,o===void 0&&(o=null),c.indexEndValue_=o,s!==void 0?(c.endNameSet_=!0,c.indexEndName_=s):(c.endNameSet_=!1,c.indexEndName_=""),c},l.prototype.orderBy=function(o){var s=this.copy_();return s.index_=o,s},l.prototype.getQueryObject=function(){var o=l.WIRE_PROTOCOL_CONSTANTS_,s={};if(this.startSet_&&(s[o.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(s[o.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(s[o.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(s[o.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){s[o.LIMIT]=this.limit_;var c=this.viewFrom_;c===""&&(this.isViewFromLeft()?c=o.VIEW_FROM_LEFT:c=o.VIEW_FROM_RIGHT),s[o.VIEW_FROM]=c}return this.index_!==PRIORITY_INDEX&&(s[o.INDEX]=this.index_.toString()),s},l.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},l.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX},l.prototype.getNodeFilter=function(){return this.loadsAllData()?new IndexedFilter(this.getIndex()):this.hasLimit()?new LimitedFilter(this):new RangedFilter(this)},l.prototype.toRestQueryStringParameters=function(){var o=l.REST_QUERY_CONSTANTS_,s={};if(this.isDefault())return s;var c;return this.index_===PRIORITY_INDEX?c=o.PRIORITY_INDEX:this.index_===VALUE_INDEX?c=o.VALUE_INDEX:this.index_===KEY_INDEX?c=o.KEY_INDEX:(index_cjsExports$1.assert(this.index_ instanceof PathIndex,"Unrecognized index type!"),c=this.index_.toString()),s[o.ORDER_BY]=index_cjsExports$1.stringify(c),this.startSet_&&(s[o.START_AT]=index_cjsExports$1.stringify(this.indexStartValue_),this.startNameSet_&&(s[o.START_AT]+=","+index_cjsExports$1.stringify(this.indexStartName_))),this.endSet_&&(s[o.END_AT]=index_cjsExports$1.stringify(this.indexEndValue_),this.endNameSet_&&(s[o.END_AT]+=","+index_cjsExports$1.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?s[o.LIMIT_TO_FIRST]=this.limit_:s[o.LIMIT_TO_LAST]=this.limit_),s},l.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},l.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},l.DEFAULT=new l,l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Reference=function(l){__extends$1(o,l);function o(s,c){var h=this;if(!(s instanceof Repo))throw new Error("new Reference() no longer supported - use app.database().");return h=l.call(this,s,c,QueryParams.DEFAULT,!1)||this,h}return o.prototype.getKey=function(){return index_cjsExports$1.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},o.prototype.child=function(s){return index_cjsExports$1.validateArgCount("Reference.child",1,1,arguments.length),typeof s=="number"?s=String(s):s instanceof Path||(this.path.getFront()===null?validateRootPathString("Reference.child",1,s,!1):validatePathString("Reference.child",1,s,!1)),new o(this.repo,this.path.child(s))},o.prototype.getParent=function(){index_cjsExports$1.validateArgCount("Reference.parent",0,0,arguments.length);var s=this.path.parent();return s===null?null:new o(this.repo,s)},o.prototype.getRoot=function(){index_cjsExports$1.validateArgCount("Reference.root",0,0,arguments.length);for(var s=this;s.getParent()!==null;)s=s.getParent();return s},o.prototype.databaseProp=function(){return this.repo.database},o.prototype.set=function(s,c){index_cjsExports$1.validateArgCount("Reference.set",1,2,arguments.length),validateWritablePath("Reference.set",this.path),validateFirebaseDataArg("Reference.set",1,s,this.path,!1),index_cjsExports$1.validateCallback("Reference.set",2,c,!0);var h=new index_cjsExports$1.Deferred;return this.repo.setWithPriority(this.path,s,null,h.wrapCallback(c)),h.promise},o.prototype.update=function(s,c){if(index_cjsExports$1.validateArgCount("Reference.update",1,2,arguments.length),validateWritablePath("Reference.update",this.path),Array.isArray(s)){for(var h={},d=0;d<s.length;++d)h[""+d]=s[d];s=h,warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateFirebaseMergeDataArg("Reference.update",1,s,this.path,!1),index_cjsExports$1.validateCallback("Reference.update",2,c,!0);var p=new index_cjsExports$1.Deferred;return this.repo.update(this.path,s,p.wrapCallback(c)),p.promise},o.prototype.setWithPriority=function(s,c,h){if(index_cjsExports$1.validateArgCount("Reference.setWithPriority",2,3,arguments.length),validateWritablePath("Reference.setWithPriority",this.path),validateFirebaseDataArg("Reference.setWithPriority",1,s,this.path,!1),validatePriority("Reference.setWithPriority",2,c,!1),index_cjsExports$1.validateCallback("Reference.setWithPriority",3,h,!0),this.getKey()===".length"||this.getKey()===".keys")throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var d=new index_cjsExports$1.Deferred;return this.repo.setWithPriority(this.path,s,c,d.wrapCallback(h)),d.promise},o.prototype.remove=function(s){return index_cjsExports$1.validateArgCount("Reference.remove",0,1,arguments.length),validateWritablePath("Reference.remove",this.path),index_cjsExports$1.validateCallback("Reference.remove",1,s,!0),this.set(null,s)},o.prototype.transaction=function(s,c,h){if(index_cjsExports$1.validateArgCount("Reference.transaction",1,3,arguments.length),validateWritablePath("Reference.transaction",this.path),index_cjsExports$1.validateCallback("Reference.transaction",1,s,!1),index_cjsExports$1.validateCallback("Reference.transaction",2,c,!0),validateBoolean("Reference.transaction",3,h,!0),this.getKey()===".length"||this.getKey()===".keys")throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";h===void 0&&(h=!0);var d=new index_cjsExports$1.Deferred;typeof c=="function"&&d.promise.catch(function(){});var p=function(Co,Bo,Lo){Co?d.reject(Co):d.resolve(new TransactionResult(Bo,Lo)),typeof c=="function"&&c(Co,Bo,Lo)};return this.repo.startTransaction(this.path,s,p,h),d.promise},o.prototype.setPriority=function(s,c){index_cjsExports$1.validateArgCount("Reference.setPriority",1,2,arguments.length),validateWritablePath("Reference.setPriority",this.path),validatePriority("Reference.setPriority",1,s,!1),index_cjsExports$1.validateCallback("Reference.setPriority",2,c,!0);var h=new index_cjsExports$1.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),s,null,h.wrapCallback(c)),h.promise},o.prototype.push=function(s,c){index_cjsExports$1.validateArgCount("Reference.push",0,2,arguments.length),validateWritablePath("Reference.push",this.path),validateFirebaseDataArg("Reference.push",1,s,this.path,!0),index_cjsExports$1.validateCallback("Reference.push",2,c,!0);var h=this.repo.serverTime(),d=nextPushId(h),p=this.child(d),Co=this.child(d),Bo;return s!=null?Bo=p.set(s,c).then(function(){return Co}):Bo=Promise.resolve(Co),p.then=Bo.then.bind(Bo),p.catch=Bo.then.bind(Bo,void 0),typeof c=="function"&&Bo.catch(function(){}),p},o.prototype.onDisconnect=function(){return validateWritablePath("Reference.onDisconnect",this.path),new OnDisconnect(this.repo,this.path)},Object.defineProperty(o.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),o}(Query);Query.__referenceConstructor=Reference;SyncPoint.__referenceConstructor=Reference;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var TreeNode=function(){function l(){this.children={},this.childCount=0,this.value=null}return l}(),Tree=function(){function l(o,s,c){o===void 0&&(o=""),s===void 0&&(s=null),c===void 0&&(c=new TreeNode),this.name_=o,this.parent_=s,this.node_=c}return l.prototype.subTree=function(o){for(var s=o instanceof Path?o:new Path(o),c=this,h=s.getFront();h!==null;){var d=index_cjsExports$1.safeGet(c.node_.children,h)||new TreeNode;c=new l(h,c,d),s=s.popFront(),h=s.getFront()}return c},l.prototype.getValue=function(){return this.node_.value},l.prototype.setValue=function(o){index_cjsExports$1.assert(typeof o<"u","Cannot set value to undefined"),this.node_.value=o,this.updateParents_()},l.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},l.prototype.hasChildren=function(){return this.node_.childCount>0},l.prototype.isEmpty=function(){return this.getValue()===null&&!this.hasChildren()},l.prototype.forEachChild=function(o){var s=this;each$1(this.node_.children,function(c,h){o(new l(c,s,h))})},l.prototype.forEachDescendant=function(o,s,c){s&&!c&&o(this),this.forEachChild(function(h){h.forEachDescendant(o,!0,c)}),s&&c&&o(this)},l.prototype.forEachAncestor=function(o,s){for(var c=s?this:this.parent();c!==null;){if(o(c))return!0;c=c.parent()}return!1},l.prototype.forEachImmediateDescendantWithValue=function(o){this.forEachChild(function(s){s.getValue()!==null?o(s):s.forEachImmediateDescendantWithValue(o)})},l.prototype.path=function(){return new Path(this.parent_===null?this.name_:this.parent_.path()+"/"+this.name_)},l.prototype.name=function(){return this.name_},l.prototype.parent=function(){return this.parent_},l.prototype.updateParents_=function(){this.parent_!==null&&this.parent_.updateChild_(this.name_,this)},l.prototype.updateChild_=function(o,s){var c=s.isEmpty(),h=index_cjsExports$1.contains(this.node_.children,o);c&&h?(delete this.node_.children[o],this.node_.childCount--,this.updateParents_()):!c&&!h&&(this.node_.children[o]=s.node_,this.node_.childCount++,this.updateParents_())},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var TransactionStatus;(function(l){l[l.RUN=0]="RUN",l[l.SENT=1]="SENT",l[l.COMPLETED=2]="COMPLETED",l[l.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",l[l.NEEDS_ABORT=4]="NEEDS_ABORT"})(TransactionStatus||(TransactionStatus={}));Repo.MAX_TRANSACTION_RETRIES_=25;Repo.prototype.transactionsInit_=function(){this.transactionQueueTree_=new Tree};Repo.prototype.startTransaction=function(l,o,s,c){this.log_("transaction on "+l);var h=function(){},d=new Reference(this,l);d.on("value",h);var p=function(){d.off("value",h)},Co={path:l,update:o,onComplete:s,status:null,order:LUIDGenerator(),applyLocally:c,retryCount:0,unwatcher:p,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},Bo=this.getLatestState_(l);Co.currentInputSnapshot=Bo;var Lo=Co.update(Bo.val());if(Lo===void 0){if(Co.unwatcher(),Co.currentOutputSnapshotRaw=null,Co.currentOutputSnapshotResolved=null,Co.onComplete){var Uo=new DataSnapshot(Co.currentInputSnapshot,new Reference(this,Co.path),PRIORITY_INDEX);Co.onComplete(null,!1,Uo)}}else{validateFirebaseData("transaction failed: Data returned ",Lo,Co.path),Co.status=TransactionStatus.RUN;var Qo=this.transactionQueueTree_.subTree(l),Po=Qo.getValue()||[];Po.push(Co),Qo.setValue(Po);var Mo=void 0;if(typeof Lo=="object"&&Lo!==null&&index_cjsExports$1.contains(Lo,".priority"))Mo=index_cjsExports$1.safeGet(Lo,".priority"),index_cjsExports$1.assert(isValidPriority(Mo),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{var Go=this.serverSyncTree_.calcCompleteEventCache(l)||ChildrenNode.EMPTY_NODE;Mo=Go.getPriority().val()}Mo=Mo;var $o=this.generateServerValues(),jo=nodeFromJSON$1(Lo,Mo),zo=resolveDeferredValueSnapshot(jo,Bo,$o);Co.currentOutputSnapshotRaw=jo,Co.currentOutputSnapshotResolved=zo,Co.currentWriteId=this.getNextWriteId_();var Xo=this.serverSyncTree_.applyUserOverwrite(l,zo,Co.currentWriteId,Co.applyLocally);this.eventQueue_.raiseEventsForChangedPath(l,Xo),this.sendReadyTransactions_()}};Repo.prototype.getLatestState_=function(l,o){return this.serverSyncTree_.calcCompleteEventCache(l,o)||ChildrenNode.EMPTY_NODE};Repo.prototype.sendReadyTransactions_=function(l){var o=this;if(l===void 0&&(l=this.transactionQueueTree_),l||this.pruneCompletedTransactionsBelowNode_(l),l.getValue()!==null){var s=this.buildTransactionQueue_(l);index_cjsExports$1.assert(s.length>0,"Sending zero length transaction queue");var c=s.every(function(h){return h.status===TransactionStatus.RUN});c&&this.sendTransactionQueue_(l.path(),s)}else l.hasChildren()&&l.forEachChild(function(h){o.sendReadyTransactions_(h)})};Repo.prototype.sendTransactionQueue_=function(l,o){for(var s=this,c=o.map(function(Po){return Po.currentWriteId}),h=this.getLatestState_(l,c),d=h,p=h.hash(),Co=0;Co<o.length;Co++){var Bo=o[Co];index_cjsExports$1.assert(Bo.status===TransactionStatus.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),Bo.status=TransactionStatus.SENT,Bo.retryCount++;var Lo=Path.relativePath(l,Bo.path);d=d.updateChild(Lo,Bo.currentOutputSnapshotRaw)}var Uo=d.val(!0),Qo=l;this.server_.put(Qo.toString(),Uo,function(Po){s.log_("transaction put response",{path:Qo.toString(),status:Po});var Mo=[];if(Po==="ok"){for(var Go=[],$o=0;$o<o.length;$o++){if(o[$o].status=TransactionStatus.COMPLETED,Mo=Mo.concat(s.serverSyncTree_.ackUserWrite(o[$o].currentWriteId)),o[$o].onComplete){var jo=o[$o].currentOutputSnapshotResolved,zo=new Reference(s,o[$o].path),Xo=new DataSnapshot(jo,zo,PRIORITY_INDEX);Go.push(o[$o].onComplete.bind(null,null,!0,Xo))}o[$o].unwatcher()}s.pruneCompletedTransactionsBelowNode_(s.transactionQueueTree_.subTree(l)),s.sendReadyTransactions_(),s.eventQueue_.raiseEventsForChangedPath(l,Mo);for(var $o=0;$o<Go.length;$o++)exceptionGuard(Go[$o])}else{if(Po==="datastale")for(var $o=0;$o<o.length;$o++)o[$o].status===TransactionStatus.SENT_NEEDS_ABORT?o[$o].status=TransactionStatus.NEEDS_ABORT:o[$o].status=TransactionStatus.RUN;else{warn("transaction at "+Qo.toString()+" failed: "+Po);for(var $o=0;$o<o.length;$o++)o[$o].status=TransactionStatus.NEEDS_ABORT,o[$o].abortReason=Po}s.rerunTransactions_(l)}},p)};Repo.prototype.rerunTransactions_=function(l){var o=this.getAncestorTransactionNode_(l),s=o.path(),c=this.buildTransactionQueue_(o);return this.rerunTransactionQueue_(c,s),s};Repo.prototype.rerunTransactionQueue_=function(l,o){if(l.length!==0){for(var s=[],c=[],h=l.filter(function(es){return es.status===TransactionStatus.RUN}),d=h.map(function(es){return es.currentWriteId}),p=0;p<l.length;p++){var Co=l[p],Bo=Path.relativePath(o,Co.path),Lo=!1,Uo=void 0;if(index_cjsExports$1.assert(Bo!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),Co.status===TransactionStatus.NEEDS_ABORT)Lo=!0,Uo=Co.abortReason,c=c.concat(this.serverSyncTree_.ackUserWrite(Co.currentWriteId,!0));else if(Co.status===TransactionStatus.RUN)if(Co.retryCount>=Repo.MAX_TRANSACTION_RETRIES_)Lo=!0,Uo="maxretry",c=c.concat(this.serverSyncTree_.ackUserWrite(Co.currentWriteId,!0));else{var Qo=this.getLatestState_(Co.path,d);Co.currentInputSnapshot=Qo;var Po=l[p].update(Qo.val());if(Po!==void 0){validateFirebaseData("transaction failed: Data returned ",Po,Co.path);var Mo=nodeFromJSON$1(Po),Go=typeof Po=="object"&&Po!=null&&index_cjsExports$1.contains(Po,".priority");Go||(Mo=Mo.updatePriority(Qo.getPriority()));var $o=Co.currentWriteId,jo=this.generateServerValues(),zo=resolveDeferredValueSnapshot(Mo,Qo,jo);Co.currentOutputSnapshotRaw=Mo,Co.currentOutputSnapshotResolved=zo,Co.currentWriteId=this.getNextWriteId_(),d.splice(d.indexOf($o),1),c=c.concat(this.serverSyncTree_.applyUserOverwrite(Co.path,zo,Co.currentWriteId,Co.applyLocally)),c=c.concat(this.serverSyncTree_.ackUserWrite($o,!0))}else Lo=!0,Uo="nodata",c=c.concat(this.serverSyncTree_.ackUserWrite(Co.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(o,c),c=[],Lo&&(l[p].status=TransactionStatus.COMPLETED,function(es){setTimeout(es,Math.floor(0))}(l[p].unwatcher),l[p].onComplete))if(Uo==="nodata"){var Xo=new Reference(this,l[p].path),Zo=l[p].currentInputSnapshot,Wo=new DataSnapshot(Zo,Xo,PRIORITY_INDEX);s.push(l[p].onComplete.bind(null,null,!1,Wo))}else s.push(l[p].onComplete.bind(null,new Error(Uo),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(var p=0;p<s.length;p++)exceptionGuard(s[p]);this.sendReadyTransactions_()}};Repo.prototype.getAncestorTransactionNode_=function(l){var o,s=this.transactionQueueTree_;for(o=l.getFront();o!==null&&s.getValue()===null;)s=s.subTree(o),l=l.popFront(),o=l.getFront();return s};Repo.prototype.buildTransactionQueue_=function(l){var o=[];return this.aggregateTransactionQueuesForNode_(l,o),o.sort(function(s,c){return s.order-c.order}),o};Repo.prototype.aggregateTransactionQueuesForNode_=function(l,o){var s=this,c=l.getValue();if(c!==null)for(var h=0;h<c.length;h++)o.push(c[h]);l.forEachChild(function(d){s.aggregateTransactionQueuesForNode_(d,o)})};Repo.prototype.pruneCompletedTransactionsBelowNode_=function(l){var o=this,s=l.getValue();if(s){for(var c=0,h=0;h<s.length;h++)s[h].status!==TransactionStatus.COMPLETED&&(s[c]=s[h],c++);s.length=c,l.setValue(s.length>0?s:null)}l.forEachChild(function(d){o.pruneCompletedTransactionsBelowNode_(d)})};Repo.prototype.abortTransactions_=function(l){var o=this,s=this.getAncestorTransactionNode_(l).path(),c=this.transactionQueueTree_.subTree(l);return c.forEachAncestor(function(h){o.abortTransactionsOnNode_(h)}),this.abortTransactionsOnNode_(c),c.forEachDescendant(function(h){o.abortTransactionsOnNode_(h)}),s};Repo.prototype.abortTransactionsOnNode_=function(l){var o=l.getValue();if(o!==null){for(var s=[],c=[],h=-1,d=0;d<o.length;d++)if(o[d].status!==TransactionStatus.SENT_NEEDS_ABORT){if(o[d].status===TransactionStatus.SENT)index_cjsExports$1.assert(h===d-1,"All SENT items should be at beginning of queue."),h=d,o[d].status=TransactionStatus.SENT_NEEDS_ABORT,o[d].abortReason="set";else if(index_cjsExports$1.assert(o[d].status===TransactionStatus.RUN,"Unexpected transaction status in abort"),o[d].unwatcher(),c=c.concat(this.serverSyncTree_.ackUserWrite(o[d].currentWriteId,!0)),o[d].onComplete){var p=null;s.push(o[d].onComplete.bind(null,new Error("set"),!1,p))}}h===-1?l.setValue(null):o.length=h+1,this.eventQueue_.raiseEventsForChangedPath(l.path(),c);for(var d=0;d<s.length;d++)exceptionGuard(s[d])}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var DATABASE_URL_OPTION="databaseURL",FIREBASE_DATABASE_EMULATOR_HOST_VAR="FIREBASE_DATABASE_EMULATOR_HOST",_staticInstance,RepoManager=function(){function l(){this.repos_={},this.useRestClient_=!1}return l.getInstance=function(){return _staticInstance||(_staticInstance=new l),_staticInstance},l.prototype.interrupt=function(){var o,s,c,h;try{for(var d=__values$1(Object.keys(this.repos_)),p=d.next();!p.done;p=d.next()){var Co=p.value;try{for(var Bo=(c=void 0,__values$1(Object.keys(this.repos_[Co]))),Lo=Bo.next();!Lo.done;Lo=Bo.next()){var Uo=Lo.value;this.repos_[Co][Uo].interrupt()}}catch(Qo){c={error:Qo}}finally{try{Lo&&!Lo.done&&(h=Bo.return)&&h.call(Bo)}finally{if(c)throw c.error}}}}catch(Qo){o={error:Qo}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}},l.prototype.resume=function(){var o,s,c,h;try{for(var d=__values$1(Object.keys(this.repos_)),p=d.next();!p.done;p=d.next()){var Co=p.value;try{for(var Bo=(c=void 0,__values$1(Object.keys(this.repos_[Co]))),Lo=Bo.next();!Lo.done;Lo=Bo.next()){var Uo=Lo.value;this.repos_[Co][Uo].resume()}}catch(Qo){c={error:Qo}}finally{try{Lo&&!Lo.done&&(h=Bo.return)&&h.call(Bo)}finally{if(c)throw c.error}}}}catch(Qo){o={error:Qo}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}},l.prototype.databaseFromApp=function(o,s,c){var h=c||o.options[DATABASE_URL_OPTION];h===void 0&&fatal("Can't determine Firebase Database URL.  Be sure to include "+DATABASE_URL_OPTION+" option when calling firebase.initializeApp().");var d=parseRepoInfo(h),p=d.repoInfo,Co=void 0;typeof process<"u"&&(Co=process.env[FIREBASE_DATABASE_EMULATOR_HOST_VAR]),Co&&(h="http://"+Co+"?ns="+p.namespace,d=parseRepoInfo(h),p=d.repoInfo),validateUrl("Invalid Firebase Database URL",1,d),d.path.isEmpty()||fatal("Database URL must point to the root of a Firebase Database (not including a child path).");var Bo=this.createRepo(p,o,s);return Bo.database},l.prototype.deleteRepo=function(o){var s=index_cjsExports$1.safeGet(this.repos_,o.app.name);(!s||index_cjsExports$1.safeGet(s,o.repoInfo_.toURLString())!==o)&&fatal("Database "+o.app.name+"("+o.repoInfo_+") has already been deleted."),o.interrupt(),delete s[o.repoInfo_.toURLString()]},l.prototype.createRepo=function(o,s,c){var h=index_cjsExports$1.safeGet(this.repos_,s.name);h||(h={},this.repos_[s.name]=h);var d=index_cjsExports$1.safeGet(h,o.toURLString());return d&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),d=new Repo(o,this.useRestClient_,s,c),h[o.toURLString()]=d,d},l.prototype.forceRestClient=function(o){this.useRestClient_=o},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Database=function(){function l(o){this.repo_=o,o instanceof Repo||fatal("Don't call new Database() directly - please use firebase.database()."),this.root_=new Reference(o,Path.Empty),this.INTERNAL=new DatabaseInternals(this)}return Object.defineProperty(l.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),l.prototype.ref=function(o){return this.checkDeleted_("ref"),index_cjsExports$1.validateArgCount("database.ref",0,1,arguments.length),o instanceof Reference?this.refFromURL(o.toString()):o!==void 0?this.root_.child(o):this.root_},l.prototype.refFromURL=function(o){var s="database.refFromURL";this.checkDeleted_(s),index_cjsExports$1.validateArgCount(s,1,1,arguments.length);var c=parseRepoInfo(o);validateUrl(s,1,c);var h=c.repoInfo;return h.host!==this.repo_.repoInfo_.host&&fatal(s+": Host name does not match the current database: (found "+h.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(c.path.toString())},l.prototype.checkDeleted_=function(o){this.repo_===null&&fatal("Cannot call "+o+" on a deleted database.")},l.prototype.goOffline=function(){index_cjsExports$1.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},l.prototype.goOnline=function(){index_cjsExports$1.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},l.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(o){return{".sv":{increment:o}}}},l}(),DatabaseInternals=function(){function l(o){this.database=o}return l.prototype.delete=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(o){return this.database.checkDeleted_("delete"),RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},l}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var forceLongPolling=function(){WebSocketConnection.forceDisallow(),BrowserPollConnection.forceAllow()},forceWebSockets=function(){BrowserPollConnection.forceDisallow()},isWebSocketsAvailable=function(){return WebSocketConnection.isAvailable()},setSecurityDebugCallback=function(l,o){l.repo.persistentConnection_.securityDebugCallback_=o},stats=function(l,o){l.repo.stats(o)},statsIncrementCounter=function(l,o){l.repo.statsIncrementCounter(o)},dataUpdateCount=function(l){return l.repo.dataUpdateCount},interceptServerData=function(l,o){return l.repo.interceptServerData_(o)},INTERNAL=Object.freeze({__proto__:null,forceLongPolling,forceWebSockets,isWebSocketsAvailable,setSecurityDebugCallback,stats,statsIncrementCounter,dataUpdateCount,interceptServerData});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var DataConnection=PersistentConnection;PersistentConnection.prototype.simpleListen=function(l,o){this.sendRequest("q",{p:l},o)};PersistentConnection.prototype.echo=function(l,o){this.sendRequest("echo",{d:l},o)};var RealTimeConnection=Connection,hijackHash=function(l){var o=PersistentConnection.prototype.put;return PersistentConnection.prototype.put=function(s,c,h,d){d!==void 0&&(d=l()),o.call(this,s,c,h,d)},function(){PersistentConnection.prototype.put=o}},ConnectionTarget=RepoInfo,queryIdentifier=function(l){return l.queryIdentifier()},forceRestClient=function(l){RepoManager.getInstance().forceRestClient(l)},TEST_ACCESS=Object.freeze({__proto__:null,DataConnection,RealTimeConnection,hijackHash,ConnectionTarget,queryIdentifier,forceRestClient}),name$1="@firebase/database",version$1="0.6.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ServerValue$1=Database.ServerValue;function registerDatabase(l){setSDKVersion(l.SDK_VERSION);var o=l.INTERNAL.registerComponent(new index_cjsExports.Component("database",function(s,c){var h=s.getProvider("app").getImmediate(),d=s.getProvider("auth-internal");return RepoManager.getInstance().databaseFromApp(h,d,c)},"PUBLIC").setServiceProps({Reference,Query,Database,DataSnapshot,enableLogging,INTERNAL,ServerValue:ServerValue$1,TEST_ACCESS}).setMultipleInstances(!0));l.registerVersion(name$1,version$1),index_cjsExports$1.isNodeSdk()&&(module.exports=o)}registerDatabase(index_cjsExports$2);(function(l,o){(function(s,c){c(requireIndex_cjs())})(commonjsGlobal$1,function(s){try{(function(){s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,function(){var c,h=typeof Object.defineProperties=="function"?Object.defineProperty:function(Fo,Oo,Ho){Fo!=Array.prototype&&Fo!=Object.prototype&&(Fo[Oo]=Ho.value)},d=function(Fo){Fo=[typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal$1=="object"&&commonjsGlobal$1,Fo];for(var Oo=0;Oo<Fo.length;++Oo){var Ho=Fo[Oo];if(Ho&&Ho.Math==Math)return Ho}return globalThis}(this);function p(Fo){var Oo,Ho,Vo=typeof Symbol<"u"&&Symbol.iterator&&Fo[Symbol.iterator];return Vo?Vo.call(Fo):{next:(Oo=Fo,Ho=0,function(){return Ho<Oo.length?{done:!1,value:Oo[Ho++]}:{done:!0}})}}(function(Fo,Oo){if(Oo){var Ho=d;Fo=Fo.split(".");for(var Vo=0;Vo<Fo.length-1;Vo++){var qo=Fo[Vo];qo in Ho||(Ho[qo]={}),Ho=Ho[qo]}(Oo=Oo(Vo=Ho[Fo=Fo[Fo.length-1]]))!=Vo&&Oo!=null&&h(Ho,Fo,{configurable:!0,writable:!0,value:Oo})}})("Promise",function(Fo){function Oo(os){this.b=0,this.c=void 0,this.a=[];var As=this.f();try{os(As.resolve,As.reject)}catch(Ts){As.reject(Ts)}}function Ho(){this.a=null}function Vo(os){return os instanceof Oo?os:new Oo(function(As){As(os)})}if(Fo)return Fo;Ho.prototype.b=function(os){if(this.a==null){this.a=[];var As=this;this.c(function(){As.g()})}this.a.push(os)};var qo=d.setTimeout;Ho.prototype.c=function(os){qo(os,0)},Ho.prototype.g=function(){for(;this.a&&this.a.length;){var os=this.a;this.a=[];for(var As=0;As<os.length;++As){var Ts=os[As];os[As]=null;try{Ts()}catch(Ns){this.f(Ns)}}}this.a=null},Ho.prototype.f=function(os){this.c(function(){throw os})},Oo.prototype.f=function(){function os(Ns){return function(Ys){Ts||(Ts=!0,Ns.call(As,Ys))}}var As=this,Ts=!1;return{resolve:os(this.m),reject:os(this.g)}},Oo.prototype.m=function(os){if(os===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(os instanceof Oo)this.s(os);else{e:switch(typeof os){case"object":var As=os!=null;break e;case"function":As=!0;break e;default:As=!1}As?this.u(os):this.h(os)}},Oo.prototype.u=function(os){var As=void 0;try{As=os.then}catch(Ts){return void this.g(Ts)}typeof As=="function"?this.w(As,os):this.h(os)},Oo.prototype.g=function(os){this.i(2,os)},Oo.prototype.h=function(os){this.i(1,os)},Oo.prototype.i=function(os,As){if(this.b!=0)throw Error("Cannot settle("+os+", "+As+"): Promise already settled in state"+this.b);this.b=os,this.c=As,this.l()},Oo.prototype.l=function(){if(this.a!=null){for(var os=0;os<this.a.length;++os)ns.b(this.a[os]);this.a=null}};var ns=new Ho;return Oo.prototype.s=function(os){var As=this.f();os.Oa(As.resolve,As.reject)},Oo.prototype.w=function(os,As){var Ts=this.f();try{os.call(As,Ts.resolve,Ts.reject)}catch(Ns){Ts.reject(Ns)}},Oo.prototype.then=function(os,As){function Ts(dl,Il){return typeof dl=="function"?function($l){try{Ns(dl($l))}catch(XA){Ys(XA)}}:Il}var Ns,Ys,tl=new Oo(function(dl,Il){Ns=dl,Ys=Il});return this.Oa(Ts(os,Ns),Ts(As,Ys)),tl},Oo.prototype.catch=function(os){return this.then(void 0,os)},Oo.prototype.Oa=function(os,As){function Ts(){switch(Ns.b){case 1:os(Ns.c);break;case 2:As(Ns.c);break;default:throw Error("Unexpected state: "+Ns.b)}}var Ns=this;this.a==null?ns.b(Ts):this.a.push(Ts)},Oo.resolve=Vo,Oo.reject=function(os){return new Oo(function(As,Ts){Ts(os)})},Oo.race=function(os){return new Oo(function(As,Ts){for(var Ns=p(os),Ys=Ns.next();!Ys.done;Ys=Ns.next())Vo(Ys.value).Oa(As,Ts)})},Oo.all=function(os){var As=p(os),Ts=As.next();return Ts.done?Vo([]):new Oo(function(Ns,Ys){function tl($l){return function(XA){dl[$l]=XA,--Il==0&&Ns(dl)}}for(var dl=[],Il=0;dl.push(void 0),Il++,Vo(Ts.value).Oa(tl(dl.length-1),Ys),!(Ts=As.next()).done;);})},Oo});var Co=Co||{},Bo=this||self,Lo=/^[\w+/_-]+[=]{0,2}$/,Uo=null;function Qo(){}function Po(Fo){var Oo=typeof Fo;if(Oo=="object"){if(!Fo)return"null";if(Fo instanceof Array)return"array";if(Fo instanceof Object)return Oo;var Ho=Object.prototype.toString.call(Fo);if(Ho=="[object Window]")return"object";if(Ho=="[object Array]"||typeof Fo.length=="number"&&Fo.splice!==void 0&&Fo.propertyIsEnumerable!==void 0&&!Fo.propertyIsEnumerable("splice"))return"array";if(Ho=="[object Function]"||Fo.call!==void 0&&Fo.propertyIsEnumerable!==void 0&&!Fo.propertyIsEnumerable("call"))return"function"}else if(Oo=="function"&&Fo.call===void 0)return"object";return Oo}function Mo(Fo){var Oo=Po(Fo);return Oo=="array"||Oo=="object"&&typeof Fo.length=="number"}function Go(Fo){return Po(Fo)=="function"}function $o(Fo){var Oo=typeof Fo;return Oo=="object"&&Fo!=null||Oo=="function"}var jo="closure_uid_"+(1e9*Math.random()>>>0),zo=0;function Xo(Fo,Oo,Ho){return Fo.call.apply(Fo.bind,arguments)}function Zo(Fo,Oo,Ho){if(!Fo)throw Error();if(2<arguments.length){var Vo=Array.prototype.slice.call(arguments,2);return function(){var qo=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(qo,Vo),Fo.apply(Oo,qo)}}return function(){return Fo.apply(Oo,arguments)}}function Wo(Fo,Oo,Ho){return(Wo=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Xo:Zo).apply(null,arguments)}function es(Fo,Oo){var Ho=Array.prototype.slice.call(arguments,1);return function(){var Vo=Ho.slice();return Vo.push.apply(Vo,arguments),Fo.apply(this,Vo)}}var is=Date.now||function(){return+new Date};function Jo(Fo,Oo){function Ho(){}Ho.prototype=Oo.prototype,Fo.Za=Oo.prototype,Fo.prototype=new Ho,Fo.prototype.constructor=Fo}function Ko(Fo,Oo,Ho){this.code=ss+Fo,this.message=Oo||cs[Fo]||"",this.a=Ho||null}function Yo(Fo){var Oo=Fo&&Fo.code;return Oo?new Ko(Oo.substring(ss.length),Fo.message,Fo.serverResponse):null}Jo(Ko,Error),Ko.prototype.v=function(){var Fo={code:this.code,message:this.message};return this.a&&(Fo.serverResponse=this.a),Fo},Ko.prototype.toJSON=function(){return this.v()};var ts,ss="auth/",cs={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},as={hd:{Ra:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},pd:{Ra:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://securetoken.googleapis.com/v1/token",Ua:"https://identitytoolkit.googleapis.com/v2/",id:"p"},rd:{Ra:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},sd:{Ra:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Xa:"https://test-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function us(Fo){for(var Oo in as)if(as[Oo].id===Fo)return{firebaseEndpoint:(Fo=as[Oo]).Ra,secureTokenEndpoint:Fo.Xa,identityPlatformEndpoint:Fo.Ua};return null}function gs(Fo){if(Fo)try{return Fo.$goog_Thenable}catch{return}}function Is(Fo){if(Error.captureStackTrace)Error.captureStackTrace(this,Is);else{var Oo=Error().stack;Oo&&(this.stack=Oo)}Fo&&(this.message=String(Fo))}function _s(Fo,Oo){for(var Ho="",Vo=(Fo=Fo.split("%s")).length-1,qo=0;qo<Vo;qo++)Ho+=Fo[qo]+(qo<Oo.length?Oo[qo]:"%s");Is.call(this,Ho+Fo[Vo])}function Hs(Fo,Oo){throw new _s("Failure"+(Fo?": "+Fo:""),Array.prototype.slice.call(arguments,1))}function ds(Fo,Oo){this.c=Fo,this.f=Oo,this.b=0,this.a=null}function hs(Fo,Oo){Fo.f(Oo),Fo.b<100&&(Fo.b++,Oo.next=Fo.a,Fo.a=Oo)}function ys(){this.b=this.a=null}ts=us("__EID__")?"__EID__":void 0,Jo(Is,Error),Is.prototype.name="CustomError",Jo(_s,Is),_s.prototype.name="AssertionError",ds.prototype.get=function(){if(0<this.b){this.b--;var Fo=this.a;this.a=Fo.next,Fo.next=null}else Fo=this.c();return Fo};var ms=new ds(function(){return new Rs},function(Fo){Fo.reset()});function Rs(){this.next=this.b=this.a=null}ys.prototype.add=function(Fo,Oo){var Ho=ms.get();Ho.set(Fo,Oo),this.b?this.b.next=Ho:this.a=Ho,this.b=Ho},Rs.prototype.set=function(Fo,Oo){this.a=Fo,this.b=Oo,this.next=null},Rs.prototype.reset=function(){this.next=this.b=this.a=null};var bs=Array.prototype.indexOf?function(Fo,Oo){return Array.prototype.indexOf.call(Fo,Oo,void 0)}:function(Fo,Oo){if(typeof Fo=="string")return typeof Oo!="string"||Oo.length!=1?-1:Fo.indexOf(Oo,0);for(var Ho=0;Ho<Fo.length;Ho++)if(Ho in Fo&&Fo[Ho]===Oo)return Ho;return-1},ps=Array.prototype.forEach?function(Fo,Oo,Ho){Array.prototype.forEach.call(Fo,Oo,Ho)}:function(Fo,Oo,Ho){for(var Vo=Fo.length,qo=typeof Fo=="string"?Fo.split(""):Fo,ns=0;ns<Vo;ns++)ns in qo&&Oo.call(Ho,qo[ns],ns,Fo)},ks=Array.prototype.filter?function(Fo,Oo){return Array.prototype.filter.call(Fo,Oo,void 0)}:function(Fo,Oo){for(var Ho=Fo.length,Vo=[],qo=0,ns=typeof Fo=="string"?Fo.split(""):Fo,os=0;os<Ho;os++)if(os in ns){var As=ns[os];Oo.call(void 0,As,os,Fo)&&(Vo[qo++]=As)}return Vo},xs=Array.prototype.map?function(Fo,Oo){return Array.prototype.map.call(Fo,Oo,void 0)}:function(Fo,Oo){for(var Ho=Fo.length,Vo=Array(Ho),qo=typeof Fo=="string"?Fo.split(""):Fo,ns=0;ns<Ho;ns++)ns in qo&&(Vo[ns]=Oo.call(void 0,qo[ns],ns,Fo));return Vo},Ss=Array.prototype.some?function(Fo,Oo){return Array.prototype.some.call(Fo,Oo,void 0)}:function(Fo,Oo){for(var Ho=Fo.length,Vo=typeof Fo=="string"?Fo.split(""):Fo,qo=0;qo<Ho;qo++)if(qo in Vo&&Oo.call(void 0,Vo[qo],qo,Fo))return!0;return!1};function Us(Fo,Oo){return 0<=bs(Fo,Oo)}function Ps(Fo,Oo){var Ho;return(Ho=0<=(Oo=bs(Fo,Oo)))&&Array.prototype.splice.call(Fo,Oo,1),Ho}function Qs(Fo,Oo){(function(Ho,Vo){for(var qo=typeof Ho=="string"?Ho.split(""):Ho,ns=Ho.length-1;0<=ns;--ns)ns in qo&&Vo.call(void 0,qo[ns],ns,Ho)})(Fo,function(Ho,Vo){Oo.call(void 0,Ho,Vo,Fo)&&Array.prototype.splice.call(Fo,Vo,1).length==1})}function Js(Fo){return Array.prototype.concat.apply([],arguments)}function qs(Fo){var Oo=Fo.length;if(0<Oo){for(var Ho=Array(Oo),Vo=0;Vo<Oo;Vo++)Ho[Vo]=Fo[Vo];return Ho}return[]}var Gs,Zs=String.prototype.trim?function(Fo){return Fo.trim()}:function(Fo){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(Fo)[1]},Es=/&/g,fs=/</g,vs=/>/g,Bs=/"/g,Ls=/'/g,Fs=/\x00/g,zs=/[\x00&<>"']/;function js(Fo,Oo){return Fo.indexOf(Oo)!=-1}function ma(Fo,Oo){return Fo<Oo?-1:Oo<Fo?1:0}e:{var Ws=Bo.navigator;if(Ws){var va=Ws.userAgent;if(va){Gs=va;break e}}Gs=""}function ca(Fo){return js(Gs,Fo)}function cl(Fo,Oo){for(var Ho in Fo)Oo.call(void 0,Fo[Ho],Ho,Fo)}function Ms(Fo){for(var Oo in Fo)return;return 1}function $s(Fo){var Oo,Ho={};for(Oo in Fo)Ho[Oo]=Fo[Oo];return Ho}var ga="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Xs(Fo,Oo){for(var Ho,Vo,qo=1;qo<arguments.length;qo++){for(Ho in Vo=arguments[qo])Fo[Ho]=Vo[Ho];for(var ns=0;ns<ga.length;ns++)Ho=ga[ns],Object.prototype.hasOwnProperty.call(Vo,Ho)&&(Fo[Ho]=Vo[Ho])}}function ll(Fo,Oo){e:{try{var Ho=Fo&&Fo.ownerDocument,Vo=Ho&&(Ho.defaultView||Ho.parentWindow);if((Vo=Vo||Bo).Element&&Vo.Location){var qo=Vo;break e}}catch{}qo=null}if(qo&&qo[Oo]!==void 0&&(!Fo||!(Fo instanceof qo[Oo])&&(Fo instanceof qo.Location||Fo instanceof qo.Element))){if($o(Fo))try{var ns=Fo.constructor.displayName||Fo.constructor.name||Object.prototype.toString.call(Fo)}catch{ns="<object could not be stringified>"}else ns=Fo===void 0?"undefined":Fo===null?"null":typeof Fo;Hs("Argument is not a %s (or a non-Element, non-Location mock); got: %s",Oo,ns)}}function sl(Fo,Oo){this.a=Fo===El&&Oo||"",this.b=pl}function nl(Fo){return Fo instanceof sl&&Fo.constructor===sl&&Fo.b===pl?Fo.a:(Hs("expected object of type Const, got '"+Fo+"'"),"type_error:Const")}sl.prototype.ra=!0,sl.prototype.qa=function(){return this.a},sl.prototype.toString=function(){return"Const{"+this.a+"}"};var pl={},El={},cA=new sl(El,"");function rl(Fo,Oo){this.a=Fo===gl&&Oo||"",this.b=hl}function Cl(Fo){return Fo instanceof rl&&Fo.constructor===rl&&Fo.b===hl?Fo.a:(Hs("expected object of type TrustedResourceUrl, got '"+Fo+"' of type "+Po(Fo)),"type_error:TrustedResourceUrl")}function Ul(Fo,Oo){var Ho=nl(Fo);if(!Ll.test(Ho))throw Error("Invalid TrustedResourceUrl format: "+Ho);return Fo=Ho.replace(Nl,function(Vo,qo){if(!Object.prototype.hasOwnProperty.call(Oo,qo))throw Error('Found marker, "'+qo+'", in format string, "'+Ho+'", but no valid label mapping found in args: '+JSON.stringify(Oo));return(Vo=Oo[qo])instanceof sl?nl(Vo):encodeURIComponent(String(Vo))}),new rl(gl,Fo)}rl.prototype.ra=!0,rl.prototype.qa=function(){return this.a.toString()},rl.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Nl=/%{(\w+)}/g,Ll=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,hl={},gl={};function zl(Fo,Oo){this.a=Fo===vA&&Oo||"",this.b=Kl}function bA(Fo){return Fo instanceof zl&&Fo.constructor===zl&&Fo.b===Kl?Fo.a:(Hs("expected object of type SafeUrl, got '"+Fo+"' of type "+Po(Fo)),"type_error:SafeUrl")}zl.prototype.ra=!0,zl.prototype.qa=function(){return this.a.toString()},zl.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var UA=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Dl(Fo){return Fo instanceof zl?Fo:(Fo=typeof Fo=="object"&&Fo.ra?Fo.qa():String(Fo),UA.test(Fo)||(Fo="about:invalid#zClosurez"),new zl(vA,Fo))}var Kl={},vA={};function Vl(){this.a="",this.b=Tl}function TA(Fo){return Fo instanceof Vl&&Fo.constructor===Vl&&Fo.b===Tl?Fo.a:(Hs("expected object of type SafeHtml, got '"+Fo+"' of type "+Po(Fo)),"type_error:SafeHtml")}Vl.prototype.ra=!0,Vl.prototype.qa=function(){return this.a.toString()},Vl.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Tl={};function xl(Fo){var Oo=new Vl;return Oo.a=Fo,Oo}xl("<!DOCTYPE html>");var ua=xl("");function _l(Fo,Oo){for(var Ho=Fo.split("%s"),Vo="",qo=Array.prototype.slice.call(arguments,1);qo.length&&1<Ho.length;)Vo+=Ho.shift()+qo.shift();return Vo+Ho.join("%s")}function uA(Fo){return zs.test(Fo)&&(Fo.indexOf("&")!=-1&&(Fo=Fo.replace(Es,"&amp;")),Fo.indexOf("<")!=-1&&(Fo=Fo.replace(fs,"&lt;")),Fo.indexOf(">")!=-1&&(Fo=Fo.replace(vs,"&gt;")),Fo.indexOf('"')!=-1&&(Fo=Fo.replace(Bs,"&quot;")),Fo.indexOf("'")!=-1&&(Fo=Fo.replace(Ls,"&#39;")),Fo.indexOf("\0")!=-1&&(Fo=Fo.replace(Fs,"&#0;"))),Fo}function fA(Fo){return fA[" "](Fo),Fo}xl("<br>"),fA[" "]=Qo;var hA,Zl,kA=ca("Opera"),Ml=ca("Trident")||ca("MSIE"),jl=ca("Edge"),GA=jl||Ml,Ol=ca("Gecko")&&!(js(Gs.toLowerCase(),"webkit")&&!ca("Edge"))&&!(ca("Trident")||ca("MSIE"))&&!ca("Edge"),yA=js(Gs.toLowerCase(),"webkit")&&!ca("Edge");function wA(){var Fo=Bo.document;return Fo?Fo.documentMode:void 0}e:{var $A="",Cs=(Zl=Gs,Ol?/rv:([^\);]+)(\)|;)/.exec(Zl):jl?/Edge\/([\d\.]+)/.exec(Zl):Ml?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Zl):yA?/WebKit\/(\S+)/.exec(Zl):kA?/(?:Version)[ \/]?(\S+)/.exec(Zl):void 0);if(Cs&&($A=Cs?Cs[1]:""),Ml){var Al=wA();if(Al!=null&&Al>parseFloat($A)){hA=String(Al);break e}}hA=$A}var bl,Wl={};function oA(Fo){return Oo=Fo,Ho=function(){for(var qo=0,ns=Zs(String(hA)).split("."),os=Zs(String(Fo)).split("."),As=Math.max(ns.length,os.length),Ts=0;qo==0&&Ts<As;Ts++){var Ns=ns[Ts]||"",Ys=os[Ts]||"";do{if(Ns=/(\d*)(\D*)(.*)/.exec(Ns)||["","","",""],Ys=/(\d*)(\D*)(.*)/.exec(Ys)||["","","",""],Ns[0].length==0&&Ys[0].length==0)break;qo=ma(Ns[1].length==0?0:parseInt(Ns[1],10),Ys[1].length==0?0:parseInt(Ys[1],10))||ma(Ns[2].length==0,Ys[2].length==0)||ma(Ns[2],Ys[2]),Ns=Ns[3],Ys=Ys[3]}while(qo==0)}return 0<=qo},Vo=Wl,Object.prototype.hasOwnProperty.call(Vo,Oo)?Vo[Oo]:Vo[Oo]=Ho(Oo);var Oo,Ho,Vo}bl=Bo.document&&Ml?wA():void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch{}var gA=!Ml||9<=Number(bl);function kl(Fo){var Oo=document;return typeof Fo=="string"?Oo.getElementById(Fo):Fo}function EA(Fo,Oo){cl(Oo,function(Ho,Vo){Ho&&typeof Ho=="object"&&Ho.ra&&(Ho=Ho.qa()),Vo=="style"?Fo.style.cssText=Ho:Vo=="class"?Fo.className=Ho:Vo=="for"?Fo.htmlFor=Ho:NA.hasOwnProperty(Vo)?Fo.setAttribute(NA[Vo],Ho):Vo.lastIndexOf("aria-",0)==0||Vo.lastIndexOf("data-",0)==0?Fo.setAttribute(Vo,Ho):Fo[Vo]=Ho})}var Ql,JA,NA={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Yl(Fo,Oo,Ho){var Vo=arguments,qo=document,ns=String(Vo[0]),os=Vo[1];if(!gA&&os&&(os.name||os.type)){if(ns=["<",ns],os.name&&ns.push(' name="',uA(os.name),'"'),os.type){ns.push(' type="',uA(os.type),'"');var As={};Xs(As,os),delete As.type,os=As}ns.push(">"),ns=ns.join("")}return ns=xA(qo,ns),os&&(typeof os=="string"?ns.className=os:Array.isArray(os)?ns.className=os.join(" "):EA(ns,os)),2<Vo.length&&function(Ts,Ns,Ys){function tl($l){$l&&Ns.appendChild(typeof $l=="string"?Ts.createTextNode($l):$l)}for(var dl=2;dl<Ys.length;dl++){var Il=Ys[dl];!Mo(Il)||$o(Il)&&0<Il.nodeType?tl(Il):ps(xu(Il)?qs(Il):Il,tl)}}(qo,ns,Vo),ns}function xA(Fo,Oo){return Oo=String(Oo),Fo.contentType==="application/xhtml+xml"&&(Oo=Oo.toLowerCase()),Fo.createElement(Oo)}function xu(Fo){if(Fo&&typeof Fo.length=="number"){if($o(Fo))return typeof Fo.item=="function"||typeof Fo.item=="string";if(Go(Fo))return typeof Fo.item=="function"}}function Rl(Fo){Bo.setTimeout(function(){throw Fo},0)}function eA(){var Fo=Bo.MessageChannel;if(Fo===void 0&&typeof window<"u"&&window.postMessage&&window.addEventListener&&!ca("Presto")&&(Fo=function(){var qo,ns,os=xA(document,"IFRAME");os.style.display="none",qo=os,ns=new rl(gl,nl(cA)),ll(qo,"HTMLIFrameElement"),qo.src=Cl(ns).toString(),document.documentElement.appendChild(os);var As=os.contentWindow;(os=As.document).open(),os.write(TA(ua)),os.close();var Ts="callImmediate"+Math.random(),Ns=As.location.protocol=="file:"?"*":As.location.protocol+"//"+As.location.host;os=Wo(function(Ys){Ns!="*"&&Ys.origin!=Ns||Ys.data!=Ts||this.port1.onmessage()},this),As.addEventListener("message",os,!1),this.port1={},this.port2={postMessage:function(){As.postMessage(Ts,Ns)}}}),Fo===void 0||ca("Trident")||ca("MSIE"))return function(qo){Bo.setTimeout(qo,0)};var Oo=new Fo,Ho={},Vo=Ho;return Oo.port1.onmessage=function(){if(Ho.next!==void 0){var qo=(Ho=Ho.next).Db;Ho.Db=null,qo()}},function(qo){Vo.next={Db:qo},Vo=Vo.next,Oo.port2.postMessage(0)}}function Pl(Fo,Oo){JA||function(){if(Bo.Promise&&Bo.Promise.resolve){var Ho=Bo.Promise.resolve(void 0);JA=function(){Ho.then(lu)}}else JA=function(){var Vo=lu;!Go(Bo.setImmediate)||Bo.Window&&Bo.Window.prototype&&!ca("Edge")&&Bo.Window.prototype.setImmediate==Bo.setImmediate?(Ql=Ql||eA())(Vo):Bo.setImmediate(Vo)}}(),il||(JA(),il=!0),wl.add(Fo,Oo)}var il=!1,wl=new ys;function lu(){for(var Fo;Ho=Oo=void 0,Ho=null,(Oo=wl).a&&(Ho=Oo.a,Oo.a=Oo.a.next,Oo.a||(Oo.b=null),Ho.next=null),Fo=Ho;){try{Fo.a.call(Fo.b)}catch(Vo){Rl(Vo)}hs(ms,Fo)}var Oo,Ho;il=!1}function vl(Fo,Oo){if(this.a=ru,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,Fo!=Qo)try{var Ho=this;Fo.call(Oo,function(Vo){ta(Ho,Au,Vo)},function(Vo){if(!(Vo instanceof Xl))try{throw Vo instanceof Error?Vo:Error("Promise rejected.")}catch{}ta(Ho,OA,Vo)})}catch(Vo){ta(this,OA,Vo)}}var ru=0,Au=2,OA=3;function rf(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}rf.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Of=new ds(function(){return new rf},function(Fo){Fo.reset()});function rs(Fo,Oo,Ho){var Vo=Of.get();return Vo.g=Fo,Vo.b=Oo,Vo.f=Ho,Vo}function ls(Fo){if(Fo instanceof vl)return Fo;var Oo=new vl(Qo);return ta(Oo,Au,Fo),Oo}function ws(Fo){return new vl(function(Oo,Ho){Ho(Fo)})}function Ds(Fo,Oo,Ho){al(Fo,Oo,Ho,null)||Pl(es(Oo,Fo))}function Os(Fo){return new vl(function(Oo){var Ho=Fo.length,Vo=[];if(Ho)for(var qo=function(os,As,Ts){Ho--,Vo[os]=As?{Mb:!0,value:Ts}:{Mb:!1,reason:Ts},Ho==0&&Oo(Vo)},ns=0;ns<Fo.length;ns++)Ds(Fo[ns],es(qo,ns,!0),es(qo,ns,!1));else Oo(Vo)})}function Ks(Fo,Oo){Fo.b||Fo.a!=Au&&Fo.a!=OA||ol(Fo),Fo.f?Fo.f.next=Oo:Fo.b=Oo,Fo.f=Oo}function Vs(Fo,Oo,Ho,Vo){var qo=rs(null,null,null);return qo.a=new vl(function(ns,os){qo.g=Oo?function(As){try{var Ts=Oo.call(Vo,As);ns(Ts)}catch(Ns){os(Ns)}}:ns,qo.b=Ho?function(As){try{var Ts=Ho.call(Vo,As);Ts===void 0&&As instanceof Xl?os(As):ns(Ts)}catch(Ns){os(Ns)}}:os}),Ks(qo.a.c=Fo,qo),qo.a}function ta(Fo,Oo,Ho){var Vo,qo;Fo.a==ru&&(Fo===Ho&&(Oo=OA,Ho=new TypeError("Promise cannot resolve to itself")),Fo.a=1,al(Ho,Fo.Yc,Fo.Zc,Fo)||(Fo.i=Ho,Fo.a=Oo,Fo.c=null,ol(Fo),Oo!=OA||Ho instanceof Xl||(qo=Ho,(Vo=Fo).g=!0,Pl(function(){Vo.g&&Fl.call(null,qo)}))))}function al(Fo,Oo,Ho,Vo){if(Fo instanceof vl)return Ks(Fo,rs(Oo||Qo,Ho||null,Vo)),1;if(gs(Fo))return Fo.then(Oo,Ho,Vo),1;if($o(Fo))try{var qo=Fo.then;if(Go(qo))return function(ns,os,As,Ts,Ns){function Ys(dl){tl||(tl=!0,Ts.call(Ns,dl))}var tl=!1;try{os.call(ns,function(dl){tl||(tl=!0,As.call(Ns,dl))},Ys)}catch(dl){Ys(dl)}}(Fo,qo,Oo,Ho,Vo),1}catch(ns){return Ho.call(Vo,ns),1}}function ol(Fo){Fo.h||(Fo.h=!0,Pl(Fo.ec,Fo))}function el(Fo){var Oo=null;return Fo.b&&(Oo=Fo.b,Fo.b=Oo.next,Oo.next=null),Fo.b||(Fo.f=null),Oo}function ml(Fo,Oo,Ho,Vo){if(Ho==OA&&Oo.b&&!Oo.c)for(;Fo&&Fo.g;Fo=Fo.c)Fo.g=!1;if(Oo.a)Oo.a.c=null,yl(Oo,Ho,Vo);else try{Oo.c?Oo.g.call(Oo.f):yl(Oo,Ho,Vo)}catch(qo){Fl.call(null,qo)}hs(Of,Oo)}function yl(Fo,Oo,Ho){Oo==Au?Fo.g.call(Fo.f,Ho):Fo.b&&Fo.b.call(Fo.f,Ho)}vl.prototype.then=function(Fo,Oo,Ho){return Vs(this,Go(Fo)?Fo:null,Go(Oo)?Oo:null,Ho)},vl.prototype.$goog_Thenable=!0,(c=vl.prototype).ma=function(Fo,Oo){return(Fo=rs(Fo,Fo,Oo)).c=!0,Ks(this,Fo),this},c.o=function(Fo,Oo){return Vs(this,null,Fo,Oo)},c.cancel=function(Fo){if(this.a==ru){var Oo=new Xl(Fo);Pl(function(){(function Ho(Vo,qo){if(Vo.a==ru)if(Vo.c){var ns=Vo.c;if(ns.b){for(var os=0,As=null,Ts=null,Ns=ns.b;Ns&&(Ns.c||(os++,Ns.a==Vo&&(As=Ns),!(As&&1<os)));Ns=Ns.next)As||(Ts=Ns);As&&(ns.a==ru&&os==1?Ho(ns,qo):(Ts?((os=Ts).next==ns.f&&(ns.f=os),os.next=os.next.next):el(ns),ml(ns,As,OA,qo)))}Vo.c=null}else ta(Vo,OA,qo)})(this,Oo)},this)}},c.Yc=function(Fo){this.a=ru,ta(this,Au,Fo)},c.Zc=function(Fo){this.a=ru,ta(this,OA,Fo)},c.ec=function(){for(var Fo;Fo=el(this);)ml(this,Fo,this.a,this.i);this.h=!1};var Fl=Rl;function Xl(Fo){Is.call(this,Fo)}function tA(){this.wa=this.wa,this.na=this.na}Jo(Xl,Is);var Gl=0;function nA(Fo){!Fo.wa&&(Fo.wa=!0,Fo.Ba(),Gl!=0)&&(Oo=Fo,Object.prototype.hasOwnProperty.call(Oo,jo)&&Oo[jo]||(Oo[jo]=++zo));var Oo}tA.prototype.wa=!(Xl.prototype.name="cancel"),tA.prototype.Ba=function(){if(this.na)for(;this.na.length;)this.na.shift()()};var mA=Object.freeze||function(Fo){return Fo},VA=!Ml||9<=Number(bl),sA=Ml&&!oA("9"),LA=function(){if(!Bo.addEventListener||!Object.defineProperty)return!1;var Fo=!1,Oo=Object.defineProperty({},"passive",{get:function(){Fo=!0}});try{Bo.addEventListener("test",Qo,Oo),Bo.removeEventListener("test",Qo,Oo)}catch{}return Fo}();function rA(Fo,Oo){this.type=Fo,this.b=this.target=Oo,this.defaultPrevented=!1}function KA(Fo,Oo){if(rA.call(this,Fo?Fo.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,Fo){var Ho=this.type=Fo.type,Vo=Fo.changedTouches&&Fo.changedTouches.length?Fo.changedTouches[0]:null;if(this.target=Fo.target||Fo.srcElement,this.b=Oo,Oo=Fo.relatedTarget){if(Ol){e:{try{fA(Oo.nodeName);var qo=!0;break e}catch{}qo=!1}qo||(Oo=null)}}else Ho=="mouseover"?Oo=Fo.fromElement:Ho=="mouseout"&&(Oo=Fo.toElement);this.relatedTarget=Oo,Vo?(this.clientX=Vo.clientX!==void 0?Vo.clientX:Vo.pageX,this.clientY=Vo.clientY!==void 0?Vo.clientY:Vo.pageY,this.screenX=Vo.screenX||0,this.screenY=Vo.screenY||0):(this.clientX=Fo.clientX!==void 0?Fo.clientX:Fo.pageX,this.clientY=Fo.clientY!==void 0?Fo.clientY:Fo.pageY,this.screenX=Fo.screenX||0,this.screenY=Fo.screenY||0),this.button=Fo.button,this.key=Fo.key||"",this.ctrlKey=Fo.ctrlKey,this.altKey=Fo.altKey,this.shiftKey=Fo.shiftKey,this.metaKey=Fo.metaKey,this.pointerId=Fo.pointerId||0,this.pointerType=typeof Fo.pointerType=="string"?Fo.pointerType:Bh[Fo.pointerType]||"",(this.a=Fo).defaultPrevented&&this.preventDefault()}}rA.prototype.preventDefault=function(){this.defaultPrevented=!0},Jo(KA,rA);var Bh=mA({2:"touch",3:"pen",4:"mouse"});KA.prototype.preventDefault=function(){KA.Za.preventDefault.call(this);var Fo=this.a;if(Fo.preventDefault)Fo.preventDefault();else if(Fo.returnValue=!1,sA)try{(Fo.ctrlKey||112<=Fo.keyCode&&Fo.keyCode<=123)&&(Fo.keyCode=-1)}catch{}},KA.prototype.f=function(){return this.a};var of="closure_listenable_"+(1e6*Math.random()|0),yv=0;function bv(Fo,Oo,Ho,Vo,qo){this.listener=Fo,this.proxy=null,this.src=Oo,this.type=Ho,this.capture=!!Vo,this.Ta=qo,this.key=++yv,this.ua=this.Na=!1}function Qf(Fo){Fo.ua=!0,Fo.listener=null,Fo.proxy=null,Fo.src=null,Fo.Ta=null}function Pf(Fo){this.src=Fo,this.a={},this.b=0}function Ih(Fo,Oo){var Ho=Oo.type;Ho in Fo.a&&Ps(Fo.a[Ho],Oo)&&(Qf(Oo),Fo.a[Ho].length==0&&(delete Fo.a[Ho],Fo.b--))}function Th(Fo,Oo,Ho,Vo){for(var qo=0;qo<Fo.length;++qo){var ns=Fo[qo];if(!ns.ua&&ns.listener==Oo&&ns.capture==!!Ho&&ns.Ta==Vo)return qo}return-1}Pf.prototype.add=function(Fo,Oo,Ho,Vo,qo){var ns=Fo.toString();(Fo=this.a[ns])||(Fo=this.a[ns]=[],this.b++);var os=Th(Fo,Oo,Vo,qo);return-1<os?(Oo=Fo[os],Ho||(Oo.Na=!1)):((Oo=new bv(Oo,this.src,ns,!!Vo,qo)).Na=Ho,Fo.push(Oo)),Oo};var Sh="closure_lm_"+(1e6*Math.random()|0),kh={};function jA(Fo,Oo,Ho,Vo,qo){if(Vo&&Vo.once)Fh(Fo,Oo,Ho,Vo,qo);else if(Array.isArray(Oo))for(var ns=0;ns<Oo.length;ns++)jA(Fo,Oo[ns],Ho,Vo,qo);else Ho=Dh(Ho),Fo&&Fo[of]?bg(Fo,Oo,Ho,$o(Vo)?!!Vo.capture:!!Vo,qo):gg(Fo,Oo,Ho,!1,Vo,qo)}function gg(Fo,Oo,Ho,Vo,qo,ns){if(!Oo)throw Error("Invalid event type");var os,As,Ts=$o(qo)?!!qo.capture:!!qo,Ns=Mf(Fo);if(Ns||(Fo[Sh]=Ns=new Pf(Fo)),!(Ho=Ns.add(Oo,Ho,Vo,Ts,ns)).proxy)if(os=wv,Vo=As=VA?function(Ys){return os.call(As.src,As.listener,Ys)}:function(Ys){if(!(Ys=os.call(As.src,As.listener,Ys)))return Ys},(Ho.proxy=Vo).src=Fo,Vo.listener=Ho,Fo.addEventListener)LA||(qo=Ts),qo===void 0&&(qo=!1),Fo.addEventListener(Oo.toString(),Vo,qo);else if(Fo.attachEvent)Fo.attachEvent(_g(Oo.toString()),Vo);else{if(!Fo.addListener||!Fo.removeListener)throw Error("addEventListener and attachEvent are unavailable.");Fo.addListener(Vo)}}function Fh(Fo,Oo,Ho,Vo,qo){if(Array.isArray(Oo))for(var ns=0;ns<Oo.length;ns++)Fh(Fo,Oo[ns],Ho,Vo,qo);else Ho=Dh(Ho),Fo&&Fo[of]?Rh(Fo,Oo,Ho,$o(Vo)?!!Vo.capture:!!Vo,qo):gg(Fo,Oo,Ho,!0,Vo,qo)}function QA(Fo,Oo,Ho,Vo,qo){if(Array.isArray(Oo))for(var ns=0;ns<Oo.length;ns++)QA(Fo,Oo[ns],Ho,Vo,qo);else Vo=$o(Vo)?!!Vo.capture:!!Vo,Ho=Dh(Ho),Fo&&Fo[of]?(Fo=Fo.u,(Oo=String(Oo).toString())in Fo.a&&-1<(Ho=Th(ns=Fo.a[Oo],Ho,Vo,qo))&&(Qf(ns[Ho]),Array.prototype.splice.call(ns,Ho,1),ns.length==0&&(delete Fo.a[Oo],Fo.b--))):(Fo=Fo&&Mf(Fo))&&(Oo=Fo.a[Oo.toString()],Fo=-1,Oo&&(Fo=Th(Oo,Ho,Vo,qo)),(Ho=-1<Fo?Oo[Fo]:null)&&mg(Ho))}function mg(Fo){if(typeof Fo!="number"&&Fo&&!Fo.ua){var Oo=Fo.src;if(Oo&&Oo[of])Ih(Oo.u,Fo);else{var Ho=Fo.type,Vo=Fo.proxy;Oo.removeEventListener?Oo.removeEventListener(Ho,Vo,Fo.capture):Oo.detachEvent?Oo.detachEvent(_g(Ho),Vo):Oo.addListener&&Oo.removeListener&&Oo.removeListener(Vo),(Ho=Mf(Oo))?(Ih(Ho,Fo),Ho.b==0&&(Ho.src=null,Oo[Sh]=null)):Qf(Fo)}}}function _g(Fo){return Fo in kh?kh[Fo]:kh[Fo]="on"+Fo}function vg(Fo,Oo,Ho,Vo){var qo=!0;if((Fo=Mf(Fo))&&(Oo=Fo.a[Oo.toString()]))for(Oo=Oo.concat(),Fo=0;Fo<Oo.length;Fo++){var ns=Oo[Fo];ns&&ns.capture==Ho&&!ns.ua&&(ns=yg(ns,Vo),qo=qo&&ns!==!1)}return qo}function yg(Fo,Oo){var Ho=Fo.listener,Vo=Fo.Ta||Fo.src;return Fo.Na&&mg(Fo),Ho.call(Vo,Oo)}function wv(Fo,Oo){if(Fo.ua)return!0;if(VA)return yg(Fo,new KA(Oo,this));if(!Oo)e:{Oo=["window","event"];for(var Ho=Bo,Vo=0;Vo<Oo.length;Vo++)if((Ho=Ho[Oo[Vo]])==null){Oo=null;break e}Oo=Ho}if(Oo=new KA(Vo=Oo,this),Ho=!0,!(Vo.keyCode<0||Vo.returnValue!=null)){e:{var qo=!1;if(Vo.keyCode==0)try{Vo.keyCode=-1;break e}catch{qo=!0}!qo&&Vo.returnValue!=null||(Vo.returnValue=!0)}for(Vo=[],qo=Oo.b;qo;qo=qo.parentNode)Vo.push(qo);for(Fo=Fo.type,qo=Vo.length-1;0<=qo;qo--){Oo.b=Vo[qo];var ns=vg(Vo[qo],Fo,!0,Oo);Ho=Ho&&ns}for(qo=0;qo<Vo.length;qo++)Oo.b=Vo[qo],ns=vg(Vo[qo],Fo,!1,Oo),Ho=Ho&&ns}return Ho}function Mf(Fo){return(Fo=Fo[Sh])instanceof Pf?Fo:null}var Lh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dh(Fo){return Go(Fo)?Fo:(Fo[Lh]||(Fo[Lh]=function(Oo){return Fo.handleEvent(Oo)}),Fo[Lh])}function CA(){tA.call(this),this.u=new Pf(this),(this.Yb=this).eb=null}function bg(Fo,Oo,Ho,Vo,qo){Fo.u.add(String(Oo),Ho,!1,Vo,qo)}function Rh(Fo,Oo,Ho,Vo,qo){Fo.u.add(String(Oo),Ho,!0,Vo,qo)}function Hf(Fo,Oo,Ho,Vo){if(!(Oo=Fo.u.a[String(Oo)]))return!0;Oo=Oo.concat();for(var qo=!0,ns=0;ns<Oo.length;++ns){var os=Oo[ns];if(os&&!os.ua&&os.capture==Ho){var As=os.listener,Ts=os.Ta||os.src;os.Na&&Ih(Fo.u,os),qo=As.call(Ts,Vo)!==!1&&qo}}return qo&&!Vo.defaultPrevented}function Uh(Fo,Oo,Ho){if(Go(Fo))Ho&&(Fo=Wo(Fo,Ho));else{if(!Fo||typeof Fo.handleEvent!="function")throw Error("Invalid listener argument");Fo=Wo(Fo.handleEvent,Fo)}return 2147483647<Number(Oo)?-1:Bo.setTimeout(Fo,Oo||0)}function Ou(Fo){var Oo=null;return new vl(function(Ho,Vo){(Oo=Uh(function(){Ho(void 0)},Fo))==-1&&Vo(Error("Failed to schedule timer."))}).o(function(Ho){throw Bo.clearTimeout(Oo),Ho})}function wg(Fo){if(Fo.V&&typeof Fo.V=="function")return Fo.V();if(typeof Fo=="string")return Fo.split("");if(Mo(Fo)){for(var Oo=[],Ho=Fo.length,Vo=0;Vo<Ho;Vo++)Oo.push(Fo[Vo]);return Oo}for(Vo in Oo=[],Ho=0,Fo)Oo[Ho++]=Fo[Vo];return Oo}function Eg(Fo){if(Fo.X&&typeof Fo.X=="function")return Fo.X();if(!Fo.V||typeof Fo.V!="function"){if(Mo(Fo)||typeof Fo=="string"){var Oo=[];Fo=Fo.length;for(var Ho=0;Ho<Fo;Ho++)Oo.push(Ho);return Oo}for(var Vo in Oo=[],Ho=0,Fo)Oo[Ho++]=Vo;return Oo}}function Qu(Fo,Oo){this.b={},this.a=[],this.c=0;var Ho=arguments.length;if(1<Ho){if(Ho%2)throw Error("Uneven number of arguments");for(var Vo=0;Vo<Ho;Vo+=2)this.set(arguments[Vo],arguments[Vo+1])}else if(Fo)if(Fo instanceof Qu)for(Ho=Fo.X(),Vo=0;Vo<Ho.length;Vo++)this.set(Ho[Vo],Fo.get(Ho[Vo]));else for(Vo in Fo)this.set(Vo,Fo[Vo])}function Nh(Fo){if(Fo.c!=Fo.a.length){for(var Oo=0,Ho=0;Oo<Fo.a.length;){var Vo=Fo.a[Oo];_u(Fo.b,Vo)&&(Fo.a[Ho++]=Vo),Oo++}Fo.a.length=Ho}if(Fo.c!=Fo.a.length){var qo={};for(Ho=Oo=0;Oo<Fo.a.length;)_u(qo,Vo=Fo.a[Oo])||(qo[Fo.a[Ho++]=Vo]=1),Oo++;Fo.a.length=Ho}}function _u(Fo,Oo){return Object.prototype.hasOwnProperty.call(Fo,Oo)}Jo(CA,tA),CA.prototype[of]=!0,CA.prototype.addEventListener=function(Fo,Oo,Ho,Vo){jA(this,Fo,Oo,Ho,Vo)},CA.prototype.removeEventListener=function(Fo,Oo,Ho,Vo){QA(this,Fo,Oo,Ho,Vo)},CA.prototype.dispatchEvent=function(Fo){var Oo,Ho=this.eb;if(Ho)for(Oo=[];Ho;Ho=Ho.eb)Oo.push(Ho);Ho=this.Yb;var Vo=Fo.type||Fo;if(typeof Fo=="string")Fo=new rA(Fo,Ho);else if(Fo instanceof rA)Fo.target=Fo.target||Ho;else{var qo=Fo;Xs(Fo=new rA(Vo,Ho),qo)}if(qo=!0,Oo)for(var ns=Oo.length-1;0<=ns;ns--){var os=Fo.b=Oo[ns];qo=Hf(os,Vo,!0,Fo)&&qo}if(qo=Hf(os=Fo.b=Ho,Vo,!0,Fo)&&qo,qo=Hf(os,Vo,!1,Fo)&&qo,Oo)for(ns=0;ns<Oo.length;ns++)qo=Hf(os=Fo.b=Oo[ns],Vo,!1,Fo)&&qo;return qo},CA.prototype.Ba=function(){if(CA.Za.Ba.call(this),this.u){var Fo,Oo=this.u;for(Fo in Oo.a){for(var Ho=Oo.a[Fo],Vo=0;Vo<Ho.length;Vo++)Qf(Ho[Vo]);delete Oo.a[Fo],Oo.b--}}this.eb=null},(c=Qu.prototype).V=function(){Nh(this);for(var Fo=[],Oo=0;Oo<this.a.length;Oo++)Fo.push(this.b[this.a[Oo]]);return Fo},c.X=function(){return Nh(this),this.a.concat()},c.clear=function(){this.b={},this.c=this.a.length=0},c.get=function(Fo,Oo){return _u(this.b,Fo)?this.b[Fo]:Oo},c.set=function(Fo,Oo){_u(this.b,Fo)||(this.c++,this.a.push(Fo)),this.b[Fo]=Oo},c.forEach=function(Fo,Oo){for(var Ho=this.X(),Vo=0;Vo<Ho.length;Vo++){var qo=Ho[Vo],ns=this.get(qo);Fo.call(Oo,ns,qo,this)}};var Cg=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/\\#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function cu(Fo,Oo){var Ho;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,Fo instanceof cu?(this.h=Oo!==void 0?Oo:Fo.h,Gf(this,Fo.f),this.i=Fo.i,this.b=Fo.b,xh(this,Fo.l),this.c=Fo.c,Oh(this,kg(Fo.a)),this.g=Fo.g):Fo&&(Ho=String(Fo).match(Cg))?(this.h=!!Oo,Gf(this,Ho[1]||"",!0),this.i=sf(Ho[2]||""),this.b=sf(Ho[3]||"",!0),xh(this,Ho[4]),this.c=sf(Ho[5]||"",!0),Oh(this,Ho[6]||"",!0),this.g=sf(Ho[7]||"")):(this.h=!!Oo,this.a=new vu(null,this.h))}function Gf(Fo,Oo,Ho){Fo.f=Ho?sf(Oo,!0):Oo,Fo.f&&(Fo.f=Fo.f.replace(/:$/,""))}function xh(Fo,Oo){if(Oo){if(Oo=Number(Oo),isNaN(Oo)||Oo<0)throw Error("Bad port number "+Oo);Fo.l=Oo}else Fo.l=null}function Oh(Fo,Oo,Ho){var Vo,qo;Oo instanceof vu?(Fo.a=Oo,Vo=Fo.a,(qo=Fo.h)&&!Vo.f&&(uu(Vo),Vo.c=null,Vo.a.forEach(function(ns,os){var As=os.toLowerCase();os!=As&&(ZA(this,os),Sg(this,As,ns))},Vo)),Vo.f=qo):(Ho||(Oo=af(Oo,Iv)),Fo.a=new vu(Oo,Fo.h))}function aA(Fo,Oo,Ho){Fo.a.set(Oo,Ho)}function PA(Fo,Oo){return Fo.a.get(Oo)}function iu(Fo){return Fo instanceof cu?new cu(Fo):new cu(Fo,void 0)}function Bg(Fo,Oo){var Ho=new cu(null,void 0);return Gf(Ho,"https"),Fo&&(Ho.b=Fo),Oo&&(Ho.c=Oo),Ho}function sf(Fo,Oo){return Fo?Oo?decodeURI(Fo.replace(/%25/g,"%2525")):decodeURIComponent(Fo):""}function af(Fo,Oo,Ho){return typeof Fo=="string"?(Fo=encodeURI(Fo).replace(Oo,Ev),Ho&&(Fo=Fo.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),Fo):null}function Ev(Fo){return"%"+((Fo=Fo.charCodeAt(0))>>4&15).toString(16)+(15&Fo).toString(16)}cu.prototype.toString=function(){var Fo=[],Oo=this.f;Oo&&Fo.push(af(Oo,Ig,!0),":");var Ho=this.b;return!Ho&&Oo!="file"||(Fo.push("//"),(Oo=this.i)&&Fo.push(af(Oo,Ig,!0),"@"),Fo.push(encodeURIComponent(String(Ho)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),(Ho=this.l)!=null&&Fo.push(":",String(Ho))),(Ho=this.c)&&(this.b&&Ho.charAt(0)!="/"&&Fo.push("/"),Fo.push(af(Ho,Ho.charAt(0)=="/"?Bv:Cv,!0))),(Ho=this.a.toString())&&Fo.push("?",Ho),(Ho=this.g)&&Fo.push("#",af(Ho,Tv)),Fo.join("")},cu.prototype.resolve=function(Fo){var Oo=new cu(this),Ho=!!Fo.f;Ho?Gf(Oo,Fo.f):Ho=!!Fo.i,Ho?Oo.i=Fo.i:Ho=!!Fo.b,Ho?Oo.b=Fo.b:Ho=Fo.l!=null;var Vo=Fo.c;if(Ho)xh(Oo,Fo.l);else if(Ho=!!Fo.c){if(Vo.charAt(0)!="/")if(this.b&&!this.c)Vo="/"+Vo;else{var qo=Oo.c.lastIndexOf("/");qo!=-1&&(Vo=Oo.c.substr(0,qo+1)+Vo)}if((qo=Vo)==".."||qo==".")Vo="";else if(js(qo,"./")||js(qo,"/.")){Vo=qo.lastIndexOf("/",0)==0,qo=qo.split("/");for(var ns=[],os=0;os<qo.length;){var As=qo[os++];As=="."?Vo&&os==qo.length&&ns.push(""):As==".."?((1<ns.length||ns.length==1&&ns[0]!="")&&ns.pop(),Vo&&os==qo.length&&ns.push("")):(ns.push(As),Vo=!0)}Vo=ns.join("/")}else Vo=qo}return Ho?Oo.c=Vo:Ho=Fo.a.toString()!=="",Ho?Oh(Oo,kg(Fo.a)):Ho=!!Fo.g,Ho&&(Oo.g=Fo.g),Oo};var Ig=/[#\/\?@]/g,Cv=/[#\?:]/g,Bv=/[#\?]/g,Iv=/[#\?@]/g,Tv=/#/g;function vu(Fo,Oo){this.b=this.a=null,this.c=Fo||null,this.f=!!Oo}function uu(Fo){Fo.a||(Fo.a=new Qu,Fo.b=0,Fo.c&&function(Oo,Ho){if(Oo){Oo=Oo.split("&");for(var Vo=0;Vo<Oo.length;Vo++){var qo=Oo[Vo].indexOf("="),ns=null;if(0<=qo){var os=Oo[Vo].substring(0,qo);ns=Oo[Vo].substring(qo+1)}else os=Oo[Vo];Ho(os,ns?decodeURIComponent(ns.replace(/\+/g," ")):"")}}}(Fo.c,function(Oo,Ho){Fo.add(decodeURIComponent(Oo.replace(/\+/g," ")),Ho)}))}function Tg(Fo){var Oo=Eg(Fo);if(Oo===void 0)throw Error("Keys are undefined");var Ho=new vu(null,void 0);Fo=wg(Fo);for(var Vo=0;Vo<Oo.length;Vo++){var qo=Oo[Vo],ns=Fo[Vo];Array.isArray(ns)?Sg(Ho,qo,ns):Ho.add(qo,ns)}return Ho}function ZA(Fo,Oo){uu(Fo),Oo=Pu(Fo,Oo),_u(Fo.a.b,Oo)&&(Fo.c=null,Fo.b-=Fo.a.get(Oo).length,_u((Fo=Fo.a).b,Oo)&&(delete Fo.b[Oo],Fo.c--,Fo.a.length>2*Fo.c&&Nh(Fo)))}function Qh(Fo,Oo){return uu(Fo),Oo=Pu(Fo,Oo),_u(Fo.a.b,Oo)}function Sg(Fo,Oo,Ho){ZA(Fo,Oo),0<Ho.length&&(Fo.c=null,Fo.a.set(Pu(Fo,Oo),qs(Ho)),Fo.b+=Ho.length)}function kg(Fo){var Oo=new vu;return Oo.c=Fo.c,Fo.a&&(Oo.a=new Qu(Fo.a),Oo.b=Fo.b),Oo}function Pu(Fo,Oo){return Oo=String(Oo),Fo.f&&(Oo=Oo.toLowerCase()),Oo}function Fg(Fo){var Oo=[];return function Ho(Vo,qo,ns){if(qo==null)ns.push("null");else{if(typeof qo=="object"){if(Array.isArray(qo)){var os=qo;qo=os.length,ns.push("[");for(var As="",Ts=0;Ts<qo;Ts++)ns.push(As),Ho(Vo,os[Ts],ns),As=",";return void ns.push("]")}if(!(qo instanceof String||qo instanceof Number||qo instanceof Boolean)){for(os in ns.push("{"),As="",qo)Object.prototype.hasOwnProperty.call(qo,os)&&typeof(Ts=qo[os])!="function"&&(ns.push(As),Dg(os,ns),ns.push(":"),Ho(Vo,Ts,ns),As=",");return void ns.push("}")}qo=qo.valueOf()}switch(typeof qo){case"string":Dg(qo,ns);break;case"number":ns.push(isFinite(qo)&&!isNaN(qo)?String(qo):"null");break;case"boolean":ns.push(String(qo));break;case"function":ns.push("null");break;default:throw Error("Unknown type: "+typeof qo)}}}(new Sv,Fo,Oo),Oo.join("")}function Sv(){}(c=vu.prototype).add=function(Fo,Oo){uu(this),this.c=null,Fo=Pu(this,Fo);var Ho=this.a.get(Fo);return Ho||this.a.set(Fo,Ho=[]),Ho.push(Oo),this.b+=1,this},c.clear=function(){this.a=this.c=null,this.b=0},c.forEach=function(Fo,Oo){uu(this),this.a.forEach(function(Ho,Vo){ps(Ho,function(qo){Fo.call(Oo,qo,Vo,this)},this)},this)},c.X=function(){uu(this);for(var Fo=this.a.V(),Oo=this.a.X(),Ho=[],Vo=0;Vo<Oo.length;Vo++)for(var qo=Fo[Vo],ns=0;ns<qo.length;ns++)Ho.push(Oo[Vo]);return Ho},c.V=function(Fo){uu(this);var Oo=[];if(typeof Fo=="string")Qh(this,Fo)&&(Oo=Js(Oo,this.a.get(Pu(this,Fo))));else{Fo=this.a.V();for(var Ho=0;Ho<Fo.length;Ho++)Oo=Js(Oo,Fo[Ho])}return Oo},c.set=function(Fo,Oo){return uu(this),this.c=null,Qh(this,Fo=Pu(this,Fo))&&(this.b-=this.a.get(Fo).length),this.a.set(Fo,[Oo]),this.b+=1,this},c.get=function(Fo,Oo){return Fo&&0<(Fo=this.V(Fo)).length?String(Fo[0]):Oo},c.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var Fo=[],Oo=this.a.X(),Ho=0;Ho<Oo.length;Ho++){var Vo=Oo[Ho],qo=encodeURIComponent(String(Vo));Vo=this.V(Vo);for(var ns=0;ns<Vo.length;ns++){var os=qo;Vo[ns]!==""&&(os+="="+encodeURIComponent(String(Vo[ns]))),Fo.push(os)}}return this.c=Fo.join("&")};var Lg={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\u000b"},kv=/\uffff/.test("\uFFFF")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Dg(Fo,Oo){Oo.push('"',Fo.replace(kv,function(Ho){var Vo=Lg[Ho];return Vo||(Vo="\\u"+(65536|Ho.charCodeAt(0)).toString(16).substr(1),Lg[Ho]=Vo),Vo}),'"')}function Ph(){var Fo=_A();return Ml&&bl&&bl==11||/Edge\/\d+/.test(Fo)}function lf(){return Bo.window&&Bo.window.location.href||self&&self.location&&self.location.href||""}function Rg(Fo,Oo){Oo=Oo||Bo.window;var Ho="about:blank";Fo&&(Ho=bA(Dl(Fo))),Oo.location.href=Ho}function Ug(Fo){return!!((Fo=(Fo||_A()).toLowerCase()).match(/android/)||Fo.match(/webos/)||Fo.match(/iphone|ipad|ipod/)||Fo.match(/blackberry/)||Fo.match(/windows phone/)||Fo.match(/iemobile/))}function yu(Fo){Fo=Fo||Bo.window;try{Fo.close()}catch{}}function Ng(Fo,Oo,Ho){var Vo=Math.floor(1e9*Math.random()).toString();Oo=Oo||500,Ho=Ho||600;var qo=(window.screen.availHeight-Ho)/2,ns=(window.screen.availWidth-Oo)/2;for(os in Oo={width:Oo,height:Ho,top:0<qo?qo:0,left:0<ns?ns:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},Ho=_A().toLowerCase(),Vo&&(Oo.target=Vo,js(Ho,"crios/")&&(Oo.target="_blank")),Mu(_A())==$h&&(Fo=Fo||"http://localhost",Oo.scrollbars=!0),Ho=Fo||"",(Fo=Oo)||(Fo={}),Vo=window,Oo=Ho instanceof zl?Ho:Dl(Ho.href!==void 0?Ho.href:String(Ho)),Ho=Fo.target||Ho.target,qo=[],Fo)switch(os){case"width":case"height":case"top":case"left":qo.push(os+"="+Fo[os]);break;case"target":case"noopener":case"noreferrer":break;default:qo.push(os+"="+(Fo[os]?1:0))}var os=qo.join(",");if((ca("iPhone")&&!ca("iPod")&&!ca("iPad")||ca("iPad")||ca("iPod"))&&Vo.navigator&&Vo.navigator.standalone&&Ho&&Ho!="_self"?(ll(os=xA(document,"A"),"HTMLAnchorElement"),Oo instanceof zl||Oo instanceof zl||(Oo=typeof Oo=="object"&&Oo.ra?Oo.qa():String(Oo),UA.test(Oo)||(Oo="about:invalid#zClosurez"),Oo=new zl(vA,Oo)),os.href=bA(Oo),os.setAttribute("target",Ho),Fo.noreferrer&&os.setAttribute("rel","noreferrer"),(Fo=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,Vo,1),os.dispatchEvent(Fo),os={}):Fo.noreferrer?(os=Vo.open("",Ho,os),Fo=bA(Oo),os&&(GA&&js(Fo,";")&&(Fo="'"+Fo.replace(/'/g,"%27")+"'"),os.opener=null,Fo=xl('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+uA(Fo)+'">'),Vo=os.document)&&(Vo.write(TA(Fo)),Vo.close())):(os=Vo.open(bA(Oo),Ho,os))&&Fo.noopener&&(os.opener=null),os)try{os.focus()}catch{}return os}var Fv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Lv=/^[^@]+@[^@]+$/;function Mh(){var Fo=null;return new vl(function(Oo){Bo.document.readyState=="complete"?Oo():(Fo=function(){Oo()},Fh(window,"load",Fo))}).o(function(Oo){throw QA(window,"load",Fo),Oo})}function Hh(Fo){return Fo=Fo||_A(),!(Gu()!=="file:"&&Gu()!=="ionic:"||!Fo.toLowerCase().match(/iphone|ipad|ipod|android/))}function Gh(){var Fo=Bo.window;try{return Fo&&Fo!=Fo.top}catch{return}}function WA(){return Bo.WorkerGlobalScope!==void 0&&typeof Bo.importScripts=="function"}function oc(){return s.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":s.INTERNAL.hasOwnProperty("node")?"Node":WA()?"Worker":"Browser"}function xg(){var Fo=oc();return Fo==="ReactNative"||Fo==="Node"}var $h="Firefox",Og="Chrome";function Mu(Fo){var Oo=Fo.toLowerCase();return js(Oo,"opera/")||js(Oo,"opr/")||js(Oo,"opios/")?"Opera":js(Oo,"iemobile")?"IEMobile":js(Oo,"msie")||js(Oo,"trident/")?"IE":js(Oo,"edge/")?"Edge":js(Oo,"firefox/")?$h:js(Oo,"silk/")?"Silk":js(Oo,"blackberry")?"Blackberry":js(Oo,"webos")?"Webos":!js(Oo,"safari/")||js(Oo,"chrome/")||js(Oo,"crios/")||js(Oo,"android")?!js(Oo,"chrome/")&&!js(Oo,"crios/")||js(Oo,"edge/")?js(Oo,"android")?"Android":(Fo=Fo.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&Fo.length==2?Fo[1]:"Other":Og:"Safari"}var Qg={jd:"FirebaseCore-web",ld:"FirebaseUI-web"};function Hu(Fo,Oo){Oo=Oo||[];var Ho,Vo=[],qo={};for(Ho in Qg)qo[Qg[Ho]]=!0;for(Ho=0;Ho<Oo.length;Ho++)qo[Oo[Ho]]!==void 0&&(delete qo[Oo[Ho]],Vo.push(Oo[Ho]));return Vo.sort(),(Oo=Vo).length||(Oo=["FirebaseCore-web"]),(Vo=oc())==="Browser"?Vo=Mu(qo=_A()):Vo==="Worker"&&(Vo=Mu(qo=_A())+"-"+Vo),Vo+"/JsCore/"+Fo+"/"+Oo.join(",")}function _A(){return Bo.navigator&&Bo.navigator.userAgent||""}function ql(Fo,Oo){Fo=Fo.split("."),Oo=Oo||Bo;for(var Ho=0;Ho<Fo.length&&typeof Oo=="object"&&Oo!=null;Ho++)Oo=Oo[Fo[Ho]];return Ho!=Fo.length&&(Oo=void 0),Oo}function Vh(){try{var Fo=Bo.localStorage,Oo=wu();if(Fo)return Fo.setItem(Oo,"1"),Fo.removeItem(Oo),!Ph()||!!Bo.indexedDB}catch{return WA()&&!!Bo.indexedDB}return!1}function bu(){return($f()||Gu()==="chrome-extension:"||Hh())&&!xg()&&Vh()&&!WA()}function $f(){return Gu()==="http:"||Gu()==="https:"}function Gu(){return Bo.location&&Bo.location.protocol||null}function Af(Fo){return!Ug(Fo=Fo||_A())&&Mu(Fo)!=$h}function cf(Fo){return Fo===void 0?null:Fg(Fo)}function Pg(Fo){var Oo,Ho={};for(Oo in Fo)Fo.hasOwnProperty(Oo)&&Fo[Oo]!==null&&Fo[Oo]!==void 0&&(Ho[Oo]=Fo[Oo]);return Ho}function $u(Fo){if(Fo!==null)return JSON.parse(Fo)}function wu(Fo){return Fo||Math.floor(1e9*Math.random()).toString()}function Mg(Fo){return Mu(Fo=Fo||_A())!="Safari"&&!Fo.toLowerCase().match(/iphone|ipad|ipod/)}function Hg(){var Fo=Bo.___jsl;if(Fo&&Fo.H){for(var Oo in Fo.H)if(Fo.H[Oo].r=Fo.H[Oo].r||[],Fo.H[Oo].L=Fo.H[Oo].L||[],Fo.H[Oo].r=Fo.H[Oo].L.concat(),Fo.CP)for(var Ho=0;Ho<Fo.CP.length;Ho++)Fo.CP[Ho]=null}}function fu(Fo,Oo){if(Oo<Fo)throw Error("Short delay should be less than long delay!");this.a=Fo,this.c=Oo,Fo=_A(),Oo=oc(),this.b=Ug(Fo)||Oo==="ReactNative"}function Kh(){var Fo=Bo.document;return!Fo||Fo.visibilityState===void 0||Fo.visibilityState=="visible"}function uf(Fo){try{var Oo=new Date(parseInt(Fo,10));if(!isNaN(Oo.getTime())&&!/[^0-9]/.test(Fo))return Oo.toUTCString()}catch{}return null}function Gg(){return ql("fireauth.oauthhelper",Bo)||ql("fireauth.iframe",Bo)}fu.prototype.get=function(){var Fo=Bo.navigator;return!Fo||typeof Fo.onLine!="boolean"||!$f()&&Gu()!=="chrome-extension:"&&Fo.connection===void 0||Fo.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var jh,$g={};function Wh(Fo){$g[Fo]||($g[Fo]=!0,typeof console<"u"&&typeof console.warn=="function"&&console.warn(Fo))}try{var qh={};Object.defineProperty(qh,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(qh,"abcd",{configurable:!0,enumerable:!0,value:2}),jh=qh.abcd==2}catch{jh=!1}function ul(Fo,Oo,Ho){jh?Object.defineProperty(Fo,Oo,{configurable:!0,enumerable:!0,value:Ho}):Fo[Oo]=Ho}function IA(Fo,Oo){if(Oo)for(var Ho in Oo)Oo.hasOwnProperty(Ho)&&ul(Fo,Ho,Oo[Ho])}function hu(Fo){var Oo={};return IA(Oo,Fo),Oo}function zh(Fo){var Oo=Fo;if(typeof Fo=="object"&&Fo!=null)for(var Ho in Oo="length"in Fo?[]:{},Fo)ul(Oo,Ho,zh(Fo[Ho]));return Oo}function Yh(Fo){var Oo=Fo&&(Fo[_d]?"phone":null);if(!(Oo&&Fo&&Fo[Zh]))throw new Ko("internal-error","Internal assert: invalid MultiFactorInfo object");ul(this,"uid",Fo[Zh]),ul(this,"displayName",Fo[Vg]||null);var Ho=null;Fo[Jh]&&(Ho=new Date(Fo[Jh]).toUTCString()),ul(this,"enrollmentTime",Ho),ul(this,"factorId",Oo)}function Xh(Fo){try{var Oo=new ff(Fo)}catch{Oo=null}return Oo}Yh.prototype.v=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Vg="displayName",Jh="enrolledAt",Zh="mfaEnrollmentId",_d="phoneInfo";function ff(Fo){Yh.call(this,Fo),ul(this,"phoneNumber",Fo[_d])}function Dv(Fo){var Oo={},Ho=Fo[Rv],Vo=Fo[Nv],qo=Fo[xv];if(Fo=Xh(Fo[Uv]),!qo||qo!=Vf&&qo!=hf&&!Ho||qo==hf&&!Vo||qo==Id&&!Fo)throw Error("Invalid checkActionCode response!");qo==hf?(Oo[jg]=Ho||null,Oo[Wg]=Ho||null,Oo[Kg]=Vo):(Oo[jg]=Vo||null,Oo[Wg]=Vo||null,Oo[Kg]=Ho||null),Oo[Ov]=Fo||null,ul(this,Pv,qo),ul(this,Qv,zh(Oo))}Jo(ff,Yh),ff.prototype.v=function(){var Fo=ff.Za.v.call(this);return Fo.phoneNumber=this.phoneNumber,Fo};var Id="REVERT_SECOND_FACTOR_ADDITION",Vf="EMAIL_SIGNIN",hf="VERIFY_AND_CHANGE_EMAIL",Rv="email",Uv="mfaInfo",Nv="newEmail",xv="requestType",Kg="email",jg="fromEmail",Ov="multiFactorInfo",Wg="previousEmail",Qv="data",Pv="operation";function Td(Fo){var Oo=PA(Fo=iu(Fo),qg)||null,Ho=PA(Fo,zg)||null,Vo=PA(Fo,Yg)||null;if(Vo=Vo&&$v[Vo]||null,!Oo||!Ho||!Vo)throw new Ko("argument-error",qg+", "+zg+"and "+Yg+" are required in a valid action code URL.");IA(this,{apiKey:Oo,operation:Vo,code:Ho,continueUrl:PA(Fo,Mv)||null,languageCode:PA(Fo,Hv)||null,tenantId:PA(Fo,Gv)||null})}var qg="apiKey",zg="oobCode",Mv="continueUrl",Hv="languageCode",Yg="mode",Gv="tenantId",$v={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:Id,signIn:Vf,verifyAndChangeEmail:hf,verifyEmail:"VERIFY_EMAIL"};function Xg(Fo){try{return new Td(Fo)}catch{return null}}function Kf(Fo){var Oo=Fo[Vv];if(Oo===void 0)throw new Ko("missing-continue-uri");if(typeof Oo!="string"||typeof Oo=="string"&&!Oo.length)throw new Ko("invalid-continue-uri");this.h=Oo,this.b=this.a=null,this.g=!1;var Ho=Fo[Jg];if(Ho&&typeof Ho=="object"){Oo=Ho[rm];var Vo=Ho[tm];if(Ho=Ho[nm],typeof Oo=="string"&&Oo.length){if(this.a=Oo,Vo!==void 0&&typeof Vo!="boolean")throw new Ko("argument-error",tm+" property must be a boolean when specified.");if(this.g=!!Vo,Ho!==void 0&&(typeof Ho!="string"||typeof Ho=="string"&&!Ho.length))throw new Ko("argument-error",nm+" property must be a non empty string when specified.");this.b=Ho||null}else{if(Oo!==void 0)throw new Ko("argument-error",rm+" property must be a non empty string when specified.");if(Vo!==void 0||Ho!==void 0)throw new Ko("missing-android-pkg-name")}}else if(Ho!==void 0)throw new Ko("argument-error",Jg+" property must be a non null object when specified.");if(this.f=null,(Oo=Fo[em])&&typeof Oo=="object"){if(typeof(Oo=Oo[im])=="string"&&Oo.length)this.f=Oo;else if(Oo!==void 0)throw new Ko("argument-error",im+" property must be a non empty string when specified.")}else if(Oo!==void 0)throw new Ko("argument-error",em+" property must be a non null object when specified.");if((Oo=Fo[Sd])!==void 0&&typeof Oo!="boolean")throw new Ko("argument-error",Sd+" property must be a boolean when specified.");if(this.c=!!Oo,(Fo=Fo[Zg])!==void 0&&(typeof Fo!="string"||typeof Fo=="string"&&!Fo.length))throw new Ko("argument-error",Zg+" property must be a non empty string when specified.");this.i=Fo||null}var Jg="android",Zg="dynamicLinkDomain",Sd="handleCodeInApp",em="iOS",Vv="url",tm="installApp",nm="minimumVersion",rm="packageName",im="bundleId";function jf(Fo){var Oo={};for(var Ho in Oo.continueUrl=Fo.h,Oo.canHandleCodeInApp=Fo.c,(Oo.androidPackageName=Fo.a)&&(Oo.androidMinimumVersion=Fo.b,Oo.androidInstallApp=Fo.g),Oo.iOSBundleId=Fo.f,Oo.dynamicLinkDomain=Fo.i,Oo)Oo[Ho]===null&&delete Oo[Ho];return Oo}var df=null;function Kv(Fo){var Oo="";return function(Ho,Vo){function qo(Ys){for(;ns<Ho.length;){var tl=Ho.charAt(ns++),dl=df[tl];if(dl!=null)return dl;if(!/^[\s\xa0]*$/.test(tl))throw Error("Unknown base64 encoding at char: "+tl)}return Ys}(function(){if(!df){df={};for(var Ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),tl=["+/=","+/","-_=","-_.","-_"],dl=0;dl<5;dl++)for(var Il=Ys.concat(tl[dl].split("")),$l=0;$l<Il.length;$l++){var XA=Il[$l];df[XA]===void 0&&(df[XA]=$l)}}})();for(var ns=0;;){var os=qo(-1),As=qo(0),Ts=qo(64),Ns=qo(64);if(Ns===64&&os===-1)break;Vo(os<<2|As>>4),Ts!=64&&(Vo(As<<4&240|Ts>>2),Ns!=64&&Vo(Ts<<6&192|Ns))}}(Fo,function(Ho){Oo+=String.fromCharCode(Ho)}),Oo}function Wf(Fo){var Oo=om(Fo);if(!(Oo&&Oo.sub&&Oo.iss&&Oo.aud&&Oo.exp))throw Error("Invalid JWT");this.g=Fo,this.c=Oo.exp,this.h=Oo.sub,this.a=Oo.provider_id||Oo.firebase&&Oo.firebase.sign_in_provider||null,this.f=Oo.firebase&&Oo.firebase.tenant||null,this.b=!!Oo.is_anonymous||this.a=="anonymous"}function qf(Fo){try{return new Wf(Fo)}catch{return null}}function om(Fo){if(!Fo||(Fo=Fo.split(".")).length!=3)return null;for(var Oo=(4-(Fo=Fo[1]).length%4)%4,Ho=0;Ho<Oo;Ho++)Fo+=".";try{return JSON.parse(Kv(Fo))}catch{}return null}Wf.prototype.S=function(){return this.f},Wf.prototype.i=function(){return this.b},Wf.prototype.toString=function(){return this.g};var sm="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),zf=["client_id","response_type","scope","redirect_uri","state"],Ld={kd:{Ha:"locale",ta:700,sa:600,ea:"facebook.com",Va:zf},md:{Ha:null,ta:500,sa:750,ea:"github.com",Va:zf},nd:{Ha:"hl",ta:515,sa:680,ea:"google.com",Va:zf},td:{Ha:"lang",ta:485,sa:705,ea:"twitter.com",Va:sm},gd:{Ha:"locale",ta:640,sa:600,ea:"apple.com",Va:[]}};function Rd(Fo){for(var Oo in Ld)if(Ld[Oo].ea==Fo)return Ld[Oo];return null}function am(Fo){var Oo={};Oo["facebook.com"]=Am,Oo["google.com"]=um,Oo["github.com"]=cm,Oo["twitter.com"]=fm;var Ho=Fo&&Fo[lm];try{if(Ho)return Oo[Ho]?new Oo[Ho](Fo):new sc(Fo);if(Fo[Ud]!==void 0)return new Nd(Fo)}catch{}return null}var Ud="idToken",lm="providerId";function Nd(Fo){var Oo=Fo[lm];if(!Oo&&Fo[Ud]){var Ho=qf(Fo[Ud]);Ho&&Ho.a&&(Oo=Ho.a)}if(!Oo)throw Error("Invalid additional user info!");Oo!="anonymous"&&Oo!="custom"||(Oo=null),Ho=!1,Fo.isNewUser!==void 0?Ho=!!Fo.isNewUser:Fo.kind==="identitytoolkit#SignupNewUserResponse"&&(Ho=!0),ul(this,"providerId",Oo),ul(this,"isNewUser",Ho)}function sc(Fo){Nd.call(this,Fo),ul(this,"profile",zh((Fo=$u(Fo.rawUserInfo||"{}"))||{}))}function Am(Fo){if(sc.call(this,Fo),this.providerId!="facebook.com")throw Error("Invalid provider ID!")}function cm(Fo){if(sc.call(this,Fo),this.providerId!="github.com")throw Error("Invalid provider ID!");ul(this,"username",this.profile&&this.profile.login||null)}function um(Fo){if(sc.call(this,Fo),this.providerId!="google.com")throw Error("Invalid provider ID!")}function fm(Fo){if(sc.call(this,Fo),this.providerId!="twitter.com")throw Error("Invalid provider ID!");ul(this,"username",Fo.screenName||null)}function hm(Fo){var Oo=iu(Fo),Ho=PA(Oo,"link"),Vo=PA(iu(Ho),"link");return Oo=PA(Oo,"deep_link_id"),PA(iu(Oo),"link")||Oo||Vo||Ho||Fo}function Yf(Fo,Oo){if(!Fo&&!Oo)throw new Ko("internal-error","Internal assert: no raw session string available");if(Fo&&Oo)throw new Ko("internal-error","Internal assert: unable to determine the session type");this.a=Fo||null,this.b=Oo||null,this.type=this.a?pf:Xf}Jo(sc,Nd),Jo(Am,sc),Jo(cm,sc),Jo(um,sc),Jo(fm,sc);var pf="enroll",Xf="signin";function Vu(){}function Ku(Fo,Oo){return Fo.then(function(Ho){if(Ho[YA]){var Vo=qf(Ho[YA]);if(!Vo||Oo!=Vo.h)throw new Ko("user-mismatch");return Ho}throw new Ko("user-mismatch")}).o(function(Ho){throw Ho&&Ho.code&&Ho.code==ss+"user-not-found"?new Ko("user-mismatch"):Ho})}function Eu(Fo,Oo){if(!Oo)throw new Ko("internal-error","failed to construct a credential");this.a=Oo,ul(this,"providerId",Fo),ul(this,"signInMethod",Fo)}function Od(Fo){return{pendingToken:Fo.a,requestUri:"http://localhost"}}function jv(Fo){if(Fo&&Fo.providerId&&Fo.signInMethod&&Fo.providerId.indexOf("saml.")==0&&Fo.pendingToken)try{return new Eu(Fo.providerId,Fo.pendingToken)}catch{}return null}function ou(Fo,Oo,Ho){if(this.a=null,Oo.idToken||Oo.accessToken)Oo.idToken&&ul(this,"idToken",Oo.idToken),Oo.accessToken&&ul(this,"accessToken",Oo.accessToken),Oo.nonce&&!Oo.pendingToken&&ul(this,"nonce",Oo.nonce),Oo.pendingToken&&(this.a=Oo.pendingToken);else{if(!Oo.oauthToken||!Oo.oauthTokenSecret)throw new Ko("internal-error","failed to construct a credential");ul(this,"accessToken",Oo.oauthToken),ul(this,"secret",Oo.oauthTokenSecret)}ul(this,"providerId",Fo),ul(this,"signInMethod",Ho)}function Qd(Fo){var Oo={};return Fo.idToken&&(Oo.id_token=Fo.idToken),Fo.accessToken&&(Oo.access_token=Fo.accessToken),Fo.secret&&(Oo.oauth_token_secret=Fo.secret),Oo.providerId=Fo.providerId,Fo.nonce&&!Fo.a&&(Oo.nonce=Fo.nonce),Oo={postBody:Tg(Oo).toString(),requestUri:"http://localhost"},Fo.a&&(delete Oo.postBody,Oo.pendingToken=Fo.a),Oo}function Wv(Fo){if(Fo&&Fo.providerId&&Fo.signInMethod){var Oo={idToken:Fo.oauthIdToken,accessToken:Fo.oauthTokenSecret?null:Fo.oauthAccessToken,oauthTokenSecret:Fo.oauthTokenSecret,oauthToken:Fo.oauthTokenSecret&&Fo.oauthAccessToken,nonce:Fo.nonce,pendingToken:Fo.pendingToken};try{return new ou(Fo.providerId,Oo,Fo.signInMethod)}catch{}}return null}function Cu(Fo,Oo){this.Oc=Oo||[],IA(this,{providerId:Fo,isOAuthProvider:!0}),this.Fb={},this.lb=(Rd(Fo)||{}).Ha||null,this.kb=null}function dm(Fo){if(typeof Fo!="string"||Fo.indexOf("saml.")!=0)throw new Ko("argument-error",'SAML provider IDs must be prefixed with "saml."');Cu.call(this,Fo,[])}function DA(Fo){Cu.call(this,Fo,zf),this.a=[]}function Bu(){DA.call(this,"facebook.com")}function pm(Fo){if(!Fo)throw new Ko("argument-error","credential failed: expected 1 argument (the OAuth access token).");var Oo=Fo;return $o(Fo)&&(Oo=Fo.accessToken),new Bu().credential({accessToken:Oo})}function Iu(){DA.call(this,"github.com")}function gm(Fo){if(!Fo)throw new Ko("argument-error","credential failed: expected 1 argument (the OAuth access token).");var Oo=Fo;return $o(Fo)&&(Oo=Fo.accessToken),new Iu().credential({accessToken:Oo})}function Tu(){DA.call(this,"google.com"),this.Aa("profile")}function mm(Fo,Oo){var Ho=Fo;return $o(Fo)&&(Ho=Fo.idToken,Oo=Fo.accessToken),new Tu().credential({idToken:Ho,accessToken:Oo})}function ju(){Cu.call(this,"twitter.com",sm)}function _m(Fo,Oo){var Ho=Fo;if($o(Ho)||(Ho={oauthToken:Fo,oauthTokenSecret:Oo}),!Ho.oauthToken||!Ho.oauthTokenSecret)throw new Ko("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new ou("twitter.com",Ho,"twitter.com")}function du(Fo,Oo,Ho){this.a=Fo,this.f=Oo,ul(this,"providerId","password"),ul(this,"signInMethod",Ho===MA.EMAIL_LINK_SIGN_IN_METHOD?MA.EMAIL_LINK_SIGN_IN_METHOD:MA.EMAIL_PASSWORD_SIGN_IN_METHOD)}function qv(Fo){return Fo&&Fo.email&&Fo.password?new du(Fo.email,Fo.password,Fo.signInMethod):null}function MA(){IA(this,{providerId:"password",isOAuthProvider:!1})}function vm(Fo,Oo){if(!(Oo=Pd(Oo)))throw new Ko("argument-error","Invalid email link!");return new du(Fo,Oo.code,MA.EMAIL_LINK_SIGN_IN_METHOD)}function Pd(Fo){return(Fo=Xg(Fo=hm(Fo)))&&Fo.operation===Vf?Fo:null}function pu(Fo){if(!(Fo.bb&&Fo.ab||Fo.Ja&&Fo.da))throw new Ko("internal-error");this.a=Fo,ul(this,"providerId","phone"),this.ea="phone",ul(this,"signInMethod","phone")}function zv(Fo){if(Fo&&Fo.providerId==="phone"&&(Fo.verificationId&&Fo.verificationCode||Fo.temporaryProof&&Fo.phoneNumber)){var Oo={};return ps(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(Ho){Fo[Ho]&&(Oo[Ho]=Fo[Ho])}),new pu(Oo)}return null}function gf(Fo){return Fo.a.Ja&&Fo.a.da?{temporaryProof:Fo.a.Ja,phoneNumber:Fo.a.da}:{sessionInfo:Fo.a.bb,code:Fo.a.ab}}function su(Fo){try{this.a=Fo||s.auth()}catch{throw new Ko("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}IA(this,{providerId:"phone",isOAuthProvider:!1})}function ym(Fo,Oo){if(!Fo)throw new Ko("missing-verification-id");if(!Oo)throw new Ko("missing-verification-code");return new pu({bb:Fo,ab:Oo})}function Md(Fo){if(Fo.temporaryProof&&Fo.phoneNumber)return new pu({Ja:Fo.temporaryProof,da:Fo.phoneNumber});var Oo=Fo&&Fo.providerId;if(!Oo||Oo==="password")return null;var Ho=Fo&&Fo.oauthAccessToken,Vo=Fo&&Fo.oauthTokenSecret,qo=Fo&&Fo.nonce,ns=Fo&&Fo.oauthIdToken,os=Fo&&Fo.pendingToken;try{switch(Oo){case"google.com":return mm(ns,Ho);case"facebook.com":return pm(Ho);case"github.com":return gm(Ho);case"twitter.com":return _m(Ho,Vo);default:return Ho||Vo||ns||os?os?Oo.indexOf("saml.")==0?new Eu(Oo,os):new ou(Oo,{pendingToken:os,idToken:Fo.oauthIdToken,accessToken:Fo.oauthAccessToken},Oo):new DA(Oo).credential({idToken:ns,accessToken:Ho,rawNonce:qo}):null}}catch{return null}}function Hd(Fo){if(!Fo.isOAuthProvider)throw new Ko("invalid-oauth-provider")}function qA(Fo,Oo,Ho,Vo,qo,ns,os){if(this.c=Fo,this.b=Oo||null,this.g=Ho||null,this.f=Vo||null,this.i=ns||null,this.h=os||null,this.a=qo||null,!this.g&&!this.a)throw new Ko("invalid-auth-event");if(this.g&&this.a)throw new Ko("invalid-auth-event");if(this.g&&!this.f)throw new Ko("invalid-auth-event")}function bm(Fo){return(Fo=Fo||{}).type?new qA(Fo.type,Fo.eventId,Fo.urlResponse,Fo.sessionId,Fo.error&&Yo(Fo.error),Fo.postBody,Fo.tenantId):null}function Yv(){this.b=null,this.a=[]}Yf.prototype.Fa=function(){return this.a?ls(this.a):ls(this.b)},Yf.prototype.v=function(){return this.type==pf?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},Vu.prototype.ia=function(){},Vu.prototype.b=function(){},Vu.prototype.c=function(){},Vu.prototype.v=function(){},Eu.prototype.ia=function(Fo){return up(Fo,Od(this))},Eu.prototype.b=function(Fo,Oo){var Ho=Od(this);return Ho.idToken=Oo,fp(Fo,Ho)},Eu.prototype.c=function(Fo,Oo){return Ku(hp(Fo,Od(this)),Oo)},Eu.prototype.v=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},ou.prototype.ia=function(Fo){return up(Fo,Qd(this))},ou.prototype.b=function(Fo,Oo){var Ho=Qd(this);return Ho.idToken=Oo,fp(Fo,Ho)},ou.prototype.c=function(Fo,Oo){return Ku(hp(Fo,Qd(this)),Oo)},ou.prototype.v=function(){var Fo={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(Fo.oauthIdToken=this.idToken),this.accessToken&&(Fo.oauthAccessToken=this.accessToken),this.secret&&(Fo.oauthTokenSecret=this.secret),this.nonce&&(Fo.nonce=this.nonce),this.a&&(Fo.pendingToken=this.a),Fo},Cu.prototype.Ia=function(Fo){return this.Fb=$s(Fo),this},Jo(dm,Cu),Jo(DA,Cu),DA.prototype.Aa=function(Fo){return Us(this.a,Fo)||this.a.push(Fo),this},DA.prototype.Nb=function(){return qs(this.a)},DA.prototype.credential=function(Fo,Oo){var Ho;if(!(Ho=$o(Fo)?{idToken:Fo.idToken||null,accessToken:Fo.accessToken||null,nonce:Fo.rawNonce||null}:{idToken:Fo||null,accessToken:Oo||null}).idToken&&!Ho.accessToken)throw new Ko("argument-error","credential failed: must provide the ID token and/or the access token.");return new ou(this.providerId,Ho,this.providerId)},Jo(Bu,DA),ul(Bu,"PROVIDER_ID","facebook.com"),ul(Bu,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),Jo(Iu,DA),ul(Iu,"PROVIDER_ID","github.com"),ul(Iu,"GITHUB_SIGN_IN_METHOD","github.com"),Jo(Tu,DA),ul(Tu,"PROVIDER_ID","google.com"),ul(Tu,"GOOGLE_SIGN_IN_METHOD","google.com"),Jo(ju,Cu),ul(ju,"PROVIDER_ID","twitter.com"),ul(ju,"TWITTER_SIGN_IN_METHOD","twitter.com"),du.prototype.ia=function(Fo){return this.signInMethod==MA.EMAIL_LINK_SIGN_IN_METHOD?Sl(Fo,vy,{email:this.a,oobCode:this.f}):Sl(Fo,Km,{email:this.a,password:this.f})},du.prototype.b=function(Fo,Oo){return this.signInMethod==MA.EMAIL_LINK_SIGN_IN_METHOD?Sl(Fo,yy,{idToken:Oo,email:this.a,oobCode:this.f}):Sl(Fo,Vm,{idToken:Oo,email:this.a,password:this.f})},du.prototype.c=function(Fo,Oo){return Ku(this.ia(Fo),Oo)},du.prototype.v=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},IA(MA,{PROVIDER_ID:"password"}),IA(MA,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),IA(MA,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),pu.prototype.ia=function(Fo){return Fo.cb(gf(this))},pu.prototype.b=function(Fo,Oo){var Ho=gf(this);return Ho.idToken=Oo,Sl(Fo,My,Ho)},pu.prototype.c=function(Fo,Oo){var Ho=gf(this);return Ho.operation="REAUTH",Ku(Fo=Sl(Fo,Hy,Ho),Oo)},pu.prototype.v=function(){var Fo={providerId:"phone"};return this.a.bb&&(Fo.verificationId=this.a.bb),this.a.ab&&(Fo.verificationCode=this.a.ab),this.a.Ja&&(Fo.temporaryProof=this.a.Ja),this.a.da&&(Fo.phoneNumber=this.a.da),Fo},su.prototype.cb=function(Fo,Oo){var Ho=this.a.b;return ls(Oo.verify()).then(function(Vo){if(typeof Vo!="string")throw new Ko("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(Oo.type){case"recaptcha":var qo=$o(Fo)?Fo.session:null,ns=$o(Fo)?Fo.phoneNumber:Fo;return(qo&&qo.type==pf?qo.Fa().then(function(os){return Sl(Ho,Ry,{idToken:os,phoneEnrollmentInfo:{phoneNumber:ns,recaptchaToken:Vo}}).then(function(As){return As.phoneSessionInfo.sessionInfo})}):qo&&qo.type==Xf?qo.Fa().then(function(os){return As=Ho,Ts={mfaPendingCredential:os,mfaEnrollmentId:Fo.multiFactorHint&&Fo.multiFactorHint.uid||Fo.multiFactorUid,phoneSignInInfo:{recaptchaToken:Vo}},Sl(As,Uy,Ts).then(function(Ns){return Ns.phoneResponseInfo.sessionInfo});var As,Ts}):Sl(Ho,Ly,{phoneNumber:ns,recaptchaToken:Vo})).then(function(os){return typeof Oo.reset=="function"&&Oo.reset(),os},function(os){throw typeof Oo.reset=="function"&&Oo.reset(),os});default:throw new Ko("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},IA(su,{PROVIDER_ID:"phone"}),IA(su,{PHONE_SIGN_IN_METHOD:"phone"}),qA.prototype.getUid=function(){var Fo=[];return Fo.push(this.c),this.b&&Fo.push(this.b),this.f&&Fo.push(this.f),this.h&&Fo.push(this.h),Fo.join("-")},qA.prototype.S=function(){return this.h},qA.prototype.v=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.v()}};var $d,Vd=null;function Kd(Fo){var Oo="unauthorized-domain",Ho=void 0,Vo=iu(Fo);Fo=Vo.b,(Vo=Vo.f)=="chrome-extension"?Ho=_l("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",Fo):Vo=="http"||Vo=="https"?Ho=_l("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",Fo):Oo="operation-not-supported-in-this-environment",Ko.call(this,Oo,Ho)}function mf(Fo,Oo,Ho){Ko.call(this,Fo,Ho),(Fo=Oo||{}).Gb&&ul(this,"email",Fo.Gb),Fo.da&&ul(this,"phoneNumber",Fo.da),Fo.credential&&ul(this,"credential",Fo.credential),Fo.Wb&&ul(this,"tenantId",Fo.Wb)}function Jf(Fo){if(Fo.code){var Oo=Fo.code||"";Oo.indexOf(ss)==0&&(Oo=Oo.substring(ss.length));var Ho={credential:Md(Fo),Wb:Fo.tenantId};if(Fo.email)Ho.Gb=Fo.email;else if(Fo.phoneNumber)Ho.da=Fo.phoneNumber;else if(!Ho.credential)return new Ko(Oo,Fo.message||void 0);return new mf(Oo,Ho,Fo.message)}return null}function _f(){}function wm(Fo){return Fo.c||(Fo.c=Fo.b())}function Zf(){}function Em(Fo){if(Fo.f||typeof XMLHttpRequest<"u"||typeof ActiveXObject>"u")return Fo.f;for(var Oo=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],Ho=0;Ho<Oo.length;Ho++){var Vo=Oo[Ho];try{return new ActiveXObject(Vo),Fo.f=Vo}catch{}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}function eh(){}function Cm(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=Wo(this.oc,this),this.a.onerror=Wo(this.Pb,this),this.a.onprogress=Wo(this.pc,this),this.a.ontimeout=Wo(this.tc,this)}function Wd(Fo,Oo){Fo.readyState=Oo,Fo.onreadystatechange&&Fo.onreadystatechange()}function Yd(Fo,Oo,Ho){this.reset(Fo,Oo,Ho,void 0,void 0)}function Xd(Fo){this.f=Fo,this.b=this.c=this.a=null}function vf(Fo,Oo){this.name=Fo,this.value=Oo}Jo(Kd,Ko),Jo(mf,Ko),mf.prototype.v=function(){var Fo={code:this.code,message:this.message};this.email&&(Fo.email=this.email),this.phoneNumber&&(Fo.phoneNumber=this.phoneNumber),this.tenantId&&(Fo.tenantId=this.tenantId);var Oo=this.credential&&this.credential.v();return Oo&&Xs(Fo,Oo),Fo},mf.prototype.toJSON=function(){return this.v()},_f.prototype.c=null,Jo(Zf,_f),Zf.prototype.a=function(){var Fo=Em(this);return Fo?new ActiveXObject(Fo):new XMLHttpRequest},Zf.prototype.b=function(){var Fo={};return Em(this)&&(Fo[0]=!0,Fo[1]=!0),Fo},$d=new Zf,Jo(eh,_f),eh.prototype.a=function(){var Fo=new XMLHttpRequest;if("withCredentials"in Fo)return Fo;if(typeof XDomainRequest<"u")return new Cm;throw Error("Unsupported browser")},eh.prototype.b=function(){return{}},(c=Cm.prototype).open=function(Fo,Oo,Ho){if(Ho!=null&&!Ho)throw Error("Only async requests are supported.");this.a.open(Fo,Oo)},c.send=function(Fo){if(Fo){if(typeof Fo!="string")throw Error("Only string data is supported");this.a.send(Fo)}else this.a.send()},c.abort=function(){this.a.abort()},c.setRequestHeader=function(){},c.getResponseHeader=function(Fo){return Fo.toLowerCase()=="content-type"?this.a.contentType:""},c.oc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Wd(this,4)},c.Pb=function(){this.status=500,this.response=this.responseText="",Wd(this,4)},c.tc=function(){this.Pb()},c.pc=function(){this.status=200,Wd(this,1)},c.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Yd.prototype.a=null,Yd.prototype.reset=function(Fo,Oo,Ho,Vo,qo){delete this.a},vf.prototype.toString=function(){return this.name};var Bm=new vf("SEVERE",1e3),Jd=new vf("WARNING",900),Xv=new vf("CONFIG",700),Jv=new vf("FINE",500);Xd.prototype.log=function(Fo,Oo,Ho){if(Fo.value>=function Vo(qo){return qo.c?qo.c:qo.a?Vo(qo.a):(Hs("Root logger has no level set."),null)}(this).value)for(Go(Oo)&&(Oo=Oo()),Fo=new Yd(Fo,String(Oo),this.f),Ho&&(Fo.a=Ho),Ho=this;Ho;)Ho=Ho.a};var Im,Zd={},ep=null;function tp(Fo){var Oo;if(ep||(ep=new Xd(""),(Zd[""]=ep).c=Xv),!(Oo=Zd[Fo])){Oo=new Xd(Fo);var Ho=Fo.lastIndexOf("."),Vo=Fo.substr(Ho+1);(Ho=tp(Fo.substr(0,Ho))).b||(Ho.b={}),(Ho.b[Vo]=Oo).a=Ho,Zd[Fo]=Oo}return Oo}function HA(Fo,Oo){Fo&&Fo.log(Jv,Oo,void 0)}function th(Fo){this.f=Fo}function np(Fo){CA.call(this),this.s=Fo,this.readyState=rp,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=tp("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}Jo(th,_f),th.prototype.a=function(){return new np(this.f)},th.prototype.b=(Im={},function(){return Im}),Jo(np,CA);var rp=0;function Tm(Fo){Fo.c.read().then(Fo.nc.bind(Fo)).catch(Fo.Sa.bind(Fo))}function yf(Fo,Oo){Oo&&Fo.f&&(Fo.status=Fo.f.status,Fo.statusText=Fo.f.statusText),Fo.readyState=4,Fo.f=null,Fo.c=null,Fo.l=null,bf(Fo)}function bf(Fo){Fo.onreadystatechange&&Fo.onreadystatechange.call(Fo)}function wf(Fo){CA.call(this),this.headers=new Qu,this.D=Fo||null,this.c=!1,this.B=this.a=null,this.h=this.P=this.l="",this.f=this.O=this.i=this.N=!1,this.g=0,this.s=null,this.m=Sm,this.w=this.R=!1}(c=np.prototype).open=function(Fo,Oo){if(this.readyState!=rp)throw this.abort(),Error("Error reopening a connection");this.m=Fo,this.g=Oo,this.readyState=1,bf(this)},c.send=function(Fo){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.a=!0;var Oo={headers:this.i,method:this.m,credentials:void 0,cache:void 0};Fo&&(Oo.body=Fo),this.s.fetch(new Request(this.g,Oo)).then(this.sc.bind(this),this.Sa.bind(this))},c.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&this.readyState!=4&&(this.a=!1,yf(this,!1)),this.readyState=rp},c.sc=function(Fo){this.a&&(this.f=Fo,this.b||(this.b=Fo.headers,this.readyState=2,bf(this)),this.a&&(this.readyState=3,bf(this),this.a&&(this.responseType==="arraybuffer"?Fo.arrayBuffer().then(this.qc.bind(this),this.Sa.bind(this)):Bo.ReadableStream!==void 0&&"body"in Fo?(this.response=this.responseText="",this.c=Fo.body.getReader(),this.l=new TextDecoder,Tm(this)):Fo.text().then(this.rc.bind(this),this.Sa.bind(this)))))},c.nc=function(Fo){if(this.a){var Oo=this.l.decode(Fo.value?Fo.value:new Uint8Array(0),{stream:!Fo.done});Oo&&(this.response=this.responseText+=Oo),Fo.done?yf(this,!0):bf(this),this.readyState==3&&Tm(this)}},c.rc=function(Fo){this.a&&(this.response=this.responseText=Fo,yf(this,!0))},c.qc=function(Fo){this.a&&(this.response=Fo,yf(this,!0))},c.Sa=function(Fo){var Oo=this.h;Oo&&Oo.log(Jd,"Failed to fetch url "+this.g,Fo instanceof Error?Fo:Error(Fo)),this.a&&yf(this,!0)},c.setRequestHeader=function(Fo,Oo){this.i.append(Fo,Oo)},c.getResponseHeader=function(Fo){return this.b?this.b.get(Fo.toLowerCase())||"":((Fo=this.h)&&Fo.log(Jd,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},c.getAllResponseHeaders=function(){if(!this.b){var Fo=this.h;return Fo&&Fo.log(Jd,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}Fo=[];for(var Oo=this.b.entries(),Ho=Oo.next();!Ho.done;)Ho=Ho.value,Fo.push(Ho[0]+": "+Ho[1]),Ho=Oo.next();return Fo.join(`\r
`)},Jo(wf,CA);var Sm="";wf.prototype.b=tp("goog.net.XhrIo");var Zv=/^https?$/i,ey=["POST","PUT"];function ty(Fo,Oo,Ho,Vo,qo){if(Fo.a)throw Error("[goog.net.XhrIo] Object is active with another request="+Fo.l+"; newUri="+Oo);Ho=Ho?Ho.toUpperCase():"GET",Fo.l=Oo,Fo.h="",Fo.P=Ho,Fo.N=!1,Fo.c=!0,Fo.a=Fo.D?Fo.D.a():$d.a(),Fo.B=Fo.D?wm(Fo.D):wm($d),Fo.a.onreadystatechange=Wo(Fo.Sb,Fo);try{HA(Fo.b,au(Fo,"Opening Xhr")),Fo.O=!0,Fo.a.open(Ho,String(Oo),!0),Fo.O=!1}catch(As){return HA(Fo.b,au(Fo,"Error opening Xhr: "+As.message)),void km(Fo,As)}Oo=Vo||"";var ns,os=new Qu(Fo.headers);qo&&function(As,Ts){if(As.forEach&&typeof As.forEach=="function")As.forEach(Ts,void 0);else if(Mo(As)||typeof As=="string")ps(As,Ts,void 0);else for(var Ns=Eg(As),Ys=wg(As),tl=Ys.length,dl=0;dl<tl;dl++)Ts.call(void 0,Ys[dl],Ns&&Ns[dl],As)}(qo,function(As,Ts){os.set(Ts,As)}),qo=function(As){e:{for(var Ts=ny,Ns=As.length,Ys=typeof As=="string"?As.split(""):As,tl=0;tl<Ns;tl++)if(tl in Ys&&Ts.call(void 0,Ys[tl],tl,As)){Ts=tl;break e}Ts=-1}return Ts<0?null:typeof As=="string"?As.charAt(Ts):As[Ts]}(os.X()),Vo=Bo.FormData&&Oo instanceof Bo.FormData,!Us(ey,Ho)||qo||Vo||os.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),os.forEach(function(As,Ts){this.a.setRequestHeader(Ts,As)},Fo),Fo.m&&(Fo.a.responseType=Fo.m),"withCredentials"in Fo.a&&Fo.a.withCredentials!==Fo.R&&(Fo.a.withCredentials=Fo.R);try{Dm(Fo),0<Fo.g&&(Fo.w=(ns=Fo.a,Ml&&oA(9)&&typeof ns.timeout=="number"&&ns.ontimeout!==void 0),HA(Fo.b,au(Fo,"Will abort after "+Fo.g+"ms if incomplete, xhr2 "+Fo.w)),Fo.w?(Fo.a.timeout=Fo.g,Fo.a.ontimeout=Wo(Fo.Ka,Fo)):Fo.s=Uh(Fo.Ka,Fo.g,Fo)),HA(Fo.b,au(Fo,"Sending request")),Fo.i=!0,Fo.a.send(Oo),Fo.i=!1}catch(As){HA(Fo.b,au(Fo,"Send error: "+As.message)),km(Fo,As)}}function ny(Fo){return Fo.toLowerCase()=="content-type"}function km(Fo,Oo){Fo.c=!1,Fo.a&&(Fo.f=!0,Fo.a.abort(),Fo.f=!1),Fo.h=Oo,Fm(Fo),nh(Fo)}function Fm(Fo){Fo.N||(Fo.N=!0,Fo.dispatchEvent("complete"),Fo.dispatchEvent("error"))}function Lm(Fo){if(Fo.c&&Co!==void 0){if(Fo.B[1]&&Ef(Fo)==4&&rh(Fo)==2)HA(Fo.b,au(Fo,"Local request error detected and ignored"));else if(Fo.i&&Ef(Fo)==4)Uh(Fo.Sb,0,Fo);else if(Fo.dispatchEvent("readystatechange"),Ef(Fo)==4){HA(Fo.b,au(Fo,"Request complete")),Fo.c=!1;try{var Oo,Ho=rh(Fo);e:switch(Ho){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var Vo=!0;break e;default:Vo=!1}if(!(Oo=Vo)){var qo;if(qo=Ho===0){var ns=String(Fo.l).match(Cg)[1]||null;if(!ns&&Bo.self&&Bo.self.location){var os=Bo.self.location.protocol;ns=os.substr(0,os.length-1)}qo=!Zv.test(ns?ns.toLowerCase():"")}Oo=qo}if(Oo)Fo.dispatchEvent("complete"),Fo.dispatchEvent("success");else{try{var As=2<Ef(Fo)?Fo.a.statusText:""}catch(Ts){HA(Fo.b,"Can not get status: "+Ts.message),As=""}Fo.h=As+" ["+rh(Fo)+"]",Fm(Fo)}}finally{nh(Fo)}}}}function nh(Fo,Oo){if(Fo.a){Dm(Fo);var Ho=Fo.a,Vo=Fo.B[0]?Qo:null;Fo.a=null,Fo.B=null,Oo||Fo.dispatchEvent("ready");try{Ho.onreadystatechange=Vo}catch(qo){(Fo=Fo.b)&&Fo.log(Bm,"Problem encountered resetting onreadystatechange: "+qo.message,void 0)}}}function Dm(Fo){Fo.a&&Fo.w&&(Fo.a.ontimeout=null),Fo.s&&(Bo.clearTimeout(Fo.s),Fo.s=null)}function Ef(Fo){return Fo.a?Fo.a.readyState:0}function rh(Fo){try{return 2<Ef(Fo)?Fo.a.status:-1}catch{return-1}}function au(Fo,Oo){return Oo+" ["+Fo.P+" "+Fo.l+" "+rh(Fo)+"]"}function Su(Fo){var Oo=ry;this.g=[],this.w=Oo,this.s=Fo||null,this.f=this.a=!1,this.c=void 0,this.u=this.B=this.i=!1,this.h=0,this.b=null,this.l=0}function Cf(Fo,Oo,Ho){Fo.a=!0,Fo.c=Ho,Fo.f=!Oo,Um(Fo)}function ih(Fo){if(Fo.a){if(!Fo.u)throw new oh;Fo.u=!1}}function ip(Fo,Oo,Ho,Vo){Fo.g.push([Oo,Ho,Vo]),Fo.a&&Um(Fo)}function Rm(Fo){return Ss(Fo.g,function(Oo){return Go(Oo[1])})}function Um(Fo){if(Fo.h&&Fo.a&&Rm(Fo)){var Oo=Fo.h,Ho=sh[Oo];Ho&&(Bo.clearTimeout(Ho.a),delete sh[Oo]),Fo.h=0}Fo.b&&(Fo.b.l--,delete Fo.b),Oo=Fo.c;for(var Vo=Ho=!1;Fo.g.length&&!Fo.i;){var qo=Fo.g.shift(),ns=qo[0],os=qo[1];if(qo=qo[2],ns=Fo.f?os:ns)try{var As=ns.call(qo||Fo.s,Oo);As!==void 0&&(Fo.f=Fo.f&&(As==Oo||As instanceof Error),Fo.c=Oo=As),(gs(Oo)||typeof Bo.Promise=="function"&&Oo instanceof Bo.Promise)&&(Vo=!0,Fo.i=!0)}catch(Ts){Oo=Ts,Fo.f=!0,Rm(Fo)||(Ho=!0)}}Fo.c=Oo,Vo&&(As=Wo(Fo.m,Fo,!0),Vo=Wo(Fo.m,Fo,!1),Oo instanceof Su?(ip(Oo,As,Vo),Oo.B=!0):Oo.then(As,Vo)),Ho&&(Oo=new Nm(Oo),sh[Oo.a]=Oo,Fo.h=Oo.a)}function oh(){Is.call(this)}function Bf(){Is.call(this)}function Nm(Fo){this.a=Bo.setTimeout(Wo(this.c,this),0),this.b=Fo}(c=wf.prototype).Ka=function(){Co!==void 0&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",HA(this.b,au(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},c.abort=function(){this.a&&this.c&&(HA(this.b,au(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),nh(this))},c.Ba=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),nh(this,!0)),wf.Za.Ba.call(this)},c.Sb=function(){this.wa||(this.O||this.i||this.f?Lm(this):this.Hc())},c.Hc=function(){Lm(this)},c.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Sm:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var Fo=this.b;return Fo&&Fo.log(Bm,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(Oo){return HA(this.b,"Can not get response: "+Oo.message),null}},Su.prototype.cancel=function(Fo){if(this.a)this.c instanceof Su&&this.c.cancel();else{if(this.b){var Oo=this.b;delete this.b,Fo?Oo.cancel(Fo):(Oo.l--,Oo.l<=0&&Oo.cancel())}this.w?this.w.call(this.s,this):this.u=!0,this.a||(Fo=new Bf,ih(this),Cf(this,!1,Fo))}},Su.prototype.m=function(Fo,Oo){this.i=!1,Cf(this,Fo,Oo)},Su.prototype.then=function(Fo,Oo,Ho){var Vo,qo,ns=new vl(function(os,As){Vo=os,qo=As});return ip(this,Vo,function(os){os instanceof Bf?ns.cancel():qo(os)}),ns.then(Fo,Oo,Ho)},Su.prototype.$goog_Thenable=!0,Jo(oh,Is),oh.prototype.message="Deferred has already fired",oh.prototype.name="AlreadyCalledError",Jo(Bf,Is),Bf.prototype.message="Deferred was canceled",Bf.prototype.name="CanceledError",Nm.prototype.c=function(){throw delete sh[this.a],this.b};var sh={};function op(Fo){var Oo,Ho,Vo,qo,ns,os=document,As=Cl(Fo).toString(),Ts=xA(document,"SCRIPT"),Ns={Tb:Ts,Ka:void 0},Ys=new Su(Ns);return Oo=window.setTimeout(function(){ah(Ts,!0);var tl=new sp(oy,"Timeout reached for loading script "+As);ih(Ys),Cf(Ys,!1,tl)},5e3),Ns.Ka=Oo,Ts.onload=Ts.onreadystatechange=function(){Ts.readyState&&Ts.readyState!="loaded"&&Ts.readyState!="complete"||(ah(Ts,!1,Oo),ih(Ys),Cf(Ys,!0,null))},Ts.onerror=function(){ah(Ts,!0,Oo);var tl=new sp(iy,"Error while loading script "+As);ih(Ys),Cf(Ys,!1,tl)},Xs(Ns={},{type:"text/javascript",charset:"UTF-8"}),EA(Ts,Ns),Vo=Fo,ll(Ho=Ts,"HTMLScriptElement"),Ho.src=Cl(Vo),Uo===null&&(Uo=(Vo=(Vo=Bo.document).querySelector&&Vo.querySelector("script[nonce]"))&&(Vo=Vo.nonce||Vo.getAttribute("nonce"))&&Lo.test(Vo)?Vo:""),(Vo=Uo)&&Ho.setAttribute("nonce",Vo),((ns=((qo=os)||document).getElementsByTagName("HEAD"))&&ns.length!=0?ns[0]:qo.documentElement).appendChild(Ts),Ys}function ry(){if(this&&this.Tb){var Fo=this.Tb;Fo&&Fo.tagName=="SCRIPT"&&ah(Fo,!0,this.Ka)}}function ah(Fo,Oo,Ho){Ho!=null&&Bo.clearTimeout(Ho),Fo.onload=Qo,Fo.onerror=Qo,Fo.onreadystatechange=Qo,Oo&&window.setTimeout(function(){Fo&&Fo.parentNode&&Fo.parentNode.removeChild(Fo)},0)}var iy=0,oy=1;function sp(Fo,Oo){var Ho="Jsloader error (code #"+Fo+")";Oo&&(Ho+=": "+Oo),Is.call(this,Ho),this.code=Fo}function lh(Fo){this.f=Fo}function zA(Fo,Oo,Ho){if(this.c=Fo,Fo=Oo||{},this.u=Fo.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=Fo.secureTokenTimeout||sy,this.g=$s(Fo.secureTokenHeaders||ay),this.h=Fo.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.l=Fo.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.i=Fo.firebaseTimeout||ly,this.a=$s(Fo.firebaseHeaders||Ay),Ho&&(this.a["X-Client-Version"]=Ho,this.g["X-Client-Version"]=Ho),Ho=oc()=="Node",!(Ho=Bo.XMLHttpRequest||Ho&&s.INTERNAL.node&&s.INTERNAL.node.XMLHttpRequest)&&!WA())throw new Ko("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,WA()?this.f=new th(self):xg()?this.f=new lh(Ho):this.f=new eh,this.b=null}Jo(sp,Is),Jo(lh,_f),lh.prototype.a=function(){return new this.f},lh.prototype.b=function(){return{}};var ap,YA="idToken",sy=new fu(3e4,6e4),ay={"Content-Type":"application/x-www-form-urlencoded"},ly=new fu(3e4,6e4),Ay={"Content-Type":"application/json"};function xm(Fo,Oo){Oo?Fo.a["X-Firebase-Locale"]=Oo:delete Fo.a["X-Firebase-Locale"]}function Om(Fo,Oo){Oo?(Fo.a["X-Client-Version"]=Oo,Fo.g["X-Client-Version"]=Oo):(delete Fo.a["X-Client-Version"],delete Fo.g["X-Client-Version"])}function Qm(Fo,Oo,Ho,Vo,qo,ns,os){var As;(Fo=!((As=Mu(As=_A())==Og&&(As=As.match(/\sChrome\/(\d+)/i))&&As.length==2?parseInt(As[1],10):null)&&As<30||Ml&&bl&&!(9<bl))||WA()?Wo(Fo.w,Fo):(ap=ap||new vl(function(Ts,Ns){(function(Ys,tl){((window.gapi||{}).client||{}).request?Ys():(Bo[Pm]=function(){((window.gapi||{}).client||{}).request?Ys():tl(Error("CORS_UNSUPPORTED"))},function(dl,Il){ip(dl,null,Il,void 0)}(op(Ul(cy,{onload:Pm})),function(){tl(Error("CORS_UNSUPPORTED"))}))})(Ts,Ns)}),Wo(Fo.s,Fo)))(Oo,Ho,Vo,qo,ns,os)}zA.prototype.S=function(){return this.b},zA.prototype.w=function(Fo,Oo,Ho,Vo,qo,ns){if(WA()&&(Bo.fetch===void 0||Bo.Headers===void 0||Bo.Request===void 0))throw new Ko("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var os=new wf(this.f);if(ns){os.g=Math.max(0,ns);var As=setTimeout(function(){os.dispatchEvent("timeout")},ns)}bg(os,"complete",function(){As&&clearTimeout(As);var Ts=null;try{Ts=JSON.parse(function(Ns){try{return Ns.a?Ns.a.responseText:""}catch(Ys){return HA(Ns.b,"Can not get responseText: "+Ys.message),""}}(this))||null}catch{Ts=null}Oo&&Oo(Ts)}),Rh(os,"ready",function(){As&&clearTimeout(As),nA(this)}),Rh(os,"timeout",function(){As&&clearTimeout(As),nA(this),Oo&&Oo(null)}),ty(os,Fo,Ho,Vo,qo)};var cy=new sl(El,"https://apis.google.com/js/client.js?onload=%{onload}"),Pm="__fcb"+Math.floor(1e6*Math.random()).toString();function uy(Fo,Oo,Ho,Vo,qo,ns,os){var As=iu(Oo+Ho);aA(As,"key",Fo.c),os&&aA(As,"cb",is().toString());var Ts=Vo=="GET";if(Ts)for(var Ns in qo)qo.hasOwnProperty(Ns)&&aA(As,Ns,qo[Ns]);return new vl(function(Ys,tl){Qm(Fo,As.toString(),function(dl){dl?dl.error?tl(pp(dl,ns||{})):Ys(dl):tl(new Ko("network-request-failed"))},Vo,Ts?void 0:Fg(Pg(qo)),Fo.a,Fo.i.get())})}function ku(Fo){if(typeof(Fo=Fo.email)!="string"||!Lv.test(Fo))throw new Ko("invalid-email")}function Mm(Fo){"email"in Fo&&ku(Fo)}function FA(Fo){if(!Fo[YA])throw Fo.mfaPendingCredential?new Ko("multi-factor-auth-required",null,$s(Fo)):new Ko("internal-error")}function lp(Fo){if(Fo.phoneNumber||Fo.temporaryProof){if(!Fo.phoneNumber||!Fo.temporaryProof)throw new Ko("internal-error")}else{if(!Fo.sessionInfo)throw new Ko("missing-verification-id");if(!Fo.code)throw new Ko("missing-verification-code")}}zA.prototype.s=function(Fo,Oo,Ho,Vo,qo){var ns=this;ap.then(function(){window.gapi.client.setApiKey(ns.c);var os=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:Fo,method:Ho,body:Vo,headers:qo,authType:"none",callback:function(As){window.gapi.auth.setToken(os),Oo&&Oo(As)}})}).o(function(os){Oo&&Oo({error:{message:os&&os.message||"CORS_UNSUPPORTED"}})})},zA.prototype.vb=function(){return Sl(this,Dy,{})},zA.prototype.xb=function(Fo,Oo){return Sl(this,$m,{idToken:Fo,email:Oo})},zA.prototype.yb=function(Fo,Oo){return Sl(this,Vm,{idToken:Fo,password:Oo})};var fy={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Hm(Fo){if(!Fo.phoneVerificationInfo)throw new Ko("internal-error");if(!Fo.phoneVerificationInfo.sessionInfo)throw new Ko("missing-verification-id");if(!Fo.phoneVerificationInfo.code)throw new Ko("missing-verification-code")}function Ap(Fo){if(!Fo.requestUri||!Fo.sessionId&&!Fo.postBody&&!Fo.pendingToken)throw new Ko("internal-error")}function cp(Fo,Oo){return Oo.oauthIdToken&&Oo.providerId&&Oo.providerId.indexOf("oidc.")==0&&!Oo.pendingToken&&(Fo.sessionId?Oo.nonce=Fo.sessionId:Fo.postBody&&Qh(Fo=new vu(Fo.postBody),"nonce")&&(Oo.nonce=Fo.get("nonce"))),Oo}function Gm(Fo){var Oo=null;if(Fo.needConfirmation?(Fo.code="account-exists-with-different-credential",Oo=Jf(Fo)):Fo.errorMessage=="FEDERATED_USER_ID_ALREADY_LINKED"?(Fo.code="credential-already-in-use",Oo=Jf(Fo)):Fo.errorMessage=="EMAIL_EXISTS"?(Fo.code="email-already-in-use",Oo=Jf(Fo)):Fo.errorMessage&&(Oo=jm(Fo.errorMessage)),Oo)throw Oo;FA(Fo)}function up(Fo,Oo){return Oo.returnIdpCredential=!0,Sl(Fo,Ny,Oo)}function fp(Fo,Oo){return Oo.returnIdpCredential=!0,Sl(Fo,Oy,Oo)}function hp(Fo,Oo){return Oo.returnIdpCredential=!0,Oo.autoCreate=!1,Sl(Fo,xy,Oo)}function dp(Fo){if(!Fo.oobCode)throw new Ko("invalid-action-code")}(c=zA.prototype).zb=function(Fo,Oo){var Ho={idToken:Fo},Vo=[];return cl(fy,function(qo,ns){var os=Oo[ns];os===null?Vo.push(qo):ns in Oo&&(Ho[ns]=os)}),Vo.length&&(Ho.deleteAttribute=Vo),Sl(this,$m,Ho)},c.rb=function(Fo,Oo){return Xs(Fo={requestType:"PASSWORD_RESET",email:Fo},Oo),Sl(this,Ty,Fo)},c.sb=function(Fo,Oo){return Xs(Fo={requestType:"EMAIL_SIGNIN",email:Fo},Oo),Sl(this,Cy,Fo)},c.qb=function(Fo,Oo){return Xs(Fo={requestType:"VERIFY_EMAIL",idToken:Fo},Oo),Sl(this,By,Fo)},c.Ab=function(Fo,Oo,Ho){return Xs(Fo={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:Fo,newEmail:Oo},Ho),Sl(this,Iy,Fo)},c.cb=function(Fo){return Sl(this,Py,Fo)},c.jb=function(Fo,Oo){return Sl(this,Fy,{oobCode:Fo,newPassword:Oo})},c.Pa=function(Fo){return Sl(this,dy,{oobCode:Fo})},c.fb=function(Fo){return Sl(this,hy,{oobCode:Fo})};var hy={endpoint:"setAccountInfo",A:dp,Y:"email",C:!0},dy={endpoint:"resetPassword",A:dp,G:function(Fo){var Oo=Fo.requestType;if(!Oo||!Fo.email&&Oo!="EMAIL_SIGNIN"&&Oo!="VERIFY_AND_CHANGE_EMAIL")throw new Ko("internal-error")},C:!0},py={endpoint:"signupNewUser",A:function(Fo){if(ku(Fo),!Fo.password)throw new Ko("weak-password")},G:FA,U:!0,C:!0},gy={endpoint:"createAuthUri",C:!0},my={endpoint:"deleteAccount",M:["idToken"]},_y={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],A:function(Fo){if(Po(Fo.deleteProvider)!="array")throw new Ko("internal-error")}},vy={endpoint:"emailLinkSignin",M:["email","oobCode"],A:ku,G:FA,U:!0,C:!0},yy={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],A:ku,G:FA,U:!0},by={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],A:Hm,G:FA,C:!0,La:!0},wy={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],A:Hm,G:FA,C:!0,La:!0},Ey={endpoint:"getAccountInfo"},Cy={endpoint:"getOobConfirmationCode",M:["requestType"],A:function(Fo){if(Fo.requestType!="EMAIL_SIGNIN")throw new Ko("internal-error");ku(Fo)},Y:"email",C:!0},By={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],A:function(Fo){if(Fo.requestType!="VERIFY_EMAIL")throw new Ko("internal-error")},Y:"email",C:!0},Iy={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],A:function(Fo){if(Fo.requestType!="VERIFY_AND_CHANGE_EMAIL")throw new Ko("internal-error")},Y:"email",C:!0},Ty={endpoint:"getOobConfirmationCode",M:["requestType"],A:function(Fo){if(Fo.requestType!="PASSWORD_RESET")throw new Ko("internal-error");ku(Fo)},Y:"email",C:!0},Sy={hb:!0,endpoint:"getProjectConfig",Rb:"GET"},ky={hb:!0,endpoint:"getRecaptchaParam",Rb:"GET",G:function(Fo){if(!Fo.recaptchaSiteKey)throw new Ko("internal-error")}},Fy={endpoint:"resetPassword",A:dp,Y:"email",C:!0},Ly={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Y:"sessionInfo",C:!0},$m={endpoint:"setAccountInfo",M:["idToken"],A:Mm,U:!0},Vm={endpoint:"setAccountInfo",M:["idToken"],A:function(Fo){if(Mm(Fo),!Fo.password)throw new Ko("weak-password")},G:FA,U:!0},Dy={endpoint:"signupNewUser",G:FA,U:!0,C:!0},Ry={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],A:function(Fo){if(!Fo.phoneEnrollmentInfo)throw new Ko("internal-error");if(!Fo.phoneEnrollmentInfo.phoneNumber)throw new Ko("missing-phone-number");if(!Fo.phoneEnrollmentInfo.recaptchaToken)throw new Ko("missing-app-credential")},G:function(Fo){if(!Fo.phoneSessionInfo||!Fo.phoneSessionInfo.sessionInfo)throw new Ko("internal-error")},C:!0,La:!0},Uy={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(Fo){if(!Fo.phoneSignInInfo||!Fo.phoneSignInInfo.recaptchaToken)throw new Ko("missing-app-credential")},G:function(Fo){if(!Fo.phoneResponseInfo||!Fo.phoneResponseInfo.sessionInfo)throw new Ko("internal-error")},C:!0,La:!0},Ny={endpoint:"verifyAssertion",A:Ap,Wa:cp,G:Gm,U:!0,C:!0},xy={endpoint:"verifyAssertion",A:Ap,Wa:cp,G:function(Fo){if(Fo.errorMessage&&Fo.errorMessage=="USER_NOT_FOUND")throw new Ko("user-not-found");if(Fo.errorMessage)throw jm(Fo.errorMessage);FA(Fo)},U:!0,C:!0},Oy={endpoint:"verifyAssertion",A:function(Fo){if(Ap(Fo),!Fo.idToken)throw new Ko("internal-error")},Wa:cp,G:Gm,U:!0},Qy={endpoint:"verifyCustomToken",A:function(Fo){if(!Fo.token)throw new Ko("invalid-custom-token")},G:FA,U:!0,C:!0},Km={endpoint:"verifyPassword",A:function(Fo){if(ku(Fo),!Fo.password)throw new Ko("wrong-password")},G:FA,U:!0,C:!0},Py={endpoint:"verifyPhoneNumber",A:lp,G:FA,C:!0},My={endpoint:"verifyPhoneNumber",A:function(Fo){if(!Fo.idToken)throw new Ko("internal-error");lp(Fo)},G:function(Fo){if(Fo.temporaryProof)throw Fo.code="credential-already-in-use",Jf(Fo);FA(Fo)}},Hy={Eb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:lp,G:FA,C:!0},Gy={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],G:function(Fo){if(!!Fo[YA]^!!Fo.refreshToken)throw new Ko("internal-error")},C:!0,La:!0};function Sl(Fo,Oo,Ho){if(!function(os,As){if(!As||!As.length)return 1;if(os){for(var Ts=0;Ts<As.length;Ts++){var Ns=os[As[Ts]];if(Ns==null||Ns==="")return}return 1}}(Ho,Oo.M))return ws(new Ko("internal-error"));var Vo,qo=!!Oo.La,ns=Oo.Rb||"POST";return ls(Ho).then(Oo.A).then(function(){return Oo.U&&(Ho.returnSecureToken=!0),Oo.C&&Fo.b&&Ho.tenantId===void 0&&(Ho.tenantId=Fo.b),uy(Fo,qo?Fo.l:Fo.h,Oo.endpoint,ns,Ho,Oo.Eb,Oo.hb||!1)}).then(function(os){return Vo=os,Oo.Wa?Oo.Wa(Ho,Vo):Vo}).then(Oo.G).then(function(){if(!Oo.Y)return Vo;if(!(Oo.Y in Vo))throw new Ko("internal-error");return Vo[Oo.Y]})}function jm(Fo){return pp({error:{errors:[{message:Fo}],code:400,message:Fo}})}function pp(Fo,Oo){var Ho=(Fo.error&&Fo.error.errors&&Fo.error.errors[0]||{}).reason||"",Vo={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(Ho=Vo[Ho]?new Ko(Vo[Ho]):null)return Ho;for(var qo in Ho=Fo.error&&Fo.error.message||"",Xs(Vo={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},Oo||{}),Oo=(Oo=Ho.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<Oo.length?Oo[1]:void 0,Vo)if(Ho.indexOf(qo)===0)return new Ko(Vo[qo],Oo);return!Oo&&Fo&&(Oo=cf(Fo)),new Ko("internal-error",Oo)}function $y(Fo){var Oo;this.b=Fo,this.a=null,this.nb=(Oo=this,(gp=gp||new vl(function(Ho,Vo){function qo(){Hg(),ql("gapi.load")("gapi.iframes",{callback:Ho,ontimeout:function(){Hg(),Vo(Error("Network Error"))},timeout:Ky.get()})}if(ql("gapi.iframes.Iframe"))Ho();else if(ql("gapi.load"))qo();else{var ns="__iframefcb"+Math.floor(1e6*Math.random()).toString();Bo[ns]=function(){ql("gapi.load")?qo():Vo(Error("Network Error"))},ls(op(ns=Ul(Vy,{onload:ns}))).o(function(){Vo(Error("Network Error"))})}}).o(function(Ho){throw gp=null,Ho})).then(function(){return new vl(function(Ho,Vo){ql("gapi.iframes.getContext")().open({where:document.body,url:Oo.b,messageHandlersFilter:ql("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(qo){function ns(){clearTimeout(os),Ho()}Oo.a=qo,Oo.a.restyle({setHideOnLeave:!1});var os=setTimeout(function(){Vo(Error("Network Error"))},jy.get());qo.ping(ns).then(ns,function(){Vo(Error("Network Error"))})})})}))}var Vy=new sl(El,"https://apis.google.com/js/api.js?onload=%{onload}"),Ky=new fu(3e4,6e4),jy=new fu(5e3,15e3),gp=null;function Wm(Fo,Oo,Ho){this.i=Fo,this.g=Oo,this.h=Ho,this.f=null,this.a=Bg(this.i,"/__/auth/iframe"),aA(this.a,"apiKey",this.g),aA(this.a,"appName",this.h),this.b=null,this.c=[]}function mp(Fo,Oo,Ho,Vo,qo){this.s=Fo,this.m=Oo,this.c=Ho,this.u=Vo,this.i=this.g=this.l=null,this.a=qo,this.h=this.f=null}function _p(Fo){try{return s.app(Fo).auth().Ea()}catch{return[]}}function qm(Fo,Oo,Ho,Vo,qo){this.u=Fo,this.f=Oo,this.b=Ho,this.c=Vo||null,this.h=qo||null,this.m=this.s=this.w=null,this.g=[],this.l=this.a=null}function zm(Fo){var Oo=lf();return Sl(Fo,Sy,{}).then(function(Ho){return Ho.authorizedDomains||[]}).then(function(Ho){e:{var Vo=iu(Oo),qo=Vo.f;Vo=Vo.b;for(var ns=0;ns<Ho.length;ns++){var os=Ho[ns],As=Vo,Ts=qo;if(As=os.indexOf("chrome-extension://")==0?iu(os).b==As&&Ts=="chrome-extension":(Ts=="http"||Ts=="https")&&(Fv.test(os)?As==os:(os=os.split(".").join("\\."),new RegExp("^(.+\\."+os+"|"+os+")$","i").test(As)))){Ho=!0;break e}}Ho=!1}if(!Ho)throw new Kd(lf())})}function Ym(Fo){return Fo.l||(Fo.l=Mh().then(function(){if(!Fo.s){var Oo=Fo.c,Ho=Fo.h,Vo=_p(Fo.b),qo=new Wm(Fo.u,Fo.f,Fo.b);qo.f=Oo,qo.b=Ho,qo.c=qs(Vo||[]),Fo.s=qo.toString()}Fo.i=new $y(Fo.s),function(ns){if(!ns.i)throw Error("IfcHandler must be initialized!");(function(os,As){os.nb.then(function(){os.a.register("authEvent",As,ql("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})(ns.i,function(os){var As={};if(os&&os.authEvent){var Ts=!1;for(os=bm(os.authEvent),As=0;As<ns.g.length;As++)Ts=ns.g[As](os)||Ts;return(As={}).status=Ts?"ACK":"ERROR",ls(As)}return As.status="ERROR",ls(As)})}(Fo)})),Fo.l}function Xm(Fo){return Fo.m||(Fo.w=Fo.c?Hu(Fo.c,_p(Fo.b)):null,Fo.m=new zA(Fo.f,us(Fo.h),Fo.w)),Fo.m}function If(Fo,Oo,Ho,Vo,qo,ns,os,As,Ts,Ns,Ys){return(Fo=new mp(Fo,Oo,Ho,Vo,qo)).l=ns,Fo.g=os,Fo.i=As,Fo.b=$s(Ts||null),Fo.f=Ns,Fo.ub(Ys).toString()}function Jm(Fo){if(this.a=Fo||s.INTERNAL.reactNative&&s.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Ko("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Zm(Fo){this.b=Fo,this.a={},this.f=Wo(this.c,this)}Wm.prototype.toString=function(){return this.f?aA(this.a,"v",this.f):ZA(this.a.a,"v"),this.b?aA(this.a,"eid",this.b):ZA(this.a.a,"eid"),this.c.length?aA(this.a,"fw",this.c.join(",")):ZA(this.a.a,"fw"),this.a.toString()},mp.prototype.ub=function(Fo){return this.h=Fo,this},mp.prototype.toString=function(){var Fo=Bg(this.s,"/__/auth/handler");if(aA(Fo,"apiKey",this.m),aA(Fo,"appName",this.c),aA(Fo,"authType",this.u),this.a.isOAuthProvider){var Oo=this.a;try{var Ho=s.app(this.c).auth().ja()}catch{Ho=null}for(var Vo in Oo.kb=Ho,aA(Fo,"providerId",this.a.providerId),Ho=Pg((Oo=this.a).Fb))Ho[Vo]=Ho[Vo].toString();Vo=Oo.Oc,Ho=$s(Ho);for(var qo=0;qo<Vo.length;qo++){var ns=Vo[qo];ns in Ho&&delete Ho[ns]}Oo.lb&&Oo.kb&&!Ho[Oo.lb]&&(Ho[Oo.lb]=Oo.kb),Ms(Ho)||aA(Fo,"customParameters",cf(Ho))}if(typeof this.a.Nb=="function"&&(Oo=this.a.Nb()).length&&aA(Fo,"scopes",Oo.join(",")),this.l?aA(Fo,"redirectUrl",this.l):ZA(Fo.a,"redirectUrl"),this.g?aA(Fo,"eventId",this.g):ZA(Fo.a,"eventId"),this.i?aA(Fo,"v",this.i):ZA(Fo.a,"v"),this.b)for(var os in this.b)this.b.hasOwnProperty(os)&&!PA(Fo,os)&&aA(Fo,os,this.b[os]);return this.h?aA(Fo,"tid",this.h):ZA(Fo.a,"tid"),this.f?aA(Fo,"eid",this.f):ZA(Fo.a,"eid"),(os=_p(this.c)).length&&aA(Fo,"fw",os.join(",")),Fo.toString()},(c=qm.prototype).Lb=function(Fo,Oo,Ho){var Vo=new Ko("popup-closed-by-user"),qo=new Ko("web-storage-unsupported"),ns=this,os=!1;return this.ka().then(function(){var As,Ts;Ts={type:"webStorageSupport"},Ym(As=ns).then(function(){return Ns=As.i,Ys=Ts,Ns.nb.then(function(){return new vl(function(tl){Ns.a.send(Ys.type,Ys,tl,ql("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})});var Ns,Ys}).then(function(Ns){if(Ns&&Ns.length&&Ns[0].webStorageSupport!==void 0)return Ns[0].webStorageSupport;throw Error()}).then(function(Ns){Ns||(Fo&&yu(Fo),Oo(qo),os=!0)})}).o(function(){}).then(function(){if(!os)return As=Fo,new vl(function(Ts){return function Ns(){Ou(2e3).then(function(){if(As&&!As.closed)return Ns();Ts()})}()});var As}).then(function(){if(!os)return Ou(Ho).then(function(){Oo(Vo)})})},c.Ub=function(){var Fo=_A();return!Af(Fo)&&!Mg(Fo)},c.Qb=function(){return!1},c.Jb=function(Fo,Oo,Ho,Vo,qo,ns,os,As){if(!Fo)return ws(new Ko("popup-blocked"));if(os&&!Af())return this.ka().o(function(Ns){yu(Fo),qo(Ns)}),Vo(),ls();this.a||(this.a=zm(Xm(this)));var Ts=this;return this.a.then(function(){var Ns=Ts.ka().o(function(Ys){throw yu(Fo),qo(Ys),Ys});return Vo(),Ns}).then(function(){Hd(Ho),os||Rg(If(Ts.u,Ts.f,Ts.b,Oo,Ho,null,ns,Ts.c,void 0,Ts.h,As),Fo)}).o(function(Ns){throw Ns.code=="auth/network-request-failed"&&(Ts.a=null),Ns})},c.Kb=function(Fo,Oo,Ho,Vo){this.a||(this.a=zm(Xm(this)));var qo=this;return this.a.then(function(){Hd(Oo),Rg(If(qo.u,qo.f,qo.b,Fo,Oo,lf(),Ho,qo.c,void 0,qo.h,Vo))}).o(function(ns){throw ns.code=="auth/network-request-failed"&&(qo.a=null),ns})},c.ka=function(){var Fo=this;return Ym(this).then(function(){return Fo.i.nb}).o(function(){throw Fo.a=null,new Ko("network-request-failed")})},c.Xb=function(){return!0},c.Ca=function(Fo){this.g.push(Fo)},c.Qa=function(Fo){Qs(this.g,function(Oo){return Oo==Fo})},(c=Jm.prototype).get=function(Fo){return ls(this.a.getItem(Fo)).then(function(Oo){return Oo&&$u(Oo)})},c.set=function(Fo,Oo){return ls(this.a.setItem(Fo,cf(Oo)))},c.T=function(Fo){return ls(this.a.removeItem(Fo))},c.ba=function(){},c.ha=function(){};var vp,e_=[];function t_(Fo,Oo,Ho){Ms(Fo.a)&&Fo.b.addEventListener("message",Fo.f),Fo.a[Oo]===void 0&&(Fo.a[Oo]=[]),Fo.a[Oo].push(Ho)}function n_(Fo){this.a=Fo}function r_(Fo){this.c=Fo,this.b=!1,this.a=[]}function i_(Fo,Oo,Ho,Vo){var qo,ns,os,As,Ts=Ho||{},Ns=null;if(Fo.b)return ws(Error("connection_unavailable"));var Ys=Vo?800:50,tl=typeof MessageChannel<"u"?new MessageChannel:null;return new vl(function(dl,Il){tl?(qo=Math.floor(Math.random()*Math.pow(10,20)).toString(),tl.port1.start(),os=setTimeout(function(){Il(Error("unsupported_event"))},Ys),Ns={messageChannel:tl,onMessage:ns=function($l){$l.data.eventId===qo&&($l.data.status==="ack"?(clearTimeout(os),As=setTimeout(function(){Il(Error("timeout"))},3e3)):$l.data.status==="done"?(clearTimeout(As),$l.data.response!==void 0?dl($l.data.response):Il(Error("unknown_error"))):(clearTimeout(os),clearTimeout(As),Il(Error("invalid_response"))))}},Fo.a.push(Ns),tl.port1.addEventListener("message",ns),Fo.c.postMessage({eventType:Oo,eventId:qo,data:Ts},[tl.port2])):Il(Error("connection_unavailable"))}).then(function(dl){return yp(Fo,Ns),dl}).o(function(dl){throw yp(Fo,Ns),dl})}function yp(Fo,Oo){if(Oo){var Ho=Oo.messageChannel,Vo=Oo.onMessage;Ho&&(Ho.port1.removeEventListener("message",Vo),Ho.port1.close()),Qs(Fo.a,function(qo){return qo==Oo})}}function o_(){if(!bp())throw new Ko("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=Bo.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.s=!1,this.h=null;var Fo,Oo=this;WA()&&self?(this.l=function(){var Ho=WA()?self:null;if(ps(e_,function(qo){qo.b==Ho&&(Vo=qo)}),!Vo){var Vo=new Zm(Ho);e_.push(Vo)}return Vo}(),t_(this.l,"keyChanged",function(Ho,Vo){return l_(Oo).then(function(qo){return 0<qo.length&&ps(Oo.a,function(ns){ns(qo)}),{keyProcessed:Us(qo,Vo.key)}})}),t_(this.l,"ping",function(){return ls(["keyChanged"])})):((Fo=Bo.navigator)&&Fo.serviceWorker?ls().then(function(){return Fo.serviceWorker.ready}).then(function(Ho){return Ho.active||null}).o(function(){return null}):ls(null)).then(function(Ho){(Oo.h=Ho)&&(Oo.g=new r_(new n_(Ho)),i_(Oo.g,"ping",null,!0).then(function(Vo){Vo[0].fulfilled&&Us(Vo[0].value,"keyChanged")&&(Oo.s=!0)}).o(function(){}))})}function s_(Fo){return new vl(function(Oo,Ho){var Vo=Fo.u.open("firebaseLocalStorageDb",1);Vo.onerror=function(qo){try{qo.preventDefault()}catch{}Ho(Error(qo.target.error))},Vo.onupgradeneeded=function(qo){qo=qo.target.result;try{qo.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(ns){Ho(ns)}},Vo.onsuccess=function(qo){var ns;(qo=qo.target.result).objectStoreNames.contains("firebaseLocalStorage")?Oo(qo):(ns=Fo,new vl(function(os,As){var Ts=ns.u.deleteDatabase("firebaseLocalStorageDb");Ts.onsuccess=function(){os()},Ts.onerror=function(Ns){As(Error(Ns.target.error))}}).then(function(){return s_(Fo)}).then(function(os){Oo(os)}).o(function(os){Ho(os)}))}})}function Ah(Fo){return Fo.m||(Fo.m=s_(Fo)),Fo.m}function bp(){try{return Bo.indexedDB}catch{return}}function Tf(Fo){return Fo.objectStore("firebaseLocalStorage")}function Sf(Fo,Oo){return Fo.transaction(["firebaseLocalStorage"],Oo?"readwrite":"readonly")}function Wu(Fo){return new vl(function(Oo,Ho){Fo.onsuccess=function(Vo){Vo&&Vo.target?Oo(Vo.target.result):Oo()},Fo.onerror=function(Vo){Ho(Vo.target.error)}})}function a_(Fo,Oo){return Fo.g&&Fo.h&&((Ho=Bo.navigator)&&Ho.serviceWorker&&Ho.serviceWorker.controller||null)===Fo.h?i_(Fo.g,"keyChanged",{key:Oo},Fo.s).then(function(){}).o(function(){}):ls();var Ho}function l_(Fo){return Ah(Fo).then(function(Oo){var Ho=Tf(Sf(Oo,!1));return Ho.getAll?Wu(Ho.getAll()):new vl(function(Vo,qo){var ns=[],os=Ho.openCursor();os.onsuccess=function(As){(As=As.target.result)?(ns.push(As.value),As.continue()):Vo(ns)},os.onerror=function(As){qo(As.target.error)}})}).then(function(Oo){var Ho={},Vo=[];if(Fo.b==0){for(Vo=0;Vo<Oo.length;Vo++)Ho[Oo[Vo].fbase_key]=Oo[Vo].value;Vo=function qo(ns,os){var As,Ts=[];for(As in ns)As in os&&typeof ns[As]==typeof os[As]?typeof ns[As]=="object"&&ns[As]!=null&&os[As]!=null?0<qo(ns[As],os[As]).length&&Ts.push(As):ns[As]!==os[As]&&Ts.push(As):Ts.push(As);for(As in os)As in ns||Ts.push(As);return Ts}(Fo.c,Ho),Fo.c=Ho}return Vo})}function A_(Fo){Fo.i&&Fo.i.cancel("STOP_EVENT"),Fo.f&&(clearTimeout(Fo.f),Fo.f=null)}function c_(Fo){var Oo=this,Ho=null;this.a=[],this.type="indexedDB",this.c=Fo,this.b=ls().then(function(){if(bp()){var Vo=wu(),qo="__sak"+Vo;return vp=vp||new o_,(Ho=vp).set(qo,Vo).then(function(){return Ho.get(qo)}).then(function(ns){if(ns!==Vo)throw Error("indexedDB not supported!");return Ho.T(qo)}).then(function(){return Ho}).o(function(){return Oo.c})}return Oo.c}).then(function(Vo){return Oo.type=Vo.type,Vo.ba(function(qo){ps(Oo.a,function(ns){ns(qo)})}),Vo})}function kf(){this.a={},this.type="inMemory"}function ch(){if(!function(){var Fo=oc()=="Node";if(!!(Fo=u_()||Fo&&s.INTERNAL.node&&s.INTERNAL.node.localStorage))try{return Fo.setItem("__sak","1"),Fo.removeItem("__sak"),1}catch{return}}())throw oc()=="Node"?new Ko("internal-error","The LocalStorage compatibility library was not found."):new Ko("web-storage-unsupported");this.a=u_()||s.INTERNAL.node.localStorage,this.type="localStorage"}function u_(){try{var Fo=Bo.localStorage,Oo=wu();return Fo&&(Fo.setItem(Oo,"1"),Fo.removeItem(Oo)),Fo}catch{return null}}function wp(){this.type="nullStorage"}function Ep(){if(!function(){var Fo=oc()=="Node";if(!!(Fo=f_()||Fo&&s.INTERNAL.node&&s.INTERNAL.node.sessionStorage))try{return Fo.setItem("__sak","1"),Fo.removeItem("__sak"),1}catch{return}}())throw oc()=="Node"?new Ko("internal-error","The SessionStorage compatibility library was not found."):new Ko("web-storage-unsupported");this.a=f_()||s.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function f_(){try{var Fo=Bo.sessionStorage,Oo=wu();return Fo&&(Fo.setItem(Oo,"1"),Fo.removeItem(Oo)),Fo}catch{return null}}function Wy(){var Fo={};Fo.Browser=qy,Fo.Node=zy,Fo.ReactNative=Yy,Fo.Worker=Xy,this.a=Fo[oc()]}Zm.prototype.c=function(Fo){var Oo=Fo.data.eventType,Ho=Fo.data.eventId,Vo=this.a[Oo];if(Vo&&0<Vo.length){Fo.ports[0].postMessage({status:"ack",eventId:Ho,eventType:Oo,response:null});var qo=[];ps(Vo,function(ns){qo.push(ls().then(function(){return ns(Fo.origin,Fo.data.data)}))}),Os(qo).then(function(ns){var os=[];ps(ns,function(As){os.push({fulfilled:As.Mb,value:As.value,reason:As.reason?As.reason.message:void 0})}),ps(os,function(As){for(var Ts in As)As[Ts]===void 0&&delete As[Ts]}),Fo.ports[0].postMessage({status:"done",eventId:Ho,eventType:Oo,response:os})})}},n_.prototype.postMessage=function(Fo,Oo){this.a.postMessage(Fo,Oo)},r_.prototype.close=function(){for(;0<this.a.length;)yp(this,this.a[0]);this.b=!0},(c=o_.prototype).set=function(Fo,Oo){var Ho,Vo=!1,qo=this;return Ah(this).then(function(ns){return Wu((ns=Tf(Sf(Ho=ns,!0))).get(Fo))}).then(function(ns){var os=Tf(Sf(Ho,!0));return ns?(ns.value=Oo,Wu(os.put(ns))):(qo.b++,Vo=!0,(ns={}).fbase_key=Fo,ns.value=Oo,Wu(os.add(ns)))}).then(function(){return qo.c[Fo]=Oo,a_(qo,Fo)}).ma(function(){Vo&&qo.b--})},c.get=function(Fo){return Ah(this).then(function(Oo){return Wu(Tf(Sf(Oo,!1)).get(Fo))}).then(function(Oo){return Oo&&Oo.value})},c.T=function(Fo){var Oo=!1,Ho=this;return Ah(this).then(function(Vo){return Oo=!0,Ho.b++,Wu(Tf(Sf(Vo,!0)).delete(Fo))}).then(function(){return delete Ho.c[Fo],a_(Ho,Fo)}).ma(function(){Oo&&Ho.b--})},c.ba=function(Fo){var Oo;this.a.length==0&&(A_(Oo=this),function Ho(){Oo.f=setTimeout(function(){Oo.i=l_(Oo).then(function(Vo){0<Vo.length&&ps(Oo.a,function(qo){qo(Vo)})}).then(function(){Ho()}).o(function(Vo){Vo.message!="STOP_EVENT"&&Ho()})},800)}()),this.a.push(Fo)},c.ha=function(Fo){Qs(this.a,function(Oo){return Oo==Fo}),this.a.length==0&&A_(this)},(c=c_.prototype).get=function(Fo){return this.b.then(function(Oo){return Oo.get(Fo)})},c.set=function(Fo,Oo){return this.b.then(function(Ho){return Ho.set(Fo,Oo)})},c.T=function(Fo){return this.b.then(function(Oo){return Oo.T(Fo)})},c.ba=function(Fo){this.a.push(Fo)},c.ha=function(Fo){Qs(this.a,function(Oo){return Oo==Fo})},(c=kf.prototype).get=function(Fo){return ls(this.a[Fo])},c.set=function(Fo,Oo){return this.a[Fo]=Oo,ls()},c.T=function(Fo){return delete this.a[Fo],ls()},c.ba=function(){},c.ha=function(){},(c=ch.prototype).get=function(Fo){var Oo=this;return ls().then(function(){return $u(Oo.a.getItem(Fo))})},c.set=function(Fo,Oo){var Ho=this;return ls().then(function(){var Vo=cf(Oo);Vo===null?Ho.T(Fo):Ho.a.setItem(Fo,Vo)})},c.T=function(Fo){var Oo=this;return ls().then(function(){Oo.a.removeItem(Fo)})},c.ba=function(Fo){Bo.window&&jA(Bo.window,"storage",Fo)},c.ha=function(Fo){Bo.window&&QA(Bo.window,"storage",Fo)},(c=wp.prototype).get=function(){return ls(null)},c.set=function(){return ls()},c.T=function(){return ls()},c.ba=function(){},c.ha=function(){},(c=Ep.prototype).get=function(Fo){var Oo=this;return ls().then(function(){return $u(Oo.a.getItem(Fo))})},c.set=function(Fo,Oo){var Ho=this;return ls().then(function(){var Vo=cf(Oo);Vo===null?Ho.T(Fo):Ho.a.setItem(Fo,Vo)})},c.T=function(Fo){var Oo=this;return ls().then(function(){Oo.a.removeItem(Fo)})},c.ba=function(){},c.ha=function(){};var h_,d_,qy={F:ch,$a:Ep},zy={F:ch,$a:Ep},Yy={F:Jm,$a:wp},Xy={F:ch,$a:wp},qu={od:"local",NONE:"none",qd:"session"};function p_(){var Fo=!(Mg(_A())||!Gh()),Oo=Af(),Ho=Vh();this.m=Fo,this.h=Oo,this.l=Ho,this.a={},Fo=h_=h_||new Wy;try{this.g=!Ph()&&Gg()||!Bo.indexedDB?new Fo.a.F:new c_(WA()?new kf:new Fo.a.F)}catch{this.g=new kf,this.h=!0}try{this.i=new Fo.a.$a}catch{this.i=new kf}this.u=new kf,this.f=Wo(this.Vb,this),this.b={}}function Ff(){return d_=d_||new p_}function Fu(Fo,Oo){switch(Oo){case"session":return Fo.i;case"none":return Fo.u;default:return Fo.g}}function zu(Fo,Oo){return"firebase:"+Fo.name+(Oo?":"+Oo:"")}function Yu(Fo,Oo,Ho){return Ho=zu(Oo,Ho),Oo.F=="local"&&(Fo.b[Ho]=null),Fu(Fo,Oo.F).T(Ho)}function Cp(Fo){Fo.c&&(clearInterval(Fo.c),Fo.c=null)}function Jy(Fo){this.a=Fo,this.b=Ff()}(c=p_.prototype).get=function(Fo,Oo){return Fu(this,Fo.F).get(zu(Fo,Oo))},c.set=function(Fo,Oo,Ho){var Vo=zu(Fo,Ho),qo=this,ns=Fu(this,Fo.F);return ns.set(Vo,Oo).then(function(){return ns.get(Vo)}).then(function(os){Fo.F=="local"&&(qo.b[Vo]=os)})},c.addListener=function(Fo,Oo,Ho){var Vo;Fo=zu(Fo,Oo),this.l&&(this.b[Fo]=Bo.localStorage.getItem(Fo)),Ms(this.a)&&(Fu(this,"local").ba(this.f),this.h||(Ph()||!Gg())&&Bo.indexedDB||!this.l||(Cp(Vo=this),Vo.c=setInterval(function(){for(var qo in Vo.a){var ns=Bo.localStorage.getItem(qo),os=Vo.b[qo];ns!=os&&(Vo.b[qo]=ns,ns=new KA({type:"storage",key:qo,target:window,oldValue:os,newValue:ns,a:!0}),Vo.Vb(ns))}},1e3))),this.a[Fo]||(this.a[Fo]=[]),this.a[Fo].push(Ho)},c.removeListener=function(Fo,Oo,Ho){Fo=zu(Fo,Oo),this.a[Fo]&&(Qs(this.a[Fo],function(Vo){return Vo==Ho}),this.a[Fo].length==0&&delete this.a[Fo]),Ms(this.a)&&(Fu(this,"local").ha(this.f),Cp(this))},c.Vb=function(Fo){if(Fo&&Fo.f){var Oo=Fo.a.key;if(Oo==null)for(var Ho in this.a){var Vo=this.b[Ho];Vo===void 0&&(Vo=null);var qo=Bo.localStorage.getItem(Ho);qo!==Vo&&(this.b[Ho]=qo,this.ib(Ho))}else if(Oo.indexOf("firebase:")==0&&this.a[Oo]){if(Fo.a.a!==void 0?Fu(this,"local").ha(this.f):Cp(this),this.m){if(Ho=Bo.localStorage.getItem(Oo),(Vo=Fo.a.newValue)!==Ho)Vo!==null?Bo.localStorage.setItem(Oo,Vo):Bo.localStorage.removeItem(Oo);else if(this.b[Oo]===Vo&&Fo.a.a===void 0)return}var ns=this;Ho=function(){Fo.a.a===void 0&&ns.b[Oo]===Bo.localStorage.getItem(Oo)||(ns.b[Oo]=Bo.localStorage.getItem(Oo),ns.ib(Oo))},Ml&&bl&&bl==10&&Bo.localStorage.getItem(Oo)!==Fo.a.newValue&&Fo.a.newValue!==Fo.a.oldValue?setTimeout(Ho,10):Ho()}}else ps(Fo,Wo(this.ib,this))},c.ib=function(Fo){this.a[Fo]&&ps(this.a[Fo],function(Oo){Oo()})};var Bp,Ip={name:"authEvent",F:"local"};function Zy(){this.a=Ff()}function uh(Fo,Oo){this.b=g_,this.f=Bo.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=Fo,this.h=Oo,this.l=Bo.Int32Array?new Int32Array(64):Array(64),Bp===void 0&&(Bp=Bo.Int32Array?new Int32Array(v_):v_),this.reset()}Jo(uh,function(){this.b=-1});for(var g_=64,hb=g_-1,m_=[],Tp=0;Tp<hb;Tp++)m_[Tp]=0;var __=Js(128,m_);function Sp(Fo){for(var Oo=Fo.f,Ho=Fo.l,Vo=0,qo=0;qo<Oo.length;)Ho[Vo++]=Oo[qo]<<24|Oo[qo+1]<<16|Oo[qo+2]<<8|Oo[qo+3],qo=4*Vo;for(Oo=16;Oo<64;Oo++){qo=0|Ho[Oo-15],Vo=0|Ho[Oo-2];var ns=(0|Ho[Oo-16])+((qo>>>7|qo<<25)^(qo>>>18|qo<<14)^qo>>>3)|0,os=(0|Ho[Oo-7])+((Vo>>>17|Vo<<15)^(Vo>>>19|Vo<<13)^Vo>>>10)|0;Ho[Oo]=ns+os|0}Vo=0|Fo.a[0],qo=0|Fo.a[1];var As=0|Fo.a[2],Ts=0|Fo.a[3],Ns=0|Fo.a[4],Ys=0|Fo.a[5],tl=0|Fo.a[6];for(ns=0|Fo.a[7],Oo=0;Oo<64;Oo++){var dl=((Vo>>>2|Vo<<30)^(Vo>>>13|Vo<<19)^(Vo>>>22|Vo<<10))+(Vo&qo^Vo&As^qo&As)|0;os=(ns=ns+((Ns>>>6|Ns<<26)^(Ns>>>11|Ns<<21)^(Ns>>>25|Ns<<7))|0)+((os=(os=Ns&Ys^~Ns&tl)+(0|Bp[Oo])|0)+(0|Ho[Oo])|0)|0,ns=tl,tl=Ys,Ys=Ns,Ns=Ts+os|0,Ts=As,As=qo,qo=Vo,Vo=os+dl|0}Fo.a[0]=Fo.a[0]+Vo|0,Fo.a[1]=Fo.a[1]+qo|0,Fo.a[2]=Fo.a[2]+As|0,Fo.a[3]=Fo.a[3]+Ts|0,Fo.a[4]=Fo.a[4]+Ns|0,Fo.a[5]=Fo.a[5]+Ys|0,Fo.a[6]=Fo.a[6]+tl|0,Fo.a[7]=Fo.a[7]+ns|0}function kp(Fo,Oo,Ho){Ho===void 0&&(Ho=Oo.length);var Vo=0,qo=Fo.c;if(typeof Oo=="string")for(;Vo<Ho;)Fo.f[qo++]=Oo.charCodeAt(Vo++),qo==Fo.b&&(Sp(Fo),qo=0);else{if(!Mo(Oo))throw Error("message must be string or array");for(;Vo<Ho;){var ns=Oo[Vo++];if(!(typeof ns=="number"&&0<=ns&&ns<=255&&ns==(0|ns)))throw Error("message must be a byte array");Fo.f[qo++]=ns,qo==Fo.b&&(Sp(Fo),qo=0)}}Fo.c=qo,Fo.g+=Ho}uh.prototype.reset=function(){this.g=this.c=0,this.a=Bo.Int32Array?new Int32Array(this.h):qs(this.h)};var v_=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function y_(){uh.call(this,8,_b)}Jo(y_,uh);var _b=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function b_(Fo,Oo,Ho,Vo,qo){this.u=Fo,this.i=Oo,this.l=Ho,this.m=Vo||null,this.s=qo||null,this.h=Oo+":"+Ho,this.w=new Zy,this.g=new Jy(this.h),this.f=null,this.b=[],this.a=this.c=null}function fh(Fo){return new Ko("invalid-cordova-configuration",Fo)}function ew(Fo){var Oo=new y_;kp(Oo,Fo),Fo=[];var Ho=8*Oo.g;Oo.c<56?kp(Oo,__,56-Oo.c):kp(Oo,__,Oo.b-(Oo.c-56));for(var Vo=63;56<=Vo;Vo--)Oo.f[Vo]=255&Ho,Ho/=256;for(Sp(Oo),Vo=Ho=0;Vo<Oo.i;Vo++)for(var qo=24;0<=qo;qo-=8)Fo[Ho++]=Oo.a[Vo]>>qo&255;return xs(Fo,function(ns){return 1<(ns=ns.toString(16)).length?ns:"0"+ns}).join("")}function w_(Fo,Oo){for(var Ho=0;Ho<Fo.b.length;Ho++)try{Fo.b[Ho](Oo)}catch{}}function E_(Fo){return Fo.f||(Fo.f=Fo.ka().then(function(){return new vl(function(Oo){function Ho(Ts){ns=!0,os&&os.cancel(),Fp(Vo).then(function(Ns){var Ys=qo;if(Ns&&Ts&&Ts.url){var tl=null;(Ys=hm(Ts.url)).indexOf("/__/auth/callback")!=-1&&(tl=(tl=typeof(tl=$u(PA(tl=iu(Ys),"firebaseError")||null))=="object"?Yo(tl):null)?new qA(Ns.c,Ns.b,null,null,tl,null,Ns.S()):new qA(Ns.c,Ns.b,Ys,Ns.f,null,null,Ns.S())),Ys=tl||qo}w_(Vo,Ys)})}var Vo,qo,ns,os,As;Fo.Ca(function Ts(Ns){return Oo(Ns),Fo.Qa(Ts),!1}),Vo=Fo,qo=new qA("unknown",null,null,null,new Ko("no-auth-event")),ns=!1,os=Ou(500).then(function(){return Fp(Vo).then(function(){ns||w_(Vo,qo)})}),As=Bo.handleOpenURL,Bo.handleOpenURL=function(Ts){if(Ts.toLowerCase().indexOf(ql("BuildInfo.packageName",Bo).toLowerCase()+"://")==0&&Ho({url:Ts}),typeof As=="function")try{As(Ts)}catch(Ns){console.error(Ns)}},Vd=Vd||new Yv,function(Ts){var Ns=Vd;Ns.a.push(Ts),Ns.b||(Ns.b=function(Ys){for(var tl=0;tl<Ns.a.length;tl++)Ns.a[tl](Ys)},typeof(Ts=ql("universalLinks.subscribe",Bo))=="function"&&Ts(null,Ns.b))}(Ho)})})),Fo.f}function Fp(Fo){var Oo,Ho=null;return(Oo=Fo.g).b.get(Ip,Oo.a).then(function(Vo){return bm(Vo)}).then(function(Vo){return Ho=Vo,Yu((Vo=Fo.g).b,Ip,Vo.a)}).then(function(){return Ho})}function tw(Fo){this.a=Fo,this.b=Ff()}(c=b_.prototype).ka=function(){return this.Ga?this.Ga:this.Ga=(Hh(void 0)?Mh().then(function(){return new vl(function(Fo,Oo){var Ho=Bo.document,Vo=setTimeout(function(){Oo(Error("Cordova framework is not ready."))},1e3);Ho.addEventListener("deviceready",function(){clearTimeout(Vo),Fo()},!1)})}):ws(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if(typeof ql("universalLinks.subscribe",Bo)!="function")throw fh("cordova-universal-links-plugin-fix is not installed");if(ql("BuildInfo.packageName",Bo)===void 0)throw fh("cordova-plugin-buildinfo is not installed");if(typeof ql("cordova.plugins.browsertab.openUrl",Bo)!="function")throw fh("cordova-plugin-browsertab is not installed");if(typeof ql("cordova.InAppBrowser.open",Bo)!="function")throw fh("cordova-plugin-inappbrowser is not installed")},function(){throw new Ko("cordova-not-ready")})},c.Lb=function(Fo,Oo){return Oo(new Ko("operation-not-supported-in-this-environment")),ls()},c.Jb=function(){return ws(new Ko("operation-not-supported-in-this-environment"))},c.Xb=function(){return!1},c.Ub=function(){return!0},c.Qb=function(){return!0},c.Kb=function(Fo,Oo,Ho,Vo){if(this.c)return ws(new Ko("redirect-operation-pending"));var qo=this,ns=Bo.document,os=null,As=null,Ts=null,Ns=null;return this.c=ls().then(function(){return Hd(Oo),E_(qo)}).then(function(){return function(Ys,tl,dl,Il,$l){var XA=function(){for(var Uu=20,Nu=[];0<Uu;)Nu.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),Uu--;return Nu.join("")}(),hw=new qA(tl,Il,null,XA,new Ko("no-auth-event"),null,$l),pg=ql("BuildInfo.packageName",Bo);if(typeof pg!="string")throw new Ko("invalid-cordova-configuration");var _v=ql("BuildInfo.displayName",Bo),xf={};if(_A().toLowerCase().match(/iphone|ipad|ipod/))xf.ibi=pg;else{if(!_A().toLowerCase().match(/android/))return ws(new Ko("operation-not-supported-in-this-environment"));xf.apn=pg}_v&&(xf.appDisplayName=_v),XA=ew(XA),xf.sessionId=XA;var vv=If(Ys.u,Ys.i,Ys.l,tl,dl,null,Il,Ys.m,xf,Ys.s,$l);return Ys.ka().then(function(){var Uu=Ys.h;return Ys.w.a.set(Ip,hw.v(),Uu)}).then(function(){var Uu=ql("cordova.plugins.browsertab.isAvailable",Bo);if(typeof Uu!="function")throw new Ko("invalid-cordova-configuration");var Nu=null;Uu(function(Ch){if(Ch){if(typeof(Nu=ql("cordova.plugins.browsertab.openUrl",Bo))!="function")throw new Ko("invalid-cordova-configuration");Nu(vv)}else{if(typeof(Nu=ql("cordova.InAppBrowser.open",Bo))!="function")throw new Ko("invalid-cordova-configuration");Ch=_A(),Ys.a=Nu(vv,Ch.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||Ch.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(qo,Fo,Oo,Ho,Vo)}).then(function(){return new vl(function(Ys,tl){As=function(){var dl=ql("cordova.plugins.browsertab.close",Bo);return Ys(),typeof dl=="function"&&dl(),qo.a&&typeof qo.a.close=="function"&&(qo.a.close(),qo.a=null),!1},qo.Ca(As),Ts=function(){os=os||Ou(2e3).then(function(){tl(new Ko("redirect-cancelled-by-user"))})},Ns=function(){Kh()&&Ts()},ns.addEventListener("resume",Ts,!1),_A().toLowerCase().match(/android/)||ns.addEventListener("visibilitychange",Ns,!1)}).o(function(Ys){return Fp(qo).then(function(){throw Ys})})}).ma(function(){Ts&&ns.removeEventListener("resume",Ts,!1),Ns&&ns.removeEventListener("visibilitychange",Ns,!1),os&&os.cancel(),As&&qo.Qa(As),qo.c=null})},c.Ca=function(Fo){this.b.push(Fo),E_(this).o(function(Oo){Oo.code==="auth/invalid-cordova-configuration"&&(Oo=new qA("unknown",null,null,null,new Ko("no-auth-event")),Fo(Oo))})},c.Qa=function(Fo){Qs(this.b,function(Oo){return Oo==Fo})};var Lp={name:"pendingRedirect",F:"session"};function Dp(Fo){return Yu(Fo.b,Lp,Fo.a)}function hh(Fo,Oo,Ho){this.i={},this.w=0,this.D=Fo,this.u=Oo,this.m=Ho,this.h=[],this.f=!1,this.l=Wo(this.s,this),this.b=new dh,this.B=new U_,this.g=new tw(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.B,this.c.linkViaPopup=this.B,this.c.reauthViaPopup=this.B,this.a=C_(this.D,this.u,this.m,ts)}function C_(Fo,Oo,Ho,Vo){var qo=s.SDK_VERSION||null;return new(Hh()?b_:qm)(Fo,Oo,Ho,qo,Vo)}function B_(Fo){Fo.f||(Fo.f=!0,Fo.a.Ca(Fo.l));var Oo=Fo.a;return Fo.a.ka().o(function(Ho){throw Fo.a==Oo&&Fo.reset(),Ho})}function I_(Fo){Fo.a.Ub()&&B_(Fo).o(function(Oo){var Ho=new qA("unknown",null,null,null,new Ko("operation-not-supported-in-this-environment"));Up(Oo)&&Fo.s(Ho)}),Fo.a.Qb()||D_(Fo.b)}function Rp(Fo,Oo){var Ho;Us(Fo.h,Oo)||Fo.h.push(Oo),Fo.f||(Ho=Fo.g).b.get(Lp,Ho.a).then(function(Vo){return Vo=="pending"}).then(function(Vo){Vo?Dp(Fo.g).then(function(){B_(Fo).o(function(qo){var ns=new qA("unknown",null,null,null,new Ko("operation-not-supported-in-this-environment"));Up(qo)&&Fo.s(ns)})}):I_(Fo)}).o(function(){I_(Fo)})}function T_(Fo,Oo){Qs(Fo.h,function(Ho){return Ho==Oo})}hh.prototype.reset=function(){this.f=!1,this.a.Qa(this.l),this.a=C_(this.D,this.u,this.m),this.i={}},hh.prototype.s=function(Fo){if(!Fo)throw new Ko("invalid-auth-event");if(6e5<=is()-this.w&&(this.i={},this.w=0),Fo&&Fo.getUid()&&this.i.hasOwnProperty(Fo.getUid()))return!1;for(var Oo=!1,Ho=0;Ho<this.h.length;Ho++){var Vo=this.h[Ho];if(Vo.Cb(Fo.c,Fo.b)){(Oo=this.c[Fo.c])&&(Oo.h(Fo,Vo),Fo&&(Fo.f||Fo.b)&&(this.i[Fo.getUid()]=!0,this.w=is())),Oo=!0;break}}return D_(this.b),Oo};var nw=new fu(2e3,1e4),rw=new fu(3e4,6e4);function S_(Fo,Oo,Ho,Vo,qo,ns,os){return Fo.a.Jb(Oo,Ho,Vo,function(){Fo.f||(Fo.f=!0,Fo.a.Ca(Fo.l))},function(){Fo.reset()},qo,ns,os)}function Up(Fo){return!(!Fo||Fo.code!="auth/cordova-not-ready")}function k_(Fo,Oo,Ho,Vo,qo){var ns,os;return(os=Fo.g).b.set(Lp,"pending",os.a).then(function(){return Fo.a.Kb(Oo,Ho,Vo,qo).o(function(As){if(Up(As))throw new Ko("operation-not-supported-in-this-environment");return ns=As,Dp(Fo.g).then(function(){throw ns})}).then(function(){return Fo.a.Xb()?new vl(function(){}):Dp(Fo.g).then(function(){return Fo.pa()}).then(function(){}).o(function(){})})})}function F_(Fo,Oo,Ho,Vo,qo){return Fo.a.Lb(Vo,function(ns){Oo.la(Ho,null,ns,qo)},nw.get())}hh.prototype.pa=function(){return this.b.pa()};var Np={};function L_(Fo,Oo,Ho){var Vo=Oo+":"+Ho;return Np[Vo]||(Np[Vo]=new hh(Fo,Oo,Ho)),Np[Vo]}function dh(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function D_(Fo){Fo.g||(Fo.g=!0,Lu(Fo,!1,null,null))}function ph(Fo){Fo.g&&!Fo.i&&Lu(Fo,!1,null,null)}function R_(Fo,Oo){if(Fo.b=function(){return ls(Oo)},Fo.f.length)for(var Ho=0;Ho<Fo.f.length;Ho++)Fo.f[Ho](Oo)}function Lu(Fo,Oo,Ho,Vo){Oo?Vo?function(qo,ns){if(qo.b=function(){return ws(ns)},qo.c.length)for(var os=0;os<qo.c.length;os++)qo.c[os](ns)}(Fo,Vo):R_(Fo,Ho):R_(Fo,{user:null}),Fo.f=[],Fo.c=[]}function U_(){}function N_(){this.Bb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.Bb},set:function(Fo){this.Bb=Fo},enumerable:!1})}function xp(Fo,Oo){this.a=Oo,ul(this,"verificationId",Fo)}function Op(Fo,Oo,Ho,Vo){return new su(Fo).cb(Oo,Ho).then(function(qo){return new xp(qo,Vo)})}function iw(Fo){var Oo=om(Fo);if(!(Oo&&Oo.exp&&Oo.auth_time&&Oo.iat))throw new Ko("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");IA(this,{token:Fo,expirationTime:uf(1e3*Oo.exp),authTime:uf(1e3*Oo.auth_time),issuedAtTime:uf(1e3*Oo.iat),signInProvider:Oo.firebase&&Oo.firebase.sign_in_provider?Oo.firebase.sign_in_provider:null,signInSecondFactor:Oo.firebase&&Oo.firebase.sign_in_second_factor?Oo.firebase.sign_in_second_factor:null,claims:Oo})}function Qp(Fo,Oo,Ho){var Vo=Oo&&Oo[O_];if(!Vo)throw new Ko("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=Fo,this.f=$s(Oo),this.g=Ho,this.c=new Yf(null,Vo),this.b=[];var qo=this;ps(Oo[x_]||[],function(ns){(ns=Xh(ns))&&qo.b.push(ns)}),ul(this,"auth",this.a),ul(this,"session",this.c),ul(this,"hints",this.b)}dh.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},dh.prototype.h=function(Fo,Oo){if(Fo){this.reset(),this.g=!0;var Ho=Fo.c,Vo=Fo.b,qo=Fo.a&&Fo.a.code=="auth/web-storage-unsupported",ns=Fo.a&&Fo.a.code=="auth/operation-not-supported-in-this-environment";this.i=!(!qo&&!ns),Ho!="unknown"||qo||ns?Fo.a?(Lu(this,!0,null,Fo.a),ls()):Oo.Da(Ho,Vo)?function(os,As,Ts){Ts=Ts.Da(As.c,As.b);var Ns=As.g,Ys=As.f,tl=As.i,dl=As.S(),Il=!!As.c.match(/Redirect$/);Ts(Ns,Ys,dl,tl).then(function($l){Lu(os,Il,$l,null)}).o(function($l){Lu(os,Il,null,$l)})}(this,Fo,Oo):ws(new Ko("invalid-auth-event")):(Lu(this,!1,null,null),ls())}else ws(new Ko("invalid-auth-event"))},dh.prototype.pa=function(){var Fo=this;return new vl(function(Oo,Ho){var Vo,qo;Fo.b?Fo.b().then(Oo,Ho):(Fo.f.push(Oo),Fo.c.push(Ho),Vo=Fo,qo=new Ko("timeout"),Vo.a&&Vo.a.cancel(),Vo.a=Ou(rw.get()).then(function(){Vo.b||(Vo.g=!0,Lu(Vo,!0,null,qo))}))})},U_.prototype.h=function(Fo,Oo){if(Fo){var Ho=Fo.c,Vo=Fo.b;Fo.a?(Oo.la(Fo.c,null,Fo.a,Fo.b),ls()):Oo.Da(Ho,Vo)?(ns=Oo,os=(qo=Fo).b,As=qo.c,ns.Da(As,os)(qo.g,qo.f,qo.S(),qo.i).then(function(Ts){ns.la(As,Ts,null,os)}).o(function(Ts){ns.la(As,null,Ts,os)})):ws(new Ko("invalid-auth-event"))}else ws(new Ko("invalid-auth-event"));var qo,ns,os,As},xp.prototype.confirm=function(Fo){return Fo=ym(this.verificationId,Fo),this.a(Fo)};var x_="mfaInfo",O_="mfaPendingCredential";function Pp(Fo,Oo,Ho,Vo){Ko.call(this,"multi-factor-auth-required",Vo,Oo),this.b=new Qp(Fo,Oo,Ho),ul(this,"resolver",this.b)}function Q_(Fo,Oo,Ho){if(Fo&&$o(Fo.serverResponse)&&Fo.code==="auth/multi-factor-auth-required")try{return new Pp(Oo,Fo.serverResponse,Ho,Fo.message)}catch{}return null}function P_(){}function Mp(Fo){ul(this,"factorId",Fo.ea),this.a=Fo}function M_(Fo){if(Mp.call(this,Fo),this.a.ea!=su.PROVIDER_ID)throw new Ko("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function Xu(Fo,Oo){for(var Ho in rA.call(this,Fo),Oo)this[Ho]=Oo[Ho]}function Hp(Fo,Oo){this.a=Fo,this.b=[],this.c=Wo(this.wc,this),jA(this.a,"userReloaded",this.c);var Ho=[];Oo&&Oo.multiFactor&&Oo.multiFactor.enrolledFactors&&ps(Oo.multiFactor.enrolledFactors,function(Vo){var qo=null,ns={};if(Vo){Vo.uid&&(ns[Zh]=Vo.uid),Vo.displayName&&(ns[Vg]=Vo.displayName),Vo.enrollmentTime&&(ns[Jh]=new Date(Vo.enrollmentTime).toISOString()),Vo.phoneNumber&&(ns[_d]=Vo.phoneNumber);try{qo=new ff(ns)}catch{}Vo=qo}else Vo=null;Vo&&Ho.push(Vo)}),gh(this,Ho)}function gh(Fo,Oo){Fo.b=Oo,ul(Fo,"enrolledFactors",Oo)}function Gp(Fo,Oo,Ho){if(this.h=Fo,this.i=Oo,this.g=Ho,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function ow(Fo,Oo){return Oo?(Fo.a=Fo.c,Fo.g()):(Oo=Fo.a,Fo.a*=2,Fo.a>Fo.f&&(Fo.a=Fo.f),Oo)}function $p(Fo){this.c=Fo,this.b=this.a=null}function Vp(Fo){return Fo.b&&1e3*Fo.b.c||0}function H_(Fo,Oo){var Ho=Oo.refreshToken;Fo.b=qf(Oo[YA]||""),Fo.a=Ho}function sw(Fo,Oo){return Ho=Fo.c,Vo=Oo,new vl(function(qo,ns){Vo.grant_type=="refresh_token"&&Vo.refresh_token||Vo.grant_type=="authorization_code"&&Vo.code?Qm(Ho,Ho.u+"?key="+encodeURIComponent(Ho.c),function(os){os?os.error?ns(pp(os)):os.access_token&&os.refresh_token?qo(os):ns(new Ko("internal-error")):ns(new Ko("network-request-failed"))},"POST",Tg(Vo).toString(),Ho.g,Ho.m.get()):ns(new Ko("internal-error"))}).then(function(qo){return Fo.b=qf(qo.access_token),Fo.a=qo.refresh_token,{accessToken:Fo.b.toString(),refreshToken:Fo.a}}).o(function(qo){throw qo.code=="auth/user-token-expired"&&(Fo.a=null),qo});var Ho,Vo}function mh(Fo,Oo){this.a=Fo||null,this.b=Oo||null,IA(this,{lastSignInTime:uf(Oo||null),creationTime:uf(Fo||null)})}function aw(Fo,Oo,Ho,Vo,qo,ns){IA(this,{uid:Fo,displayName:Vo||null,photoURL:qo||null,email:Ho||null,phoneNumber:ns||null,providerId:Oo})}function RA(Fo,Oo,Ho){var Vo;this.N=[],this.l=Fo.apiKey,this.m=Fo.appName,this.s=Fo.authDomain||null,Fo=s.SDK_VERSION?Hu(s.SDK_VERSION):null,this.a=new zA(this.l,us(ts),Fo),this.b=new $p(this.a),zp(this,Oo[YA]),H_(this.b,Oo),ul(this,"refreshToken",this.b.a),$_(this,Ho||{}),CA.call(this),this.P=!1,this.s&&bu()&&(this.i=L_(this.s,this.l,this.m)),this.R=[],this.h=null,this.B=(Vo=this,new Gp(function(){return Vo.I(!0)},function(ns){return!(!ns||ns.code!="auth/network-request-failed")},function(){var ns=Vp(Vo.b)-is()-3e5;return 0<ns?ns:0})),this.Z=Wo(this.Ma,this);var qo=this;this.oa=null,this.za=function(ns){qo.va(ns.g)},this.aa=null,this.W=[],this.ya=function(ns){Lf(qo,ns.c)},this.$=null,this.O=new Hp(this,Ho),ul(this,"multiFactor",this.O)}function Kp(Fo,Oo){Fo.aa&&QA(Fo.aa,"languageCodeChanged",Fo.za),(Fo.aa=Oo)&&jA(Oo,"languageCodeChanged",Fo.za)}function Lf(Fo,Oo){Fo.W=Oo,Om(Fo.a,s.SDK_VERSION?Hu(s.SDK_VERSION,Fo.W):null)}function jp(Fo,Oo){Fo.$&&QA(Fo.$,"frameworkChanged",Fo.ya),(Fo.$=Oo)&&jA(Oo,"frameworkChanged",Fo.ya)}function Wp(Fo){try{return s.app(Fo.m).auth()}catch{throw new Ko("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+Fo.m+"'!")}}function G_(Fo){Fo.D||Fo.B.b||(Fo.B.start(),QA(Fo,"tokenChanged",Fo.Z),jA(Fo,"tokenChanged",Fo.Z))}function qp(Fo){QA(Fo,"tokenChanged",Fo.Z),Fo.B.stop()}function zp(Fo,Oo){Fo.xa=Oo,ul(Fo,"_lat",Oo)}function Du(Fo){for(var Oo=[],Ho=0;Ho<Fo.R.length;Ho++)Oo.push(Fo.R[Ho](Fo));return Os(Oo).then(function(){return Fo})}function Df(Fo){Fo.i&&!Fo.P&&(Fo.P=!0,Rp(Fo.i,Fo))}function $_(Fo,Oo){IA(Fo,{uid:Oo.uid,displayName:Oo.displayName||null,photoURL:Oo.photoURL||null,email:Oo.email||null,emailVerified:Oo.emailVerified||!1,phoneNumber:Oo.phoneNumber||null,isAnonymous:Oo.isAnonymous||!1,tenantId:Oo.tenantId||null,metadata:new mh(Oo.createdAt,Oo.lastLoginAt),providerData:[]}),Fo.a.b=Fo.tenantId}function V_(){}function Yp(Fo){return ls().then(function(){if(Fo.D)throw new Ko("app-deleted")})}function Xp(Fo){return xs(Fo.providerData,function(Oo){return Oo.providerId})}function Jp(Fo,Oo){Oo&&(K_(Fo,Oo.providerId),Fo.providerData.push(Oo))}function K_(Fo,Oo){Qs(Fo.providerData,function(Ho){return Ho.providerId==Oo})}function gu(Fo,Oo,Ho){(Oo!="uid"||Ho)&&Fo.hasOwnProperty(Oo)&&ul(Fo,Oo,Ho)}function _h(Fo,Oo){var Ho,Vo,qo;Fo!=Oo&&(IA(Fo,{uid:Oo.uid,displayName:Oo.displayName,photoURL:Oo.photoURL,email:Oo.email,emailVerified:Oo.emailVerified,phoneNumber:Oo.phoneNumber,isAnonymous:Oo.isAnonymous,tenantId:Oo.tenantId,providerData:[]}),Oo.metadata?ul(Fo,"metadata",new mh((qo=Oo.metadata).a,qo.b)):ul(Fo,"metadata",new mh),ps(Oo.providerData,function(ns){Jp(Fo,ns)}),Ho=Fo.b,Vo=Oo.b,Ho.b=Vo.b,Ho.a=Vo.a,ul(Fo,"refreshToken",Fo.b.a),gh(Fo.O,Oo.O.b))}function Zp(Fo){return Fo.I().then(function(Oo){var Ho,Vo,qo=Fo.isAnonymous;return Vo=Oo,Sl((Ho=Fo).a,Ey,{idToken:Vo}).then(Wo(Ho.Ic,Ho)).then(function(){return qo||gu(Fo,"isAnonymous",!1),Oo})})}function _c(Fo,Oo){Oo[YA]&&Fo.xa!=Oo[YA]&&(H_(Fo.b,Oo),Fo.dispatchEvent(new Xu("tokenChanged")),zp(Fo,Oo[YA]),gu(Fo,"refreshToken",Fo.b.a))}function vh(Fo,Oo){return Zp(Fo).then(function(){if(Us(Xp(Fo),Oo))return Du(Fo).then(function(){throw new Ko("provider-already-linked")})})}function Rf(Fo,Oo,Ho){return hu({user:Fo,credential:Md(Oo),additionalUserInfo:Oo=am(Oo),operationType:Ho})}function j_(Fo,Oo){return _c(Fo,Oo),Fo.reload().then(function(){return Fo})}function W_(Fo,Oo,Ho,Vo,qo){if(!bu())return ws(new Ko("operation-not-supported-in-this-environment"));if(Fo.h&&!qo)return ws(Fo.h);var ns=Rd(Ho.providerId),os=wu(Fo.uid+":::"),As=null;(!Af()||Gh())&&Fo.s&&Ho.isOAuthProvider&&(As=If(Fo.s,Fo.l,Fo.m,Oo,Ho,null,os,s.SDK_VERSION||null,null,null,Fo.tenantId));var Ts=Ng(As,ns&&ns.ta,ns&&ns.sa);return Vo=Vo().then(function(){if(z_(Fo),!qo)return Fo.I().then(function(){})}).then(function(){return S_(Fo.i,Ts,Oo,Ho,os,!!As,Fo.tenantId)}).then(function(){return new vl(function(Ns,Ys){Fo.la(Oo,null,new Ko("cancelled-popup-request"),Fo.g||null),Fo.f=Ns,Fo.w=Ys,Fo.g=os,Fo.c=F_(Fo.i,Fo,Oo,Ts,os)})}).then(function(Ns){return Ts&&yu(Ts),Ns?hu(Ns):null}).o(function(Ns){throw Ts&&yu(Ts),Ns}),dA(Fo,Vo,qo)}function q_(Fo,Oo,Ho,Vo,qo){if(!bu())return ws(new Ko("operation-not-supported-in-this-environment"));if(Fo.h&&!qo)return ws(Fo.h);var ns=null,os=wu(Fo.uid+":::");return Vo=Vo().then(function(){if(z_(Fo),!qo)return Fo.I().then(function(){})}).then(function(){return Fo.fa=os,Du(Fo)}).then(function(As){return Fo.ga&&(As=(As=Fo.ga).b.set(eg,Fo.v(),As.a)),As}).then(function(){return k_(Fo.i,Oo,Ho,os,Fo.tenantId)}).o(function(As){if(ns=As,Fo.ga)return X_(Fo.ga);throw ns}).then(function(){if(ns)throw ns}),dA(Fo,Vo,qo)}function z_(Fo){if(!Fo.i||!Fo.P)throw Fo.i&&!Fo.P?new Ko("internal-error"):new Ko("auth-domain-config-required")}function dA(Fo,Oo,Ho){var Vo,qo,ns,os=(qo=Oo,ns=Ho,(Vo=Fo).h&&!ns?(qo.cancel(),ws(Vo.h)):qo.o(function(As){throw!As||As.code!="auth/user-disabled"&&As.code!="auth/user-token-expired"||(Vo.h||Vo.dispatchEvent(new Xu("userInvalidated")),Vo.h=As),As}));return Fo.N.push(os),os.ma(function(){Ps(Fo.N,os)}),os.o(function(As){var Ts=null;throw As&&As.code==="auth/multi-factor-auth-required"&&(Ts=Q_(As.v(),Wp(Fo),Wo(Fo.hc,Fo))),Ts||As})}function Y_(Fo){if(!Fo.apiKey)return null;var Oo={apiKey:Fo.apiKey,authDomain:Fo.authDomain,appName:Fo.appName},Ho={};if(!Fo.stsTokenManager||!Fo.stsTokenManager.accessToken)return null;Ho[YA]=Fo.stsTokenManager.accessToken,Ho.refreshToken=Fo.stsTokenManager.refreshToken||null;var Vo=new RA(Oo,Ho,Fo);return Fo.providerData&&ps(Fo.providerData,function(qo){qo&&Jp(Vo,hu(qo))}),Fo.redirectEventId&&(Vo.fa=Fo.redirectEventId),Vo}function lw(Fo){this.a=Fo,this.b=Ff()}Qp.prototype.Pc=function(Fo){var Oo=this;return Fo.ob(this.a.b,this.c).then(function(Ho){var Vo=$s(Oo.f);return delete Vo[x_],delete Vo[O_],Xs(Vo,Ho),Oo.g(Vo)})},Jo(Pp,Ko),P_.prototype.ob=function(Fo,Oo,Ho){return Oo.type==pf?(ns=this,os=Fo,As=Ho,Oo.Fa().then(function(Ts){return Ts={idToken:Ts},As!==void 0&&(Ts.displayName=As),Xs(Ts,{phoneVerificationInfo:gf(ns.a)}),Sl(os,by,Ts)})):(Vo=this,qo=Fo,Oo.Fa().then(function(Ts){return Xs(Ts={mfaPendingCredential:Ts},{phoneVerificationInfo:gf(Vo.a)}),Sl(qo,wy,Ts)}));var Vo,qo,ns,os,As},Jo(Mp,P_),Jo(M_,Mp),Jo(Xu,rA),(c=Hp.prototype).wc=function(Fo){var Oo,Ho;gh(this,(Oo=Fo.ed,Ho=[],ps(Oo.mfaInfo||[],function(Vo){(Vo=Xh(Vo))&&Ho.push(Vo)}),Ho))},c.Ob=function(){return this.a.I().then(function(Fo){return new Yf(Fo,null)})},c.dc=function(Fo,Oo){var Ho=this,Vo=this.a.a;return this.Ob().then(function(qo){return Fo.ob(Vo,qo,Oo)}).then(function(qo){return _c(Ho.a,qo),Ho.a.reload()})},c.$c=function(Fo){var Oo=this,Ho=typeof Fo=="string"?Fo:Fo.uid,Vo=this.a.a;return this.a.I().then(function(qo){return Sl(Vo,Gy,{idToken:qo,mfaEnrollmentId:Ho})}).then(function(qo){var ns=ks(Oo.b,function(os){return os.uid!=Ho});return gh(Oo,ns),_c(Oo.a,qo),Oo.a.reload().o(function(os){if(os.code!="auth/user-token-expired")throw os})})},c.v=function(){return{multiFactor:{enrolledFactors:xs(this.b,function(Fo){return Fo.v()})}}},Gp.prototype.start=function(){this.a=this.c,function Fo(Oo,Ho){Oo.stop(),Oo.b=Ou(ow(Oo,Ho)).then(function(){return Vo=Bo.document,qo=null,Kh()||!Vo?ls():new vl(function(ns){qo=function(){Kh()&&(Vo.removeEventListener("visibilitychange",qo,!1),ns())},Vo.addEventListener("visibilitychange",qo,!1)}).o(function(ns){throw Vo.removeEventListener("visibilitychange",qo,!1),ns});var Vo,qo}).then(function(){return Oo.h()}).then(function(){Fo(Oo,!0)}).o(function(Vo){Oo.i(Vo)&&Fo(Oo,!1)})}(this,!0)},Gp.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},$p.prototype.v=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:Vp(this)}},$p.prototype.getToken=function(Fo){return Fo=!!Fo,this.b&&!this.a?ws(new Ko("user-token-expired")):Fo||!this.b||is()>Vp(this)-3e4?this.a?sw(this,{grant_type:"refresh_token",refresh_token:this.a}):ls(null):ls({accessToken:this.b.toString(),refreshToken:this.a})},mh.prototype.v=function(){return{lastLoginAt:this.b,createdAt:this.a}},Jo(RA,CA),RA.prototype.va=function(Fo){this.oa=Fo,xm(this.a,Fo)},RA.prototype.ja=function(){return this.oa},RA.prototype.Ea=function(){return qs(this.W)},RA.prototype.Ma=function(){this.B.b&&(this.B.stop(),this.B.start())},ul(RA.prototype,"providerId","firebase"),(c=RA.prototype).reload=function(){var Fo=this;return dA(this,Yp(this).then(function(){return Zp(Fo).then(function(){return Du(Fo)}).then(V_)}))},c.mc=function(Fo){return this.I(Fo).then(function(Oo){return new iw(Oo)})},c.I=function(Fo){var Oo=this;return dA(this,Yp(this).then(function(){return Oo.b.getToken(Fo)}).then(function(Ho){if(!Ho)throw new Ko("internal-error");return Ho.accessToken!=Oo.xa&&(zp(Oo,Ho.accessToken),Oo.dispatchEvent(new Xu("tokenChanged"))),gu(Oo,"refreshToken",Ho.refreshToken),Ho.accessToken}))},c.Ic=function(Fo){if(!(Fo=Fo.users)||!Fo.length)throw new Ko("internal-error");$_(this,{uid:(Fo=Fo[0]).localId,displayName:Fo.displayName,photoURL:Fo.photoUrl,email:Fo.email,emailVerified:!!Fo.emailVerified,phoneNumber:Fo.phoneNumber,lastLoginAt:Fo.lastLoginAt,createdAt:Fo.createdAt,tenantId:Fo.tenantId});for(var Oo=(Vo=(Vo=Fo).providerUserInfo)&&Vo.length?xs(Vo,function(qo){return new aw(qo.rawId,qo.providerId,qo.email,qo.displayName,qo.photoUrl,qo.phoneNumber)}):[],Ho=0;Ho<Oo.length;Ho++)Jp(this,Oo[Ho]);var Vo;gu(this,"isAnonymous",!(this.email&&Fo.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new Xu("userReloaded",{ed:Fo}))},c.Jc=function(Fo){return Wh("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.pb(Fo)},c.pb=function(Fo){var Oo=this,Ho=null;return dA(this,Fo.c(this.a,this.uid).then(function(Vo){return _c(Oo,Vo),Ho=Rf(Oo,Vo,"reauthenticate"),Oo.h=null,Oo.reload()}).then(function(){return Ho}),!0)},c.Ac=function(Fo){return Wh("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.mb(Fo)},c.mb=function(Fo){var Oo=this,Ho=null;return dA(this,vh(this,Fo.providerId).then(function(){return Oo.I()}).then(function(Vo){return Fo.b(Oo.a,Vo)}).then(function(Vo){return Ho=Rf(Oo,Vo,"link"),j_(Oo,Vo)}).then(function(){return Ho}))},c.Bc=function(Fo,Oo){var Ho=this;return dA(this,vh(this,"phone").then(function(){return Op(Wp(Ho),Fo,Oo,Wo(Ho.mb,Ho))}))},c.Kc=function(Fo,Oo){var Ho=this;return dA(this,ls().then(function(){return Op(Wp(Ho),Fo,Oo,Wo(Ho.pb,Ho))}),!0)},c.xb=function(Fo){var Oo=this;return dA(this,this.I().then(function(Ho){return Oo.a.xb(Ho,Fo)}).then(function(Ho){return _c(Oo,Ho),Oo.reload()}))},c.cd=function(Fo){var Oo=this;return dA(this,this.I().then(function(Ho){return Fo.b(Oo.a,Ho)}).then(function(Ho){return _c(Oo,Ho),Oo.reload()}))},c.yb=function(Fo){var Oo=this;return dA(this,this.I().then(function(Ho){return Oo.a.yb(Ho,Fo)}).then(function(Ho){return _c(Oo,Ho),Oo.reload()}))},c.zb=function(Fo){if(Fo.displayName===void 0&&Fo.photoURL===void 0)return Yp(this);var Oo=this;return dA(this,this.I().then(function(Ho){return Oo.a.zb(Ho,{displayName:Fo.displayName,photoUrl:Fo.photoURL})}).then(function(Ho){return _c(Oo,Ho),gu(Oo,"displayName",Ho.displayName||null),gu(Oo,"photoURL",Ho.photoUrl||null),ps(Oo.providerData,function(Vo){Vo.providerId==="password"&&(ul(Vo,"displayName",Oo.displayName),ul(Vo,"photoURL",Oo.photoURL))}),Du(Oo)}).then(V_))},c.ad=function(Fo){var Oo=this;return dA(this,Zp(this).then(function(Ho){return Us(Xp(Oo),Fo)?Sl(Oo.a,_y,{idToken:Ho,deleteProvider:[Fo]}).then(function(Vo){var qo={};return ps(Vo.providerUserInfo||[],function(ns){qo[ns.providerId]=!0}),ps(Xp(Oo),function(ns){qo[ns]||K_(Oo,ns)}),qo[su.PROVIDER_ID]||ul(Oo,"phoneNumber",null),Du(Oo)}):Du(Oo).then(function(){throw new Ko("no-such-provider")})}))},c.delete=function(){var Fo=this;return dA(this,this.I().then(function(Oo){return Sl(Fo.a,my,{idToken:Oo})}).then(function(){Fo.dispatchEvent(new Xu("userDeleted"))})).then(function(){for(var Oo=0;Oo<Fo.N.length;Oo++)Fo.N[Oo].cancel("app-deleted");Kp(Fo,null),jp(Fo,null),Fo.N=[],Fo.D=!0,qp(Fo),ul(Fo,"refreshToken",null),Fo.i&&T_(Fo.i,Fo)})},c.Cb=function(Fo,Oo){return!!(Fo=="linkViaPopup"&&(this.g||null)==Oo&&this.f||Fo=="reauthViaPopup"&&(this.g||null)==Oo&&this.f||Fo=="linkViaRedirect"&&(this.fa||null)==Oo||Fo=="reauthViaRedirect"&&(this.fa||null)==Oo)},c.la=function(Fo,Oo,Ho,Vo){Fo!="linkViaPopup"&&Fo!="reauthViaPopup"||Vo!=(this.g||null)||(Ho&&this.w?this.w(Ho):Oo&&!Ho&&this.f&&this.f(Oo),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.w)},c.Da=function(Fo,Oo){return Fo=="linkViaPopup"&&Oo==(this.g||null)?Wo(this.Hb,this):Fo=="reauthViaPopup"&&Oo==(this.g||null)?Wo(this.Ib,this):Fo=="linkViaRedirect"&&(this.fa||null)==Oo?Wo(this.Hb,this):Fo=="reauthViaRedirect"&&(this.fa||null)==Oo?Wo(this.Ib,this):null},c.Cc=function(Fo){var Oo=this;return W_(this,"linkViaPopup",Fo,function(){return vh(Oo,Fo.providerId).then(function(){return Du(Oo)})},!1)},c.Lc=function(Fo){return W_(this,"reauthViaPopup",Fo,function(){return ls()},!0)},c.Dc=function(Fo){var Oo=this;return q_(this,"linkViaRedirect",Fo,function(){return vh(Oo,Fo.providerId)},!1)},c.Mc=function(Fo){return q_(this,"reauthViaRedirect",Fo,function(){return ls()},!0)},c.Hb=function(Fo,Oo,Ho,Vo){var qo=this;this.c&&(this.c.cancel(),this.c=null);var ns=null;return Ho=this.I().then(function(os){return fp(qo.a,{requestUri:Fo,postBody:Vo,sessionId:Oo,idToken:os})}).then(function(os){return ns=Rf(qo,os,"link"),j_(qo,os)}).then(function(){return ns}),dA(this,Ho)},c.Ib=function(Fo,Oo,Ho,Vo){var qo=this;this.c&&(this.c.cancel(),this.c=null);var ns=null;return dA(this,ls().then(function(){return Ku(hp(qo.a,{requestUri:Fo,sessionId:Oo,postBody:Vo,tenantId:Ho}),qo.uid)}).then(function(os){return ns=Rf(qo,os,"reauthenticate"),_c(qo,os),qo.h=null,qo.reload()}).then(function(){return ns}),!0)},c.qb=function(Fo){var Oo=this,Ho=null;return dA(this,this.I().then(function(Vo){return Ho=Vo,Fo===void 0||Ms(Fo)?{}:jf(new Kf(Fo))}).then(function(Vo){return Oo.a.qb(Ho,Vo)}).then(function(Vo){if(Oo.email!=Vo)return Oo.reload()}).then(function(){}))},c.Ab=function(Fo,Oo){var Ho=this,Vo=null;return dA(this,this.I().then(function(qo){return Vo=qo,Oo===void 0||Ms(Oo)?{}:jf(new Kf(Oo))}).then(function(qo){return Ho.a.Ab(Vo,Fo,qo)}).then(function(qo){if(Ho.email!=qo)return Ho.reload()}).then(function(){}))},c.hc=function(Fo){var Oo=null,Ho=this;return dA(this,Fo=Ku(ls(Fo),Ho.uid).then(function(Vo){return Oo=Rf(Ho,Vo,"reauthenticate"),_c(Ho,Vo),Ho.h=null,Ho.reload()}).then(function(){return Oo}),!0)},c.toJSON=function(){return this.v()},c.v=function(){var Fo={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.v(),redirectEventId:this.fa||null};return this.metadata&&Xs(Fo,this.metadata.v()),ps(this.providerData,function(Oo){Fo.providerData.push(function(Ho){var Vo,qo={};for(Vo in Ho)Ho.hasOwnProperty(Vo)&&(qo[Vo]=Ho[Vo]);return qo}(Oo))}),Xs(Fo,this.O.v()),Fo};var eg={name:"redirectUser",F:"session"};function X_(Fo){return Yu(Fo.b,eg,Fo.a)}function tg(Fo){var Oo,Ho,Vo,qo;this.a=Fo,this.b=Ff(),this.c=null,this.f=(Ho=eu("local"),Vo=eu("session"),qo=eu("none"),function(ns,os,As){var Ts=zu(os,As),Ns=Fu(ns,os.F);return ns.get(os,As).then(function(Ys){var tl=null;try{tl=$u(Bo.localStorage.getItem(Ts))}catch{}if(tl&&!Ys)return Bo.localStorage.removeItem(Ts),ns.set(os,tl,As);tl&&Ys&&Ns.type!="localStorage"&&Bo.localStorage.removeItem(Ts)})}((Oo=this).b,Ho,Oo.a).then(function(){return Oo.b.get(Vo,Oo.a)}).then(function(ns){return ns?Vo:Oo.b.get(qo,Oo.a).then(function(os){return os?qo:Oo.b.get(Ho,Oo.a).then(function(As){return As?Ho:Oo.b.get(rg,Oo.a).then(function(Ts){return Ts?eu(Ts):Ho})})})}).then(function(ns){return Oo.c=ns,ng(Oo,ns.F)}).o(function(){Oo.c||(Oo.c=Ho)})),this.b.addListener(eu("local"),this.a,Wo(this.g,this))}function ng(Fo,Oo){var Ho,Vo,qo=[];for(Ho in qu)qu[Ho]!==Oo&&qo.push(Yu(Fo.b,eu(qu[Ho]),Fo.a));return qo.push(Yu(Fo.b,rg,Fo.a)),Vo=qo,new vl(function(ns,os){var As=Vo.length,Ts=[];if(As)for(var Ns=function(dl,Il){As--,Ts[dl]=Il,As==0&&ns(Ts)},Ys=function(dl){os(dl)},tl=0;tl<Vo.length;tl++)Ds(Vo[tl],es(Ns,tl),Ys);else ns(Ts)})}tg.prototype.g=function(){var Fo=this,Oo=eu("local");Ju(this,function(){return ls().then(function(){return Fo.c&&Fo.c.F!="local"?Fo.b.get(Oo,Fo.a):null}).then(function(Ho){if(Ho)return ng(Fo,"local").then(function(){Fo.c=Oo})})})};var rg={name:"persistence",F:"session"};function eu(Fo){return{name:"authUser",F:Fo}}function J_(Fo,Oo){return Ju(Fo,function(){return Fo.b.set(Fo.c,Oo.v(),Fo.a)})}function Z_(Fo){return Ju(Fo,function(){return Yu(Fo.b,Fo.c,Fo.a)})}function ev(Fo,Oo){return Ju(Fo,function(){return Fo.b.get(Fo.c,Fo.a).then(function(Ho){return Ho&&Oo&&(Ho.authDomain=Oo),Y_(Ho||{})})})}function Ju(Fo,Oo){return Fo.f=Fo.f.then(Oo,Oo),Fo.f}function tu(Fo){if(this.l=!1,ul(this,"settings",new N_),ul(this,"app",Fo),!Hl(this).options||!Hl(this).options.apiKey)throw new Ko("invalid-api-key");var Oo,Ho,Vo,qo,ns,os,As,Ts;Fo=s.SDK_VERSION?Hu(s.SDK_VERSION):null,this.b=new zA(Hl(this).options&&Hl(this).options.apiKey,us(ts),Fo),this.P=[],this.m=[],this.O=[],this.$b=s.INTERNAL.createSubscribe(Wo(this.xc,this)),this.W=void 0,this.ac=s.INTERNAL.createSubscribe(Wo(this.yc,this)),Zu(this,null),this.i=new tg(Hl(this).options.apiKey+":"+Hl(this).name),this.B=new lw(Hl(this).options.apiKey+":"+Hl(this).name),this.Z=iA(this,(Ho=Hl(Oo=this).options.authDomain,Vo=function(Ns){var Ys=function(tl,dl){return tl.b.get(eg,tl.a).then(function(Il){return Il&&dl&&(Il.authDomain=dl),Y_(Il||{})})}(Ns.B,Hl(Ns).options.authDomain).then(function(tl){return(Ns.D=tl)&&(tl.ga=Ns.B),X_(Ns.B)});return iA(Ns,Ys)}(Oo).then(function(){return ev(Oo.i,Ho)}).then(function(Ns){return Ns?(Ns.ga=Oo.B,Oo.D&&(Oo.D.fa||null)==(Ns.fa||null)?Ns:Ns.reload().then(function(){return J_(Oo.i,Ns).then(function(){return Ns})}).o(function(Ys){return Ys.code=="auth/network-request-failed"?Ns:Z_(Oo.i)})):null}).then(function(Ns){Zu(Oo,Ns||null)}),iA(Oo,Vo))),this.h=iA(this,(qo=this).Z.then(function(){return rv(qo)}).o(function(){}).then(function(){if(!qo.l)return qo.oa()}).o(function(){}).then(function(){if(!qo.l){qo.aa=!0;var Ns=qo.i;Ns.b.addListener(eu("local"),Ns.a,qo.oa)}})),this.aa=!1,this.oa=Wo(this.Xc,this),this.Ma=Wo(this.ca,this),this.xa=Wo(this.jc,this),this.ya=Wo(this.uc,this),this.za=Wo(this.vc,this),this.a=null,os=Hl(ns=this).options.authDomain,As=Hl(ns).options.apiKey,os&&bu()&&(ns.Zb=ns.Z.then(function(){if(!ns.l){if(ns.a=L_(os,As,Hl(ns).name),Rp(ns.a,ns),Bl(ns)&&Df(Bl(ns)),ns.D){Df(ns.D);var Ns=ns.D;Ns.va(ns.ja()),Kp(Ns,ns),Lf(Ns=ns.D,ns.N),jp(Ns,ns),ns.D=null}return ns.a}})),this.INTERNAL={},this.INTERNAL.delete=Wo(this.delete,this),this.INTERNAL.logFramework=Wo(this.Ec,this),this.s=0,CA.call(this),Ts=this,Object.defineProperty(Ts,"lc",{get:function(){return this.ja()},set:function(Ns){this.va(Ns)},enumerable:!1}),Ts.$=null,Object.defineProperty(Ts,"ti",{get:function(){return this.S()},set:function(Ns){this.ub(Ns)},enumerable:!1}),Ts.R=null,this.N=[]}function tv(Fo){rA.call(this,"languageCodeChanged"),this.g=Fo}function nv(Fo){rA.call(this,"frameworkChanged"),this.c=Fo}function ig(Fo){return Fo.Zb||ws(new Ko("auth-domain-config-required"))}function rv(Fo){if(!bu())return ws(new Ko("operation-not-supported-in-this-environment"));var Oo=ig(Fo).then(function(){return Fo.a.pa()}).then(function(Ho){return Ho?hu(Ho):null});return iA(Fo,Oo)}function Aw(Fo,Oo){var Ho={};return Ho.apiKey=Hl(Fo).options.apiKey,Ho.authDomain=Hl(Fo).options.authDomain,Ho.appName=Hl(Fo).name,Fo.Z.then(function(){return Vo=Ho,qo=Oo,ns=Fo.B,os=Fo.Ea(),As=new RA(Vo,qo),ns&&(As.ga=ns),os&&Lf(As,os),As.reload().then(function(){return As});var Vo,qo,ns,os,As}).then(function(Vo){return Bl(Fo)&&Vo.uid==Bl(Fo).uid?_h(Bl(Fo),Vo):(Zu(Fo,Vo),Df(Vo)),Fo.ca(Vo)}).then(function(){Uf(Fo)})}function Zu(Fo,Oo){var Ho,Vo;Bl(Fo)&&(Ho=Bl(Fo),Vo=Fo.Ma,Qs(Ho.R,function(qo){return qo==Vo}),QA(Bl(Fo),"tokenChanged",Fo.xa),QA(Bl(Fo),"userDeleted",Fo.ya),QA(Bl(Fo),"userInvalidated",Fo.za),qp(Bl(Fo))),Oo&&(Oo.R.push(Fo.Ma),jA(Oo,"tokenChanged",Fo.xa),jA(Oo,"userDeleted",Fo.ya),jA(Oo,"userInvalidated",Fo.za),0<Fo.s&&G_(Oo)),ul(Fo,"currentUser",Oo),Oo&&(Oo.va(Fo.ja()),Kp(Oo,Fo),Lf(Oo,Fo.N),jp(Oo,Fo))}function Ru(Fo,Oo){var Ho=null,Vo=null;return iA(Fo,Oo.then(function(qo){return Ho=Md(qo),Vo=am(qo),Aw(Fo,qo)},function(qo){var ns=null;throw qo&&qo.code==="auth/multi-factor-auth-required"&&(ns=Q_(qo.v(),Fo,Wo(Fo.ic,Fo))),ns||qo}).then(function(){return hu({user:Bl(Fo),credential:Ho,additionalUserInfo:Vo,operationType:"signIn"})}))}function Hl(Fo){return Fo.app}function Bl(Fo){return Fo.currentUser}function yh(Fo){return Bl(Fo)&&Bl(Fo)._lat||null}function Uf(Fo){if(Fo.aa){for(var Oo=0;Oo<Fo.m.length;Oo++)Fo.m[Oo]&&Fo.m[Oo](yh(Fo));if(Fo.W!==Fo.getUid()&&Fo.O.length)for(Fo.W=Fo.getUid(),Oo=0;Oo<Fo.O.length;Oo++)Fo.O[Oo]&&Fo.O[Oo](yh(Fo))}}function iA(Fo,Oo){return Fo.P.push(Oo),Oo.ma(function(){Ps(Fo.P,Oo)}),Oo}function Nf(){}function ef(){this.a={},this.b=1e12}tg.prototype.tb=function(Fo){var Oo=null,Ho=this;return function(Vo){var qo=new Ko("invalid-persistence-type"),ns=new Ko("unsupported-persistence-type");e:{for(os in qu)if(qu[os]==Vo){var os=!0;break e}os=!1}if(!os||typeof Vo!="string")throw qo;switch(oc()){case"ReactNative":if(Vo==="session")throw ns;break;case"Node":if(Vo!=="none")throw ns;break;case"Worker":if(Vo==="session"||!bp()&&Vo!=="none")throw ns;break;default:if(!Vh()&&Vo!=="none")throw ns}}(Fo),Ju(this,function(){return Fo!=Ho.c.F?Ho.b.get(Ho.c,Ho.a).then(function(Vo){return Oo=Vo,ng(Ho,Fo)}).then(function(){if(Ho.c=eu(Fo),Oo)return Ho.b.set(Ho.c,Oo,Ho.a)}):ls()})},Jo(tu,CA),Jo(tv,rA),Jo(nv,rA),(c=tu.prototype).tb=function(Fo){return Fo=this.i.tb(Fo),iA(this,Fo)},c.va=function(Fo){this.$===Fo||this.l||(this.$=Fo,xm(this.b,this.$),this.dispatchEvent(new tv(this.ja())))},c.ja=function(){return this.$},c.dd=function(){var Fo=Bo.navigator;this.va(Fo&&(Fo.languages&&Fo.languages[0]||Fo.language||Fo.userLanguage)||null)},c.Ec=function(Fo){this.N.push(Fo),Om(this.b,s.SDK_VERSION?Hu(s.SDK_VERSION,this.N):null),this.dispatchEvent(new nv(this.N))},c.Ea=function(){return qs(this.N)},c.ub=function(Fo){this.R===Fo||this.l||(this.R=Fo,this.b.b=this.R)},c.S=function(){return this.R},c.toJSON=function(){return{apiKey:Hl(this).options.apiKey,authDomain:Hl(this).options.authDomain,appName:Hl(this).name,currentUser:Bl(this)&&Bl(this).v()}},c.Cb=function(Fo,Oo){switch(Fo){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==Oo&&!!this.f;default:return!1}},c.la=function(Fo,Oo,Ho,Vo){Fo=="signInViaPopup"&&this.g==Vo&&(Ho&&this.w?this.w(Ho):Oo&&!Ho&&this.f&&this.f(Oo),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.w)},c.Da=function(Fo,Oo){return Fo=="signInViaRedirect"||Fo=="signInViaPopup"&&this.g==Oo&&this.f?Wo(this.gc,this):null},c.gc=function(Fo,Oo,Ho,Vo){var qo=this,ns={requestUri:Fo,postBody:Vo,sessionId:Oo,tenantId:Ho};return this.c&&(this.c.cancel(),this.c=null),qo.Z.then(function(){return Ru(qo,up(qo.b,ns))})},c.Vc=function(Fo){if(!bu())return ws(new Ko("operation-not-supported-in-this-environment"));var Oo=this,Ho=Rd(Fo.providerId),Vo=wu(),qo=null;(!Af()||Gh())&&Hl(this).options.authDomain&&Fo.isOAuthProvider&&(qo=If(Hl(this).options.authDomain,Hl(this).options.apiKey,Hl(this).name,"signInViaPopup",Fo,null,Vo,s.SDK_VERSION||null,null,null,this.S()));var ns=Ng(qo,Ho&&Ho.ta,Ho&&Ho.sa);return iA(this,Ho=ig(this).then(function(os){return S_(os,ns,"signInViaPopup",Fo,Vo,!!qo,Oo.S())}).then(function(){return new vl(function(os,As){Oo.la("signInViaPopup",null,new Ko("cancelled-popup-request"),Oo.g),Oo.f=os,Oo.w=As,Oo.g=Vo,Oo.c=F_(Oo.a,Oo,"signInViaPopup",ns,Vo)})}).then(function(os){return ns&&yu(ns),os?hu(os):null}).o(function(os){throw ns&&yu(ns),os}))},c.Wc=function(Fo){if(!bu())return ws(new Ko("operation-not-supported-in-this-environment"));var Oo=this;return iA(this,ig(this).then(function(){return Ju(Ho=Oo.i,function(){return Ho.b.set(rg,Ho.c.F,Ho.a)});var Ho}).then(function(){return k_(Oo.a,"signInViaRedirect",Fo,void 0,Oo.S())}))},c.pa=function(){var Fo=this;return rv(this).then(function(Oo){return Fo.a&&ph(Fo.a.b),Oo}).o(function(Oo){throw Fo.a&&ph(Fo.a.b),Oo})},c.bd=function(Fo){if(!Fo)return ws(new Ko("null-user"));if(this.R!=Fo.tenantId)return ws(new Ko("tenant-id-mismatch"));var Oo=this,Ho={};Ho.apiKey=Hl(this).options.apiKey,Ho.authDomain=Hl(this).options.authDomain,Ho.appName=Hl(this).name;var Vo,qo,ns,os,As,Ts,Ns=(Vo=Fo,qo=Ho,ns=Oo.B,os=Oo.Ea(),As=Vo.b,(Ts={})[YA]=As.b&&As.b.toString(),Ts.refreshToken=As.a,qo=new RA(qo||{apiKey:Vo.l,authDomain:Vo.s,appName:Vo.m},Ts),ns&&(qo.ga=ns),os&&Lf(qo,os),_h(qo,Vo),qo);return iA(this,this.h.then(function(){if(Hl(Oo).options.apiKey!=Fo.l)return Ns.reload()}).then(function(){return Bl(Oo)&&Fo.uid==Bl(Oo).uid?(_h(Bl(Oo),Fo),Oo.ca(Fo)):(Zu(Oo,Ns),Df(Ns),Oo.ca(Ns))}).then(function(){Uf(Oo)}))},c.wb=function(){var Fo=this,Oo=this.h.then(function(){return Fo.a&&ph(Fo.a.b),Bl(Fo)?(Zu(Fo,null),Z_(Fo.i).then(function(){Uf(Fo)})):ls()});return iA(this,Oo)},c.Xc=function(){var Fo=this;return ev(this.i,Hl(this).options.authDomain).then(function(Oo){if(!Fo.l){var Ho;if(Ho=Bl(Fo)&&Oo){Ho=Bl(Fo).uid;var Vo=Oo.uid;Ho=Ho!=null&&Ho!==""&&Vo!=null&&Vo!==""&&Ho==Vo}if(Ho)return _h(Bl(Fo),Oo),Bl(Fo).I();(Bl(Fo)||Oo)&&(Zu(Fo,Oo),Oo&&(Df(Oo),Oo.ga=Fo.B),Fo.a&&Rp(Fo.a,Fo),Uf(Fo))}})},c.ca=function(Fo){return J_(this.i,Fo)},c.jc=function(){Uf(this),this.ca(Bl(this))},c.uc=function(){this.wb()},c.vc=function(){this.wb()},c.ic=function(Fo){var Oo=this;return this.h.then(function(){return Ru(Oo,ls(Fo))})},c.xc=function(Fo){var Oo=this;this.addAuthTokenListener(function(){Fo.next(Bl(Oo))})},c.yc=function(Fo){var Oo,Ho,Vo=this;Ho=function(){Fo.next(Bl(Vo))},(Oo=this).O.push(Ho),iA(Oo,Oo.h.then(function(){!Oo.l&&Us(Oo.O,Ho)&&Oo.W!==Oo.getUid()&&(Oo.W=Oo.getUid(),Ho(yh(Oo)))}))},c.Gc=function(Fo,Oo,Ho){var Vo=this;return this.aa&&Promise.resolve().then(function(){Go(Fo)?Fo(Bl(Vo)):Go(Fo.next)&&Fo.next(Bl(Vo))}),this.$b(Fo,Oo,Ho)},c.Fc=function(Fo,Oo,Ho){var Vo=this;return this.aa&&Promise.resolve().then(function(){Vo.W=Vo.getUid(),Go(Fo)?Fo(Bl(Vo)):Go(Fo.next)&&Fo.next(Bl(Vo))}),this.ac(Fo,Oo,Ho)},c.kc=function(Fo){var Oo=this,Ho=this.h.then(function(){return Bl(Oo)?Bl(Oo).I(Fo).then(function(Vo){return{accessToken:Vo}}):null});return iA(this,Ho)},c.Rc=function(Fo){var Oo=this;return this.h.then(function(){return Ru(Oo,Sl(Oo.b,Qy,{token:Fo}))}).then(function(Ho){var Vo=Ho.user;return gu(Vo,"isAnonymous",!1),Oo.ca(Vo),Ho})},c.Sc=function(Fo,Oo){var Ho=this;return this.h.then(function(){return Ru(Ho,Sl(Ho.b,Km,{email:Fo,password:Oo}))})},c.cc=function(Fo,Oo){var Ho=this;return this.h.then(function(){return Ru(Ho,Sl(Ho.b,py,{email:Fo,password:Oo}))})},c.Ya=function(Fo){var Oo=this;return this.h.then(function(){return Ru(Oo,Fo.ia(Oo.b))})},c.Qc=function(Fo){return Wh("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Ya(Fo)},c.vb=function(){var Fo=this;return this.h.then(function(){var Oo=Bl(Fo);if(Oo&&Oo.isAnonymous){var Ho=hu({providerId:null,isNewUser:!1});return hu({user:Oo,credential:null,additionalUserInfo:Ho,operationType:"signIn"})}return Ru(Fo,Fo.b.vb()).then(function(Vo){var qo=Vo.user;return gu(qo,"isAnonymous",!0),Fo.ca(qo),Vo})})},c.getUid=function(){return Bl(this)&&Bl(this).uid||null},c.bc=function(Fo){this.addAuthTokenListener(Fo),this.s++,0<this.s&&Bl(this)&&G_(Bl(this))},c.Nc=function(Fo){var Oo=this;ps(this.m,function(Ho){Ho==Fo&&Oo.s--}),this.s<0&&(this.s=0),this.s==0&&Bl(this)&&qp(Bl(this)),this.removeAuthTokenListener(Fo)},c.addAuthTokenListener=function(Fo){var Oo=this;this.m.push(Fo),iA(this,this.h.then(function(){Oo.l||Us(Oo.m,Fo)&&Fo(yh(Oo))}))},c.removeAuthTokenListener=function(Fo){Qs(this.m,function(Oo){return Oo==Fo})},c.delete=function(){this.l=!0;for(var Fo=0;Fo<this.P.length;Fo++)this.P[Fo].cancel("app-deleted");return this.P=[],this.i&&(Fo=this.i).b.removeListener(eu("local"),Fo.a,this.oa),this.a&&(T_(this.a,this),ph(this.a.b)),Promise.resolve()},c.fc=function(Fo){return iA(this,Sl(this.b,gy,{identifier:Fo,continueUri:$f()?lf():"http://localhost"}).then(function(Oo){return Oo.signinMethods||[]}))},c.zc=function(Fo){return!!Pd(Fo)},c.sb=function(Fo,Oo){var Ho=this;return iA(this,ls().then(function(){var Vo=new Kf(Oo);if(!Vo.c)throw new Ko("argument-error",Sd+" must be true when sending sign in link to email");return jf(Vo)}).then(function(Vo){return Ho.b.sb(Fo,Vo)}).then(function(){}))},c.fd=function(Fo){return this.Pa(Fo).then(function(Oo){return Oo.data.email})},c.jb=function(Fo,Oo){return iA(this,this.b.jb(Fo,Oo).then(function(){}))},c.Pa=function(Fo){return iA(this,this.b.Pa(Fo).then(function(Oo){return new Dv(Oo)}))},c.fb=function(Fo){return iA(this,this.b.fb(Fo).then(function(){}))},c.rb=function(Fo,Oo){var Ho=this;return iA(this,ls().then(function(){return Oo===void 0||Ms(Oo)?{}:jf(new Kf(Oo))}).then(function(Vo){return Ho.b.rb(Fo,Vo)}).then(function(){}))},c.Uc=function(Fo,Oo){return iA(this,Op(this,Fo,Oo,Wo(this.Ya,this)))},c.Tc=function(Fo,Oo){var Ho=this;return iA(this,ls().then(function(){var Vo=Oo||lf(),qo=vm(Fo,Vo);if(!(Vo=Pd(Vo)))throw new Ko("argument-error","Invalid email link!");if(Vo.tenantId!==Ho.S())throw new Ko("tenant-id-mismatch");return Ho.Ya(qo)}))},Nf.prototype.render=function(){},Nf.prototype.reset=function(){},Nf.prototype.getResponse=function(){},Nf.prototype.execute=function(){};var iv=null;function og(Fo,Oo){return(Oo=ov(Oo))&&Fo.a[Oo]||null}function ov(Fo){return(Fo=Fo===void 0?1e12:Fo)?Fo.toString():null}function bh(Fo,Oo){this.g=!1,this.c=Oo,this.a=this.b=null,this.h=this.c.size!=="invisible",this.f=kl(Fo);var Ho=this;this.i=function(){Ho.execute()},this.h?this.execute():jA(this.f,"click",this.i)}function sg(Fo){if(Fo.g)throw Error("reCAPTCHA mock was already deleted!")}function ag(){}function lg(){}ef.prototype.render=function(Fo,Oo){return this.a[this.b.toString()]=new bh(Fo,Oo),this.b++},ef.prototype.reset=function(Fo){var Oo=og(this,Fo);Fo=ov(Fo),Oo&&Fo&&(Oo.delete(),delete this.a[Fo])},ef.prototype.getResponse=function(Fo){return(Fo=og(this,Fo))?Fo.getResponse():null},ef.prototype.execute=function(Fo){(Fo=og(this,Fo))&&Fo.execute()},bh.prototype.getResponse=function(){return sg(this),this.b},bh.prototype.execute=function(){sg(this);var Fo=this;this.a||(this.a=setTimeout(function(){Fo.b=function(){for(var Vo=50,qo=[];0<Vo;)qo.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),Vo--;return qo.join("")}();var Oo=Fo.c.callback,Ho=Fo.c["expired-callback"];if(Oo)try{Oo(Fo.b)}catch{}Fo.a=setTimeout(function(){if(Fo.a=null,Fo.b=null,Ho)try{Ho()}catch{}Fo.h&&Fo.execute()},6e4)},500))},bh.prototype.delete=function(){sg(this),this.g=!0,clearTimeout(this.a),this.a=null,QA(this.f,"click",this.i)},ul(ag,"FACTOR_ID","phone"),lg.prototype.g=function(){return ls(iv=iv||new ef)},lg.prototype.c=function(){};var sv=null;function Ag(){this.b=Bo.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var cw=new sl(El,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),uw=new fu(3e4,6e4);Ag.prototype.g=function(Fo){var Oo=this;return new vl(function(Ho,Vo){var qo=setTimeout(function(){Vo(new Ko("network-request-failed"))},uw.get());!Bo.grecaptcha||Fo!==Oo.f&&!Oo.b?(Bo[Oo.a]=function(){if(Bo.grecaptcha){Oo.f=Fo;var ns=Bo.grecaptcha.render;Bo.grecaptcha.render=function(os,As){return os=ns(os,As),Oo.b++,os},clearTimeout(qo),Ho(Bo.grecaptcha)}else clearTimeout(qo),Vo(new Ko("internal-error"));delete Bo[Oo.a]},ls(op(Ul(cw,{onload:Oo.a,hl:Fo||""}))).o(function(){clearTimeout(qo),Vo(new Ko("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(qo),Ho(Bo.grecaptcha))})},Ag.prototype.c=function(){this.b--};var av=null;function cg(Fo,Oo,Ho,Vo,qo,ns,os){if(ul(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.u=Oo,this.g=null,os=os?sv=sv||new lg:av=av||new Ag,this.m=os,this.a=Ho||{theme:"light",type:"image"},this.h=[],this.a[cv])throw new Ko("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i=this.a[fw]==="invisible",!Bo.document)throw new Ko("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!kl(Oo)||!this.i&&kl(Oo).hasChildNodes())throw new Ko("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new zA(Fo,ns||null,qo||null),this.w=Vo||function(){return null};var As=this;this.l=[];var Ts=this.a[lv];this.a[lv]=function(Ys){if(uv(As,Ys),typeof Ts=="function")Ts(Ys);else if(typeof Ts=="string"){var tl=ql(Ts,Bo);typeof tl=="function"&&tl(Ys)}};var Ns=this.a[Av];this.a[Av]=function(){if(uv(As,null),typeof Ns=="function")Ns();else if(typeof Ns=="string"){var Ys=ql(Ns,Bo);typeof Ys=="function"&&Ys()}}}var lv="callback",Av="expired-callback",cv="sitekey",fw="size";function uv(Fo,Oo){for(var Ho=0;Ho<Fo.l.length;Ho++)try{Fo.l[Ho](Oo)}catch{}}function ug(Fo,Oo){return Fo.h.push(Oo),Oo.ma(function(){Ps(Fo.h,Oo)}),Oo}function wh(Fo){if(Fo.D)throw new Ko("internal-error","RecaptchaVerifier instance has been destroyed.")}function fg(Fo,Oo,Ho){var Vo=!1;try{this.b=Ho||s.app()}catch{throw new Ko("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Ko("invalid-api-key");Ho=this.b.options.apiKey;var qo=this,ns=null;try{ns=this.b.auth().Ea()}catch{}try{Vo=this.b.auth().settings.appVerificationDisabledForTesting}catch{}ns=s.SDK_VERSION?Hu(s.SDK_VERSION,ns):null,cg.call(this,Ho,Fo,Oo,function(){try{var os=qo.b.auth().ja()}catch{os=null}return os},ns,us(ts),Vo)}function fv(Fo,Oo,Ho,Vo){e:{Ho=Array.prototype.slice.call(Ho);for(var qo=0,ns=!1,os=0;os<Oo.length;os++)if(Oo[os].optional)ns=!0;else{if(ns)throw new Ko("internal-error","Argument validator encountered a required argument after an optional argument.");qo++}if(ns=Oo.length,Ho.length<qo||ns<Ho.length)Vo="Expected "+(qo==ns?qo==1?"1 argument":qo+" arguments":qo+"-"+ns+" arguments")+" but got "+Ho.length+".";else{for(qo=0;qo<Ho.length;qo++)if(ns=Oo[qo].optional&&Ho[qo]===void 0,!Oo[qo].K(Ho[qo])&&!ns){if(Oo=Oo[qo],qo<0||qo>=hv.length)throw new Ko("internal-error","Argument validator received an unsupported number of arguments.");Ho=hv[qo],Vo=(Vo?"":Ho+" argument ")+(Oo.name?'"'+Oo.name+'" ':"")+"must be "+Oo.J+".";break e}Vo=null}}if(Vo)throw new Ko("argument-error",Fo+" failed: "+Vo)}(c=cg.prototype).Ga=function(){var Fo=this;return this.f?this.f:this.f=ug(this,ls().then(function(){if($f()&&!WA())return Mh();throw new Ko("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return Fo.m.g(Fo.w())}).then(function(Oo){return Fo.g=Oo,Sl(Fo.s,ky,{})}).then(function(Oo){Fo.a[cv]=Oo.recaptchaSiteKey}).o(function(Oo){throw Fo.f=null,Oo}))},c.render=function(){wh(this);var Fo=this;return ug(this,this.Ga().then(function(){if(Fo.c===null){var Oo=Fo.u;if(!Fo.i){var Ho=kl(Oo);Oo=Yl("DIV"),Ho.appendChild(Oo)}Fo.c=Fo.g.render(Oo,Fo.a)}return Fo.c}))},c.verify=function(){wh(this);var Fo=this;return ug(this,this.render().then(function(Oo){return new vl(function(Ho){var Vo=Fo.g.getResponse(Oo);if(Vo)Ho(Vo);else{var qo=function(ns){var os;ns&&(os=qo,Qs(Fo.l,function(As){return As==os}),Ho(ns))};Fo.l.push(qo),Fo.i&&Fo.g.execute(Fo.c)}})}))},c.reset=function(){wh(this),this.c!==null&&this.g.reset(this.c)},c.clear=function(){wh(this),this.D=!0,this.m.c();for(var Fo=0;Fo<this.h.length;Fo++)this.h[Fo].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){Fo=kl(this.u);for(var Oo;Oo=Fo.firstChild;)Fo.removeChild(Oo)}},Jo(fg,cg);var hv="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function fl(Fo,Oo){return{name:Fo||"",J:"a valid string",optional:!!Oo,K:function(Ho){return typeof Ho=="string"}}}function hg(Fo,Oo){return{name:Fo||"",J:"a boolean",optional:!!Oo,K:function(Ho){return typeof Ho=="boolean"}}}function pA(Fo,Oo){return{name:Fo||"",J:"a valid object",optional:!!Oo,K:$o}}function tf(Fo,Oo){return{name:Fo||"",J:"a function",optional:!!Oo,K:Go}}function nu(Fo,Oo){return{name:Fo||"",J:"null",optional:!!Oo,K:function(Ho){return Ho===null}}}function mu(Fo){return{name:Fo?Fo+"Credential":"credential",J:Fo?"a valid "+Fo+" credential":"a valid credential",optional:!1,K:function(Oo){if(!Oo)return!1;var Ho=!Fo||Oo.providerId===Fo;return!(!Oo.ia||!Ho)}}}function dv(){return{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(Fo){return!!Fo&&!!Fo.ob}}}function nf(){return{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(Fo){return!!(Fo&&Fo.providerId&&Fo.hasOwnProperty&&Fo.hasOwnProperty("isOAuthProvider"))}}}function dg(Fo,Oo){return $o(Fo)&&typeof Fo.type=="string"&&Fo.type===Oo&&Go(Fo.Fa)}function pv(Fo){return $o(Fo)&&typeof Fo.uid=="string"}function Eh(){return{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(Fo){return!(!Fo||typeof Fo.type!="string"||!Go(Fo.verify))}}}function lA(Fo,Oo,Ho,Vo){return{name:Ho||"",J:Fo.J+" or "+Oo.J,optional:!!Vo,K:function(qo){return Fo.K(qo)||Oo.K(qo)}}}function Jl(Fo,Oo){for(var Ho in Oo){var Vo=Oo[Ho].name;Fo[Vo]=mv(Vo,Fo[Ho],Oo[Ho].j)}}function gv(Fo,Oo){for(var Ho in Oo){var Vo=Oo[Ho].name;Vo!==Ho&&Object.defineProperty(Fo,Vo,{get:es(function(qo){return this[qo]},Ho),set:es(function(qo,ns,os,As){fv(qo,[os],[As],!0),this[ns]=As},Vo,Ho,Oo[Ho].gb),enumerable:!0})}}function AA(Fo,Oo,Ho,Vo){Fo[Oo]=mv(Oo,Ho,Vo)}function mv(Fo,Oo,Ho){function Vo(){var As=Array.prototype.slice.call(arguments);return fv(os,Ho,As),Oo.apply(this,As)}if(!Ho)return Oo;var qo,ns,os=(ns=(ns=Fo).split("."))[ns.length-1];for(qo in Oo)Vo[qo]=Oo[qo];for(qo in Oo.prototype)Vo.prototype[qo]=Oo.prototype[qo];return Vo}Jl(tu.prototype,{fb:{name:"applyActionCode",j:[fl("code")]},Pa:{name:"checkActionCode",j:[fl("code")]},jb:{name:"confirmPasswordReset",j:[fl("code"),fl("newPassword")]},cc:{name:"createUserWithEmailAndPassword",j:[fl("email"),fl("password")]},fc:{name:"fetchSignInMethodsForEmail",j:[fl("email")]},pa:{name:"getRedirectResult",j:[]},zc:{name:"isSignInWithEmailLink",j:[fl("emailLink")]},Fc:{name:"onAuthStateChanged",j:[lA(pA(),tf(),"nextOrObserver"),tf("opt_error",!0),tf("opt_completed",!0)]},Gc:{name:"onIdTokenChanged",j:[lA(pA(),tf(),"nextOrObserver"),tf("opt_error",!0),tf("opt_completed",!0)]},rb:{name:"sendPasswordResetEmail",j:[fl("email"),lA(pA("opt_actionCodeSettings",!0),nu(null,!0),"opt_actionCodeSettings",!0)]},sb:{name:"sendSignInLinkToEmail",j:[fl("email"),pA("actionCodeSettings")]},tb:{name:"setPersistence",j:[fl("persistence")]},Qc:{name:"signInAndRetrieveDataWithCredential",j:[mu()]},vb:{name:"signInAnonymously",j:[]},Ya:{name:"signInWithCredential",j:[mu()]},Rc:{name:"signInWithCustomToken",j:[fl("token")]},Sc:{name:"signInWithEmailAndPassword",j:[fl("email"),fl("password")]},Tc:{name:"signInWithEmailLink",j:[fl("email"),fl("emailLink",!0)]},Uc:{name:"signInWithPhoneNumber",j:[fl("phoneNumber"),Eh()]},Vc:{name:"signInWithPopup",j:[nf()]},Wc:{name:"signInWithRedirect",j:[nf()]},bd:{name:"updateCurrentUser",j:[lA({name:"user",J:"an instance of Firebase User",optional:!1,K:function(Fo){return!!(Fo&&Fo instanceof RA)}},nu(),"user")]},wb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[fl(null,!0)]},dd:{name:"useDeviceLanguage",j:[]},fd:{name:"verifyPasswordResetCode",j:[fl("code")]}}),gv(tu.prototype,{lc:{name:"languageCode",gb:lA(fl(),nu(),"languageCode")},ti:{name:"tenantId",gb:lA(fl(),nu(),"tenantId")}}),(tu.Persistence=qu).LOCAL="local",tu.Persistence.SESSION="session",tu.Persistence.NONE="none",Jl(RA.prototype,{delete:{name:"delete",j:[]},mc:{name:"getIdTokenResult",j:[hg("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[hg("opt_forceRefresh",!0)]},Ac:{name:"linkAndRetrieveDataWithCredential",j:[mu()]},mb:{name:"linkWithCredential",j:[mu()]},Bc:{name:"linkWithPhoneNumber",j:[fl("phoneNumber"),Eh()]},Cc:{name:"linkWithPopup",j:[nf()]},Dc:{name:"linkWithRedirect",j:[nf()]},Jc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[mu()]},pb:{name:"reauthenticateWithCredential",j:[mu()]},Kc:{name:"reauthenticateWithPhoneNumber",j:[fl("phoneNumber"),Eh()]},Lc:{name:"reauthenticateWithPopup",j:[nf()]},Mc:{name:"reauthenticateWithRedirect",j:[nf()]},reload:{name:"reload",j:[]},qb:{name:"sendEmailVerification",j:[lA(pA("opt_actionCodeSettings",!0),nu(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[fl(null,!0)]},ad:{name:"unlink",j:[fl("provider")]},xb:{name:"updateEmail",j:[fl("email")]},yb:{name:"updatePassword",j:[fl("password")]},cd:{name:"updatePhoneNumber",j:[mu("phone")]},zb:{name:"updateProfile",j:[pA("profile")]},Ab:{name:"verifyBeforeUpdateEmail",j:[fl("email"),lA(pA("opt_actionCodeSettings",!0),nu(null,!0),"opt_actionCodeSettings",!0)]}}),Jl(ef.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Jl(Nf.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Jl(vl.prototype,{ma:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),gv(N_.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",gb:hg("appVerificationDisabledForTesting")}}),Jl(xp.prototype,{confirm:{name:"confirm",j:[fl("verificationCode")]}}),AA(Vu,"fromJSON",function(Fo){Fo=typeof Fo=="string"?JSON.parse(Fo):Fo;for(var Oo,Ho=[Wv,qv,zv,jv],Vo=0;Vo<Ho.length;Vo++)if(Oo=Ho[Vo](Fo))return Oo;return null},[lA(fl(),pA(),"json")]),AA(MA,"credential",function(Fo,Oo){return new du(Fo,Oo)},[fl("email"),fl("password")]),Jl(du.prototype,{v:{name:"toJSON",j:[fl(null,!0)]}}),Jl(Bu.prototype,{Aa:{name:"addScope",j:[fl("scope")]},Ia:{name:"setCustomParameters",j:[pA("customOAuthParameters")]}}),AA(Bu,"credential",pm,[lA(fl(),pA(),"token")]),AA(MA,"credentialWithLink",vm,[fl("email"),fl("emailLink")]),Jl(Iu.prototype,{Aa:{name:"addScope",j:[fl("scope")]},Ia:{name:"setCustomParameters",j:[pA("customOAuthParameters")]}}),AA(Iu,"credential",gm,[lA(fl(),pA(),"token")]),Jl(Tu.prototype,{Aa:{name:"addScope",j:[fl("scope")]},Ia:{name:"setCustomParameters",j:[pA("customOAuthParameters")]}}),AA(Tu,"credential",mm,[lA(fl(),lA(pA(),nu()),"idToken"),lA(fl(),nu(),"accessToken",!0)]),Jl(ju.prototype,{Ia:{name:"setCustomParameters",j:[pA("customOAuthParameters")]}}),AA(ju,"credential",_m,[lA(fl(),pA(),"token"),fl("secret",!0)]),Jl(DA.prototype,{Aa:{name:"addScope",j:[fl("scope")]},credential:{name:"credential",j:[lA(fl(),lA(pA(),nu()),"optionsOrIdToken"),lA(fl(),nu(),"accessToken",!0)]},Ia:{name:"setCustomParameters",j:[pA("customOAuthParameters")]}}),Jl(ou.prototype,{v:{name:"toJSON",j:[fl(null,!0)]}}),Jl(Eu.prototype,{v:{name:"toJSON",j:[fl(null,!0)]}}),AA(su,"credential",ym,[fl("verificationId"),fl("verificationCode")]),Jl(su.prototype,{cb:{name:"verifyPhoneNumber",j:[lA(fl(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(Fo){return!!Fo&&(Fo.session&&Fo.phoneNumber?dg(Fo.session,pf)&&typeof Fo.phoneNumber=="string":Fo.session&&Fo.multiFactorHint?dg(Fo.session,Xf)&&pv(Fo.multiFactorHint):Fo.session&&Fo.multiFactorUid?dg(Fo.session,Xf)&&typeof Fo.multiFactorUid=="string":!!Fo.phoneNumber&&typeof Fo.phoneNumber=="string")}},"phoneInfoOptions"),Eh()]}}),Jl(pu.prototype,{v:{name:"toJSON",j:[fl(null,!0)]}}),Jl(Ko.prototype,{toJSON:{name:"toJSON",j:[fl(null,!0)]}}),Jl(mf.prototype,{toJSON:{name:"toJSON",j:[fl(null,!0)]}}),Jl(Kd.prototype,{toJSON:{name:"toJSON",j:[fl(null,!0)]}}),Jl(Pp.prototype,{toJSON:{name:"toJSON",j:[fl(null,!0)]}}),Jl(Qp.prototype,{Pc:{name:"resolveSignIn",j:[dv()]}}),Jl(Hp.prototype,{Ob:{name:"getSession",j:[]},dc:{name:"enroll",j:[dv(),fl("displayName",!0)]},$c:{name:"unenroll",j:[lA({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:pv},fl(),"multiFactorInfoIdentifier")]}}),Jl(fg.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),AA(Td,"parseLink",Xg,[fl("link")]),AA(ag,"assertion",function(Fo){return new M_(Fo)},[mu("phone")]),function(){if(s===void 0||!s.INTERNAL||!s.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var Fo={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Vf,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:Id,VERIFY_AND_CHANGE_EMAIL:hf,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:tu,AuthCredential:Vu,Error:Ko};AA(Fo,"EmailAuthProvider",MA,[]),AA(Fo,"FacebookAuthProvider",Bu,[]),AA(Fo,"GithubAuthProvider",Iu,[]),AA(Fo,"GoogleAuthProvider",Tu,[]),AA(Fo,"TwitterAuthProvider",ju,[]),AA(Fo,"OAuthProvider",DA,[fl("providerId")]),AA(Fo,"SAMLAuthProvider",dm,[fl("providerId")]),AA(Fo,"PhoneAuthProvider",su,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(Oo){return!!(Oo&&Oo instanceof tu)}}]),AA(Fo,"RecaptchaVerifier",fg,[lA(fl(),{name:"",J:"an HTML element",optional:!1,K:function(Oo){return!!(Oo&&Oo instanceof Element)}},"recaptchaContainer"),pA("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(Oo){return!!(Oo&&Oo instanceof s.app.App)}}]),AA(Fo,"ActionCodeURL",Td,[]),AA(Fo,"PhoneMultiFactorGenerator",ag,[]),s.INTERNAL.registerComponent({name:"auth",instanceFactory:function(Oo){return new tu(Oo=Oo.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:Fo,instantiationMode:"LAZY",type:"PUBLIC"}),s.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(Oo){return{getUid:Wo((Oo=Oo.getProvider("auth").getImmediate()).getUid,Oo),getToken:Wo(Oo.kc,Oo),addAuthTokenListener:Wo(Oo.bc,Oo),removeAuthTokenListener:Wo(Oo.Nc,Oo)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),s.registerVersion("@firebase/auth","0.14.6"),s.INTERNAL.extendNamespace({User:RA})}()}.apply(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})}).apply(this,arguments)}catch(c){throw console.error(c),new Error("Cannot instantiate firebase-auth.js - be sure to load firebase-app.js first.")}})})();(function(l,o){(function(s,c){c(requireIndex_cjs())})(commonjsGlobal$1,function(s){try{(function(){s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s;var c=function(rs,ls){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ws,Ds){ws.__proto__=Ds}||function(ws,Ds){for(var Os in Ds)Ds.hasOwnProperty(Os)&&(ws[Os]=Ds[Os])})(rs,ls)};function h(rs,ls,ws,Ds){return new(ws=ws||Promise)(function(Os,Ks){function Vs(ol){try{al(Ds.next(ol))}catch(el){Ks(el)}}function ta(ol){try{al(Ds.throw(ol))}catch(el){Ks(el)}}function al(ol){var el;ol.done?Os(ol.value):((el=ol.value)instanceof ws?el:new ws(function(ml){ml(el)})).then(Vs,ta)}al((Ds=Ds.apply(rs,ls||[])).next())})}function d(rs,ls){var ws,Ds,Os,Ks,Vs={label:0,sent:function(){if(1&Os[0])throw Os[1];return Os[1]},trys:[],ops:[]};return Ks={next:ta(0),throw:ta(1),return:ta(2)},typeof Symbol=="function"&&(Ks[Symbol.iterator]=function(){return this}),Ks;function ta(al){return function(ol){return function(el){if(ws)throw new TypeError("Generator is already executing.");for(;Vs;)try{if(ws=1,Ds&&(Os=2&el[0]?Ds.return:el[0]?Ds.throw||((Os=Ds.return)&&Os.call(Ds),0):Ds.next)&&!(Os=Os.call(Ds,el[1])).done)return Os;switch(Ds=0,Os&&(el=[2&el[0],Os.value]),el[0]){case 0:case 1:Os=el;break;case 4:return Vs.label++,{value:el[1],done:!1};case 5:Vs.label++,Ds=el[1],el=[0];continue;case 7:el=Vs.ops.pop(),Vs.trys.pop();continue;default:if(!(Os=0<(Os=Vs.trys).length&&Os[Os.length-1])&&(el[0]===6||el[0]===2)){Vs=0;continue}if(el[0]===3&&(!Os||el[1]>Os[0]&&el[1]<Os[3])){Vs.label=el[1];break}if(el[0]===6&&Vs.label<Os[1]){Vs.label=Os[1],Os=el;break}if(Os&&Vs.label<Os[2]){Vs.label=Os[2],Vs.ops.push(el);break}Os[2]&&Vs.ops.pop(),Vs.trys.pop();continue}el=ls.call(rs,Vs)}catch(ml){el=[6,ml],Ds=0}finally{ws=Os=0}if(5&el[0])throw el[1];return{value:el[0]?el[1]:void 0,done:!0}}([al,ol])}}}function p(){for(var rs=0,ls=0,ws=arguments.length;ls<ws;ls++)rs+=arguments[ls].length;var Ds=Array(rs),Os=0;for(ls=0;ls<ws;ls++)for(var Ks=arguments[ls],Vs=0,ta=Ks.length;Vs<ta;Vs++,Os++)Ds[Os]=Ks[Vs];return Ds}var Co,Bo,Lo,Uo=(Co=Error,c(Bo=Po,Lo=Co),Bo.prototype=Lo===null?Object.create(Lo):(Qo.prototype=Lo.prototype,new Qo),Po);function Qo(){this.constructor=Bo}function Po(rs,ls){var ws=Co.call(this,ls)||this;return ws.code=rs,ws.name="FirebaseError",Object.setPrototypeOf(ws,Po.prototype),Error.captureStackTrace&&Error.captureStackTrace(ws,Mo.prototype.create),ws}var Mo=(Go.prototype.create=function(rs){for(var ls=[],ws=1;ws<arguments.length;ws++)ls[ws-1]=arguments[ws];for(var Ds,Os=ls[0]||{},Ks=this.service+"/"+rs,Vs=this.errors[rs],ta=Vs?(Ds=Os,Vs.replace($o,function(Fl,Xl){var tA=Ds[Xl];return tA!=null?tA.toString():"<"+Xl+"?>"})):"Error",al=this.serviceName+": "+ta+" ("+Ks+").",ol=new Uo(Ks,al),el=0,ml=Object.keys(Os);el<ml.length;el++){var yl=ml[el];yl.slice(-1)!=="_"&&(yl in ol&&console.warn('Overwriting FirebaseError base field "'+yl+'" can cause unexpected behavior.'),ol[yl]=Os[yl])}return ol},Go);function Go(rs,ls,ws){this.service=rs,this.serviceName=ls,this.errors=ws}var $o=/\{\$([^}]+)}/g,jo=(zo.prototype.setInstantiationMode=function(rs){return this.instantiationMode=rs,this},zo.prototype.setMultipleInstances=function(rs){return this.multipleInstances=rs,this},zo.prototype.setServiceProps=function(rs){return this.serviceProps=rs,this},zo);function zo(rs,ls,ws){this.name=rs,this.instanceFactory=ls,this.type=ws,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Xo="firebasestorage.googleapis.com",Zo=(Wo.prototype.codeProp=function(){return this.code},Wo.prototype.codeEquals=function(rs){return is(rs)===this.codeProp()},Wo.prototype.serverResponseProp=function(){return this.serverResponse_},Wo.prototype.setServerResponseProp=function(rs){this.serverResponse_=rs},Object.defineProperty(Wo.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(Wo.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(Wo.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(Wo.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),Wo);function Wo(rs,ls){this.code_=is(rs),this.message_="Firebase Storage: "+ls,this.serverResponse_=null,this.name_="FirebaseError"}var es={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function is(rs){return"storage/"+rs}function Jo(){return new Zo(es.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Ko(){return new Zo(es.CANCELED,"User canceled the upload/download.")}function Yo(){return new Zo(es.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ts(rs,ls,ws){return new Zo(es.INVALID_ARGUMENT,"Invalid argument in `"+ls+"` at index "+rs+": "+ws)}function ss(){return new Zo(es.APP_DELETED,"The Firebase app was deleted.")}function cs(rs,ls){return new Zo(es.INVALID_FORMAT,"String does not match format '"+rs+"': "+ls)}function as(rs){throw new Zo(es.INTERNAL_ERROR,"Internal error: "+rs)}var us={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function gs(rs){switch(rs){case us.RAW:case us.BASE64:case us.BASE64URL:case us.DATA_URL:return;default:throw"Expected one of the event types: ["+us.RAW+", "+us.BASE64+", "+us.BASE64URL+", "+us.DATA_URL+"]."}}var Is=function(rs,ls){this.data=rs,this.contentType=ls||null};function _s(rs,ls){switch(rs){case us.RAW:return new Is(Hs(ls));case us.BASE64:case us.BASE64URL:return new Is(ds(rs,ls));case us.DATA_URL:return new Is((ws=new hs(ls)).base64?ds(us.BASE64,ws.rest):function(Ds){var Os;try{Os=decodeURIComponent(Ds)}catch{throw cs(us.DATA_URL,"Malformed data URL.")}return Hs(Os)}(ws.rest),new hs(ls).contentType)}var ws;throw Jo()}function Hs(rs){for(var ls=[],ws=0;ws<rs.length;ws++){var Ds=rs.charCodeAt(ws);Ds<=127?ls.push(Ds):Ds<=2047?ls.push(192|Ds>>6,128|63&Ds):(64512&Ds)==55296?ws<rs.length-1&&(64512&rs.charCodeAt(ws+1))==56320?(Ds=65536|(1023&Ds)<<10|1023&rs.charCodeAt(++ws),ls.push(240|Ds>>18,128|Ds>>12&63,128|Ds>>6&63,128|63&Ds)):ls.push(239,191,189):(64512&Ds)==56320?ls.push(239,191,189):ls.push(224|Ds>>12,128|Ds>>6&63,128|63&Ds)}return new Uint8Array(ls)}function ds(rs,ls){switch(rs){case us.BASE64:var ws=ls.indexOf("-")!==-1,Ds=ls.indexOf("_")!==-1;if(ws||Ds)throw cs(rs,"Invalid character '"+(ws?"-":"_")+"' found: is it base64url encoded?");break;case us.BASE64URL:var Os=ls.indexOf("+")!==-1,Ks=ls.indexOf("/")!==-1;if(Os||Ks)throw cs(rs,"Invalid character '"+(Os?"+":"/")+"' found: is it base64 encoded?");ls=ls.replace(/-/g,"+").replace(/_/g,"/")}var Vs;try{Vs=atob(ls)}catch{throw cs(rs,"Invalid character found")}for(var ta=new Uint8Array(Vs.length),al=0;al<Vs.length;al++)ta[al]=Vs.charCodeAt(al);return ta}var hs=function(rs){this.base64=!1,this.contentType=null;var ls=rs.match(/^data:([^,]+)?,/);if(ls===null)throw cs(us.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var ws,Ds,Os=ls[1]||null;Os!=null&&(this.base64=(Ds=";base64",(ws=Os).length>=Ds.length&&ws.substring(ws.length-Ds.length)===Ds),this.contentType=this.base64?Os.substring(0,Os.length-7):Os),this.rest=rs.substring(rs.indexOf(",")+1)},ys,ms,Rs={STATE_CHANGED:"state_changed"},bs="running",ps="pausing",ks="paused",xs="success",Ss="canceling",Us="canceled",Ps="error",Qs={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Js(rs){switch(rs){case bs:case ps:case Ss:return Qs.RUNNING;case ks:return Qs.PAUSED;case xs:return Qs.SUCCESS;case Us:return Qs.CANCELED;case Ps:default:return Qs.ERROR}}function qs(rs){return rs!=null}function Gs(rs){return rs!==void 0}function Zs(rs){return typeof rs=="function"}function Es(rs){return typeof rs=="object"}function fs(rs){return typeof rs=="string"||rs instanceof String}function vs(rs){return typeof rs=="number"||rs instanceof Number}function Bs(rs){return Ls()&&rs instanceof Blob}function Ls(){return typeof Blob<"u"}(ms=ys=ys||{})[ms.NO_ERROR=0]="NO_ERROR",ms[ms.NETWORK_ERROR=1]="NETWORK_ERROR",ms[ms.ABORT=2]="ABORT";var Fs=(zs.prototype.send=function(rs,ls,ws,Ds){if(this.sent_)throw as("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(ls,rs,!0),qs(Ds))for(var Os in Ds)Ds.hasOwnProperty(Os)&&this.xhr_.setRequestHeader(Os,Ds[Os].toString());return qs(ws)?this.xhr_.send(ws):this.xhr_.send(),this.sendPromise_},zs.prototype.getErrorCode=function(){if(!this.sent_)throw as("cannot .getErrorCode() before sending");return this.errorCode_},zs.prototype.getStatus=function(){if(!this.sent_)throw as("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}},zs.prototype.getResponseText=function(){if(!this.sent_)throw as("cannot .getResponseText() before sending");return this.xhr_.responseText},zs.prototype.abort=function(){this.xhr_.abort()},zs.prototype.getResponseHeader=function(rs){return this.xhr_.getResponseHeader(rs)},zs.prototype.addUploadProgressListener=function(rs){qs(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",rs)},zs.prototype.removeUploadProgressListener=function(rs){qs(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",rs)},zs);function zs(){var rs=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=ys.NO_ERROR,this.sendPromise_=new Promise(function(ls){rs.xhr_.addEventListener("abort",function(){rs.errorCode_=ys.ABORT,ls(rs)}),rs.xhr_.addEventListener("error",function(){rs.errorCode_=ys.NETWORK_ERROR,ls(rs)}),rs.xhr_.addEventListener("load",function(){ls(rs)})})}var js=(ma.prototype.createXhrIo=function(){return new Fs},ma);function ma(){}function Ws(){for(var rs=[],ls=0;ls<arguments.length;ls++)rs[ls]=arguments[ls];var ws=typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0;if(ws!==void 0){for(var Ds=new ws,Os=0;Os<rs.length;Os++)Ds.append(rs[Os]);return Ds.getBlob()}if(Ls())return new Blob(rs);throw Error("This browser doesn't seem to support creating Blobs")}var va=(ca.prototype.size=function(){return this.size_},ca.prototype.type=function(){return this.type_},ca.prototype.slice=function(rs,ls){if(Bs(this.data_)){var ws=this.data_,Ds=(Ks=rs,Vs=ls,(Os=ws).webkitSlice?Os.webkitSlice(Ks,Vs):Os.mozSlice?Os.mozSlice(Ks,Vs):Os.slice?Os.slice(Ks,Vs):null);return Ds===null?null:new ca(Ds)}var Os,Ks,Vs;return new ca(new Uint8Array(this.data_.buffer,rs,ls-rs),!0)},ca.getBlob=function(){for(var rs=[],ls=0;ls<arguments.length;ls++)rs[ls]=arguments[ls];if(Ls()){var ws=rs.map(function(ta){return ta instanceof ca?ta.data_:ta});return new ca(Ws.apply(null,ws))}var Ds=rs.map(function(ta){return fs(ta)?_s(us.RAW,ta).data:ta.data_}),Os=0;Ds.forEach(function(ta){Os+=ta.byteLength});var Ks=new Uint8Array(Os),Vs=0;return Ds.forEach(function(ta){for(var al=0;al<ta.length;al++)Ks[Vs++]=ta[al]}),new ca(Ks,!0)},ca.prototype.uploadData=function(){return this.data_},ca);function ca(rs,ls){var ws=0,Ds="";Bs(rs)?(ws=(this.data_=rs).size,Ds=rs.type):rs instanceof ArrayBuffer?(ls?this.data_=new Uint8Array(rs):(this.data_=new Uint8Array(rs.byteLength),this.data_.set(new Uint8Array(rs))),ws=this.data_.length):rs instanceof Uint8Array&&(ls?this.data_=rs:(this.data_=new Uint8Array(rs.length),this.data_.set(rs)),ws=rs.length),this.size_=ws,this.type_=Ds}var cl=(Object.defineProperty(Ms.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),Object.defineProperty(Ms.prototype,"isRoot",{get:function(){return this.path.length===0},enumerable:!0,configurable:!0}),Ms.prototype.fullServerUrl=function(){var rs=encodeURIComponent;return"/b/"+rs(this.bucket)+"/o/"+rs(this.path)},Ms.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},Ms.makeFromBucketSpec=function(rs){var ls,ws;try{ls=Ms.makeFromUrl(rs)}catch{return new Ms(rs,"")}if(ls.path==="")return ls;throw ws=rs,new Zo(es.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+ws+"'.")},Ms.makeFromUrl=function(rs){var ls=null,ws="([A-Za-z0-9.\\-_]+)",Ds=new RegExp("^gs://"+ws+"(/(.*))?$","i");function Os(Fl){Fl.path_=decodeURIComponent(Fl.path)}for(var Ks,Vs=Xo.replace(/[.]/g,"\\."),ta=[{regex:Ds,indices:{bucket:1,path:3},postModify:function(Fl){Fl.path.charAt(Fl.path.length-1)==="/"&&(Fl.path_=Fl.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+Vs+"/v[A-Za-z0-9_]+/b/"+ws+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:Os},{regex:new RegExp("^https?://(?:storage.googleapis.com|storage.cloud.google.com)/"+ws+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:Os}],al=0;al<ta.length;al++){var ol=ta[al],el=ol.regex.exec(rs);if(el){var ml=el[ol.indices.bucket],yl=el[ol.indices.path];ls=new Ms(ml,yl=yl||""),ol.postModify(ls);break}}if(ls==null)throw Ks=rs,new Zo(es.INVALID_URL,"Invalid URL '"+Ks+"'.");return ls},Ms);function Ms(rs,ls){this.bucket=rs,this.path_=ls}function $s(rs){var ls,ws;try{ls=JSON.parse(rs)}catch{return null}return Es(ws=ls)&&!Array.isArray(ws)?ls:null}function ga(rs){var ls=rs.lastIndexOf("/",rs.length-2);return ls===-1?rs:rs.slice(ls+1)}function Xs(rs){return"https://"+Xo+"/v0"+rs}function ll(rs){var ls=encodeURIComponent,ws="?";for(var Ds in rs)rs.hasOwnProperty(Ds)&&(ws=ws+(ls(Ds)+"="+ls(rs[Ds]))+"&");return ws=ws.slice(0,-1)}function sl(rs,ls){return ls}var nl=function(rs,ls,ws,Ds){this.server=rs,this.local=ls||rs,this.writable=!!ws,this.xform=Ds||sl},pl=null;function El(){if(pl)return pl;var rs=[];rs.push(new nl("bucket")),rs.push(new nl("generation")),rs.push(new nl("metageneration")),rs.push(new nl("name","fullPath",!0));var ls=new nl("name");ls.xform=function(Ds,Os){return!fs(Ks=Os)||Ks.length<2?Ks:ga(Ks);var Ks},rs.push(ls);var ws=new nl("size");return ws.xform=function(Ds,Os){return qs(Os)?Number(Os):Os},rs.push(ws),rs.push(new nl("timeCreated")),rs.push(new nl("updated")),rs.push(new nl("md5Hash",null,!0)),rs.push(new nl("cacheControl",null,!0)),rs.push(new nl("contentDisposition",null,!0)),rs.push(new nl("contentEncoding",null,!0)),rs.push(new nl("contentLanguage",null,!0)),rs.push(new nl("contentType",null,!0)),rs.push(new nl("metadata","customMetadata",!0)),pl=rs}function cA(rs,ls){Object.defineProperty(rs,"ref",{get:function(){var ws=rs.bucket,Ds=rs.fullPath,Os=new cl(ws,Ds);return ls.makeStorageReference(Os)}})}function rl(rs,ls,ws){var Ds=$s(ls);return Ds===null?null:function(Os,Ks,Vs){for(var ta={type:"file"},al=Vs.length,ol=0;ol<al;ol++){var el=Vs[ol];ta[el.local]=el.xform(ta,Ks[el.server])}return cA(ta,Os),ta}(rs,Ds,ws)}function Cl(rs,ls){for(var ws={},Ds=ls.length,Os=0;Os<Ds;Os++){var Ks=ls[Os];Ks.writable&&(ws[Ks.server]=rs[Ks.local])}return JSON.stringify(ws)}function Ul(rs){if(!Es(rs)||!rs)throw"Expected Metadata object.";for(var ls in rs)if(rs.hasOwnProperty(ls)){var ws=rs[ls];if(ls==="customMetadata"){if(!Es(ws))throw"Expected object for 'customMetadata' mapping."}else if(Es(Ds=ws)&&Ds!==null)throw"Mapping for '"+ls+"' cannot be an object."}var Ds}var Nl="maxResults",Ll=1e3,hl="pageToken",gl="prefixes",zl="items";function bA(rs,ls,ws){var Ds=$s(ws);return Ds===null?null:function(Os,Ks,Vs){var ta={prefixes:[],items:[],nextPageToken:Vs.nextPageToken};if(Vs[gl])for(var al=0,ol=Vs[gl];al<ol.length;al++){var el=ol[al].replace(/\/$/,""),ml=Os.makeStorageReference(new cl(Ks,el));ta.prefixes.push(ml)}if(Vs[zl])for(var yl=0,Fl=Vs[zl];yl<Fl.length;yl++){var Xl=Fl[yl];ml=Os.makeStorageReference(new cl(Ks,Xl.name)),ta.items.push(ml)}return ta}(rs,ls,Ds)}function UA(rs){if(!Es(rs)||!rs)throw"Expected ListOptions object.";for(var ls in rs)if(ls===Nl){if(!vs(ws=rs[Nl])||!Number.isInteger(ws)||rs[Nl]<=0)throw"Expected maxResults to be a positive number.";if(1e3<rs[Nl])throw"Expected maxResults to be less than or equal to "+Ll+"."}else{if(ls!==hl)throw"Unknown option: "+ls;if(rs[hl]&&!fs(rs[hl]))throw"Expected pageToken to be string."}var ws}var Dl=function(rs,ls,ws,Ds){this.url=rs,this.method=ls,this.handler=ws,this.timeout=Ds,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Kl(rs){if(!rs)throw Jo()}function vA(rs,ls){return function(ws,Ds){var Os=rl(rs,Ds,ls);return Kl(Os!==null),Os}}function Vl(rs,ls){return function(ws,Ds){var Os=bA(rs,ls,Ds);return Kl(Os!==null),Os}}function TA(rs,ls){return function(ws,Ds){var Os=rl(rs,Ds,ls);return Kl(Os!==null),function(Ks,Vs){var ta=$s(Vs);if(ta===null||!fs(ta.downloadTokens))return null;var al=ta.downloadTokens;if(al.length===0)return null;var ol=encodeURIComponent;return al.split(",").map(function(el){var ml=Ks.bucket,yl=Ks.fullPath;return Xs("/b/"+ol(ml)+"/o/"+ol(yl))+ll({alt:"media",token:el})})[0]}(Os,Ds)}}function Tl(rs){return function(ls,ws){var Ds,Os,Ks;return(Ds=ls.getStatus()===401?new Zo(es.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):ls.getStatus()===402?(Ks=rs.bucket,new Zo(es.QUOTA_EXCEEDED,"Quota for bucket '"+Ks+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):ls.getStatus()===403?(Os=rs.path,new Zo(es.UNAUTHORIZED,"User does not have permission to access '"+Os+"'.")):ws).setServerResponseProp(ws.serverResponseProp()),Ds}}function xl(rs){var ls=Tl(rs);return function(ws,Ds){var Os,Ks=ls(ws,Ds);return ws.getStatus()===404&&(Os=rs.path,Ks=new Zo(es.OBJECT_NOT_FOUND,"Object '"+Os+"' does not exist.")),Ks.setServerResponseProp(Ds.serverResponseProp()),Ks}}function ua(rs,ls,ws){var Ds=Xs(ls.fullServerUrl()),Os=rs.maxOperationRetryTime(),Ks=new Dl(Ds,"GET",vA(rs,ws),Os);return Ks.errorHandler=xl(ls),Ks}function _l(rs,ls,ws){var Ds,Os,Ks=Object.assign({},ws);return Ks.fullPath=rs.path,Ks.size=ls.size(),Ks.contentType||(Ks.contentType=(Os=ls,(Ds=null)&&Ds.contentType||Os&&Os.type()||"application/octet-stream")),Ks}function uA(rs,ls,ws,Ds,Os){var Ks=ls.bucketOnlyServerUrl(),Vs={"X-Goog-Upload-Protocol":"multipart"},ta=function(){for(var Gl="",nA=0;nA<2;nA++)Gl+=Math.random().toString().slice(2);return Gl}();Vs["Content-Type"]="multipart/related; boundary="+ta;var al=_l(ls,Ds,Os),ol="--"+ta+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+Cl(al,ws)+`\r
--`+ta+`\r
Content-Type: `+al.contentType+`\r
\r
`,el=`\r
--`+ta+"--",ml=va.getBlob(ol,Ds,el);if(ml===null)throw Yo();var yl={name:al.fullPath},Fl=Xs(Ks),Xl=rs.maxUploadRetryTime(),tA=new Dl(Fl,"POST",vA(rs,ws),Xl);return tA.urlParams=yl,tA.headers=Vs,tA.body=ml.uploadData(),tA.errorHandler=Tl(ls),tA}var fA=function(rs,ls,ws,Ds){this.current=rs,this.total=ls,this.finalized=!!ws,this.metadata=Ds||null};function hA(rs,ls){var ws=null;try{ws=rs.getResponseHeader("X-Goog-Upload-Status")}catch{Kl(!1)}return Kl(!!ws&&(ls||["active"]).indexOf(ws)!==-1),ws}function Zl(rs,ls,ws,Ds,Os){var Ks=ls.bucketOnlyServerUrl(),Vs=_l(ls,Ds,Os),ta={name:Vs.fullPath},al=Xs(Ks),ol={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":Ds.size(),"X-Goog-Upload-Header-Content-Type":Vs.contentType,"Content-Type":"application/json; charset=utf-8"},el=Cl(Vs,ws),ml=rs.maxUploadRetryTime(),yl=new Dl(al,"POST",function(Fl){var Xl;hA(Fl);try{Xl=Fl.getResponseHeader("X-Goog-Upload-URL")}catch{Kl(!1)}return Kl(fs(Xl)),Xl},ml);return yl.urlParams=ta,yl.headers=ol,yl.body=el,yl.errorHandler=Tl(ls),yl}function kA(rs,ls,ws,Ds){var Os=rs.maxUploadRetryTime(),Ks=new Dl(ws,"POST",function(Vs){var ta=hA(Vs,["active","final"]),al=null;try{al=Vs.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Kl(!1)}al||Kl(!1);var ol=Number(al);return Kl(!isNaN(ol)),new fA(ol,Ds.size(),ta==="final")},Os);return Ks.headers={"X-Goog-Upload-Command":"query"},Ks.errorHandler=Tl(ls),Ks}function Ml(rs,ls,ws,Ds,Os,Ks,Vs,ta){var al=new fA(0,0);if(Vs?(al.current=Vs.current,al.total=Vs.total):(al.current=0,al.total=Ds.size()),Ds.size()!==al.total)throw new Zo(es.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var ol=al.total-al.current,el=ol;0<Os&&(el=Math.min(el,Os));var ml=al.current,yl=ml+el,Fl={"X-Goog-Upload-Command":el===ol?"upload, finalize":"upload","X-Goog-Upload-Offset":al.current},Xl=Ds.slice(ml,yl);if(Xl===null)throw Yo();var tA=ls.maxUploadRetryTime(),Gl=new Dl(ws,"POST",function(nA,mA){var VA,sA=hA(nA,["active","final"]),LA=al.current+el,rA=Ds.size();return VA=sA==="final"?vA(ls,Ks)(nA,mA):null,new fA(LA,rA,sA==="final",VA)},tA);return Gl.headers=Fl,Gl.body=Xl.uploadData(),Gl.progressCallback=ta||null,Gl.errorHandler=Tl(rs),Gl}var jl=function(rs,ls,ws){if(Zs(rs)||qs(ls)||qs(ws))this.next=rs,this.error=ls||null,this.complete=ws||null;else{var Ds=rs;this.next=Ds.next||null,this.error=Ds.error||null,this.complete=Ds.complete||null}},GA=function(rs,ls,ws,Ds,Os,Ks){this.bytesTransferred=rs,this.totalBytes=ls,this.state=ws,this.metadata=Ds,this.task=Os,this.ref=Ks};function Ol(rs,ls,ws){for(var Ds=ls.length,Os=ls.length,Ks=0;Ks<ls.length;Ks++)if(ls[Ks].optional){Ds=Ks;break}var Vs,ta,al,ol,el,ml;if(!(Ds<=ws.length&&ws.length<=Os))throw Vs=Ds,ta=Os,al=rs,ol=ws.length,ml=Vs===ta?(el=Vs)===1?"argument":"arguments":(el="between "+Vs+" and "+ta,"arguments"),new Zo(es.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+al+"`: Expected "+el+" "+ml+", received "+ol+".");for(Ks=0;Ks<ws.length;Ks++)try{ls[Ks].validator(ws[Ks])}catch(yl){throw yl instanceof Error?ts(Ks,rs,yl.message):ts(Ks,rs,yl)}}var yA=function(rs,ls){var ws=this;this.validator=function(Ds){ws.optional&&!Gs(Ds)||rs(Ds)},this.optional=!!ls};function wA(rs,ls){function ws(Vs){if(!fs(Vs))throw"Expected string."}var Ds,Os,Ks;return Ds=rs?(Os=ws,Ks=rs,function(Vs){Os(Vs),Ks(Vs)}):ws,new yA(Ds,ls)}function $A(){return new yA(function(rs){if(!(rs instanceof Uint8Array||rs instanceof ArrayBuffer||Ls()&&rs instanceof Blob))throw"Expected Blob or File."})}function Cs(rs){return new yA(Ul,rs)}function Al(){return new yA(function(rs){if(!(vs(rs)&&0<=rs))throw"Expected a number 0 or greater."})}function bl(rs,ls){return new yA(function(ws){if(!(ws===null||qs(ws)&&ws instanceof Object))throw"Expected an Object.";rs!=null&&rs(ws)},ls)}function Wl(rs){return new yA(function(ls){if(!(ls===null||Zs(ls)))throw"Expected a Function."},rs)}function oA(rs){return function(){for(var ls=[],ws=0;ws<arguments.length;ws++)ls[ws]=arguments[ws];Promise.resolve().then(function(){return rs.apply(void 0,ls)})}}var gA=(kl.prototype.makeProgressCallback_=function(){var rs=this,ls=this.transferred_;return function(ws){return rs.updateProgress_(ls+ws)}},kl.prototype.shouldDoResumable_=function(rs){return 262144<rs.size()},kl.prototype.start_=function(){this.state_===bs&&this.request_===null&&(this.resumable_?this.uploadUrl_===null?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},kl.prototype.resolveToken_=function(rs){var ls=this;this.authWrapper_.getAuthToken().then(function(ws){switch(ls.state_){case bs:rs(ws);break;case Ss:ls.transition_(Us);break;case ps:ls.transition_(ks)}})},kl.prototype.createResumable_=function(){var rs=this;this.resolveToken_(function(ls){var ws=Zl(rs.authWrapper_,rs.location_,rs.mappings_,rs.blob_,rs.metadata_),Ds=rs.authWrapper_.makeRequest(ws,ls);(rs.request_=Ds).getPromise().then(function(Os){rs.request_=null,rs.uploadUrl_=Os,rs.needToFetchStatus_=!1,rs.completeTransitions_()},rs.errorHandler_)})},kl.prototype.fetchStatus_=function(){var rs=this,ls=this.uploadUrl_;this.resolveToken_(function(ws){var Ds=kA(rs.authWrapper_,rs.location_,ls,rs.blob_),Os=rs.authWrapper_.makeRequest(Ds,ws);(rs.request_=Os).getPromise().then(function(Ks){Ks=Ks,rs.request_=null,rs.updateProgress_(Ks.current),rs.needToFetchStatus_=!1,Ks.finalized&&(rs.needToFetchMetadata_=!0),rs.completeTransitions_()},rs.errorHandler_)})},kl.prototype.continueUpload_=function(){var rs=this,ls=262144*this.chunkMultiplier_,ws=new fA(this.transferred_,this.blob_.size()),Ds=this.uploadUrl_;this.resolveToken_(function(Os){var Ks;try{Ks=Ml(rs.location_,rs.authWrapper_,Ds,rs.blob_,ls,rs.mappings_,ws,rs.makeProgressCallback_())}catch(ta){return rs.error_=ta,void rs.transition_(Ps)}var Vs=rs.authWrapper_.makeRequest(Ks,Os);(rs.request_=Vs).getPromise().then(function(ta){rs.increaseMultiplier_(),rs.request_=null,rs.updateProgress_(ta.current),ta.finalized?(rs.metadata_=ta.metadata,rs.transition_(xs)):rs.completeTransitions_()},rs.errorHandler_)})},kl.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},kl.prototype.fetchMetadata_=function(){var rs=this;this.resolveToken_(function(ls){var ws=ua(rs.authWrapper_,rs.location_,rs.mappings_),Ds=rs.authWrapper_.makeRequest(ws,ls);(rs.request_=Ds).getPromise().then(function(Os){rs.request_=null,rs.metadata_=Os,rs.transition_(xs)},rs.metadataErrorHandler_)})},kl.prototype.oneShotUpload_=function(){var rs=this;this.resolveToken_(function(ls){var ws=uA(rs.authWrapper_,rs.location_,rs.mappings_,rs.blob_,rs.metadata_),Ds=rs.authWrapper_.makeRequest(ws,ls);(rs.request_=Ds).getPromise().then(function(Os){rs.request_=null,rs.metadata_=Os,rs.updateProgress_(rs.blob_.size()),rs.transition_(xs)},rs.errorHandler_)})},kl.prototype.updateProgress_=function(rs){var ls=this.transferred_;this.transferred_=rs,this.transferred_!==ls&&this.notifyObservers_()},kl.prototype.transition_=function(rs){if(this.state_!==rs)switch(rs){case Ss:case ps:this.state_=rs,this.request_!==null&&this.request_.cancel();break;case bs:var ls=this.state_===ks;this.state_=rs,ls&&(this.notifyObservers_(),this.start_());break;case ks:this.state_=rs,this.notifyObservers_();break;case Us:this.error_=Ko(),this.state_=rs,this.notifyObservers_();break;case Ps:case xs:this.state_=rs,this.notifyObservers_()}},kl.prototype.completeTransitions_=function(){switch(this.state_){case ps:this.transition_(ks);break;case Ss:this.transition_(Us);break;case bs:this.start_()}},Object.defineProperty(kl.prototype,"snapshot",{get:function(){var rs=Js(this.state_);return new GA(this.transferred_,this.blob_.size(),rs,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),kl.prototype.on=function(rs,ls,ws,Ds){var Os="Expected a function or an Object with one of `next`, `error`, `complete` properties.",Ks=Wl(!0).validator,Vs=bl(null,!0).validator;function ta(ml){try{return void Ks(ml)}catch{}try{if(Vs(ml),!(Gs(ml.next)||Gs(ml.error)||Gs(ml.complete)))throw"";return}catch{throw Os}}Ol("on",[wA(function(){if(rs!==Rs.STATE_CHANGED)throw"Expected one of the event types: ["+Rs.STATE_CHANGED+"]."}),bl(ta,!0),Wl(!0),Wl(!0)],arguments);var al=this;function ol(ml){return function(yl,Fl,Xl){ml!==null&&Ol("on",ml,arguments);var tA=new jl(yl,Fl,Ds);return al.addObserver_(tA),function(){al.removeObserver_(tA)}}}var el=[bl(function(ml){if(ml===null)throw Os;ta(ml)}),Wl(!0),Wl(!0)];return Gs(ls)||Gs(ws)||Gs(Ds)?ol(null)(ls,ws,Ds):ol(el)},kl.prototype.then=function(rs,ls){return this.promise_.then(rs,ls)},kl.prototype.catch=function(rs){return this.then(null,rs)},kl.prototype.addObserver_=function(rs){this.observers_.push(rs),this.notifyObserver_(rs)},kl.prototype.removeObserver_=function(rs){var ls=this.observers_.indexOf(rs);ls!==-1&&this.observers_.splice(ls,1)},kl.prototype.notifyObservers_=function(){var rs=this;this.finishPromise_(),this.observers_.slice().forEach(function(ls){rs.notifyObserver_(ls)})},kl.prototype.finishPromise_=function(){if(this.resolve_!==null){var rs=!0;switch(Js(this.state_)){case Qs.SUCCESS:oA(this.resolve_.bind(null,this.snapshot))();break;case Qs.CANCELED:case Qs.ERROR:oA(this.reject_.bind(null,this.error_))();break;default:rs=!1}rs&&(this.resolve_=null,this.reject_=null)}},kl.prototype.notifyObserver_=function(rs){switch(Js(this.state_)){case Qs.RUNNING:case Qs.PAUSED:rs.next&&oA(rs.next.bind(rs,this.snapshot))();break;case Qs.SUCCESS:rs.complete&&oA(rs.complete.bind(rs))();break;case Qs.CANCELED:case Qs.ERROR:rs.error&&oA(rs.error.bind(rs,this.error_))();break;default:rs.error&&oA(rs.error.bind(rs,this.error_))()}},kl.prototype.resume=function(){Ol("resume",[],arguments);var rs=this.state_===ks||this.state_===ps;return rs&&this.transition_(bs),rs},kl.prototype.pause=function(){Ol("pause",[],arguments);var rs=this.state_===bs;return rs&&this.transition_(ps),rs},kl.prototype.cancel=function(){Ol("cancel",[],arguments);var rs=this.state_===bs||this.state_===ps;return rs&&this.transition_(Ss),rs},kl);function kl(rs,ls,ws,Ds,Os,Ks){var Vs=this;Ks===void 0&&(Ks=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=rs,this.authWrapper_=ls,this.location_=ws,this.blob_=Os,this.metadata_=Ks,this.mappings_=Ds,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=bs,this.errorHandler_=function(ta){Vs.request_=null,Vs.chunkMultiplier_=1,ta.codeEquals(es.CANCELED)?(Vs.needToFetchStatus_=!0,Vs.completeTransitions_()):(Vs.error_=ta,Vs.transition_(Ps))},this.metadataErrorHandler_=function(ta){Vs.request_=null,ta.codeEquals(es.CANCELED)?Vs.completeTransitions_():(Vs.error_=ta,Vs.transition_(Ps))},this.promise_=new Promise(function(ta,al){Vs.resolve_=ta,Vs.reject_=al,Vs.start_()}),this.promise_.then(null,function(){})}var EA=(Ql.prototype.toString=function(){return Ol("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},Ql.prototype.newRef=function(rs,ls){return new Ql(rs,ls)},Ql.prototype.mappings=function(){return El()},Ql.prototype.child=function(rs){Ol("child",[wA()],arguments);var ls,ws,Ds=(ls=this.location.path,ws=rs.split("/").filter(function(Ks){return 0<Ks.length}).join("/"),ls.length===0?ws:ls+"/"+ws),Os=new cl(this.location.bucket,Ds);return this.newRef(this.authWrapper,Os)},Object.defineProperty(Ql.prototype,"parent",{get:function(){var rs=function(ws){if(ws.length===0)return null;var Ds=ws.lastIndexOf("/");return Ds===-1?"":ws.slice(0,Ds)}(this.location.path);if(rs===null)return null;var ls=new cl(this.location.bucket,rs);return this.newRef(this.authWrapper,ls)},enumerable:!0,configurable:!0}),Object.defineProperty(Ql.prototype,"root",{get:function(){var rs=new cl(this.location.bucket,"");return this.newRef(this.authWrapper,rs)},enumerable:!0,configurable:!0}),Object.defineProperty(Ql.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(Ql.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(Ql.prototype,"name",{get:function(){return ga(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(Ql.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),Ql.prototype.put=function(rs,ls){return ls===void 0&&(ls=null),Ol("put",[$A(),Cs(!0)],arguments),this.throwIfRoot_("put"),new gA(this,this.authWrapper,this.location,this.mappings(),new va(rs),ls)},Ql.prototype.putString=function(rs,ls,ws){ls===void 0&&(ls=us.RAW),Ol("putString",[wA(),wA(gs,!0),Cs(!0)],arguments),this.throwIfRoot_("putString");var Ds=_s(ls,rs),Os=Object.assign({},ws);return!qs(Os.contentType)&&qs(Ds.contentType)&&(Os.contentType=Ds.contentType),new gA(this,this.authWrapper,this.location,this.mappings(),new va(Ds.data,!0),Os)},Ql.prototype.delete=function(){var rs=this;return Ol("delete",[],arguments),this.throwIfRoot_("delete"),this.authWrapper.getAuthToken().then(function(ls){var ws,Ds,Os,Ks,Vs,ta=(ws=rs.authWrapper,Ds=rs.location,Os=Xs(Ds.fullServerUrl()),Ks=ws.maxOperationRetryTime(),(Vs=new Dl(Os,"DELETE",function(al,ol){},Ks)).successCodes=[200,204],Vs.errorHandler=xl(Ds),Vs);return rs.authWrapper.makeRequest(ta,ls).getPromise()})},Ql.prototype.listAll=function(){Ol("listAll",[],arguments);var rs={prefixes:[],items:[]};return this.listAllHelper(rs).then(function(){return rs})},Ql.prototype.listAllHelper=function(rs,ls){return h(this,void 0,void 0,function(){var ws,Ds,Os,Ks;return d(this,function(Vs){switch(Vs.label){case 0:return ws={pageToken:ls},[4,this.list(ws)];case 1:return Ds=Vs.sent(),(Os=rs.prefixes).push.apply(Os,Ds.prefixes),(Ks=rs.items).push.apply(Ks,Ds.items),Ds.nextPageToken==null?[3,3]:[4,this.listAllHelper(rs,Ds.nextPageToken)];case 2:Vs.sent(),Vs.label=3;case 3:return[2]}})})},Ql.prototype.list=function(rs){Ol("list",[new yA(UA,!0)],arguments);var ls=this;return this.authWrapper.getAuthToken().then(function(ws){var Ds=rs||{},Os=function(Ks,Vs,ta,al,ol){var el={};Vs.isRoot?el.prefix="":el.prefix=Vs.path+"/",ta&&0<ta.length&&(el.delimiter=ta),al&&(el.pageToken=al),ol&&(el.maxResults=ol);var ml=Xs(Vs.bucketOnlyServerUrl()),yl=Ks.maxOperationRetryTime(),Fl=new Dl(ml,"GET",Vl(Ks,Vs.bucket),yl);return Fl.urlParams=el,Fl.errorHandler=Tl(Vs),Fl}(ls.authWrapper,ls.location,"/",Ds.pageToken,Ds.maxResults);return ls.authWrapper.makeRequest(Os,ws).getPromise()})},Ql.prototype.getMetadata=function(){var rs=this;return Ol("getMetadata",[],arguments),this.throwIfRoot_("getMetadata"),this.authWrapper.getAuthToken().then(function(ls){var ws=ua(rs.authWrapper,rs.location,rs.mappings());return rs.authWrapper.makeRequest(ws,ls).getPromise()})},Ql.prototype.updateMetadata=function(rs){var ls=this;return Ol("updateMetadata",[Cs()],arguments),this.throwIfRoot_("updateMetadata"),this.authWrapper.getAuthToken().then(function(ws){var Ds,Os,Ks,Vs,ta,al,ol,el,ml=(Ds=ls.authWrapper,Os=ls.location,Ks=rs,Vs=ls.mappings(),ta=Xs(Os.fullServerUrl()),al=Cl(Ks,Vs),ol=Ds.maxOperationRetryTime(),(el=new Dl(ta,"PATCH",vA(Ds,Vs),ol)).headers={"Content-Type":"application/json; charset=utf-8"},el.body=al,el.errorHandler=xl(Os),el);return ls.authWrapper.makeRequest(ml,ws).getPromise()})},Ql.prototype.getDownloadURL=function(){var rs=this;return Ol("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.authWrapper.getAuthToken().then(function(ls){var ws,Ds,Os,Ks,Vs,ta,al=(ws=rs.authWrapper,Ds=rs.location,Os=rs.mappings(),Ks=Xs(Ds.fullServerUrl()),Vs=ws.maxOperationRetryTime(),(ta=new Dl(Ks,"GET",TA(ws,Os),Vs)).errorHandler=xl(Ds),ta);return rs.authWrapper.makeRequest(al,ls).getPromise().then(function(ol){if(ol===null)throw new Zo(es.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return ol})})},Ql.prototype.throwIfRoot_=function(rs){if(this.location.path==="")throw ls=rs,new Zo(es.INVALID_ROOT_OPERATION,"The operation '"+ls+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').");var ls},Ql);function Ql(rs,ls){this.authWrapper=rs,this.location=ls instanceof cl?ls:cl.makeFromUrl(ls)}var JA=(NA.prototype.getPromise=function(){return this.promise_},NA.prototype.cancel=function(rs){},NA);function NA(rs){this.promise_=Promise.reject(rs)}var Yl=(xA.prototype.addRequest=function(rs){var ls=this,ws=this.id;this.id++,this.map.set(ws,rs),rs.getPromise().then(function(){return ls.map.delete(ws)},function(){return ls.map.delete(ws)})},xA.prototype.clear=function(){this.map.forEach(function(rs){rs&&rs.cancel(!0)}),this.map.clear()},xA);function xA(){this.map=new Map,this.id=-9007199254740991}var xu=(Rl.extractBucket_=function(rs){var ls=rs.storageBucket||null;return ls==null?null:cl.makeFromBucketSpec(ls).bucket},Rl.prototype.getAuthToken=function(){var rs=this.authProvider_.getImmediate({optional:!0});return rs?rs.getToken().then(function(ls){return ls!==null?ls.accessToken:null},function(){return null}):Promise.resolve(null)},Rl.prototype.bucket=function(){if(this.deleted_)throw ss();return this.bucket_},Rl.prototype.service=function(){return this.service_},Rl.prototype.makeStorageReference=function(rs){return this.storageRefMaker_(this,rs)},Rl.prototype.makeRequest=function(rs,ls){if(this.deleted_)return new JA(ss());var ws=this.requestMaker_(rs,this.appId_,ls,this.pool_);return this.requestMap_.addRequest(ws),ws},Rl.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},Rl.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},Rl.prototype.setMaxUploadRetryTime=function(rs){this.maxUploadRetryTime_=rs},Rl.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},Rl.prototype.setMaxOperationRetryTime=function(rs){this.maxOperationRetryTime_=rs},Rl);function Rl(rs,ls,ws,Ds,Os,Ks){var Vs;if(this.bucket_=null,this.appId_=null,this.deleted_=!1,this.app_=rs,this.app_!==null){var ta=this.app_.options;qs(ta)&&(this.bucket_=Rl.extractBucket_(ta),this.appId_=(Vs=ta.appId)!==null&&Vs!==void 0?Vs:null)}this.authProvider_=ls,this.storageRefMaker_=ws,this.requestMaker_=Ds,this.pool_=Ks,this.service_=Os,this.maxOperationRetryTime_=12e4,this.maxUploadRetryTime_=6e5,this.requestMap_=new Yl}var eA=(Pl.prototype.start_=function(){var rs,ls,ws,Ds,Os,Ks,Vs,ta,al,ol=this;function el(Gl,nA){var mA,VA=ol.resolve_,sA=ol.reject_,LA=nA.xhr;if(nA.wasSuccessCode)try{var rA=ol.callback_(LA,LA.getResponseText());Gs(rA)?VA(rA):VA()}catch(KA){sA(KA)}else LA!==null?((mA=Jo()).setServerResponseProp(LA.getResponseText()),ol.errorCallback_?sA(ol.errorCallback_(LA,mA)):sA(mA)):nA.canceled?sA(mA=(ol.appDelete_?ss:Ko)()):sA(mA=new Zo(es.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}function ml(){return Vs===2}function yl(){for(var Gl=[],nA=0;nA<arguments.length;nA++)Gl[nA]=arguments[nA];ta||(ta=!0,ls.apply(null,Gl))}function Fl(Gl){Os=setTimeout(function(){Os=null,rs(Xl,ml())},Gl)}function Xl(Gl){for(var nA=[],mA=1;mA<arguments.length;mA++)nA[mA-1]=arguments[mA];ta||(Gl||ml()||Ks?yl.call.apply(yl,p([null,Gl],nA)):(Ds<64&&(Ds*=2),Fl(Vs===1?(Vs=2,0):1e3*(Ds+Math.random()))))}function tA(Gl){al||(al=!0,ta||(Os!==null?(Gl||(Vs=2),clearTimeout(Os),Fl(0)):Gl||(Vs=1)))}this.canceled_?el(0,new il(!1,null,!0)):this.backoffId_=(rs=function(Gl,nA){if(nA)Gl(!1,new il(!1,null,!0));else{var mA=ol.pool_.createXhrIo();ol.pendingXhr_=mA,ol.progressCallback_!==null&&mA.addUploadProgressListener(VA),mA.send(ol.url_,ol.method_,ol.body_,ol.headers_).then(function(sA){ol.progressCallback_!==null&&sA.removeUploadProgressListener(VA),ol.pendingXhr_=null;var LA=(sA=sA).getErrorCode()===ys.NO_ERROR,rA=sA.getStatus();if(LA&&!ol.isRetryStatusCode_(rA)){var KA=ol.successCodes_.indexOf(rA)!==-1;Gl(!0,new il(KA,sA))}else{var Bh=sA.getErrorCode()===ys.ABORT;Gl(!1,new il(!1,null,Bh))}})}function VA(sA){var LA=sA.loaded,rA=sA.lengthComputable?sA.total:-1;ol.progressCallback_!==null&&ol.progressCallback_(LA,rA)}},ls=el,ws=this.timeout_,Os=null,al=ta=Ks=!(Ds=1),Fl(Vs=0),setTimeout(function(){tA(Ks=!0)},ws),tA)},Pl.prototype.getPromise=function(){return this.promise_},Pl.prototype.cancel=function(rs){this.canceled_=!0,this.appDelete_=rs||!1,this.backoffId_!==null&&(0,this.backoffId_)(!1),this.pendingXhr_!==null&&this.pendingXhr_.abort()},Pl.prototype.isRetryStatusCode_=function(rs){var ls=500<=rs&&rs<600,ws=[408,429].indexOf(rs)!==-1,Ds=this.additionalRetryCodes_.indexOf(rs)!==-1;return ls||ws||Ds},Pl);function Pl(rs,ls,ws,Ds,Os,Ks,Vs,ta,al,ol,el){var ml=this;this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=rs,this.method_=ls,this.headers_=ws,this.body_=Ds,this.successCodes_=Os.slice(),this.additionalRetryCodes_=Ks.slice(),this.callback_=Vs,this.errorCallback_=ta,this.progressCallback_=ol,this.timeout_=al,this.pool_=el,this.promise_=new Promise(function(yl,Fl){ml.resolve_=yl,ml.reject_=Fl,ml.start_()})}var il=function(rs,ls,ws){this.wasSuccessCode=rs,this.xhr=ls,this.canceled=!!ws};function wl(rs,ls,ws,Ds){var Os,Ks,Vs,ta,al,ol,el=ll(rs.urlParams),ml=rs.url+el,yl=Object.assign({},rs.headers);return Os=yl,(Ks=ls)&&(Os["X-Firebase-GMPID"]=Ks),Vs=yl,(ta=ws)!==null&&0<ta.length&&(Vs.Authorization="Firebase "+ta),al=yl,ol=s!==void 0?s.SDK_VERSION:"AppManager",al["X-Firebase-Storage-Version"]="webjs/"+ol,new eA(ml,rs.method,yl,rs.body,rs.successCodes,rs.additionalRetryCodes,rs.handler,rs.errorHandler,rs.timeout,rs.progressCallback,Ds)}var lu=(vl.prototype.ref=function(rs){if(Ol("ref",[wA(function(ws){if(typeof ws!="string")throw"Path is not a string.";if(/^[A-Za-z]+:\/\//.test(ws))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),this.bucket_==null)throw new Error("No Storage Bucket defined in Firebase Options.");var ls=new EA(this.authWrapper_,this.bucket_);return rs!=null?ls.child(rs):ls},vl.prototype.refFromURL=function(rs){return Ol("refFromURL",[wA(function(ls){if(typeof ls!="string")throw"Path is not a string.";if(!/^[A-Za-z]+:\/\//.test(ls))throw"Expected full URL but got a child path, use ref instead.";try{cl.makeFromUrl(ls)}catch{throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new EA(this.authWrapper_,rs)},Object.defineProperty(vl.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),vl.prototype.setMaxUploadRetryTime=function(rs){Ol("setMaxUploadRetryTime",[Al()],arguments),this.authWrapper_.setMaxUploadRetryTime(rs)},vl.prototype.setMaxOperationRetryTime=function(rs){Ol("setMaxOperationRetryTime",[Al()],arguments),this.authWrapper_.setMaxOperationRetryTime(rs)},Object.defineProperty(vl.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(vl.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),vl);function vl(rs,ls,ws,Ds){if(this.bucket_=null,this.authWrapper_=new xu(rs,ls,function(Ks,Vs){return new EA(Ks,Vs)},wl,this,ws),this.app_=rs,Ds!=null)this.bucket_=cl.makeFromBucketSpec(Ds);else{var Os=this.authWrapper_.bucket();Os!=null&&(this.bucket_=new cl(Os,""))}this.internals_=new ru(this)}var ru=(Au.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),Promise.resolve()},Au);function Au(rs){this.service_=rs}var OA,rf;function Of(rs,ls){var ws=rs.getProvider("app").getImmediate(),Ds=rs.getProvider("auth-internal");return new lu(ws,Ds,new js,ls)}rf={TaskState:Qs,TaskEvent:Rs,StringFormat:us,Storage:lu,Reference:EA},(OA=s).INTERNAL.registerComponent(new jo("storage",Of,"PUBLIC").setServiceProps(rf).setMultipleInstances(!0)),OA.registerVersion("@firebase/storage","0.3.34")}).apply(this,arguments)}catch(c){throw console.error(c),new Error("Cannot instantiate firebase-storage.js - be sure to load firebase-app.js first.")}})})();index_cjsExports$2.initializeApp(firebaseConfig);const Realtime=index_cjsExports$2.database(),Firestore=index_cjsExports$2.firestore(),Auth$1=index_cjsExports$2.auth(),Storage=index_cjsExports$2.storage(),FieldValue=index_cjsExports$2.firestore.FieldValue,FieldPath=index_cjsExports$2.firestore.FieldPath,ServerValue=index_cjsExports$2.database.ServerValue;function backOut(l){return--l*l*((1.70158+1)*l+1.70158)+1}function cubicOut(l){const o=l-1;return o*o*o+1}function fade(l,{delay:o=0,duration:s=400,easing:c=identity}={}){const h=+getComputedStyle(l).opacity;return{delay:o,duration:s,easing:c,css:d=>`opacity: ${d*h}`}}function fly(l,{delay:o=0,duration:s=400,easing:c=cubicOut,x:h=0,y:d=0,opacity:p=0}={}){const Co=getComputedStyle(l),Bo=+Co.opacity,Lo=Co.transform==="none"?"":Co.transform,Uo=Bo*(1-p);return{delay:o,duration:s,easing:c,css:(Qo,Po)=>`
			transform: ${Lo} translate(${(1-Qo)*h}px, ${(1-Qo)*d}px);
			opacity: ${Bo-Uo*Po}`}}const Modal_svelte_svelte_type_style_lang="";function create_if_block$v(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po=l[0].closeButton&&create_if_block_1$l(l);const Mo=[l[2]];var Go=l[1];function $o(jo){let zo={};for(let Xo=0;Xo<Mo.length;Xo+=1)zo=assign(zo,Mo[Xo]);return{props:zo}}return Go&&(p=new Go($o())),{c(){o=element("div"),s=element("div"),c=element("div"),Po&&Po.c(),h=space(),d=element("div"),p&&create_component(p.$$.fragment),attr(d,"class","content svelte-fnsfcv"),attr(d,"style",l[11]),attr(c,"class","window svelte-fnsfcv"),attr(c,"style",l[12]),attr(s,"class","window-wrap svelte-fnsfcv"),attr(o,"class","bg svelte-fnsfcv"),attr(o,"style",l[13])},m(jo,zo){insert(jo,o,zo),append(o,s),append(s,c),Po&&Po.m(c,null),append(c,h),append(c,d),p&&mount_component(p,d,null),l[31](s),l[32](o),Lo=!0,Uo||(Qo=[listen(c,"introstart",function(){is_function(l[5])&&l[5].apply(this,arguments)}),listen(c,"outrostart",function(){is_function(l[6])&&l[6].apply(this,arguments)}),listen(c,"introend",function(){is_function(l[7])&&l[7].apply(this,arguments)}),listen(c,"outroend",function(){is_function(l[8])&&l[8].apply(this,arguments)}),listen(o,"click",l[16])],Uo=!0)},p(jo,zo){l=jo,l[0].closeButton?Po?Po.p(l,zo):(Po=create_if_block_1$l(l),Po.c(),Po.m(c,h)):Po&&(Po.d(1),Po=null);const Xo=zo[0]&4?get_spread_update(Mo,[get_spread_object(l[2])]):{};if(Go!==(Go=l[1])){if(p){group_outros();const Zo=p;transition_out(Zo.$$.fragment,1,0,()=>{destroy_component(Zo,1)}),check_outros()}Go?(p=new Go($o()),create_component(p.$$.fragment),transition_in(p.$$.fragment,1),mount_component(p,d,null)):p=null}else Go&&p.$set(Xo);(!Lo||zo[0]&2048)&&attr(d,"style",l[11]),(!Lo||zo[0]&4096)&&attr(c,"style",l[12]),(!Lo||zo[0]&8192)&&attr(o,"style",l[13])},i(jo){Lo||(p&&transition_in(p.$$.fragment,jo),add_render_callback(()=>{Co||(Co=create_bidirectional_transition(c,l[9],l[0].transitionWindowProps,!0)),Co.run(1)}),add_render_callback(()=>{Bo||(Bo=create_bidirectional_transition(o,l[10],l[0].transitionBgProps,!0)),Bo.run(1)}),Lo=!0)},o(jo){p&&transition_out(p.$$.fragment,jo),Co||(Co=create_bidirectional_transition(c,l[9],l[0].transitionWindowProps,!1)),Co.run(0),Bo||(Bo=create_bidirectional_transition(o,l[10],l[0].transitionBgProps,!1)),Bo.run(0),Lo=!1},d(jo){jo&&detach(o),Po&&Po.d(),p&&destroy_component(p),jo&&Co&&Co.end(),l[31](null),l[32](null),jo&&Bo&&Bo.end(),Uo=!1,run_all(Qo)}}}function create_if_block_1$l(l){let o,s,c;return{c(){o=element("button"),attr(o,"class","close svelte-fnsfcv")},m(h,d){insert(h,o,d),s||(c=listen(o,"click",l[14]),s=!0)},p:noop$2,d(h){h&&detach(o),s=!1,c()}}}function create_fragment$U(l){let o,s,c,h,d=l[1]&&create_if_block$v(l);const p=l[30].default,Co=create_slot(p,l,l[29],null);return{c(){d&&d.c(),o=space(),Co&&Co.c()},m(Bo,Lo){d&&d.m(Bo,Lo),insert(Bo,o,Lo),Co&&Co.m(Bo,Lo),s=!0,c||(h=listen(window,"keyup",l[15]),c=!0)},p(Bo,Lo){Bo[1]?d?(d.p(Bo,Lo),Lo[0]&2&&transition_in(d,1)):(d=create_if_block$v(Bo),d.c(),transition_in(d,1),d.m(o.parentNode,o)):d&&(group_outros(),transition_out(d,1,1,()=>{d=null}),check_outros()),Co&&Co.p&&(!s||Lo[0]&536870912)&&update_slot_base(Co,p,Bo,Bo[29],s?get_slot_changes(p,Bo[29],Lo,null):get_all_dirty_from_scope(Bo[29]),null)},i(Bo){s||(transition_in(d),transition_in(Co,Bo),s=!0)},o(Bo){transition_out(d),transition_out(Co,Bo),s=!1},d(Bo){d&&d.d(Bo),Bo&&detach(o),Co&&Co.d(Bo),c=!1,h()}}}function instance$R(l,o,s){let c,h,d,p,Co,{$$slots:Bo={},$$scope:Lo}=o,{key:Uo="simple-modal"}=o,{closeButton:Qo=!0}=o,{closeOnEsc:Po=!0}=o,{closeOnOuterClick:Mo=!0}=o,{styleBg:Go={top:0,left:0}}=o,{styleWindow:$o={}}=o,{styleContent:jo={}}=o,{setContext:zo=setContext}=o,{transitionBg:Xo=fade}=o,{transitionBgProps:Zo={duration:250}}=o,{transitionWindow:Wo=Xo}=o,{transitionWindowProps:es=Zo}=o;const is={closeButton:Qo,closeOnEsc:Po,closeOnOuterClick:Mo,styleBg:Go,styleWindow:$o,styleContent:jo,transitionBg:Xo,transitionBgProps:Zo,transitionWindow:Wo,transitionWindowProps:es};let Jo={...is},Ko=null,Yo=null,ts,ss;const cs=ps=>ps.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase(),as=ps=>Object.keys(ps).reduce((ks,xs)=>`${ks}; ${cs(xs)}: ${ps[xs]}`,""),us=()=>{};let gs=us,Is=us,_s=us,Hs=us;const ds=(ps,ks={},xs={},Ss={})=>{s(1,Ko=ps),s(2,Yo=ks),s(0,Jo={...is,...xs}),s(5,gs=Ss.onOpen||us),s(6,Is=Ss.onClose||us),s(7,_s=Ss.onOpened||us),s(8,Hs=Ss.onClosed||us)},hs=(ps={})=>{s(6,Is=ps.onClose||Is),s(8,Hs=ps.onClosed||Hs),s(1,Ko=null),s(2,Yo=null)},ys=ps=>{Jo.closeOnEsc&&Ko&&ps.key==="Escape"&&(ps.preventDefault(),hs())},ms=ps=>{Jo.closeOnOuterClick&&(ps.target===ts||ps.target===ss)&&(ps.preventDefault(),hs())};zo(Uo,{open:ds,close:hs});function Rs(ps){binding_callbacks[ps?"unshift":"push"](()=>{ss=ps,s(4,ss)})}function bs(ps){binding_callbacks[ps?"unshift":"push"](()=>{ts=ps,s(3,ts)})}return l.$$set=ps=>{"key"in ps&&s(17,Uo=ps.key),"closeButton"in ps&&s(18,Qo=ps.closeButton),"closeOnEsc"in ps&&s(19,Po=ps.closeOnEsc),"closeOnOuterClick"in ps&&s(20,Mo=ps.closeOnOuterClick),"styleBg"in ps&&s(21,Go=ps.styleBg),"styleWindow"in ps&&s(22,$o=ps.styleWindow),"styleContent"in ps&&s(23,jo=ps.styleContent),"setContext"in ps&&s(24,zo=ps.setContext),"transitionBg"in ps&&s(25,Xo=ps.transitionBg),"transitionBgProps"in ps&&s(26,Zo=ps.transitionBgProps),"transitionWindow"in ps&&s(27,Wo=ps.transitionWindow),"transitionWindowProps"in ps&&s(28,es=ps.transitionWindowProps),"$$scope"in ps&&s(29,Lo=ps.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&1&&s(13,c=as(Jo.styleBg)),l.$$.dirty[0]&1&&s(12,h=as(Jo.styleWindow)),l.$$.dirty[0]&1&&s(11,d=as(Jo.styleContent)),l.$$.dirty[0]&1&&s(10,p=Jo.transitionBg),l.$$.dirty[0]&1&&s(9,Co=Jo.transitionWindow)},[Jo,Ko,Yo,ts,ss,gs,Is,_s,Hs,Co,p,d,h,c,hs,ys,ms,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,Lo,Bo,Rs,bs]}class Modal extends SvelteComponent{constructor(o){super(),init(this,o,instance$R,create_fragment$U,safe_not_equal,{key:17,closeButton:18,closeOnEsc:19,closeOnOuterClick:20,styleBg:21,styleWindow:22,styleContent:23,setContext:24,transitionBg:25,transitionBgProps:26,transitionWindow:27,transitionWindowProps:28},null,[-1,-1])}}const loader_svelte_svelte_type_style_lang="";function create_fragment$T(l){let o;return{c(){o=element("div"),o.textContent="Loading...",attr(o,"class","loader svelte-1qq7015")},m(s,c){insert(s,o,c)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o)}}}class Loader$1 extends SvelteComponent{constructor(o){super(),init(this,o,null,create_fragment$T,safe_not_equal,{})}}const signUp_svelte_svelte_type_style_lang="";function create_else_block$o(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,Hs,ds,hs,ys,ms,Rs,bs,ps,ks,xs,Ss,Us,Ps,Qs,Js,qs,Gs,Zs,Es,fs,vs,Bs,Ls,Fs,zs,js,ma,Ws,va,ca,cl,Ms,$s,ga,Xs,ll,sl,nl,pl,El,cA,rl,Cl,Ul,Nl,Ll;return{c(){o=element("form"),s=element("div"),c=element("h4"),c.textContent="Your name",h=space(),d=element("div"),p=element("input"),Co=space(),Bo=element("label"),Bo.textContent="First name",Lo=space(),Uo=element("div"),Qo=element("input"),Po=space(),Mo=element("label"),Mo.textContent="Middle name/s (optional)",Go=space(),$o=element("div"),jo=element("input"),zo=space(),Xo=element("label"),Xo.textContent="Last name",Zo=space(),Wo=element("div"),es=element("div"),is=element("h4"),is.textContent="Your institution",Jo=space(),Ko=element("div"),Yo=element("input"),ts=space(),ss=element("label"),ss.textContent="e.g. 'Bolus Herbarium' or 'SANBI'",cs=space(),as=element("div"),us=element("h4"),us.textContent="Accronym",gs=space(),Is=element("div"),_s=element("input"),Hs=space(),ds=element("label"),ds.textContent="e.g. 'BOL' or 'SANBI'",hs=space(),ys=element("p"),ms=text("Formatted name (for dwc:georefBy): "),Rs=element("span"),bs=text(l[12]),ps=space(),ks=element("input"),xs=element("span"),xs.textContent="Do NOT include my institution acronym",Ss=space(),Us=element("div"),Ps=element("h4"),Qs=text("Your ORCID ID"),Js=element("span"),Js.textContent="open_in_new",qs=space(),Gs=element("div"),Zs=element("input"),Es=space(),fs=element("label"),fs.textContent="e.g. https://orcid.org/0000-0001-2345-6789",vs=space(),Bs=element("div"),Ls=element("h4"),Ls.textContent="Email",Fs=space(),zs=element("div"),js=element("input"),ma=space(),Ws=element("label"),Ws.textContent="Example: [yourname]@[yourinstitution].org",va=space(),ca=element("div"),cl=element("h4"),cl.textContent="Password",Ms=space(),$s=element("div"),ga=element("div"),Xs=element("input"),ll=space(),sl=element("label"),sl.textContent="Password (min. 8 chars with numbers and special chars)",nl=space(),pl=element("div"),El=element("input"),cA=space(),rl=element("label"),rl.textContent="Confirm password",Cl=space(),Ul=element("button"),Ul.textContent="Register",attr(c,"class","svelte-gxfvsa"),attr(p,"type","text"),attr(p,"id","first"),attr(p,"class","svelte-gxfvsa"),toggle_class(p,"warning",l[18]),attr(Bo,"for","first"),attr(Bo,"class","svelte-gxfvsa"),attr(d,"class","labelinputinline svelte-gxfvsa"),attr(Qo,"type","text"),attr(Qo,"id","middle"),attr(Mo,"for","middle"),attr(Mo,"class","svelte-gxfvsa"),attr(Uo,"class","labelinputinline svelte-gxfvsa"),attr(jo,"type","text"),attr(jo,"id","last"),attr(jo,"class","svelte-gxfvsa"),toggle_class(jo,"warning",l[17]),attr(Xo,"for","last"),attr(Xo,"class","svelte-gxfvsa"),attr($o,"class","labelinputinline svelte-gxfvsa"),attr(s,"class","formsection svelte-gxfvsa"),attr(is,"class","svelte-gxfvsa"),set_style(Yo,"width","400px"),attr(Yo,"type","text"),attr(Yo,"id","institution"),attr(ss,"for","institution"),attr(ss,"class","svelte-gxfvsa"),attr(Ko,"class","labelinputinline svelte-gxfvsa"),attr(us,"class","svelte-gxfvsa"),attr(_s,"type","text"),attr(_s,"id","instAbbrev"),attr(_s,"placeholder",l[8]),attr(ds,"for","instAbbrev"),attr(ds,"class","svelte-gxfvsa"),attr(Is,"class","labelinputinline svelte-gxfvsa"),attr(Wo,"class","formsection flex svelte-gxfvsa"),set_style(Rs,"text-decoration","underline"),attr(ks,"type","checkbox"),attr(Js,"class","material-icons md-18 iconbutton svelte-gxfvsa"),attr(Js,"title","Go to ORCID"),attr(Ps,"class","svelte-gxfvsa"),set_style(Zs,"width","400px"),attr(Zs,"type","text"),attr(Zs,"id","orcid"),attr(Zs,"class","svelte-gxfvsa"),toggle_class(Zs,"warning",l[16]),attr(fs,"for","orcid"),attr(fs,"class","svelte-gxfvsa"),attr(Gs,"class","labelinputinline svelte-gxfvsa"),attr(Us,"class","formsection svelte-gxfvsa"),attr(Ls,"class","svelte-gxfvsa"),set_style(js,"width","400px"),attr(js,"type","email"),attr(js,"id","email"),attr(js,"placeholder","ex: [yourname]@[yourinstitution].org"),attr(js,"class","svelte-gxfvsa"),toggle_class(js,"warning",l[15]),attr(Ws,"for","email"),attr(Ws,"class","svelte-gxfvsa"),attr(zs,"class","labelinputinline svelte-gxfvsa"),attr(Bs,"class","formsection svelte-gxfvsa"),attr(cl,"class","svelte-gxfvsa"),set_style(Xs,"width","100%"),attr(Xs,"type","password"),attr(Xs,"name","pass"),attr(Xs,"id","pass"),attr(Xs,"class","svelte-gxfvsa"),toggle_class(Xs,"warning",l[14]),attr(sl,"for","pass"),attr(sl,"class","svelte-gxfvsa"),attr(ga,"class","labelinputinline svelte-gxfvsa"),set_style(ga,"width","200px"),set_style(El,"width","100%"),attr(El,"type","password"),attr(El,"name","confirmpass"),attr(El,"id","confirmpass"),attr(El,"class","svelte-gxfvsa"),toggle_class(El,"warning",l[13]),attr(rl,"for","confirmpass"),attr(rl,"class","svelte-gxfvsa"),attr(pl,"class","labelinputinline svelte-gxfvsa"),set_style(pl,"width","200px"),set_style(pl,"margin-left","4px"),attr($s,"class","flex svelte-gxfvsa"),attr(ca,"class","formsection svelte-gxfvsa"),set_style(Ul,"width","200px"),set_style(Ul,"text-align","center"),attr(Ul,"class","svelte-gxfvsa"),attr(o,"class","svelte-gxfvsa")},m(hl,gl){insert(hl,o,gl),append(o,s),append(s,c),append(s,h),append(s,d),append(d,p),set_input_value(p,l[0]),append(d,Co),append(d,Bo),append(s,Lo),append(s,Uo),append(Uo,Qo),set_input_value(Qo,l[1]),append(Uo,Po),append(Uo,Mo),append(s,Go),append(s,$o),append($o,jo),set_input_value(jo,l[2]),append($o,zo),append($o,Xo),append(o,Zo),append(o,Wo),append(Wo,es),append(es,is),append(es,Jo),append(es,Ko),append(Ko,Yo),set_input_value(Yo,l[3]),append(Ko,ts),append(Ko,ss),append(Wo,cs),append(Wo,as),append(as,us),append(as,gs),append(as,Is),append(Is,_s),set_input_value(_s,l[9]),append(Is,Hs),append(Is,ds),append(o,hs),append(o,ys),append(ys,ms),append(ys,Rs),append(Rs,bs),append(o,ps),append(o,ks),ks.checked=l[10],append(o,xs),append(o,Ss),append(o,Us),append(Us,Ps),append(Ps,Qs),append(Ps,Js),append(Us,qs),append(Us,Gs),append(Gs,Zs),set_input_value(Zs,l[4]),append(Gs,Es),append(Gs,fs),append(o,vs),append(o,Bs),append(Bs,Ls),append(Bs,Fs),append(Bs,zs),append(zs,js),set_input_value(js,l[5]),append(zs,ma),append(zs,Ws),append(o,va),append(o,ca),append(ca,cl),append(ca,Ms),append(ca,$s),append($s,ga),append(ga,Xs),set_input_value(Xs,l[6]),append(ga,ll),append(ga,sl),append($s,nl),append($s,pl),append(pl,El),set_input_value(El,l[7]),append(pl,cA),append(pl,rl),append(o,Cl),append(o,Ul),Nl||(Ll=[listen(p,"input",l[21]),listen(Qo,"input",l[22]),listen(jo,"input",l[23]),listen(Yo,"input",l[24]),listen(_s,"input",l[25]),listen(ks,"change",l[26]),listen(Js,"click",l[27]),listen(Zs,"input",l[28]),listen(js,"input",l[29]),listen(Xs,"input",l[30]),listen(El,"input",l[31]),listen(Ul,"click",prevent_default(l[19]))],Nl=!0)},p(hl,gl){gl[0]&1&&p.value!==hl[0]&&set_input_value(p,hl[0]),gl[0]&262144&&toggle_class(p,"warning",hl[18]),gl[0]&2&&Qo.value!==hl[1]&&set_input_value(Qo,hl[1]),gl[0]&4&&jo.value!==hl[2]&&set_input_value(jo,hl[2]),gl[0]&131072&&toggle_class(jo,"warning",hl[17]),gl[0]&8&&Yo.value!==hl[3]&&set_input_value(Yo,hl[3]),gl[0]&256&&attr(_s,"placeholder",hl[8]),gl[0]&512&&_s.value!==hl[9]&&set_input_value(_s,hl[9]),gl[0]&4096&&set_data(bs,hl[12]),gl[0]&1024&&(ks.checked=hl[10]),gl[0]&16&&Zs.value!==hl[4]&&set_input_value(Zs,hl[4]),gl[0]&65536&&toggle_class(Zs,"warning",hl[16]),gl[0]&32&&js.value!==hl[5]&&set_input_value(js,hl[5]),gl[0]&32768&&toggle_class(js,"warning",hl[15]),gl[0]&64&&Xs.value!==hl[6]&&set_input_value(Xs,hl[6]),gl[0]&16384&&toggle_class(Xs,"warning",hl[14]),gl[0]&128&&El.value!==hl[7]&&set_input_value(El,hl[7]),gl[0]&8192&&toggle_class(El,"warning",hl[13])},i:noop$2,o:noop$2,d(hl){hl&&detach(o),Nl=!1,run_all(Ll)}}}function create_if_block$u(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_fragment$S(l){let o,s,c,h,d,p;const Co=[create_if_block$u,create_else_block$o],Bo=[];function Lo(Uo,Qo){return Uo[11]?0:1}return h=Lo(l),d=Bo[h]=Co[h](l),{c(){o=element("div"),s=element("h3"),s.textContent="Registration",c=space(),d.c(),attr(o,"class","container svelte-gxfvsa")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),append(o,c),Bo[h].m(o,null),p=!0},p(Uo,Qo){let Po=h;h=Lo(Uo),h===Po?Bo[h].p(Uo,Qo):(group_outros(),transition_out(Bo[Po],1,1,()=>{Bo[Po]=null}),check_outros(),d=Bo[h],d?d.p(Uo,Qo):(d=Bo[h]=Co[h](Uo),d.c()),transition_in(d,1),d.m(o,null))},i(Uo){p||(transition_in(d),p=!0)},o(Uo){transition_out(d),p=!1},d(Uo){Uo&&detach(o),Bo[h].d()}}}let orcidRE=/^https:\/\/orcid.org\/\d{4}-\d{4}-\d{4}-\d{3}[0-9X]{1}$/,pwdRE$2=/^(?=.*\d)(?=.*[a-zA-Z])(?=.*[!@#$%^&*])[0-9a-zA-Z!@#$%^&*]{8,}$/;function instance$Q($$self,$$props,$$invalidate){let firstWarning,lastWarning,orcidWarning,emailWarning,pwdWarning,confPwdWarning;const dispatch=createEventDispatcher();let busy=!1,first,middle,last,inst,orcid,email,pwd,confPwd,instAbbrev="",userInstAbbrev,noInstAbbrev=!1,formattedName="",submitClicked=!1,warnings=["firstWarning","lastWarning","orcidWarning","emailWarning","pwdWarning","confPwdWarning"];const updateFormattedName=l=>{if(last&&last.trim()){let o=[];if(first&&first.trim()&&o.push(first[0].toUpperCase()),first&&first.trim()&&middle&&middle.trim()){let s=middle.split(" ");s=s.filter(c=>c&&c.trim());for(let c of s)o.push(c[0].toUpperCase())}o.length?$$invalidate(12,formattedName=`${last.trim()}, ${o.join(".")}.`):$$invalidate(12,formattedName=last.trim()),noInstAbbrev||(userInstAbbrev&&userInstAbbrev.trim()?$$invalidate(12,formattedName+=` (${userInstAbbrev})`):instAbbrev&&instAbbrev.trim()&&$$invalidate(12,formattedName+=` (${instAbbrev})`))}},getInstitutionAbbrev=l=>{if(inst&&inst.trim())if(/^[A-Z]+$/.test(inst))$$invalidate(8,instAbbrev=inst);else{let o=inst.split(" ");o=o.filter(s=>s&&s.trim()&&s.trim().toLowerCase()!="of"),$$invalidate(8,instAbbrev=o.reduce((s,c)=>s+c[0].toUpperCase(),""))}else $$invalidate(8,instAbbrev="")},handleRegisterClick=_=>{$$invalidate(20,submitClicked=!0),$$invalidate(11,busy=!0),setTimeout(_=>{for(let warning of warnings)if(eval(warning)){$$invalidate(11,busy=!1),alert("required form fields incomplete");return}let searchEmail=email.replace(/[@\.\s]+/g,"").toLowerCase(),profile={firstName:first,middleName:middle||null,lastName:last,formattedName,institution:inst||null,orcid:orcid||null,email,searchEmail};dispatch("user-sign-in",profile),Auth$1.createUserWithEmailAndPassword(email,pwd).catch(l=>{switch(l.code){case"auth/email-already-in-use":alert(`Email address ${email} already in use. Please go to sign or register with another email address.`),$$invalidate(11,busy=!1);break;case"auth/invalid-email":alert(`Email address ${email} is invalid.`),$$invalidate(11,busy=!1);break;case"auth/operation-not-allowed":alert("Error during sign up."),$$invalidate(11,busy=!1);break;case"auth/weak-password":alert("Password is not strong enough. Add additional characters including special characters and numbers."),$$invalidate(11,busy=!1);break;default:alert(l.message),$$invalidate(11,busy=!1);break}})},100)};function input0_input_handler(){first=this.value,$$invalidate(0,first)}function input1_input_handler(){middle=this.value,$$invalidate(1,middle)}function input2_input_handler(){last=this.value,$$invalidate(2,last)}function input3_input_handler(){inst=this.value,$$invalidate(3,inst)}function input4_input_handler(){userInstAbbrev=this.value,$$invalidate(9,userInstAbbrev)}function input5_change_handler(){noInstAbbrev=this.checked,$$invalidate(10,noInstAbbrev)}const click_handler=l=>window.open("https://orcid.org/");function input6_input_handler(){orcid=this.value,$$invalidate(4,orcid)}function input7_input_handler(){email=this.value,$$invalidate(5,email)}function input8_input_handler(){pwd=this.value,$$invalidate(6,pwd)}function input9_input_handler(){confPwd=this.value,$$invalidate(7,confPwd)}return $$self.$$.update=()=>{$$self.$$.dirty[0]&1048577&&$$invalidate(18,firstWarning=submitClicked&&(!first||!first.trim())),$$self.$$.dirty[0]&1048580&&$$invalidate(17,lastWarning=submitClicked&&(!last||!last.trim())),$$self.$$.dirty[0]&16&&$$invalidate(16,orcidWarning=orcid&&orcid.trim()&&!orcidRE.test(orcid)),$$self.$$.dirty[0]&1048608&&$$invalidate(15,emailWarning=submitClicked&&(!email||!email.trim()||!/\S+@\S+\.\S+/.test(email))),$$self.$$.dirty[0]&1048640&&$$invalidate(14,pwdWarning=Boolean(submitClicked&&!pwd||pwd&&pwd.trim()&&!pwdRE$2.test(pwd))),$$self.$$.dirty[0]&192&&$$invalidate(13,confPwdWarning=Boolean(pwd&&pwd.trim()&&pwd!=confPwd)),$$self.$$.dirty[0]&8&&getInstitutionAbbrev(),$$self.$$.dirty[0]&1799&&(first||middle||last||instAbbrev||userInstAbbrev||noInstAbbrev)&&updateFormattedName()},[first,middle,last,inst,orcid,email,pwd,confPwd,instAbbrev,userInstAbbrev,noInstAbbrev,busy,formattedName,confPwdWarning,pwdWarning,emailWarning,orcidWarning,lastWarning,firstWarning,handleRegisterClick,submitClicked,input0_input_handler,input1_input_handler,input2_input_handler,input3_input_handler,input4_input_handler,input5_change_handler,click_handler,input6_input_handler,input7_input_handler,input8_input_handler,input9_input_handler]}class SignUp extends SvelteComponent{constructor(o){super(),init(this,o,instance$Q,create_fragment$S,safe_not_equal,{},null,[-1,-1])}}const signIn_svelte_svelte_type_style_lang="";function create_else_block$n(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko;return{c(){o=element("form"),s=element("div"),c=element("h4"),c.textContent="Email",h=space(),d=element("div"),p=element("input"),Co=space(),Bo=element("label"),Bo.textContent="Example: [yourname]@[yourinstitution].org",Lo=space(),Uo=element("div"),Qo=element("h4"),Qo.textContent="Password",Po=space(),Mo=element("div"),Go=element("input"),$o=space(),jo=element("label"),jo.textContent="Password (min. 8 chars with numbers and special chars)",zo=space(),Xo=element("div"),Zo=element("span"),Zo.textContent="Forgot password?",Wo=space(),es=element("div"),is=element("button"),is.textContent="Sign in",attr(c,"class","svelte-10wu0ah"),set_style(p,"width","400px"),attr(p,"type","email"),attr(p,"id","email"),attr(p,"class","svelte-10wu0ah"),toggle_class(p,"warning",l[4]),attr(Bo,"for","email"),attr(Bo,"class","svelte-10wu0ah"),attr(d,"class","labelinputinline svelte-10wu0ah"),attr(s,"class","formsection svelte-10wu0ah"),attr(Qo,"class","svelte-10wu0ah"),set_style(Go,"width","400px"),attr(Go,"type","password"),attr(Go,"name","pass"),attr(Go,"id","pass"),attr(Go,"class","svelte-10wu0ah"),toggle_class(Go,"warning",l[3]),attr(jo,"for","pass"),attr(jo,"class","svelte-10wu0ah"),attr(Mo,"class","labelinputinline svelte-10wu0ah"),set_style(Mo,"width","200px"),attr(Uo,"class","formsection svelte-10wu0ah"),attr(Zo,"class","pwdlink svelte-10wu0ah"),attr(Xo,"class","flex svelte-10wu0ah"),set_style(is,"margin","auto"),set_style(is,"width","200px"),set_style(is,"text-align","center"),attr(is,"class","svelte-10wu0ah"),set_style(es,"text-align","center"),attr(o,"class","svelte-10wu0ah")},m(Yo,ts){insert(Yo,o,ts),append(o,s),append(s,c),append(s,h),append(s,d),append(d,p),set_input_value(p,l[0]),append(d,Co),append(d,Bo),append(o,Lo),append(o,Uo),append(Uo,Qo),append(Uo,Po),append(Uo,Mo),append(Mo,Go),set_input_value(Go,l[1]),append(Mo,$o),append(Mo,jo),append(o,zo),append(o,Xo),append(Xo,Zo),append(o,Wo),append(o,es),append(es,is),Jo||(Ko=[listen(p,"input",l[7]),listen(Go,"input",l[8]),listen(Zo,"click",l[9]),listen(is,"click",prevent_default(l[6]))],Jo=!0)},p(Yo,ts){ts&1&&p.value!==Yo[0]&&set_input_value(p,Yo[0]),ts&16&&toggle_class(p,"warning",Yo[4]),ts&2&&Go.value!==Yo[1]&&set_input_value(Go,Yo[1]),ts&8&&toggle_class(Go,"warning",Yo[3])},i:noop$2,o:noop$2,d(Yo){Yo&&detach(o),Jo=!1,run_all(Ko)}}}function create_if_block_1$k(l){let o;return{c(){o=element("p"),o.textContent="There appears to be an issue, you are already signed in"},m(s,c){insert(s,o,c)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o)}}}function create_if_block$t(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_fragment$R(l){let o,s,c,h,d,p;const Co=[create_if_block$t,create_if_block_1$k,create_else_block$n],Bo=[];function Lo(Uo,Qo){return Uo[2]?0:Auth$1.currentUser?1:2}return h=Lo(l),d=Bo[h]=Co[h](l),{c(){o=element("div"),s=element("h3"),s.textContent="Sign in",c=space(),d.c(),attr(o,"class","container svelte-10wu0ah")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),append(o,c),Bo[h].m(o,null),p=!0},p(Uo,[Qo]){let Po=h;h=Lo(Uo),h===Po?Bo[h].p(Uo,Qo):(group_outros(),transition_out(Bo[Po],1,1,()=>{Bo[Po]=null}),check_outros(),d=Bo[h],d?d.p(Uo,Qo):(d=Bo[h]=Co[h](Uo),d.c()),transition_in(d,1),d.m(o,null))},i(Uo){p||(transition_in(d),p=!0)},o(Uo){transition_out(d),p=!1},d(Uo){Uo&&detach(o),Bo[h].d()}}}let submitClicked=!1,pwdRE$1=/^(?=.*\d)(?=.*[a-zA-Z])(?=.*[!@#$%^&*])[0-9a-zA-Z!@#$%^&*]{8,}$/;function instance$P(l,o,s){let c,h;const d=createEventDispatcher();let p=!1,Co,Bo;const Lo=Mo=>{if(c||h){alert("Please complete the necessary sign in details before attempting to sign in");return}s(2,p=!0),Auth$1.signInWithEmailAndPassword(Co,Bo).catch(Go=>{switch(Go.code){case"auth/invalid-email":alert(`Email address ${Co} is invalid, please check the address entered`),s(2,p=!1);break;case"auth/user-disabled":alert(`The profile for ${Co} have been disabled. Please contact the NSCF for details.`),s(2,p=!1);break;case"auth/user-not-found":alert(`We could not find a profile for ${Co}. Please check your email or register if you don't have an account.`),s(2,p=!1);break;case"auth/wrong-password":alert(`The password provided does not match the account for ${Co}. Please check the password entered.`),s(2,p=!1);break;default:alert(Go.message),s(2,p=!1);break}})};function Uo(){Co=this.value,s(0,Co)}function Qo(){Bo=this.value,s(1,Bo)}const Po=Mo=>d("to-forgot-pwd");return l.$$.update=()=>{l.$$.dirty&1&&s(4,c=submitClicked),l.$$.dirty&2&&s(3,h=Boolean(Bo&&Bo.trim()&&!pwdRE$1.test(Bo)))},[Co,Bo,p,h,c,d,Lo,Uo,Qo,Po]}class SignIn extends SvelteComponent{constructor(o){super(),init(this,o,instance$P,create_fragment$R,safe_not_equal,{})}}const signInForgotPwd_svelte_svelte_type_style_lang="";function create_else_block$m(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo;return{c(){o=element("form"),s=element("div"),c=element("h4"),c.textContent="Email",h=space(),d=element("div"),p=element("input"),Co=space(),Bo=element("label"),Bo.textContent="Example: [yourname]@[yourinstitution].org",Lo=space(),Uo=element("div"),Qo=element("button"),Qo.textContent="Send password reset code",attr(c,"class","svelte-od3es0"),set_style(p,"width","400px"),attr(p,"type","email"),attr(p,"id","email"),attr(p,"class","svelte-od3es0"),toggle_class(p,"warning",l[2]),attr(Bo,"for","email"),attr(Bo,"class","svelte-od3es0"),attr(d,"class","labelinputinline svelte-od3es0"),attr(s,"class","formsection svelte-od3es0"),set_style(Qo,"margin","auto"),set_style(Qo,"width","200px"),set_style(Qo,"text-align","center"),attr(Qo,"class","svelte-od3es0"),set_style(Uo,"text-align","center"),attr(o,"class","svelte-od3es0")},m(Go,$o){insert(Go,o,$o),append(o,s),append(s,c),append(s,h),append(s,d),append(d,p),set_input_value(p,l[0]),append(d,Co),append(d,Bo),append(o,Lo),append(o,Uo),append(Uo,Qo),Po||(Mo=[listen(p,"input",l[6]),listen(Qo,"click",prevent_default(l[3]))],Po=!0)},p(Go,$o){$o&1&&p.value!==Go[0]&&set_input_value(p,Go[0]),$o&4&&toggle_class(p,"warning",Go[2])},i:noop$2,o:noop$2,d(Go){Go&&detach(o),Po=!1,run_all(Mo)}}}function create_if_block$s(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_fragment$Q(l){let o,s,c,h,d,p;const Co=[create_if_block$s,create_else_block$m],Bo=[];function Lo(Uo,Qo){return Uo[1]?0:1}return h=Lo(l),d=Bo[h]=Co[h](l),{c(){o=element("div"),s=element("h3"),s.textContent="Forgot password",c=space(),d.c(),attr(o,"class","container svelte-od3es0")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),append(o,c),Bo[h].m(o,null),p=!0},p(Uo,[Qo]){let Po=h;h=Lo(Uo),h===Po?Bo[h].p(Uo,Qo):(group_outros(),transition_out(Bo[Po],1,1,()=>{Bo[Po]=null}),check_outros(),d=Bo[h],d?d.p(Uo,Qo):(d=Bo[h]=Co[h](Uo),d.c()),transition_in(d,1),d.m(o,null))},i(Uo){p||(transition_in(d),p=!0)},o(Uo){transition_out(d),p=!1},d(Uo){Uo&&detach(o),Bo[h].d()}}}function instance$O(l,o,s){let c;createEventDispatcher();let{Auth:h}=o,d=!1,p=!1,Co;const Bo=Uo=>{s(5,d=!0),s(1,p=!0),setTimeout(Qo=>{if(c){alert("Please enter your email to send password change link");return}h.sendPasswordResetEmail(Co).then(Po=>{console.log("password reset mail sent")}).catch(Po=>{switch(Po.code){case"auth/invalid-email":alert("The email provided is not valid, please try again."),s(1,p=!1);break;case"auth/user-not-found":alert(`No user account could be found for ${Co}. Please check the email provided or register a new account`),s(1,p=!1);break;default:alert(Po.message),s(1,p=!1);break}})},100)};function Lo(){Co=this.value,s(0,Co)}return l.$$set=Uo=>{"Auth"in Uo&&s(4,h=Uo.Auth)},l.$$.update=()=>{l.$$.dirty&33&&s(2,c=d&&(!Co||!Co.trim()||!/\S+@\S+\.\S+/.test(Co)))},[Co,p,c,Bo,h,d,Lo]}class SignInForgotPwd extends SvelteComponent{constructor(o){super(),init(this,o,instance$O,create_fragment$Q,safe_not_equal,{Auth:4})}}const signInPwdReset_svelte_svelte_type_style_lang="";function create_else_block$l(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss;return{c(){o=element("form"),s=element("div"),c=element("h4"),c.textContent="Code",h=space(),d=element("div"),p=element("p"),Co=text(l[0]),Bo=space(),Lo=element("label"),Lo.textContent="Password reset code sent by email",Uo=space(),Qo=element("div"),Po=element("h4"),Po.textContent="New password",Mo=space(),Go=element("div"),$o=element("div"),jo=element("input"),zo=space(),Xo=element("label"),Xo.textContent="Password (min. 8 chars with numbers and special chars)",Zo=space(),Wo=element("div"),es=element("input"),is=space(),Jo=element("label"),Jo.textContent="Confirm password",Ko=space(),Yo=element("button"),Yo.textContent="Reset Password",attr(c,"class","svelte-24b91q"),set_style(p,"width","400"),set_style(p,"overflow-wrap","break-word"),set_style(p,"margin","0"),attr(Lo,"for","code"),attr(Lo,"class","svelte-24b91q"),attr(d,"class","labelinputinline svelte-24b91q"),attr(s,"class","formsection svelte-24b91q"),attr(Po,"class","svelte-24b91q"),set_style(jo,"width","100%"),attr(jo,"type","password"),attr(jo,"name","pass"),attr(jo,"id","pass"),attr(jo,"class","svelte-24b91q"),toggle_class(jo,"warning",l[5]),attr(Xo,"for","pass"),attr(Xo,"class","svelte-24b91q"),attr($o,"class","labelinputinline svelte-24b91q"),set_style($o,"width","200px"),set_style(es,"width","100%"),attr(es,"type","password"),attr(es,"name","confirmpass"),attr(es,"id","confirmpass"),attr(es,"class","svelte-24b91q"),toggle_class(es,"warning",l[4]),attr(Jo,"for","confirmpass"),attr(Jo,"class","svelte-24b91q"),attr(Wo,"class","labelinputinline svelte-24b91q"),set_style(Wo,"width","200px"),set_style(Wo,"margin-left","4px"),attr(Go,"class","flex svelte-24b91q"),attr(Qo,"class","formsection svelte-24b91q"),set_style(Yo,"width","200px"),set_style(Yo,"text-align","center"),attr(Yo,"class","svelte-24b91q"),attr(o,"class","svelte-24b91q")},m(cs,as){insert(cs,o,as),append(o,s),append(s,c),append(s,h),append(s,d),append(d,p),append(p,Co),append(d,Bo),append(d,Lo),append(o,Uo),append(o,Qo),append(Qo,Po),append(Qo,Mo),append(Qo,Go),append(Go,$o),append($o,jo),set_input_value(jo,l[1]),append($o,zo),append($o,Xo),append(Go,Zo),append(Go,Wo),append(Wo,es),set_input_value(es,l[2]),append(Wo,is),append(Wo,Jo),append(o,Ko),append(o,Yo),ts||(ss=[listen(jo,"input",l[10]),listen(es,"input",l[11]),listen(Yo,"click",prevent_default(l[6]))],ts=!0)},p(cs,as){as&1&&set_data(Co,cs[0]),as&2&&jo.value!==cs[1]&&set_input_value(jo,cs[1]),as&32&&toggle_class(jo,"warning",cs[5]),as&4&&es.value!==cs[2]&&set_input_value(es,cs[2]),as&16&&toggle_class(es,"warning",cs[4])},i:noop$2,o:noop$2,d(cs){cs&&detach(o),ts=!1,run_all(ss)}}}function create_if_block_1$j(l){let o;return{c(){o=element("p"),o.textContent="A password reset link has been sent to your email. Please follow that link to reset your password.",set_style(o,"width","400px")},m(s,c){insert(s,o,c)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o)}}}function create_if_block$r(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_fragment$P(l){let o,s,c,h,d,p;const Co=[create_if_block$r,create_if_block_1$j,create_else_block$l],Bo=[];function Lo(Uo,Qo){return Uo[3]?0:2}return h=Lo(l),d=Bo[h]=Co[h](l),{c(){o=element("div"),s=element("h3"),s.textContent="Reset password",c=space(),d.c(),attr(o,"class","container svelte-24b91q")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),append(o,c),Bo[h].m(o,null),p=!0},p(Uo,[Qo]){let Po=h;h=Lo(Uo),h===Po?Bo[h].p(Uo,Qo):(group_outros(),transition_out(Bo[Po],1,1,()=>{Bo[Po]=null}),check_outros(),d=Bo[h],d?d.p(Uo,Qo):(d=Bo[h]=Co[h](Uo),d.c()),transition_in(d,1),d.m(o,null))},i(Uo){p||(transition_in(d),p=!0)},o(Uo){transition_out(d),p=!1},d(Uo){Uo&&detach(o),Bo[h].d()}}}let pwdRE=/^(?=.*\d)(?=.*[a-zA-Z])(?=.*[!@#$%^&*])[0-9a-zA-Z!@#$%^&*]{8,}$/;function instance$N(l,o,s){let c,h;const d=createEventDispatcher();let{Auth:p}=o,{email:Co}=o,{code:Bo}=o,Lo,Uo,Qo=!1,Po=!1;const Mo=jo=>{s(9,Qo=!0),s(3,Po=!0),setTimeout(zo=>{if(c||h){s(3,Po=!1),alert("required form fields incomplete");return}p.confirmPasswordReset(Bo,Lo).then(Xo=>{s(3,Po=!1)}).catch(Xo=>{switch(Xo.code){case"auth/expired-action-code":alert("The code provided has expired. Please return to the sign in form and select Forgot Password again."),d("to-sign-in");break;case"auth/invalid-action-code":alert("The reset code provided is not valid. Please check the code and try again."),s(3,Po=!1);break;case"auth/user-disabled":alert(`The account for user ${Co} has been disabled. Please contact the NSCF for further assistance.`),s(3,Po=!1);break;case"auth/user-not-found":alert(`No account could be found for ${Co}. Please contact the NSCF for further assistance`),s(3,Po=!1);break;case"auth/weak-password":alert("Password is weak. Add additional characters including special characters and numbers and try again."),s(3,Po=!1);break;default:alert(Xo.message),s(3,Po=!1);break}})},100)};function Go(){Lo=this.value,s(1,Lo)}function $o(){Uo=this.value,s(2,Uo)}return l.$$set=jo=>{"Auth"in jo&&s(7,p=jo.Auth),"email"in jo&&s(8,Co=jo.email),"code"in jo&&s(0,Bo=jo.code)},l.$$.update=()=>{l.$$.dirty&514&&s(5,c=Boolean(Qo&&!Lo||Lo&&Lo.trim()&&!pwdRE.test(Lo))),l.$$.dirty&6&&s(4,h=Boolean(Lo&&Lo.trim()&&Lo!=Uo))},[Bo,Lo,Uo,Po,h,c,Mo,p,Co,Qo,Go,$o]}class SignInPwdReset extends SvelteComponent{constructor(o){super(),init(this,o,instance$N,create_fragment$P,safe_not_equal,{Auth:7,email:8,code:0})}}const About_svelte_svelte_type_style_lang="";function create_fragment$O(l){let o;return{c(){o=element("div"),o.innerHTML=`<div class="content svelte-63izc2"><h3>About the NSCF Georeferencing Tool</h3> 
    <p>The NSCF georeferencing tool is designed to aid the process of producing high quality georeferences 
      for museum and herbarium specimen records in a quick, efficient and enjoyable way. It makes georeferences 
      reusable so that when a specimen locality has been georeferenced that georeference can be applied to
      another specimen from the same locality, even if the locality is spelled or formatted differently. 
      The tool also facilitates teamwork for georeferencing a set of specimen records, and enforces 
      <a href="https://dwc.tdwg.org/terms/#dwc:georeferencedBy" target="_blank">the Darwin Core standard set of metadata terms</a> 
      for georeferences.</p> 
    <h4>How to use this tool</h4> 
    <p>The first step is to generate a dataset of specimen records from a museum or 
      herbarium database with Darwin Core terms for field headings, in CSV format, and upload the dataset into the tool. 
      Datasets can be up to 10s of thousands of records, depending on the size of your team and time 
      you want to take to work on the dataset. It is recommended to provide reasonably sized datasets that
      can be completed in a month or two to keep momentum and motivation in the team. Required fields are 
      <a href="https://dwc.tdwg.org/terms/#dwc:scientificName" target="_blank"><em class="svelte-63izc2">dwc:scientificName</em></a>, 
      <a href="https://dwc.tdwg.org/terms/#dwc:country" target="_blank"><em class="svelte-63izc2">dwc:country</em></a>, 
      <a href="https://dwc.tdwg.org/terms/#dwc:locality" target="_blank"><em class="svelte-63izc2">dwc:locality</em></a> or 
      <a href="https://dwc.tdwg.org/terms/#dwc:verbatimLocality" target="_blank"><em class="svelte-63izc2">dwc:verbatimLocality</em></a>, 
      and a field that uniquely identifies rows in the dataset such as 
      <a href="https://dwc.tdwg.org/terms/#dwc:occurrenceID" target="_blank"><em class="svelte-63izc2">dwc:occurrenceID</em></a>, 
      <a href="https://dwc.tdwg.org/terms/#dwc:catalogNumber" target="_blank"><em class="svelte-63izc2">dwc:catalogNumber</em></a> 
      (if unique in the dataset) or an equivalent. 
      <a href="https://dwc.tdwg.org/terms/#dwc:stateProvince" target="_blank"><em class="svelte-63izc2">dwc:stateProvince</em></a>
      is recommended to facilitate the georeferencing process, and 
      <a href="https://dwc.tdwg.org/terms/#dwc:recordedBy" target="_blank"><em class="svelte-63izc2">dwc:recordedBy</em></a> can be 
      included to refine localities further.</p> 
    <p><strong>For assistance with preparing and uploading a dataset please contact the NSCF on 
      <a href="mailto:data@nscf.org.za">data@nscf.org.za</a>.</strong></p> 
    <p>When the dataset is uploaded into the tool the included fields are checked, owner details provided, and similar 
      localities grouped. The dataset owner can invite team members to assist with georeferencing at this stage.</p> 
    <p>The dataset is then ready for georeferencing. The georeferencing process involves creating or using 
      existing georeferences and &#39;tying&#39; or &#39;linking&#39; those to the localities from the dataset. Users should
      have an appropriate set of georeferencing tools at hand, inluding GIS and appropriate data layers, Geolocate, 
      and so on, for generating new georeferences. Localities from the dataset are presented in groups of 
      similar or the same locality with the numbers of associated specimen records indicated. The process is then as follows:</p> 
    <ol><li>The user selects one or more locality strings from the group</li> 
      <li>An existing, appropriate georeference is selected or a new one is created</li> 
      <li>The user applies the selected georeference to the selected locality strings</li></ol> 
    <p>Team members work through the dataset until all locality groups have been processed. 
      Locality groups can be skipped or bookmarked to return to later.</p> 
    <p class="warning svelte-63izc2">Please take care when georeferencing to use existing georeferences 
      if they match your locality strings. DON&#39;T JUST CREATE NEW GEOREFERENCES! The purpose of this 
      tool is to make georeferencing efficient by minimizing duplication.</p> 
    <p>For NSCF partner institutions we recommend the use of the georeferencing protocol in the 
      <a href="https://nscf.org.za/resources/collections-management/" target="_blank">Collections Management Manual</a> or
      <a href="https://bit.ly/georefprotocol" target="_blank">available here</a>. Remember that your georeferences will be used by
      others so take care to make sure that new georeferences are accurate, include uncertainty measures that 
      are consistent with your protocol, and add remarks explaining why you chose particular coordinates and 
      uncertainty for a locality where others might need to know that when using your georeferences.</p> 
    <p>When the dataset is completed the owner and/or designated &#39;admins&#39; can validate the georeferences by
      checking that the coordinates and uncertainties are correct, that 
      georeferences are correctly linked to localities in the dataset, and that all metadata fields have 
      been completed. An additional validation step includes checking for geographic or environmental outliers.</p> 
    <p>After validation the dataset can be downloaded again with all georeference data included for incorporation back 
      into the institution database. It is recommended to review the downloaded dataset with a tool such as 
      <a href="https://openrefine.org/" target="blank">OpenRefine</a> before updating the main database.</p> 
    <p>A training video demonstrating use of the tool is available at this link (to come)</p> 
    <h4>Data policy</h4> 
    <p>Datasets uploaded to the georeferencing tool are considered property of the data owner
      and will not be used or accessed by SANBI, the NSCF Hub team, or any of the NSCF partner institutions 
      without express written permission from the owner of the dataset.</p> 
    <p>Conversely, georeferences created with this tool, meaning geographic coordinates for a locality string with all supporting
      metadata fields, will be publicly accessible and free from any intellectual property restrictions or terms of use. 
      This is in the spirit of free and open data access, and is required for reuse of those georeferences by other parties 
      facilitating efficient georeferencing. Note though
      that attribution is maintained for a georeference by means of the dwc:georeferencedBy and dwc:georeferencedByID terms
      to indicate who generated the georeference. Georeferences are not linked to specimen records outside of a dataset, 
      i.e. it is not possible for anyone to see what specimens, collectors, or datasets are associated with a 
      georeference, except a dataset owner where that georeference has been used.</p> 
    <p>We hope that you will enjoy using the tool. For any further assistance please contact <a href="mailto:data@nscf.org.za">data@nscf.org.za</a>.</p></div>`,attr(o,"class","container svelte-63izc2")},m(s,c){insert(s,o,c)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o)}}}class About extends SvelteComponent{constructor(o){super(),init(this,o,null,create_fragment$O,safe_not_equal,{})}}const subscriber_queue=[];function writable(l,o=noop$2){let s;const c=new Set;function h(Co){if(safe_not_equal(l,Co)&&(l=Co,s)){const Bo=!subscriber_queue.length;for(const Lo of c)Lo[1](),subscriber_queue.push(Lo,l);if(Bo){for(let Lo=0;Lo<subscriber_queue.length;Lo+=2)subscriber_queue[Lo][0](subscriber_queue[Lo+1]);subscriber_queue.length=0}}}function d(Co){h(Co(l))}function p(Co,Bo=noop$2){const Lo=[Co,Bo];return c.add(Lo),c.size===1&&(s=o(h)||noop$2),Co(l),()=>{c.delete(Lo),c.size===0&&(s(),s=null)}}return{set:h,update:d,subscribe:p}}const dataStore=writable({recordGroupSnap:null,recordGroup:null,georefIndex:null,locGeorefIndex:null,selectedGeorefID:null,markers:null});function converter(l,o){o||(o=5),l=l.replace(/\s\s+/g," ").trim();var s=null,c=null,h="",d="",p=[],Co=!1;if(dd_re.test(l))if(p=dd_re.exec(l),Co=checkMatch(p),Co)s=p[2],c=p[6],s.includes(",")&&s.replace(",","."),c.includes(",")&&c.replace(",","."),p[1]?(h=p[1],d=p[5]):p[4]&&(h=p[4],d=p[8]);else throw new Error("invalid decimal coordinate format");else if(dms_periods.test(l))if(p=dms_periods.exec(l),Co=checkMatch(p),Co)s=Math.abs(parseInt(p[2])),p[4]&&(s+=p[4]/60),p[6]&&(s+=p[6]/3600),parseInt(p[2])<0&&(s=-1*s),c=Math.abs(parseInt(p[9])),p[11]&&(c+=p[11]/60),p[13]&&(c+=p[13]/3600),parseInt(p[9])<0&&(c=-1*c),p[1]?(h=p[1],d=p[8]):p[7]&&(h=p[7],d=p[14]);else throw new Error("invalid DMS coordinates format");else if(dms_abbr.test(l))if(p=dms_abbr.exec(l),Co=checkMatch(p),Co)s=Math.abs(parseInt(p[2])),p[4]&&(s+=p[4]/60,p[3]||(p[3]=" ")),p[6]&&(s+=p[6]/3600,p[5]||(p[5]=" ")),parseInt(p[2])<0&&(s=-1*s),c=Math.abs(parseInt(p[10])),p[12]&&(c+=p[12]/60,p[11]||(p[11]=" ")),p[14]&&(c+=p[14]/3600,p[13]||(p[13]=" ")),parseInt(p[10])<0&&(c=-1*c),p[1]?(h=p[1],d=p[9]):p[8]&&(h=p[8],d=p[16]);else throw new Error("invalid DMS coordinates format");else if(coords_other.test(l))if(p=coords_other.exec(l),Co=checkMatch(p),Co)s=Math.abs(parseInt(p[2])),p[4]&&(s+=p[4]/60,p[3]||(p[3]=" ")),p[6]&&(s+=p[6]/3600,p[5]||(p[5]=" ")),parseInt(p[2])<0&&(s=-1*s),c=Math.abs(parseInt(p[10])),p[12]&&(c+=p[12]/60,p[11]||(p[11]=" ")),p[14]&&(c+=p[14]/3600,p[13]||(p[13]=" ")),parseInt(p[10])<0&&(c=-1*c),p[1]?(h=p[1],d=p[9]):p[8]&&(h=p[8],d=p[16]);else throw new Error("invalid coordinates format");if(Math.abs(c)>=180)throw new Error("invalid longitude value");if(Co){var Bo=/S|SOUTH/i;Bo.test(h)&&s>0&&(s=-1*s),Bo=/W|WEST/i,Bo.test(d)&&c>0&&(c=-1*c);var Lo=p[0].trim(),Uo,Qo,Po=/[,/;\u0020]/g,Mo=Lo.match(Po);if(Mo==null){var Go=Math.floor(l.length/2);Uo=Lo.substring(0,Go).trim(),Qo=Lo.substring(Go).trim()}else{var Go;Mo.length%2==1?Go=Math.floor(Mo.length/2):Go=Mo.length/2-1;var $o=0;if(Go==0)$o=Lo.indexOf(Mo[0]),Uo=Lo.substring(0,$o).trim(),Qo=Lo.substring($o+1).trim();else{for(var jo=0,zo=0;jo<=Go;)$o=Lo.indexOf(Mo[jo],zo),zo=$o+1,jo++;Uo=Lo.substring(0,$o).trim(),Qo=Lo.substring($o+1).trim()}}return isNaN(s)&&s.includes(",")&&(s=s.replace(",",".")),s=Number(Number(s).toFixed(o)),isNaN(c)&&c.includes(",")&&(c=c.replace(",",".")),c=Number(Number(c).toFixed(o)),{verbatimCoordinates:Lo,verbatimLatitude:Uo,verbatimLongitude:Qo,decimalLatitude:s,decimalLongitude:c,decimalCoordinates:`${s},${c}`,closeEnough:coordsCloseEnough}}else throw new Error("coordinates pattern match failed")}function checkMatch(l){if(!isNaN(l[0]))return!1;var o=l.filter(Co=>Co);if(o.shift(),o.length%2>0)return!1;for(var s=/^[-+]?(\d+|\d+\.\d*|\d*\.\d+)$/,c=/[A-Za-z]+/,h=o.length/2,d=!0,p=0;p<h;p++)if(s.test(o[p])!=s.test(o[p+h])||c.test(o[p])!=c.test(o[p+h])){d=!1;break}return d}function decimalsCloseEnough(l,o){var s=Math.abs(l-o);return diff=Number(s.toFixed(6)),diff<=1e-5}function coordsCloseEnough(l){if(l.includes(",")){var o=l.split(",");if(Number(o[0])==NaN||Number(o[1])==NaN)throw new Error("coords are not valid decimals");return decimalsCloseEnough(this.decimalLatitude,Number(o[0]))&&decimalsCloseEnough(this.decimalLongitude,o[1])}else throw new Error("coords being tested must be separated by a comma")}var dd_re=/(NORTH|SOUTH|[NS])?[\s]*([+-]?[0-8]?[0-9](?:[\.,]\d{3,}))([•º°]?)[\s]*(NORTH|SOUTH|[NS])?[\s]*[,/;]?[\s]*(EAST|WEST|[EW])?[\s]*([+-]?[0-1]?[0-9]?[0-9](?:[\.,]\d{3,}))([•º°]?)[\s]*(EAST|WEST|[EW])?/i,dms_periods=/(NORTH|SOUTH|[NS])?[\ \t]*([+-]?[0-8]?[0-9])[\ \t]*(\.)[\ \t]*([0-5]?[0-9])[\ \t]*(\.)?[\ \t]*((?:[0-5]?[0-9])(?:\.\d{1,3})?)?(NORTH|SOUTH|[NS])?(?:[\ \t]*[,/;][\ \t]*|[\ \t]*)(EAST|WEST|[EW])?[\ \t]*([+-]?[0-1]?[0-9]?[0-9])[\ \t]*(\.)[\ \t]*([0-5]?[0-9])[\ \t]*(\.)?[\ \t]*((?:[0-5]?[0-9])(?:\.\d{1,3})?)?(EAST|WEST|[EW])?/i,dms_abbr=/(NORTH|SOUTH|[NS])?[\ \t]*([+-]?[0-8]?[0-9])[\ \t]*(D(?:EG)?(?:REES)?)[\ \t]*([0-5]?[0-9])[\ \t]*(M(?:IN)?(?:UTES)?)[\ \t]*((?:[0-5]?[0-9])(?:\.\d{1,3})?)?(S(?:EC)?(?:ONDS)?)?[\ \t]*(NORTH|SOUTH|[NS])?(?:[\ \t]*[,/;][\ \t]*|[\ \t]*)(EAST|WEST|[EW])?[\ \t]*([+-]?[0-1]?[0-9]?[0-9])[\ \t]*(D(?:EG)?(?:REES)?)[\ \t]*([0-5]?[0-9])[\ \t]*(M(?:IN)?(?:UTES)?)[\ \t]*((?:[0-5]?[0-9])(?:\.\d{1,3})?)?(S(?:EC)?(?:ONDS)?)[\ \t]*(EAST|WEST|[EW])?/i,coords_other=/(NORTH|SOUTH|[NS])?[\ \t]*([+-]?[0-8]?[0-9])[\ \t]*([•º°\.:]|D(?:EG)?(?:REES)?)?[\ \t]*,?([0-5]?[0-9](?:\.\d{1,})?)?[\ \t]*(['′´’\.:]|M(?:IN)?(?:UTES)?)?[\ \t]*,?((?:[0-5]?[0-9])(?:\.\d{1,3})?)?[\ \t]*(''|′′|’’|´´|["″”\.])?[\ \t]*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?[\ \t]*([+-]?[0-1]?[0-9]?[0-9])[\ \t]*([•º°\.:]|D(?:EG)?(?:REES)?)?[\ \t]*,?([0-5]?[0-9](?:\.\d{1,})?)?[\ \t]*(['′´’\.:]|M(?:IN)?(?:UTES)?)?[\ \t]*,?((?:[0-5]?[0-9])(?:\.\d{1,3})?)?[\ \t]*(''|′′|´´|’’|["″”\.])?[\ \t]*(EAST|WEST|[EW])?/i,converter_1=converter,coordsParserFormats=[{verbatimCoordinates:"40.123, -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123\xB0 N 74.123\xB0 W",verbatimLatitude:"40.123\xB0 N",verbatimLongitude:"74.123\xB0 W"},{verbatimCoordinates:"40.123\xB0 N 74.123\xB0 W",verbatimLatitude:"40.123\xB0 N",verbatimLongitude:"74.123\xB0 W"},{verbatimCoordinates:'40\xB0 7\xB4 22.8" N 74\xB0 7\xB4 22.8" W',verbatimLatitude:'40\xB0 7\xB4 22.8" N',verbatimLongitude:'74\xB0 7\xB4 22.8" W'},{verbatimCoordinates:"40\xB0 7.38\u2019 , -74\xB0 7.38\u2019",verbatimLatitude:"40\xB0 7.38\u2019",verbatimLongitude:"-74\xB0 7.38\u2019"},{verbatimCoordinates:"N40\xB07\u201922.8\u2019\u2019, W74\xB07\u201922.8\u2019\u2019",verbatimLatitude:"N40\xB07\u201922.8\u2019\u2019",verbatimLongitude:"W74\xB07\u201922.8\u2019\u2019"},{verbatimCoordinates:'40\xB07\u201922.8"N, 74\xB07\u201922.8"W',verbatimLatitude:'40\xB07\u201922.8"N',verbatimLongitude:'74\xB07\u201922.8"W'},{verbatimCoordinates:`40\xB07'22.8"N, 74\xB07'22.8"W`,verbatimLatitude:`40\xB07'22.8"N`,verbatimLongitude:`74\xB07'22.8"W`},{verbatimCoordinates:"40 7 22.8, -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"},{verbatimCoordinates:"40.123 -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123\xB0,-74.123\xB0",verbatimLatitude:"40.123\xB0",verbatimLongitude:"-74.123\xB0"},{verbatimCoordinates:"40.123N74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"4007.38N7407.38W",verbatimLatitude:"4007.38N",verbatimLongitude:"7407.38W"},{verbatimCoordinates:'40\xB07\u201922.8"N, 74\xB07\u201922.8"W',verbatimLatitude:'40\xB07\u201922.8"N',verbatimLongitude:'74\xB07\u201922.8"W'},{verbatimCoordinates:"400722.8N740722.8W",verbatimLatitude:"400722.8N",verbatimLongitude:"740722.8W"},{verbatimCoordinates:"N 40 7.38 W 74 7.38",verbatimLatitude:"N 40 7.38",verbatimLongitude:"W 74 7.38"},{verbatimCoordinates:"40:7:22.8N 74:7:22.8W",verbatimLatitude:"40:7:22.8N",verbatimLongitude:"74:7:22.8W"},{verbatimCoordinates:"40:7:23N,74:7:23W",verbatimLatitude:"40:7:23N",verbatimLongitude:"74:7:23W",decimalLatitude:40.1230555555,decimalLongitude:-74.1230555555},{verbatimCoordinates:'40\xB07\u201923"N 74\xB07\u201923"W',verbatimLatitude:'40\xB07\u201923"N',verbatimLongitude:'74\xB07\u201923"W',decimalLatitude:40.1230555555,decimalLongitude:-74.12305555555555},{verbatimCoordinates:'40\xB07\u201923" -74\xB07\u201923"',verbatimLatitude:'40\xB07\u201923"',verbatimLongitude:'-74\xB07\u201923"',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:'40d 7\u2019 23" N 74d 7\u2019 23" W',verbatimLatitude:'40d 7\u2019 23" N',verbatimLongitude:'74d 7\u2019 23" W',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:"40.123N 74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"40\xB0 7.38, -74\xB0 7.38",verbatimLatitude:"40\xB0 7.38",verbatimLongitude:"-74\xB0 7.38"},{verbatimCoordinates:"40\xB0 7.38, -74\xB0 7.38",verbatimLatitude:"40\xB0 7.38",verbatimLongitude:"-74\xB0 7.38"},{verbatimCoordinates:"40 7 22.8; -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"}],coordsParserDecimals={decimalLatitude:40.123,decimalLongitude:-74.123},coordsRegexFormats=[{verbatimCoordinates:`50\xB04'17.698"south, 14\xB024'2.826"east`,verbatimLatitude:`50\xB04'17.698"south`,verbatimLongitude:`14\xB024'2.826"east`,decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"50d4m17.698S 14d24m2.826E",verbatimLatitude:"50d4m17.698S",verbatimLongitude:"14d24m2.826E",decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"40:26:46N,79:56:55W",verbatimLatitude:"40:26:46N",verbatimLongitude:"79:56:55W",decimalLatitude:40.44611111111111,decimalLongitude:-79.9486111111111},{verbatimCoordinates:"40:26:46.302N 79:56:55.903W",verbatimLatitude:"40:26:46.302N",verbatimLongitude:"79:56:55.903W",decimalLatitude:40.446195,decimalLongitude:-79.94886194444445},{verbatimCoordinates:"40\xB026\u203247\u2033N 79\xB058\u203236\u2033W",verbatimLatitude:"40\xB026\u203247\u2033N",verbatimLongitude:"79\xB058\u203236\u2033W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40d 26\u2032 47\u2033 N 79d 58\u2032 36\u2033 W",verbatimLatitude:"40d 26\u2032 47\u2033 N",verbatimLongitude:"79d 58\u2032 36\u2033 W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40.446195N 79.948862W",verbatimLatitude:"40.446195N",verbatimLongitude:"79.948862W",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40,446195\xB0 79,948862\xB0",verbatimLatitude:"40,446195\xB0",verbatimLongitude:"79,948862\xB0",decimalLatitude:40.446195,decimalLongitude:79.948862},{verbatimCoordinates:"40\xB0 26.7717, -79\xB0 56.93172",verbatimLatitude:"40\xB0 26.7717",verbatimLongitude:"-79\xB0 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.446195, -79.948862",verbatimLatitude:"40.446195",verbatimLongitude:"-79.948862",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.123256; -74.123256",verbatimLatitude:"40.123256",verbatimLongitude:"-74.123256",decimalLatitude:40.123256,decimalLongitude:-74.123256}],otherFormats=[{verbatimCoordinates:"18.24S 22.45E",verbatimLatitude:"18.24S",verbatimLongitude:"22.45E",decimalLatitude:-18.4,decimalLongitude:22.75},{verbatimCoordinates:"27deg 15min 45.2sec S 18deg 32min 53.7sec E",verbatimLatitude:"27deg 15min 45.2sec S",verbatimLongitude:"18deg 32min 53.7sec E",decimalLatitude:-27.262555555555554,decimalLongitude:18.54825},{verbatimCoordinates:"-23.3245\xB0 S / 28.2344\xB0 E",verbatimLatitude:"-23.3245\xB0 S",verbatimLongitude:"28.2344\xB0 E",decimalLatitude:-23.3245,decimalLongitude:28.2344},{verbatimCoordinates:"40\xB0 26.7717 -79\xB0 56.93172",verbatimLatitude:"40\xB0 26.7717",verbatimLongitude:"-79\xB0 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"27.15.45S 18.32.53E",verbatimLatitude:"27.15.45S",verbatimLongitude:"18.32.53E",decimalLatitude:-27.2625,decimalLongitude:18.548055}];let userProvidedFormats=[{verbatimCoordinates:"N 52d0m0s E 000d0m0s",verbatimLatitude:"N 52d0m0s",verbatimLongitude:"E 000d0m0s",decimalLatitude:52,decimalLongitude:0},{verbatimCoordinates:"N49 0.000 E02 33.314",verbatimLatitude:"N49 0.000",verbatimLongitude:"E02 33.314",decimalLatitude:49,decimalLongitude:2.5552333333333332}];function getAllTestFormats(){var l=[];return coordsParserFormats.forEach(o=>{o.decimalLatitude?l.push(o):l.push({...o,...coordsParserDecimals})}),[...l,...coordsRegexFormats,...otherFormats,...userProvidedFormats]}var testformats=getAllTestFormats(),convert=converter_1,formats=testformats.map(l=>l.verbatimCoordinates);convert.formats=formats;var merge$1=convert;let nanoid=(l=21)=>crypto.getRandomValues(new Uint8Array(l)).reduce((o,s)=>(s&=63,s<36?o+=s.toString(36):s<62?o+=(s-26).toString(36).toUpperCase():s>62?o+="-":o+="_",o),"");var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate(l){return typeof l=="string"&&REGEX.test(l)}var byteToHex=[];for(var i$3=0;i$3<256;++i$3)byteToHex.push((i$3+256).toString(16).substr(1));function stringify(l){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=(byteToHex[l[o+0]]+byteToHex[l[o+1]]+byteToHex[l[o+2]]+byteToHex[l[o+3]]+"-"+byteToHex[l[o+4]]+byteToHex[l[o+5]]+"-"+byteToHex[l[o+6]]+byteToHex[l[o+7]]+"-"+byteToHex[l[o+8]]+byteToHex[l[o+9]]+"-"+byteToHex[l[o+10]]+byteToHex[l[o+11]]+byteToHex[l[o+12]]+byteToHex[l[o+13]]+byteToHex[l[o+14]]+byteToHex[l[o+15]]).toLowerCase();if(!validate(s))throw TypeError("Stringified UUID is invalid");return s}function v4(l,o,s){l=l||{};var c=l.random||(l.rng||rng)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,o){s=s||0;for(var h=0;h<16;++h)o[s+h]=c[h];return o}return stringify(c)}async function getSafeTime(){try{let l=await fetchWithTimeout("https://us-central1-georef-745b9.cloudfunctions.net/getutctimestamp",{timeout:5e3});if(l.ok)return(await l.json()).timestamp;throw new Error(l.statusText)}catch(l){throw error.name==="AbortError"?new Error("timestamp API timed out"):l}}async function fetchWithTimeout(l,o={}){const{timeout:s=8e3}=o,c=new AbortController,h=setTimeout(()=>c.abort(),s),d=await fetch(l,{...o,signal:c.signal});return clearTimeout(h),d}class Georef{constructor(){this.georefID=nanoid(),this.guid=v4(),this.country=null,this.stateProvince=null,this.locality=null,this.verbatimCoordinates=null,this.decimalLatitude=null,this.decimalLongitude=null,this.uncertainty=null,this.uncertaintyUnit=null,this.datum=null,this.by=null,this.byORCID=null,this.date=null,this.sources=null,this.originalGeorefSource=null,this.protocol=null,this.remarks=null,this.verified=!1,this.verifiedBy=null,this.verifiedByORCID=null,this.verifiedDate=null,this.verifiedByRole=null,this.verificationRemarks=null,this.sendVerificationFeedback=null,this.createdBy=null,this.createdByID=null,this.dateCreated=null,this.lastEdited=null,this.lastEditedBy=null,this.lastEditdByID=null,this.lastEditRemarks=null,this.region=null,this.domain=null,this.used=!1,this.flagged=!1,this.ambiguous=!1,Object.defineProperties(this,{protocolObject:{enumerable:!1,get(){if(this.protocol&&this.protocol.trim())return{value:this.protocol,label:this.protocol}},set(o){o?this.protocol=o.value:this.protocol=null}},sourcesArray:{enumerable:!1,get(){if(this.sources&&this.sources.trim()){let o=this.sources.split("|").filter(s=>s).map(s=>s.trim()).filter(s=>s);if(o.length){let s=[];for(let c of o)s.push({value:c,label:c});return s}else return null}else return null},set(o){Array.isArray(o)?this.sources=o.map(s=>s.value).join(" | "):this.sources=null}},uncertaintyUnitOkay:{value:!0,writable:!0,enumerable:!1}})}copy(){let o=new Georef;for(let[s,c]of Object.entries(this)){if(s=="protocolObject"){o[s]=Object.assign({},c);continue}if(s=="sourcesArray"){o[s]=c.map(h=>Object.assign({},h));continue}o[s]=c}return o}clear(){for(let o of Object.keys(this))this[o]=null;this.protocolObject=null,this.sourcesArray=void 0}differentTo(o){if(!o||Object.keys(o).length==0)return!0;let s=["locality","verbatimCoordinates","decimalLatitude","decimalLongitude","uncertainty","uncertaintyUnit","datum","by","byORCID","date","sources","protocol","remarks"];for(let c of s)if(c=="decimalLatitude"||c=="decimalLongitude"){if(Math.abs(this[c]-o[c])>1e-9)return!0}else if(this[c]!=o[c])return!0;return!1}resetFieldsIfDifferent(){this.georefID=nanoid(),this.guid=v4(),this.country=null,this.stateProvince=null,this.originalGeorefSource=null,this.verified=!1,this.verifiedBy=null,this.verifiedByORCID=null,this.verifiedDate=null,this.verifiedByRole=null,this.verificationRemarks=null,this.createdBy=null,this.createdByID=null,this.dateCreated=null,this.lastEdited=null,this.lastEditedBy=null,this.lastEditdByID=null,this.lastEditRemarks=null,this.region=null,this.domain=null,this.used=!1,this.flagged=!1,this.ambiguous=!1,this.selected=!1}async persist(o,s,c,h){if(!o||!s||!c||!c.trim())throw new Error("valid profile and dataset objects and an index are required to persist a georef");let d=null;try{d=await getSafeTime()}catch(Lo){dispatch("componenterror",Lo);return}h?(this.lastEdited=d,this.lastEditedB=o.formattedName,this.lastEditdByID=o.uid):(this.dateCreated=d,this.createdBy=o.formattedName,this.createdByID=o.uid,this.region=s.region,this.domain=s.domain,(!this.originalGeorefSource||!this.originalGeorefSource.trim())&&(this.originalGeorefSource="NSCF georeference database"));let p;h?p="https://us-central1-georef-745b9.cloudfunctions.net/updategeoref":p="https://us-central1-georef-745b9.cloudfunctions.net/addgeoref";let Co=await Auth$1.currentUser.getIdToken(),Bo;try{Bo=await fetch(p,{method:"POST",headers:{Authorization:Co,"Content-Type":"application/json"},body:JSON.stringify({georef:this,index:c})})}catch(Lo){this.saveError=Lo.message,console.error(`error ${h?"updating":"saving"} this georef:`),console.log(this);try{let Uo=h?"updateGeorefErrors":"saveGeorefErrors";await Firestore.collection(Uo).doc(this.georefID).set(this)}catch(Uo){alert("Failed to store failed georef on Firebase:",Uo.message);return}}if(Bo.status!=200){let Lo=await Bo.json();if(Lo.validation){this.validationErrors=Lo.validation,console.log(this);try{let Qo=h?"updateGeorefErrors":"saveGeorefErrors";await Firestore.collection(Qo).doc(this.georefID).set(this)}catch(Qo){alert("Unable to store failed georef on Firebase:",Qo.message);return}let Uo=`There was an error ${h?"updating":"saving"} the georeference with id ${this.georefID}.\r
\r
`;Uo+="There were validation errors with these fields:"+Lo.validation+`\r
\r
`,Uo+="Please take a screenshot and alert the NSCF on data@nscf.org.za",alert(Uo)}else{this.saveErrors=Lo,console.error("Error saving this georef:"),console.log(this);try{let Qo=h?"updateGeorefErrors":"saveGeorefErrors";await Firestore.collection(Qo).doc(this.georefID).set(this)}catch(Qo){alert("Unable to store failed georef on Firebase:",Qo.message);return}let Uo=`There was an error ${h?"updating":"saving"} the georeference with id ${this.georefID}.\r
\r
`;Uo+="Error message:"+Lo+`\r
\r
`,Uo+="Please take a screenshot and alert the NSCF on data@nscf.org.za",alert(Uo);return}}else if(window.pushToast){let Lo=h?"georef updated":"new georef saved";window.pushToast(Lo)}}get decimalCoordinates(){return this.decimalLatitude&&this.decimalLongitude?this.decimalLatitude+","+this.decimalLongitude:null}set decimalCoordinates(o){if(o&&o.trim()){let s=o.split(",");this.decimalLatitude=Number(s[0]),this.decimalLongitude=Number(s[1])}}get decimalCoordinatesOkay(){return this.decimalLatitude&&this.decimalLongitude?!(isNaN(this.decimalLatitude)||isNaN(this.decimalLongitude)||this.decimalLatitude>90||this.decimalLongitude<-90||this.decimalLongitude>180||this.decimalLongitude<-180||!/^-?\d{1,2}\.\d+,\s*-?\d{1,3}\.\d+$/.test(this.decimalCoordinates)):!0}get decimalCoordinatesWarning(){return!/^-?\d{1,2}\.\d{4,8},\s*-?\d{1,3}\.\d{4,8}$/.test(this.decimalCoordinates)}get uncertaintyUnitOkay(){return!(this.uncertainty&&(!this.uncertaintyUnit||!this.uncertaintyUnit.trim()||!["m","km"].contains(this.uncertaintyUnit.trim())))}}const getNextAvailableRecordGroup=async(l,o,s,c,h)=>{let d=Firestore.collection("recordGroups").where("datasetID","==",l).where("completed","==",!1).where("groupLocked","==",!1);o&&o!="all"&&(d=d.where("country","==",o),s&&s!="all"&&(s=="none"?d=d.where("stateProvince","==",null):d=d.where("stateProvince","==",s))),d=d.orderBy("groupID"),h&&(c&&c=="at"?d=d.startAt(h):d=d.startAfter(h));const p=await d.limit(1).get();if(p.empty)return[];{let Co=await Firestore.runTransaction(async Bo=>{let Lo=await Bo.get(p.docs[0].ref);if(Lo.data().groupLocked)return null;try{await Bo.update(Lo.ref,{groupLocked:!0})}catch(Qo){return console.log("failed to lock the group"),console.error(Qo),null}return Lo});return Co?[Co]:null}},fetchCandidateGeorefs=async(l,o,s,c)=>{if(l&&l.length){let h=[];for(let Co of l){let Bo=Co.loc.replace(/(alt|elev)[:;\.]{0,1}\s+\d+(m|ft|f)/i,"").trim();try{let Lo=merge$1(Bo);Bo=Bo.replace(Lo.verbatimCoordinates,"")}catch{}h.push(fetchGeorefsForLoc(Bo,o,s,c))}let d;try{d=await Promise.all(h)}catch(Co){throw Co}d=d.filter(Co=>Co);let p={};if(d.length){for(let Co of d)if(Co.length)for(let Bo of Co){let Lo=Object.assign(new Georef,Bo._source);if(!p[Lo.georefID]){if(Lo.selected&&(Lo.selected=!1),!Lo.decimalCoordinatesOkay||Lo.flagged)continue;if(Lo.uncertaintyUnit&&Lo.uncertaintyUnit.trim()){if(!Lo.uncertainty||isNaN(Lo.uncertainty))Lo.uncertainty=null,Lo.uncertaintyUnit=null;else if(typeof Lo.uncertainty=="string"){let Uo=Number(Lo.uncertainty);!isNaN(Uo)&&Uo&&Uo>0?Lo.uncertainty=Uo:(Lo.uncertainty=null,Lo.uncertaintyUnit=null)}}else Lo.uncertainty=null,Lo.uncertaintyUnit=null;p[Lo.georefID]=Lo}}}return{georefIndex:p}}else throw new Error("no values supplied")},fetchGeorefsForLoc=async(l,o,s,c)=>{let d=`https://us-central1-georef-745b9.cloudfunctions.net/getgeorefs?search=${encodeURI(l)}&index=${o}`;c&&(d+="&noflags"),s&&!isNaN(s)&&(d+=`&limit=${s}`);let p;try{p=await fetch(d)}catch{return null}return p.ok?await p.json():null},updateGeorefStats=async(l,o,s,c,h,d,p,Co)=>{let Bo=getYearMonth(new Date),Lo=getYearWeek(new Date),Uo=new Date,Qo=new Date(Uo.getTime()-Uo.getTimezoneOffset()*60*1e3).toISOString().split("T")[0],Po=["stats/georefsAdded","stats/recordsGeoreferenced",`stats/weekly/${Lo}/georefsAdded`,`stats/weekly/${Lo}/recordsGeoreferenced`,`stats/monthly/${Bo}/georefsAdded`,`stats/monthly/${Bo}/recordsGeoreferenced`,`stats/perDataset/${p}/georefsAdded`,`stats/perDataset/${p}/recordsGeoreferenced`,`stats/perDataset/${p}/daily/${Qo}/georefsAdded`,`stats/perDataset/${p}/daily/${Qo}/recordsGeoreferenced`,`stats/perDataset/${p}/weekly/${Lo}/georefsAdded`,`stats/perDataset/${p}/weekly/${Lo}/recordsGeoreferenced`,`stats/perDataset/${p}/monthly/${Bo}/georefsAdded`,`stats/perDataset/${p}/monthly/${Bo}/recordsGeoreferenced`,`stats/perDataset/${p}/perUser/${h}/georefsAdded`,`stats/perDataset/${p}/perUser/${h}/recordsGeoreferenced`,`stats/perDataset/${p}/perUser/${h}/daily/${Qo}/georefsAdded`,`stats/perDataset/${p}/perUser/${h}/daily/${Qo}/recordsGeoreferenced`,`stats/perDataset/${p}/perUser/${h}/weekly/${Lo}/georefsAdded`,`stats/perDataset/${p}/perUser/${h}/weekly/${Lo}/recordsGeoreferenced`,`stats/perDataset/${p}/perUser/${h}/monthly/${Bo}/georefsAdded`,`stats/perDataset/${p}/perUser/${h}/monthly/${Bo}/recordsGeoreferenced`,`stats/perUser/${h}/georefsAdded`,`stats/perUser/${h}/recordsGeoreferenced`,`stats/perUser/${h}/daily/${Qo}/georefsAdded`,`stats/perUser/${h}/daily/${Qo}/recordsGeoreferenced`,`stats/perUser/${h}/weekly/${Lo}/georefsAdded`,`stats/perUser/${h}/weekly/${Lo}/recordsGeoreferenced`,`stats/perUser/${h}/monthly/${Bo}/georefsAdded`,`stats/perUser/${h}/monthly/${Bo}/recordsGeoreferenced`],Mo=[];for(let Xo of Po){let Zo=s;Xo.endsWith("recordsGeoreferenced")&&(Zo=c);let Wo=l.ref(Xo);Mo.push(updateStat(Wo,Zo))}if(Co){let Xo=["stats/perDataset/"+p+"/daily/"+Qo+"/groupsCompleted","stats/perDataset/"+p+"/weekly/"+Lo+"/groupsCompleted","stats/perDataset/"+p+"/monthly/"+Bo+"/groupsCompleted"];for(let Zo of Xo){let Wo=l.ref(Zo).transaction(es=>(es?es++:es=1,es));Mo.push(Wo)}}let Go=l.ref("stats/lastGeorefAdded").transaction(Xo=>(Xo=o.TIMESTAMP,Xo)),$o=l.ref("stats/lastGeorefAddedBy").transaction(Xo=>(Xo=d,Xo)),jo=l.ref(`stats/perDataset/${p}/lastGeorefAdded`).transaction(Xo=>(Xo=o.TIMESTAMP,Xo)),zo=l.ref(`stats/perDataset/${p}/lastGeorefAddedBy`).transaction(Xo=>(Xo=d,Xo));Mo.push(Go),Mo.push($o),Mo.push(jo),Mo.push(zo),await Promise.all(Mo)},updateStat=(l,o)=>{l.transaction(s=>(s?s+=o:s=o,s))},getYearWeek=l=>{l=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate())),l.setUTCDate(l.getUTCDate()+4-(l.getUTCDay()||7));var o=new Date(Date.UTC(l.getUTCFullYear(),0,1)),s=Math.ceil(((l-o)/864e5+1)/7);return`${l.getUTCFullYear()} ${s.toString().padStart(2,"0")}`},getYearMonth=l=>{let o=l.getUTCFullYear(),s=l.getMonth()+1;return`${o} ${s.toString().padStart(2,"0")}`},updateDatasetStats=(l,o,s,c,h)=>l.runTransaction(async d=>{let p=await d.get(o);if(!p.exists)throw"Document does not exist!";let Co=p.data();Co.recordsCompleted+=s;let Bo={recordsCompleted:Co.recordsCompleted,lastGeoreference:FieldValue.serverTimestamp(),lastGeoreferenceBy:c};h&&(Bo.groupsComplete=++Co.groupsComplete),await d.update(o,Bo)}),updateDatasetGeorefs=async(l,o,s,c)=>{let h=l.collection("datasetGeorefs").doc(s),d=l.collection("datasetGeorefsAdded").doc(s);if((await d.get()).exists)await h.update({georefIDs:o.arrayUnion(...c)});else{let Co=[h.set({georefIDs:c}),d.set({added:!0})];await Promise.all(Co)}},updateGeorefRecords=async(l,o,s,c,h)=>{try{await l.runTransaction(async d=>{let p=l.collection("georefRecords").doc(s.georefID),Co=await d.get(p);if(Co.exists){let Bo=Co.data(),Lo={};Lo.datasetIDs=o.arrayUnion(c),Lo.records={},Bo.records?Bo.records[c]?(Lo.records[c]=o.arrayUnion(...h),Bo.records[c]=[...Bo.records[c],...h]):(Lo.records[c]=h,Bo.records[c]=h):(Lo.records[c]=h,Bo.records={},Bo.records[c]=h);let Uo=0;for(let Qo of Object.values(Bo.records))Uo+=Qo.length;Lo.recordCount=Uo,d.update(p,Lo)}else{const Bo={};Bo[c]=h;let Lo={georefID:s.georefID,country:s.country,stateProvince:s.stateProvince||null,locality:s.locality||null,decimalLatitude:s.decimalLatitude||null,decimalLongitude:s.decimalLongitude||null,locked:!1,verified:!1,records:{[c]:h},datasetIDs:[c],recordCount:h.length,createdByID:s.createdByID,dateCreated:s.dateCreated};d.set(p,Lo)}})}catch(d){alert("Error updating georefRecords, see the console"),console.error(d)}},flagGeoref=async(l,o)=>{let s=`https://us-central1-georef-745b9.cloudfunctions.net/flaggeoref?georefID=${l}&index=${o}`,c;try{c=await fetch(s)}catch(h){alert("Failed to flag georef:"+h.message)}if(c.status!=200){let h=await c.json();console.error(h),alert("Failed to flag georef:"+JSON.stringify(h,null,2))}else window.pushToast&&window.pushToast("georef flagged")},customSearch_svelte_svelte_type_style_lang="";function create_fragment$N(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo;return{c(){o=element("div"),s=element("div"),c=element("input"),h=space(),d=element("span"),d.textContent="content_paste",p=space(),Co=element("span"),Co.textContent="clear",Bo=space(),Lo=element("button"),Uo=text("Search"),attr(c,"class","icon-input svelte-1shd1mz"),c.disabled=l[2],attr(c,"placeholder",l[1]),toggle_class(c,"input-active",l[0]&&l[0].trim().length),attr(d,"class","material-icons inline-icon icon-input-icon svelte-1shd1mz"),set_style(d,"right","30px"),attr(d,"title","paste clipboard"),attr(Co,"class","material-icons icon-input-icon svelte-1shd1mz"),set_style(Co,"right","5px"),attr(Co,"title","clear"),attr(s,"class","icon-input-container svelte-1shd1mz"),attr(Lo,"class","search-button svelte-1shd1mz"),Lo.disabled=Qo=!l[0]||!l[0].trim().length||l[2],attr(o,"class","container svelte-1shd1mz")},m(Go,$o){insert(Go,o,$o),append(o,s),append(s,c),set_input_value(c,l[0]),append(s,h),append(s,d),append(s,p),append(s,Co),append(o,Bo),append(o,Lo),append(Lo,Uo),Po||(Mo=[listen(c,"keyup",l[7]),listen(c,"input",l[8]),listen(d,"click",l[4]),listen(Co,"click",l[5]),listen(Lo,"click",l[3])],Po=!0)},p(Go,[$o]){$o&4&&(c.disabled=Go[2]),$o&2&&attr(c,"placeholder",Go[1]),$o&1&&c.value!==Go[0]&&set_input_value(c,Go[0]),$o&1&&toggle_class(c,"input-active",Go[0]&&Go[0].trim().length),$o&5&&Qo!==(Qo=!Go[0]||!Go[0].trim().length||Go[2])&&(Lo.disabled=Qo)},i:noop$2,o:noop$2,d(Go){Go&&detach(o),Po=!1,run_all(Mo)}}}function instance$M(l,o,s){const c=createEventDispatcher();let{customSearchString:h=null}=o,{elasticindex:d}=o,{placeholder:p="Search for a custom locality here"}=o,Co=!1;const Bo=async Mo=>{if(h&&d){c("custom-search-searching"),s(2,Co=!0);let Go={loc:h};try{let $o=await fetchCandidateGeorefs([Go],d,20,!0);c("custom-georefs",$o.georefIndex),s(2,Co=!1)}catch($o){alert("there was an error fetching georefs: "+$o.message),s(2,Co=!1)}}else h?(console.log("elastic indiex is",d),alert("Please select a region and domain to search")):alert("Please add a suitable locality to search for")},Lo=Mo=>{navigator.clipboard.writeText?navigator.clipboard.readText().then(Go=>{s(0,h=Go)}):alert("this browser does not support programmatic paste")},Uo=Mo=>{Co||(s(0,h=null),c("custom-search-cleared"))},Qo=Mo=>Mo.key==="Enter"&&Bo();function Po(){h=this.value,s(0,h)}return l.$$set=Mo=>{"customSearchString"in Mo&&s(0,h=Mo.customSearchString),"elasticindex"in Mo&&s(6,d=Mo.elasticindex),"placeholder"in Mo&&s(1,p=Mo.placeholder)},[h,p,Co,Bo,Lo,Uo,d,Qo,Po]}class CustomSearch extends SvelteComponent{constructor(o){super(),init(this,o,instance$M,create_fragment$N,safe_not_equal,{customSearchString:0,elasticindex:6,placeholder:1})}}const georefMatchListRow_svelte_svelte_type_style_lang="";function create_if_block$q(l){let o,s,c,h,d,p=l[1].georefIndex[l[0]].locality+"",Co,Bo,Lo,Uo,Qo,Po,Mo,Go=l[1].georefIndex[l[0]].protocol&&l[1].georefIndex[l[0]].protocol.toLowerCase().trim()!="unspecified",$o,jo,zo,Xo,Zo=l[1].georefIndex[l[0]].uncertainty&&create_if_block_5$8(),Wo=l[1].georefIndex[l[0]].sources&&create_if_block_4$a(),es=Go&&create_if_block_3$b(),is=l[1].georefIndex[l[0]].datum&&create_if_block_2$e(),Jo=l[1].georefIndex[l[0]].verified&&create_if_block_1$i();return{c(){o=element("td"),s=element("span"),c=text("stop"),h=space(),d=element("td"),Co=text(p),Bo=space(),Lo=element("td"),Zo&&Zo.c(),Uo=space(),Qo=element("td"),Wo&&Wo.c(),Po=space(),Mo=element("td"),es&&es.c(),$o=space(),jo=element("td"),is&&is.c(),zo=space(),Xo=element("td"),Jo&&Jo.c(),attr(s,"class","material-icons"),set_style(s,"color",l[3]),attr(Lo,"class","indicator svelte-d52cm5"),attr(Qo,"class","indicator svelte-d52cm5"),attr(Mo,"class","indicator svelte-d52cm5"),attr(jo,"class","indicator svelte-d52cm5"),attr(Xo,"class","indicator svelte-d52cm5")},m(Ko,Yo){insert(Ko,o,Yo),append(o,s),append(s,c),insert(Ko,h,Yo),insert(Ko,d,Yo),append(d,Co),insert(Ko,Bo,Yo),insert(Ko,Lo,Yo),Zo&&Zo.m(Lo,null),insert(Ko,Uo,Yo),insert(Ko,Qo,Yo),Wo&&Wo.m(Qo,null),insert(Ko,Po,Yo),insert(Ko,Mo,Yo),es&&es.m(Mo,null),insert(Ko,$o,Yo),insert(Ko,jo,Yo),is&&is.m(jo,null),insert(Ko,zo,Yo),insert(Ko,Xo,Yo),Jo&&Jo.m(Xo,null)},p(Ko,Yo){Yo&8&&set_style(s,"color",Ko[3]),Yo&3&&p!==(p=Ko[1].georefIndex[Ko[0]].locality+"")&&set_data(Co,p),Ko[1].georefIndex[Ko[0]].uncertainty?Zo||(Zo=create_if_block_5$8(),Zo.c(),Zo.m(Lo,null)):Zo&&(Zo.d(1),Zo=null),Ko[1].georefIndex[Ko[0]].sources?Wo||(Wo=create_if_block_4$a(),Wo.c(),Wo.m(Qo,null)):Wo&&(Wo.d(1),Wo=null),Yo&3&&(Go=Ko[1].georefIndex[Ko[0]].protocol&&Ko[1].georefIndex[Ko[0]].protocol.toLowerCase().trim()!="unspecified"),Go?es||(es=create_if_block_3$b(),es.c(),es.m(Mo,null)):es&&(es.d(1),es=null),Ko[1].georefIndex[Ko[0]].datum?is||(is=create_if_block_2$e(),is.c(),is.m(jo,null)):is&&(is.d(1),is=null),Ko[1].georefIndex[Ko[0]].verified?Jo||(Jo=create_if_block_1$i(),Jo.c(),Jo.m(Xo,null)):Jo&&(Jo.d(1),Jo=null)},d(Ko){Ko&&detach(o),Ko&&detach(h),Ko&&detach(d),Ko&&detach(Bo),Ko&&detach(Lo),Zo&&Zo.d(),Ko&&detach(Uo),Ko&&detach(Qo),Wo&&Wo.d(),Ko&&detach(Po),Ko&&detach(Mo),es&&es.d(),Ko&&detach($o),Ko&&detach(jo),is&&is.d(),Ko&&detach(zo),Ko&&detach(Xo),Jo&&Jo.d()}}}function create_if_block_5$8(l){let o;return{c(){o=element("span"),o.textContent="task_alt",attr(o,"class","material-icons")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_4$a(l){let o;return{c(){o=element("span"),o.textContent="task_alt",attr(o,"class","material-icons")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_3$b(l){let o;return{c(){o=element("span"),o.textContent="task_alt",attr(o,"class","material-icons")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_2$e(l){let o;return{c(){o=element("span"),o.textContent="task_alt",attr(o,"class","material-icons")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_1$i(l){let o;return{c(){o=element("span"),o.textContent="task_alt",attr(o,"class","material-icons")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_fragment$M(l){let o,s,c,h=l[1].georefIndex&&create_if_block$q(l);return{c(){o=element("tr"),h&&h.c(),attr(o,"class","svelte-d52cm5"),toggle_class(o,"active",l[1].georefIndex&&l[1].georefIndex[l[0]].selected),toggle_class(o,"oddrow",l[1].georefIndex&&l[2]%2&&!l[1].georefIndex[l[0]].selected),toggle_class(o,"hidden",!l[4])},m(d,p){insert(d,o,p),h&&h.m(o,null),s||(c=listen(o,"click",l[5]),s=!0)},p(d,[p]){d[1].georefIndex?h?h.p(d,p):(h=create_if_block$q(d),h.c(),h.m(o,null)):h&&(h.d(1),h=null),p&3&&toggle_class(o,"active",d[1].georefIndex&&d[1].georefIndex[d[0]].selected),p&7&&toggle_class(o,"oddrow",d[1].georefIndex&&d[2]%2&&!d[1].georefIndex[d[0]].selected),p&16&&toggle_class(o,"hidden",!d[4])},i:noop$2,o:noop$2,d(d){d&&detach(o),h&&h.d(),s=!1,c()}}}function instance$L(l,o,s){let c;component_subscribe(l,dataStore,$o=>s(1,c=$o));const h=createEventDispatcher();let{filterBest:d}=o,{georefKey:p}=o,Co=0,Bo,Lo,Uo=!0;const Qo=$o=>{let jo=c.georefIndex[p],zo=["uncertainty","datum","sources","protocol"],Xo=0;for(let Zo of zo)Zo=="uncertainty"?jo[Zo]&&jo[Zo]>0&&Xo++:jo[Zo]&&jo[Zo].trim()&&Xo++;return Xo},Po=$o=>{let jo=c.georefIndex[p];return jo.ambiguous||Lo==4?jo.verified?"#0066ff":"#00CC66":Lo>=2?"#FF9966":"#D3D3D3"},Mo=$o=>{if(c.georefIndex&&c.georefIndex[p]){let jo=c.georefIndex[p];if(d){if(jo.ambiguous){s(4,Uo=!0);return}if(Lo==4){s(4,Uo=!0);return}s(4,Uo=!1)}else s(4,Uo=!0)}},Go=$o=>{h("georef-selected",p)};return l.$$set=$o=>{"filterBest"in $o&&s(6,d=$o.filterBest),"georefKey"in $o&&s(0,p=$o.georefKey)},l.$$.update=()=>{if(l.$$.dirty&3&&p&&c.georefIndex){let $o=Object.keys(c.georefIndex);s(2,Co=$o.indexOf(p)),Lo=Qo(),s(3,Bo=Po())}l.$$.dirty&64&&Mo()},[p,c,Co,Bo,Uo,Go,d]}class GeorefMatchListRow extends SvelteComponent{constructor(o){super(),init(this,o,instance$L,create_fragment$M,safe_not_equal,{filterBest:6,georefKey:0})}}const georefMatchList_svelte_svelte_type_style_lang="";function get_each_context$e(l,o,s){const c=l.slice();return c[7]=o[s],c}function create_else_block$k(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block$p(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo=Object.keys(l[3].georefIndex),Ko=[];for(let ss=0;ss<Jo.length;ss+=1)Ko[ss]=create_each_block$e(get_each_context$e(l,Jo,ss));const Yo=ss=>transition_out(Ko[ss],1,1,()=>{Ko[ss]=null});let ts=l[1]==1&&create_if_block_1$h();return{c(){o=element("thead"),s=element("tr"),c=element("th"),h=element("span"),h.textContent="filter_alt",d=space(),p=element("th"),p.textContent="locality",Co=space(),Bo=element("th"),Bo.textContent="uncertainty",Lo=space(),Uo=element("th"),Uo.textContent="sources",Qo=space(),Po=element("th"),Po.textContent="protocol",Mo=space(),Go=element("th"),Go.textContent="datum",$o=space(),jo=element("th"),jo.textContent="verified",zo=space();for(let ss=0;ss<Ko.length;ss+=1)Ko[ss].c();Xo=space(),ts&&ts.c(),Zo=empty$1(),attr(h,"class","material-icons svelte-17n9x3u"),toggle_class(h,"icon-selected",l[0]),set_style(c,"width","20px"),attr(c,"class","svelte-17n9x3u"),attr(p,"class","svelte-17n9x3u"),attr(Bo,"class","svelte-17n9x3u"),attr(Uo,"class","svelte-17n9x3u"),attr(Po,"class","svelte-17n9x3u"),attr(Go,"class","svelte-17n9x3u"),attr(jo,"class","svelte-17n9x3u"),attr(o,"class","svelte-17n9x3u")},m(ss,cs){insert(ss,o,cs),append(o,s),append(s,c),append(c,h),append(s,d),append(s,p),append(s,Co),append(s,Bo),append(s,Lo),append(s,Uo),append(s,Qo),append(s,Po),append(s,Mo),append(s,Go),append(s,$o),append(s,jo),insert(ss,zo,cs);for(let as=0;as<Ko.length;as+=1)Ko[as].m(ss,cs);insert(ss,Xo,cs),ts&&ts.m(ss,cs),insert(ss,Zo,cs),Wo=!0,es||(is=listen(h,"click",l[4]),es=!0)},p(ss,cs){if(cs&1&&toggle_class(h,"icon-selected",ss[0]),cs&9){Jo=Object.keys(ss[3].georefIndex);let as;for(as=0;as<Jo.length;as+=1){const us=get_each_context$e(ss,Jo,as);Ko[as]?(Ko[as].p(us,cs),transition_in(Ko[as],1)):(Ko[as]=create_each_block$e(us),Ko[as].c(),transition_in(Ko[as],1),Ko[as].m(Xo.parentNode,Xo))}for(group_outros(),as=Jo.length;as<Ko.length;as+=1)Yo(as);check_outros()}ss[1]==1?ts||(ts=create_if_block_1$h(),ts.c(),ts.m(Zo.parentNode,Zo)):ts&&(ts.d(1),ts=null)},i(ss){if(!Wo){for(let cs=0;cs<Jo.length;cs+=1)transition_in(Ko[cs]);Wo=!0}},o(ss){Ko=Ko.filter(Boolean);for(let cs=0;cs<Ko.length;cs+=1)transition_out(Ko[cs]);Wo=!1},d(ss){ss&&detach(o),ss&&detach(zo),destroy_each(Ko,ss),ss&&detach(Xo),ts&&ts.d(ss),ss&&detach(Zo),es=!1,is()}}}function create_each_block$e(l){let o,s;return o=new GeorefMatchListRow({props:{georefKey:l[7],filterBest:l[0]}}),o.$on("georef-selected",l[5]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h&8&&(d.georefKey=c[7]),h&1&&(d.filterBest=c[0]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_1$h(l){let o;return{c(){o=element("tr"),o.innerHTML='<td colspan="7">Check the filter top left if no georefs here</td>',attr(o,"class","no-row-message svelte-17n9x3u")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_fragment$L(l){let o,s,c,h,d;const p=[create_if_block$p,create_else_block$k],Co=[];function Bo(Lo,Uo){return(s==null||Uo&8)&&(s=!!(Lo[3].georefIndex&&Object.keys(Lo[3].georefIndex).length)),s?0:1}return c=Bo(l,-1),h=Co[c]=p[c](l),{c(){o=element("table"),h.c(),attr(o,"class","svelte-17n9x3u")},m(Lo,Uo){insert(Lo,o,Uo),Co[c].m(o,null),l[6](o),d=!0},p(Lo,[Uo]){let Qo=c;c=Bo(Lo,Uo),c===Qo?Co[c].p(Lo,Uo):(group_outros(),transition_out(Co[Qo],1,1,()=>{Co[Qo]=null}),check_outros(),h=Co[c],h?h.p(Lo,Uo):(h=Co[c]=p[c](Lo),h.c()),transition_in(h,1),h.m(o,null))},i(Lo){d||(transition_in(h),d=!0)},o(Lo){transition_out(h),d=!1},d(Lo){Lo&&detach(o),Co[c].d(),l[6](null)}}}function instance$K(l,o,s){let c;component_subscribe(l,dataStore,Uo=>s(3,c=Uo));let h=!1,d=0,p;afterUpdate(Uo=>{if(p){let Qo=0;for(let Po=0;Po<p.rows.length;Po++)getComputedStyle(p.rows[Po]).display!="none"&&Qo++;s(1,d=Qo)}});const Co=Uo=>s(0,h=!h);function Bo(Uo){bubble.call(this,l,Uo)}function Lo(Uo){binding_callbacks[Uo?"unshift":"push"](()=>{p=Uo,s(2,p)})}return[h,d,p,c,Co,Bo,Lo]}class GeorefMatchList extends SvelteComponent{constructor(o){super(),init(this,o,instance$K,create_fragment$L,safe_not_equal,{})}}var fastDeepEqual=function l(o,s){if(o===s)return!0;if(o&&s&&typeof o=="object"&&typeof s=="object"){if(o.constructor!==s.constructor)return!1;var c,h,d;if(Array.isArray(o)){if(c=o.length,c!=s.length)return!1;for(h=c;h--!==0;)if(!l(o[h],s[h]))return!1;return!0}if(o.constructor===RegExp)return o.source===s.source&&o.flags===s.flags;if(o.valueOf!==Object.prototype.valueOf)return o.valueOf()===s.valueOf();if(o.toString!==Object.prototype.toString)return o.toString()===s.toString();if(d=Object.keys(o),c=d.length,c!==Object.keys(s).length)return!1;for(h=c;h--!==0;)if(!Object.prototype.hasOwnProperty.call(s,d[h]))return!1;for(h=c;h--!==0;){var p=d[h];if(!l(o[p],s[p]))return!1}return!0}return o!==o&&s!==s};const DEFAULT_ID="__googleMapsScriptId";class Loader{constructor({apiKey:o,channel:s,client:c,id:h=DEFAULT_ID,libraries:d=[],language:p,region:Co,version:Bo,mapIds:Lo,nonce:Uo,retries:Qo=3,url:Po="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.version=Bo,this.apiKey=o,this.channel=s,this.client=c,this.id=h||DEFAULT_ID,this.libraries=d,this.language=p,this.region=Co,this.mapIds=Lo,this.nonce=Uo,this.retries=Qo,this.url=Po,Loader.instance){if(!fastDeepEqual(this.options,Loader.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(Loader.instance.options)}`);return Loader.instance}Loader.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}createUrl(){let o=this.url;return o+=`?callback=${this.CALLBACK}`,this.apiKey&&(o+=`&key=${this.apiKey}`),this.channel&&(o+=`&channel=${this.channel}`),this.client&&(o+=`&client=${this.client}`),this.libraries.length>0&&(o+=`&libraries=${this.libraries.join(",")}`),this.language&&(o+=`&language=${this.language}`),this.region&&(o+=`&region=${this.region}`),this.version&&(o+=`&v=${this.version}`),this.mapIds&&(o+=`&map_ids=${this.mapIds.join(",")}`),o}load(){return this.loadPromise()}loadPromise(){return new Promise((o,s)=>{this.loadCallback(c=>{c?s(c):o()})})}loadCallback(o){this.callbacks.push(o),this.execute()}setScript(){if(document.getElementById(this.id)){this.callback();return}const o=this.createUrl(),s=document.createElement("script");s.id=this.id,s.type="text/javascript",s.src=o,s.onerror=this.loadErrorCallback.bind(this),s.defer=!0,s.async=!0,this.nonce&&(s.nonce=this.nonce),document.head.appendChild(s)}deleteScript(){const o=document.getElementById(this.id);o&&o.remove()}resetIfRetryingFailed(){const o=this.retries+1;this.done&&!this.loading&&this.errors.length>=o&&(this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[])}loadErrorCallback(o){if(this.errors.push(o),this.errors.length<=this.retries){const s=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${s} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},s)}else this.onerrorEvent=o,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(o=>{o(this.onerrorEvent)}),this.callbacks=[]}execute(){window.google&&window.google.maps&&window.google.maps.version&&(console.warn("Aborted attempt to load Google Maps JS with @googlemaps/js-api-loader.This may result in undesirable behavior as script parameters may not match."),this.callback()),this.resetIfRetryingFailed(),this.done?this.callback():this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}function _typeof(l){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(o){return typeof o}:_typeof=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(l)}function _classCallCheck(l,o){if(!(l instanceof o))throw new TypeError("Cannot call a class as a function")}function _defineProperties(l,o){for(var s=0;s<o.length;s++){var c=o[s];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(l,c.key,c)}}function _createClass(l,o,s){return o&&_defineProperties(l.prototype,o),s&&_defineProperties(l,s),l}function _defineProperty(l,o,s){return o in l?Object.defineProperty(l,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):l[o]=s,l}function ownKeys(l,o){var s=Object.keys(l);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(l);o&&(c=c.filter(function(h){return Object.getOwnPropertyDescriptor(l,h).enumerable})),s.push.apply(s,c)}return s}function _objectSpread2(l){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?ownKeys(Object(s),!0).forEach(function(c){_defineProperty(l,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(s)):ownKeys(Object(s)).forEach(function(c){Object.defineProperty(l,c,Object.getOwnPropertyDescriptor(s,c))})}return l}function _slicedToArray(l,o){return _arrayWithHoles(l)||_iterableToArrayLimit(l,o)||_unsupportedIterableToArray(l,o)||_nonIterableRest()}function _toConsumableArray(l){return _arrayWithoutHoles(l)||_iterableToArray(l)||_unsupportedIterableToArray(l)||_nonIterableSpread()}function _arrayWithoutHoles(l){if(Array.isArray(l))return _arrayLikeToArray(l)}function _arrayWithHoles(l){if(Array.isArray(l))return l}function _iterableToArray(l){if(typeof Symbol<"u"&&Symbol.iterator in Object(l))return Array.from(l)}function _iterableToArrayLimit(l,o){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(l)))){var s=[],c=!0,h=!1,d=void 0;try{for(var p=l[Symbol.iterator](),Co;!(c=(Co=p.next()).done)&&(s.push(Co.value),!(o&&s.length===o));c=!0);}catch(Bo){h=!0,d=Bo}finally{try{!c&&p.return!=null&&p.return()}finally{if(h)throw d}}return s}}function _unsupportedIterableToArray(l,o){if(!!l){if(typeof l=="string")return _arrayLikeToArray(l,o);var s=Object.prototype.toString.call(l).slice(8,-1);if(s==="Object"&&l.constructor&&(s=l.constructor.name),s==="Map"||s==="Set")return Array.from(l);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return _arrayLikeToArray(l,o)}}function _arrayLikeToArray(l,o){(o==null||o>l.length)&&(o=l.length);for(var s=0,c=new Array(o);s<o;s++)c[s]=l[s];return c}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var noop$1={value:()=>{}};function dispatch$1(){for(var l=0,o=arguments.length,s={},c;l<o;++l){if(!(c=arguments[l]+"")||c in s||/[\s.]/.test(c))throw new Error("illegal type: "+c);s[c]=[]}return new Dispatch(s)}function Dispatch(l){this._=l}function parseTypenames(l,o){return l.trim().split(/^|\s+/).map(function(s){var c="",h=s.indexOf(".");if(h>=0&&(c=s.slice(h+1),s=s.slice(0,h)),s&&!o.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:c}})}Dispatch.prototype=dispatch$1.prototype={constructor:Dispatch,on:function(l,o){var s=this._,c=parseTypenames(l+"",s),h,d=-1,p=c.length;if(arguments.length<2){for(;++d<p;)if((h=(l=c[d]).type)&&(h=get$1(s[h],l.name)))return h;return}if(o!=null&&typeof o!="function")throw new Error("invalid callback: "+o);for(;++d<p;)if(h=(l=c[d]).type)s[h]=set$1(s[h],l.name,o);else if(o==null)for(h in s)s[h]=set$1(s[h],l.name,null);return this},copy:function(){var l={},o=this._;for(var s in o)l[s]=o[s].slice();return new Dispatch(l)},call:function(l,o){if((h=arguments.length-2)>0)for(var s=new Array(h),c=0,h,d;c<h;++c)s[c]=arguments[c+2];if(!this._.hasOwnProperty(l))throw new Error("unknown type: "+l);for(d=this._[l],c=0,h=d.length;c<h;++c)d[c].value.apply(o,s)},apply:function(l,o,s){if(!this._.hasOwnProperty(l))throw new Error("unknown type: "+l);for(var c=this._[l],h=0,d=c.length;h<d;++h)c[h].value.apply(o,s)}};function get$1(l,o){for(var s=0,c=l.length,h;s<c;++s)if((h=l[s]).name===o)return h.value}function set$1(l,o,s){for(var c=0,h=l.length;c<h;++c)if(l[c].name===o){l[c]=noop$1,l=l.slice(0,c).concat(l.slice(c+1));break}return s!=null&&l.push({name:o,value:s}),l}var xhtml="http://www.w3.org/1999/xhtml",namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(l){var o=l+="",s=o.indexOf(":");return s>=0&&(o=l.slice(0,s))!=="xmlns"&&(l=l.slice(s+1)),namespaces.hasOwnProperty(o)?{space:namespaces[o],local:l}:l}function creatorInherit(l){return function(){var o=this.ownerDocument,s=this.namespaceURI;return s===xhtml&&o.documentElement.namespaceURI===xhtml?o.createElement(l):o.createElementNS(s,l)}}function creatorFixed(l){return function(){return this.ownerDocument.createElementNS(l.space,l.local)}}function creator(l){var o=namespace(l);return(o.local?creatorFixed:creatorInherit)(o)}function none(){}function selector(l){return l==null?none:function(){return this.querySelector(l)}}function selection_select(l){typeof l!="function"&&(l=selector(l));for(var o=this._groups,s=o.length,c=new Array(s),h=0;h<s;++h)for(var d=o[h],p=d.length,Co=c[h]=new Array(p),Bo,Lo,Uo=0;Uo<p;++Uo)(Bo=d[Uo])&&(Lo=l.call(Bo,Bo.__data__,Uo,d))&&("__data__"in Bo&&(Lo.__data__=Bo.__data__),Co[Uo]=Lo);return new Selection$1(c,this._parents)}function array(l){return typeof l=="object"&&"length"in l?l:Array.from(l)}function empty(){return[]}function selectorAll(l){return l==null?empty:function(){return this.querySelectorAll(l)}}function arrayAll(l){return function(){var o=l.apply(this,arguments);return o==null?[]:array(o)}}function selection_selectAll(l){typeof l=="function"?l=arrayAll(l):l=selectorAll(l);for(var o=this._groups,s=o.length,c=[],h=[],d=0;d<s;++d)for(var p=o[d],Co=p.length,Bo,Lo=0;Lo<Co;++Lo)(Bo=p[Lo])&&(c.push(l.call(Bo,Bo.__data__,Lo,p)),h.push(Bo));return new Selection$1(c,h)}function matcher(l){return function(){return this.matches(l)}}function childMatcher(l){return function(o){return o.matches(l)}}var find=Array.prototype.find;function childFind(l){return function(){return find.call(this.children,l)}}function childFirst(){return this.firstElementChild}function selection_selectChild(l){return this.select(l==null?childFirst:childFind(typeof l=="function"?l:childMatcher(l)))}var filter=Array.prototype.filter;function children(){return this.children}function childrenFilter(l){return function(){return filter.call(this.children,l)}}function selection_selectChildren(l){return this.selectAll(l==null?children:childrenFilter(typeof l=="function"?l:childMatcher(l)))}function selection_filter(l){typeof l!="function"&&(l=matcher(l));for(var o=this._groups,s=o.length,c=new Array(s),h=0;h<s;++h)for(var d=o[h],p=d.length,Co=c[h]=[],Bo,Lo=0;Lo<p;++Lo)(Bo=d[Lo])&&l.call(Bo,Bo.__data__,Lo,d)&&Co.push(Bo);return new Selection$1(c,this._parents)}function sparse(l){return new Array(l.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(l,o){this.ownerDocument=l.ownerDocument,this.namespaceURI=l.namespaceURI,this._next=null,this._parent=l,this.__data__=o}EnterNode.prototype={constructor:EnterNode,appendChild:function(l){return this._parent.insertBefore(l,this._next)},insertBefore:function(l,o){return this._parent.insertBefore(l,o)},querySelector:function(l){return this._parent.querySelector(l)},querySelectorAll:function(l){return this._parent.querySelectorAll(l)}};function constant(l){return function(){return l}}function bindIndex(l,o,s,c,h,d){for(var p=0,Co,Bo=o.length,Lo=d.length;p<Lo;++p)(Co=o[p])?(Co.__data__=d[p],c[p]=Co):s[p]=new EnterNode(l,d[p]);for(;p<Bo;++p)(Co=o[p])&&(h[p]=Co)}function bindKey(l,o,s,c,h,d,p){var Co,Bo,Lo=new Map,Uo=o.length,Qo=d.length,Po=new Array(Uo),Mo;for(Co=0;Co<Uo;++Co)(Bo=o[Co])&&(Po[Co]=Mo=p.call(Bo,Bo.__data__,Co,o)+"",Lo.has(Mo)?h[Co]=Bo:Lo.set(Mo,Bo));for(Co=0;Co<Qo;++Co)Mo=p.call(l,d[Co],Co,d)+"",(Bo=Lo.get(Mo))?(c[Co]=Bo,Bo.__data__=d[Co],Lo.delete(Mo)):s[Co]=new EnterNode(l,d[Co]);for(Co=0;Co<Uo;++Co)(Bo=o[Co])&&Lo.get(Po[Co])===Bo&&(h[Co]=Bo)}function datum(l){return l.__data__}function selection_data(l,o){if(!arguments.length)return Array.from(this,datum);var s=o?bindKey:bindIndex,c=this._parents,h=this._groups;typeof l!="function"&&(l=constant(l));for(var d=h.length,p=new Array(d),Co=new Array(d),Bo=new Array(d),Lo=0;Lo<d;++Lo){var Uo=c[Lo],Qo=h[Lo],Po=Qo.length,Mo=array(l.call(Uo,Uo&&Uo.__data__,Lo,c)),Go=Mo.length,$o=Co[Lo]=new Array(Go),jo=p[Lo]=new Array(Go),zo=Bo[Lo]=new Array(Po);s(Uo,Qo,$o,jo,zo,Mo,o);for(var Xo=0,Zo=0,Wo,es;Xo<Go;++Xo)if(Wo=$o[Xo]){for(Xo>=Zo&&(Zo=Xo+1);!(es=jo[Zo])&&++Zo<Go;);Wo._next=es||null}}return p=new Selection$1(p,c),p._enter=Co,p._exit=Bo,p}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(l,o,s){var c=this.enter(),h=this,d=this.exit();return c=typeof l=="function"?l(c):c.append(l+""),o!=null&&(h=o(h)),s==null?d.remove():s(d),c&&h?c.merge(h).order():h}function selection_merge(l){if(!(l instanceof Selection$1))throw new Error("invalid merge");for(var o=this._groups,s=l._groups,c=o.length,h=s.length,d=Math.min(c,h),p=new Array(c),Co=0;Co<d;++Co)for(var Bo=o[Co],Lo=s[Co],Uo=Bo.length,Qo=p[Co]=new Array(Uo),Po,Mo=0;Mo<Uo;++Mo)(Po=Bo[Mo]||Lo[Mo])&&(Qo[Mo]=Po);for(;Co<c;++Co)p[Co]=o[Co];return new Selection$1(p,this._parents)}function selection_order(){for(var l=this._groups,o=-1,s=l.length;++o<s;)for(var c=l[o],h=c.length-1,d=c[h],p;--h>=0;)(p=c[h])&&(d&&p.compareDocumentPosition(d)^4&&d.parentNode.insertBefore(p,d),d=p);return this}function selection_sort(l){l||(l=ascending);function o(Qo,Po){return Qo&&Po?l(Qo.__data__,Po.__data__):!Qo-!Po}for(var s=this._groups,c=s.length,h=new Array(c),d=0;d<c;++d){for(var p=s[d],Co=p.length,Bo=h[d]=new Array(Co),Lo,Uo=0;Uo<Co;++Uo)(Lo=p[Uo])&&(Bo[Uo]=Lo);Bo.sort(o)}return new Selection$1(h,this._parents).order()}function ascending(l,o){return l<o?-1:l>o?1:l>=o?0:NaN}function selection_call(){var l=arguments[0];return arguments[0]=this,l.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var l=this._groups,o=0,s=l.length;o<s;++o)for(var c=l[o],h=0,d=c.length;h<d;++h){var p=c[h];if(p)return p}return null}function selection_size(){let l=0;for(const o of this)++l;return l}function selection_empty(){return!this.node()}function selection_each(l){for(var o=this._groups,s=0,c=o.length;s<c;++s)for(var h=o[s],d=0,p=h.length,Co;d<p;++d)(Co=h[d])&&l.call(Co,Co.__data__,d,h);return this}function attrRemove(l){return function(){this.removeAttribute(l)}}function attrRemoveNS(l){return function(){this.removeAttributeNS(l.space,l.local)}}function attrConstant(l,o){return function(){this.setAttribute(l,o)}}function attrConstantNS(l,o){return function(){this.setAttributeNS(l.space,l.local,o)}}function attrFunction(l,o){return function(){var s=o.apply(this,arguments);s==null?this.removeAttribute(l):this.setAttribute(l,s)}}function attrFunctionNS(l,o){return function(){var s=o.apply(this,arguments);s==null?this.removeAttributeNS(l.space,l.local):this.setAttributeNS(l.space,l.local,s)}}function selection_attr(l,o){var s=namespace(l);if(arguments.length<2){var c=this.node();return s.local?c.getAttributeNS(s.space,s.local):c.getAttribute(s)}return this.each((o==null?s.local?attrRemoveNS:attrRemove:typeof o=="function"?s.local?attrFunctionNS:attrFunction:s.local?attrConstantNS:attrConstant)(s,o))}function defaultView(l){return l.ownerDocument&&l.ownerDocument.defaultView||l.document&&l||l.defaultView}function styleRemove(l){return function(){this.style.removeProperty(l)}}function styleConstant(l,o,s){return function(){this.style.setProperty(l,o,s)}}function styleFunction(l,o,s){return function(){var c=o.apply(this,arguments);c==null?this.style.removeProperty(l):this.style.setProperty(l,c,s)}}function selection_style(l,o,s){return arguments.length>1?this.each((o==null?styleRemove:typeof o=="function"?styleFunction:styleConstant)(l,o,s==null?"":s)):styleValue(this.node(),l)}function styleValue(l,o){return l.style.getPropertyValue(o)||defaultView(l).getComputedStyle(l,null).getPropertyValue(o)}function propertyRemove(l){return function(){delete this[l]}}function propertyConstant(l,o){return function(){this[l]=o}}function propertyFunction(l,o){return function(){var s=o.apply(this,arguments);s==null?delete this[l]:this[l]=s}}function selection_property(l,o){return arguments.length>1?this.each((o==null?propertyRemove:typeof o=="function"?propertyFunction:propertyConstant)(l,o)):this.node()[l]}function classArray(l){return l.trim().split(/^|\s+/)}function classList(l){return l.classList||new ClassList(l)}function ClassList(l){this._node=l,this._names=classArray(l.getAttribute("class")||"")}ClassList.prototype={add:function(l){var o=this._names.indexOf(l);o<0&&(this._names.push(l),this._node.setAttribute("class",this._names.join(" ")))},remove:function(l){var o=this._names.indexOf(l);o>=0&&(this._names.splice(o,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(l){return this._names.indexOf(l)>=0}};function classedAdd(l,o){for(var s=classList(l),c=-1,h=o.length;++c<h;)s.add(o[c])}function classedRemove(l,o){for(var s=classList(l),c=-1,h=o.length;++c<h;)s.remove(o[c])}function classedTrue(l){return function(){classedAdd(this,l)}}function classedFalse(l){return function(){classedRemove(this,l)}}function classedFunction(l,o){return function(){(o.apply(this,arguments)?classedAdd:classedRemove)(this,l)}}function selection_classed(l,o){var s=classArray(l+"");if(arguments.length<2){for(var c=classList(this.node()),h=-1,d=s.length;++h<d;)if(!c.contains(s[h]))return!1;return!0}return this.each((typeof o=="function"?classedFunction:o?classedTrue:classedFalse)(s,o))}function textRemove(){this.textContent=""}function textConstant(l){return function(){this.textContent=l}}function textFunction(l){return function(){var o=l.apply(this,arguments);this.textContent=o==null?"":o}}function selection_text(l){return arguments.length?this.each(l==null?textRemove:(typeof l=="function"?textFunction:textConstant)(l)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(l){return function(){this.innerHTML=l}}function htmlFunction(l){return function(){var o=l.apply(this,arguments);this.innerHTML=o==null?"":o}}function selection_html(l){return arguments.length?this.each(l==null?htmlRemove:(typeof l=="function"?htmlFunction:htmlConstant)(l)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(l){var o=typeof l=="function"?l:creator(l);return this.select(function(){return this.appendChild(o.apply(this,arguments))})}function constantNull(){return null}function selection_insert(l,o){var s=typeof l=="function"?l:creator(l),c=o==null?constantNull:typeof o=="function"?o:selector(o);return this.select(function(){return this.insertBefore(s.apply(this,arguments),c.apply(this,arguments)||null)})}function remove(){var l=this.parentNode;l&&l.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var l=this.cloneNode(!1),o=this.parentNode;return o?o.insertBefore(l,this.nextSibling):l}function selection_cloneDeep(){var l=this.cloneNode(!0),o=this.parentNode;return o?o.insertBefore(l,this.nextSibling):l}function selection_clone(l){return this.select(l?selection_cloneDeep:selection_cloneShallow)}function selection_datum(l){return arguments.length?this.property("__data__",l):this.node().__data__}function contextListener(l){return function(o){l.call(this,o,this.__data__)}}function parseTypenames$1(l){return l.trim().split(/^|\s+/).map(function(o){var s="",c=o.indexOf(".");return c>=0&&(s=o.slice(c+1),o=o.slice(0,c)),{type:o,name:s}})}function onRemove(l){return function(){var o=this.__on;if(!!o){for(var s=0,c=-1,h=o.length,d;s<h;++s)d=o[s],(!l.type||d.type===l.type)&&d.name===l.name?this.removeEventListener(d.type,d.listener,d.options):o[++c]=d;++c?o.length=c:delete this.__on}}}function onAdd(l,o,s){return function(){var c=this.__on,h,d=contextListener(o);if(c){for(var p=0,Co=c.length;p<Co;++p)if((h=c[p]).type===l.type&&h.name===l.name){this.removeEventListener(h.type,h.listener,h.options),this.addEventListener(h.type,h.listener=d,h.options=s),h.value=o;return}}this.addEventListener(l.type,d,s),h={type:l.type,name:l.name,value:o,listener:d,options:s},c?c.push(h):this.__on=[h]}}function selection_on(l,o,s){var c=parseTypenames$1(l+""),h,d=c.length,p;if(arguments.length<2){var Co=this.node().__on;if(Co){for(var Bo=0,Lo=Co.length,Uo;Bo<Lo;++Bo)for(h=0,Uo=Co[Bo];h<d;++h)if((p=c[h]).type===Uo.type&&p.name===Uo.name)return Uo.value}return}for(Co=o?onAdd:onRemove,h=0;h<d;++h)this.each(Co(c[h],o,s));return this}function dispatchEvent(l,o,s){var c=defaultView(l),h=c.CustomEvent;typeof h=="function"?h=new h(o,s):(h=c.document.createEvent("Event"),s?(h.initEvent(o,s.bubbles,s.cancelable),h.detail=s.detail):h.initEvent(o,!1,!1)),l.dispatchEvent(h)}function dispatchConstant(l,o){return function(){return dispatchEvent(this,l,o)}}function dispatchFunction(l,o){return function(){return dispatchEvent(this,l,o.apply(this,arguments))}}function selection_dispatch(l,o){return this.each((typeof o=="function"?dispatchFunction:dispatchConstant)(l,o))}function*selection_iterator(){for(var l=this._groups,o=0,s=l.length;o<s;++o)for(var c=l[o],h=0,d=c.length,p;h<d;++h)(p=c[h])&&(yield p)}var root=[null];function Selection$1(l,o){this._groups=l,this._parents=o}function selection_selection(){return this}Selection$1.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(l){return typeof l=="string"?new Selection$1([[document.querySelector(l)]],[document.documentElement]):new Selection$1([[l]],root)}function sourceEvent(l){let o;for(;o=l.sourceEvent;)l=o;return l}function pointer(l,o){if(l=sourceEvent(l),o===void 0&&(o=l.currentTarget),o){var s=o.ownerSVGElement||o;if(s.createSVGPoint){var c=s.createSVGPoint();return c.x=l.clientX,c.y=l.clientY,c=c.matrixTransform(o.getScreenCTM().inverse()),[c.x,c.y]}if(o.getBoundingClientRect){var h=o.getBoundingClientRect();return[l.clientX-h.left-o.clientLeft,l.clientY-h.top-o.clientTop]}}return[l.pageX,l.pageY]}function selectAll(l){return typeof l=="string"?new Selection$1([document.querySelectorAll(l)],[document.documentElement]):new Selection$1([l==null?[]:array(l)],root)}function nopropagation(l){l.stopImmediatePropagation()}function noevent(l){l.preventDefault(),l.stopImmediatePropagation()}function nodrag(l){var o=l.document.documentElement,s=select(l).on("dragstart.drag",noevent,!0);"onselectstart"in o?s.on("selectstart.drag",noevent,!0):(o.__noselect=o.style.MozUserSelect,o.style.MozUserSelect="none")}function yesdrag(l,o){var s=l.document.documentElement,c=select(l).on("dragstart.drag",null);o&&(c.on("click.drag",noevent,!0),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart"in s?c.on("selectstart.drag",null):(s.style.MozUserSelect=s.__noselect,delete s.__noselect)}var constant$1=l=>()=>l;function DragEvent(l,{sourceEvent:o,subject:s,target:c,identifier:h,active:d,x:p,y:Co,dx:Bo,dy:Lo,dispatch:Uo}){Object.defineProperties(this,{type:{value:l,enumerable:!0,configurable:!0},sourceEvent:{value:o,enumerable:!0,configurable:!0},subject:{value:s,enumerable:!0,configurable:!0},target:{value:c,enumerable:!0,configurable:!0},identifier:{value:h,enumerable:!0,configurable:!0},active:{value:d,enumerable:!0,configurable:!0},x:{value:p,enumerable:!0,configurable:!0},y:{value:Co,enumerable:!0,configurable:!0},dx:{value:Bo,enumerable:!0,configurable:!0},dy:{value:Lo,enumerable:!0,configurable:!0},_:{value:Uo}})}DragEvent.prototype.on=function(){var l=this._.on.apply(this._,arguments);return l===this._?this:l};function defaultFilter(l){return!l.ctrlKey&&!l.button}function defaultContainer(){return this.parentNode}function defaultSubject(l,o){return o==null?{x:l.x,y:l.y}:o}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function drag(){var l=defaultFilter,o=defaultContainer,s=defaultSubject,c=defaultTouchable,h={},d=dispatch$1("start","drag","end"),p=0,Co,Bo,Lo,Uo,Qo=0;function Po(Wo){Wo.on("mousedown.drag",Mo).filter(c).on("touchstart.drag",jo).on("touchmove.drag",zo).on("touchend.drag touchcancel.drag",Xo).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function Mo(Wo,es){if(!(Uo||!l.call(this,Wo,es))){var is=Zo(this,o.call(this,Wo,es),Wo,es,"mouse");!is||(select(Wo.view).on("mousemove.drag",Go,!0).on("mouseup.drag",$o,!0),nodrag(Wo.view),nopropagation(Wo),Lo=!1,Co=Wo.clientX,Bo=Wo.clientY,is("start",Wo))}}function Go(Wo){if(noevent(Wo),!Lo){var es=Wo.clientX-Co,is=Wo.clientY-Bo;Lo=es*es+is*is>Qo}h.mouse("drag",Wo)}function $o(Wo){select(Wo.view).on("mousemove.drag mouseup.drag",null),yesdrag(Wo.view,Lo),noevent(Wo),h.mouse("end",Wo)}function jo(Wo,es){if(!!l.call(this,Wo,es)){var is=Wo.changedTouches,Jo=o.call(this,Wo,es),Ko=is.length,Yo,ts;for(Yo=0;Yo<Ko;++Yo)(ts=Zo(this,Jo,Wo,es,is[Yo].identifier,is[Yo]))&&(nopropagation(Wo),ts("start",Wo,is[Yo]))}}function zo(Wo){var es=Wo.changedTouches,is=es.length,Jo,Ko;for(Jo=0;Jo<is;++Jo)(Ko=h[es[Jo].identifier])&&(noevent(Wo),Ko("drag",Wo,es[Jo]))}function Xo(Wo){var es=Wo.changedTouches,is=es.length,Jo,Ko;for(Uo&&clearTimeout(Uo),Uo=setTimeout(function(){Uo=null},500),Jo=0;Jo<is;++Jo)(Ko=h[es[Jo].identifier])&&(nopropagation(Wo),Ko("end",Wo,es[Jo]))}function Zo(Wo,es,is,Jo,Ko,Yo){var ts=d.copy(),ss=pointer(Yo||is,es),cs,as,us;if((us=s.call(Wo,new DragEvent("beforestart",{sourceEvent:is,target:Po,identifier:Ko,active:p,x:ss[0],y:ss[1],dx:0,dy:0,dispatch:ts}),Jo))!=null)return cs=us.x-ss[0]||0,as=us.y-ss[1]||0,function gs(Is,_s,Hs){var ds=ss,hs;switch(Is){case"start":h[Ko]=gs,hs=p++;break;case"end":delete h[Ko],--p;case"drag":ss=pointer(Hs||_s,es),hs=p;break}ts.call(Is,Wo,new DragEvent(Is,{sourceEvent:_s,subject:us,target:Po,identifier:Ko,active:hs,x:ss[0]+cs,y:ss[1]+as,dx:ss[0]-ds[0],dy:ss[1]-ds[1],dispatch:ts}),Jo)}}return Po.filter=function(Wo){return arguments.length?(l=typeof Wo=="function"?Wo:constant$1(!!Wo),Po):l},Po.container=function(Wo){return arguments.length?(o=typeof Wo=="function"?Wo:constant$1(Wo),Po):o},Po.subject=function(Wo){return arguments.length?(s=typeof Wo=="function"?Wo:constant$1(Wo),Po):s},Po.touchable=function(Wo){return arguments.length?(c=typeof Wo=="function"?Wo:constant$1(!!Wo),Po):c},Po.on=function(){var Wo=d.on.apply(d,arguments);return Wo===d?Po:Wo},Po.clickDistance=function(Wo){return arguments.length?(Qo=(Wo=+Wo)*Wo,Po):Math.sqrt(Qo)},Po}var i18n={en:{tooltipText1:"Drag to change, click to remove",tooltipText2:"Drag to change"},it:{tooltipText1:"Trascina per modificare, fai clic per rimuovere",tooltipText2:"Trascina per modificare"},zh:{tooltipText1:"\u62D6\u52A8\u5373\u53EF\u66F4\u6539\uFF0C\u70B9\u51FB\u5373\u53EF\u5220\u9664",tooltipText2:"\u62D6\u52A8\u5373\u53EF\u66F4\u6539"},es:{tooltipText1:"Arrastra para cambiar, haz clic para quitar",tooltipText2:"Arrastra para cambiar"},de:{tooltipText1:"Zum \xC4ndern ziehen, zum Entfernen klicken",tooltipText2:"Zum \xC4ndern ziehen"},fr:{tooltipText1:"Faites glisser pour modifier, cliquez pour supprimer",tooltipText2:"Faites glisser pour modifier"},pt:{tooltipText1:"Arraste para alterar, clique para remover",tooltipText2:"Arraste para alterar"}},defaultLangCode="en",getProp=function l(o,s){if(i18n[o])return i18n[o][s];var c=o.split("-")[0];return i18n[c]?i18n[c][s]:i18n[defaultLangCode][s]},Config$2={prefix:"measure-tool",tooltipText1:function l(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:defaultLangCode;return getProp(o,"tooltipText1")},tooltipText2:function l(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:defaultLangCode;return getProp(o,"tooltipText2")}},e$1=[],t=[];function n(l,o){if(l&&typeof document<"u"){var s,c=o.prepend===!0?"prepend":"append",h=o.singleTag===!0,d=typeof o.container=="string"?document.querySelector(o.container):document.getElementsByTagName("head")[0];if(h){var p=e$1.indexOf(d);p===-1&&(p=e$1.push(d)-1,t[p]={}),s=t[p]&&t[p][c]?t[p][c]:t[p][c]=Co()}else s=Co();l.charCodeAt(0)===65279&&(l=l.substring(1)),s.styleSheet?s.styleSheet.cssText+=l:s.appendChild(document.createTextNode(l))}function Co(){var Bo=document.createElement("style");if(Bo.setAttribute("type","text/css"),o.attributes)for(var Lo=Object.keys(o.attributes),Uo=0;Uo<Lo.length;Uo++)Bo.setAttribute(Lo[Uo],o.attributes[Lo[Uo]]);var Qo=c==="prepend"?"afterbegin":"beforeend";return d.insertAdjacentElement(Qo,Bo),Bo}}var css=`.measure-tool-context-menu {
  font-family: Roboto, Arial, sans-serif;
  border: 1px solid rgba(0, 0, 0, 0.2);
  outline: none;
  position: fixed;
  display: none;
  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.2);
  transform: translate3d(0, 0, 0);
  max-width: 265px;
  z-index: 1;
  outline-offset: -2px;
  background: #fff;
  padding: 6px 0;
  white-space: nowrap;
  cursor: default;
  margin: 0; }
  .measure-tool-context-menu ul {
    padding: 0px;
    margin: 0px;
    background-color: white; }
    .measure-tool-context-menu ul li {
      cursor: pointer;
      display: flex;
      align-items: center;
      border-color: transparent;
      border-style: dotted;
      border-width: 1px 0;
      color: #333;
      font-size: 13px;
      font-weight: normal;
      margin: 0;
      padding: 4px 44px 4px 16px;
      position: relative;
      white-space: nowrap; }
      .measure-tool-context-menu ul li:hover {
        background-color: #f1f1f1;
        border-color: #f1f1f1;
        color: #222;
        transition: background 0s; }
`;n(css,{});var ContextMenu=function(){_createClass(l,[{key:"left",get:function(){return this._containerDiv.getBoundingClientRect().left}},{key:"top",get:function(){return this._containerDiv.getBoundingClientRect().top}},{key:"width",get:function(){return this._containerDiv.getBoundingClientRect().width}},{key:"height",get:function(){return this._containerDiv.getBoundingClientRect().height}}]);function l(o,s){_classCallCheck(this,l),this._defaultOptions={width:150},this._options=Object.assign({},this._defaultOptions,s||{}),this._parentDiv=o,this._containerDiv=document.createElement("div"),this._containerDiv.classList.add("".concat(Config$2.prefix,"-context-menu")),this._containerDiv.stylesheet=css,this._containerDiv.oncontextmenu=function(c){return c.preventDefault()},this._list=document.createElement("ul"),this._containerDiv.appendChild(this._list),o.appendChild(this._containerDiv),this._isVisible=!1}return _createClass(l,[{key:"addItem",value:function(s,c,h){var d=this,p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:this,Co=document.createElement("li"),Bo=document.createTextNode(s);return Co.appendChild(Bo),Co.onclick=function(Lo){Lo.preventDefault(),h.apply(p),d.hide()},c?this.showItem(Co):this.hideItem(Co),this._list.appendChild(Co),Co}},{key:"hideItem",value:function(s){s.style.cssText="display: none"}},{key:"showItem",value:function(s){s.style.cssText="display: block"}},{key:"toggleItems",value:function(s,c){var h=this;s.forEach(function(d){return h.showItem(d)}),c.forEach(function(d){return h.hideItem(d)})}},{key:"show",value:function(s){this._isVisible=!0,this._containerDiv.style.cssText=`
      display: block;
      visibility: hidden;
      position: absolute;
      width: `.concat(this._options.width,`px; 
    `);var c=this._parentDiv.getBoundingClientRect().width<=s.x+this.width,h=this._parentDiv.getBoundingClientRect().height<=s.y+this.height;this._containerDiv.style.cssText+=`
      `.concat(c?"right: 0px;":"left: "+s.x+"px;",`
      `).concat(h?"bottom: 14px;":"top: "+s.y+"px;",`
      visibility: visible;
    `)}},{key:"hide",value:function(){this._isVisible=!1,this._containerDiv.style.cssText="display: none"}},{key:"toggle",value:function(s){this._isVisible?this.hide():this.show(s)}}]),l}(),css$1=`.measure-tool-tooltip {
  display: none;
  font-family: Roboto, Arial, sans-serif;
  margin: 6px 15px;
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);
  padding: 10px;
  overflow: hidden;
  pointer-events: none;
  font-size: 0.7rem;
  z-index: 999; }
`;n(css$1,{});var Tooltip$1=function(){function l(o){_classCallCheck(this,l),this._parentDiv=o,this._containerDiv=document.createElement("div"),this._containerDiv.classList.add("".concat(Config$2.prefix,"-tooltip")),this._containerDiv.stylesheet=css$1,o.appendChild(this._containerDiv)}return _createClass(l,[{key:"show",value:function(s,c){this._containerDiv.innerHTML=c,this._containerDiv.style.cssText=`
      display: block;
      visibility: hidden;
      position: absolute;
    `;var h=this._parentDiv.getBoundingClientRect().width,d=this._parentDiv.getBoundingClientRect().height;this._containerDiv.style.cssText+=s.x<h/2?"left: ".concat(s.x,"px;"):"right: ".concat(h-s.x,"px;"),this._containerDiv.style.cssText+=s.y<d/2?"top: ".concat(s.y,"px"):"bottom: ".concat(d-s.y,"px;"),this._containerDiv.style.cssText+="visibility: visible;"}},{key:"hide",value:function(){this._containerDiv.style.cssText="display: none"}}]),l}(),ProjectionUtility=function(){function l(o,s,c){_classCallCheck(this,l),this._defaultOptions={offsetRate:8e3},this._options=Object.assign({},this._defaultOptions,c||{}),this._container=o,this._projection=s}return _createClass(l,[{key:"latLngToSvgPoint",value:function(s){var c=this._options.offsetRate/2,h=new google.maps.LatLng(s[1],s[0]),d=this._projection.fromLatLngToDivPixel(h);return[d.x+c,d.y+c]}},{key:"svgPointToLatLng",value:function(s){var c=this._options.offsetRate/2,h=new google.maps.Point(s[0]-c,s[1]-c),d=this._projection.fromDivPixelToLatLng(h);return[d.lng(),d.lat()]}},{key:"svgPointToContainerPoint",value:function(s){var c=this.svgPointToLatLng(s);return this._projection.fromLatLngToContainerPixel(new google.maps.LatLng(c[1],c[0]))}},{key:"latLngToContainerPoint",value:function(s){return this._projection.fromLatLngToContainerPixel(new google.maps.LatLng(s[1],s[0]))}}]),l}(),Geometry=function(){_createClass(l,[{key:"nodes",get:function(){return Object.assign([],this._nodes)}},{key:"lines",get:function(){var s=[];if(this._nodes.length>1)for(var c=1;c<this._nodes.length;c++)s.push([this._nodes[c-1],this._nodes[c]]);return s}}]);function l(){_classCallCheck(this,l),this._nodes=[]}return _createClass(l,[{key:"addNode",value:function(s){this._nodes.push(s)}},{key:"updateNode",value:function(s,c){this._nodes[s]=c}},{key:"removeNode",value:function(s){this._nodes.splice(s,1)}},{key:"insertNode",value:function(s,c){this._nodes.splice(s,0,c)}}]),l}(),Segment=function(){function l(o,s,c,h){_classCallCheck(this,l),this._start=o,this._end=s,this._length=c,this._lengthText=h}return _createClass(l,[{key:"toJSON",value:function(){return{start_location:{lat:this._start[1],lng:this._start[0]},end_location:{lat:this._end[1],lng:this._end[0]},length:{text:this._lengthText,value:this._length}}}}]),l}(),UnitTypeId={METRIC:"metric",IMPERIAL:"imperial",NAUTICAL:"nautical"},Helper=function(){function l(o){_classCallCheck(this,l),this._options={unit:UnitTypeId.METRIC},Object.assign(this._options,o),this.init()}return _createClass(l,[{key:"init",value:function(){this.initUnits()}},{key:"initUnits",value:function(){switch(this._options.unit.toLowerCase()){case UnitTypeId.METRIC:this._lengthMultiplier=1,this.formatLength=this._formatLengthMetric,this._areaMultiplier=1,this.formatArea=this._formatAreaMetric;break;case UnitTypeId.IMPERIAL:this._lengthMultiplier=3.28084,this.formatLength=this._formatLengthImperial,this._areaMultiplier=10.7639,this.formatArea=this._formatAreaImperial;break;case UnitTypeId.NAUTICAL:this._lengthMultiplier=1,this.formatLength=this._formatLengthNautical,this._areaMultiplier=1,this.formatArea=this._formatAreaMetric;break;default:this._lengthMultiplier=1,this.formatLength=this._formatLengthMetric,this._areaMultiplier=1,this.formatArea=this._formatAreaMetric;break}}},{key:"setOption",value:function(s,c){if(!this._options[s])throw new Error("".concat(s," is not a valid option on MeasureTool helper"));this._options[s]=c,this.initUnits()}},{key:"computeLengthBetween",value:function(s,c){return google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(s[1],s[0]),new google.maps.LatLng(c[1],c[0]))*this._lengthMultiplier}},{key:"computePathLength",value:function(s){for(var c=0,h=1;h<s.length;h++)c+=google.maps.geometry.spherical.computeDistanceBetween(new google.maps.LatLng(s[h-1][1],s[h-1][0]),new google.maps.LatLng(s[h][1],s[h][0]));return c*this._lengthMultiplier}},{key:"computeArea",value:function(s){return google.maps.geometry.spherical.computeArea(s.map(function(c){return new google.maps.LatLng(c[1],c[0])}))*this._areaMultiplier}},{key:"_formatLengthMetric",value:function(s){var c;return s/1e3>=1?(c="km",s/=1e3):c="m",this._numberToLocale(this._roundUp(s,2))+" "+c}},{key:"_formatLengthImperial",value:function(s){var c;return s/5280>=1?(c="mi",s/=5280):c="ft",this._numberToLocale(this._roundUp(s,2))+" "+c}},{key:"_formatLengthNautical",value:function(s){var c="NM";return s/=1852,this._numberToLocale(this._roundUp(s,2))+" "+c}},{key:"_formatAreaMetric",value:function(s){var c;return s/1e6>=1?(c="km\xB2",s/=1e6):c="m\xB2",this._numberToLocale(this._roundUp(s,2))+" "+c}},{key:"_formatAreaImperial",value:function(s){var c;return s*3587e-11>=1?(c="mi\xB2",s*=3587e-11):c="ft\xB2",this._numberToLocale(this._roundUp(s,2))+" "+c}},{key:"_roundUp",value:function(s,c){return Number(Math.round(s+"e"+c)+"e-"+c).toFixed(c)}},{key:"_numberToLocale",value:function(s){return new Intl.NumberFormat().format(s)}}],[{key:"findTouchPoint",value:function(s,c){var h=((s[1][1]-s[0][1])*(c[0]-s[0][0])-(s[1][0]-s[0][0])*(c[1]-s[0][1]))/(Math.pow(s[1][1]-s[0][1],2)+Math.pow(s[1][0]-s[0][0],2));return[c[0]-h*(s[1][1]-s[0][1]),c[1]+h*(s[1][0]-s[0][0])]}},{key:"findMidPoint",value:function(s){return[(s[0][0]+s[1][0])/2,(s[0][1]+s[1][1])/2]}},{key:"transformText",value:function(s,c){var h=l.findMidPoint([s,c]),d;return s[0]===c[0]?c[1]>s[1]?d=90:c[1]<s[1]?d=270:d=0:d=Math.atan((c[1]-s[1])/(c[0]-s[0]))*180/Math.PI,"translate(".concat(h[0],", ").concat(h[1],") rotate(").concat(d,")")}},{key:"makeId",value:function(s){return(Math.random().toString(36)+"00000000000000000").slice(2,s+2)}},{key:"_interpolate",value:function(s,c,h){var d=google.maps.geometry.spherical.interpolate(new google.maps.LatLng(s[1],s[0]),new google.maps.LatLng(c[1],c[0]),h);return[d.lng(),d.lat()]}}]),l}(),EVENT_START="measure_start",EVENT_END="measure_end",EVENT_CHANGE="measure_change",ObjectAssign=function l(){typeof Object.assign!="function"&&(Object.assign=function(o){if(o===null)throw new TypeError("Cannot convert undefined or null to object");o=Object(o);for(var s=1;s<arguments.length;s++){var c=arguments[s];if(c!==null)for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(o[h]=c[h])}return o})},deepClone=function l(o){if(!o)return o;var s=[Number,String,Boolean],c;if(s.forEach(function(d){o instanceof d&&(c=d(o))}),typeof c>"u")if(Object.prototype.toString.call(o)==="[object Array]")c=[],o.forEach(function(d,p,Co){c[p]=l(d)});else if(_typeof(o)==="object")if(o.nodeType&&typeof o.cloneNode=="function")c=o.cloneNode(!0);else if(o.prototype)c=o;else if(o instanceof Date)c=new Date(o);else{c={};for(var h in o)c[h]=l(o[h])}else c=o;return c},getClass=function l(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return s?"".concat(o," inverted"):o},css$2=`.measure-tool-svg-overlay {
  position: absolute;
  top: -4000px;
  left: -4000px;
  width: 8000px;
  height: 8000px; }

.cover-circle {
  fill: white;
  stroke: black;
  stroke-width: 2.5px; }

.touch-circle {
  fill: transparent;
  cursor: pointer; }

.grey-circle {
  fill: #fcfcfc;
  stroke: #646464;
  stroke-width: 2.5px;
  pointer-events: none; }

.base-line {
  fill: none;
  stroke: black;
  stroke-width: 2.5px; }
  .base-line.inverted {
    stroke: white; }

.aux-line {
  fill: none;
  stroke: transparent;
  stroke-width: 12px;
  cursor: pointer; }

.segment-measure-text {
  pointer-events: none;
  stroke: black;
  text-shadow: -2.4px -2.4px rgba(255, 255, 255, 0.4), -2.4px 2.4px rgba(255, 255, 255, 0.4), 2.4px 2.4px rgba(255, 255, 255, 0.4), 2.4px -2.4px rgba(255, 255, 255, 0.4), -2.4px 0 rgba(255, 255, 255, 0.4), 0 2.4px rgba(255, 255, 255, 0.4), 2.4px 0 rgba(255, 255, 255, 0.4), 0 -2.4px rgba(255, 255, 255, 0.4); }
  .segment-measure-text.inverted {
    stroke: white;
    text-shadow: -2.4px -2.4px black, -2.4px 2.4px black, 2.4px 2.4px black, 2.4px -2.4px black, -2.4px 0 black, 0 2.4px black, 2.4px 0 black, 0 -2.4px black; }

.node-measure-text {
  stroke: black;
  text-shadow: -2.4px -2.4px rgba(255, 255, 255, 0.4), -2.4px 2.4px rgba(255, 255, 255, 0.4), 2.4px 2.4px rgba(255, 255, 255, 0.4), 2.4px -2.4px rgba(255, 255, 255, 0.4), -2.4px 0 rgba(255, 255, 255, 0.4), 0 2.4px rgba(255, 255, 255, 0.4), 2.4px 0 rgba(255, 255, 255, 0.4), 0 -2.4px rgba(255, 255, 255, 0.4);
  pointer-events: none; }
  .node-measure-text.inverted {
    stroke: white;
    text-shadow: -2.4px -2.4px black, -2.4px 2.4px black, 2.4px 2.4px black, 2.4px -2.4px black, -2.4px 0 black, 0 2.4px black, 2.4px 0 black, 0 -2.4px black; }
  .node-measure-text.head-text {
    visibility: hidden; }
`;n(css$2,{});var nodeTargetRadius=5,nodeTargetExpandRadius=6,touchTargetRadius=12,MeasureTool=function(){_createClass(l,[{key:"lengthText",get:function(){return this._helper.formatLength(this._length||0)}},{key:"areaText",get:function(){return this._helper.formatArea(this._area||0)}},{key:"length",get:function(){return this._length||0}},{key:"area",get:function(){return this._area||0}},{key:"segments",get:function(){return deepClone(this._segments)||[]}},{key:"points",get:function(){return deepClone(this._geometry.nodes.map(function(s){return{lat:s[1],lng:s[0]}}))||[]}}],[{key:"UnitTypeId",get:function(){return UnitTypeId}}]);function l(o,s){_classCallCheck(this,l),l._initPolyfills(),this._options=_objectSpread2({showSegmentLength:!0,showAccumulativeLength:!0,contextMenu:!0,tooltip:!0,unit:UnitTypeId.METRIC,initialSegments:[],language:navigator?navigator.language:"en",invertColor:!1},s),this._map=o,this._map.setClickableIcons(!1),this._id=Helper.makeId(4),this._events=new Map,this._geometry=new Geometry,this._init()}return _createClass(l,[{key:"_init",value:function(){this._containerDiv=this._map.getDiv().querySelector("div:first-child"),this._options.contextMenu&&(this._contextMenu=new ContextMenu(this._containerDiv,{width:160}),this._startElementNode=this._contextMenu.addItem("Measure distance",!0,this.start,this),this._endElementNode=this._contextMenu.addItem("Clear measurement",!1,this.end,this),this._bindToggleContextMenu()),this._options.tooltip&&(this._tooltip=new Tooltip$1(this._containerDiv)),this._helper=new Helper({unit:this._options.unit}),this._initOverlay()}},{key:"_bindToggleContextMenu",value:function(){var s=this;this._map.addListener("contextmenu",function(c){s._firstClick=c,s._contextMenu.show(s._projection.fromLatLngToContainerPixel(c.latLng))}),document.addEventListener("keydown",function(c){(c.key==="Escape"||c.which===27)&&s._contextMenu.hide()}),this._containerDiv.addEventListener("mousedown",function(c){c.clientX>=s._contextMenu.left&&c.clientX<=s._contextMenu.left+s._contextMenu.width&&c.clientY>=s._contextMenu.top&&c.clientY<=s._contextMenu.top+s._contextMenu.height||s._contextMenu.hide()})}},{key:"start",value:function(s){var c=this;if(!this._started){this._overlay.setMap(this._map),this._geometry=new Geometry,this._segments=[];var h=s&&s.length>0;if(!this._options.contextMenu&&h)for(var d=0;d<s.length;d++){var p=s[d];if(this._geometry.addNode([p.lng,p.lat]),d>0){var Co=s[d-1];this._updateSegment([Co,p])}}this._options.contextMenu&&this._firstClick&&(this._checkClick(this._firstClick),this._contextMenu.toggleItems([this._endElementNode],[this._startElementNode])),this._mapClickEvent=this._map.addListener("click",function(Bo){return c._checkClick(Bo)}),this._map.setOptions({draggableCursor:"default"}),this._started=!0,typeof this._events.get(EVENT_START)=="function"&&this._events.get(EVENT_START)()}}},{key:"end",value:function(){!this._started||(typeof this._events.get(EVENT_END)=="function"&&this._events.get(EVENT_END)(this._getResults()),this._options.contextMenu&&this._contextMenu.toggleItems([this._startElementNode],[this._endElementNode]),this._mapClickEvent.remove(),this._geometry=new Geometry,this._onRemoveOverlay(),this._setOverlay(),this._overlay.setMap(null),this._map.setOptions({draggableCursor:null}),this._hideTooltip(),this._started=!1)}},{key:"addListener",value:function(s,c){this._events.set(s,c)}},{key:"removeListener",value:function(s){this._events.delete(s)}},{key:"setOption",value:function(s,c){if(this._options[s]===void 0)throw new Error("".concat(s," is not a valid option on MeasureTool"));this._options[s]=c,this._helper._options[s]&&this._helper.setOption(s,c),this._overlay&&this._nodeCircles&&this._redrawOverlay()}},{key:"_initOverlay",value:function(){this._setOverlay(),this._initComplete=!1}},{key:"_setOverlay",value:function(){this._overlay=new google.maps.OverlayView,this._overlay.onAdd=this._onAddOverlay.bind(this),this._overlay.draw=this._onDrawOverlay.bind(this),this._overlay.onRemove=this._onRemoveOverlay.bind(this),this._overlay.setMap(this._map)}},{key:"_onAddOverlay",value:function(){this._initComplete||(this._initComplete=!0),this._projection=this._overlay.getProjection(),this._projectionUtility=new ProjectionUtility(this._containerDiv,this._projection),this._svgOverlay=select(this._overlay.getPanes().overlayMouseTarget).append("div").attr("class","".concat(Config$2.prefix,"-measure-points-").concat(this._id)).append("svg").attr("class","".concat(Config$2.prefix,"-svg-overlay")),this._linesBase=this._svgOverlay.append("g").attr("class","base"),this._linesBase.selectAll("line").data(this._geometry.lines),this._linesAux=this._svgOverlay.append("g").attr("class","aux"),this._linesAux.selectAll("line").data(this._geometry.lines),this._lineDrag=this._svgOverlay.append("g").attr("class","drag"),this._lineDrag.selectAll("line").data(this._geometry.lines),this._nodeCircles=this._svgOverlay.append("g").attr("class","node-circle"),this._nodeCircles.selectAll("circle").data(this._geometry.nodes),this._touchCircles=this._svgOverlay.append("g").attr("class","touch-circle"),this._options.showSegmentLength&&(this._segmentText=this._svgOverlay.append("g").attr("class","segment-text"),this._segmentText.selectAll("text").data(this._geometry.lines)),this._options.showAccumulativeLength&&(this._nodeText=this._svgOverlay.append("g").attr("class","node-text"),this._nodeText.selectAll("text").data(this._geometry.nodes)),this._hoverCircle=this._svgOverlay.append("g").attr("class","hover-circle"),this._hoverCircle.append("circle").attr("class",getClass("grey-circle",this._options.invertColor)).attr("r",nodeTargetRadius),this._initComplete&&!this._started&&this._overlay.setMap(null)}},{key:"_onDrawOverlay",value:function(){this._updateCircles(),this._updateTouchCircles(),this._updateLine(),this._options.showSegmentLength&&this._updateSegmentText(),this._options.showAccumulativeLength&&this._updateNodeText(),this._geometry&&this._updateArea(this._geometry.nodes.length-1,this._geometry.nodes[this._geometry.nodes.length-1]),this._dispatchMeasureEvent()}},{key:"_onRemoveOverlay",value:function(){selectAll(".".concat(Config$2.prefix,"-measure-points-").concat(this._id)).remove()}},{key:"_redrawOverlay",value:function(){this._onRemoveOverlay(),this._setOverlay(),this._overlay.draw()}},{key:"_checkClick",value:function(s){if(!this._dragged&&this._touchCircles.selectAll('circle[r="'.concat(nodeTargetExpandRadius,'"]')).size()===0&&!this._hoverCircle.select("circle").attr("cx")){var c=[s.latLng.lng(),s.latLng.lat()];this._geometry.addNode(c),this._overlay.draw()}this._dragged=!1}},{key:"_updateCircles",value:function(){var s=this,c=this,h=this._nodeCircles.selectAll("circle").data(this._geometry.nodes).join("circle").datum(function(d,p){return[d,p]}).attr("class",function(d){var p=_slicedToArray(d,2),Co=p[1];return Co===0?"".concat(getClass("cover-circle",s._options.invertColor)," head-circle"):getClass("cover-circle",s._options.invertColor)}).attr("r",nodeTargetRadius).attr("cx",function(d){var p=_slicedToArray(d,1),Co=p[0];return s._projectionUtility.latLngToSvgPoint(Co)[0]}).attr("cy",function(d){var p=_slicedToArray(d,1),Co=p[0];return s._projectionUtility.latLngToSvgPoint(Co)[1]}).on("mouseover",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];c._onOverCircle(Bo,Lo,this)}).on("mouseout",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];c._onOutCircle(Bo,Lo,this)}).on("mousedown",function(){return s._hideTooltip()});h.enter().append("circle").attr("class",getClass("cover-circle",this._options.invertColor)).attr("r",nodeTargetRadius).attr("cx",function(d){var p=_slicedToArray(d,1),Co=p[0];return s._projectionUtility.latLngToSvgPoint(Co)[0]}).attr("cy",function(d){var p=_slicedToArray(d,1),Co=p[0];return s._projectionUtility.latLngToSvgPoint(Co)[1]}).on("mouseover",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];c._onOverCircle(Bo,Lo,this)}).on("mouseout",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];c._onOutCircle(Bo,Lo,this)}).on("mousedown",function(){return s._hideTooltip()}),this._nodeCircles.selectAll(".removed-circle").remove()}},{key:"_updateTouchCircles",value:function(){var s=this,c=this,h=this._touchCircles.selectAll("circle").data(this._geometry.nodes).join("circle").datum(function(d,p){return[d,p]}).attr("class",function(d){var p=_slicedToArray(d,2),Co=p[1];return Co===0?"".concat(getClass("touch-circle",s._options.invertColor)," head-circle"):getClass("touch-circle",s._options.invertColor)}).attr("r",touchTargetRadius).attr("cx",function(d){var p=_slicedToArray(d,1),Co=p[0];return s._projectionUtility.latLngToSvgPoint(Co)[0]}).attr("cy",function(d){var p=_slicedToArray(d,1),Co=p[0];return s._projectionUtility.latLngToSvgPoint(Co)[1]}).on("mouseover",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];c._onOverCircle(Bo,Lo,this)}).on("mouseout",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];c._onOutCircle(Bo,Lo,this)}).on("touchstart",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];d.preventDefault(),c._onOverCircle(Bo,Lo,this,!0)}).on("touchend",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];d.preventDefault(),c._onOutCircle(Bo,Lo,this)}).on("mousedown",function(){return s._hideTooltip()}).call(this._onDragCircle());h.enter().append("circle").attr("class",getClass("touch-circle",this._options.invertColor)).attr("r",touchTargetRadius).attr("cx",function(d){var p=_slicedToArray(d,1),Co=p[0];return s._projectionUtility.latLngToSvgPoint(Co)[0]}).attr("cy",function(d){var p=_slicedToArray(d,1),Co=p[0];return s._projectionUtility.latLngToSvgPoint(Co)[1]}).on("mouseover",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];c._onOverCircle(Bo,Lo,this)}).on("mouseout",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];c._onOutCircle(Bo,Lo,this)}).on("touchstart",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];d.preventDefault(),c._onOverCircle(Bo,Lo,this,!0)}).on("touchend",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];d.preventDefault(),c._onOutCircle(Bo,Lo,this)}).on("mousedown",function(){return s._hideTooltip()}).call(this._onDragCircle()),this._touchCircles.selectAll(".removed-circle").remove()}},{key:"_updateLine",value:function(){var s=this;this._segments=[];var c=this._linesBase.selectAll("line").data(this._geometry.lines).attr("class",getClass("base-line",this._options.invertColor)).attr("x1",function(p){return s._projectionUtility.latLngToSvgPoint(p[0])[0]}).attr("y1",function(p){return s._projectionUtility.latLngToSvgPoint(p[0])[1]}).attr("x2",function(p){return s._projectionUtility.latLngToSvgPoint(p[1])[0]}).attr("y2",function(p){return s._projectionUtility.latLngToSvgPoint(p[1])[1]}).each(function(p){return s._updateSegment(p)});c.exit().remove(),c.enter().append("line").attr("class",getClass("base-line",this._options.invertColor)).attr("x1",function(p){return s._projectionUtility.latLngToSvgPoint(p[0])[0]}).attr("y1",function(p){return s._projectionUtility.latLngToSvgPoint(p[0])[1]}).attr("x2",function(p){return s._projectionUtility.latLngToSvgPoint(p[1])[0]}).attr("y2",function(p){return s._projectionUtility.latLngToSvgPoint(p[1])[1]}).each(function(p){return s._updateSegment(p)});var h=this._linesAux.selectAll("line").data(this._geometry.lines).join("line").datum(function(p,Co){return[p,Co]}).attr("class","aux-line").attr("x1",function(p){var Co=_slicedToArray(p,1),Bo=Co[0];return s._projectionUtility.latLngToSvgPoint(Bo[0])[0]}).attr("y1",function(p){var Co=_slicedToArray(p,1),Bo=Co[0];return s._projectionUtility.latLngToSvgPoint(Bo[0])[1]}).attr("x2",function(p){var Co=_slicedToArray(p,1),Bo=Co[0];return s._projectionUtility.latLngToSvgPoint(Bo[1])[0]}).attr("y2",function(p){var Co=_slicedToArray(p,1),Bo=Co[0];return s._projectionUtility.latLngToSvgPoint(Bo[1])[1]});h.on("mousemove",function(p,Co){var Bo=_slicedToArray(Co,1),Lo=Bo[0],Uo=Helper.findTouchPoint([s._projectionUtility.latLngToSvgPoint(Lo[0]),s._projectionUtility.latLngToSvgPoint(Lo[1])],[p.offsetX,p.offsetY]);s._updateHoverCirclePosition(Uo[0],Uo[1])}).on("mouseout",function(){return s._hideHoverCircle()}).on("mousedown",function(){return s._hideTooltip()}).on("touchstart",function(p){p.preventDefault()}).call(this._onDragLine(h,c)),h.exit().remove(),h.enter().append("line").join("line").datum(function(p,Co){return[p,Co]}).attr("class","aux-line").attr("x1",function(p){var Co=_slicedToArray(p,1),Bo=Co[0];return s._projectionUtility.latLngToSvgPoint(Bo[0])[0]}).attr("y1",function(p){var Co=_slicedToArray(p,1),Bo=Co[0];return s._projectionUtility.latLngToSvgPoint(Bo[0])[1]}).attr("x2",function(p){var Co=_slicedToArray(p,1),Bo=Co[0];return s._projectionUtility.latLngToSvgPoint(Bo[1])[0]}).attr("y2",function(p){var Co=_slicedToArray(p,1),Bo=Co[0];return s._projectionUtility.latLngToSvgPoint(Bo[1])[1]});var d=this._lineDrag.selectAll("line").data([]);d.exit().remove()}},{key:"_updateSegmentText",value:function(){var s=this,c=this._segmentText.selectAll("text").data(this._geometry.lines).attr("class",getClass("segment-measure-text",this._options.invertColor)).attr("text-anchor","middle").attr("dominant-baseline","text-before-edge").attr("transform",function(h){var d=s._projectionUtility.latLngToSvgPoint(h[0]),p=s._projectionUtility.latLngToSvgPoint(h[1]);return Helper.transformText(d,p)}).text(function(h,d){return s._helper.formatLength(s._helper.computeLengthBetween(h[0],h[1]))});c.enter().append("text").attr("class",getClass("segment-measure-text",this._options.invertColor)).attr("text-anchor","middle").attr("dominant-baseline","text-before-edge").attr("transform",function(h){var d=s._projectionUtility.latLngToSvgPoint(h[0]),p=s._projectionUtility.latLngToSvgPoint(h[1]);return Helper.transformText(d,p)}).text(function(h,d){return s._helper.formatLength(s._helper.computeLengthBetween(h[0],h[1]))}),c.exit().remove()}},{key:"_updateNodeText",value:function(){var s=this,c=this._nodeText.selectAll("text").data(this._geometry.nodes).attr("class",function(h,d){return d===0?"".concat(getClass("node-measure-text",s._options.invertColor)," head-text"):getClass("node-measure-text",s._options.invertColor)}).attr("text-anchor","middle").attr("dominant-baseline","text-after-edge").attr("x",function(h){return s._projectionUtility.latLngToSvgPoint(h)[0]}).attr("y",this._transformNodeTextY.bind(this)).text(function(h,d){var p=s._helper.computePathLength(s._geometry.nodes.slice(0,d+1));return d===s._geometry.nodes.length-1&&(s._length=p),s._helper.formatLength(p)});c.enter().append("text").attr("class",function(h,d){return d===0?"".concat(getClass("node-measure-text",s._options.invertColor)," head-text"):getClass("node-measure-text",s._options.invertColor)}).attr("text-anchor","middle").attr("dominant-baseline","text-after-edge").attr("x",function(h){return s._projectionUtility.latLngToSvgPoint(h)[0]}).attr("y",this._transformNodeTextY.bind(this)).text(function(h,d){var p=s._helper.computePathLength(s._geometry.nodes.slice(0,d+1));return d===s._geometry.nodes.length-1&&(s._length=p),s._helper.formatLength(p)}),c.exit().remove()}},{key:"_onOverCircle",value:function(s,c,h){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!this._dragging){var p=select(h);p.classed("base")||(p=this._nodeCircles.select("circle:nth-child(".concat(c+1,")"))),p.attr("r",nodeTargetExpandRadius),this._options.tooltip&&!d&&this._tooltip.show(this._projectionUtility.latLngToContainerPoint(s),c===0?Config$2.tooltipText2(this._options.language):Config$2.tooltipText1(this._options.language))}}},{key:"_onOutCircle",value:function(s,c,h){var d=select(h);d.classed("base")||(d=this._nodeCircles.select("circle:nth-child(".concat(c+1,")"))),d.attr("r",nodeTargetRadius),this._hideTooltip()}},{key:"_onDragCircle",value:function(){var s=this,c=!1,h=drag().on("drag",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[1];c=!0,s._dragging=!0,select(this).attr("cx",d.x).attr("cy",d.y),s._updateLinePosition.call(s,s._linesBase,Bo,d),s._updateLinePosition.call(s,s._linesAux,Bo,d),s._updateNodeCirclePosition(Bo,d),s._options.showSegmentLength&&s._updateSegmentTextPosition(Bo,d),s._options.showAccumulativeLength&&s._updateNodeTextPosition(Bo,d),s._updateArea(Bo,s._projectionUtility.svgPointToLatLng([d.x,d.y]))});return h.on("start",function(d){d.sourceEvent.stopPropagation(),select(this).raise().attr("r",nodeTargetExpandRadius),s._disableMapScroll()}),h.on("end",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[0],Lo=Co[1];s._enableMapScroll(),c?(s._geometry.updateNode(Lo,s._projectionUtility.svgPointToLatLng([d.x,d.y])),s._showTooltipOnEvent(Lo===0?Config$2.tooltipText2(s._options.language):Config$2.tooltipText1(s._options.language),d)):Lo>0?(s._geometry.removeNode(Lo),select(this).classed("removed-circle",!0)):(s._geometry.addNode(Bo),s._dragged=!0),c=!1,s._dragging=!1,s._overlay.draw()}),h}},{key:"_onDragLine",value:function(){var s=this,c=!1,h=drag().on("drag",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[1];if(s._dragging=!0,!c){c=!0,s._geometry.insertNode(Bo+1,s._projectionUtility.svgPointToLatLng([d.x,d.y]));var Lo=s._lineDrag.selectAll("line").data(s._geometry.lines);Lo.exit().remove(),Lo.enter().append("line").attr("class",getClass("base-line",s._options.invertColor)).attr("x1",function(Uo){return s._projectionUtility.latLngToSvgPoint(Uo[0])[0]}).attr("y1",function(Uo){return s._projectionUtility.latLngToSvgPoint(Uo[0])[1]}).attr("x2",function(Uo){return s._projectionUtility.latLngToSvgPoint(Uo[1])[0]}).attr("y2",function(Uo){return s._projectionUtility.latLngToSvgPoint(Uo[1])[1]}),s._linesBase.selectAll("line").style("display","none"),s._linesAux.selectAll("line").style("display","none"),s._options.showSegmentLength&&s._updateSegmentText(),s._options.showAccumulativeLength&&s._updateNodeText()}s._updateHoverCirclePosition(d.x,d.y),s._updateLinePosition(s._lineDrag,Bo+1,d),s._options.showSegmentLength&&s._updateSegmentTextPosition(Bo+1,d),s._options.showAccumulativeLength&&s._updateNodeTextPosition(Bo+1,d),s._updateArea(Bo+1,s._projectionUtility.svgPointToLatLng([d.x,d.y]))});return h.on("start",function(d){d.sourceEvent.stopPropagation(),s._hoverCircle.select("circle").attr("class",getClass("cover-circle",s._options.invertColor)),s._disableMapScroll()}),h.on("end",function(d,p){var Co=_slicedToArray(p,2),Bo=Co[1];s._enableMapScroll(),c&&(s._geometry.updateNode(Bo+1,s._projectionUtility.svgPointToLatLng([d.x,d.y])),s._hideHoverCircle(),s._overlay.draw(),c=!1,s._showTooltipOnEvent(Config$2.tooltipText1(s._options.language),d)),s._updateArea(Bo+1,s._projectionUtility.svgPointToLatLng([d.x,d.y])),s._hoverCircle.select("circle").attr("class",getClass("grey-circle",s._options.invertColor)),s._linesBase.selectAll("line").style("display","inline"),s._linesAux.selectAll("line").style("display","inline"),s._dragging=!1}),h}},{key:"_updateLinePosition",value:function(s,c,h){c<this._geometry.lines.length&&s.select("line:nth-child(".concat(c+1,")")).attr("x1",h.x).attr("y1",h.y),c>0&&s.select("line:nth-child(".concat(c,")")).attr("x2",h.x).attr("y2",h.y)}},{key:"_updateSegmentTextPosition",value:function(s,c){var h=this;s<this._geometry.lines.length&&this._segmentText.select("text:nth-child(".concat(s+1,")")).attr("transform",function(d){var p=[c.x,c.y],Co=h._projectionUtility.latLngToSvgPoint(d[1]);return Helper.transformText(p,Co)}).text(function(d){return h._helper.formatLength(h._helper.computeLengthBetween(h._projectionUtility.svgPointToLatLng([c.x,c.y]),d[1]))}),s>0&&this._segmentText.select("text:nth-child(".concat(s,")")).attr("transform",function(d){var p=h._projectionUtility.latLngToSvgPoint(d[0]),Co=[c.x,c.y];return Helper.transformText(p,Co)}).text(function(d){return h._helper.formatLength(h._helper.computeLengthBetween(d[0],h._projectionUtility.svgPointToLatLng([c.x,c.y])))})}},{key:"_updateNodeTextPosition",value:function(s,c){var h=this;this._nodeText.select("text:nth-child(".concat(s+1,")")).attr("x",c.x).attr("y",function(){var p;return s>0&&h._projectionUtility.latLngToSvgPoint(h._geometry.nodes[s-1])[1]<c.y?p=23:p=-7,c.y+p}),this._nodeText.select("text:nth-child(".concat(s+2,")")).attr("y",function(p){var Co;return s+1>0&&c.y<h._projectionUtility.latLngToSvgPoint(p)[1]?Co=23:Co=-7,h._projectionUtility.latLngToSvgPoint(p)[1]+Co});var d=this._nodeText.selectAll("text").filter(function(p,Co){return Co>=s});d.text(function(p,Co){var Bo=h._helper.computePathLength([].concat(_toConsumableArray(h._geometry.nodes.slice(0,s)),[h._projectionUtility.svgPointToLatLng([c.x,c.y])],_toConsumableArray(h._geometry.nodes.slice(s+1,s+1+Co))));return s+Co===h._geometry.nodes.length-1&&(h._length=Bo),h._helper.formatLength(Bo)})}},{key:"_updateNodeCirclePosition",value:function(s,c){this._nodeCircles.select("circle:nth-child(".concat(s+1,")")).attr("cx",c.x).attr("cy",c.y)}},{key:"_updateHoverCirclePosition",value:function(s,c){this._hoverCircle.select("circle").attr("cx",s).attr("cy",c),!this._dragging&&this._options.tooltip&&this._tooltip.show(this._projectionUtility.svgPointToContainerPoint([s,c]),Config$2.tooltipText2(this._options.language))}},{key:"_hideHoverCircle",value:function(){this._hoverCircle.select("circle").attr("cx",null).attr("cy",null),this._hideTooltip()}},{key:"_disableMapScroll",value:function(){this._zoomControl=!!document.querySelector("button[aria-label='Zoom in']"),this._map.setOptions({scrollwheel:!1,gestureHandling:"none",zoomControl:!1})}},{key:"_enableMapScroll",value:function(){this._map.setOptions({scrollwheel:!0,gestureHandling:"auto",zoomControl:this._zoomControl})}},{key:"_transformNodeTextY",value:function(s,c){var h;return c>0&&this._geometry.nodes[c-1][1]>s[1]?h=23:h=-7,this._projectionUtility.latLngToSvgPoint(s)[1]+h}},{key:"_updateArea",value:function(s,c){if(!!this._geometry){var h=this._geometry.nodes.length,d=1/80*this.length,p,Co=0;h>2&&(s===0?(p=this._helper.computeLengthBetween(this._geometry.nodes[h-1],c),Co=p>d?0:this._helper.computeArea([c].concat(_toConsumableArray(this._geometry.nodes.slice(1,h-1))))):s===h-1?(p=this._helper.computeLengthBetween(c,this._geometry.nodes[0]),Co=p>d?0:this._helper.computeArea(this._geometry.nodes.slice(0,h-1))):s>0&&s<h-1?(p=this._helper.computeLengthBetween(this._geometry.nodes[0],this._geometry.nodes[h-1]),Co=p>d?0:this._helper.computeArea([].concat(_toConsumableArray(this._geometry.nodes.slice(0,s)),[c],_toConsumableArray(this._geometry.nodes.slice(s+1))))):(p=this._helper.computeLengthBetween(this._geometry.nodes[0],this._geometry.nodes[h-1]),Co=p>d?0:this._helper.computeArea(this._geometry.nodes))),this._area=Co,Co>0&&this._nodeText.select(":last-child").text("Total distance: ".concat(this.lengthText,"; Total area: ").concat(this.areaText,"."))}}},{key:"_showTooltipOnEvent",value:function(s,c){c.sourceEvent.type.startsWith("touch")||this._options.tooltip&&this._tooltip.show(this._projectionUtility.svgPointToContainerPoint([c.x,c.y]),s)}},{key:"_hideTooltip",value:function(){this._options.tooltip&&this._tooltip.hide()}},{key:"_dispatchMeasureEvent",value:function(){if(!!this._started){var s=this._getResults();this._lastMeasure&&this._lastMeasure.result.lengthText===this.lengthText&&this._lastMeasure.result.areaText===this.areaText||typeof this._events.get(EVENT_CHANGE)=="function"&&this._events.get(EVENT_CHANGE)(this._lastMeasure=s)}}},{key:"_updateSegment",value:function(s){var c=this._helper.computeLengthBetween(s[0],s[1]),h=this._helper.formatLength(c);this._segments.push(new Segment(s[0],s[1],c,h).toJSON())}},{key:"_getResults",value:function(){return{result:{length:this.length,lengthText:this.lengthText,area:this.area,areaText:this.areaText,segments:this.segments,points:this.points}}}}],[{key:"_initPolyfills",value:function(){ObjectAssign()}}]),l}();let mapsAPIKey="AIzaSyD_3Zs4G0iv3_teiE-cPMPEF4lotqiZPqU";const georefMatchMap_svelte_svelte_type_style_lang="";function create_fragment$K(l){let o;return{c(){o=element("div"),attr(o,"class","mapview svelte-aritcu")},m(s,c){insert(s,o,c),l[5](o)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o),l[5](null)}}}function instance$J(l,o,s){let c;component_subscribe(l,dataStore,Yo=>s(4,c=Yo));const h=createEventDispatcher();let{pastedDecimalCoords:d}=o,p,Co,Bo,Lo=!1,Uo,Qo=!0;const Po=Yo=>!!(window.google&&typeof window.google=="object"&&window.google.maps&&typeof window.google.maps=="object"&&window.google.maps.Map&&typeof window.google.maps.Map=="function");onMount(async Yo=>{Po()||await new Loader({apiKey:mapsAPIKey,version:"weekly",libraries:["geometry"]}).load(),s(2,Co=new google.maps.Map(p,{zoom:5,center:{lat:-24.321476,lng:24.909317},disableDoubleClickZoom:!0}));const ss=document.createElement("div"),cs=document.createElement("div");cs.style.backgroundColor="#fff",cs.style.border="2px solid #fff",cs.style.borderRadius="3px",cs.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",cs.style.cursor="pointer",cs.style.margin="10px",cs.style.textAlign="center",cs.title="Click to toggle uncertainty circles",ss.appendChild(cs);const as=document.createElement("div");as.style.color="rgb(25,25,25)",as.style.fontFamily="Roboto,Arial,sans-serif",as.style.fontSize="16px",as.style.lineHeight="38px",as.style.paddingLeft="5px",as.style.paddingRight="5px",as.innerHTML="Circles",cs.appendChild(as),cs.addEventListener("click",is),Co.controls[google.maps.ControlPosition.TOP_RIGHT].push(ss),new MeasureTool(Co,{showSegmentLength:!1}),Lo=!0,Zo()});const Mo=Yo=>{if(c.georefIndex&&Object.keys(c.georefIndex).length){let ts=new google.maps.LatLngBounds;for(let ss of Object.values(c.georefIndex))if(!ss.ambiguous){let cs=new google.maps.LatLng(ss.decimalLatitude,ss.decimalLongitude);ts.extend(cs)}return ts}else return null},Go=Yo=>{const ts=Mo();ts&&Co.fitBounds(ts)},$o=Yo=>{if(c.markers&&Object.keys(c.markers).length){for(let ts of Object.values(c.markers))ts.circle&&ts.circle.setMap(null),ts.setMap(null);set_store_value(dataStore,c.markers=null,c)}},jo=Yo=>{if(c.georefIndex&&Object.keys(c.georefIndex).length&&Uo!=c.georefIndex){Qo=!0;for(let[ts,ss]of Object.entries(c.georefIndex)){if(ss.ambiguous)continue;let cs;try{cs=es(ss,Co,Qo)}catch(as){console.log(`error creating marker for ${ts}:`,as.message);continue}c.markers||set_store_value(dataStore,c.markers={},c),set_store_value(dataStore,c.markers[ts]=cs,c)}Uo=c.georefIndex,Go()}},zo=Yo=>{const ss=Mo().getCenter();s(3,Bo=new google.maps.Marker({position:ss,map:Co,draggable:!0,title:"Use for coordinates"})),google.maps.event.addListener(Bo,"dragend",function(cs){let as=cs.latLng.toUrlValue();navigator.clipboard.writeText(as).then(us=>{window.pushToast&&window.pushToast("coordinates copied")})}),google.maps.event.addListener(Co,"dblclick",function(cs){var as=cs.latLng;Bo.setPosition(as);let us=as.toUrlValue();navigator.clipboard.writeText(us),Co.panTo(as),window.pushToast&&window.pushToast("coordinates copied")})},Xo=Yo=>{if(Bo){const ss=Mo().getCenter();Bo.setPosition(ss),navigator&&navigator.clipboard&&navigator.clipboard.writeText("")}},Zo=Yo=>{Lo&&c.georefIndex&&Object.keys(c.georefIndex).length&&Uo!=c.georefIndex&&($o(),jo(),Go(),Bo?Xo():zo())},Wo=Yo=>{if(c.georefIndex&&Object.keys(c.georefIndex).length&&Uo==c.georefIndex){for(let[ts,ss]of Object.entries(c.georefIndex))if(!ss.ambiguous)if(c.markers){if(!c.markers.hasOwnProperty(ts)){let cs=es(ss,Co,Qo);set_store_value(dataStore,c.markers[ts]=cs,c)}}else{let cs=es(ss,Co,Qo);set_store_value(dataStore,c.markers={},c),set_store_value(dataStore,c.markers[ts]=cs,c)}for(let[ts,ss]of Object.entries(c.markers))c.georefIndex.hasOwnProperty(ts)||(ss.circle.setMap(null),ss.setMap(null),delete c.markers[ts])}},es=(Yo,ts,ss)=>{if(!Yo)throw new Error("georef is null");let cs=new google.maps.LatLng(Yo.decimalLatitude,Yo.decimalLongitude),as=new google.maps.Marker({position:cs,map:ts,icon:{path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"green",fillOpacity:1,strokeColor:"green"},zIndex:0}),us=Jo(Yo.uncertainty,Yo.uncertaintyUnit);if(us){let gs=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.2,center:cs,map:ts,radius:us,clickable:!1,visible:ss});as.circle=gs,google.maps.event.addListener(gs,"dblclick",function(Is){google.maps.event.trigger(ts,"dblclick",Is)})}return as.addListener("click",gs=>{h("georef-selected",Yo.georefID)}),as.panToMe=gs=>{ts.panTo(as.getPosition())},as},is=Yo=>{if(c.markers&&Object.keys(c.markers).length)if(Qo){for(let ts of Object.values(c.markers))ts.circle&&ts.circle.setVisible(!1);Qo=!1}else{for(let ts of Object.values(c.markers))ts.circle&&ts.circle.setVisible(!0);Qo=!0}},Jo=(Yo,ts)=>!isNaN(Yo)&&Yo>0&&ts&&ts.trim()&&["m","km","mi"].includes(ts.toLowerCase())?(ts=ts.trim().toLowerCase(),ts=="m"?Yo:ts=="km"?Yo*1e3:Number((Yo*1.60934*1e3).toFixed(2))):0;function Ko(Yo){binding_callbacks[Yo?"unshift":"push"](()=>{p=Yo,s(0,p)})}return l.$$set=Yo=>{"pastedDecimalCoords"in Yo&&s(1,d=Yo.pastedDecimalCoords)},l.$$.update=()=>{if(l.$$.dirty&16&&(c.georefIndex,Zo(),Wo()),l.$$.dirty&14&&Co&&Bo&&d){let Yo=d.split(",").map(ss=>Number(ss)),ts={lat:Yo[0],lng:Yo[1]};Bo.setPosition(ts),Co.panTo(ts)}},[p,d,Co,Bo,c,Ko]}class GeorefMatchMap extends SvelteComponent{constructor(o){super(),init(this,o,instance$J,create_fragment$K,safe_not_equal,{pastedDecimalCoords:1})}}function isOutOfViewport(l){const o=l.getBoundingClientRect(),s={};return s.top=o.top<0,s.left=o.left<0,s.bottom=o.bottom>(window.innerHeight||document.documentElement.clientHeight),s.right=o.right>(window.innerWidth||document.documentElement.clientWidth),s.any=s.top||s.left||s.bottom||s.right,s}const Item_svelte_svelte_type_style_lang="";function create_fragment$J(l){let o,s=l[0](l[1],l[2])+"",c;return{c(){o=element("div"),attr(o,"class",c="item "+l[3]+" svelte-u0t2tk")},m(h,d){insert(h,o,d),o.innerHTML=s},p(h,[d]){d&7&&s!==(s=h[0](h[1],h[2])+"")&&(o.innerHTML=s),d&8&&c!==(c="item "+h[3]+" svelte-u0t2tk")&&attr(o,"class",c)},i:noop$2,o:noop$2,d(h){h&&detach(o)}}}function instance$I(l,o,s){let{isActive:c=!1}=o,{isFirst:h=!1}=o,{isHover:d=!1}=o,{getOptionLabel:p=void 0}=o,{item:Co=void 0}=o,{filterText:Bo=""}=o,Lo="";return l.$$set=Uo=>{"isActive"in Uo&&s(4,c=Uo.isActive),"isFirst"in Uo&&s(5,h=Uo.isFirst),"isHover"in Uo&&s(6,d=Uo.isHover),"getOptionLabel"in Uo&&s(0,p=Uo.getOptionLabel),"item"in Uo&&s(1,Co=Uo.item),"filterText"in Uo&&s(2,Bo=Uo.filterText)},l.$$.update=()=>{if(l.$$.dirty&114){const Uo=[];c&&Uo.push("active"),h&&Uo.push("first"),d&&Uo.push("hover"),Co.isGroupHeader&&Uo.push("groupHeader"),Co.isGroupItem&&Uo.push("groupItem"),s(3,Lo=Uo.join(" "))}},[p,Co,Bo,Lo,c,h,d]}class Item extends SvelteComponent{constructor(o){super(),init(this,o,instance$I,create_fragment$J,safe_not_equal,{isActive:4,isFirst:5,isHover:6,getOptionLabel:0,item:1,filterText:2})}}const List_svelte_svelte_type_style_lang="";function get_each_context$d(l,o,s){const c=l.slice();return c[41]=o[s],c[42]=s,c}function create_else_block$j(l){let o,s,c=l[1],h=[];for(let Co=0;Co<c.length;Co+=1)h[Co]=create_each_block$d(get_each_context$d(l,c,Co));const d=Co=>transition_out(h[Co],1,1,()=>{h[Co]=null});let p=null;return c.length||(p=create_else_block_2$8(l)),{c(){for(let Co=0;Co<h.length;Co+=1)h[Co].c();o=empty$1(),p&&p.c()},m(Co,Bo){for(let Lo=0;Lo<h.length;Lo+=1)h[Lo].m(Co,Bo);insert(Co,o,Bo),p&&p.m(Co,Bo),s=!0},p(Co,Bo){if(Bo[0]&114390){c=Co[1];let Lo;for(Lo=0;Lo<c.length;Lo+=1){const Uo=get_each_context$d(Co,c,Lo);h[Lo]?(h[Lo].p(Uo,Bo),transition_in(h[Lo],1)):(h[Lo]=create_each_block$d(Uo),h[Lo].c(),transition_in(h[Lo],1),h[Lo].m(o.parentNode,o))}for(group_outros(),Lo=c.length;Lo<h.length;Lo+=1)d(Lo);check_outros(),!c.length&&p?p.p(Co,Bo):c.length?p&&(p.d(1),p=null):(p=create_else_block_2$8(Co),p.c(),p.m(o.parentNode,o))}},i(Co){if(!s){for(let Bo=0;Bo<c.length;Bo+=1)transition_in(h[Bo]);s=!0}},o(Co){h=h.filter(Boolean);for(let Bo=0;Bo<h.length;Bo+=1)transition_out(h[Bo]);s=!1},d(Co){destroy_each(h,Co),Co&&detach(o),p&&p.d(Co)}}}function create_if_block$o(l){let o,s,c;var h=l[3];function d(p){return{props:{items:p[1],itemHeight:p[8],$$slots:{default:[create_default_slot$2,({item:Co,i:Bo})=>({41:Co,42:Bo}),({item:Co,i:Bo})=>[0,(Co?1024:0)|(Bo?2048:0)]]},$$scope:{ctx:p}}}}return h&&(o=new h(d(l))),{c(){o&&create_component(o.$$.fragment),s=empty$1()},m(p,Co){o&&mount_component(o,p,Co),insert(p,s,Co),c=!0},p(p,Co){const Bo={};if(Co[0]&2&&(Bo.items=p[1]),Co[0]&256&&(Bo.itemHeight=p[8]),Co[0]&9814|Co[1]&11264&&(Bo.$$scope={dirty:Co,ctx:p}),h!==(h=p[3])){if(o){group_outros();const Lo=o;transition_out(Lo.$$.fragment,1,0,()=>{destroy_component(Lo,1)}),check_outros()}h?(o=new h(d(p)),create_component(o.$$.fragment),transition_in(o.$$.fragment,1),mount_component(o,s.parentNode,s)):o=null}else h&&o.$set(Bo)},i(p){c||(o&&transition_in(o.$$.fragment,p),c=!0)},o(p){o&&transition_out(o.$$.fragment,p),c=!1},d(p){p&&detach(s),o&&destroy_component(o,p)}}}function create_else_block_2$8(l){let o,s=!l[11]&&create_if_block_2$d(l);return{c(){s&&s.c(),o=empty$1()},m(c,h){s&&s.m(c,h),insert(c,o,h)},p(c,h){c[11]?s&&(s.d(1),s=null):s?s.p(c,h):(s=create_if_block_2$d(c),s.c(),s.m(o.parentNode,o))},d(c){s&&s.d(c),c&&detach(o)}}}function create_if_block_2$d(l){let o,s;return{c(){o=element("div"),s=text(l[12]),attr(o,"class","empty svelte-1uyqfml")},m(c,h){insert(c,o,h),append(o,s)},p(c,h){h[0]&4096&&set_data(s,c[12])},d(c){c&&detach(o)}}}function create_else_block_1$a(l){let o,s,c,h,d,p;var Co=l[4];function Bo(Po){return{props:{item:Po[41],filterText:Po[13],getOptionLabel:Po[6],isFirst:isItemFirst(Po[42]),isActive:isItemActive(Po[41],Po[9],Po[10]),isHover:isItemHover(Po[2],Po[41],Po[42],Po[1])}}}Co&&(s=new Co(Bo(l)));function Lo(){return l[29](l[42])}function Uo(){return l[30](l[42])}function Qo(...Po){return l[31](l[41],l[42],...Po)}return{c(){o=element("div"),s&&create_component(s.$$.fragment),c=space(),attr(o,"class","listItem"),attr(o,"tabindex","-1")},m(Po,Mo){insert(Po,o,Mo),s&&mount_component(s,o,null),append(o,c),h=!0,d||(p=[listen(o,"mouseover",Lo),listen(o,"focus",Uo),listen(o,"click",Qo)],d=!0)},p(Po,Mo){l=Po;const Go={};if(Mo[0]&2&&(Go.item=l[41]),Mo[0]&8192&&(Go.filterText=l[13]),Mo[0]&64&&(Go.getOptionLabel=l[6]),Mo[0]&1538&&(Go.isActive=isItemActive(l[41],l[9],l[10])),Mo[0]&6&&(Go.isHover=isItemHover(l[2],l[41],l[42],l[1])),Co!==(Co=l[4])){if(s){group_outros();const $o=s;transition_out($o.$$.fragment,1,0,()=>{destroy_component($o,1)}),check_outros()}Co?(s=new Co(Bo(l)),create_component(s.$$.fragment),transition_in(s.$$.fragment,1),mount_component(s,o,c)):s=null}else Co&&s.$set(Go)},i(Po){h||(s&&transition_in(s.$$.fragment,Po),h=!0)},o(Po){s&&transition_out(s.$$.fragment,Po),h=!1},d(Po){Po&&detach(o),s&&destroy_component(s),d=!1,run_all(p)}}}function create_if_block_1$g(l){let o,s=l[7](l[41])+"",c;return{c(){o=element("div"),c=text(s),attr(o,"class","listGroupTitle svelte-1uyqfml")},m(h,d){insert(h,o,d),append(o,c)},p(h,d){d[0]&130&&s!==(s=h[7](h[41])+"")&&set_data(c,s)},i:noop$2,o:noop$2,d(h){h&&detach(o)}}}function create_each_block$d(l){let o,s,c,h;const d=[create_if_block_1$g,create_else_block_1$a],p=[];function Co(Bo,Lo){return Bo[41].isGroupHeader&&!Bo[41].isSelectable?0:1}return o=Co(l),s=p[o]=d[o](l),{c(){s.c(),c=empty$1()},m(Bo,Lo){p[o].m(Bo,Lo),insert(Bo,c,Lo),h=!0},p(Bo,Lo){let Uo=o;o=Co(Bo),o===Uo?p[o].p(Bo,Lo):(group_outros(),transition_out(p[Uo],1,1,()=>{p[Uo]=null}),check_outros(),s=p[o],s?s.p(Bo,Lo):(s=p[o]=d[o](Bo),s.c()),transition_in(s,1),s.m(c.parentNode,c))},i(Bo){h||(transition_in(s),h=!0)},o(Bo){transition_out(s),h=!1},d(Bo){p[o].d(Bo),Bo&&detach(c)}}}function create_default_slot$2(l){let o,s,c,h,d;var p=l[4];function Co(Qo){return{props:{item:Qo[41],filterText:Qo[13],getOptionLabel:Qo[6],isFirst:isItemFirst(Qo[42]),isActive:isItemActive(Qo[41],Qo[9],Qo[10]),isHover:isItemHover(Qo[2],Qo[41],Qo[42],Qo[1])}}}p&&(s=new p(Co(l)));function Bo(){return l[26](l[42])}function Lo(){return l[27](l[42])}function Uo(...Qo){return l[28](l[41],l[42],...Qo)}return{c(){o=element("div"),s&&create_component(s.$$.fragment),attr(o,"class","listItem")},m(Qo,Po){insert(Qo,o,Po),s&&mount_component(s,o,null),c=!0,h||(d=[listen(o,"mouseover",Bo),listen(o,"focus",Lo),listen(o,"click",Uo)],h=!0)},p(Qo,Po){l=Qo;const Mo={};if(Po[1]&1024&&(Mo.item=l[41]),Po[0]&8192&&(Mo.filterText=l[13]),Po[0]&64&&(Mo.getOptionLabel=l[6]),Po[1]&2048&&(Mo.isFirst=isItemFirst(l[42])),Po[0]&1536|Po[1]&1024&&(Mo.isActive=isItemActive(l[41],l[9],l[10])),Po[0]&6|Po[1]&3072&&(Mo.isHover=isItemHover(l[2],l[41],l[42],l[1])),p!==(p=l[4])){if(s){group_outros();const Go=s;transition_out(Go.$$.fragment,1,0,()=>{destroy_component(Go,1)}),check_outros()}p?(s=new p(Co(l)),create_component(s.$$.fragment),transition_in(s.$$.fragment,1),mount_component(s,o,null)):s=null}else p&&s.$set(Mo)},i(Qo){c||(s&&transition_in(s.$$.fragment,Qo),c=!0)},o(Qo){s&&transition_out(s.$$.fragment,Qo),c=!1},d(Qo){Qo&&detach(o),s&&destroy_component(s),h=!1,run_all(d)}}}function create_fragment$I(l){let o,s,c,h,d,p;const Co=[create_if_block$o,create_else_block$j],Bo=[];function Lo(Uo,Qo){return Uo[5]?0:1}return s=Lo(l),c=Bo[s]=Co[s](l),{c(){o=element("div"),c.c(),attr(o,"class","listContainer svelte-1uyqfml"),attr(o,"style",l[14]),toggle_class(o,"virtualList",l[5])},m(Uo,Qo){insert(Uo,o,Qo),Bo[s].m(o,null),l[32](o),h=!0,d||(p=[listen(window,"keydown",l[17]),listen(window,"resize",l[18])],d=!0)},p(Uo,Qo){let Po=s;s=Lo(Uo),s===Po?Bo[s].p(Uo,Qo):(group_outros(),transition_out(Bo[Po],1,1,()=>{Bo[Po]=null}),check_outros(),c=Bo[s],c?c.p(Uo,Qo):(c=Bo[s]=Co[s](Uo),c.c()),transition_in(c,1),c.m(o,null)),(!h||Qo[0]&16384)&&attr(o,"style",Uo[14]),Qo[0]&32&&toggle_class(o,"virtualList",Uo[5])},i(Uo){h||(transition_in(c),h=!0)},o(Uo){transition_out(c),h=!1},d(Uo){Uo&&detach(o),Bo[s].d(),l[32](null),d=!1,run_all(p)}}}function isItemActive(l,o,s){return o&&o[s]===l[s]}function isItemFirst(l){return l===0}function isItemHover(l,o,s,c){return l===s||c.length===1}function instance$H(l,o,s){const c=createEventDispatcher();let{container:h=void 0}=o,{VirtualList:d=null}=o,{Item:p=Item}=o,{isVirtualList:Co=!1}=o,{items:Bo=[]}=o,{labelIdentifier:Lo="label"}=o,{getOptionLabel:Uo=(Ss,Us)=>{if(Ss)return Ss.isCreator?`Create "${Us}"`:Ss[Lo]}}=o,{getGroupHeaderLabel:Qo=null}=o,{itemHeight:Po=40}=o,{hoverItemIndex:Mo=0}=o,{value:Go=void 0}=o,{optionIdentifier:$o="value"}=o,{hideEmptyState:jo=!1}=o,{noOptionsMessage:zo="No options"}=o,{isMulti:Xo=!1}=o,{activeItemIndex:Zo=0}=o,{filterText:Wo=""}=o,{parent:es=null}=o,{listPlacement:is=null}=o,{listAutoWidth:Jo=null}=o,{listOffset:Ko=5}=o,Yo=0,ts=!1,ss;onMount(()=>{if(Bo.length>0&&!Xo&&Go){const Ss=Bo.findIndex(Us=>Us[$o]===Go[$o]);Ss&&s(2,Mo=Ss)}Hs("active"),h.addEventListener("scroll",()=>{clearTimeout(Yo),Yo=setTimeout(()=>{ts=!1},100)},!1)}),beforeUpdate(()=>{Bo||s(1,Bo=[]),Bo!==ss&&Bo.length>0&&s(2,Mo=0),ss=Bo});function cs(Ss){Ss.isCreator||c("itemSelected",Ss)}function as(Ss){ts||s(2,Mo=Ss)}function us(Ss){const{item:Us,i:Ps,event:Qs}=Ss;if(Qs.stopPropagation(),Go&&!Xo&&Go[$o]===Us[$o])return gs();Us.isCreator?c("itemCreated",Wo):(s(19,Zo=Ps),s(2,Mo=Ps),cs(Us))}function gs(){c("closeList")}async function Is(Ss){if(Co)return;let Us=!0;for(;Us;)Ss>0&&Mo===Bo.length-1?s(2,Mo=0):Ss<0&&Mo===0?s(2,Mo=Bo.length-1):s(2,Mo=Mo+Ss),Us=Bo[Mo].isGroupHeader&&!Bo[Mo].isSelectable;await tick(),Hs("hover")}function _s(Ss){switch(Ss.key){case"Escape":Ss.preventDefault(),gs();break;case"ArrowDown":Ss.preventDefault(),Bo.length&&Is(1);break;case"ArrowUp":Ss.preventDefault(),Bo.length&&Is(-1);break;case"Enter":if(Ss.preventDefault(),Bo.length===0)break;const Us=Bo[Mo];if(Go&&!Xo&&Go[$o]===Us[$o]){gs();break}Us.isCreator?c("itemCreated",Wo):(s(19,Zo=Mo),cs(Bo[Mo]));break;case"Tab":if(Ss.preventDefault(),Bo.length===0||Go&&Go[$o]===Bo[Mo][$o])return gs();s(19,Zo=Mo),cs(Bo[Mo]);break}}function Hs(Ss){if(Co||!h)return;let Us;const Ps=h.querySelector(`.listItem .${Ss}`);Ps&&(Us=h.getBoundingClientRect().bottom-Ps.getBoundingClientRect().bottom),s(0,h.scrollTop-=Us,h)}let ds;function hs(){const{top:Ss,height:Us,width:Ps}=es.getBoundingClientRect();s(14,ds=""),s(14,ds+=`min-width:${Ps}px;width:${Jo?"auto":"100%"};`),is==="top"||is==="auto"&&isOutOfViewport(es).bottom?s(14,ds+=`bottom:${Us+Ko}px;`):s(14,ds+=`top:${Us+Ko}px;`)}const ys=Ss=>as(Ss),ms=Ss=>as(Ss),Rs=(Ss,Us,Ps)=>us({item:Ss,i:Us,event:Ps}),bs=Ss=>as(Ss),ps=Ss=>as(Ss),ks=(Ss,Us,Ps)=>us({item:Ss,i:Us,event:Ps});function xs(Ss){binding_callbacks[Ss?"unshift":"push"](()=>{h=Ss,s(0,h)})}return l.$$set=Ss=>{"container"in Ss&&s(0,h=Ss.container),"VirtualList"in Ss&&s(3,d=Ss.VirtualList),"Item"in Ss&&s(4,p=Ss.Item),"isVirtualList"in Ss&&s(5,Co=Ss.isVirtualList),"items"in Ss&&s(1,Bo=Ss.items),"labelIdentifier"in Ss&&s(20,Lo=Ss.labelIdentifier),"getOptionLabel"in Ss&&s(6,Uo=Ss.getOptionLabel),"getGroupHeaderLabel"in Ss&&s(7,Qo=Ss.getGroupHeaderLabel),"itemHeight"in Ss&&s(8,Po=Ss.itemHeight),"hoverItemIndex"in Ss&&s(2,Mo=Ss.hoverItemIndex),"value"in Ss&&s(9,Go=Ss.value),"optionIdentifier"in Ss&&s(10,$o=Ss.optionIdentifier),"hideEmptyState"in Ss&&s(11,jo=Ss.hideEmptyState),"noOptionsMessage"in Ss&&s(12,zo=Ss.noOptionsMessage),"isMulti"in Ss&&s(21,Xo=Ss.isMulti),"activeItemIndex"in Ss&&s(19,Zo=Ss.activeItemIndex),"filterText"in Ss&&s(13,Wo=Ss.filterText),"parent"in Ss&&s(22,es=Ss.parent),"listPlacement"in Ss&&s(23,is=Ss.listPlacement),"listAutoWidth"in Ss&&s(24,Jo=Ss.listAutoWidth),"listOffset"in Ss&&s(25,Ko=Ss.listOffset)},l.$$.update=()=>{l.$$.dirty[0]&4194305&&es&&h&&hs()},[h,Bo,Mo,d,p,Co,Uo,Qo,Po,Go,$o,jo,zo,Wo,ds,as,us,_s,hs,Zo,Lo,Xo,es,is,Jo,Ko,ys,ms,Rs,bs,ps,ks,xs]}class List extends SvelteComponent{constructor(o){super(),init(this,o,instance$H,create_fragment$I,safe_not_equal,{container:0,VirtualList:3,Item:4,isVirtualList:5,items:1,labelIdentifier:20,getOptionLabel:6,getGroupHeaderLabel:7,itemHeight:8,hoverItemIndex:2,value:9,optionIdentifier:10,hideEmptyState:11,noOptionsMessage:12,isMulti:21,activeItemIndex:19,filterText:13,parent:22,listPlacement:23,listAutoWidth:24,listOffset:25},null,[-1,-1])}}const Selection_svelte_svelte_type_style_lang="";function create_fragment$H(l){let o,s=l[0](l[1])+"";return{c(){o=element("div"),attr(o,"class","selection svelte-pu1q1n")},m(c,h){insert(c,o,h),o.innerHTML=s},p(c,[h]){h&3&&s!==(s=c[0](c[1])+"")&&(o.innerHTML=s)},i:noop$2,o:noop$2,d(c){c&&detach(o)}}}function instance$G(l,o,s){let{getSelectionLabel:c=void 0}=o,{item:h=void 0}=o;return l.$$set=d=>{"getSelectionLabel"in d&&s(0,c=d.getSelectionLabel),"item"in d&&s(1,h=d.item)},[c,h]}class Selection extends SvelteComponent{constructor(o){super(),init(this,o,instance$G,create_fragment$H,safe_not_equal,{getSelectionLabel:0,item:1})}}const MultiSelection_svelte_svelte_type_style_lang="";function get_each_context$c(l,o,s){const c=l.slice();return c[9]=o[s],c[11]=s,c}function create_if_block$n(l){let o,s,c;function h(...d){return l[6](l[11],...d)}return{c(){o=element("div"),o.innerHTML='<svg width="100%" height="100%" viewBox="-2 -2 50 50" focusable="false" aria-hidden="true" role="presentation" class="svelte-liu9pa"><path d="M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124 l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z"></path></svg>',attr(o,"class","multiSelectItem_clear svelte-liu9pa")},m(d,p){insert(d,o,p),s||(c=listen(o,"click",h),s=!0)},p(d,p){l=d},d(d){d&&detach(o),s=!1,c()}}}function create_each_block$c(l){let o,s,c=l[4](l[9])+"",h,d,p,Co,Bo,Lo=!l[2]&&!l[3]&&create_if_block$n(l);function Uo(...Qo){return l[7](l[11],...Qo)}return{c(){o=element("div"),s=element("div"),h=space(),Lo&&Lo.c(),d=space(),attr(s,"class","multiSelectItem_label svelte-liu9pa"),attr(o,"class",p="multiSelectItem "+(l[1]===l[11]?"active":"")+" "+(l[2]?"disabled":"")+" svelte-liu9pa")},m(Qo,Po){insert(Qo,o,Po),append(o,s),s.innerHTML=c,append(o,h),Lo&&Lo.m(o,null),append(o,d),Co||(Bo=listen(o,"click",Uo),Co=!0)},p(Qo,Po){l=Qo,Po&17&&c!==(c=l[4](l[9])+"")&&(s.innerHTML=c),!l[2]&&!l[3]?Lo?Lo.p(l,Po):(Lo=create_if_block$n(l),Lo.c(),Lo.m(o,d)):Lo&&(Lo.d(1),Lo=null),Po&6&&p!==(p="multiSelectItem "+(l[1]===l[11]?"active":"")+" "+(l[2]?"disabled":"")+" svelte-liu9pa")&&attr(o,"class",p)},d(Qo){Qo&&detach(o),Lo&&Lo.d(),Co=!1,Bo()}}}function create_fragment$G(l){let o,s=l[0],c=[];for(let h=0;h<s.length;h+=1)c[h]=create_each_block$c(get_each_context$c(l,s,h));return{c(){for(let h=0;h<c.length;h+=1)c[h].c();o=empty$1()},m(h,d){for(let p=0;p<c.length;p+=1)c[p].m(h,d);insert(h,o,d)},p(h,[d]){if(d&63){s=h[0];let p;for(p=0;p<s.length;p+=1){const Co=get_each_context$c(h,s,p);c[p]?c[p].p(Co,d):(c[p]=create_each_block$c(Co),c[p].c(),c[p].m(o.parentNode,o))}for(;p<c.length;p+=1)c[p].d(1);c.length=s.length}},i:noop$2,o:noop$2,d(h){destroy_each(c,h),h&&detach(o)}}}function instance$F(l,o,s){const c=createEventDispatcher();let{value:h=[]}=o,{activeValue:d=void 0}=o,{isDisabled:p=!1}=o,{multiFullItemClearable:Co=!1}=o,{getSelectionLabel:Bo=void 0}=o;function Lo(Po,Mo){Mo.stopPropagation(),c("multiItemClear",{i:Po})}const Uo=(Po,Mo)=>Lo(Po,Mo),Qo=(Po,Mo)=>Co?Lo(Po,Mo):{};return l.$$set=Po=>{"value"in Po&&s(0,h=Po.value),"activeValue"in Po&&s(1,d=Po.activeValue),"isDisabled"in Po&&s(2,p=Po.isDisabled),"multiFullItemClearable"in Po&&s(3,Co=Po.multiFullItemClearable),"getSelectionLabel"in Po&&s(4,Bo=Po.getSelectionLabel)},[h,d,p,Co,Bo,Lo,Uo,Qo]}class MultiSelection extends SvelteComponent{constructor(o){super(),init(this,o,instance$F,create_fragment$G,safe_not_equal,{value:0,activeValue:1,isDisabled:2,multiFullItemClearable:3,getSelectionLabel:4})}}const VirtualList_svelte_svelte_type_style_lang="";function get_each_context$b(l,o,s){const c=l.slice();return c[23]=o[s],c}const get_default_slot_changes$2=l=>({item:l&32,i:l&32,hoverItemIndex:l&2}),get_default_slot_context$2=l=>({item:l[23].data,i:l[23].index,hoverItemIndex:l[1]});function fallback_block$1(l){let o;return{c(){o=text("Missing template")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_each_block$b(l,o){let s,c,h;const d=o[15].default,p=create_slot(d,o,o[14],get_default_slot_context$2),Co=p||fallback_block$1();return{key:l,first:null,c(){s=element("svelte-virtual-list-row"),Co&&Co.c(),c=space(),set_custom_element_data(s,"class","svelte-g2cagw"),this.first=s},m(Bo,Lo){insert(Bo,s,Lo),Co&&Co.m(s,null),append(s,c),h=!0},p(Bo,Lo){o=Bo,p&&p.p&&(!h||Lo&16418)&&update_slot_base(p,d,o,o[14],h?get_slot_changes(d,o[14],Lo,get_default_slot_changes$2):get_all_dirty_from_scope(o[14]),get_default_slot_context$2)},i(Bo){h||(transition_in(Co,Bo),h=!0)},o(Bo){transition_out(Co,Bo),h=!1},d(Bo){Bo&&detach(s),Co&&Co.d(Bo)}}}function create_fragment$F(l){let o,s,c=[],h=new Map,d,p,Co,Bo,Lo=l[5];const Uo=Qo=>Qo[23].index;for(let Qo=0;Qo<Lo.length;Qo+=1){let Po=get_each_context$b(l,Lo,Qo),Mo=Uo(Po);h.set(Mo,c[Qo]=create_each_block$b(Mo,Po))}return{c(){o=element("svelte-virtual-list-viewport"),s=element("svelte-virtual-list-contents");for(let Qo=0;Qo<c.length;Qo+=1)c[Qo].c();set_style(s,"padding-top",l[6]+"px"),set_style(s,"padding-bottom",l[7]+"px"),set_custom_element_data(s,"class","svelte-g2cagw"),set_style(o,"height",l[0]),set_custom_element_data(o,"class","svelte-g2cagw"),add_render_callback(()=>l[18].call(o))},m(Qo,Po){insert(Qo,o,Po),append(o,s);for(let Mo=0;Mo<c.length;Mo+=1)c[Mo].m(s,null);l[16](s),l[17](o),d=add_resize_listener(o,l[18].bind(o)),p=!0,Co||(Bo=listen(o,"scroll",l[8]),Co=!0)},p(Qo,[Po]){Po&16418&&(Lo=Qo[5],group_outros(),c=update_keyed_each(c,Po,Uo,1,Qo,Lo,h,s,outro_and_destroy_block,create_each_block$b,null,get_each_context$b),check_outros()),(!p||Po&64)&&set_style(s,"padding-top",Qo[6]+"px"),(!p||Po&128)&&set_style(s,"padding-bottom",Qo[7]+"px"),(!p||Po&1)&&set_style(o,"height",Qo[0])},i(Qo){if(!p){for(let Po=0;Po<Lo.length;Po+=1)transition_in(c[Po]);p=!0}},o(Qo){for(let Po=0;Po<c.length;Po+=1)transition_out(c[Po]);p=!1},d(Qo){Qo&&detach(o);for(let Po=0;Po<c.length;Po+=1)c[Po].d();l[16](null),l[17](null),d(),Co=!1,Bo()}}}function instance$E(l,o,s){let{$$slots:c={},$$scope:h}=o,{items:d=void 0}=o,{height:p="100%"}=o,{itemHeight:Co=40}=o,{hoverItemIndex:Bo=0}=o,{start:Lo=0}=o,{end:Uo=0}=o,Qo=[],Po,Mo,Go,$o=0,jo,zo,Xo=0,Zo=0,Wo;async function es(ts,ss,cs){const{scrollTop:as}=Mo;await tick();let us=Xo-as,gs=Lo;for(;us<ss&&gs<ts.length;){let _s=Po[gs-Lo];_s||(s(10,Uo=gs+1),await tick(),_s=Po[gs-Lo]),us+=Qo[gs]=cs||_s.offsetHeight,gs+=1}s(10,Uo=gs);const Is=ts.length-Uo;Wo=(Xo+us)/Uo,s(7,Zo=Is*Wo),Qo.length=ts.length,Mo&&s(3,Mo.scrollTop=0,Mo)}async function is(){const{scrollTop:ts}=Mo,ss=Lo;for(let gs=0;gs<Po.length;gs+=1)Qo[Lo+gs]=Co||Po[gs].offsetHeight;let cs=0,as=0;for(;cs<d.length;){const gs=Qo[cs]||Wo;if(as+gs>ts){s(9,Lo=cs),s(6,Xo=as);break}as+=gs,cs+=1}for(;cs<d.length&&(as+=Qo[cs]||Wo,cs+=1,!(as>ts+$o)););s(10,Uo=cs);const us=d.length-Uo;for(Wo=as/Uo;cs<d.length;)Qo[cs++]=Wo;if(s(7,Zo=us*Wo),Lo<ss){await tick();let gs=0,Is=0;for(let Hs=Lo;Hs<ss;Hs+=1)Po[Hs-Lo]&&(gs+=Qo[Hs],Is+=Co||Po[Hs-Lo].offsetHeight);const _s=Is-gs;Mo.scrollTo(0,ts+_s)}}onMount(()=>{Po=Go.getElementsByTagName("svelte-virtual-list-row"),s(13,zo=!0)});function Jo(ts){binding_callbacks[ts?"unshift":"push"](()=>{Go=ts,s(4,Go)})}function Ko(ts){binding_callbacks[ts?"unshift":"push"](()=>{Mo=ts,s(3,Mo)})}function Yo(){$o=this.offsetHeight,s(2,$o)}return l.$$set=ts=>{"items"in ts&&s(11,d=ts.items),"height"in ts&&s(0,p=ts.height),"itemHeight"in ts&&s(12,Co=ts.itemHeight),"hoverItemIndex"in ts&&s(1,Bo=ts.hoverItemIndex),"start"in ts&&s(9,Lo=ts.start),"end"in ts&&s(10,Uo=ts.end),"$$scope"in ts&&s(14,h=ts.$$scope)},l.$$.update=()=>{l.$$.dirty&3584&&s(5,jo=d.slice(Lo,Uo).map((ts,ss)=>({index:ss+Lo,data:ts}))),l.$$.dirty&14340&&zo&&es(d,$o,Co)},[p,Bo,$o,Mo,Go,jo,Xo,Zo,is,Lo,Uo,d,Co,zo,h,c,Jo,Ko,Yo]}class VirtualList extends SvelteComponent{constructor(o){super(),init(this,o,instance$E,create_fragment$F,safe_not_equal,{items:11,height:0,itemHeight:12,hoverItemIndex:1,start:9,end:10})}}function create_fragment$E(l){let o,s;return{c(){o=svg_element("svg"),s=svg_element("path"),attr(s,"fill","currentColor"),attr(s,"d",`M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124
    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z`),attr(o,"width","100%"),attr(o,"height","100%"),attr(o,"viewBox","-2 -2 50 50"),attr(o,"focusable","false"),attr(o,"aria-hidden","true"),attr(o,"role","presentation")},m(c,h){insert(c,o,h),append(o,s)},p:noop$2,i:noop$2,o:noop$2,d(c){c&&detach(o)}}}class ClearIcon extends SvelteComponent{constructor(o){super(),init(this,o,null,create_fragment$E,safe_not_equal,{})}}function debounce$1(l,o,s){let c;return function(){let d=this,p=arguments,Co=function(){c=null,s||l.apply(d,p)},Bo=s&&!c;clearTimeout(c),c=setTimeout(Co,o),Bo&&l.apply(d,p)}}const Select_svelte_svelte_type_style_lang="";function get_each_context$a(l,o,s){const c=l.slice();return c[103]=o[s],c}function create_if_block_10$4(l){let o,s,c,h,d;return{c(){o=element("span"),s=text(l[33]),c=space(),h=element("span"),d=text(l[32]),attr(o,"id","aria-selection"),attr(h,"id","aria-context")},m(p,Co){insert(p,o,Co),append(o,s),insert(p,c,Co),insert(p,h,Co),append(h,d)},p(p,Co){Co[1]&4&&set_data(s,p[33]),Co[1]&2&&set_data(d,p[32])},d(p){p&&detach(o),p&&detach(c),p&&detach(h)}}}function create_if_block_9$5(l){let o,s,c;const h=[l[18]];var d=l[17];function p(Co){let Bo={};for(let Lo=0;Lo<h.length;Lo+=1)Bo=assign(Bo,h[Lo]);return{props:Bo}}return d&&(o=new d(p())),{c(){o&&create_component(o.$$.fragment),s=empty$1()},m(Co,Bo){o&&mount_component(o,Co,Bo),insert(Co,s,Bo),c=!0},p(Co,Bo){const Lo=Bo[0]&262144?get_spread_update(h,[get_spread_object(Co[18])]):{};if(d!==(d=Co[17])){if(o){group_outros();const Uo=o;transition_out(Uo.$$.fragment,1,0,()=>{destroy_component(Uo,1)}),check_outros()}d?(o=new d(p()),create_component(o.$$.fragment),transition_in(o.$$.fragment,1),mount_component(o,s.parentNode,s)):o=null}else d&&o.$set(Lo)},i(Co){c||(o&&transition_in(o.$$.fragment,Co),c=!0)},o(Co){o&&transition_out(o.$$.fragment,Co),c=!1},d(Co){Co&&detach(s),o&&destroy_component(o,Co)}}}function create_if_block_8$5(l){let o,s,c;var h=l[26];function d(p){return{props:{value:p[2],getSelectionLabel:p[12],activeValue:p[30],isDisabled:p[9],multiFullItemClearable:p[8]}}}return h&&(o=new h(d(l)),o.$on("multiItemClear",l[38]),o.$on("focus",l[40])),{c(){o&&create_component(o.$$.fragment),s=empty$1()},m(p,Co){o&&mount_component(o,p,Co),insert(p,s,Co),c=!0},p(p,Co){const Bo={};if(Co[0]&4&&(Bo.value=p[2]),Co[0]&4096&&(Bo.getSelectionLabel=p[12]),Co[0]&1073741824&&(Bo.activeValue=p[30]),Co[0]&512&&(Bo.isDisabled=p[9]),Co[0]&256&&(Bo.multiFullItemClearable=p[8]),h!==(h=p[26])){if(o){group_outros();const Lo=o;transition_out(Lo.$$.fragment,1,0,()=>{destroy_component(Lo,1)}),check_outros()}h?(o=new h(d(p)),o.$on("multiItemClear",p[38]),o.$on("focus",p[40]),create_component(o.$$.fragment),transition_in(o.$$.fragment,1),mount_component(o,s.parentNode,s)):o=null}else h&&o.$set(Bo)},i(p){c||(o&&transition_in(o.$$.fragment,p),c=!0)},o(p){o&&transition_out(o.$$.fragment,p),c=!1},d(p){p&&detach(s),o&&destroy_component(o,p)}}}function create_if_block_7$5(l){let o,s,c,h,d;var p=l[25];function Co(Bo){return{props:{item:Bo[2],getSelectionLabel:Bo[12]}}}return p&&(s=new p(Co(l))),{c(){o=element("div"),s&&create_component(s.$$.fragment),attr(o,"class","selectedItem svelte-b8sh3g")},m(Bo,Lo){insert(Bo,o,Lo),s&&mount_component(s,o,null),c=!0,h||(d=listen(o,"focus",l[40]),h=!0)},p(Bo,Lo){const Uo={};if(Lo[0]&4&&(Uo.item=Bo[2]),Lo[0]&4096&&(Uo.getSelectionLabel=Bo[12]),p!==(p=Bo[25])){if(s){group_outros();const Qo=s;transition_out(Qo.$$.fragment,1,0,()=>{destroy_component(Qo,1)}),check_outros()}p?(s=new p(Co(Bo)),create_component(s.$$.fragment),transition_in(s.$$.fragment,1),mount_component(s,o,null)):s=null}else p&&s.$set(Uo)},i(Bo){c||(s&&transition_in(s.$$.fragment,Bo),c=!0)},o(Bo){s&&transition_out(s.$$.fragment,Bo),c=!1},d(Bo){Bo&&detach(o),s&&destroy_component(s),h=!1,d()}}}function create_if_block_6$6(l){let o,s,c,h,d;var p=l[23];function Co(Bo){return{}}return p&&(s=new p(Co())),{c(){o=element("div"),s&&create_component(s.$$.fragment),attr(o,"class","clearSelect svelte-b8sh3g"),attr(o,"aria-hidden","true")},m(Bo,Lo){insert(Bo,o,Lo),s&&mount_component(s,o,null),c=!0,h||(d=listen(o,"click",prevent_default(l[27])),h=!0)},p(Bo,Lo){if(p!==(p=Bo[23])){if(s){group_outros();const Uo=s;transition_out(Uo.$$.fragment,1,0,()=>{destroy_component(Uo,1)}),check_outros()}p?(s=new p(Co()),create_component(s.$$.fragment),transition_in(s.$$.fragment,1),mount_component(s,o,null)):s=null}},i(Bo){c||(s&&transition_in(s.$$.fragment,Bo),c=!0)},o(Bo){s&&transition_out(s.$$.fragment,Bo),c=!1},d(Bo){Bo&&detach(o),s&&destroy_component(s),h=!1,d()}}}function create_if_block_4$9(l){let o;function s(d,p){return d[22]?create_if_block_5$7:create_else_block$i}let c=s(l),h=c(l);return{c(){o=element("div"),h.c(),attr(o,"class","indicator svelte-b8sh3g"),attr(o,"aria-hidden","true")},m(d,p){insert(d,o,p),h.m(o,null)},p(d,p){c===(c=s(d))&&h?h.p(d,p):(h.d(1),h=c(d),h&&(h.c(),h.m(o,null)))},d(d){d&&detach(o),h.d()}}}function create_else_block$i(l){let o,s;return{c(){o=svg_element("svg"),s=svg_element("path"),attr(s,"d",`M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747
          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0
          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502
          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0
          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z`),attr(o,"width","100%"),attr(o,"height","100%"),attr(o,"viewBox","0 0 20 20"),attr(o,"focusable","false"),attr(o,"aria-hidden","true"),attr(o,"class","svelte-b8sh3g")},m(c,h){insert(c,o,h),append(o,s)},p:noop$2,d(c){c&&detach(o)}}}function create_if_block_5$7(l){let o,s;return{c(){o=new HtmlTag,s=empty$1(),o.a=s},m(c,h){o.m(l[22],c,h),insert(c,s,h)},p(c,h){h[0]&4194304&&o.p(c[22])},d(c){c&&detach(s),c&&o.d()}}}function create_if_block_3$a(l){let o;return{c(){o=element("div"),o.innerHTML='<svg class="spinner_icon svelte-b8sh3g" viewBox="25 25 50 50"><circle class="spinner_path svelte-b8sh3g" cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="5" stroke-miterlimit="10"></circle></svg>',attr(o,"class","spinner svelte-b8sh3g")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_2$c(l){let o,s,c,h;const d=[l[34]];function p(Lo){l[84](Lo)}var Co=l[24];function Bo(Lo){let Uo={};for(let Qo=0;Qo<d.length;Qo+=1)Uo=assign(Uo,d[Qo]);return Lo[28]!==void 0&&(Uo.hoverItemIndex=Lo[28]),{props:Uo}}return Co&&(o=new Co(Bo(l)),binding_callbacks.push(()=>bind(o,"hoverItemIndex",p)),o.$on("itemSelected",l[43]),o.$on("itemCreated",l[44]),o.$on("closeList",l[45])),{c(){o&&create_component(o.$$.fragment),c=empty$1()},m(Lo,Uo){o&&mount_component(o,Lo,Uo),insert(Lo,c,Uo),h=!0},p(Lo,Uo){const Qo=Uo[1]&8?get_spread_update(d,[get_spread_object(Lo[34])]):{};if(!s&&Uo[0]&268435456&&(s=!0,Qo.hoverItemIndex=Lo[28],add_flush_callback(()=>s=!1)),Co!==(Co=Lo[24])){if(o){group_outros();const Po=o;transition_out(Po.$$.fragment,1,0,()=>{destroy_component(Po,1)}),check_outros()}Co?(o=new Co(Bo(Lo)),binding_callbacks.push(()=>bind(o,"hoverItemIndex",p)),o.$on("itemSelected",Lo[43]),o.$on("itemCreated",Lo[44]),o.$on("closeList",Lo[45]),create_component(o.$$.fragment),transition_in(o.$$.fragment,1),mount_component(o,c.parentNode,c)):o=null}else Co&&o.$set(Qo)},i(Lo){h||(o&&transition_in(o.$$.fragment,Lo),h=!0)},o(Lo){o&&transition_out(o.$$.fragment,Lo),h=!1},d(Lo){Lo&&detach(c),o&&destroy_component(o,Lo)}}}function create_if_block_1$f(l){let o,s,c;return{c(){o=element("input"),attr(o,"name",s=l[16].name),attr(o,"type","hidden"),o.value=c=l[2]?l[12](l[2]):null,attr(o,"class","svelte-b8sh3g")},m(h,d){insert(h,o,d)},p(h,d){d[0]&65536&&s!==(s=h[16].name)&&attr(o,"name",s),d[0]&4100&&c!==(c=h[2]?h[12](h[2]):null)&&(o.value=c)},d(h){h&&detach(o)}}}function create_if_block$m(l){let o,s=l[2],c=[];for(let h=0;h<s.length;h+=1)c[h]=create_each_block$a(get_each_context$a(l,s,h));return{c(){for(let h=0;h<c.length;h+=1)c[h].c();o=empty$1()},m(h,d){for(let p=0;p<c.length;p+=1)c[p].m(h,d);insert(h,o,d)},p(h,d){if(d[0]&69636){s=h[2];let p;for(p=0;p<s.length;p+=1){const Co=get_each_context$a(h,s,p);c[p]?c[p].p(Co,d):(c[p]=create_each_block$a(Co),c[p].c(),c[p].m(o.parentNode,o))}for(;p<c.length;p+=1)c[p].d(1);c.length=s.length}},d(h){destroy_each(c,h),h&&detach(o)}}}function create_each_block$a(l){let o,s,c;return{c(){o=element("input"),attr(o,"name",s=l[16].name),attr(o,"type","hidden"),o.value=c=l[103]?l[12](l[103]):null,attr(o,"class","svelte-b8sh3g")},m(h,d){insert(h,o,d)},p(h,d){d[0]&65536&&s!==(s=h[16].name)&&attr(o,"name",s),d[0]&4100&&c!==(c=h[103]?h[12](h[103]):null)&&(o.value=c)},d(h){h&&detach(o)}}}function create_fragment$D(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo=l[1]&&create_if_block_10$4(l),Wo=l[17]&&create_if_block_9$5(l),es=l[35]&&create_if_block_8$5(l),is=[{readOnly:Co=!l[13]},l[31],{placeholder:l[36]},{style:l[14]},{disabled:l[9]}],Jo={};for(let gs=0;gs<is.length;gs+=1)Jo=assign(Jo,is[gs]);let Ko=!l[7]&&l[29]&&create_if_block_7$5(l),Yo=l[37]&&create_if_block_6$6(l),ts=!l[37]&&(l[20]||l[19]&&!l[2]||!l[13]&&!l[9]&&!l[4]&&(l[29]&&!l[15]||!l[29]))&&create_if_block_4$9(l),ss=l[4]&&create_if_block_3$a(),cs=l[5]&&create_if_block_2$c(l),as=(!l[7]||l[7]&&!l[35])&&create_if_block_1$f(l),us=l[7]&&l[35]&&create_if_block$m(l);return{c(){o=element("div"),s=element("span"),Zo&&Zo.c(),c=space(),Wo&&Wo.c(),h=space(),es&&es.c(),d=space(),p=element("input"),Bo=space(),Ko&&Ko.c(),Lo=space(),Yo&&Yo.c(),Uo=space(),ts&&ts.c(),Qo=space(),ss&&ss.c(),Po=space(),cs&&cs.c(),Mo=space(),as&&as.c(),Go=space(),us&&us.c(),attr(s,"aria-live","polite"),attr(s,"aria-atomic","false"),attr(s,"aria-relevant","additions text"),attr(s,"class","a11yText svelte-b8sh3g"),set_attributes(p,Jo),toggle_class(p,"svelte-b8sh3g",!0),attr(o,"class",$o="selectContainer "+l[21]+" svelte-b8sh3g"),attr(o,"style",l[11]),toggle_class(o,"hasError",l[10]),toggle_class(o,"multiSelect",l[7]),toggle_class(o,"disabled",l[9]),toggle_class(o,"focused",l[1])},m(gs,Is){insert(gs,o,Is),append(o,s),Zo&&Zo.m(s,null),append(o,c),Wo&&Wo.m(o,null),append(o,h),es&&es.m(o,null),append(o,d),append(o,p),p.autofocus&&p.focus(),l[82](p),set_input_value(p,l[3]),append(o,Bo),Ko&&Ko.m(o,null),append(o,Lo),Yo&&Yo.m(o,null),append(o,Uo),ts&&ts.m(o,null),append(o,Qo),ss&&ss.m(o,null),append(o,Po),cs&&cs.m(o,null),append(o,Mo),as&&as.m(o,null),append(o,Go),us&&us.m(o,null),l[85](o),jo=!0,zo||(Xo=[listen(window,"click",l[41]),listen(window,"focusin",l[41]),listen(window,"keydown",l[39]),listen(p,"focus",l[40]),listen(p,"input",l[83]),listen(o,"click",l[42])],zo=!0)},p(gs,Is){gs[1]?Zo?Zo.p(gs,Is):(Zo=create_if_block_10$4(gs),Zo.c(),Zo.m(s,null)):Zo&&(Zo.d(1),Zo=null),gs[17]?Wo?(Wo.p(gs,Is),Is[0]&131072&&transition_in(Wo,1)):(Wo=create_if_block_9$5(gs),Wo.c(),transition_in(Wo,1),Wo.m(o,h)):Wo&&(group_outros(),transition_out(Wo,1,1,()=>{Wo=null}),check_outros()),gs[35]?es?(es.p(gs,Is),Is[1]&16&&transition_in(es,1)):(es=create_if_block_8$5(gs),es.c(),transition_in(es,1),es.m(o,d)):es&&(group_outros(),transition_out(es,1,1,()=>{es=null}),check_outros()),set_attributes(p,Jo=get_spread_update(is,[(!jo||Is[0]&8192&&Co!==(Co=!gs[13]))&&{readOnly:Co},Is[1]&1&&gs[31],(!jo||Is[1]&32)&&{placeholder:gs[36]},(!jo||Is[0]&16384)&&{style:gs[14]},(!jo||Is[0]&512)&&{disabled:gs[9]}])),Is[0]&8&&p.value!==gs[3]&&set_input_value(p,gs[3]),toggle_class(p,"svelte-b8sh3g",!0),!gs[7]&&gs[29]?Ko?(Ko.p(gs,Is),Is[0]&536871040&&transition_in(Ko,1)):(Ko=create_if_block_7$5(gs),Ko.c(),transition_in(Ko,1),Ko.m(o,Lo)):Ko&&(group_outros(),transition_out(Ko,1,1,()=>{Ko=null}),check_outros()),gs[37]?Yo?(Yo.p(gs,Is),Is[1]&64&&transition_in(Yo,1)):(Yo=create_if_block_6$6(gs),Yo.c(),transition_in(Yo,1),Yo.m(o,Uo)):Yo&&(group_outros(),transition_out(Yo,1,1,()=>{Yo=null}),check_outros()),!gs[37]&&(gs[20]||gs[19]&&!gs[2]||!gs[13]&&!gs[9]&&!gs[4]&&(gs[29]&&!gs[15]||!gs[29]))?ts?ts.p(gs,Is):(ts=create_if_block_4$9(gs),ts.c(),ts.m(o,Qo)):ts&&(ts.d(1),ts=null),gs[4]?ss||(ss=create_if_block_3$a(),ss.c(),ss.m(o,Po)):ss&&(ss.d(1),ss=null),gs[5]?cs?(cs.p(gs,Is),Is[0]&32&&transition_in(cs,1)):(cs=create_if_block_2$c(gs),cs.c(),transition_in(cs,1),cs.m(o,Mo)):cs&&(group_outros(),transition_out(cs,1,1,()=>{cs=null}),check_outros()),!gs[7]||gs[7]&&!gs[35]?as?as.p(gs,Is):(as=create_if_block_1$f(gs),as.c(),as.m(o,Go)):as&&(as.d(1),as=null),gs[7]&&gs[35]?us?us.p(gs,Is):(us=create_if_block$m(gs),us.c(),us.m(o,null)):us&&(us.d(1),us=null),(!jo||Is[0]&2097152&&$o!==($o="selectContainer "+gs[21]+" svelte-b8sh3g"))&&attr(o,"class",$o),(!jo||Is[0]&2048)&&attr(o,"style",gs[11]),Is[0]&2098176&&toggle_class(o,"hasError",gs[10]),Is[0]&2097280&&toggle_class(o,"multiSelect",gs[7]),Is[0]&2097664&&toggle_class(o,"disabled",gs[9]),Is[0]&2097154&&toggle_class(o,"focused",gs[1])},i(gs){jo||(transition_in(Wo),transition_in(es),transition_in(Ko),transition_in(Yo),transition_in(cs),jo=!0)},o(gs){transition_out(Wo),transition_out(es),transition_out(Ko),transition_out(Yo),transition_out(cs),jo=!1},d(gs){gs&&detach(o),Zo&&Zo.d(),Wo&&Wo.d(),es&&es.d(),l[82](null),Ko&&Ko.d(),Yo&&Yo.d(),ts&&ts.d(),ss&&ss.d(),cs&&cs.d(),as&&as.d(),us&&us.d(),l[85](null),zo=!1,run_all(Xo)}}}function convertStringItemsToObjects(l){return l.map((o,s)=>({index:s,value:o,label:`${o}`}))}function instance$D(l,o,s){let c,h,d,p,Co,Bo,Lo,Uo;const Qo=createEventDispatcher();let{id:Po=null}=o,{container:Mo=void 0}=o,{input:Go=void 0}=o,{isMulti:$o=!1}=o,{multiFullItemClearable:jo=!1}=o,{isDisabled:zo=!1}=o,{isCreatable:Xo=!1}=o,{isFocused:Zo=!1}=o,{value:Wo=null}=o,{filterText:es=""}=o,{placeholder:is="Select..."}=o,{placeholderAlwaysShow:Jo=!1}=o,{items:Ko=null}=o,{itemFilter:Yo=(Cs,Al,bl)=>`${Cs}`.toLowerCase().includes(Al.toLowerCase())}=o,{groupBy:ts=void 0}=o,{groupFilter:ss=Cs=>Cs}=o,{isGroupHeaderSelectable:cs=!1}=o,{getGroupHeaderLabel:as=Cs=>Cs[us]||Cs.id}=o,{labelIdentifier:us="label"}=o,{getOptionLabel:gs=(Cs,Al)=>Cs.isCreator?`Create "${Al}"`:Cs[us]}=o,{optionIdentifier:Is="value"}=o,{loadOptions:_s=void 0}=o,{hasError:Hs=!1}=o,{containerStyles:ds=""}=o,{getSelectionLabel:hs=Cs=>Cs?Cs[us]:null}=o,{createGroupHeaderItem:ys=Cs=>({value:Cs,label:Cs})}=o,{createItem:ms=Cs=>({value:Cs,label:Cs})}=o;const Rs=()=>c;let{isSearchable:bs=!0}=o,{inputStyles:ps=""}=o,{isClearable:ks=!0}=o,{isWaiting:xs=!1}=o,{listPlacement:Ss="auto"}=o,{listOpen:Us=!1}=o,{isVirtualList:Ps=!1}=o,{loadOptionsInterval:Qs=300}=o,{noOptionsMessage:Js="No options"}=o,{hideEmptyState:qs=!1}=o,{inputAttributes:Gs={}}=o,{listAutoWidth:Zs=!0}=o,{itemHeight:Es=40}=o,{Icon:fs=void 0}=o,{iconProps:vs={}}=o,{showChevron:Bs=!1}=o,{showIndicator:Ls=!1}=o,{containerClasses:Fs=""}=o,{indicatorSvg:zs=void 0}=o,{listOffset:js=5}=o,{ClearIcon:ma=ClearIcon}=o,{Item:Ws=Item}=o,{List:va=List}=o,{Selection:ca=Selection}=o,{MultiSelection:cl=MultiSelection}=o,{VirtualList:Ms=VirtualList}=o;function $s(Cs){if(Cs.loadOptions&&Cs.filterText.length>0)return;if(!Cs.items)return[];Cs.items&&Cs.items.length>0&&typeof Cs.items[0]!="object"&&(Cs.items=convertStringItemsToObjects(Cs.items));let Al=Cs.items.filter(bl=>{let Wl=Yo(gs(bl,Cs.filterText),Cs.filterText,bl);return Wl&&Cs.isMulti&&Cs.value&&Array.isArray(Cs.value)&&(Wl=!Cs.value.some(oA=>oA[Cs.optionIdentifier]===bl[Cs.optionIdentifier])),Wl});return Cs.groupBy&&(Al=Ll(Al)),Cs.isCreatable&&(Al=ga(Al,Cs.filterText)),Al}function ga(Cs,Al){if(Al.length===0)return Cs;const bl=ms(Al);return Cs[0]&&Al===Cs[0][us]?Cs:(bl.isCreator=!0,[...Cs,bl])}let{selectedValue:Xs=null}=o,ll,sl,nl,pl,El,cA;const rl=debounce$1(async()=>{s(4,xs=!0);let Cs=await _s(es).catch(Al=>{console.warn("svelte-select loadOptions error :>> ",Al),Qo("error",{type:"loadOptions",details:Al})});Cs&&!Cs.cancelled&&(Cs?(Cs&&Cs.length>0&&typeof Cs[0]!="object"&&(Cs=convertStringItemsToObjects(Cs)),s(81,c=[...Cs]),Qo("loaded",{items:c})):s(81,c=[]),Xo&&s(81,c=ga(c,es)),s(4,xs=!1),s(1,Zo=!0),s(5,Us=!0))},Qs);function Cl(){typeof Wo=="string"?s(2,Wo={[Is]:Wo,label:Wo}):$o&&Array.isArray(Wo)&&Wo.length>0&&s(2,Wo=Wo.map(Cs=>typeof Cs=="string"?{value:Cs,label:Cs}:Cs)),nl&&!_s&&s(3,es="")}let Ul;function Nl(){s(31,Ul=Object.assign({autocapitalize:"none",autocomplete:"off",autocorrect:"off",spellcheck:!1,tabindex:0,type:"text","aria-autocomplete":"list"},Gs)),Po&&s(31,Ul.id=Po,Ul),bs||s(31,Ul.readonly=!0,Ul)}function Ll(Cs){const Al=[],bl={};Cs.forEach(oA=>{const gA=ts(oA);Al.includes(gA)||(Al.push(gA),bl[gA]=[],gA&&bl[gA].push(Object.assign(ys(gA,oA),{id:gA,isGroupHeader:!0,isSelectable:cs}))),bl[gA].push(Object.assign({isGroupItem:!!gA},oA))});const Wl=[];return ss(Al).forEach(oA=>{Wl.push(...bl[oA])}),Wl}function hl(){if($o){JSON.stringify(Wo)!==JSON.stringify(sl)&&Dl()&&Qo("select",Wo);return}(!sl||JSON.stringify(Wo[Is])!==JSON.stringify(sl[Is]))&&Qo("select",Wo)}function gl(){Zo||Us?Tl():Go&&Go.blur()}function zl(){Wo&&(Array.isArray(Wo)?s(2,Wo=[...Wo]):s(2,Wo=[Wo]))}function bA(){Wo&&s(2,Wo=null)}function UA(){es.length!==0&&(s(1,Zo=!0),s(5,Us=!0),_s?rl():(s(5,Us=!0),$o&&s(30,ll=void 0)))}beforeUpdate(async()=>{s(77,sl=Wo),s(78,nl=es),s(79,pl=Zo),s(80,El=$o)});function Dl(){let Cs=!0;if(Wo){const Al=[],bl=[];Wo.forEach(Wl=>{Al.includes(Wl[Is])?Cs=!1:(Al.push(Wl[Is]),bl.push(Wl))}),Cs||s(2,Wo=bl)}return Cs}function Kl(Cs){let Al=Cs?Cs[Is]:Wo[Is];return Ko.find(bl=>bl[Is]===Al)}function vA(Cs){!Cs||Cs.length===0||Cs.some(Al=>typeof Al!="object")||!Wo||($o?Wo.some(Al=>!Al||!Al[Is]):!Wo[Is])||(Array.isArray(Wo)?s(2,Wo=Wo.map(Al=>Kl(Al)||Al)):s(2,Wo=Kl()||Wo))}function Vl(Cs){const{detail:Al}=Cs,bl=Wo[Al?Al.i:Wo.length-1];Wo.length===1?s(2,Wo=void 0):s(2,Wo=Wo.filter(Wl=>Wl!==bl)),Qo("clear",bl)}function TA(Cs){if(!!Zo)switch(Cs.key){case"ArrowDown":Cs.preventDefault(),s(5,Us=!0),s(30,ll=void 0);break;case"ArrowUp":Cs.preventDefault(),s(5,Us=!0),s(30,ll=void 0);break;case"Tab":Us||s(1,Zo=!1);break;case"Backspace":if(!$o||es.length>0)return;if($o&&Wo&&Wo.length>0){if(Vl(ll!==void 0?ll:Wo.length-1),ll===0||ll===void 0)break;s(30,ll=Wo.length>ll?ll-1:void 0)}break;case"ArrowLeft":if(!$o||es.length>0)return;ll===void 0?s(30,ll=Wo.length-1):Wo.length>ll&&ll!==0&&s(30,ll-=1);break;case"ArrowRight":if(!$o||es.length>0||ll===void 0)return;ll===Wo.length-1?s(30,ll=void 0):ll<Wo.length-1&&s(30,ll+=1);break}}function Tl(){s(1,Zo=!0),Go&&Go.focus()}function xl(Cs){if(!Mo)return;const Al=Cs.path&&Cs.path.length>0?Cs.path[0]:Cs.target;Mo.contains(Al)||(s(1,Zo=!1),s(5,Us=!1),s(30,ll=void 0),Go&&Go.blur())}function ua(){zo||(s(1,Zo=!0),s(5,Us=!Us))}function _l(){s(2,Wo=void 0),s(5,Us=!1),Qo("clear",Wo),Tl()}onMount(()=>{Zo&&Go&&Go.focus()});function uA(Cs){const{detail:Al}=Cs;if(Al){s(3,es="");const bl=Object.assign({},Al);(!bl.isGroupHeader||bl.isSelectable)&&($o?s(2,Wo=Wo?Wo.concat([bl]):[bl]):s(2,Wo=bl),s(2,Wo),setTimeout(()=>{s(5,Us=!1),s(30,ll=void 0)}))}}function fA(Cs){const{detail:Al}=Cs;$o?(s(2,Wo=Wo||[]),s(2,Wo=[...Wo,ms(Al)])):s(2,Wo=ms(Al)),Qo("itemCreated",Al),s(3,es=""),s(5,Us=!1),s(30,ll=void 0)}function hA(){s(3,es=""),s(5,Us=!1)}let{ariaValues:Zl=Cs=>`Option ${Cs}, selected.`}=o,{ariaListOpen:kA=(Cs,Al)=>`You are currently focused on option ${Cs}. There are ${Al} results available.`}=o,{ariaFocused:Ml=()=>"Select is focused, type to refine list, press down to open the menu."}=o;function jl(){let Cs;return $o&&Wo.length>0?Cs=Wo.map(Al=>hs(Al)).join(", "):Cs=hs(Wo),Zl(Cs)}function GA(){if(!Zo||!c||c.length===0)return"";let Cs=c[cA];if(Us&&Cs){let Al=hs(Cs),bl=c?c.length:0;return kA(Al,bl)}else return Ml()}function Ol(Cs){binding_callbacks[Cs?"unshift":"push"](()=>{Go=Cs,s(6,Go)})}function yA(){es=this.value,s(3,es)}function wA(Cs){cA=Cs,s(28,cA)}function $A(Cs){binding_callbacks[Cs?"unshift":"push"](()=>{Mo=Cs,s(0,Mo)})}return l.$$set=Cs=>{"id"in Cs&&s(46,Po=Cs.id),"container"in Cs&&s(0,Mo=Cs.container),"input"in Cs&&s(6,Go=Cs.input),"isMulti"in Cs&&s(7,$o=Cs.isMulti),"multiFullItemClearable"in Cs&&s(8,jo=Cs.multiFullItemClearable),"isDisabled"in Cs&&s(9,zo=Cs.isDisabled),"isCreatable"in Cs&&s(47,Xo=Cs.isCreatable),"isFocused"in Cs&&s(1,Zo=Cs.isFocused),"value"in Cs&&s(2,Wo=Cs.value),"filterText"in Cs&&s(3,es=Cs.filterText),"placeholder"in Cs&&s(48,is=Cs.placeholder),"placeholderAlwaysShow"in Cs&&s(49,Jo=Cs.placeholderAlwaysShow),"items"in Cs&&s(50,Ko=Cs.items),"itemFilter"in Cs&&s(51,Yo=Cs.itemFilter),"groupBy"in Cs&&s(52,ts=Cs.groupBy),"groupFilter"in Cs&&s(53,ss=Cs.groupFilter),"isGroupHeaderSelectable"in Cs&&s(54,cs=Cs.isGroupHeaderSelectable),"getGroupHeaderLabel"in Cs&&s(55,as=Cs.getGroupHeaderLabel),"labelIdentifier"in Cs&&s(56,us=Cs.labelIdentifier),"getOptionLabel"in Cs&&s(57,gs=Cs.getOptionLabel),"optionIdentifier"in Cs&&s(58,Is=Cs.optionIdentifier),"loadOptions"in Cs&&s(59,_s=Cs.loadOptions),"hasError"in Cs&&s(10,Hs=Cs.hasError),"containerStyles"in Cs&&s(11,ds=Cs.containerStyles),"getSelectionLabel"in Cs&&s(12,hs=Cs.getSelectionLabel),"createGroupHeaderItem"in Cs&&s(60,ys=Cs.createGroupHeaderItem),"createItem"in Cs&&s(61,ms=Cs.createItem),"isSearchable"in Cs&&s(13,bs=Cs.isSearchable),"inputStyles"in Cs&&s(14,ps=Cs.inputStyles),"isClearable"in Cs&&s(15,ks=Cs.isClearable),"isWaiting"in Cs&&s(4,xs=Cs.isWaiting),"listPlacement"in Cs&&s(63,Ss=Cs.listPlacement),"listOpen"in Cs&&s(5,Us=Cs.listOpen),"isVirtualList"in Cs&&s(64,Ps=Cs.isVirtualList),"loadOptionsInterval"in Cs&&s(65,Qs=Cs.loadOptionsInterval),"noOptionsMessage"in Cs&&s(66,Js=Cs.noOptionsMessage),"hideEmptyState"in Cs&&s(67,qs=Cs.hideEmptyState),"inputAttributes"in Cs&&s(16,Gs=Cs.inputAttributes),"listAutoWidth"in Cs&&s(68,Zs=Cs.listAutoWidth),"itemHeight"in Cs&&s(69,Es=Cs.itemHeight),"Icon"in Cs&&s(17,fs=Cs.Icon),"iconProps"in Cs&&s(18,vs=Cs.iconProps),"showChevron"in Cs&&s(19,Bs=Cs.showChevron),"showIndicator"in Cs&&s(20,Ls=Cs.showIndicator),"containerClasses"in Cs&&s(21,Fs=Cs.containerClasses),"indicatorSvg"in Cs&&s(22,zs=Cs.indicatorSvg),"listOffset"in Cs&&s(70,js=Cs.listOffset),"ClearIcon"in Cs&&s(23,ma=Cs.ClearIcon),"Item"in Cs&&s(71,Ws=Cs.Item),"List"in Cs&&s(24,va=Cs.List),"Selection"in Cs&&s(25,ca=Cs.Selection),"MultiSelection"in Cs&&s(26,cl=Cs.MultiSelection),"VirtualList"in Cs&&s(72,Ms=Cs.VirtualList),"selectedValue"in Cs&&s(73,Xs=Cs.selectedValue),"ariaValues"in Cs&&s(74,Zl=Cs.ariaValues),"ariaListOpen"in Cs&&s(75,kA=Cs.ariaListOpen),"ariaFocused"in Cs&&s(76,Ml=Cs.ariaFocused)},l.$$.update=()=>{l.$$.dirty[0]&140|l.$$.dirty[1]&405340160&&s(81,c=$s({loadOptions:_s,filterText:es,items:Ko,value:Wo,isMulti:$o,optionIdentifier:Is,groupBy:ts,isCreatable:Xo})),l.$$.dirty[2]&2048&&Xs&&console.warn("selectedValue is no longer used. Please use value instead."),l.$$.dirty[1]&524288&&vA(Ko),l.$$.dirty[0]&4&&Wo&&Cl(),l.$$.dirty[0]&73728&&(Gs||!bs)&&Nl(),l.$$.dirty[0]&128|l.$$.dirty[2]&262144&&($o&&zl(),El&&!$o&&bA()),l.$$.dirty[0]&132&&$o&&Wo&&Wo.length>1&&Dl(),l.$$.dirty[0]&4&&Wo&&hl(),l.$$.dirty[0]&132|l.$$.dirty[2]&32768&&!Wo&&$o&&sl&&Qo("select",Wo),l.$$.dirty[0]&2|l.$$.dirty[2]&131072&&Zo!==pl&&gl(),l.$$.dirty[0]&8|l.$$.dirty[2]&65536&&es!==nl&&UA(),l.$$.dirty[0]&12&&s(29,h=Wo&&es.length===0),l.$$.dirty[0]&536904208&&s(37,d=h&&ks&&!zo&&!xs),l.$$.dirty[0]&132|l.$$.dirty[1]&393216&&s(36,p=Jo&&$o?is:Wo?"":is),l.$$.dirty[0]&132&&s(35,Co=$o&&Wo&&Wo.length>0),l.$$.dirty[0]&141|l.$$.dirty[1]&218103808|l.$$.dirty[2]&526326&&s(34,Bo={Item:Ws,filterText:es,optionIdentifier:Is,noOptionsMessage:Js,hideEmptyState:qs,isVirtualList:Ps,VirtualList:Ms,value:Wo,isMulti:$o,getGroupHeaderLabel:as,items:c,itemHeight:Es,getOptionLabel:gs,listPlacement:Ss,parent:Mo,listAutoWidth:Zs,listOffset:js}),l.$$.dirty[0]&132&&s(33,Lo=Wo?jl():""),l.$$.dirty[0]&268435490|l.$$.dirty[2]&524288&&s(32,Uo=GA())},[Mo,Zo,Wo,es,xs,Us,Go,$o,jo,zo,Hs,ds,hs,bs,ps,ks,Gs,fs,vs,Bs,Ls,Fs,zs,ma,va,ca,cl,_l,cA,h,ll,Ul,Uo,Lo,Bo,Co,p,d,Vl,TA,Tl,xl,ua,uA,fA,hA,Po,Xo,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,ys,ms,Rs,Ss,Ps,Qs,Js,qs,Zs,Es,js,Ws,Ms,Xs,Zl,kA,Ml,sl,nl,pl,El,c,Ol,yA,wA,$A]}class Select extends SvelteComponent{constructor(o){super(),init(this,o,instance$D,create_fragment$D,safe_not_equal,{id:46,container:0,input:6,isMulti:7,multiFullItemClearable:8,isDisabled:9,isCreatable:47,isFocused:1,value:2,filterText:3,placeholder:48,placeholderAlwaysShow:49,items:50,itemFilter:51,groupBy:52,groupFilter:53,isGroupHeaderSelectable:54,getGroupHeaderLabel:55,labelIdentifier:56,getOptionLabel:57,optionIdentifier:58,loadOptions:59,hasError:10,containerStyles:11,getSelectionLabel:12,createGroupHeaderItem:60,createItem:61,getFilteredItems:62,isSearchable:13,inputStyles:14,isClearable:15,isWaiting:4,listPlacement:63,listOpen:5,isVirtualList:64,loadOptionsInterval:65,noOptionsMessage:66,hideEmptyState:67,inputAttributes:16,listAutoWidth:68,itemHeight:69,Icon:17,iconProps:18,showChevron:19,showIndicator:20,containerClasses:21,indicatorSvg:22,listOffset:70,ClearIcon:23,Item:71,List:24,Selection:25,MultiSelection:26,VirtualList:72,selectedValue:73,handleClear:27,ariaValues:74,ariaListOpen:75,ariaFocused:76},null,[-1,-1,-1,-1])}get getFilteredItems(){return this.$$.ctx[62]}get handleClear(){return this.$$.ctx[27]}}const localityInput_svelte_svelte_type_style_lang="";function create_fragment$C(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo;return{c(){o=element("div"),s=element("textarea"),c=space(),h=element("span"),h.textContent="content_copy",d=space(),p=element("span"),Co=text("content_paste"),attr(s,"class","icon-input svelte-z2ee2n"),attr(s,"type","text"),attr(s,"id","loc"),attr(s,"rows","2"),toggle_class(s,"hasError",l[1]),attr(h,"class","material-icons inline-icon icon-input-icon svelte-z2ee2n"),set_style(h,"right","30px"),attr(h,"title","copy locality"),attr(p,"class","material-icons inline-icon icon-input-icon svelte-z2ee2n"),set_style(p,"right","5px"),attr(p,"title","paste locality"),attr(p,"disabled",Bo=!l[2]),toggle_class(p,"md-inactive",!l[2]),attr(o,"class","icon-input-container svelte-z2ee2n")},m(Qo,Po){insert(Qo,o,Po),append(o,s),set_input_value(s,l[0]),l[7](s),append(o,c),append(o,h),append(o,d),append(o,p),append(p,Co),Lo||(Uo=[listen(s,"input",l[6]),listen(h,"click",l[4]),listen(p,"click",l[5])],Lo=!0)},p(Qo,[Po]){Po&1&&set_input_value(s,Qo[0]),Po&2&&toggle_class(s,"hasError",Qo[1]),Po&4&&Bo!==(Bo=!Qo[2])&&attr(p,"disabled",Bo),Po&4&&toggle_class(p,"md-inactive",!Qo[2])},i:noop$2,o:noop$2,d(Qo){Qo&&detach(o),l[7](null),Lo=!1,run_all(Uo)}}}function instance$C(l,o,s){let{value:c}=o,{hasError:h}=o,{editable:d}=o,p;const Co=Po=>{if(navigator.clipboard.writeText)if(c&&c.trim()){let Mo=Lo();Mo?navigator.clipboard.writeText(Mo).then(Go=>{window.pushToast&&window.pushToast("selection copied")}):navigator.clipboard.writeText(c).then(Go=>{console.log("locality copied"),window.pushToast&&window.pushToast("locality copied")})}else alert("no content to copy");else alert("this browser does not support programmatic copy/paste")},Bo=Po=>{navigator.clipboard.readText?d&&navigator.clipboard.readText().then(Mo=>{Mo&&Mo.trim()?s(0,c=Mo.trim()):window.pushToast?window.pushToast("clipboard empty"):alert("clipboard empty")}):alert("this browser does not support programmatic copy/paste")};function Lo(){if(typeof p.selectionStart=="number")return p.value.slice(p.selectionStart,p.selectionEnd);if(typeof document.selection<"u"){var Po=document.selection.createRange();if(Po.parentElement()==p)return Po.text}return console.log("no value to copy"),null}function Uo(){c=this.value,s(0,c)}function Qo(Po){binding_callbacks[Po?"unshift":"push"](()=>{p=Po,s(3,p)})}return l.$$set=Po=>{"value"in Po&&s(0,c=Po.value),"hasError"in Po&&s(1,h=Po.hasError),"editable"in Po&&s(2,d=Po.editable)},[c,h,d,p,Co,Bo,Uo,Qo]}class LocalityInput extends SvelteComponent{constructor(o){super(),init(this,o,instance$C,create_fragment$C,safe_not_equal,{value:0,hasError:1,editable:2})}}const decimalCoordsInput_svelte_svelte_type_style_lang="";function create_fragment$B(l){let o,s,c,h,d,p,Co,Bo;return{c(){o=element("div"),s=element("input"),c=space(),h=element("span"),h.textContent="content_copy",d=space(),p=element("span"),p.textContent="content_paste",attr(s,"type","text"),attr(s,"class","icon-input svelte-ufitd6"),s.readOnly=!0,toggle_class(s,"hasError",l[1]),attr(h,"class","material-icons inline-icon icon-input-icon svelte-ufitd6"),set_style(h,"right","30px"),attr(h,"title","copy coords"),attr(p,"class","material-icons inline-icon icon-input-icon svelte-ufitd6"),set_style(p,"right","5px"),attr(p,"title","paste coords"),toggle_class(p,"md-inactive",!l[2]),attr(o,"class","icon-input-container svelte-ufitd6")},m(Lo,Uo){insert(Lo,o,Uo),append(o,s),set_input_value(s,l[0]),append(o,c),append(o,h),append(o,d),append(o,p),Co||(Bo=[listen(s,"paste",l[5]),listen(s,"input",l[6]),listen(h,"click",l[3]),listen(p,"click",l[4])],Co=!0)},p(Lo,[Uo]){Uo&1&&s.value!==Lo[0]&&set_input_value(s,Lo[0]),Uo&2&&toggle_class(s,"hasError",Lo[1]),Uo&4&&toggle_class(p,"md-inactive",!Lo[2])},i:noop$2,o:noop$2,d(Lo){Lo&&detach(o),Co=!1,run_all(Bo)}}}function instance$B(l,o,s){let c=createEventDispatcher(),{value:h}=o,{hasError:d}=o,{editable:p}=o;const Co=Po=>{h&&h.trim()&&navigator.clipboard.writeText?navigator.clipboard.writeText(h).then(Mo=>{window.pushToast&&window.pushToast("coordinates copied")}):navigator.clipboard.writeText?window.pushToast?window.pushToast("coordinates empty"):alert("coordinates empty"):alert("this browser does not support programmatic copy/paste")},Bo=Po=>{p&&(navigator.clipboard.readText?navigator.clipboard.readText().then(Mo=>{try{let Go=Uo(Mo);h?Go.replace(/\s+/g,"")!=h.replace(/\s+/g,"")&&(s(0,h=Go),c("coords-from-paste")):(s(0,h=Go),c("coords-from-paste"))}catch{!Mo||!Mo.trim()?alert("clipboard empty"):(Mo=Mo.trim(),Mo.length>30&&(Mo=Mo.slice(0,30)+"..."),Mo=Mo.replace(/\s+/g," "),Mo='"'+Mo+'"',alert("invalid coordinates: "+Mo))}}):alert("this browser does not support programmatic copy/paste"))},Lo=Po=>{if(Po.preventDefault(),p){let Mo=Po.clipboardData.getData("text");if(Mo&&Mo.trim())try{let Go=Uo(Mo);h?Go.replace(/\s+/g,"")!=h.replace(/\s+/g,"")&&(s(0,h=Go),c("coords-from-paste")):(s(0,h=Go),c("coords-from-paste"))}catch{Mo=Mo.trim(),Mo.length>30&&(Mo=Mo.slice(0,30)+"..."),Mo=Mo.replace(/\s+/g," "),Mo='"'+Mo+'"',alert("invalid coordinates: "+Mo)}else alert("clipboard empty")}},Uo=Po=>{if(Po&&Po.trim())if(Po=Po.trim(),/^-?\d{1,2}\.\d{4,},\s*-?\d{1,3}\.\d{4,}$/.test(Po)){let Go=Po.split(","),$o=Go[0],jo=Go[1],zo,Xo,Zo=$o.split(".");if(Zo[1].length>8?zo=Number(Number($o).toFixed(8)):zo=Number($o),Zo=jo.split("."),Zo[1].length>8?Xo=Number(Number(jo).toFixed(8)):Xo=Number(jo),zo>90||zo<-90)throw new Error;if(Xo>180||Xo<-180)throw new Error;return`${zo},${Xo}`}else throw new Error;else throw new Error};function Qo(){h=this.value,s(0,h)}return l.$$set=Po=>{"value"in Po&&s(0,h=Po.value),"hasError"in Po&&s(1,d=Po.hasError),"editable"in Po&&s(2,p=Po.editable)},[h,d,p,Co,Bo,Lo,Qo]}class DecimalCoordsInput extends SvelteComponent{constructor(o){super(),init(this,o,instance$B,create_fragment$B,safe_not_equal,{value:0,hasError:1,editable:2})}}const verbatimCoordsInput_svelte_svelte_type_style_lang="";function create_fragment$A(l){let o,s,c,h,d,p;return{c(){o=element("div"),s=element("input"),c=space(),h=element("span"),h.textContent="content_paste",attr(s,"type","text"),attr(s,"class","icon-input svelte-zap1t5"),s.readOnly=!0,toggle_class(s,"hasError",l[1]),attr(h,"class","material-icons inline-icon icon-input-icon svelte-zap1t5"),set_style(h,"right","5px"),attr(h,"title","paste verbatim coords"),toggle_class(h,"md-inactive",!l[2]),attr(o,"class","icon-input-container svelte-zap1t5")},m(Co,Bo){insert(Co,o,Bo),append(o,s),set_input_value(s,l[0]),append(o,c),append(o,h),d||(p=[listen(s,"paste",l[4]),listen(s,"input",l[5]),listen(h,"click",l[3])],d=!0)},p(Co,[Bo]){Bo&1&&s.value!==Co[0]&&set_input_value(s,Co[0]),Bo&2&&toggle_class(s,"hasError",Co[1]),Bo&4&&toggle_class(h,"md-inactive",!Co[2])},i:noop$2,o:noop$2,d(Co){Co&&detach(o),d=!1,run_all(p)}}}function instance$A(l,o,s){let{value:c=null}=o,{hasError:h=!1}=o,{editable:d}=o,p=createEventDispatcher();const Co=Qo=>{d&&(navigator.clipboard.readText?navigator.clipboard.readText().then(Po=>{try{let Mo=Lo(Po);s(0,c=Po.trim()),p("coords-from-verbatim",Mo)}catch(Mo){alert(Mo.message)}}):alert("this browser does not support programmatic copy/paste"))},Bo=Qo=>{if(Qo.preventDefault(),d){let Po=Qo.clipboardData.getData("text");try{let Mo=Lo(Po);s(0,c=Po.trim()),p("coords-from-verbatim",Mo)}catch(Mo){alert(Mo.message)}}},Lo=Qo=>{if(Qo&&Qo.trim()){Qo=Qo.trim();try{let Po=merge$1(Qo);return`${Po.decimalLatitude},${Po.decimalLongitude}`}catch{throw Qo.length>30&&(Qo=Qo.slice(0,30)+"..."),Qo=Qo.replace(/\s+/g," "),Qo='"'+Qo+'"',new Error("invalid verbatim coords string: "+Qo)}}else throw new Error("empty coordinates string")};function Uo(){c=this.value,s(0,c)}return l.$$set=Qo=>{"value"in Qo&&s(0,c=Qo.value),"hasError"in Qo&&s(1,h=Qo.hasError),"editable"in Qo&&s(2,d=Qo.editable)},[c,h,d,Co,Bo,Uo]}class VerbatimCoordsInput extends SvelteComponent{constructor(o){super(),init(this,o,instance$A,create_fragment$A,safe_not_equal,{value:0,hasError:1,editable:2})}}const dateInput_svelte_svelte_type_style_lang="";function create_fragment$z(l){let o,s,c,h,d,p;return{c(){o=element("div"),s=element("input"),c=space(),h=element("span"),h.textContent="today",attr(s,"type","text"),attr(s,"class","icon-input svelte-1jdp7oc"),toggle_class(s,"hasError",l[1]||l[3]),attr(h,"class","material-icons inline-icon icon-input-icon svelte-1jdp7oc"),set_style(h,"right","5px"),attr(h,"title","copy coords"),toggle_class(h,"md-inactive",!l[2]),attr(o,"class","icon-input-container svelte-1jdp7oc")},m(Co,Bo){insert(Co,o,Bo),append(o,s),set_input_value(s,l[0]),append(o,c),append(o,h),d||(p=[listen(s,"paste",l[5]),listen(s,"input",l[7]),listen(h,"click",l[4])],d=!0)},p(Co,[Bo]){Bo&1&&s.value!==Co[0]&&set_input_value(s,Co[0]),Bo&10&&toggle_class(s,"hasError",Co[1]||Co[3]),Bo&4&&toggle_class(h,"md-inactive",!Co[2])},i:noop$2,o:noop$2,d(Co){Co&&detach(o),d=!1,run_all(p)}}}let re=/^(19|20)\d\d-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/;function instance$z(l,o,s){let c,{value:h}=o,{hasError:d}=o,{hasBy:p=!1}=o,{editable:Co}=o;const Bo=Qo=>{if(Co)if(p){let Po=new Date;s(0,h=new Date(Po.getTime()-Po.getTimezoneOffset()*60*1e3).toISOString().split("T")[0])}else alert("'georef by' is required before a date can be added")},Lo=Qo=>{if(Co){Qo.preventDefault();let Po=Qo.clipboardData.getData("text");re.test(Po)?s(0,h=Po):alert("invalid date value: "+Po)}};function Uo(){h=this.value,s(0,h)}return l.$$set=Qo=>{"value"in Qo&&s(0,h=Qo.value),"hasError"in Qo&&s(1,d=Qo.hasError),"hasBy"in Qo&&s(6,p=Qo.hasBy),"editable"in Qo&&s(2,Co=Qo.editable)},l.$$.update=()=>{l.$$.dirty&1&&s(3,c=Boolean(h&&h.trim()&&!re.test(h)))},[h,d,Co,c,Bo,Lo,p,Uo]}class DateInput extends SvelteComponent{constructor(o){super(),init(this,o,instance$z,create_fragment$z,safe_not_equal,{value:0,hasError:1,hasBy:6,editable:2})}}const Checkbox_svelte_svelte_type_style_lang="";function create_fragment$y(l){let o,s,c,h,d,p,Co,Bo;return{c(){o=element("label"),s=text(l[1]),c=space(),h=element("input"),d=space(),p=element("span"),attr(h,"type","checkbox"),attr(h,"class","svelte-1jrca2p"),attr(p,"class","checkmark svelte-1jrca2p"),attr(o,"class","container svelte-1jrca2p")},m(Lo,Uo){insert(Lo,o,Uo),append(o,s),append(o,c),append(o,h),h.checked=l[0],append(o,d),append(o,p),Co||(Bo=listen(h,"change",l[2]),Co=!0)},p(Lo,[Uo]){Uo&2&&set_data(s,Lo[1]),Uo&1&&(h.checked=Lo[0])},i:noop$2,o:noop$2,d(Lo){Lo&&detach(o),Co=!1,Bo()}}}function instance$y(l,o,s){let{label:c=""}=o,{checked:h=!1}=o;function d(){h=this.checked,s(0,h)}return l.$$set=p=>{"label"in p&&s(1,c=p.label),"checked"in p&&s(0,h=p.checked)},[h,c,d]}class Checkbox extends SvelteComponent{constructor(o){super(),init(this,o,instance$y,create_fragment$y,safe_not_equal,{label:1,checked:0})}}const georefForm_svelte_svelte_type_style_lang="";function get_each_context$9(l,o,s){const c=l.slice();return c[71]=o[s],c}function create_if_block_10$3(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po=l[9]&&create_if_block_11$3(l);return{c(){o=element("div"),Po&&Po.c(),s=space(),c=element("button"),h=element("span"),h.textContent="report",p=space(),Co=element("button"),Co.innerHTML="<span>JSON</span>",Bo=space(),Lo=element("button"),Lo.innerHTML='<span class="material-icons">clear_all</span>',attr(h,"class","material-icons"),attr(c,"class","georef-tool-button svelte-31lx36"),attr(c,"title","Flag this georef"),c.disabled=d=l[11].flagged,attr(Co,"class","georef-tool-button json-button svelte-31lx36"),attr(Co,"title","Copy georef JSON"),attr(Lo,"class","georef-tool-button svelte-31lx36"),attr(Lo,"title","Copy tab delimited"),attr(o,"class","georef-tool-container svelte-31lx36")},m(Mo,Go){insert(Mo,o,Go),Po&&Po.m(o,null),append(o,s),append(o,c),append(c,h),append(o,p),append(o,Co),append(o,Bo),append(o,Lo),Uo||(Qo=[listen(c,"click",prevent_default(l[31])),listen(Co,"click",prevent_default(l[28])),listen(Lo,"click",prevent_default(l[29]))],Uo=!0)},p(Mo,Go){Mo[9]?Po?Po.p(Mo,Go):(Po=create_if_block_11$3(Mo),Po.c(),Po.m(o,s)):Po&&(Po.d(1),Po=null),Go[0]&2048&&d!==(d=Mo[11].flagged)&&(c.disabled=d)},d(Mo){Mo&&detach(o),Po&&Po.d(),Uo=!1,run_all(Qo)}}}function create_if_block_11$3(l){let o,s,c;return{c(){o=element("button"),o.innerHTML='<span class="material-icons">restore_page</span>',attr(o,"class","georef-tool-button svelte-31lx36"),attr(o,"title","Clear all")},m(h,d){insert(h,o,d),s||(c=listen(o,"click",prevent_default(l[30])),s=!0)},p:noop$2,d(h){h&&detach(o),s=!1,c()}}}function create_if_block_9$4(l){let o;return{c(){o=element("div"),o.innerHTML='<div class="ambiguous-alert svelte-31lx36">Please note this is a blank geoference used for imprecise, ambiguous, or otherwise ungeoreferencable locality strings. Any edits will update it to a regular georeference. Only edit if you understand the consequences for other locaties that might use it...</div>',attr(o,"class","ambiguous-alert-container svelte-31lx36")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_each_block$9(l){let o,s=l[71]+"",c;return{c(){o=element("option"),c=text(s),o.__value=l[71],o.value=o.__value},m(h,d){insert(h,o,d),append(o,c)},p:noop$2,d(h){h&&detach(o)}}}function create_if_block_8$4(l){let o,s,c,h,d,p;return{c(){o=element("div"),s=element("label"),s.innerHTML='<a href="https://dwc.tdwg.org/terms/#dwc:footprintWKT" target="_blank" class="svelte-31lx36">georef WKT</a>',c=space(),h=element("textarea"),attr(s,"for","WKT"),set_style(s,"width","100%"),set_style(s,"text-align","right"),attr(s,"class","svelte-31lx36"),attr(h,"id","WKT"),attr(h,"rows","3"),attr(h,"class","svelte-31lx36")},m(Co,Bo){insert(Co,o,Bo),append(o,s),append(o,c),append(o,h),set_input_value(h,l[11].WKT),d||(p=listen(h,"input",l[48]),d=!0)},p(Co,Bo){Bo[0]&2048&&set_input_value(h,Co[11].WKT)},d(Co){Co&&detach(o),d=!1,p()}}}function create_if_block_6$5(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo;function Qo(Go,$o){return Go[2]?create_if_block_7$4:create_else_block_3$4}let Po=Qo(l),Mo=Po(l);return{c(){o=element("div"),s=element("label"),s.textContent="georef by",c=space(),Mo.c(),h=space(),d=element("div"),p=element("label"),p.textContent="georef by ID",Co=space(),Bo=element("input"),attr(s,"for","georefBy"),attr(s,"class","svelte-31lx36"),attr(o,"class","oneliner svelte-31lx36"),attr(p,"for","georefByORCID"),attr(p,"class","svelte-31lx36"),attr(Bo,"type","text"),attr(Bo,"id","georefByORCID"),set_style(Bo,"width","100%"),set_style(Bo,"max-width","300px"),attr(Bo,"class","svelte-31lx36"),attr(d,"class","oneliner svelte-31lx36")},m(Go,$o){insert(Go,o,$o),append(o,s),append(o,c),Mo.m(o,null),insert(Go,h,$o),insert(Go,d,$o),append(d,p),append(d,Co),append(d,Bo),set_input_value(Bo,l[11].byORCID),Lo||(Uo=listen(Bo,"input",l[52]),Lo=!0)},p(Go,$o){Po===(Po=Qo(Go))&&Mo?Mo.p(Go,$o):(Mo.d(1),Mo=Po(Go),Mo&&(Mo.c(),Mo.m(o,null))),$o[0]&2048&&Bo.value!==Go[11].byORCID&&set_input_value(Bo,Go[11].byORCID)},d(Go){Go&&detach(o),Mo.d(),Go&&detach(h),Go&&detach(d),Lo=!1,Uo()}}}function create_else_block_3$4(l){let o,s,c;return{c(){o=element("input"),attr(o,"type","text"),attr(o,"id","georefBy"),set_style(o,"width","50%"),attr(o,"class","svelte-31lx36"),toggle_class(o,"hasError",l[21])},m(h,d){insert(h,o,d),set_input_value(o,l[11].by),s||(c=listen(o,"input",l[51]),s=!0)},p(h,d){d[0]&2048&&o.value!==h[11].by&&set_input_value(o,h[11].by),d[0]&2097152&&toggle_class(o,"hasError",h[21])},d(h){h&&detach(o),s=!1,c()}}}function create_if_block_7$4(l){let o,s,c,h,d,p;return{c(){o=element("input"),s=space(),c=element("datalist"),h=element("option"),attr(o,"type","text"),attr(o,"list","defaultGeorefBy"),attr(o,"id","georefBy"),set_style(o,"width","70%"),attr(o,"class","svelte-31lx36"),toggle_class(o,"hasError",l[21]),h.__value=l[2],h.value=h.__value,attr(c,"id","defaultGeorefBy")},m(Co,Bo){insert(Co,o,Bo),set_input_value(o,l[11].by),insert(Co,s,Bo),insert(Co,c,Bo),append(c,h),d||(p=listen(o,"input",l[50]),d=!0)},p(Co,Bo){Bo[0]&2048&&o.value!==Co[11].by&&set_input_value(o,Co[11].by),Bo[0]&2097152&&toggle_class(o,"hasError",Co[21]),Bo[0]&4&&(h.__value=Co[2],h.value=h.__value)},d(Co){Co&&detach(o),Co&&detach(s),Co&&detach(c),d=!1,p()}}}function create_else_block_2$7(l){let o,s,c,h,d,p;return{c(){o=element("div"),s=element("label"),s.textContent="protocol",c=space(),h=element("input"),attr(s,"for","protocol"),attr(s,"class","svelte-31lx36"),attr(h,"type","text"),set_style(h,"width","100%"),set_style(h,"max-width","300px"),attr(h,"class","svelte-31lx36"),attr(o,"class","oneliner svelte-31lx36")},m(Co,Bo){insert(Co,o,Bo),append(o,s),append(o,c),append(o,h),set_input_value(h,l[11].protocol),d||(p=listen(h,"input",l[55]),d=!0)},p(Co,Bo){Bo[0]&2048&&h.value!==Co[11].protocol&&set_input_value(h,Co[11].protocol)},i:noop$2,o:noop$2,d(Co){Co&&detach(o),d=!1,p()}}}function create_if_block_5$6(l){let o,s,c,h,d,p,Co;function Bo(Uo){l[54](Uo)}let Lo={items:l[0].map(func$2),isCreatable:!0,placeholder:"Select a protocol...",hasError:l[19]};return l[11].protocolObject!==void 0&&(Lo.value=l[11].protocolObject),d=new Select({props:Lo}),binding_callbacks.push(()=>bind(d,"value",Bo)),d.$on("select",l[35]),{c(){o=element("div"),s=element("label"),s.textContent="protocol",c=space(),h=element("div"),create_component(d.$$.fragment),set_style(s,"width","100%"),set_style(s,"text-align","right"),attr(s,"for","protocol"),attr(s,"class","svelte-31lx36"),attr(h,"class","inline-select svelte-31lx36")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),append(o,c),append(o,h),mount_component(d,h,null),Co=!0},p(Uo,Qo){const Po={};Qo[0]&1&&(Po.items=Uo[0].map(func$2)),Qo[0]&524288&&(Po.hasError=Uo[19]),!p&&Qo[0]&2048&&(p=!0,Po.value=Uo[11].protocolObject,add_flush_callback(()=>p=!1)),d.$set(Po)},i(Uo){Co||(transition_in(d.$$.fragment,Uo),Co=!0)},o(Uo){transition_out(d.$$.fragment,Uo),Co=!1},d(Uo){Uo&&detach(o),destroy_component(d)}}}function create_else_block_1$9(l){let o,s,c,h,d,p;return{c(){o=element("div"),s=element("label"),s.textContent="sources",c=space(),h=element("textarea"),attr(s,"for","sources"),attr(s,"class","svelte-31lx36"),set_style(h,"width","100%"),set_style(h,"max-width","300px"),set_style(h,"rows","2"),set_style(h,"resize","vertical"),attr(h,"class","svelte-31lx36"),attr(o,"class","oneliner svelte-31lx36")},m(Co,Bo){insert(Co,o,Bo),append(o,s),append(o,c),append(o,h),set_input_value(h,l[11].sources),d||(p=listen(h,"input",l[57]),d=!0)},p(Co,Bo){Bo[0]&2048&&set_input_value(h,Co[11].sources)},i:noop$2,o:noop$2,d(Co){Co&&detach(o),d=!1,p()}}}function create_if_block_4$8(l){let o,s,c,h,d,p,Co;function Bo(Uo){l[56](Uo)}let Lo={items:l[1].map(func_1),isCreatable:!0,isMulti:!0,placeholder:"Select source/s...",hasError:l[18]};return l[11].sourcesArray!==void 0&&(Lo.value=l[11].sourcesArray),d=new Select({props:Lo}),binding_callbacks.push(()=>bind(d,"value",Bo)),d.$on("select",l[36]),{c(){o=element("div"),s=element("label"),s.textContent="sources",c=space(),h=element("div"),create_component(d.$$.fragment),set_style(s,"width","100%"),set_style(s,"text-align","right"),attr(s,"for","sources"),attr(s,"class","svelte-31lx36"),attr(h,"class","inline-select svelte-31lx36")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),append(o,c),append(o,h),mount_component(d,h,null),Co=!0},p(Uo,Qo){const Po={};Qo[0]&2&&(Po.items=Uo[1].map(func_1)),Qo[0]&262144&&(Po.hasError=Uo[18]),!p&&Qo[0]&2048&&(p=!0,Po.value=Uo[11].sourcesArray,add_flush_callback(()=>p=!1)),d.$set(Po)},i(Uo){Co||(transition_in(d.$$.fragment,Uo),Co=!0)},o(Uo){transition_out(d.$$.fragment,Uo),Co=!1},d(Uo){Uo&&detach(o),destroy_component(d)}}}function create_if_block_1$e(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts;function ss(gs,Is){return gs[2]?create_if_block_3$9:create_else_block$h}let cs=ss(l),as=cs(l),us=l[3]&&create_if_block_2$b(l);return{c(){o=element("div"),o.innerHTML='<hr class="svelte-31lx36"/><hr class="svelte-31lx36"/>',s=space(),c=element("div"),h=element("label"),h.textContent="verified by",d=space(),as.c(),p=space(),Co=element("div"),Bo=element("label"),Bo.textContent="verified by ID",Lo=space(),Uo=element("input"),Qo=space(),Po=element("div"),Mo=element("label"),Mo.textContent="verifier role",Go=space(),$o=element("input"),jo=space(),zo=element("datalist"),Xo=element("option"),Zo=element("option"),Wo=element("option"),es=space(),us&&us.c(),is=space(),Jo=element("div"),Jo.innerHTML='<hr class="svelte-31lx36"/><hr class="svelte-31lx36"/>',attr(o,"class","hr-break svelte-31lx36"),attr(h,"for","verifiedBy"),attr(h,"class","svelte-31lx36"),attr(c,"class","oneliner svelte-31lx36"),attr(Bo,"for","verifiedByORCID"),attr(Bo,"class","svelte-31lx36"),attr(Uo,"type","text"),attr(Uo,"id","verifiedByORCID"),set_style(Uo,"width","100%"),set_style(Uo,"max-width","300px"),attr(Uo,"class","svelte-31lx36"),attr(Co,"class","oneliner svelte-31lx36"),attr(Mo,"for","verifierRole"),attr(Mo,"class","svelte-31lx36"),attr($o,"id","verifierRole"),attr($o,"list","verifierRoles"),attr($o,"name","verifierRole"),set_style($o,"width","50%"),attr($o,"class","svelte-31lx36"),toggle_class($o,"hasError",l[15]),Xo.__value="quality controller",Xo.value=Xo.__value,Zo.__value="curator",Zo.value=Zo.__value,Wo.__value="collector",Wo.value=Wo.__value,attr(zo,"id","verifierRoles"),attr(Po,"class","oneliner svelte-31lx36"),attr(Jo,"class","hr-break svelte-31lx36")},m(gs,Is){insert(gs,o,Is),insert(gs,s,Is),insert(gs,c,Is),append(c,h),append(c,d),as.m(c,null),insert(gs,p,Is),insert(gs,Co,Is),append(Co,Bo),append(Co,Lo),append(Co,Uo),set_input_value(Uo,l[11].verifiedByORCID),insert(gs,Qo,Is),insert(gs,Po,Is),append(Po,Mo),append(Po,Go),append(Po,$o),set_input_value($o,l[11].verifierRole),append(Po,jo),append(Po,zo),append(zo,Xo),append(zo,Zo),append(zo,Wo),insert(gs,es,Is),us&&us.m(gs,Is),insert(gs,is,Is),insert(gs,Jo,Is),Ko=!0,Yo||(ts=[listen(Uo,"input",l[61]),listen($o,"input",l[62])],Yo=!0)},p(gs,Is){cs===(cs=ss(gs))&&as?as.p(gs,Is):(as.d(1),as=cs(gs),as&&(as.c(),as.m(c,null))),Is[0]&2048&&Uo.value!==gs[11].verifiedByORCID&&set_input_value(Uo,gs[11].verifiedByORCID),Is[0]&2048&&$o.value!==gs[11].verifierRole&&set_input_value($o,gs[11].verifierRole),Is[0]&32768&&toggle_class($o,"hasError",gs[15]),gs[3]?us?(us.p(gs,Is),Is[0]&8&&transition_in(us,1)):(us=create_if_block_2$b(gs),us.c(),transition_in(us,1),us.m(is.parentNode,is)):us&&(group_outros(),transition_out(us,1,1,()=>{us=null}),check_outros())},i(gs){Ko||(transition_in(us),Ko=!0)},o(gs){transition_out(us),Ko=!1},d(gs){gs&&detach(o),gs&&detach(s),gs&&detach(c),as.d(),gs&&detach(p),gs&&detach(Co),gs&&detach(Qo),gs&&detach(Po),gs&&detach(es),us&&us.d(gs),gs&&detach(is),gs&&detach(Jo),Yo=!1,run_all(ts)}}}function create_else_block$h(l){let o,s,c;return{c(){o=element("input"),attr(o,"type","text"),attr(o,"id","verifiedBy"),set_style(o,"width","70%"),attr(o,"class","svelte-31lx36"),toggle_class(o,"hasError",l[17])},m(h,d){insert(h,o,d),set_input_value(o,l[11].verifiedBy),s||(c=listen(o,"input",l[60]),s=!0)},p(h,d){d[0]&2048&&o.value!==h[11].verifiedBy&&set_input_value(o,h[11].verifiedBy),d[0]&131072&&toggle_class(o,"hasError",h[17])},d(h){h&&detach(o),s=!1,c()}}}function create_if_block_3$9(l){let o,s,c,h,d,p;return{c(){o=element("input"),s=space(),c=element("datalist"),h=element("option"),attr(o,"type","text"),attr(o,"list","defaultVerifiedBy"),attr(o,"id","verifiedBy"),set_style(o,"width","70%"),attr(o,"class","svelte-31lx36"),toggle_class(o,"hasError",l[17]),h.__value=l[2],h.value=h.__value,attr(c,"id","defaultVerifiedBy")},m(Co,Bo){insert(Co,o,Bo),set_input_value(o,l[11].verifiedBy),insert(Co,s,Bo),insert(Co,c,Bo),append(c,h),d||(p=listen(o,"input",l[59]),d=!0)},p(Co,Bo){Bo[0]&2048&&o.value!==Co[11].verifiedBy&&set_input_value(o,Co[11].verifiedBy),Bo[0]&131072&&toggle_class(o,"hasError",Co[17]),Bo[0]&4&&(h.__value=Co[2],h.value=h.__value)},d(Co){Co&&detach(o),Co&&detach(s),Co&&detach(c),d=!1,p()}}}function create_if_block_2$b(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo;function Wo(Ko){l[63](Ko)}let es={hasBy:l[11].verifiedBy&&l[11].verifiedBy.trim(),editable:l[3],hasError:l[16]};l[11].verifiedDate!==void 0&&(es.value=l[11].verifiedDate),p=new DateInput({props:es}),binding_callbacks.push(()=>bind(p,"value",Wo));function is(Ko){l[65](Ko)}let Jo={label:"Send feedback"};return l[11].sendVerificationFeedback!==void 0&&(Jo.checked=l[11].sendVerificationFeedback),$o=new Checkbox({props:Jo}),binding_callbacks.push(()=>bind($o,"checked",is)),{c(){o=element("div"),s=element("div"),c=element("div"),h=element("label"),h.textContent="verified date",d=space(),create_component(p.$$.fragment),Bo=space(),Lo=element("div"),Uo=element("label"),Uo.textContent="verification remarks",Qo=space(),Po=element("textarea"),Mo=space(),Go=element("div"),create_component($o.$$.fragment),attr(h,"for","verifiedDate"),set_style(h,"padding-right","10px"),attr(h,"class","svelte-31lx36"),attr(c,"class","flex svelte-31lx36"),attr(s,"class","fields svelte-31lx36"),attr(o,"class","oneliner svelte-31lx36"),attr(Uo,"for","veriremarks"),set_style(Uo,"width","100%"),set_style(Uo,"text-align","right"),attr(Uo,"class","svelte-31lx36"),attr(Po,"id","veriremarks"),attr(Po,"rows","3"),attr(Po,"class","svelte-31lx36")},m(Ko,Yo){insert(Ko,o,Yo),append(o,s),append(s,c),append(c,h),append(c,d),mount_component(p,c,null),insert(Ko,Bo,Yo),insert(Ko,Lo,Yo),append(Lo,Uo),append(Lo,Qo),append(Lo,Po),set_input_value(Po,l[11].verificationRemarks),insert(Ko,Mo,Yo),insert(Ko,Go,Yo),mount_component($o,Go,null),zo=!0,Xo||(Zo=listen(Po,"input",l[64]),Xo=!0)},p(Ko,Yo){const ts={};Yo[0]&2048&&(ts.hasBy=Ko[11].verifiedBy&&Ko[11].verifiedBy.trim()),Yo[0]&8&&(ts.editable=Ko[3]),Yo[0]&65536&&(ts.hasError=Ko[16]),!Co&&Yo[0]&2048&&(Co=!0,ts.value=Ko[11].verifiedDate,add_flush_callback(()=>Co=!1)),p.$set(ts),Yo[0]&2048&&set_input_value(Po,Ko[11].verificationRemarks);const ss={};!jo&&Yo[0]&2048&&(jo=!0,ss.checked=Ko[11].sendVerificationFeedback,add_flush_callback(()=>jo=!1)),$o.$set(ss)},i(Ko){zo||(transition_in(p.$$.fragment,Ko),transition_in($o.$$.fragment,Ko),zo=!0)},o(Ko){transition_out(p.$$.fragment,Ko),transition_out($o.$$.fragment,Ko),zo=!1},d(Ko){Ko&&detach(o),destroy_component(p),Ko&&detach(Bo),Ko&&detach(Lo),Ko&&detach(Mo),Ko&&detach(Go),destroy_component($o),Xo=!1,Zo()}}}function create_if_block$l(l){let o,s,c,h;return{c(){o=element("div"),s=element("button"),c=text(l[10]),attr(s,"class","georefbutton svelte-31lx36"),s.disabled=h=!l[13]&&!l[11].ambiguous,set_style(o,"text-align","center")},m(d,p){insert(d,o,p),append(o,s),append(s,c)},p(d,p){p[0]&1024&&set_data(c,d[10]),p[0]&10240&&h!==(h=!d[13]&&!d[11].ambiguous)&&(s.disabled=h)},d(d){d&&detach(o)}}}function create_fragment$x(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,Hs,ds,hs,ys,ms,Rs,bs,ps,ks,xs,Ss,Us,Ps,Qs,Js,qs,Gs,Zs,Es,fs,vs,Bs,Ls,Fs,zs,js,ma,Ws,va,ca,cl,Ms,$s,ga,Xs,ll,sl=l[4]&&create_if_block_10$3(l),nl=l[11].ambiguous&&create_if_block_9$4();function pl(ua){l[42](ua)}let El={hasError:l[26],editable:l[3]};l[11].locality!==void 0&&(El.value=l[11].locality),Lo=new LocalityInput({props:El}),binding_callbacks.push(()=>bind(Lo,"value",pl));function cA(ua){l[43](ua)}let rl={editable:l[3]};l[11].verbatimCoordinates!==void 0&&(rl.value=l[11].verbatimCoordinates),$o=new VerbatimCoordsInput({props:rl}),binding_callbacks.push(()=>bind($o,"value",cA)),$o.$on("coords-from-verbatim",l[32]),$o.$on("coords-from-paste",l[33]);function Cl(ua){l[44](ua)}let Ul={hasError:l[25],editable:l[3]};l[11].decimalCoordinates!==void 0&&(Ul.value=l[11].decimalCoordinates),es=new DecimalCoordsInput({props:Ul}),binding_callbacks.push(()=>bind(es,"value",Cl)),es.$on("coords-from-paste",l[33]);let Nl=l[27],Ll=[];for(let ua=0;ua<Nl.length;ua+=1)Ll[ua]=create_each_block$9(get_each_context$9(l,Nl,ua));let hl=l[6]&&create_if_block_8$4(l),gl=l[7]&&create_if_block_6$5(l);function zl(ua){l[53](ua)}let bA={hasBy:l[11].by&&l[11].by.trim(),editable:l[3],hasError:l[20]};l[11].date!==void 0&&(bA.value=l[11].date),qs=new DateInput({props:bA}),binding_callbacks.push(()=>bind(qs,"value",zl));const UA=[create_if_block_5$6,create_else_block_2$7],Dl=[];function Kl(ua,_l){return ua[3]?0:1}Es=Kl(l),fs=Dl[Es]=UA[Es](l);const vA=[create_if_block_4$8,create_else_block_1$9],Vl=[];function TA(ua,_l){return ua[3]?0:1}Bs=TA(l),Ls=Vl[Bs]=vA[Bs](l);let Tl=l[8]&&create_if_block_1$e(l),xl=l[5]&&create_if_block$l(l);return{c(){o=element("form"),sl&&sl.c(),s=space(),nl&&nl.c(),c=space(),h=element("fieldset"),d=element("div"),p=element("label"),p.textContent="locality",Co=element("br"),Bo=space(),create_component(Lo.$$.fragment),Qo=space(),Po=element("div"),Mo=element("label"),Mo.textContent="verbatim coords",Go=space(),create_component($o.$$.fragment),zo=space(),Xo=element("div"),Zo=element("label"),Zo.textContent="decimal coords",Wo=space(),create_component(es.$$.fragment),Jo=space(),Ko=element("fieldset"),Yo=element("div"),ts=element("label"),ts.textContent="uncertainty",ss=space(),cs=element("div"),as=element("input"),us=space(),gs=element("select"),Is=element("option");for(let ua=0;ua<Ll.length;ua+=1)Ll[ua].c();_s=space(),hl&&hl.c(),Hs=space(),ds=element("div"),hs=element("label"),hs.textContent="datum",ys=space(),ms=element("input"),Rs=space(),bs=element("datalist"),ps=element("option"),ks=space(),gl&&gl.c(),xs=space(),Ss=element("div"),Us=element("div"),Ps=element("div"),Qs=element("label"),Qs.textContent="georef date",Js=space(),create_component(qs.$$.fragment),Zs=space(),fs.c(),vs=space(),Ls.c(),zs=space(),js=element("div"),ma=element("label"),ma.textContent="georef remarks",Ws=space(),va=element("textarea"),cl=space(),Tl&&Tl.c(),$s=space(),xl&&xl.c(),attr(p,"for","loc"),set_style(p,"width","100%"),set_style(p,"text-align","right"),attr(p,"class","svelte-31lx36"),attr(Mo,"for","verbatimcoords"),attr(Mo,"class","svelte-31lx36"),attr(Po,"class","oneliner svelte-31lx36"),attr(Zo,"for","coords"),attr(Zo,"class","svelte-31lx36"),attr(Xo,"class","oneliner svelte-31lx36"),attr(ts,"for","acc"),attr(ts,"class","svelte-31lx36"),attr(as,"type","number"),attr(as,"id","acc"),attr(as,"min","0"),attr(as,"step","0.1"),attr(as,"class","svelte-31lx36"),toggle_class(as,"hasError",l[24]),Is.selected="selected",Is.__value="",Is.value=Is.__value,attr(gs,"id","accunit"),attr(gs,"class","svelte-31lx36"),l[11].uncertaintyUnit===void 0&&add_render_callback(()=>l[46].call(gs)),toggle_class(gs,"hasError",l[23]),attr(cs,"class","uncertainty-fields svelte-31lx36"),attr(Yo,"class","oneliner svelte-31lx36"),attr(hs,"for","datum"),attr(hs,"class","svelte-31lx36"),attr(ms,"id","datum"),attr(ms,"list","datums"),attr(ms,"name","datum"),set_style(ms,"width","50%"),attr(ms,"class","svelte-31lx36"),toggle_class(ms,"hasError",l[22]),ps.__value="WGS84",ps.value=ps.__value,attr(bs,"id","datums"),attr(ds,"class","oneliner svelte-31lx36"),attr(Qs,"for","georefDate"),set_style(Qs,"padding-right","10px"),attr(Qs,"class","svelte-31lx36"),attr(Ps,"class","flex svelte-31lx36"),attr(Us,"class","fields svelte-31lx36"),attr(Ss,"class","oneliner svelte-31lx36"),attr(Ko,"class","innerfieldset svelte-31lx36"),Ko.disabled=Fs=!l[14],attr(ma,"for","remarks"),set_style(ma,"width","100%"),set_style(ma,"text-align","right"),attr(ma,"class","svelte-31lx36"),attr(va,"id","remarks"),attr(va,"rows","3"),va.disabled=ca=!l[3]||!l[14],attr(va,"class","svelte-31lx36"),h.disabled=Ms=!l[3],attr(h,"class","svelte-31lx36"),attr(o,"class","svelte-31lx36"),toggle_class(o,"form-ambiguous",l[11].ambiguous)},m(ua,_l){insert(ua,o,_l),sl&&sl.m(o,null),append(o,s),nl&&nl.m(o,null),append(o,c),append(o,h),append(h,d),append(d,p),append(d,Co),append(d,Bo),mount_component(Lo,d,null),append(h,Qo),append(h,Po),append(Po,Mo),append(Po,Go),mount_component($o,Po,null),append(h,zo),append(h,Xo),append(Xo,Zo),append(Xo,Wo),mount_component(es,Xo,null),append(h,Jo),append(h,Ko),append(Ko,Yo),append(Yo,ts),append(Yo,ss),append(Yo,cs),append(cs,as),set_input_value(as,l[11].uncertainty),append(cs,us),append(cs,gs),append(gs,Is);for(let uA=0;uA<Ll.length;uA+=1)Ll[uA].m(gs,null);select_option(gs,l[11].uncertaintyUnit),l[47](gs),append(Ko,_s),hl&&hl.m(Ko,null),append(Ko,Hs),append(Ko,ds),append(ds,hs),append(ds,ys),append(ds,ms),set_input_value(ms,l[11].datum),append(ds,Rs),append(ds,bs),append(bs,ps),append(Ko,ks),gl&&gl.m(Ko,null),append(Ko,xs),append(Ko,Ss),append(Ss,Us),append(Us,Ps),append(Ps,Qs),append(Ps,Js),mount_component(qs,Ps,null),append(Ko,Zs),Dl[Es].m(Ko,null),append(Ko,vs),Vl[Bs].m(Ko,null),append(h,zs),append(h,js),append(js,ma),append(js,Ws),append(js,va),set_input_value(va,l[11].remarks),append(h,cl),Tl&&Tl.m(h,null),append(o,$s),xl&&xl.m(o,null),ga=!0,Xs||(ll=[listen(as,"blur",l[34]),listen(as,"input",l[45]),listen(gs,"change",l[46]),listen(ms,"input",l[49]),listen(va,"input",l[58]),listen(o,"submit",prevent_default(l[37]))],Xs=!0)},p(ua,_l){ua[4]?sl?sl.p(ua,_l):(sl=create_if_block_10$3(ua),sl.c(),sl.m(o,s)):sl&&(sl.d(1),sl=null),ua[11].ambiguous?nl||(nl=create_if_block_9$4(),nl.c(),nl.m(o,c)):nl&&(nl.d(1),nl=null);const uA={};_l[0]&67108864&&(uA.hasError=ua[26]),_l[0]&8&&(uA.editable=ua[3]),!Uo&&_l[0]&2048&&(Uo=!0,uA.value=ua[11].locality,add_flush_callback(()=>Uo=!1)),Lo.$set(uA);const fA={};_l[0]&8&&(fA.editable=ua[3]),!jo&&_l[0]&2048&&(jo=!0,fA.value=ua[11].verbatimCoordinates,add_flush_callback(()=>jo=!1)),$o.$set(fA);const hA={};if(_l[0]&33554432&&(hA.hasError=ua[25]),_l[0]&8&&(hA.editable=ua[3]),!is&&_l[0]&2048&&(is=!0,hA.value=ua[11].decimalCoordinates,add_flush_callback(()=>is=!1)),es.$set(hA),_l[0]&2048&&to_number(as.value)!==ua[11].uncertainty&&set_input_value(as,ua[11].uncertainty),_l[0]&16777216&&toggle_class(as,"hasError",ua[24]),_l[0]&134217728){Nl=ua[27];let jl;for(jl=0;jl<Nl.length;jl+=1){const GA=get_each_context$9(ua,Nl,jl);Ll[jl]?Ll[jl].p(GA,_l):(Ll[jl]=create_each_block$9(GA),Ll[jl].c(),Ll[jl].m(gs,null))}for(;jl<Ll.length;jl+=1)Ll[jl].d(1);Ll.length=Nl.length}_l[0]&2048&&select_option(gs,ua[11].uncertaintyUnit),_l[0]&8388608&&toggle_class(gs,"hasError",ua[23]),ua[6]?hl?hl.p(ua,_l):(hl=create_if_block_8$4(ua),hl.c(),hl.m(Ko,Hs)):hl&&(hl.d(1),hl=null),_l[0]&2048&&ms.value!==ua[11].datum&&set_input_value(ms,ua[11].datum),_l[0]&4194304&&toggle_class(ms,"hasError",ua[22]),ua[7]?gl?gl.p(ua,_l):(gl=create_if_block_6$5(ua),gl.c(),gl.m(Ko,xs)):gl&&(gl.d(1),gl=null);const Zl={};_l[0]&2048&&(Zl.hasBy=ua[11].by&&ua[11].by.trim()),_l[0]&8&&(Zl.editable=ua[3]),_l[0]&1048576&&(Zl.hasError=ua[20]),!Gs&&_l[0]&2048&&(Gs=!0,Zl.value=ua[11].date,add_flush_callback(()=>Gs=!1)),qs.$set(Zl);let kA=Es;Es=Kl(ua),Es===kA?Dl[Es].p(ua,_l):(group_outros(),transition_out(Dl[kA],1,1,()=>{Dl[kA]=null}),check_outros(),fs=Dl[Es],fs?fs.p(ua,_l):(fs=Dl[Es]=UA[Es](ua),fs.c()),transition_in(fs,1),fs.m(Ko,vs));let Ml=Bs;Bs=TA(ua),Bs===Ml?Vl[Bs].p(ua,_l):(group_outros(),transition_out(Vl[Ml],1,1,()=>{Vl[Ml]=null}),check_outros(),Ls=Vl[Bs],Ls?Ls.p(ua,_l):(Ls=Vl[Bs]=vA[Bs](ua),Ls.c()),transition_in(Ls,1),Ls.m(Ko,null)),(!ga||_l[0]&16384&&Fs!==(Fs=!ua[14]))&&(Ko.disabled=Fs),(!ga||_l[0]&16392&&ca!==(ca=!ua[3]||!ua[14]))&&(va.disabled=ca),_l[0]&2048&&set_input_value(va,ua[11].remarks),ua[8]?Tl?(Tl.p(ua,_l),_l[0]&256&&transition_in(Tl,1)):(Tl=create_if_block_1$e(ua),Tl.c(),transition_in(Tl,1),Tl.m(h,null)):Tl&&(group_outros(),transition_out(Tl,1,1,()=>{Tl=null}),check_outros()),(!ga||_l[0]&8&&Ms!==(Ms=!ua[3]))&&(h.disabled=Ms),ua[5]?xl?xl.p(ua,_l):(xl=create_if_block$l(ua),xl.c(),xl.m(o,null)):xl&&(xl.d(1),xl=null),_l[0]&2048&&toggle_class(o,"form-ambiguous",ua[11].ambiguous)},i(ua){ga||(transition_in(Lo.$$.fragment,ua),transition_in($o.$$.fragment,ua),transition_in(es.$$.fragment,ua),transition_in(qs.$$.fragment,ua),transition_in(fs),transition_in(Ls),transition_in(Tl),ga=!0)},o(ua){transition_out(Lo.$$.fragment,ua),transition_out($o.$$.fragment,ua),transition_out(es.$$.fragment,ua),transition_out(qs.$$.fragment,ua),transition_out(fs),transition_out(Ls),transition_out(Tl),ga=!1},d(ua){ua&&detach(o),sl&&sl.d(),nl&&nl.d(),destroy_component(Lo),destroy_component($o),destroy_component(es),destroy_each(Ll,ua),l[47](null),hl&&hl.d(),gl&&gl.d(),destroy_component(qs),Dl[Es].d(),Vl[Bs].d(),Tl&&Tl.d(),xl&&xl.d(),Xs=!1,run_all(ll)}}}const func$2=l=>({value:l,label:l}),func_1=l=>({value:l,label:l});function instance$x($$self,$$props,$$invalidate){let hasLocalityAndCoords,localityhasError,coordsHasError,uncertaintyHasError,uncertaintyUnitHasError,datumHasError,georefByHasError,georefDateHasError,protocolHasError,sourcesHasError,verifiedByHasError,verifiedDateHasError,verifierRoleHasError,dispatch=createEventDispatcher(),{georef}=$$props,{defaultGeorefBy=null}=$$props,{defaultGeorefByORCID=null}=$$props,localGeoref=new Georef,{editable=!0}=$$props,{showButtons=!0}=$$props,{showSubmitButton=!0}=$$props,{showWKT=!1}=$$props,{showGeorefBy=!0}=$$props,{showVerification=!1}=$$props,{showResetButton=!0}=$$props,{submitButtonText=""}=$$props,{requiredFields=["uncertainty","datum","by","date"]}=$$props,uncertaintyUnitsEnum=["m","km"],uncertaintySelect,{georefProtocols=["NSCF protocol","SANBI georeferencing guide","Chapman & Wieczorek 2020","Chapman & Wieczorek 2006","Wieczorek et al. 2004"]}=$$props,{georefSources=["Google Maps","Google Earth","Google Satellite","Google Terrain","Google Search","1:250k topomap","1:50k topomap","SANBI gazetteer","Geolocate","Nominatum","verbatim coordinates","NSCF georeference database"]}=$$props;onMount(l=>{let o=localStorage.getItem("custom-protocols");o&&$$invalidate(0,georefProtocols=[...georefProtocols,...JSON.parse(o)]);let s=localStorage.getItem("custom-sources");s&&$$invalidate(1,georefSources=[...georefSources,...JSON.parse(s)])});let metaEditable,validationVars=["localityhasError","coordsHasError","uncertaintyHasError","uncertaintyUnitHasError","datumHasError","georefByHasError","georefDateHasError","protocolHasError","sourcesHasError","verifiedByHasError","verifiedDateHasError","verifierRoleHasError"];const clear=l=>{if($$invalidate(11,localGeoref=new Georef),defaultGeorefBy){$$invalidate(11,localGeoref.by=defaultGeorefBy,localGeoref);let o=new Date;$$invalidate(11,localGeoref.date=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3).toISOString().split("T")[0],localGeoref),defaultGeorefByORCID&&$$invalidate(11,localGeoref.byORCID=defaultGeorefByORCID,localGeoref)}},setLocalGeoref=l=>{if($$invalidate(14,metaEditable=!1),georef&&georef instanceof Georef){if($$invalidate(11,localGeoref=georef.copy()),editable&&!localGeoref.ambiguous){let o=[localGeoref.uncertainty,localGeoref.datum,localGeoref.by,localGeoref.date,localGeoref.sources,localGeoref.protocol];$$invalidate(14,metaEditable=showVerification||o.some(s=>!s))}}else if($$invalidate(11,localGeoref=new Georef),defaultGeorefBy){$$invalidate(11,localGeoref.by=defaultGeorefBy,localGeoref);let o=new Date;$$invalidate(11,localGeoref.date=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3).toISOString().split("T")[0],localGeoref),defaultGeorefByORCID&&$$invalidate(11,localGeoref.byORCID=defaultGeorefByORCID,localGeoref)}},setDefaultORCID=l=>{localGeoref[l]&&localGeoref[l].trim()?defaultGeorefBy&&(defaultGeorefByORCID?localGeoref[l]==defaultGeorefBy&&$$invalidate(11,localGeoref[l+"ORCID"]=defaultGeorefByORCID,localGeoref):$$invalidate(11,localGeoref[l+"ORCID"]=null,localGeoref)):$$invalidate(11,localGeoref[l+"ORCID"]=null,localGeoref)},updateOnLocalityChange=l=>{if(localGeoref.locality&&georef&&(localGeoref.verbatimCoordinates||localGeoref.originalGeorefSource)){let o=localGeoref.locality.replace(/\s+/," ").toLowerCase(),s=georef.locality.replace(/\s+/," ").toLowerCase();o!=s&&($$invalidate(11,localGeoref.verbatimCoordinates=null,localGeoref),$$invalidate(11,localGeoref.originalGeorefSource=null,localGeoref),$$invalidate(11,localGeoref.ambiguous=!1,localGeoref),editable&&$$invalidate(14,metaEditable=!0))}},copyGeorefJSON=l=>{l.preventDefault(),navigator.clipboard.writeText(JSON.stringify(localGeoref,null,2)).then(o=>{window.pushToast&&window.pushToast("georef JSON copied")})},copyTabDelimited=l=>{let o="";for(let s of Object.values(localGeoref))s?o+=s+"	":o+="	";navigator.clipboard.writeText(o).then(s=>{console.log("tab delimited values copied"),window.pushToast&&window.pushToast("tab delimited data copied")})},handleClearClick=l=>{georef&&georef instanceof Georef&&dispatch("clear-georef"),clear(),window.pushToast&&window.pushToast("new georef")},flagGeoref=l=>{localGeoref.flagged||confirm("Are you sure you want to flag this georeference?")&&($$invalidate(11,localGeoref.flagged=!0,localGeoref),dispatch("georef-flagged",localGeoref.georefID))},handleCoordsFromVerbatim=l=>{try{let o=l.detail;localGeoref.decimalCoordinates&&localGeoref.decimalCoordinates.replace(/\s+/g,"")!=o?($$invalidate(11,localGeoref.decimalCoordinates=o,localGeoref),$$invalidate(11,localGeoref.sources="verbatim coordinates",localGeoref),$$invalidate(11,localGeoref.originalGeorefSource=null,localGeoref),$$invalidate(11,localGeoref.ambiguous=!1,localGeoref),dispatch("coords-from-paste",localGeoref.decimalCoordinates)):($$invalidate(11,localGeoref.decimalCoordinates=o,localGeoref),$$invalidate(11,localGeoref.sources="verbatim coordinates",localGeoref),$$invalidate(11,localGeoref.originalGeorefSource=null,localGeoref),dispatch("coords-from-paste",localGeoref.decimalCoordinates)),editable&&$$invalidate(14,metaEditable=!0)}catch(o){alert(o.message)}},handleCoordsFromPaste=l=>{editable&&$$invalidate(14,metaEditable=!0),$$invalidate(11,localGeoref.verbatimCoordinates=null,localGeoref),$$invalidate(11,localGeoref.originalGeorefSource=null,localGeoref),$$invalidate(11,localGeoref.ambiguous=!1,localGeoref),dispatch("coords-from-paste",localGeoref.decimalCoordinates)},handleUncertaintyBlur=l=>{if(!localGeoref.uncertainty){let o=uncertaintySelect.options;for(let s=0,c=o.length;s<c;s++)if(o[s].defaultSelected){$$invalidate(12,uncertaintySelect.selectedIndex=s,uncertaintySelect);return}$$invalidate(12,uncertaintySelect.selectedIndex=0,uncertaintySelect)}},handleProtocolSelected=l=>{if(localGeoref.protocolObject&&!georefProtocols.includes(localGeoref.protocolObject.value)){$$invalidate(0,georefProtocols=[...georefProtocols,localGeoref.protocolObject.value]);let o=[],s=localStorage.getItem("custom-protocols");s&&(o=JSON.parse(s)),o.push(localGeoref.protocolObject.value),localStorage.setItem("custom-protocols",JSON.stringify(o))}},handleSourceSelected=l=>{if(localGeoref.sourcesArray&&localGeoref.sourcesArray.length){for(let o of localGeoref.sourcesArray)if(!georefSources.includes(o.value)){$$invalidate(1,georefSources=[...georefSources,o.value]);let s=[],c=localStorage.getItem("custom-sources");c&&(s=JSON.parse(c)),s.push(o.value),localStorage.setItem("custom-sources",JSON.stringify(s));break}}},checkAndDispatchGeoref=_=>{try{if(localGeoref.differentTo(georef)){let invalidFields=[];for(let v of validationVars)eval(v)&&invalidFields.push(v.replace("HasError",""));if(invalidFields.length){let l=`The following fields have invalid values: ${invalidFields}.\r
\r
Do you want to continue?`;if(!confirm(l))return}localGeoref.resetFieldsIfDifferent()}dispatch("set-georef",localGeoref)}catch(l){alert("error checking georefs are equal: "+l.message)}};function localityinput_value_binding(l){$$self.$$.not_equal(localGeoref.locality,l)&&(localGeoref.locality=l,$$invalidate(11,localGeoref))}function verbatimcoordsinput_value_binding(l){$$self.$$.not_equal(localGeoref.verbatimCoordinates,l)&&(localGeoref.verbatimCoordinates=l,$$invalidate(11,localGeoref))}function decimalcoordsinput_value_binding(l){$$self.$$.not_equal(localGeoref.decimalCoordinates,l)&&(localGeoref.decimalCoordinates=l,$$invalidate(11,localGeoref))}function input0_input_handler(){localGeoref.uncertainty=to_number(this.value),$$invalidate(11,localGeoref)}function select_change_handler(){localGeoref.uncertaintyUnit=select_value(this),$$invalidate(11,localGeoref)}function select_binding(l){binding_callbacks[l?"unshift":"push"](()=>{uncertaintySelect=l,$$invalidate(12,uncertaintySelect),$$invalidate(27,uncertaintyUnitsEnum)})}function textarea_input_handler(){localGeoref.WKT=this.value,$$invalidate(11,localGeoref)}function input1_input_handler(){localGeoref.datum=this.value,$$invalidate(11,localGeoref)}function input_input_handler(){localGeoref.by=this.value,$$invalidate(11,localGeoref)}function input_input_handler_1(){localGeoref.by=this.value,$$invalidate(11,localGeoref)}function input_input_handler_2(){localGeoref.byORCID=this.value,$$invalidate(11,localGeoref)}function dateinput_value_binding(l){$$self.$$.not_equal(localGeoref.date,l)&&(localGeoref.date=l,$$invalidate(11,localGeoref))}function select_value_binding(l){$$self.$$.not_equal(localGeoref.protocolObject,l)&&(localGeoref.protocolObject=l,$$invalidate(11,localGeoref))}function input_input_handler_3(){localGeoref.protocol=this.value,$$invalidate(11,localGeoref)}function select_value_binding_1(l){$$self.$$.not_equal(localGeoref.sourcesArray,l)&&(localGeoref.sourcesArray=l,$$invalidate(11,localGeoref))}function textarea_input_handler_1(){localGeoref.sources=this.value,$$invalidate(11,localGeoref)}function textarea_input_handler_2(){localGeoref.remarks=this.value,$$invalidate(11,localGeoref)}function input_input_handler_4(){localGeoref.verifiedBy=this.value,$$invalidate(11,localGeoref)}function input_input_handler_5(){localGeoref.verifiedBy=this.value,$$invalidate(11,localGeoref)}function input0_input_handler_1(){localGeoref.verifiedByORCID=this.value,$$invalidate(11,localGeoref)}function input1_input_handler_1(){localGeoref.verifierRole=this.value,$$invalidate(11,localGeoref)}function dateinput_value_binding_1(l){$$self.$$.not_equal(localGeoref.verifiedDate,l)&&(localGeoref.verifiedDate=l,$$invalidate(11,localGeoref))}function textarea_input_handler_3(){localGeoref.verificationRemarks=this.value,$$invalidate(11,localGeoref)}function checkbox_checked_binding(l){$$self.$$.not_equal(localGeoref.sendVerificationFeedback,l)&&(localGeoref.sendVerificationFeedback=l,$$invalidate(11,localGeoref))}return $$self.$$set=l=>{"georef"in l&&$$invalidate(38,georef=l.georef),"defaultGeorefBy"in l&&$$invalidate(2,defaultGeorefBy=l.defaultGeorefBy),"defaultGeorefByORCID"in l&&$$invalidate(39,defaultGeorefByORCID=l.defaultGeorefByORCID),"editable"in l&&$$invalidate(3,editable=l.editable),"showButtons"in l&&$$invalidate(4,showButtons=l.showButtons),"showSubmitButton"in l&&$$invalidate(5,showSubmitButton=l.showSubmitButton),"showWKT"in l&&$$invalidate(6,showWKT=l.showWKT),"showGeorefBy"in l&&$$invalidate(7,showGeorefBy=l.showGeorefBy),"showVerification"in l&&$$invalidate(8,showVerification=l.showVerification),"showResetButton"in l&&$$invalidate(9,showResetButton=l.showResetButton),"submitButtonText"in l&&$$invalidate(10,submitButtonText=l.submitButtonText),"requiredFields"in l&&$$invalidate(40,requiredFields=l.requiredFields),"georefProtocols"in l&&$$invalidate(0,georefProtocols=l.georefProtocols),"georefSources"in l&&$$invalidate(1,georefSources=l.georefSources)},$$self.$$.update=()=>{$$self.$$.dirty[0]&2048&&localGeoref&&localGeoref.verifiedBy&&localGeoref.verifiedDate&&localGeoref.verifiedByRole&&$$invalidate(11,localGeoref.verified=!0,localGeoref),$$self.$$.dirty[0]&2056&&$$invalidate(13,hasLocalityAndCoords=editable&&Boolean(localGeoref.locality&&localGeoref.locality.trim()&&localGeoref.decimalCoordinates)),$$self.$$.dirty[0]&2056&&$$invalidate(26,localityhasError=editable&&Boolean(localGeoref.decimalCoordinates&&(!localGeoref.locality||!localGeoref.locality.trim()))),$$self.$$.dirty[0]&2056&&$$invalidate(25,coordsHasError=editable&&Boolean(localGeoref.locality&&localGeoref.locality.trim()&&(!localGeoref.decimalCoordinates||!localGeoref.decimalCoordinatesOkay||localGeoref.decimalCoordinatesWarning)&&!localGeoref.ambiguous)),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(24,uncertaintyHasError=editable&&Boolean(hasLocalityAndCoords&&requiredFields.includes("uncertainty")&&!localGeoref.uncertainty&&!localGeoref.ambiguous)),$$self.$$.dirty[0]&2056&&$$invalidate(23,uncertaintyUnitHasError=editable&&Boolean(localGeoref.uncertainty&&!localGeoref.uncertaintyUnit&&!localGeoref.ambiguous)),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(22,datumHasError=editable&&Boolean(hasLocalityAndCoords&&requiredFields.includes("datum")&&(!localGeoref.datum||!localGeoref.datum.trim())&&!localGeoref.ambiguous)),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(21,georefByHasError=editable&&Boolean(hasLocalityAndCoords&&requiredFields.includes("by")&&(!localGeoref.by||!localGeoref.by.trim())&&!localGeoref.ambiguous)),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(20,georefDateHasError=editable&&Boolean(hasLocalityAndCoords&&(localGeoref.by&&localGeoref.by.trim()||requiredFields.includes("date"))&&(!localGeoref.date||!localGeoref.date.trim())&&!localGeoref.ambiguous)),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(19,protocolHasError=editable&&Boolean(hasLocalityAndCoords&&requiredFields.includes("protocol")&&(!localGeoref.protocolObject||!localGeoref.protocolObject.value)&&!localGeoref.ambiguous)),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(18,sourcesHasError=editable&&Boolean(hasLocalityAndCoords&&requiredFields.includes("sources")&&(!localGeoref.sourcesArray||!localGeoref.sourcesArray.length)&&!localGeoref.ambiguous)),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(17,verifiedByHasError=editable&&Boolean(hasLocalityAndCoords&&requiredFields.includes("verifiedBy")&&(!localGeoref.verifiedBy||!localGeoref.verifiedBy.trim()))),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(16,verifiedDateHasError=editable&&Boolean(hasLocalityAndCoords&&(localGeoref.verifiedBy&&localGeoref.verifiedBy.trim()||requiredFields.includes("verifiedDate"))&&(!localGeoref.verifiedDate||!localGeoref.verifiedDate.trim()))),$$self.$$.dirty[0]&10248|$$self.$$.dirty[1]&512&&$$invalidate(15,verifierRoleHasError=editable&&Boolean(hasLocalityAndCoords&&requiredFields.includes("verifierRole")&&(!localGeoref.verifierRole||!localGeoref.verifierRole.trim()))),$$self.$$.dirty[1]&128&&setLocalGeoref(),$$self.$$.dirty[0]&2048&&(localGeoref.by,setDefaultORCID("by")),$$self.$$.dirty[0]&2048&&(localGeoref.verifiedBy,setDefaultORCID("verifiedBy")),$$self.$$.dirty[0]&2048&&(localGeoref.locality,updateOnLocalityChange()),$$self.$$.dirty[0]&6144&&uncertaintySelect&&!localGeoref.uncertaintyUnit&&handleUncertaintyBlur(),$$self.$$.dirty[0]&2304&&localGeoref&&showVerification&&localGeoref.uncertainty&&localGeoref.uncertaintyUnit&&dispatch("uncertainty-changed",{uncertainty:localGeoref.uncertainty,uncertaintyUnit:localGeoref.uncertaintyUnit}),$$self.$$.dirty[0]&2304&&localGeoref&&showVerification&&localGeoref.locality&&dispatch("locality-changed",{locality:localGeoref.locality})},[georefProtocols,georefSources,defaultGeorefBy,editable,showButtons,showSubmitButton,showWKT,showGeorefBy,showVerification,showResetButton,submitButtonText,localGeoref,uncertaintySelect,hasLocalityAndCoords,metaEditable,verifierRoleHasError,verifiedDateHasError,verifiedByHasError,sourcesHasError,protocolHasError,georefDateHasError,georefByHasError,datumHasError,uncertaintyUnitHasError,uncertaintyHasError,coordsHasError,localityhasError,uncertaintyUnitsEnum,copyGeorefJSON,copyTabDelimited,handleClearClick,flagGeoref,handleCoordsFromVerbatim,handleCoordsFromPaste,handleUncertaintyBlur,handleProtocolSelected,handleSourceSelected,checkAndDispatchGeoref,georef,defaultGeorefByORCID,requiredFields,clear,localityinput_value_binding,verbatimcoordsinput_value_binding,decimalcoordsinput_value_binding,input0_input_handler,select_change_handler,select_binding,textarea_input_handler,input1_input_handler,input_input_handler,input_input_handler_1,input_input_handler_2,dateinput_value_binding,select_value_binding,input_input_handler_3,select_value_binding_1,textarea_input_handler_1,textarea_input_handler_2,input_input_handler_4,input_input_handler_5,input0_input_handler_1,input1_input_handler_1,dateinput_value_binding_1,textarea_input_handler_3,checkbox_checked_binding]}class GeorefForm extends SvelteComponent{constructor(o){super(),init(this,o,instance$x,create_fragment$x,safe_not_equal,{georef:38,defaultGeorefBy:2,defaultGeorefByORCID:39,editable:3,showButtons:4,showSubmitButton:5,showWKT:6,showGeorefBy:7,showVerification:8,showResetButton:9,submitButtonText:10,requiredFields:40,georefProtocols:0,georefSources:1,clear:41},null,[-1,-1,-1])}get clear(){return this.$$.ctx[41]}}const toast_svelte_svelte_type_style_lang="";function get_each_context$8(l,o,s){const c=l.slice();return c[5]=o[s],c}function create_each_block$8(l,o){let s,c=o[5].msg+"",h,d,p,Co,Bo;return{key:l,first:null,c(){s=element("div"),h=text(c),d=space(),attr(s,"class","toast-item svelte-rqkiq9"),this.first=s},m(Lo,Uo){insert(Lo,s,Uo),append(s,h),append(s,d),Bo=!0},p(Lo,Uo){o=Lo,(!Bo||Uo&1)&&c!==(c=o[5].msg+"")&&set_data(h,c)},i(Lo){Bo||(add_render_callback(()=>{Co&&Co.end(1),p=create_in_transition(s,fly,{delay:0,duration:300,x:0,y:50,opacity:.1,easing:backOut}),p.start()}),Bo=!0)},o(Lo){p&&p.invalidate(),Co=create_out_transition(s,fade,{duration:500,opacity:0}),Bo=!1},d(Lo){Lo&&detach(s),Lo&&Co&&Co.end()}}}function create_fragment$w(l){let o,s=[],c=new Map,h,d=l[0];const p=Co=>Co[5]._id;for(let Co=0;Co<d.length;Co+=1){let Bo=get_each_context$8(l,d,Co),Lo=p(Bo);c.set(Lo,s[Co]=create_each_block$8(Lo,Bo))}return{c(){o=element("div");for(let Co=0;Co<s.length;Co+=1)s[Co].c();attr(o,"class","toast-wrapper svelte-rqkiq9")},m(Co,Bo){insert(Co,o,Bo);for(let Lo=0;Lo<s.length;Lo+=1)s[Lo].m(o,null);h=!0},p(Co,[Bo]){Bo&1&&(d=Co[0],group_outros(),s=update_keyed_each(s,Bo,p,1,Co,d,c,o,outro_and_destroy_block,create_each_block$8,null,get_each_context$8),check_outros())},i(Co){if(!h){for(let Bo=0;Bo<d.length;Bo+=1)transition_in(s[Bo]);h=!0}},o(Co){for(let Bo=0;Bo<s.length;Bo+=1)transition_out(s[Bo]);h=!1},d(Co){Co&&detach(o);for(let Bo=0;Bo<s.length;Bo+=1)s[Bo].d()}}}function instance$w(l,o,s){let c=[],{retainMs:h=1e3}=o,d=0;const p=(Bo="")=>{s(0,c=[...c,{_id:++d,msg:Bo}]),setTimeout(()=>{Co()},h)},Co=()=>{s(0,c=c.filter((Bo,Lo)=>Lo>0))};return onMount(()=>{window.pushToast=p}),l.$$set=Bo=>{"retainMs"in Bo&&s(1,h=Bo.retainMs)},[c,h]}class Toast extends SvelteComponent{constructor(o){super(),init(this,o,instance$w,create_fragment$w,safe_not_equal,{retainMs:1})}}const manualGeoref_svelte_svelte_type_style_lang="";function get_each_context$7(l,o,s){const c=l.slice();return c[20]=o[s],c}function get_each_context_1$1(l,o,s){const c=l.slice();return c[20]=o[s],c}function create_else_block$g(l){let o;return{c(){o=element("option"),o.textContent="One moment please...",o.__value="",o.value=o.__value,o.selected=!0,o.disabled=!0},m(s,c){insert(s,o,c)},p:noop$2,d(s){s&&detach(o)}}}function create_if_block_1$d(l){let o,s=l[2],c=[];for(let h=0;h<s.length;h+=1)c[h]=create_each_block_1$1(get_each_context_1$1(l,s,h));return{c(){for(let h=0;h<c.length;h+=1)c[h].c();o=empty$1()},m(h,d){for(let p=0;p<c.length;p+=1)c[p].m(h,d);insert(h,o,d)},p(h,d){if(d&4){s=h[2];let p;for(p=0;p<s.length;p+=1){const Co=get_each_context_1$1(h,s,p);c[p]?c[p].p(Co,d):(c[p]=create_each_block_1$1(Co),c[p].c(),c[p].m(o.parentNode,o))}for(;p<c.length;p+=1)c[p].d(1);c.length=s.length}},d(h){destroy_each(c,h),h&&detach(o)}}}function create_each_block_1$1(l){let o,s=l[20].label+"",c,h,d;return{c(){o=element("option"),c=text(s),o.__value=h=l[20].value,o.value=o.__value,o.selected=d=l[20].value=="Southern Africa"},m(p,Co){insert(p,o,Co),append(o,c)},p(p,Co){Co&4&&s!==(s=p[20].label+"")&&set_data(c,s),Co&4&&h!==(h=p[20].value)&&(o.__value=h,o.value=o.__value),Co&4&&d!==(d=p[20].value=="Southern Africa")&&(o.selected=d)},d(p){p&&detach(o)}}}function create_each_block$7(l){let o,s=l[20].label+"",c;return{c(){o=element("option"),c=text(s),o.__value=l[20].value,o.value=o.__value},m(h,d){insert(h,o,d),append(o,c)},p:noop$2,d(h){h&&detach(o)}}}function create_if_block$k(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo;return h=new GeorefMatchList({}),h.$on("georef-selected",l[10]),Lo=new GeorefMatchMap({props:{pastedDecimalCoords:l[7]}}),Lo.$on("georef-selected",l[10]),Go=new GeorefForm({props:{editable:!1,showVerification:!0,georef:l[3],showResetButton:!1,showSubmitButton:!1}}),Go.$on("georef-flagged",l[12]),{c(){o=element("div"),s=element("div"),c=element("div"),create_component(h.$$.fragment),d=space(),p=element("div"),Co=space(),Bo=element("div"),create_component(Lo.$$.fragment),Uo=space(),Qo=element("div"),Po=element("h4"),Po.textContent="Georeference",Mo=space(),create_component(Go.$$.fragment),attr(c,"class","table-flex svelte-9b9qz4"),attr(p,"class","table-plug svelte-9b9qz4"),attr(s,"class","table-container svelte-9b9qz4"),attr(Bo,"class","map-container svelte-9b9qz4"),attr(Po,"class","svelte-9b9qz4"),attr(Qo,"class","form-container svelte-9b9qz4"),attr(o,"class","grid-container svelte-9b9qz4")},m(zo,Xo){insert(zo,o,Xo),append(o,s),append(s,c),mount_component(h,c,null),append(s,d),append(s,p),append(o,Co),append(o,Bo),mount_component(Lo,Bo,null),append(o,Uo),append(o,Qo),append(Qo,Po),append(Qo,Mo),mount_component(Go,Qo,null),jo=!0},p(zo,Xo){const Zo={};Xo&8&&(Zo.georef=zo[3]),Go.$set(Zo)},i(zo){jo||(transition_in(h.$$.fragment,zo),transition_in(Lo.$$.fragment,zo),transition_in(Go.$$.fragment,zo),$o||add_render_callback(()=>{$o=create_in_transition(o,fly,{y:200,duration:1e3}),$o.start()}),jo=!0)},o(zo){transition_out(h.$$.fragment,zo),transition_out(Lo.$$.fragment,zo),transition_out(Go.$$.fragment,zo),jo=!1},d(zo){zo&&detach(o),destroy_component(h),destroy_component(Lo),destroy_component(Go)}}}function create_fragment$v(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo;h=new CustomSearch({props:{placeholder:`Search for a locality in ${l[0]}`,elasticindex:l[5]}}),h.$on("custom-georefs",l[9]),h.$on("custom-search-searching",l[14]),h.$on("custom-search-cleared",l[11]);function zo(Jo,Ko){return Jo[2]?create_if_block_1$d:create_else_block$g}let Xo=zo(l),Zo=Xo(l),Wo=l[8],es=[];for(let Jo=0;Jo<Wo.length;Jo+=1)es[Jo]=create_each_block$7(get_each_context$7(l,Wo,Jo));let is=l[6].georefIndex&&create_if_block$k(l);return Mo=new Toast({}),{c(){o=element("div"),s=element("div"),c=element("div"),create_component(h.$$.fragment),d=space(),p=element("div"),Co=element("select"),Zo.c(),Bo=space(),Lo=element("div"),Uo=element("select");for(let Jo=0;Jo<es.length;Jo+=1)es[Jo].c();Qo=space(),is&&is.c(),Po=space(),create_component(Mo.$$.fragment),attr(Co,"id","region-select"),attr(Co,"class","svelte-9b9qz4"),l[0]===void 0&&add_render_callback(()=>l[15].call(Co)),attr(p,"class","inline-select svelte-9b9qz4"),set_style(p,"width","59%"),attr(Uo,"class","svelte-9b9qz4"),l[1]===void 0&&add_render_callback(()=>l[17].call(Uo)),attr(Lo,"class","inline-select svelte-9b9qz4"),set_style(Lo,"width","40%"),attr(s,"class","search-container svelte-9b9qz4"),toggle_class(s,"left",Boolean(l[6].georefIndex)),attr(o,"class","container svelte-9b9qz4")},m(Jo,Ko){insert(Jo,o,Ko),append(o,s),append(s,c),mount_component(h,c,null),append(c,d),append(c,p),append(p,Co),Zo.m(Co,null),select_option(Co,l[0]),l[16](Co),append(c,Bo),append(c,Lo),append(Lo,Uo);for(let Yo=0;Yo<es.length;Yo+=1)es[Yo].m(Uo,null);select_option(Uo,l[1]),append(o,Qo),is&&is.m(o,null),append(o,Po),mount_component(Mo,o,null),Go=!0,$o||(jo=[listen(Co,"change",l[15]),listen(Uo,"change",l[17])],$o=!0)},p(Jo,[Ko]){const Yo={};if(Ko&1&&(Yo.placeholder=`Search for a locality in ${Jo[0]}`),Ko&32&&(Yo.elasticindex=Jo[5]),h.$set(Yo),Xo===(Xo=zo(Jo))&&Zo?Zo.p(Jo,Ko):(Zo.d(1),Zo=Xo(Jo),Zo&&(Zo.c(),Zo.m(Co,null))),Ko&1&&select_option(Co,Jo[0]),Ko&256){Wo=Jo[8];let ts;for(ts=0;ts<Wo.length;ts+=1){const ss=get_each_context$7(Jo,Wo,ts);es[ts]?es[ts].p(ss,Ko):(es[ts]=create_each_block$7(ss),es[ts].c(),es[ts].m(Uo,null))}for(;ts<es.length;ts+=1)es[ts].d(1);es.length=Wo.length}Ko&258&&select_option(Uo,Jo[1]),Ko&64&&toggle_class(s,"left",Boolean(Jo[6].georefIndex)),Jo[6].georefIndex?is?(is.p(Jo,Ko),Ko&64&&transition_in(is,1)):(is=create_if_block$k(Jo),is.c(),transition_in(is,1),is.m(o,Po)):is&&(group_outros(),transition_out(is,1,1,()=>{is=null}),check_outros())},i(Jo){Go||(transition_in(h.$$.fragment,Jo),transition_in(is),transition_in(Mo.$$.fragment,Jo),Go=!0)},o(Jo){transition_out(h.$$.fragment,Jo),transition_out(is),transition_out(Mo.$$.fragment,Jo),Go=!1},d(Jo){Jo&&detach(o),destroy_component(h),Zo.d(),l[16](null),destroy_each(es,Jo),is&&is.d(),destroy_component(Mo),$o=!1,run_all(jo)}}}function instance$v(l,o,s){let c;component_subscribe(l,dataStore,Jo=>s(6,c=Jo));const h=createEventDispatcher();let d,p,Co,Bo;const Lo=[{value:"TER",label:"terrestrial"}];let Uo,Qo,Po,Mo;onMount(async Jo=>{let Ko=await Realtime.ref("settings/georefRegions").once("value");s(13,d=Ko.val()),set_store_value(dataStore,c.georefIndex=null,c)}),afterUpdate(Jo=>{p&&p.length&&s(0,Qo=document.getElementById("region-select").value)});const Go=Jo=>{set_store_value(dataStore,c.georefIndex=Jo.detail,c)},$o=Jo=>{if(c.selectedGeorefID&&jo(c.selectedGeorefID),Jo&&Jo.detail){let Ko=Jo.detail;s(3,Bo=c.georefIndex[Ko]),s(3,Bo.selected=!0,Bo);let Yo=c.markers[Ko];Yo&&(Yo.setIcon({path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"blue",fillOpacity:1,strokeColor:"blue"}),Yo.setZIndex(1),Yo.panToMe()),set_store_value(dataStore,c.selectedGeorefID=Ko,c),set_store_value(dataStore,c.georefIndex=c.georefIndex,c)}},jo=Jo=>{let Ko=c.markers[Jo];Ko&&(Ko.setIcon({path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"green",fillOpacity:1,strokeColor:"green"}),Ko.setZIndex(0)),c.georefIndex[Jo]&&set_store_value(dataStore,c.georefIndex[Jo].selected=!1,c),set_store_value(dataStore,c.selectedGeorefID=null,c),Bo&&(s(3,Bo.selected=!1,Bo),s(3,Bo=null))},zo=Jo=>{set_store_value(dataStore,c.georefIndex=null,c),h("custom-search-cleared")},Xo=async Jo=>{const Ko=Jo.detail;await flagGeoref(Ko,Mo)};function Zo(Jo){bubble.call(this,l,Jo)}function Wo(){Qo=select_value(this),s(0,Qo),s(13,d)}function es(Jo){binding_callbacks[Jo?"unshift":"push"](()=>{Uo=Jo,s(4,Uo),s(2,p),s(13,d),s(0,Qo)})}function is(){Po=select_value(this),s(1,Po),s(8,Lo)}return l.$$.update=()=>{l.$$.dirty&8193&&d&&Object.keys(d).length&&(s(2,p=Object.keys(d).map(Jo=>({value:Jo,label:Jo}))),s(0,Qo),s(13,d)),l.$$.dirty&3&&(Qo&&Po?s(5,Mo=(Qo+Po).toLowerCase().replace(/\s+/g,"")):s(5,Mo=null))},[Qo,Po,p,Bo,Uo,Mo,c,Co,Lo,Go,$o,zo,Xo,d,Zo,Wo,es,is]}class ManualGeoref extends SvelteComponent{constructor(o){super(),init(this,o,instance$v,create_fragment$v,safe_not_equal,{})}}const Alert_svelte_svelte_type_style_lang="";function create_fragment$u(l){let o,s,c,h,d,p,Co,Bo;return{c(){o=element("p"),s=text(l[0]),c=space(),h=element("button"),h.textContent="Okay",d=space(),p=element("div"),attr(o,"class","svelte-14pwi7k"),set_style(h,"width","110px"),set_style(h,"float","right"),set_style(p,"clear","both")},m(Lo,Uo){insert(Lo,o,Uo),append(o,s),insert(Lo,c,Uo),insert(Lo,h,Uo),insert(Lo,d,Uo),insert(Lo,p,Uo),Co||(Bo=listen(h,"click",l[1]),Co=!0)},p(Lo,[Uo]){Uo&1&&set_data(s,Lo[0])},i:noop$2,o:noop$2,d(Lo){Lo&&detach(o),Lo&&detach(c),Lo&&detach(h),Lo&&detach(d),Lo&&detach(p),Co=!1,Bo()}}}function instance$u(l,o,s){const{close:c}=getContext("simple-modal");let{message:h}=o;return l.$$set=d=>{"message"in d&&s(0,h=d.message)},[h,c]}class Alert extends SvelteComponent{constructor(o){super(),init(this,o,instance$u,create_fragment$u,safe_not_equal,{message:0})}}const home_svelte_svelte_type_style_lang="";function create_else_block$f(l){let o;return{c(){o=element("div"),set_style(o,"margin-top","20px")},m(s,c){insert(s,o,c)},p:noop$2,d(s){s&&detach(o)}}}function create_if_block_3$8(l){let o,s,c,h=!l[0]&&create_if_block_4$7(l);return{c(){o=element("h1"),o.textContent="Welcome to the NSCF Georeferencer",s=space(),h&&h.c(),c=empty$1(),attr(o,"class","svelte-1lfowh0")},m(d,p){insert(d,o,p),insert(d,s,p),h&&h.m(d,p),insert(d,c,p)},p(d,p){d[0]?h&&(h.d(1),h=null):h?h.p(d,p):(h=create_if_block_4$7(d),h.c(),h.m(c.parentNode,c))},d(d){d&&detach(o),d&&detach(s),h&&h.d(d),d&&detach(c)}}}function create_if_block_4$7(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo;return{c(){o=element("p"),s=element("strong"),c=text("The NSCF Georeferencer is built for collaboration first."),h=element("br"),d=text(`Please visit the \r
        `),p=element("span"),p.textContent="About page",Co=text(` \r
        for more information on using this tool or contact us on \r
        `),Bo=element("a"),Bo.textContent="data@nscf.org.za",Lo=text(`. \r
        Alternatively you can search the georeference database manually below.`),attr(p,"class","fake-link svelte-1lfowh0"),attr(Bo,"href","mailto:data@nscf.origin.za"),attr(o,"class","warning svelte-1lfowh0")},m(Po,Mo){insert(Po,o,Mo),append(o,s),append(s,c),append(s,h),append(s,d),append(s,p),append(s,Co),append(s,Bo),append(s,Lo),Uo||(Qo=listen(p,"click",l[13]),Uo=!0)},p:noop$2,d(Po){Po&&detach(o),Uo=!1,Qo()}}}function create_if_block$j(l){let o,s,c=l[0]&&create_if_block_1$c(l);return{c(){c&&c.c(),o=space(),s=element("div"),s.innerHTML=`<span>made with</span> 
      <a href="https://svelte.dev" target="_blank"><img src="images/svelte-android-chrome-512.png" title="Svelte" alt="Svelte" class="madewithimg svelte-1lfowh0"/></a> 
      <span>+</span> 
      <a href="https://firebase.google.com" target="_blank"><img src="images/firebase.png" title="Firebase" alt="Firebase" class="madewithimg svelte-1lfowh0"/></a> 
      <span>+</span> 
      <a href="https://www.elastic.co/" target="_blank"><img src="images/elasticsearch.png" title="ElasticSearch" alt="ElasticSearch" class="madewithimg svelte-1lfowh0"/></a>`,attr(s,"class","madewith svelte-1lfowh0")},m(h,d){c&&c.m(h,d),insert(h,o,d),insert(h,s,d)},p(h,d){h[0]?c?c.p(h,d):(c=create_if_block_1$c(h),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(h){c&&c.d(h),h&&detach(o),h&&detach(s)}}}function create_if_block_1$c(l){let o,s,c,h,d,p,Co,Bo=l[0].isAdmin&&create_if_block_2$a(l);return{c(){o=element("h2"),o.textContent="OR",s=space(),c=element("button"),c.innerHTML="<strong>GO TO DATASETS</strong>",h=space(),Bo&&Bo.c(),d=empty$1(),set_style(o,"color","gray"),attr(c,"class","datasets-button svelte-1lfowh0")},m(Lo,Uo){insert(Lo,o,Uo),insert(Lo,s,Uo),insert(Lo,c,Uo),insert(Lo,h,Uo),Bo&&Bo.m(Lo,Uo),insert(Lo,d,Uo),p||(Co=listen(c,"click",l[10]),p=!0)},p(Lo,Uo){Lo[0].isAdmin?Bo?Bo.p(Lo,Uo):(Bo=create_if_block_2$a(Lo),Bo.c(),Bo.m(d.parentNode,d)):Bo&&(Bo.d(1),Bo=null)},d(Lo){Lo&&detach(o),Lo&&detach(s),Lo&&detach(c),Lo&&detach(h),Bo&&Bo.d(Lo),Lo&&detach(d),p=!1,Co()}}}function create_if_block_2$a(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo;return{c(){o=element("h2"),o.textContent="OR",s=space(),c=element("div"),h=element("div"),h.innerHTML=`<div class="svelte-1lfowh0"><span class="material-icons-outlined ico-up svelte-1lfowh0">cloud_upload</span> 
              <p class="dwc-p svelte-1lfowh0">Darwin Core</p> 
              <p class="box-p svelte-1lfowh0">Drag&amp;Drop a CSV file to start georeferencing</p> 
              <span class="material-icons-outlined box-arrow svelte-1lfowh0">reply</span></div>`,d=space(),p=element("div"),p.innerHTML="<strong>Please remember that georeferencing must be done separately for terrestrial, freshwater, and coastal/marine datasets</strong>",Co=space(),Bo=element("input"),set_style(o,"color","gray"),attr(h,"id","fileDropBox"),attr(h,"class","fileDropBox svelte-1lfowh0"),attr(h,"ondragover","return false"),attr(c,"id","wrapper"),attr(c,"class","wrapper svelte-1lfowh0"),attr(p,"class","warning svelte-1lfowh0"),attr(Bo,"type","file"),set_style(Bo,"visibility","hidden")},m(Qo,Po){insert(Qo,o,Po),insert(Qo,s,Po),insert(Qo,c,Po),append(c,h),l[16](h),insert(Qo,d,Po),insert(Qo,p,Po),insert(Qo,Co,Po),insert(Qo,Bo,Po),l[17](Bo),Lo||(Uo=[listen(h,"dragenter",l[5]),listen(h,"dragleave",l[6]),listen(h,"drop",l[9]),listen(h,"click",l[7]),listen(Bo,"change",l[8])],Lo=!0)},p:noop$2,d(Qo){Qo&&detach(o),Qo&&detach(s),Qo&&detach(c),l[16](null),Qo&&detach(d),Qo&&detach(p),Qo&&detach(Co),Qo&&detach(Bo),l[17](null),Lo=!1,run_all(Uo)}}}function create_fragment$t(l){let o,s,c,h,d,p,Co,Bo;function Lo(Mo,Go){return Mo[1]?create_else_block$f:create_if_block_3$8}let Uo=Lo(l),Qo=Uo(l);p=new ManualGeoref({}),p.$on("custom-search-searching",l[14]),p.$on("custom-search-cleared",l[15]);let Po=!l[1]&&create_if_block$j(l);return{c(){o=element("div"),Qo.c(),s=space(),c=element("h3"),c.textContent="Single georeference lookup",h=space(),d=element("div"),create_component(p.$$.fragment),Co=space(),Po&&Po.c(),set_style(c,"color","darkslategray"),attr(d,"class","manual-georef svelte-1lfowh0"),toggle_class(d,"manual-georef-searching",l[1]),attr(o,"class","home-container svelte-1lfowh0")},m(Mo,Go){insert(Mo,o,Go),Qo.m(o,null),append(o,s),append(o,c),append(o,h),append(o,d),mount_component(p,d,null),append(o,Co),Po&&Po.m(o,null),Bo=!0},p(Mo,[Go]){Uo===(Uo=Lo(Mo))&&Qo?Qo.p(Mo,Go):(Qo.d(1),Qo=Uo(Mo),Qo&&(Qo.c(),Qo.m(o,s))),Go&2&&toggle_class(d,"manual-georef-searching",Mo[1]),Mo[1]?Po&&(Po.d(1),Po=null):Po?Po.p(Mo,Go):(Po=create_if_block$j(Mo),Po.c(),Po.m(o,null))},i(Mo){Bo||(transition_in(p.$$.fragment,Mo),Bo=!0)},o(Mo){transition_out(p.$$.fragment,Mo),Bo=!1},d(Mo){Mo&&detach(o),Qo.d(),destroy_component(p),Po&&Po.d()}}}function instance$t(l,o,s){let c;component_subscribe(l,dataStore,Jo=>s(19,c=Jo));const h=createEventDispatcher();let{profile:d}=o,{fileMIMETypes:p}=o,Co=!1,Bo,Lo;const Uo=Jo=>{s(1,Co=!1)};function Qo(){s(3,Lo.style.borderColor="#bcd0ec",Lo),Lo.querySelector(".ico-up").style.color="#bcd0ec",Lo.querySelector(".dwc-p").style.color="#495d9e",Lo.querySelector(".box-arrow").style.color="#495d9e"}function Po(){s(3,Lo.style.borderColor="lightgray",Lo),Lo.querySelector(".ico-up").style.color="lightgray",Lo.querySelector(".dwc-p").style.color="lightgray",Lo.querySelector(".box-arrow").style.color="lightgray"}function Mo(Jo){Bo.click()}function Go(){let Jo=Bo.files[0];zo(Jo),s(2,Bo.value=null,Bo)}function $o(Jo){Jo.stopPropagation(),Jo.preventDefault();let Ko=Jo.dataTransfer.files[0];zo(Ko)}function jo(Jo){d?h("to-datasets"):alert("Please register or sign in to begin")}function zo(Jo){Jo&&p.includes(Jo.type)?h("file-selected",{file:Jo}):open(Alert,{message:"Please select a valid CSV file"},{closeButton:!1,styleWindow:{backgroundColor:"#f2dede","border-color":"blue"}})}const Xo=Jo=>h("to-about"),Zo=Jo=>s(1,Co=!0),Wo=Jo=>s(1,Co=!1);function es(Jo){binding_callbacks[Jo?"unshift":"push"](()=>{Lo=Jo,s(3,Lo)})}function is(Jo){binding_callbacks[Jo?"unshift":"push"](()=>{Bo=Jo,s(2,Bo)})}return l.$$set=Jo=>{"profile"in Jo&&s(0,d=Jo.profile),"fileMIMETypes"in Jo&&s(11,p=Jo.fileMIMETypes)},l.$$.update=()=>{l.$$.dirty&2&&(Co||set_store_value(dataStore,c.georefIndex=null,c))},[d,Co,Bo,Lo,h,Qo,Po,Mo,Go,$o,jo,p,Uo,Xo,Zo,Wo,es,is]}class Home extends SvelteComponent{constructor(o){super(),init(this,o,instance$t,create_fragment$t,safe_not_equal,{profile:0,fileMIMETypes:11,closeSearching:12})}get closeSearching(){return this.$$.ctx[12]}}var papaparse_min={exports:{}};/* @license
Papa Parse
v5.2.0
https://github.com/mholt/PapaParse
License: MIT
*/(function(l,o){(function(s,c){l.exports=c()})(commonjsGlobal$1,function s(){var c=typeof self<"u"?self:typeof window<"u"?window:c!==void 0?c:{},h=!c.document&&!!c.postMessage,d=h&&/blob:/i.test((c.location||{}).protocol),p={},Co=0,Bo={parse:function(Ko,Yo){var ts=(Yo=Yo||{}).dynamicTyping||!1;if(Jo(ts)&&(Yo.dynamicTypingFunction=ts,ts={}),Yo.dynamicTyping=ts,Yo.transform=!!Jo(Yo.transform)&&Yo.transform,Yo.worker&&Bo.WORKERS_SUPPORTED){var ss=function(){if(!Bo.WORKERS_SUPPORTED)return!1;var as=(gs=c.URL||c.webkitURL||null,Is=s.toString(),Bo.BLOB_URL||(Bo.BLOB_URL=gs.createObjectURL(new Blob(["(",Is,")();"],{type:"text/javascript"})))),us=new c.Worker(as),gs,Is;return us.onmessage=Xo,us.id=Co++,p[us.id]=us}();return ss.userStep=Yo.step,ss.userChunk=Yo.chunk,ss.userComplete=Yo.complete,ss.userError=Yo.error,Yo.step=Jo(Yo.step),Yo.chunk=Jo(Yo.chunk),Yo.complete=Jo(Yo.complete),Yo.error=Jo(Yo.error),delete Yo.worker,void ss.postMessage({input:Ko,config:Yo,workerId:ss.id})}var cs=null;return Bo.NODE_STREAM_INPUT,typeof Ko=="string"?cs=Yo.download?new Qo(Yo):new Mo(Yo):Ko.readable===!0&&Jo(Ko.read)&&Jo(Ko.on)?cs=new Go(Yo):(c.File&&Ko instanceof File||Ko instanceof Object)&&(cs=new Po(Yo)),cs.stream(Ko)},unparse:function(Ko,Yo){var ts=!1,ss=!0,cs=",",as=`\r
`,us='"',gs=us+us,Is=!1,_s=null;(function(){if(typeof Yo=="object"){if(typeof Yo.delimiter!="string"||Bo.BAD_DELIMITERS.filter(function(ms){return Yo.delimiter.indexOf(ms)!==-1}).length||(cs=Yo.delimiter),(typeof Yo.quotes=="boolean"||typeof Yo.quotes=="function"||Array.isArray(Yo.quotes))&&(ts=Yo.quotes),typeof Yo.skipEmptyLines!="boolean"&&typeof Yo.skipEmptyLines!="string"||(Is=Yo.skipEmptyLines),typeof Yo.newline=="string"&&(as=Yo.newline),typeof Yo.quoteChar=="string"&&(us=Yo.quoteChar),typeof Yo.header=="boolean"&&(ss=Yo.header),Array.isArray(Yo.columns)){if(Yo.columns.length===0)throw new Error("Option columns is empty");_s=Yo.columns}Yo.escapeChar!==void 0&&(gs=Yo.escapeChar+us)}})();var Hs=new RegExp(jo(us),"g");if(typeof Ko=="string"&&(Ko=JSON.parse(Ko)),Array.isArray(Ko)){if(!Ko.length||Array.isArray(Ko[0]))return hs(null,Ko,Is);if(typeof Ko[0]=="object")return hs(_s||ds(Ko[0]),Ko,Is)}else if(typeof Ko=="object")return typeof Ko.data=="string"&&(Ko.data=JSON.parse(Ko.data)),Array.isArray(Ko.data)&&(Ko.fields||(Ko.fields=Ko.meta&&Ko.meta.fields),Ko.fields||(Ko.fields=Array.isArray(Ko.data[0])?Ko.fields:ds(Ko.data[0])),Array.isArray(Ko.data[0])||typeof Ko.data[0]=="object"||(Ko.data=[Ko.data])),hs(Ko.fields||[],Ko.data||[],Is);throw new Error("Unable to serialize unrecognized input");function ds(ms){if(typeof ms!="object")return[];var Rs=[];for(var bs in ms)Rs.push(bs);return Rs}function hs(ms,Rs,bs){var ps="";typeof ms=="string"&&(ms=JSON.parse(ms)),typeof Rs=="string"&&(Rs=JSON.parse(Rs));var ks=Array.isArray(ms)&&0<ms.length,xs=!Array.isArray(Rs[0]);if(ks&&ss){for(var Ss=0;Ss<ms.length;Ss++)0<Ss&&(ps+=cs),ps+=ys(ms[Ss],Ss);0<Rs.length&&(ps+=as)}for(var Us=0;Us<Rs.length;Us++){var Ps=ks?ms.length:Rs[Us].length,Qs=!1,Js=ks?Object.keys(Rs[Us]).length===0:Rs[Us].length===0;if(bs&&!ks&&(Qs=bs==="greedy"?Rs[Us].join("").trim()==="":Rs[Us].length===1&&Rs[Us][0].length===0),bs==="greedy"&&ks){for(var qs=[],Gs=0;Gs<Ps;Gs++){var Zs=xs?ms[Gs]:Gs;qs.push(Rs[Us][Zs])}Qs=qs.join("").trim()===""}if(!Qs){for(var Es=0;Es<Ps;Es++){0<Es&&!Js&&(ps+=cs);var fs=ks&&xs?ms[Es]:Es;ps+=ys(Rs[Us][fs],Es)}Us<Rs.length-1&&(!bs||0<Ps&&!Js)&&(ps+=as)}}return ps}function ys(ms,Rs){if(ms==null)return"";if(ms.constructor===Date)return JSON.stringify(ms).slice(1,25);var bs=ms.toString().replace(Hs,gs),ps=typeof ts=="boolean"&&ts||typeof ts=="function"&&ts(ms,Rs)||Array.isArray(ts)&&ts[Rs]||function(ks,xs){for(var Ss=0;Ss<xs.length;Ss++)if(-1<ks.indexOf(xs[Ss]))return!0;return!1}(bs,Bo.BAD_DELIMITERS)||-1<bs.indexOf(cs)||bs.charAt(0)===" "||bs.charAt(bs.length-1)===" ";return ps?us+bs+us:bs}}};if(Bo.RECORD_SEP=String.fromCharCode(30),Bo.UNIT_SEP=String.fromCharCode(31),Bo.BYTE_ORDER_MARK="\uFEFF",Bo.BAD_DELIMITERS=["\r",`
`,'"',Bo.BYTE_ORDER_MARK],Bo.WORKERS_SUPPORTED=!h&&!!c.Worker,Bo.NODE_STREAM_INPUT=1,Bo.LocalChunkSize=10485760,Bo.RemoteChunkSize=5242880,Bo.DefaultDelimiter=",",Bo.Parser=zo,Bo.ParserHandle=$o,Bo.NetworkStreamer=Qo,Bo.FileStreamer=Po,Bo.StringStreamer=Mo,Bo.ReadableStreamStreamer=Go,c.jQuery){var Lo=c.jQuery;Lo.fn.parse=function(Ko){var Yo=Ko.config||{},ts=[];return this.each(function(as){if(!(Lo(this).prop("tagName").toUpperCase()==="INPUT"&&Lo(this).attr("type").toLowerCase()==="file"&&c.FileReader)||!this.files||this.files.length===0)return!0;for(var us=0;us<this.files.length;us++)ts.push({file:this.files[us],inputElem:this,instanceConfig:Lo.extend({},Yo)})}),ss(),this;function ss(){if(ts.length!==0){var as,us,gs,Is,_s=ts[0];if(Jo(Ko.before)){var Hs=Ko.before(_s.file,_s.inputElem);if(typeof Hs=="object"){if(Hs.action==="abort")return as="AbortError",us=_s.file,gs=_s.inputElem,Is=Hs.reason,void(Jo(Ko.error)&&Ko.error({name:as},us,gs,Is));if(Hs.action==="skip")return void cs();typeof Hs.config=="object"&&(_s.instanceConfig=Lo.extend(_s.instanceConfig,Hs.config))}else if(Hs==="skip")return void cs()}var ds=_s.instanceConfig.complete;_s.instanceConfig.complete=function(hs){Jo(ds)&&ds(hs,_s.file,_s.inputElem),cs()},Bo.parse(_s.file,_s.instanceConfig)}else Jo(Ko.complete)&&Ko.complete()}function cs(){ts.splice(0,1),ss()}}}function Uo(Ko){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(Yo){var ts=es(Yo);ts.chunkSize=parseInt(ts.chunkSize),Yo.step||Yo.chunk||(ts.chunkSize=null),this._handle=new $o(ts),(this._handle.streamer=this)._config=ts}.call(this,Ko),this.parseChunk=function(Yo,ts){if(this.isFirstChunk&&Jo(this._config.beforeFirstChunk)){var ss=this._config.beforeFirstChunk(Yo);ss!==void 0&&(Yo=ss)}this.isFirstChunk=!1,this._halted=!1;var cs=this._partialLine+Yo;this._partialLine="";var as=this._handle.parse(cs,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var us=as.meta.cursor;this._finished||(this._partialLine=cs.substring(us-this._baseIndex),this._baseIndex=us),as&&as.data&&(this._rowCount+=as.data.length);var gs=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(d)c.postMessage({results:as,workerId:Bo.WORKER_ID,finished:gs});else if(Jo(this._config.chunk)&&!ts){if(this._config.chunk(as,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);as=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(as.data),this._completeResults.errors=this._completeResults.errors.concat(as.errors),this._completeResults.meta=as.meta),this._completed||!gs||!Jo(this._config.complete)||as&&as.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),gs||as&&as.meta.paused||this._nextChunk(),as}this._halted=!0},this._sendError=function(Yo){Jo(this._config.error)?this._config.error(Yo):d&&this._config.error&&c.postMessage({workerId:Bo.WORKER_ID,error:Yo,finished:!1})}}function Qo(Ko){var Yo;(Ko=Ko||{}).chunkSize||(Ko.chunkSize=Bo.RemoteChunkSize),Uo.call(this,Ko),this._nextChunk=h?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(ts){this._input=ts,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(Yo=new XMLHttpRequest,this._config.withCredentials&&(Yo.withCredentials=this._config.withCredentials),h||(Yo.onload=is(this._chunkLoaded,this),Yo.onerror=is(this._chunkError,this)),Yo.open(this._config.downloadRequestBody?"POST":"GET",this._input,!h),this._config.downloadRequestHeaders){var ts=this._config.downloadRequestHeaders;for(var ss in ts)Yo.setRequestHeader(ss,ts[ss])}if(this._config.chunkSize){var cs=this._start+this._config.chunkSize-1;Yo.setRequestHeader("Range","bytes="+this._start+"-"+cs)}try{Yo.send(this._config.downloadRequestBody)}catch(as){this._chunkError(as.message)}h&&Yo.status===0&&this._chunkError()}},this._chunkLoaded=function(){Yo.readyState===4&&(Yo.status<200||400<=Yo.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:Yo.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(ts){var ss=ts.getResponseHeader("Content-Range");return ss===null?-1:parseInt(ss.substring(ss.lastIndexOf("/")+1))}(Yo),this.parseChunk(Yo.responseText)))},this._chunkError=function(ts){var ss=Yo.statusText||ts;this._sendError(new Error(ss))}}function Po(Ko){var Yo,ts;(Ko=Ko||{}).chunkSize||(Ko.chunkSize=Bo.LocalChunkSize),Uo.call(this,Ko);var ss=typeof FileReader<"u";this.stream=function(cs){this._input=cs,ts=cs.slice||cs.webkitSlice||cs.mozSlice,ss?((Yo=new FileReader).onload=is(this._chunkLoaded,this),Yo.onerror=is(this._chunkError,this)):Yo=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var cs=this._input;if(this._config.chunkSize){var as=Math.min(this._start+this._config.chunkSize,this._input.size);cs=ts.call(cs,this._start,as)}var us=Yo.readAsText(cs,this._config.encoding);ss||this._chunkLoaded({target:{result:us}})},this._chunkLoaded=function(cs){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(cs.target.result)},this._chunkError=function(){this._sendError(Yo.error)}}function Mo(Ko){var Yo;Uo.call(this,Ko=Ko||{}),this.stream=function(ts){return Yo=ts,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var ts,ss=this._config.chunkSize;return ss?(ts=Yo.substring(0,ss),Yo=Yo.substring(ss)):(ts=Yo,Yo=""),this._finished=!Yo,this.parseChunk(ts)}}}function Go(Ko){Uo.call(this,Ko=Ko||{});var Yo=[],ts=!0,ss=!1;this.pause=function(){Uo.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){Uo.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(cs){this._input=cs,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){ss&&Yo.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),Yo.length?this.parseChunk(Yo.shift()):ts=!0},this._streamData=is(function(cs){try{Yo.push(typeof cs=="string"?cs:cs.toString(this._config.encoding)),ts&&(ts=!1,this._checkIsFinished(),this.parseChunk(Yo.shift()))}catch(as){this._streamError(as)}},this),this._streamError=is(function(cs){this._streamCleanUp(),this._sendError(cs)},this),this._streamEnd=is(function(){this._streamCleanUp(),ss=!0,this._streamData("")},this),this._streamCleanUp=is(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function $o(Ko){var Yo,ts,ss,cs=Math.pow(2,53),as=-cs,us=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,gs=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,Is=this,_s=0,Hs=0,ds=!1,hs=!1,ys=[],ms={data:[],errors:[],meta:{}};if(Jo(Ko.step)){var Rs=Ko.step;Ko.step=function(Us){if(ms=Us,ks())ps();else{if(ps(),ms.data.length===0)return;_s+=Us.data.length,Ko.preview&&_s>Ko.preview?ts.abort():(ms.data=ms.data[0],Rs(ms,Is))}}}function bs(Us){return Ko.skipEmptyLines==="greedy"?Us.join("").trim()==="":Us.length===1&&Us[0].length===0}function ps(){if(ms&&ss&&(Ss("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+Bo.DefaultDelimiter+"'"),ss=!1),Ko.skipEmptyLines)for(var Us=0;Us<ms.data.length;Us++)bs(ms.data[Us])&&ms.data.splice(Us--,1);return ks()&&function(){if(!ms)return;function Ps(Js){Jo(Ko.transformHeader)&&(Js=Ko.transformHeader(Js)),ys.push(Js)}if(Array.isArray(ms.data[0])){for(var Qs=0;ks()&&Qs<ms.data.length;Qs++)ms.data[Qs].forEach(Ps);ms.data.splice(0,1)}else ms.data.forEach(Ps)}(),function(){if(!ms||!Ko.header&&!Ko.dynamicTyping&&!Ko.transform)return ms;function Ps(Js,qs){var Gs,Zs=Ko.header?{}:[];for(Gs=0;Gs<Js.length;Gs++){var Es=Gs,fs=Js[Gs];Ko.header&&(Es=Gs>=ys.length?"__parsed_extra":ys[Gs]),Ko.transform&&(fs=Ko.transform(fs,Es)),fs=xs(Es,fs),Es==="__parsed_extra"?(Zs[Es]=Zs[Es]||[],Zs[Es].push(fs)):Zs[Es]=fs}return Ko.header&&(Gs>ys.length?Ss("FieldMismatch","TooManyFields","Too many fields: expected "+ys.length+" fields but parsed "+Gs,Hs+qs):Gs<ys.length&&Ss("FieldMismatch","TooFewFields","Too few fields: expected "+ys.length+" fields but parsed "+Gs,Hs+qs)),Zs}var Qs=1;return!ms.data.length||Array.isArray(ms.data[0])?(ms.data=ms.data.map(Ps),Qs=ms.data.length):ms.data=Ps(ms.data,0),Ko.header&&ms.meta&&(ms.meta.fields=ys),Hs+=Qs,ms}()}function ks(){return Ko.header&&ys.length===0}function xs(Us,Ps){return Qs=Us,Ko.dynamicTypingFunction&&Ko.dynamicTyping[Qs]===void 0&&(Ko.dynamicTyping[Qs]=Ko.dynamicTypingFunction(Qs)),(Ko.dynamicTyping[Qs]||Ko.dynamicTyping)===!0?Ps==="true"||Ps==="TRUE"||Ps!=="false"&&Ps!=="FALSE"&&(function(Js){if(us.test(Js)){var qs=parseFloat(Js);if(as<qs&&qs<cs)return!0}return!1}(Ps)?parseFloat(Ps):gs.test(Ps)?new Date(Ps):Ps===""?null:Ps):Ps;var Qs}function Ss(Us,Ps,Qs,Js){var qs={type:Us,code:Ps,message:Qs};Js!==void 0&&(qs.row=Js),ms.errors.push(qs)}this.parse=function(Us,Ps,Qs){var Js=Ko.quoteChar||'"';if(Ko.newline||(Ko.newline=function(Zs,Es){Zs=Zs.substring(0,1048576);var fs=new RegExp(jo(Es)+"([^]*?)"+jo(Es),"gm"),vs=(Zs=Zs.replace(fs,"")).split("\r"),Bs=Zs.split(`
`),Ls=1<Bs.length&&Bs[0].length<vs[0].length;if(vs.length===1||Ls)return`
`;for(var Fs=0,zs=0;zs<vs.length;zs++)vs[zs][0]===`
`&&Fs++;return Fs>=vs.length/2?`\r
`:"\r"}(Us,Js)),ss=!1,Ko.delimiter)Jo(Ko.delimiter)&&(Ko.delimiter=Ko.delimiter(Us),ms.meta.delimiter=Ko.delimiter);else{var qs=function(Zs,Es,fs,vs,Bs){var Ls,Fs,zs,js;Bs=Bs||[",","	","|",";",Bo.RECORD_SEP,Bo.UNIT_SEP];for(var ma=0;ma<Bs.length;ma++){var Ws=Bs[ma],va=0,ca=0,cl=0;zs=void 0;for(var Ms=new zo({comments:vs,delimiter:Ws,newline:Es,preview:10}).parse(Zs),$s=0;$s<Ms.data.length;$s++)if(fs&&bs(Ms.data[$s]))cl++;else{var ga=Ms.data[$s].length;ca+=ga,zs!==void 0?0<ga&&(va+=Math.abs(ga-zs),zs=ga):zs=ga}0<Ms.data.length&&(ca/=Ms.data.length-cl),(Fs===void 0||va<=Fs)&&(js===void 0||js<ca)&&1.99<ca&&(Fs=va,Ls=Ws,js=ca)}return{successful:!!(Ko.delimiter=Ls),bestDelimiter:Ls}}(Us,Ko.newline,Ko.skipEmptyLines,Ko.comments,Ko.delimitersToGuess);qs.successful?Ko.delimiter=qs.bestDelimiter:(ss=!0,Ko.delimiter=Bo.DefaultDelimiter),ms.meta.delimiter=Ko.delimiter}var Gs=es(Ko);return Ko.preview&&Ko.header&&Gs.preview++,Yo=Us,ts=new zo(Gs),ms=ts.parse(Yo,Ps,Qs),ps(),ds?{meta:{paused:!0}}:ms||{meta:{paused:!1}}},this.paused=function(){return ds},this.pause=function(){ds=!0,ts.abort(),Yo=Jo(Ko.chunk)?"":Yo.substring(ts.getCharIndex())},this.resume=function(){Is.streamer._halted?(ds=!1,Is.streamer.parseChunk(Yo,!0)):setTimeout(Is.resume,3)},this.aborted=function(){return hs},this.abort=function(){hs=!0,ts.abort(),ms.meta.aborted=!0,Jo(Ko.complete)&&Ko.complete(ms),Yo=""}}function jo(Ko){return Ko.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function zo(Ko){var Yo,ts=(Ko=Ko||{}).delimiter,ss=Ko.newline,cs=Ko.comments,as=Ko.step,us=Ko.preview,gs=Ko.fastMode,Is=Yo=Ko.quoteChar===void 0?'"':Ko.quoteChar;if(Ko.escapeChar!==void 0&&(Is=Ko.escapeChar),(typeof ts!="string"||-1<Bo.BAD_DELIMITERS.indexOf(ts))&&(ts=","),cs===ts)throw new Error("Comment character same as delimiter");cs===!0?cs="#":(typeof cs!="string"||-1<Bo.BAD_DELIMITERS.indexOf(cs))&&(cs=!1),ss!==`
`&&ss!=="\r"&&ss!==`\r
`&&(ss=`
`);var _s=0,Hs=!1;this.parse=function(ds,hs,ys){if(typeof ds!="string")throw new Error("Input must be a string");var ms=ds.length,Rs=ts.length,bs=ss.length,ps=cs.length,ks=Jo(as),xs=[],Ss=[],Us=[],Ps=_s=0;if(!ds)return ma();if(gs||gs!==!1&&ds.indexOf(Yo)===-1){for(var Qs=ds.split(ss),Js=0;Js<Qs.length;Js++){if(Us=Qs[Js],_s+=Us.length,Js!==Qs.length-1)_s+=ss.length;else if(ys)return ma();if(!cs||Us.substring(0,ps)!==cs){if(ks){if(xs=[],Ls(Us.split(ts)),Ws(),Hs)return ma()}else Ls(Us.split(ts));if(us&&us<=Js)return xs=xs.slice(0,us),ma(!0)}}return ma()}for(var qs=ds.indexOf(ts,_s),Gs=ds.indexOf(ss,_s),Zs=new RegExp(jo(Is)+jo(Yo),"g"),Es=ds.indexOf(Yo,_s);;)if(ds[_s]!==Yo)if(cs&&Us.length===0&&ds.substring(_s,_s+ps)===cs){if(Gs===-1)return ma();_s=Gs+bs,Gs=ds.indexOf(ss,_s),qs=ds.indexOf(ts,_s)}else{if(qs!==-1&&(qs<Gs||Gs===-1)){if(!(qs<Es)){Us.push(ds.substring(_s,qs)),_s=qs+Rs,qs=ds.indexOf(ts,_s);continue}var fs=va(qs,Es,Gs);if(fs&&fs.nextDelim!==void 0){qs=fs.nextDelim,Es=fs.quoteSearch,Us.push(ds.substring(_s,qs)),_s=qs+Rs,qs=ds.indexOf(ts,_s);continue}}if(Gs===-1)break;if(Us.push(ds.substring(_s,Gs)),js(Gs+bs),ks&&(Ws(),Hs))return ma();if(us&&xs.length>=us)return ma(!0)}else for(Es=_s,_s++;;){if((Es=ds.indexOf(Yo,Es+1))===-1)return ys||Ss.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:xs.length,index:_s}),zs();if(Es===ms-1)return zs(ds.substring(_s,Es).replace(Zs,Yo));if(Yo!==Is||ds[Es+1]!==Is){if(Yo===Is||Es===0||ds[Es-1]!==Is){qs!==-1&&qs<Es+1&&(qs=ds.indexOf(ts,Es+1)),Gs!==-1&&Gs<Es+1&&(Gs=ds.indexOf(ss,Es+1));var vs=Fs(Gs===-1?qs:Math.min(qs,Gs));if(ds[Es+1+vs]===ts){Us.push(ds.substring(_s,Es).replace(Zs,Yo)),ds[_s=Es+1+vs+Rs]!==Yo&&(Es=ds.indexOf(Yo,_s)),qs=ds.indexOf(ts,_s),Gs=ds.indexOf(ss,_s);break}var Bs=Fs(Gs);if(ds.substring(Es+1+Bs,Es+1+Bs+bs)===ss){if(Us.push(ds.substring(_s,Es).replace(Zs,Yo)),js(Es+1+Bs+bs),qs=ds.indexOf(ts,_s),Es=ds.indexOf(Yo,_s),ks&&(Ws(),Hs))return ma();if(us&&xs.length>=us)return ma(!0);break}Ss.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:xs.length,index:_s}),Es++}}else Es++}return zs();function Ls(ca){xs.push(ca),Ps=_s}function Fs(ca){var cl=0;if(ca!==-1){var Ms=ds.substring(Es+1,ca);Ms&&Ms.trim()===""&&(cl=Ms.length)}return cl}function zs(ca){return ys||(ca===void 0&&(ca=ds.substring(_s)),Us.push(ca),_s=ms,Ls(Us),ks&&Ws()),ma()}function js(ca){_s=ca,Ls(Us),Us=[],Gs=ds.indexOf(ss,_s)}function ma(ca){return{data:xs,errors:Ss,meta:{delimiter:ts,linebreak:ss,aborted:Hs,truncated:!!ca,cursor:Ps+(hs||0)}}}function Ws(){as(ma()),xs=[],Ss=[]}function va(ca,cl,Ms){var $s={nextDelim:void 0,quoteSearch:void 0},ga=ds.indexOf(Yo,cl+1);if(cl<ca&&ca<ga&&(ga<Ms||Ms===-1)){var Xs=ds.indexOf(ts,ga);if(Xs===-1)return $s;ga<Xs&&(ga=ds.indexOf(Yo,ga+1)),$s=va(Xs,ga,Ms)}else $s={nextDelim:ca,quoteSearch:cl};return $s}},this.abort=function(){Hs=!0},this.getCharIndex=function(){return _s}}function Xo(Ko){var Yo=Ko.data,ts=p[Yo.workerId],ss=!1;if(Yo.error)ts.userError(Yo.error,Yo.file);else if(Yo.results&&Yo.results.data){var cs={abort:function(){ss=!0,Zo(Yo.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Wo,resume:Wo};if(Jo(ts.userStep)){for(var as=0;as<Yo.results.data.length&&(ts.userStep({data:Yo.results.data[as],errors:Yo.results.errors,meta:Yo.results.meta},cs),!ss);as++);delete Yo.results}else Jo(ts.userChunk)&&(ts.userChunk(Yo.results,cs,Yo.file),delete Yo.results)}Yo.finished&&!ss&&Zo(Yo.workerId,Yo.results)}function Zo(Ko,Yo){var ts=p[Ko];Jo(ts.userComplete)&&ts.userComplete(Yo),ts.terminate(),delete p[Ko]}function Wo(){throw new Error("Not implemented.")}function es(Ko){if(typeof Ko!="object"||Ko===null)return Ko;var Yo=Array.isArray(Ko)?[]:{};for(var ts in Ko)Yo[ts]=es(Ko[ts]);return Yo}function is(Ko,Yo){return function(){Ko.apply(Yo,arguments)}}function Jo(Ko){return typeof Ko=="function"}return d&&(c.onmessage=function(Ko){var Yo=Ko.data;if(Bo.WORKER_ID===void 0&&Yo&&(Bo.WORKER_ID=Yo.workerId),typeof Yo.input=="string")c.postMessage({workerId:Bo.WORKER_ID,results:Bo.parse(Yo.input,Yo.config),finished:!0});else if(c.File&&Yo.input instanceof File||Yo.input instanceof Object){var ts=Bo.parse(Yo.input,Yo.config);ts&&c.postMessage({workerId:Bo.WORKER_ID,results:ts,finished:!0})}}),(Qo.prototype=Object.create(Uo.prototype)).constructor=Qo,(Po.prototype=Object.create(Uo.prototype)).constructor=Po,(Mo.prototype=Object.create(Mo.prototype)).constructor=Mo,(Go.prototype=Object.create(Uo.prototype)).constructor=Go,Bo})})(papaparse_min);const Papa=papaparse_min.exports;function isArray$1(l){return Array.isArray?Array.isArray(l):Object.prototype.toString.call(l)==="[object Array]"}const INFINITY$1=1/0;function baseToString(l){if(typeof l=="string")return l;let o=l+"";return o=="0"&&1/l==-INFINITY$1?"-0":o}function toString(l){return l==null?"":baseToString(l)}function isString(l){return typeof l=="string"}function isNumber$1(l){return typeof l=="number"}function isObject$1(l){return typeof l=="object"}function isDefined(l){return l!=null}function isBlank(l){return!l.trim().length}const EXTENDED_SEARCH_UNAVAILABLE="Extended search is not available",INCORRECT_INDEX_TYPE="Incorrect 'index' type",LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY=l=>`Invalid value for key ${l}`,PATTERN_LENGTH_TOO_LARGE=l=>`Pattern length exceeds max of ${l}.`,MISSING_KEY_PROPERTY=l=>`Missing ${l} property in key`,INVALID_KEY_WEIGHT_VALUE=l=>`Property 'weight' in key '${l}' must be a positive integer`,hasOwn=Object.prototype.hasOwnProperty;class KeyStore{constructor(o){this._keys={},this._keyNames=[];let s=0;o.forEach(c=>{let h,d=1;if(isString(c))h=c;else{if(!hasOwn.call(c,"name"))throw new Error(MISSING_KEY_PROPERTY("name"));if(h=c.name,hasOwn.call(c,"weight")&&(d=c.weight,d<=0))throw new Error(INVALID_KEY_WEIGHT_VALUE(h))}this._keyNames.push(h),this._keys[h]={weight:d},s+=d}),this._keyNames.forEach(c=>{this._keys[c].weight/=s})}get(o,s){return this._keys[o]&&this._keys[o][s]}keys(){return this._keyNames}toJSON(){return JSON.stringify(this._keys)}}function get(l,o){let s=[],c=!1;const h=(d,p)=>{if(!p)s.push(d);else{const Co=p.indexOf(".");let Bo=p,Lo=null;Co!==-1&&(Bo=p.slice(0,Co),Lo=p.slice(Co+1));const Uo=d[Bo];if(!isDefined(Uo))return;if(!Lo&&(isString(Uo)||isNumber$1(Uo)))s.push(toString(Uo));else if(isArray$1(Uo)){c=!0;for(let Qo=0,Po=Uo.length;Qo<Po;Qo+=1)h(Uo[Qo],Lo)}else Lo&&h(Uo,Lo)}};return h(l,o),c?s:s[0]}const MatchOptions={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},BasicOptions={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(l,o)=>l.score===o.score?l.idx<o.idx?-1:1:l.score<o.score?-1:1},FuzzyOptions={location:0,threshold:.6,distance:100},AdvancedOptions={useExtendedSearch:!1,getFn:get,ignoreLocation:!1,ignoreFieldNorm:!1};var Config$1={...BasicOptions,...MatchOptions,...FuzzyOptions,...AdvancedOptions};const SPACE$2=/[^ ]+/g;function norm(l=3){const o=new Map;return{get(s){const c=s.match(SPACE$2).length;if(o.has(c))return o.get(c);const h=parseFloat((1/Math.sqrt(c)).toFixed(l));return o.set(c,h),h},clear(){o.clear()}}}class FuseIndex{constructor({getFn:o=Config$1.getFn}={}){this.norm=norm(3),this.getFn=o,this.isCreated=!1,this.setIndexRecords()}setSources(o=[]){this.docs=o}setIndexRecords(o=[]){this.records=o}setKeys(o=[]){this.keys=o}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,isString(this.docs[0])?this.docs.forEach((o,s)=>{this._addString(o,s)}):this.docs.forEach((o,s)=>{this._addObject(o,s)}),this.norm.clear())}add(o){const s=this.size();isString(o)?this._addString(o,s):this._addObject(o,s)}removeAt(o){this.records.splice(o,1);for(let s=o,c=this.size();s<c;s+=1)this.records[s].i-=1}size(){return this.records.length}_addString(o,s){if(!isDefined(o)||isBlank(o))return;let c={v:o,i:s,n:this.norm.get(o)};this.records.push(c)}_addObject(o,s){let c={i:s,$:{}};this.keys.forEach((h,d)=>{let p=this.getFn(o,h);if(!!isDefined(p)){if(isArray$1(p)){let Co=[];const Bo=[{nestedArrIndex:-1,value:p}];for(;Bo.length;){const{nestedArrIndex:Lo,value:Uo}=Bo.pop();if(!!isDefined(Uo))if(isString(Uo)&&!isBlank(Uo)){let Qo={v:Uo,i:Lo,n:this.norm.get(Uo)};Co.push(Qo)}else isArray$1(Uo)&&Uo.forEach((Qo,Po)=>{Bo.push({nestedArrIndex:Po,value:Qo})})}c.$[d]=Co}else if(!isBlank(p)){let Co={v:p,n:this.norm.get(p)};c.$[d]=Co}}}),this.records.push(c)}toJSON(){return{keys:this.keys,records:this.records}}}function createIndex(l,o,{getFn:s=Config$1.getFn}={}){const c=new FuseIndex({getFn:s}),h=new KeyStore(l);return c.setKeys(h.keys()),c.setSources(o),c.create(),c}function parseIndex(l,{getFn:o=Config$1.getFn}={}){const{keys:s,records:c}=l,h=new FuseIndex({getFn:o});return h.setKeys(s),h.setIndexRecords(c),h}function transformMatches(l,o){const s=l.matches;o.matches=[],isDefined(s)&&s.forEach(c=>{if(!isDefined(c.indices)||!c.indices.length)return;const{indices:h,value:d}=c;let p={indices:h,value:d};c.key&&(p.key=c.key),c.idx>-1&&(p.refIndex=c.idx),o.matches.push(p)})}function transformScore(l,o){o.score=l.score}function computeScore(l,{errors:o=0,currentLocation:s=0,expectedLocation:c=0,distance:h=Config$1.distance,ignoreLocation:d=Config$1.ignoreLocation}={}){const p=o/l.length;if(d)return p;const Co=Math.abs(c-s);return h?p+Co/h:Co?1:p}function convertMaskToIndices(l=[],o=Config$1.minMatchCharLength){let s=[],c=-1,h=-1,d=0;for(let p=l.length;d<p;d+=1){let Co=l[d];Co&&c===-1?c=d:!Co&&c!==-1&&(h=d-1,h-c+1>=o&&s.push([c,h]),c=-1)}return l[d-1]&&d-c>=o&&s.push([c,d-1]),s}const MAX_BITS=32;function search(l,o,s,{location:c=Config$1.location,distance:h=Config$1.distance,threshold:d=Config$1.threshold,findAllMatches:p=Config$1.findAllMatches,minMatchCharLength:Co=Config$1.minMatchCharLength,includeMatches:Bo=Config$1.includeMatches,ignoreLocation:Lo=Config$1.ignoreLocation}={}){if(o.length>MAX_BITS)throw new Error(PATTERN_LENGTH_TOO_LARGE(MAX_BITS));const Uo=o.length,Qo=l.length,Po=Math.max(0,Math.min(c,Qo));let Mo=d,Go=Po;const $o=Co>1||Bo,jo=$o?Array(Qo):[];let zo;for(;(zo=l.indexOf(o,Go))>-1;){let Jo=computeScore(o,{currentLocation:zo,expectedLocation:Po,distance:h,ignoreLocation:Lo});if(Mo=Math.min(Jo,Mo),Go=zo+Uo,$o){let Ko=0;for(;Ko<Uo;)jo[zo+Ko]=1,Ko+=1}}Go=-1;let Xo=[],Zo=1,Wo=Uo+Qo;const es=1<<Uo-1;for(let Jo=0;Jo<Uo;Jo+=1){let Ko=0,Yo=Wo;for(;Ko<Yo;)computeScore(o,{errors:Jo,currentLocation:Po+Yo,expectedLocation:Po,distance:h,ignoreLocation:Lo})<=Mo?Ko=Yo:Wo=Yo,Yo=Math.floor((Wo-Ko)/2+Ko);Wo=Yo;let ts=Math.max(1,Po-Yo+1),ss=p?Qo:Math.min(Po+Yo,Qo)+Uo,cs=Array(ss+2);cs[ss+1]=(1<<Jo)-1;for(let us=ss;us>=ts;us-=1){let gs=us-1,Is=s[l.charAt(gs)];if($o&&(jo[gs]=+!!Is),cs[us]=(cs[us+1]<<1|1)&Is,Jo&&(cs[us]|=(Xo[us+1]|Xo[us])<<1|1|Xo[us+1]),cs[us]&es&&(Zo=computeScore(o,{errors:Jo,currentLocation:gs,expectedLocation:Po,distance:h,ignoreLocation:Lo}),Zo<=Mo)){if(Mo=Zo,Go=gs,Go<=Po)break;ts=Math.max(1,2*Po-Go)}}if(computeScore(o,{errors:Jo+1,currentLocation:Po,expectedLocation:Po,distance:h,ignoreLocation:Lo})>Mo)break;Xo=cs}const is={isMatch:Go>=0,score:Math.max(.001,Zo)};if($o){const Jo=convertMaskToIndices(jo,Co);Jo.length?Bo&&(is.indices=Jo):is.isMatch=!1}return is}function createPatternAlphabet(l){let o={};for(let s=0,c=l.length;s<c;s+=1){const h=l.charAt(s);o[h]=(o[h]||0)|1<<c-s-1}return o}class BitapSearch{constructor(o,{location:s=Config$1.location,threshold:c=Config$1.threshold,distance:h=Config$1.distance,includeMatches:d=Config$1.includeMatches,findAllMatches:p=Config$1.findAllMatches,minMatchCharLength:Co=Config$1.minMatchCharLength,isCaseSensitive:Bo=Config$1.isCaseSensitive,ignoreLocation:Lo=Config$1.ignoreLocation}={}){if(this.options={location:s,threshold:c,distance:h,includeMatches:d,findAllMatches:p,minMatchCharLength:Co,isCaseSensitive:Bo,ignoreLocation:Lo},this.pattern=Bo?o:o.toLowerCase(),this.chunks=[],!this.pattern.length)return;const Uo=(Po,Mo)=>{this.chunks.push({pattern:Po,alphabet:createPatternAlphabet(Po),startIndex:Mo})},Qo=this.pattern.length;if(Qo>MAX_BITS){let Po=0;const Mo=Qo%MAX_BITS,Go=Qo-Mo;for(;Po<Go;)Uo(this.pattern.substr(Po,MAX_BITS),Po),Po+=MAX_BITS;if(Mo){const $o=Qo-MAX_BITS;Uo(this.pattern.substr($o),$o)}}else Uo(this.pattern,0)}searchIn(o){const{isCaseSensitive:s,includeMatches:c}=this.options;if(s||(o=o.toLowerCase()),this.pattern===o){let Go={isMatch:!0,score:0};return c&&(Go.indices=[[0,o.length-1]]),Go}const{location:h,distance:d,threshold:p,findAllMatches:Co,minMatchCharLength:Bo,ignoreLocation:Lo}=this.options;let Uo=[],Qo=0,Po=!1;this.chunks.forEach(({pattern:Go,alphabet:$o,startIndex:jo})=>{const{isMatch:zo,score:Xo,indices:Zo}=search(o,Go,$o,{location:h+jo,distance:d,threshold:p,findAllMatches:Co,minMatchCharLength:Bo,includeMatches:c,ignoreLocation:Lo});zo&&(Po=!0),Qo+=Xo,zo&&Zo&&(Uo=[...Uo,...Zo])});let Mo={isMatch:Po,score:Po?Qo/this.chunks.length:1};return Po&&c&&(Mo.indices=Uo),Mo}}class BaseMatch{constructor(o){this.pattern=o}static isMultiMatch(o){return getMatch(o,this.multiRegex)}static isSingleMatch(o){return getMatch(o,this.singleRegex)}search(){}}function getMatch(l,o){const s=l.match(o);return s?s[1]:null}class ExactMatch extends BaseMatch{constructor(o){super(o)}static get type(){return"exact"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(o){let s=0,c;const h=[],d=this.pattern.length;for(;(c=o.indexOf(this.pattern,s))>-1;)s=c+d,h.push([c,s-1]);const p=!!h.length;return{isMatch:p,score:p?1:0,indices:h}}}class InverseExactMatch extends BaseMatch{constructor(o){super(o)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(o){const c=o.indexOf(this.pattern)===-1;return{isMatch:c,score:c?0:1,indices:[0,o.length-1]}}}class PrefixExactMatch extends BaseMatch{constructor(o){super(o)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(o){const s=o.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,this.pattern.length-1]}}}class InversePrefixExactMatch extends BaseMatch{constructor(o){super(o)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(o){const s=!o.startsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,o.length-1]}}}class SuffixExactMatch extends BaseMatch{constructor(o){super(o)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(o){const s=o.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[o.length-this.pattern.length,o.length-1]}}}class InverseSuffixExactMatch extends BaseMatch{constructor(o){super(o)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(o){const s=!o.endsWith(this.pattern);return{isMatch:s,score:s?0:1,indices:[0,o.length-1]}}}class FuzzyMatch extends BaseMatch{constructor(o,{location:s=Config$1.location,threshold:c=Config$1.threshold,distance:h=Config$1.distance,includeMatches:d=Config$1.includeMatches,findAllMatches:p=Config$1.findAllMatches,minMatchCharLength:Co=Config$1.minMatchCharLength,isCaseSensitive:Bo=Config$1.isCaseSensitive}={}){super(o),this._bitapSearch=new BitapSearch(o,{location:s,threshold:c,distance:h,includeMatches:d,findAllMatches:p,minMatchCharLength:Co,isCaseSensitive:Bo})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(o){return this._bitapSearch.searchIn(o)}}const searchers=[ExactMatch,PrefixExactMatch,InversePrefixExactMatch,InverseSuffixExactMatch,SuffixExactMatch,InverseExactMatch,FuzzyMatch],searchersLen=searchers.length,SPACE_RE=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,OR_TOKEN="|";function parseQuery(l,o={}){return l.split(OR_TOKEN).map(s=>{let c=s.trim().split(SPACE_RE).filter(d=>d&&!!d.trim()),h=[];for(let d=0,p=c.length;d<p;d+=1){const Co=c[d];let Bo=!1,Lo=-1;for(;!Bo&&++Lo<searchersLen;){const Uo=searchers[Lo];let Qo=Uo.isMultiMatch(Co);Qo&&(h.push(new Uo(Qo,o)),Bo=!0)}if(!Bo)for(Lo=-1;++Lo<searchersLen;){const Uo=searchers[Lo];let Qo=Uo.isSingleMatch(Co);if(Qo){h.push(new Uo(Qo,o));break}}}return h})}const MultiMatchSet=new Set([FuzzyMatch.type,ExactMatch.type]);class ExtendedSearch{constructor(o,{isCaseSensitive:s=Config$1.isCaseSensitive,includeMatches:c=Config$1.includeMatches,minMatchCharLength:h=Config$1.minMatchCharLength,findAllMatches:d=Config$1.findAllMatches,location:p=Config$1.location,threshold:Co=Config$1.threshold,distance:Bo=Config$1.distance}={}){this.query=null,this.options={isCaseSensitive:s,includeMatches:c,minMatchCharLength:h,findAllMatches:d,location:p,threshold:Co,distance:Bo},this.pattern=s?o:o.toLowerCase(),this.query=parseQuery(this.pattern,this.options)}static condition(o,s){return s.useExtendedSearch}searchIn(o){const s=this.query;if(!s)return{isMatch:!1,score:1};const{includeMatches:c,isCaseSensitive:h}=this.options;o=h?o:o.toLowerCase();let d=0,p=[],Co=0;for(let Bo=0,Lo=s.length;Bo<Lo;Bo+=1){const Uo=s[Bo];p.length=0,d=0;for(let Qo=0,Po=Uo.length;Qo<Po;Qo+=1){const Mo=Uo[Qo],{isMatch:Go,indices:$o,score:jo}=Mo.search(o);if(Go){if(d+=1,Co+=jo,c){const zo=Mo.constructor.type;MultiMatchSet.has(zo)?p=[...p,...$o]:p.push($o)}}else{Co=0,d=0,p.length=0;break}}if(d){let Qo={isMatch:!0,score:Co/d};return c&&(Qo.indices=p),Qo}}return{isMatch:!1,score:1}}}const registeredSearchers=[];function register(...l){registeredSearchers.push(...l)}function createSearcher(l,o){for(let s=0,c=registeredSearchers.length;s<c;s+=1){let h=registeredSearchers[s];if(h.condition(l,o))return new h(l,o)}return new BitapSearch(l,o)}const LogicalOperator={AND:"$and",OR:"$or"},isExpression=l=>!!(l[LogicalOperator.AND]||l[LogicalOperator.OR]),isLeaf=l=>!isArray$1(l)&&isObject$1(l)&&!isExpression(l),convertToExplicit=l=>({[LogicalOperator.AND]:Object.keys(l).map(o=>({[o]:l[o]}))});function parse$2(l,o,{auto:s=!0}={}){const c=h=>{let d=Object.keys(h);if(d.length>1&&!isExpression(h))return c(convertToExplicit(h));let p=d[0];if(isLeaf(h)){const Bo=h[p];if(!isString(Bo))throw new Error(LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY(p));const Lo={key:p,pattern:Bo};return s&&(Lo.searcher=createSearcher(Bo,o)),Lo}let Co={children:[],operator:p};return d.forEach(Bo=>{const Lo=h[Bo];isArray$1(Lo)&&Lo.forEach(Uo=>{Co.children.push(c(Uo))})}),Co};return isExpression(l)||(l=convertToExplicit(l)),c(l)}class Fuse{constructor(o,s={},c){this.options={...Config$1,...s},this.options.useExtendedSearch,this._keyStore=new KeyStore(this.options.keys),this.setCollection(o,c)}setCollection(o,s){if(this._docs=o,s&&!(s instanceof FuseIndex))throw new Error(INCORRECT_INDEX_TYPE);this._myIndex=s||createIndex(this._keyStore.keys(),this._docs,{getFn:this.options.getFn})}add(o){!isDefined(o)||(this._docs.push(o),this._myIndex.add(o))}remove(o=()=>!1){const s=[];for(let c=0,h=this._docs.length;c<h;c+=1){const d=this._docs[c];o(d,c)&&(this.removeAt(c),c-=1,s.push(d))}return s}removeAt(o){this._docs.splice(o,1),this._myIndex.removeAt(o)}getIndex(){return this._myIndex}search(o,{limit:s=-1}={}){const{includeMatches:c,includeScore:h,shouldSort:d,sortFn:p,ignoreFieldNorm:Co}=this.options;let Bo=isString(o)?isString(this._docs[0])?this._searchStringList(o):this._searchObjectList(o):this._searchLogical(o);return computeScore$1(Bo,this._keyStore,{ignoreFieldNorm:Co}),d&&Bo.sort(p),isNumber$1(s)&&s>-1&&(Bo=Bo.slice(0,s)),format(Bo,this._docs,{includeMatches:c,includeScore:h})}_searchStringList(o){const s=createSearcher(o,this.options),{records:c}=this._myIndex,h=[];return c.forEach(({v:d,i:p,n:Co})=>{if(!isDefined(d))return;const{isMatch:Bo,score:Lo,indices:Uo}=s.searchIn(d);Bo&&h.push({item:d,idx:p,matches:[{score:Lo,value:d,norm:Co,indices:Uo}]})}),h}_searchLogical(o){const s=parse$2(o,this.options),{keys:c,records:h}=this._myIndex,d={},p=[],Co=(Bo,Lo,Uo)=>{if(Bo.children){const Qo=Bo.operator;let Po=[];for(let Mo=0;Mo<Bo.children.length;Mo+=1){let Go=Bo.children[Mo],$o=Co(Go,Lo,Uo);if($o&&$o.length){if(Po.push({idx:Uo,item:Lo,matches:$o}),Qo===LogicalOperator.OR)break}else if(Qo===LogicalOperator.AND){Po.length=0;break}}Po.length&&(d[Uo]||(d[Uo]={idx:Uo,item:Lo,matches:[]},p.push(d[Uo])),Po.forEach(({matches:Mo})=>{d[Uo].matches.push(...Mo)}))}else{const{key:Qo,searcher:Po}=Bo,Mo=Lo[c.indexOf(Qo)];return this._findMatches({key:Qo,value:Mo,searcher:Po})}};return h.forEach(({$:Bo,i:Lo})=>{isDefined(Bo)&&Co(s,Bo,Lo)}),p}_searchObjectList(o){const s=createSearcher(o,this.options),{keys:c,records:h}=this._myIndex,d=[];return h.forEach(({$:p,i:Co})=>{if(!isDefined(p))return;let Bo=[];c.forEach((Lo,Uo)=>{Bo.push(...this._findMatches({key:Lo,value:p[Uo],searcher:s}))}),Bo.length&&d.push({idx:Co,item:p,matches:Bo})}),d}_findMatches({key:o,value:s,searcher:c}){if(!isDefined(s))return[];let h=[];if(isArray$1(s))s.forEach(({v:d,i:p,n:Co})=>{if(!isDefined(d))return;const{isMatch:Bo,score:Lo,indices:Uo}=c.searchIn(d);Bo&&h.push({score:Lo,key:o,value:d,idx:p,norm:Co,indices:Uo})});else{const{v:d,n:p}=s,{isMatch:Co,score:Bo,indices:Lo}=c.searchIn(d);Co&&h.push({score:Bo,key:o,value:d,norm:p,indices:Lo})}return h}}function computeScore$1(l,o,{ignoreFieldNorm:s=Config$1.ignoreFieldNorm}){l.forEach(c=>{let h=1;c.matches.forEach(({key:d,norm:p,score:Co})=>{const Bo=o.get(d,"weight");h*=Math.pow(Co===0&&Bo?Number.EPSILON:Co,(Bo||1)*(s?1:p))}),c.score=h})}function format(l,o,{includeMatches:s=Config$1.includeMatches,includeScore:c=Config$1.includeScore}={}){const h=[];return s&&h.push(transformMatches),c&&h.push(transformScore),l.map(d=>{const{idx:p}=d,Co={item:o[p],refIndex:p};return h.length&&h.forEach(Bo=>{Bo(d,Co)}),Co})}Fuse.version="6.2.0";Fuse.createIndex=createIndex;Fuse.parseIndex=parseIndex;Fuse.config=Config$1;Fuse.parseQuery=parse$2;register(ExtendedSearch);let validateFields=(l,o,s="dwc",c="dc")=>{if(l.length>0){let h=[],d=[],p=[],Co=[],Bo=[],Lo,Uo,Qo=[],Po=[],Mo=[],Go=[],$o=[],jo=[],zo=!1;l=l.filter(_s=>_s).map(_s=>_s.trim()).filter(_s=>_s);let Xo=l.filter(onlyUnique$1);l.length>Xo.length&&(h=findDuplicates(l));let Zo,Wo;({dwcTerms:Zo,dcTerms:Wo}=o),Zo=Zo.filter(_s=>_s).map(_s=>_s.trim()).filter(_s=>_s),Wo=Wo.filter(_s=>_s).map(_s=>_s.trim()).filter(_s=>_s);let es=Zo.map(_s=>_s.startsWith(`${s}:`)?_s:`${s}:${_s}`),is=Wo.map(_s=>_s.startsWith(c)?_s:`${c}:${_s}`),Jo=new RegExp(`^${s}:`),Ko=new RegExp(`^${c}:`),Yo=es.map(_s=>_s.replace(Jo,"")),ts=is.map(_s=>_s.replace(Ko,"")),ss=new Fuse(Yo,{threshold:.3}),cs=new Fuse(ts,{threshold:.3});return Zo.map(_s=>_s.toLowerCase()),Wo.map(_s=>_s.toLowerCase()),Qo=Xo.filter(_s=>_s.startsWith(`${s}:`)),Po=Xo.filter(_s=>_s.startsWith(`${c}:`)),Lo=Qo.filter(_s=>!es.includes(_s)),Qo=Qo.filter(_s=>!Lo.includes(_s)),Uo=Po.filter(_s=>!is.includes(_s)),Po=Po.filter(_s=>!Uo.includes(_s)),Lo.map(_s=>_s.replace(Jo,"").replace(/\s*/g,"").replace(/[^a-zA-Z0-9]/gmi,"")).forEach((_s,Hs)=>{ss.search(_s).length&&Go.push(Lo[Hs])}),Lo=Lo.filter(_s=>!Go.includes(_s)),Uo.map(_s=>_s.replace(Ko,"").replace(/\s*/g,"").replace(/[^a-zA-Z0-9]/gmi,"")).forEach((_s,Hs)=>{cs.search(_s).length&&$o.push(Uo[Hs])}),Uo=Uo.filter(_s=>!$o.includes(_s)),Mo=Xo.filter(_s=>!_s.startsWith(`${s}:`)&&!_s.startsWith(`${c}:`)),d=Mo.filter(_s=>Yo.includes(_s)),p=Mo.filter(_s=>ts.includes(_s)),Mo=Mo.filter(_s=>!d.includes(_s)),Mo=Mo.filter(_s=>!p.includes(_s)),Mo.map(_s=>_s.replace(/\s*/g,"").replace(/[^a-zA-Z0-9]/gmi,"")).forEach((_s,Hs)=>{ss.search(_s).length&&Co.push(Mo[Hs]),cs.search(_s).length&&Bo.push(Mo[Hs])}),jo=Mo.filter(_s=>!Co.includes(_s)),jo=jo.filter(_s=>!Bo.includes(_s)),(Qo.length||Po.length)&&(d.length||p.length||Co.length||Bo.length)&&(zo=!0),{validDWCFields:[...Qo,...d,...Po,...p],duplicatedFields:h,notDarwinCore:Lo,notDarwinCoreButClose:Go,notDublinCore:Uo,notDublinCoreButClose:$o,almostDarwinCore:Co,almostDublinCore:Bo,otherFields:jo,someFieldsNamespaced:zo}}else throw new Error("no fields provided")},onlyUnique$1=(l,o,s)=>s.indexOf(l)===o,findDuplicates=l=>l.filter((o,s)=>l.indexOf(o)!=s);var support={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};function isDataView(l){return l&&DataView.prototype.isPrototypeOf(l)}if(support.arrayBuffer)var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],isArrayBufferView=ArrayBuffer.isView||function(l){return l&&viewClasses.indexOf(Object.prototype.toString.call(l))>-1};function normalizeName(l){if(typeof l!="string"&&(l=String(l)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(l))throw new TypeError("Invalid character in header field name");return l.toLowerCase()}function normalizeValue(l){return typeof l!="string"&&(l=String(l)),l}function iteratorFor(l){var o={next:function(){var s=l.shift();return{done:s===void 0,value:s}}};return support.iterable&&(o[Symbol.iterator]=function(){return o}),o}function Headers$1(l){this.map={},l instanceof Headers$1?l.forEach(function(o,s){this.append(s,o)},this):Array.isArray(l)?l.forEach(function(o){this.append(o[0],o[1])},this):l&&Object.getOwnPropertyNames(l).forEach(function(o){this.append(o,l[o])},this)}Headers$1.prototype.append=function(l,o){l=normalizeName(l),o=normalizeValue(o);var s=this.map[l];this.map[l]=s?s+", "+o:o};Headers$1.prototype.delete=function(l){delete this.map[normalizeName(l)]};Headers$1.prototype.get=function(l){return l=normalizeName(l),this.has(l)?this.map[l]:null};Headers$1.prototype.has=function(l){return this.map.hasOwnProperty(normalizeName(l))};Headers$1.prototype.set=function(l,o){this.map[normalizeName(l)]=normalizeValue(o)};Headers$1.prototype.forEach=function(l,o){for(var s in this.map)this.map.hasOwnProperty(s)&&l.call(o,this.map[s],s,this)};Headers$1.prototype.keys=function(){var l=[];return this.forEach(function(o,s){l.push(s)}),iteratorFor(l)};Headers$1.prototype.values=function(){var l=[];return this.forEach(function(o){l.push(o)}),iteratorFor(l)};Headers$1.prototype.entries=function(){var l=[];return this.forEach(function(o,s){l.push([s,o])}),iteratorFor(l)};support.iterable&&(Headers$1.prototype[Symbol.iterator]=Headers$1.prototype.entries);function consumed(l){if(l.bodyUsed)return Promise.reject(new TypeError("Already read"));l.bodyUsed=!0}function fileReaderReady(l){return new Promise(function(o,s){l.onload=function(){o(l.result)},l.onerror=function(){s(l.error)}})}function readBlobAsArrayBuffer(l){var o=new FileReader,s=fileReaderReady(o);return o.readAsArrayBuffer(l),s}function readBlobAsText(l){var o=new FileReader,s=fileReaderReady(o);return o.readAsText(l),s}function readArrayBufferAsText(l){for(var o=new Uint8Array(l),s=new Array(o.length),c=0;c<o.length;c++)s[c]=String.fromCharCode(o[c]);return s.join("")}function bufferClone(l){if(l.slice)return l.slice(0);var o=new Uint8Array(l.byteLength);return o.set(new Uint8Array(l)),o.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(l){this._bodyInit=l,l?typeof l=="string"?this._bodyText=l:support.blob&&Blob.prototype.isPrototypeOf(l)?this._bodyBlob=l:support.formData&&FormData.prototype.isPrototypeOf(l)?this._bodyFormData=l:support.searchParams&&URLSearchParams.prototype.isPrototypeOf(l)?this._bodyText=l.toString():support.arrayBuffer&&support.blob&&isDataView(l)?(this._bodyArrayBuffer=bufferClone(l.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):support.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(l)||isArrayBufferView(l))?this._bodyArrayBuffer=bufferClone(l):this._bodyText=l=Object.prototype.toString.call(l):this._bodyText="",this.headers.get("content-type")||(typeof l=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(l)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},support.blob&&(this.blob=function(){var l=consumed(this);if(l)return l;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var l=consumed(this);if(l)return l;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode$2)}),this.json=function(){return this.text().then(JSON.parse)},this}var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function normalizeMethod(l){var o=l.toUpperCase();return methods.indexOf(o)>-1?o:l}function Request$1(l,o){o=o||{};var s=o.body;if(l instanceof Request$1){if(l.bodyUsed)throw new TypeError("Already read");this.url=l.url,this.credentials=l.credentials,o.headers||(this.headers=new Headers$1(l.headers)),this.method=l.method,this.mode=l.mode,this.signal=l.signal,!s&&l._bodyInit!=null&&(s=l._bodyInit,l.bodyUsed=!0)}else this.url=String(l);if(this.credentials=o.credentials||this.credentials||"same-origin",(o.headers||!this.headers)&&(this.headers=new Headers$1(o.headers)),this.method=normalizeMethod(o.method||this.method||"GET"),this.mode=o.mode||this.mode||null,this.signal=o.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}Request$1.prototype.clone=function(){return new Request$1(this,{body:this._bodyInit})};function decode$2(l){var o=new FormData;return l.trim().split("&").forEach(function(s){if(s){var c=s.split("="),h=c.shift().replace(/\+/g," "),d=c.join("=").replace(/\+/g," ");o.append(decodeURIComponent(h),decodeURIComponent(d))}}),o}function parseHeaders(l){var o=new Headers$1,s=l.replace(/\r?\n[\t ]+/g," ");return s.split(/\r?\n/).forEach(function(c){var h=c.split(":"),d=h.shift().trim();if(d){var p=h.join(":").trim();o.append(d,p)}}),o}Body.call(Request$1.prototype);function Response(l,o){o||(o={}),this.type="default",this.status=o.status===void 0?200:o.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in o?o.statusText:"OK",this.headers=new Headers$1(o.headers),this.url=o.url||"",this._initBody(l)}Body.call(Response.prototype);Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers$1(this.headers),url:this.url})};Response.error=function(){var l=new Response(null,{status:0,statusText:""});return l.type="error",l};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(l,o){if(redirectStatuses.indexOf(o)===-1)throw new RangeError("Invalid status code");return new Response(null,{status:o,headers:{location:l}})};var DOMException$1=self.DOMException;try{new DOMException$1}catch(l){DOMException$1=function(o,s){this.message=o,this.name=s;var c=Error(o);this.stack=c.stack},DOMException$1.prototype=Object.create(Error.prototype),DOMException$1.prototype.constructor=DOMException$1}function fetch$1(l,o){return new Promise(function(s,c){var h=new Request$1(l,o);if(h.signal&&h.signal.aborted)return c(new DOMException$1("Aborted","AbortError"));var d=new XMLHttpRequest;function p(){d.abort()}d.onload=function(){var Co={status:d.status,statusText:d.statusText,headers:parseHeaders(d.getAllResponseHeaders()||"")};Co.url="responseURL"in d?d.responseURL:Co.headers.get("X-Request-URL");var Bo="response"in d?d.response:d.responseText;s(new Response(Bo,Co))},d.onerror=function(){c(new TypeError("Network request failed"))},d.ontimeout=function(){c(new TypeError("Network request failed"))},d.onabort=function(){c(new DOMException$1("Aborted","AbortError"))},d.open(h.method,h.url,!0),h.credentials==="include"?d.withCredentials=!0:h.credentials==="omit"&&(d.withCredentials=!1),"responseType"in d&&support.blob&&(d.responseType="blob"),h.headers.forEach(function(Co,Bo){d.setRequestHeader(Bo,Co)}),h.signal&&(h.signal.addEventListener("abort",p),d.onreadystatechange=function(){d.readyState===4&&h.signal.removeEventListener("abort",p)}),d.send(typeof h._bodyInit>"u"?null:h._bodyInit)})}fetch$1.polyfill=!0;self.fetch||(self.fetch=fetch$1,self.Headers=Headers$1,self.Request=Request$1,self.Response=Response);self.fetch.bind(self);async function getDWCTerms(){let l=await fetch("https://dwc.tdwg.org/terms");if(l.status>=400)throw new Error(l.statusText);{let s=(await l.text()).match(/(<\s*a[^>]*>(.*?)<\s*\/\s*a>)/g),c=s.filter(Uo=>Uo.startsWith('<a id="dwc:')),h,d,p,Co=c.map(Uo=>(h=Uo.indexOf("dwc:"),d=Uo.indexOf('"',h),p=Uo.substring(h,d),p)),Lo=s.filter(Uo=>Uo.startsWith('<a id="dcterms:')).map(Uo=>(h=Uo.indexOf("dcterms:"),d=Uo.indexOf('"',h),p=Uo.substring(h,d),p));return Lo=Lo.map(Uo=>Uo.replace("dcterms:","dc:")),{dwcTerms:Co,dcTerms:Lo}}}let readHeadersAndValidate=async l=>{let o=new Promise((c,h)=>{console.log("reading csv headers"),Papa.parse(l,{header:!0,preview:1,complete:async d=>{try{let p=Object.keys(d.data[0]);console.log("fetching Darwin Core terms");let Co=await getDWCTerms(),Bo=validateFields(p,Co);c(Bo)}catch(p){h(new Error("error reading headers:",p.message))}},error:d=>h(new Error("error reading headers:",d.message))})}),s;try{s=await o}catch(c){throw c}return s};const confirmCSVFields_svelte_svelte_type_style_lang="";function get_each_context$6(l,o,s){const c=l.slice();return c[18]=o[s],c}function get_each_context_1(l,o,s){const c=l.slice();return c[18]=o[s],c}function create_else_block$e(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o=l[1]&&l[1].length&&create_if_block_13$1(l),jo=l[0].someFieldsNamespaced&&create_if_block_12$1(),zo=l[3]&&l[3].length&&create_if_block_11$2(l),Xo=l[2]&&l[2].length&&create_if_block_10$2(l),Zo=l[4]&&l[4].length&&create_if_block_9$3(l),Wo=l[7]&&create_if_block_6$4(l),es=l[7]&&!l[6].recordIDField&&create_if_block_4$6(l),is=!l[7]&&create_if_block_2$9(l);function Jo(ts,ss){return ts[7]?create_if_block_1$b:create_else_block_1$8}let Ko=Jo(l),Yo=Ko(l);return{c(){o=element("div"),s=element("h2"),s.textContent="Please confirm the fields in your dataset",c=space(),$o&&$o.c(),h=space(),jo&&jo.c(),d=space(),zo&&zo.c(),p=space(),Xo&&Xo.c(),Co=space(),Zo&&Zo.c(),Bo=space(),Wo&&Wo.c(),Lo=space(),es&&es.c(),Uo=space(),is&&is.c(),Qo=space(),Yo.c(),Po=space(),Mo=element("div"),attr(s,"class","svelte-1okp5za"),set_style(Mo,"clear","both"),attr(o,"class","confirmfield-container svelte-1okp5za")},m(ts,ss){insert(ts,o,ss),append(o,s),append(o,c),$o&&$o.m(o,null),append(o,h),jo&&jo.m(o,null),append(o,d),zo&&zo.m(o,null),append(o,p),Xo&&Xo.m(o,null),append(o,Co),Zo&&Zo.m(o,null),append(o,Bo),Wo&&Wo.m(o,null),append(o,Lo),es&&es.m(o,null),append(o,Uo),is&&is.m(o,null),append(o,Qo),Yo.m(o,null),append(o,Po),append(o,Mo),Go=!0},p(ts,ss){ts[1]&&ts[1].length?$o?$o.p(ts,ss):($o=create_if_block_13$1(ts),$o.c(),$o.m(o,h)):$o&&($o.d(1),$o=null),ts[0].someFieldsNamespaced?jo||(jo=create_if_block_12$1(),jo.c(),jo.m(o,d)):jo&&(jo.d(1),jo=null),ts[3]&&ts[3].length?zo?zo.p(ts,ss):(zo=create_if_block_11$2(ts),zo.c(),zo.m(o,p)):zo&&(zo.d(1),zo=null),ts[2]&&ts[2].length?Xo?Xo.p(ts,ss):(Xo=create_if_block_10$2(ts),Xo.c(),Xo.m(o,Co)):Xo&&(Xo.d(1),Xo=null),ts[4]&&ts[4].length?Zo?Zo.p(ts,ss):(Zo=create_if_block_9$3(ts),Zo.c(),Zo.m(o,Bo)):Zo&&(Zo.d(1),Zo=null),ts[7]?Wo?Wo.p(ts,ss):(Wo=create_if_block_6$4(ts),Wo.c(),Wo.m(o,Lo)):Wo&&(Wo.d(1),Wo=null),ts[7]&&!ts[6].recordIDField?es?(es.p(ts,ss),ss&192&&transition_in(es,1)):(es=create_if_block_4$6(ts),es.c(),transition_in(es,1),es.m(o,Uo)):es&&(group_outros(),transition_out(es,1,1,()=>{es=null}),check_outros()),ts[7]?is&&(is.d(1),is=null):is?is.p(ts,ss):(is=create_if_block_2$9(ts),is.c(),is.m(o,Qo)),Ko===(Ko=Jo(ts))&&Yo?Yo.p(ts,ss):(Yo.d(1),Yo=Ko(ts),Yo&&(Yo.c(),Yo.m(o,Po)))},i(ts){Go||(transition_in(es),Go=!0)},o(ts){transition_out(es),Go=!1},d(ts){ts&&detach(o),$o&&$o.d(),jo&&jo.d(),zo&&zo.d(),Xo&&Xo.d(),Zo&&Zo.d(),Wo&&Wo.d(),es&&es.d(),is&&is.d(),Yo.d()}}}function create_if_block$i(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_13$1(l){let o,s,c,h,d=l[1].join(", ")+"",p;return{c(){o=element("h4"),o.textContent="Darwin Core fields:",s=space(),c=element("p"),h=element("i"),p=text(d)},m(Co,Bo){insert(Co,o,Bo),insert(Co,s,Bo),insert(Co,c,Bo),append(c,h),append(h,p)},p(Co,Bo){Bo&2&&d!==(d=Co[1].join(", ")+"")&&set_data(p,d)},d(Co){Co&&detach(o),Co&&detach(s),Co&&detach(c)}}}function create_if_block_12$1(l){let o;return{c(){o=element("p"),o.innerHTML="<strong>Some fields are namespaced and others not - it&#39;s best to be consistent</strong>",set_style(o,"color","red")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_11$2(l){let o,s,c,h,d,p,Co=l[3].join(", ")+"",Bo;return{c(){o=element("h4"),o.textContent="Malformed fields:",s=space(),c=element("p"),c.innerHTML='The following fields may be incorrectly formed Darwin Core fields. Darwin Core terms are <a href="https://en.wikipedia.org/wiki/Camel_case" target="_blank">camelCase</a> and don&#39;t include spaces, numbers or punctuation. Please see <a href="https://dwc.tdwg.org/terms/" target="_blank">the standard</a>',h=space(),d=element("p"),p=element("i"),Bo=text(Co)},m(Lo,Uo){insert(Lo,o,Uo),insert(Lo,s,Uo),insert(Lo,c,Uo),insert(Lo,h,Uo),insert(Lo,d,Uo),append(d,p),append(p,Bo)},p(Lo,Uo){Uo&8&&Co!==(Co=Lo[3].join(", ")+"")&&set_data(Bo,Co)},d(Lo){Lo&&detach(o),Lo&&detach(s),Lo&&detach(c),Lo&&detach(h),Lo&&detach(d)}}}function create_if_block_10$2(l){let o,s,c,h,d,p,Co=l[3].join(", ")+"",Bo;return{c(){o=element("h4"),o.textContent="Not Darwin Core:",s=space(),c=element("p"),c.textContent="The following fields include namespace prefixes but don't exist in those namespaces. Make sure you're using the correct namespace prefixes for the Dublin Core terms within Darwin Core",h=space(),d=element("p"),p=element("i"),Bo=text(Co)},m(Lo,Uo){insert(Lo,o,Uo),insert(Lo,s,Uo),insert(Lo,c,Uo),insert(Lo,h,Uo),insert(Lo,d,Uo),append(d,p),append(p,Bo)},p(Lo,Uo){Uo&8&&Co!==(Co=Lo[3].join(", ")+"")&&set_data(Bo,Co)},d(Lo){Lo&&detach(o),Lo&&detach(s),Lo&&detach(c),Lo&&detach(h),Lo&&detach(d)}}}function create_if_block_9$3(l){let o,s,c,h,d,p,Co=l[4].join(", ")+"",Bo;return{c(){o=element("h4"),o.textContent="Other fields:",s=space(),c=element("p"),c.textContent="The following additional fields were found in the dataset:",h=space(),d=element("p"),p=element("i"),Bo=text(Co)},m(Lo,Uo){insert(Lo,o,Uo),insert(Lo,s,Uo),insert(Lo,c,Uo),insert(Lo,h,Uo),insert(Lo,d,Uo),append(d,p),append(p,Bo)},p(Lo,Uo){Uo&16&&Co!==(Co=Lo[4].join(", ")+"")&&set_data(Bo,Co)},d(Lo){Lo&&detach(o),Lo&&detach(s),Lo&&detach(c),Lo&&detach(h),Lo&&detach(d)}}}function create_if_block_6$4(l){let o,s,c,h=l[8],d=[];for(let p=0;p<h.length;p+=1)d[p]=create_each_block_1(get_each_context_1(l,h,p));return{c(){o=element("h3"),o.textContent="The following required or recommended fields are missing:",s=space();for(let p=0;p<d.length;p+=1)d[p].c();c=empty$1(),set_style(o,"color","tomato")},m(p,Co){insert(p,o,Co),insert(p,s,Co);for(let Bo=0;Bo<d.length;Bo+=1)d[Bo].m(p,Co);insert(p,c,Co)},p(p,Co){if(Co&320){h=p[8];let Bo;for(Bo=0;Bo<h.length;Bo+=1){const Lo=get_each_context_1(p,h,Bo);d[Bo]?d[Bo].p(Lo,Co):(d[Bo]=create_each_block_1(Lo),d[Bo].c(),d[Bo].m(c.parentNode,c))}for(;Bo<d.length;Bo+=1)d[Bo].d(1);d.length=h.length}},d(p){p&&detach(o),p&&detach(s),destroy_each(d,p),p&&detach(c)}}}function create_if_block_7$3(l){let o;function s(d,p){return d[18].required?create_if_block_8$3:create_else_block_3$3}let h=s(l)(l);return{c(){h.c(),o=empty$1()},m(d,p){h.m(d,p),insert(d,o,p)},p(d,p){h.p(d,p)},d(d){h.d(d),d&&detach(o)}}}function create_else_block_3$3(l){let o,s=l[18].targetfields.replace(/\s*\|\|\s*/g," OR ")+"",c;return{c(){o=element("p"),c=text(s)},m(h,d){insert(h,o,d),append(o,c)},p:noop$2,d(h){h&&detach(o)}}}function create_if_block_8$3(l){let o,s=l[18].targetfields.replace(/\s*\|\|\s*/g," OR ")+"",c;return{c(){o=element("p"),c=text(s)},m(h,d){insert(h,o,d),append(o,c)},p:noop$2,d(h){h&&detach(o)}}}function create_each_block_1(l){let o,s=!l[6][l[18].key]&&create_if_block_7$3(l);return{c(){s&&s.c(),o=empty$1()},m(c,h){s&&s.m(c,h),insert(c,o,h)},p(c,h){c[6][c[18].key]?s&&(s.d(1),s=null):s?s.p(c,h):(s=create_if_block_7$3(c),s.c(),s.m(o.parentNode,o))},d(c){s&&s.d(c),c&&detach(o)}}}function create_if_block_4$6(l){let o,s,c,h,d=l[5].length>0&&create_if_block_5$5(l);return{c(){o=element("h3"),o.textContent="A unique row identifier field is required",s=space(),d&&d.c(),c=empty$1(),set_style(o,"color","tomato")},m(p,Co){insert(p,o,Co),insert(p,s,Co),d&&d.m(p,Co),insert(p,c,Co),h=!0},p(p,Co){p[5].length>0?d?(d.p(p,Co),Co&32&&transition_in(d,1)):(d=create_if_block_5$5(p),d.c(),transition_in(d,1),d.m(c.parentNode,c)):d&&(group_outros(),transition_out(d,1,1,()=>{d=null}),check_outros())},i(p){h||(transition_in(d),h=!0)},o(p){transition_out(d),h=!1},d(p){p&&detach(o),p&&detach(s),d&&d.d(p),p&&detach(c)}}}function create_if_block_5$5(l){let o,s,c,h,d;return h=new Select({props:{items:l[5]}}),h.$on("select",l[9]),{c(){o=element("p"),o.textContent="Please select a field that uniquely identifies rows in the dataset. Recommended Darwin Core fields are occurrenceID and catalogNumber, but other fields like can be used as long as they are unique per row",s=space(),c=element("div"),create_component(h.$$.fragment),set_style(c,"width","500px"),set_style(c,"text-align","center")},m(p,Co){insert(p,o,Co),insert(p,s,Co),insert(p,c,Co),mount_component(h,c,null),d=!0},p(p,Co){const Bo={};Co&32&&(Bo.items=p[5]),h.$set(Bo)},i(p){d||(transition_in(h.$$.fragment,p),d=!0)},o(p){transition_out(h.$$.fragment,p),d=!1},d(p){p&&detach(o),p&&detach(s),p&&detach(c),destroy_component(h)}}}function create_if_block_2$9(l){let o,s,c,h=l[8],d=[];for(let p=0;p<h.length;p+=1)d[p]=create_each_block$6(get_each_context$6(l,h,p));return{c(){o=element("h4"),o.textContent="Fields to be used for georeferencing:",s=space();for(let p=0;p<d.length;p+=1)d[p].c();c=empty$1()},m(p,Co){insert(p,o,Co),insert(p,s,Co);for(let Bo=0;Bo<d.length;Bo+=1)d[Bo].m(p,Co);insert(p,c,Co)},p(p,Co){if(Co&320){h=p[8];let Bo;for(Bo=0;Bo<h.length;Bo+=1){const Lo=get_each_context$6(p,h,Bo);d[Bo]?d[Bo].p(Lo,Co):(d[Bo]=create_each_block$6(Lo),d[Bo].c(),d[Bo].m(c.parentNode,c))}for(;Bo<d.length;Bo+=1)d[Bo].d(1);d.length=h.length}},d(p){p&&detach(o),p&&detach(s),destroy_each(d,p),p&&detach(c)}}}function create_else_block_2$6(l){let o,s=l[18].key+"",c,h,d,p=(l[6][l[18].key]||"none")+"",Co;return{c(){o=element("p"),c=text(s),h=text(" (recommended): "),d=element("i"),Co=text(p)},m(Bo,Lo){insert(Bo,o,Lo),append(o,c),append(o,h),append(o,d),append(d,Co)},p(Bo,Lo){Lo&64&&p!==(p=(Bo[6][Bo[18].key]||"none")+"")&&set_data(Co,p)},d(Bo){Bo&&detach(o)}}}function create_if_block_3$7(l){let o,s=l[18].key+"",c,h,d,p=l[6][l[18].key]+"",Co;return{c(){o=element("p"),c=text(s),h=text(" (required): "),d=element("i"),Co=text(p)},m(Bo,Lo){insert(Bo,o,Lo),append(o,c),append(o,h),append(o,d),append(d,Co)},p(Bo,Lo){Lo&64&&p!==(p=Bo[6][Bo[18].key]+"")&&set_data(Co,p)},d(Bo){Bo&&detach(o)}}}function create_each_block$6(l){let o;function s(d,p){return d[18].required?create_if_block_3$7:create_else_block_2$6}let h=s(l)(l);return{c(){h.c(),o=empty$1()},m(d,p){h.m(d,p),insert(d,o,p)},p(d,p){h.p(d,p)},d(d){h.d(d),d&&detach(o)}}}function create_else_block_1$8(l){let o,s,c;return{c(){o=element("button"),o.textContent="Next...",set_style(o,"width","200px"),set_style(o,"float","right")},m(h,d){insert(h,o,d),s||(c=listen(o,"click",l[10]),s=!0)},p:noop$2,d(h){h&&detach(o),s=!1,c()}}}function create_if_block_1$b(l){let o,s,c;return{c(){o=element("button"),o.textContent="I'll start over",set_style(o,"width","200px"),set_style(o,"float","right"),set_style(o,"margin-right","20px")},m(h,d){insert(h,o,d),s||(c=listen(o,"click",l[11]),s=!0)},p:noop$2,d(h){h&&detach(o),s=!1,c()}}}function create_fragment$s(l){let o,s,c,h;const d=[create_if_block$i,create_else_block$e],p=[];function Co(Bo,Lo){return Bo[0]?1:0}return o=Co(l),s=p[o]=d[o](l),{c(){s.c(),c=empty$1()},m(Bo,Lo){p[o].m(Bo,Lo),insert(Bo,c,Lo),h=!0},p(Bo,[Lo]){let Uo=o;o=Co(Bo),o===Uo?p[o].p(Bo,Lo):(group_outros(),transition_out(p[Uo],1,1,()=>{p[Uo]=null}),check_outros(),s=p[o],s?s.p(Bo,Lo):(s=p[o]=d[o](Bo),s.c()),transition_in(s,1),s.m(c.parentNode,c))},i(Bo){h||(transition_in(s),h=!0)},o(Bo){transition_out(s),h=!1},d(Bo){p[o].d(Bo),Bo&&detach(c)}}}function instance$s(l,o,s){const c=createEventDispatcher();let{file:h}=o,d,p=[],Co=[],Bo=[],Lo=[],Uo=[],Qo=[{key:"taxonField",targetfields:"dwc:scientificName",required:!0},{key:"recordIDField",targetfields:"dwc:occurrenceID",required:!0},{key:"countryField",targetfields:"dwc:country",required:!0},{key:"stateProvinceField",targetfields:"dwc:stateProvince",required:!1},{key:"localityField",targetfields:"dwc:verbatimLocality || dwc:locality",required:!0},{key:"collectorsField",targetfields:"dwc:recordedBy",required:!1}],Po={},Mo=!1;async function Go(es){es&&s(0,d=await readHeadersAndValidate(es))}function $o(){if(jo(),d){d.validDWCFields.length>0&&s(1,p=d.validDWCFields),(d.notDarwinCore.length||d.notDublinCore.length)&&s(2,Co=[...d.notDarwinCore,...d.notDublinCore]),(d.notDarwinCoreButClose.length||d.notDublinCoreButClose.length||d.almostDarwinCore.length||d.almostDublinCore.length)&&s(3,Bo=[...d.notDarwinCoreButClose,...d.notDublinCoreButClose,...d.almostDarwinCore,...d.almostDublinCore]),d.otherFields.length&&s(4,Lo=d.otherFields);for(let es of Qo){let is=es.targetfields.trim().split(/\s*\|\|\s*/g);for(let Jo of is){let Ko=null;if(p&&(Ko=p.find(Yo=>Yo==Jo||Yo==Jo.split(":")[1]||Yo.split(":")[1]==Jo)),Ko){s(6,Po[es.key]=Ko,Po);break}else s(6,Po[es.key]=null,Po)}}if(Xo(),!Po.recordIDField){let es=null;p&&(es=p.find(is=>is=="catalogNumber"||is.split(":")[1]=="catalogNumber")),es||(es=[]),Lo&&Lo.length&&(es=[...es,...Lo].filter(is=>is&&is.trim())),Bo&&Bo.length&&(es=[...es,...Bo].filter(is=>is&&is.trim())),s(5,Uo=es.map(is=>({value:is,label:is})))}}}function jo(){s(6,Po={}),s(1,p=null),s(2,Co=null),s(3,Bo=null),s(4,Lo=null),s(5,Uo=null),s(7,Mo=!1)}function zo(es){s(6,Po.recordIDField=es.detail.value,Po),Xo()}function Xo(){let es=!1;for(let is of Qo)if(is.required&&!Po[is.key]){es=!0;break}es?s(7,Mo=!0):s(7,Mo=!1)}function Zo(){c("fields-confirmed",Po)}function Wo(){c("fields-confirm-cancelled")}return l.$$set=es=>{"file"in es&&s(12,h=es.file)},l.$$.update=()=>{l.$$.dirty&4096&&Go(h),l.$$.dirty&1&&$o()},[d,p,Co,Bo,Lo,Uo,Po,Mo,Qo,zo,Zo,Wo,h]}class ConfirmCSVFields extends SvelteComponent{constructor(o){super(),init(this,o,instance$s,create_fragment$s,safe_not_equal,{file:12})}}let validateCSVContent=(l,o)=>new Promise((s,c)=>{if(!l){c("file data required");return}if(!o){c("required fields object must be provided");return}if(Object.keys(o).forEach(es=>{o[es]&&o[es].trim()?o[es]=o[es].trim():o[es]=null}),!o.recordIDField||!o.localityField){c("required fields not provided");return}let h=new Map,d=!1,p=0,Co=0,Bo=0,Lo=!1,Uo=new Map,Qo=0,Po=!1,Mo=!1,Go=[],$o={},jo,zo,Xo,Zo,Wo=[];Papa.parse(l,{header:!0,step:function(es){if(p++,jo=es.data[o.recordIDField],jo&&jo.trim()?(jo=jo.trim(),h.has(jo)?(Uo.set(jo,!0),Qo++):h.set(jo,!0)):Lo=!0,zo=es.data[o.countryField],zo&&zo.trim()?(zo=zo.trim().replace(/\s+/g," ").replace(/[\.,;-\s]+$/,"").replace(/^[\.,;-\s]+/,""),zo||jo||(Po=!0)):(zo=null,jo||(Po=!0)),o.stateProvinceField&&(Xo=es.data[o.stateProvinceField],Xo&&Xo.trim()&&(Xo=Xo.trim().replace(/\s+/g," ").replace(/[\.,;-\s]+$/,"").replace(/^[\.,;-\s]+/,""),Xo&&!d&&(d=!0))),Zo=es.data[o.localityField],Zo&&Zo.trim()?(Zo=Zo.trim().replace(/\s+/g," ").replace(/[\.,;-\s]+$/,"").replace(/^[\.,;-\s]+/,""),Zo||(jo?Go.push(jo):Mo=!0)):(Zo=null,jo?Go.push(jo):Mo=!0),jo&&zo&&Zo){let is=Zo;if(o.collectorField&&es.data[o.collectorField]&&es.data[o.collectorField].trim()){let Jo=es.data[o.collectorField].trim().replace(/\s+/g," ").replace(/\|/g,"; ").replace(/[\.,;-\s]+$/,"");is+=" -- "+Jo}Wo.push({recordID:jo,country:zo,stateProvince:Xo,localityCollector:is})}jo=zo=Xo=Zo=null},complete:function(){console.log("All done parsing file!");for(let{recordID:is,country:Jo,stateProvince:Ko,localityCollector:Yo}of Wo)Uo.has(is)||($o[Jo]||($o[Jo]={}),d?(Ko||(Ko="none"),$o[Jo][Ko]?$o[Jo][Ko][Yo]?$o[Jo][Ko][Yo].push(is):($o[Jo][Ko][Yo]=[is],Co++):($o[Jo][Ko]={},$o[Jo][Ko][Yo]=[is],Co++)):$o[Jo][Yo]?$o[Jo][Yo].push(is):($o[Jo][Yo]=[is],Co++),Bo++);Uo=[...Uo.keys()],Qo+=Uo.length,s({hasStateProvince:d,totalRows:p,uniqueLocalityCollectorCount:Co,recordsToGeoreference:Bo,recordIDsMissing:Lo,duplicatedRecordIDs:Uo,duplicateRecordCount:Qo,recordsMissingCountryAlsoMissingID:Po,recordsMissingLocalityAlsoMissingID:Mo,rowsWithoutLocality:Go,localityRecordIDMap:$o})},error(es){c(new Error(`error reading file: ${es.message}`))}})});const confirmCSVData_svelte_svelte_type_style_lang="";function create_else_block$d(l){let o,s,c,h,d=l[1].totalRows+"",p,Co,Bo,Lo,Uo=l[1].recordsToGeoreference+"",Qo,Po,Mo=Math.round(l[1].recordsToGeoreference/l[1].totalRows*100)+"",Go,$o,jo,zo,Xo,Zo=l[1].uniqueLocalityCollectorCount+"",Wo,es,is=l[0].collectorField?"/collector":"",Jo,Ko,Yo,ts;function ss(us,gs){return us[1].uniqueLocalityCollectorCount<=20?create_if_block_1$a:create_else_block_1$7}let cs=ss(l),as=cs(l);return{c(){o=element("h2"),o.textContent="Please check your file summary before proceeding:",s=space(),c=element("h4"),h=text("This file contains "),p=text(d),Co=text(" records"),Bo=space(),Lo=element("h4"),Qo=text(Uo),Po=text(" (~"),Go=text(Mo),$o=text("%) qualify for georeferencing"),jo=space(),zo=element("h3"),Xo=text("There are "),Wo=text(Zo),es=text(" unique locality"),Jo=text(is),Ko=text(" values that will be grouped during georeferencing"),Yo=space(),as.c(),ts=empty$1(),attr(o,"class","svelte-1bxfhxo")},m(us,gs){insert(us,o,gs),insert(us,s,gs),insert(us,c,gs),append(c,h),append(c,p),append(c,Co),insert(us,Bo,gs),insert(us,Lo,gs),append(Lo,Qo),append(Lo,Po),append(Lo,Go),append(Lo,$o),insert(us,jo,gs),insert(us,zo,gs),append(zo,Xo),append(zo,Wo),append(zo,es),append(zo,Jo),append(zo,Ko),insert(us,Yo,gs),as.m(us,gs),insert(us,ts,gs)},p(us,gs){gs&2&&d!==(d=us[1].totalRows+"")&&set_data(p,d),gs&2&&Uo!==(Uo=us[1].recordsToGeoreference+"")&&set_data(Qo,Uo),gs&2&&Mo!==(Mo=Math.round(us[1].recordsToGeoreference/us[1].totalRows*100)+"")&&set_data(Go,Mo),gs&2&&Zo!==(Zo=us[1].uniqueLocalityCollectorCount+"")&&set_data(Wo,Zo),gs&1&&is!==(is=us[0].collectorField?"/collector":"")&&set_data(Jo,is),cs===(cs=ss(us))&&as?as.p(us,gs):(as.d(1),as=cs(us),as&&(as.c(),as.m(ts.parentNode,ts)))},i:noop$2,o:noop$2,d(us){us&&detach(o),us&&detach(s),us&&detach(c),us&&detach(Bo),us&&detach(Lo),us&&detach(jo),us&&detach(zo),us&&detach(Yo),as.d(us),us&&detach(ts)}}}function create_if_block$h(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_else_block_1$7(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo=l[1].recordIDsMissing&&create_if_block_9$2(),zo=l[1].recordsMissingLocalityAlsoMissingID&&create_if_block_8$2(),Xo=l[1].duplicatedRecordIDs.length&&create_if_block_5$4(l),Zo=l[1].rowsWithoutLocality&&l[1].rowsWithoutLocality.length&&create_if_block_2$8(l);return{c(){jo&&jo.c(),o=space(),zo&&zo.c(),s=space(),Xo&&Xo.c(),c=space(),Zo&&Zo.c(),h=space(),d=element("br"),p=space(),Co=element("button"),Bo=text("Next..."),Uo=space(),Qo=element("button"),Qo.textContent="I'll start over",Po=space(),Mo=element("div"),Co.disabled=Lo=!l[0].recordIDField,set_style(Co,"width","200px"),set_style(Co,"float","right"),set_style(Qo,"width","200px"),set_style(Qo,"float","right"),set_style(Qo,"margin-right","20px"),set_style(Mo,"clear","both")},m(Wo,es){jo&&jo.m(Wo,es),insert(Wo,o,es),zo&&zo.m(Wo,es),insert(Wo,s,es),Xo&&Xo.m(Wo,es),insert(Wo,c,es),Zo&&Zo.m(Wo,es),insert(Wo,h,es),insert(Wo,d,es),insert(Wo,p,es),insert(Wo,Co,es),append(Co,Bo),insert(Wo,Uo,es),insert(Wo,Qo,es),insert(Wo,Po,es),insert(Wo,Mo,es),Go||($o=[listen(Co,"click",l[5]),listen(Qo,"click",l[6])],Go=!0)},p(Wo,es){Wo[1].recordIDsMissing?jo||(jo=create_if_block_9$2(),jo.c(),jo.m(o.parentNode,o)):jo&&(jo.d(1),jo=null),Wo[1].recordsMissingLocalityAlsoMissingID?zo||(zo=create_if_block_8$2(),zo.c(),zo.m(s.parentNode,s)):zo&&(zo.d(1),zo=null),Wo[1].duplicatedRecordIDs.length?Xo?Xo.p(Wo,es):(Xo=create_if_block_5$4(Wo),Xo.c(),Xo.m(c.parentNode,c)):Xo&&(Xo.d(1),Xo=null),Wo[1].rowsWithoutLocality&&Wo[1].rowsWithoutLocality.length?Zo?Zo.p(Wo,es):(Zo=create_if_block_2$8(Wo),Zo.c(),Zo.m(h.parentNode,h)):Zo&&(Zo.d(1),Zo=null),es&1&&Lo!==(Lo=!Wo[0].recordIDField)&&(Co.disabled=Lo)},d(Wo){jo&&jo.d(Wo),Wo&&detach(o),zo&&zo.d(Wo),Wo&&detach(s),Xo&&Xo.d(Wo),Wo&&detach(c),Zo&&Zo.d(Wo),Wo&&detach(h),Wo&&detach(d),Wo&&detach(p),Wo&&detach(Co),Wo&&detach(Uo),Wo&&detach(Qo),Wo&&detach(Po),Wo&&detach(Mo),Go=!1,run_all($o)}}}function create_if_block_1$a(l){let o,s,c,h,d;return{c(){o=element("p"),o.textContent="It doesn't make sense to use bulk georeferencing for this number of localities. Rather start over, extract the unique localities from your dataset and use the manual georeferencing option.",s=space(),c=element("button"),c.textContent="I'll start over",set_style(c,"width","200px"),set_style(c,"float","right"),set_style(c,"margin-right","20px")},m(p,Co){insert(p,o,Co),insert(p,s,Co),insert(p,c,Co),h||(d=listen(c,"click",l[6]),h=!0)},p:noop$2,d(p){p&&detach(o),p&&detach(s),p&&detach(c),h=!1,d()}}}function create_if_block_9$2(l){let o;return{c(){o=element("h3"),o.textContent="There are records missing IDs. If you continue rows with no IDs will be discarded",set_style(o,"color","tomoto")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_8$2(l){let o;return{c(){o=element("h3"),o.textContent="There are records missing IDs AND locality values. If you continue these will be discarded",set_style(o,"color","tomoto")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_5$4(l){let o,s,c=l[1].duplicateRecordCount+"",h,d,p=l[1].duplicatedRecordIDs.length+"",Co,Bo,Lo,Uo,Qo,Po,Mo,Go;function $o(Zo,Wo){return Zo[3]?create_if_block_7$2:create_else_block_3$2}let jo=$o(l),zo=jo(l),Xo=l[3]&&create_if_block_6$3(l);return{c(){o=element("h3"),s=text("There are "),h=text(c),d=text(" duplicated records for "),Co=text(p),Bo=text(" recordID values. Please ensure every row has a unique ID, otherwise these will be discarded"),Lo=space(),Uo=element("button"),zo.c(),Qo=space(),Xo&&Xo.c(),Po=empty$1(),set_style(o,"color","tomato")},m(Zo,Wo){insert(Zo,o,Wo),append(o,s),append(o,h),append(o,d),append(o,Co),append(o,Bo),insert(Zo,Lo,Wo),insert(Zo,Uo,Wo),zo.m(Uo,null),insert(Zo,Qo,Wo),Xo&&Xo.m(Zo,Wo),insert(Zo,Po,Wo),Mo||(Go=listen(Uo,"click",l[4]),Mo=!0)},p(Zo,Wo){Wo&2&&c!==(c=Zo[1].duplicateRecordCount+"")&&set_data(h,c),Wo&2&&p!==(p=Zo[1].duplicatedRecordIDs.length+"")&&set_data(Co,p),jo!==(jo=$o(Zo))&&(zo.d(1),zo=jo(Zo),zo&&(zo.c(),zo.m(Uo,null))),Zo[3]?Xo?Xo.p(Zo,Wo):(Xo=create_if_block_6$3(Zo),Xo.c(),Xo.m(Po.parentNode,Po)):Xo&&(Xo.d(1),Xo=null)},d(Zo){Zo&&detach(o),Zo&&detach(Lo),Zo&&detach(Uo),zo.d(),Zo&&detach(Qo),Xo&&Xo.d(Zo),Zo&&detach(Po),Mo=!1,Go()}}}function create_else_block_3$2(l){let o;return{c(){o=text("show")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_7$2(l){let o;return{c(){o=text("hide")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_6$3(l){let o,s,c=l[1].duplicatedRecordIDs.join("; ")+"",h;return{c(){o=element("p"),s=element("i"),h=text(c)},m(d,p){insert(d,o,p),append(o,s),append(s,h)},p(d,p){p&2&&c!==(c=d[1].duplicatedRecordIDs.join("; ")+"")&&set_data(h,c)},d(d){d&&detach(o)}}}function create_if_block_2$8(l){let o;function s(d,p){return d[1].rowsWithoutLocality.length<=20?create_if_block_3$6:create_else_block_2$5}let c=s(l),h=c(l);return{c(){h.c(),o=empty$1()},m(d,p){h.m(d,p),insert(d,o,p)},p(d,p){c===(c=s(d))&&h?h.p(d,p):(h.d(1),h=c(d),h&&(h.c(),h.m(o.parentNode,o)))},d(d){h.d(d),d&&detach(o)}}}function create_else_block_2$5(l){let o,s=l[1].rowsWithoutLocality.length+"",c,h,d,p,Co,Bo,Lo,Uo,Qo=l[2]&&create_if_block_4$5(l);return{c(){o=element("h4"),c=text(s),h=text(" records are missing a locality value and therefore cannot be georeferenced:"),d=space(),p=element("button"),p.textContent=`${showMissingLocalitiesButtonText}`,Co=space(),Qo&&Qo.c(),Bo=empty$1()},m(Po,Mo){insert(Po,o,Mo),append(o,c),append(o,h),insert(Po,d,Mo),insert(Po,p,Mo),insert(Po,Co,Mo),Qo&&Qo.m(Po,Mo),insert(Po,Bo,Mo),Lo||(Uo=listen(p,"click",l[8]),Lo=!0)},p(Po,Mo){Mo&2&&s!==(s=Po[1].rowsWithoutLocality.length+"")&&set_data(c,s),Po[2]?Qo?Qo.p(Po,Mo):(Qo=create_if_block_4$5(Po),Qo.c(),Qo.m(Bo.parentNode,Bo)):Qo&&(Qo.d(1),Qo=null)},d(Po){Po&&detach(o),Po&&detach(d),Po&&detach(p),Po&&detach(Co),Qo&&Qo.d(Po),Po&&detach(Bo),Lo=!1,Uo()}}}function create_if_block_3$6(l){let o,s,c,h,d=l[1].rowsWithoutLocality.join("; ")+"",p;return{c(){o=element("h4"),o.textContent="The following records are missing a locality value and cannot be georeferenced:",s=space(),c=element("p"),h=element("i"),p=text(d)},m(Co,Bo){insert(Co,o,Bo),insert(Co,s,Bo),insert(Co,c,Bo),append(c,h),append(h,p)},p(Co,Bo){Bo&2&&d!==(d=Co[1].rowsWithoutLocality.join("; ")+"")&&set_data(p,d)},d(Co){Co&&detach(o),Co&&detach(s),Co&&detach(c)}}}function create_if_block_4$5(l){let o,s,c=l[1].rowsWithoutLocality.join("; ")+"",h;return{c(){o=element("p"),s=element("i"),h=text(c)},m(d,p){insert(d,o,p),append(o,s),append(s,h)},p(d,p){p&2&&c!==(c=d[1].rowsWithoutLocality.join("; ")+"")&&set_data(h,c)},d(d){d&&detach(o)}}}function create_fragment$r(l){let o,s,c,h;const d=[create_if_block$h,create_else_block$d],p=[];function Co(Bo,Lo){return Bo[1]?1:0}return o=Co(l),s=p[o]=d[o](l),{c(){s.c(),c=empty$1()},m(Bo,Lo){p[o].m(Bo,Lo),insert(Bo,c,Lo),h=!0},p(Bo,[Lo]){let Uo=o;o=Co(Bo),o===Uo?p[o].p(Bo,Lo):(group_outros(),transition_out(p[Uo],1,1,()=>{p[Uo]=null}),check_outros(),s=p[o],s?s.p(Bo,Lo):(s=p[o]=d[o](Bo),s.c()),transition_in(s,1),s.m(c.parentNode,c))},i(Bo){h||(transition_in(s),h=!0)},o(Bo){transition_out(s),h=!1},d(Bo){p[o].d(Bo),Bo&&detach(c)}}}let showMissingLocalitiesButtonText="show";function instance$r(l,o,s){const c=createEventDispatcher();let{file:h}=o,{requiredFields:d}=o,p,Co=!1,Bo=!1;async function Lo(){s(1,p=await validateCSVContent(h,d))}function Uo(){s(3,Bo=!Bo)}function Qo(){c("data-confirmed",p)}function Po(){c("data-confirm-cancelled")}const Mo=Go=>s(2,Co=!Co);return l.$$set=Go=>{"file"in Go&&s(7,h=Go.file),"requiredFields"in Go&&s(0,d=Go.requiredFields)},l.$$.update=()=>{l.$$.dirty&128&&Lo()},[d,p,Co,Bo,Uo,Qo,Po,h,Mo]}class ConfirmCSVData extends SvelteComponent{constructor(o){super(),init(this,o,instance$r,create_fragment$r,safe_not_equal,{file:7,requiredFields:0})}}const Circle_svelte_svelte_type_style_lang="";function create_fragment$q(l){let o;return{c(){o=element("div"),attr(o,"class","circle svelte-14upwad"),set_style(o,"--size",l[0]+l[2]),set_style(o,"--color",l[1]),set_style(o,"--duration",l[3])},m(s,c){insert(s,o,c)},p(s,[c]){c&5&&set_style(o,"--size",s[0]+s[2]),c&2&&set_style(o,"--color",s[1]),c&8&&set_style(o,"--duration",s[3])},i:noop$2,o:noop$2,d(s){s&&detach(o)}}}function instance$q(l,o,s){let{size:c=60}=o,{color:h="#FF3E00"}=o,{unit:d="px"}=o,{duration:p="0.75s"}=o;return l.$$set=Co=>{"size"in Co&&s(0,c=Co.size),"color"in Co&&s(1,h=Co.color),"unit"in Co&&s(2,d=Co.unit),"duration"in Co&&s(3,p=Co.duration)},[c,h,d,p]}class Circle extends SvelteComponent{constructor(o){super(),init(this,o,instance$q,create_fragment$q,safe_not_equal,{size:0,color:1,unit:2,duration:3})}}const Circle2_svelte_svelte_type_style_lang="",Circle3_svelte_svelte_type_style_lang="",DoubleBounce_svelte_svelte_type_style_lang="",GoogleSpin_svelte_svelte_type_style_lang="",ScaleOut_svelte_svelte_type_style_lang="",SpinLine_svelte_svelte_type_style_lang="",Stretch_svelte_svelte_type_style_lang="",BarLoader_svelte_svelte_type_style_lang="",Jumper_svelte_svelte_type_style_lang="",RingLoader_svelte_svelte_type_style_lang="",SyncLoader_svelte_svelte_type_style_lang="",Rainbow_svelte_svelte_type_style_lang="",Wave_svelte_svelte_type_style_lang="",Firework_svelte_svelte_type_style_lang="",Pulse_svelte_svelte_type_style_lang="",Jellyfish_svelte_svelte_type_style_lang="",Chasing_svelte_svelte_type_style_lang="",Shadow_svelte_svelte_type_style_lang="",Square_svelte_svelte_type_style_lang="",Moon_svelte_svelte_type_style_lang="",Plane_svelte_svelte_type_style_lang="",Diamonds_svelte_svelte_type_style_lang="",profileSelect_svelte_svelte_type_style_lang="";function get_each_context$5(l,o,s){const c=l.slice();return c[11]=o[s],c}function create_if_block_2$7(l){let o,s,c;return s=new Circle({props:{size:"1",color:"#1d4a9c",unit:"em"}}),{c(){o=element("div"),create_component(s.$$.fragment),attr(o,"class","loader svelte-rav4xn")},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function create_else_block_1$6(l){let o,s,c=`${l[11].firstName} ${l[11].lastName} (${l[11].email})`,h,d,p;function Co(...Bo){return l[6](l[11],...Bo)}return{c(){o=element("div"),s=text("invite "),h=text(c),attr(o,"class","selectableitem svelte-rav4xn")},m(Bo,Lo){insert(Bo,o,Lo),append(o,s),append(o,h),d||(p=listen(o,"click",Co),d=!0)},p(Bo,Lo){l=Bo,Lo&4&&c!==(c=`${l[11].firstName} ${l[11].lastName} (${l[11].email})`)&&set_data(h,c)},d(Bo){Bo&&detach(o),d=!1,p()}}}function create_if_block$g(l){let o,s;function c(p,Co){return(o==null||Co&4)&&(o=!!p[11].includes("invite")),o?create_if_block_1$9:create_else_block$c}let h=c(l,-1),d=h(l);return{c(){d.c(),s=empty$1()},m(p,Co){d.m(p,Co),insert(p,s,Co)},p(p,Co){h===(h=c(p,Co))&&d?d.p(p,Co):(d.d(1),d=h(p),d&&(d.c(),d.m(s.parentNode,s)))},d(p){d.d(p),p&&detach(s)}}}function create_else_block$c(l){let o,s,c=l[11]+"",h;return{c(){o=element("div"),s=text("invite "),h=text(c),attr(o,"class","selectableitem svelte-rav4xn")},m(d,p){insert(d,o,p),append(o,s),append(o,h)},p(d,p){p&4&&c!==(c=d[11]+"")&&set_data(h,c)},d(d){d&&detach(o)}}}function create_if_block_1$9(l){let o,s=l[11]+"",c,h,d;function p(...Co){return l[5](l[11],...Co)}return{c(){o=element("div"),c=text(s),attr(o,"class","selectableitem svelte-rav4xn")},m(Co,Bo){insert(Co,o,Bo),append(o,c),h||(d=listen(o,"click",p),h=!0)},p(Co,Bo){l=Co,Bo&4&&s!==(s=l[11]+"")&&set_data(c,s)},d(Co){Co&&detach(o),h=!1,d()}}}function create_each_block$5(l){let o,s;function c(p,Co){return typeof p[11]=="string"?create_if_block$g:create_else_block_1$6}let h=c(l),d=h(l);return{c(){d.c(),o=space(),s=element("hr"),attr(s,"class","svelte-rav4xn")},m(p,Co){d.m(p,Co),insert(p,o,Co),insert(p,s,Co)},p(p,Co){h===(h=c(p))&&d?d.p(p,Co):(d.d(1),d=h(p),d&&(d.c(),d.m(o.parentNode,o)))},d(p){d.d(p),p&&detach(o),p&&detach(s)}}}function create_fragment$p(l){let o,s,c,h,d,p,Co,Bo,Lo=l[1]&&create_if_block_2$7(),Uo=l[2],Qo=[];for(let Po=0;Po<Uo.length;Po+=1)Qo[Po]=create_each_block$5(get_each_context$5(l,Uo,Po));return{c(){o=element("div"),s=element("input"),c=space(),Lo&&Lo.c(),h=space(),d=element("div");for(let Po=0;Po<Qo.length;Po+=1)Qo[Po].c();set_style(s,"width","400px"),attr(s,"placeholder","Type a name or email address"),attr(d,"class","optionscontainer svelte-rav4xn"),attr(o,"class","dropcontainer svelte-rav4xn")},m(Po,Mo){insert(Po,o,Mo),append(o,s),set_input_value(s,l[0]),append(o,c),Lo&&Lo.m(o,null),append(o,h),append(o,d);for(let Go=0;Go<Qo.length;Go+=1)Qo[Go].m(d,null);p=!0,Co||(Bo=listen(s,"input",l[4]),Co=!0)},p(Po,[Mo]){if(Mo&1&&s.value!==Po[0]&&set_input_value(s,Po[0]),Po[1]?Lo?Mo&2&&transition_in(Lo,1):(Lo=create_if_block_2$7(),Lo.c(),transition_in(Lo,1),Lo.m(o,h)):Lo&&(group_outros(),transition_out(Lo,1,1,()=>{Lo=null}),check_outros()),Mo&12){Uo=Po[2];let Go;for(Go=0;Go<Uo.length;Go+=1){const $o=get_each_context$5(Po,Uo,Go);Qo[Go]?Qo[Go].p($o,Mo):(Qo[Go]=create_each_block$5($o),Qo[Go].c(),Qo[Go].m(d,null))}for(;Go<Qo.length;Go+=1)Qo[Go].d(1);Qo.length=Uo.length}},i(Po){p||(transition_in(Lo),p=!0)},o(Po){transition_out(Lo),p=!1},d(Po){Po&&detach(o),Lo&&Lo.d(),destroy_each(Qo,Po),Co=!1,Bo()}}}function makeSingle(l){let o;return async function(...s){const c=o=new Object,h=l(...s);let d;for(;;){const p=h.next(d);if(p.done)return p.value;if(d=await p.value,c!==o)return}}}function instance$p(l,o,s){const c=createEventDispatcher();let h=!1,d,p,Co=[];function*Bo(Go){s(1,h=!0);let $o=yield fetch(`https://us-central1-georef-745b9.cloudfunctions.net/findprofile?search=${Go}`);if($o.ok){let jo=yield $o.json();jo.length?s(2,Co=jo):/\S+@\S+\.\S+/.test(Go)?s(2,Co=["invite "+Go]):s(2,Co=["couldn't find "+Go])}else s(2,Co=["there was a problem"]);s(1,h=!1)}Bo=makeSingle(Bo);const Lo=Go=>{Go&&Go.trim()&&Go.length>3?(clearTimeout(p),p=setTimeout(Bo,500,Go)):s(2,Co=[])},Uo=Go=>{s(2,Co=[]),s(0,d=""),c("profile-selected",Go)};function Qo(){d=this.value,s(0,d)}const Po=(Go,$o)=>Uo(Go),Mo=(Go,$o)=>Uo(Go);return l.$$.update=()=>{l.$$.dirty&1&&Lo(d)},[d,h,Co,Uo,Qo,Po,Mo]}class ProfileSelect extends SvelteComponent{constructor(o){super(),init(this,o,instance$p,create_fragment$p,safe_not_equal,{})}}const datasetTeam_svelte_svelte_type_style_lang="";function get_each_context$4(l,o,s){const c=l.slice();return c[13]=o[s],c}function create_if_block$f(l){let o,s=l[1],c=[];for(let h=0;h<s.length;h+=1)c[h]=create_each_block$4(get_each_context$4(l,s,h));return{c(){for(let h=0;h<c.length;h+=1)c[h].c();o=empty$1()},m(h,d){for(let p=0;p<c.length;p+=1)c[p].m(h,d);insert(h,o,d)},p(h,d){if(d&127){s=h[1];let p;for(p=0;p<s.length;p+=1){const Co=get_each_context$4(h,s,p);c[p]?c[p].p(Co,d):(c[p]=create_each_block$4(Co),c[p].c(),c[p].m(o.parentNode,o))}for(;p<c.length;p+=1)c[p].d(1);c.length=s.length}},d(h){destroy_each(c,h),h&&detach(o)}}}function create_else_block_3$1(l){let o,s=l[13]+"",c,h,d,p,Co;function Bo(...Lo){return l[11](l[13],...Lo)}return{c(){o=element("span"),c=text(s),h=space(),d=element("span"),d.textContent="clear",set_style(o,"padding-right","5px"),attr(d,"class","material-icons icon-input-icon svelte-z1a3gu"),attr(d,"title","remove")},m(Lo,Uo){insert(Lo,o,Uo),append(o,c),insert(Lo,h,Uo),insert(Lo,d,Uo),p||(Co=listen(d,"click",Bo),p=!0)},p(Lo,Uo){l=Lo,Uo&2&&s!==(s=l[13]+"")&&set_data(c,s)},d(Lo){Lo&&detach(o),Lo&&detach(h),Lo&&detach(d),p=!1,Co()}}}function create_if_block_1$8(l){let o,s=l[2][l[13]].formattedName+"",c,h,d;function p(Lo,Uo){return Lo[3]?create_if_block_2$6:Lo[4]?create_if_block_5$3:create_else_block_2$4}let Co=p(l),Bo=Co(l);return{c(){o=element("div"),c=text(s),h=space(),Bo.c(),d=empty$1(),set_style(o,"padding-right","5px")},m(Lo,Uo){insert(Lo,o,Uo),append(o,c),insert(Lo,h,Uo),Bo.m(Lo,Uo),insert(Lo,d,Uo)},p(Lo,Uo){Uo&6&&s!==(s=Lo[2][Lo[13]].formattedName+"")&&set_data(c,s),Co===(Co=p(Lo))&&Bo?Bo.p(Lo,Uo):(Bo.d(1),Bo=Co(Lo),Bo&&(Bo.c(),Bo.m(d.parentNode,d)))},d(Lo){Lo&&detach(o),Lo&&detach(h),Bo.d(Lo),Lo&&detach(d)}}}function create_else_block_2$4(l){let o,s,c;function h(...d){return l[10](l[13],...d)}return{c(){o=element("span"),o.textContent="mail_outline",attr(o,"class","material-icons icon-input-icon svelte-z1a3gu"),attr(o,"title","re-invite")},m(d,p){insert(d,o,p),s||(c=listen(o,"click",h),s=!0)},p(d,p){l=d},d(d){d&&detach(o),s=!1,c()}}}function create_if_block_5$3(l){let o,s,c;function h(...d){return l[9](l[13],...d)}return{c(){o=element("span"),o.textContent="clear",attr(o,"class","material-icons icon-input-icon svelte-z1a3gu"),attr(o,"title","remove")},m(d,p){insert(d,o,p),s||(c=listen(o,"click",h),s=!0)},p(d,p){l=d},d(d){d&&detach(o),s=!1,c()}}}function create_if_block_2$6(l){let o;function s(d,p){return d[0]!=d[13]?create_if_block_3$5:create_else_block_1$5}let c=s(l),h=c(l);return{c(){h.c(),o=empty$1()},m(d,p){h.m(d,p),insert(d,o,p)},p(d,p){c===(c=s(d))&&h?h.p(d,p):(h.d(1),h=c(d),h&&(h.c(),h.m(o.parentNode,o)))},d(d){h.d(d),d&&detach(o)}}}function create_else_block_1$5(l){let o;return{c(){o=element("span"),o.textContent="OWNER",attr(o,"class","owner-icon svelte-z1a3gu")},m(s,c){insert(s,o,c)},p:noop$2,d(s){s&&detach(o)}}}function create_if_block_3$5(l){let o,s,c,h,d;function p(Uo,Qo){return(o==null||Qo&34)&&(o=!!(Uo[5]&&Uo[5].includes(Uo[13]))),o?create_if_block_4$4:create_else_block$b}let Co=p(l,-1),Bo=Co(l);function Lo(...Uo){return l[8](l[13],...Uo)}return{c(){Bo.c(),s=space(),c=element("span"),c.textContent="clear",attr(c,"class","material-icons icon-input-icon svelte-z1a3gu"),attr(c,"title","remove")},m(Uo,Qo){Bo.m(Uo,Qo),insert(Uo,s,Qo),insert(Uo,c,Qo),h||(d=listen(c,"click",Lo),h=!0)},p(Uo,Qo){l=Uo,Co===(Co=p(l,Qo))&&Bo?Bo.p(l,Qo):(Bo.d(1),Bo=Co(l),Bo&&(Bo.c(),Bo.m(s.parentNode,s)))},d(Uo){Bo.d(Uo),Uo&&detach(s),Uo&&detach(c),h=!1,d()}}}function create_else_block$b(l){let o,s,c;function h(...d){return l[7](l[13],...d)}return{c(){o=element("span"),o.textContent="person_add_alt",attr(o,"class","material-icons icon-input-icon svelte-z1a3gu"),attr(o,"title","make admin")},m(d,p){insert(d,o,p),s||(c=listen(o,"click",h),s=!0)},p(d,p){l=d},d(d){d&&detach(o),s=!1,c()}}}function create_if_block_4$4(l){let o;return{c(){o=element("span"),o.textContent="person",attr(o,"class","material-icons"),attr(o,"title","is admin")},m(s,c){insert(s,o,c)},p:noop$2,d(s){s&&detach(o)}}}function create_each_block$4(l){let o,s;function c(p,Co){return p[2][p[13]]?create_if_block_1$8:create_else_block_3$1}let h=c(l),d=h(l);return{c(){o=element("div"),d.c(),s=space(),attr(o,"class","inviteecontainer svelte-z1a3gu")},m(p,Co){insert(p,o,Co),d.m(o,null),append(o,s)},p(p,Co){h===(h=c(p))&&d?d.p(p,Co):(d.d(1),d=h(p),d&&(d.c(),d.m(o,s)))},d(p){p&&detach(o),d.d()}}}function create_fragment$o(l){let o,s=l[2]&&create_if_block$f(l);return{c(){o=element("div"),s&&s.c(),attr(o,"class","inviteelist svelte-z1a3gu")},m(c,h){insert(c,o,h),s&&s.m(o,null)},p(c,[h]){c[2]?s?s.p(c,h):(s=create_if_block$f(c),s.c(),s.m(o,null)):s&&(s.d(1),s=null)},i:noop$2,o:noop$2,d(c){c&&detach(o),s&&s.d()}}}function instance$o(l,o,s){const c=createEventDispatcher();let{datasetCreatedByID:h=null}=o,{ids:d}=o,{profilesIndex:p}=o,{georef:Co=!1}=o,{invitees:Bo=!1}=o,{admins:Lo=[]}=o;const Uo=($o,jo)=>c("make-admin",{uid:$o,firstName:p[$o].firstName}),Qo=($o,jo)=>c("remove-user",{uid:$o,firstName:p[$o].firstName,list:"georeferencers"}),Po=($o,jo)=>c("remove-user",{uid:$o,firstName:p[$o].firstName,list:"invitees"}),Mo=($o,jo)=>c("reinvite",$o),Go=($o,jo)=>c("remove-new",$o);return l.$$set=$o=>{"datasetCreatedByID"in $o&&s(0,h=$o.datasetCreatedByID),"ids"in $o&&s(1,d=$o.ids),"profilesIndex"in $o&&s(2,p=$o.profilesIndex),"georef"in $o&&s(3,Co=$o.georef),"invitees"in $o&&s(4,Bo=$o.invitees),"admins"in $o&&s(5,Lo=$o.admins)},[h,d,p,Co,Bo,Lo,c,Uo,Qo,Po,Mo,Go]}class DatasetTeam extends SvelteComponent{constructor(o){super(),init(this,o,instance$o,create_fragment$o,safe_not_equal,{datasetCreatedByID:0,ids:1,profilesIndex:2,georef:3,invitees:4,admins:5})}}const validateCountries=(l,o,s)=>{console.log("datasetcountries is",l),console.log("region countries is",s),s=s.split(",").filter(Co=>Co).map(Co=>Co.trim()).filter(Co=>Co),l=l.filter(onlyUnique);let c=[],h=[],d=new Set,p;for(let Co of l)p=findMatchingCountries(Co,o),p.length?p.length>1?c.push({country:Co,ambiguous:!0}):h.push({country:Co,countryCode:p[0].alpha3Code}):c.push({country:Co,ambiguous:!1});for(let Co of s)p=findMatchingCountries(Co,o),p.length?p.length>1?alert("there is a problem with the list of region countries:",Co,"is ambiguous! Any records for this country will be removed from the dataset"):d.add(p[0].alpha3Code):alert("there is a problem with the list of region countries:",Co,"could not be verified! Any records for this country will be removed from the dataset");for(let Co of h)d.has(Co.countryCode)||c.push({country:Co.country,ambiguous:!1});return c},getCountries=async()=>{let l=await fetch("https://restcountries.com/v2/all");if(l.status==200){let o=await l.json(),s=/\(.*\)/gi,c,h;for(let d of o)s.test(d.name)?(c=d.name.match(s)[0],c.includes("Republic")||c.includes("State")?(d.name=d.name.replace(c,"").trim(),c=c.replace(/[\(\)]/g,"").trim(),h=[c,d.name].join(" "),d.altSpellings.includes(h)||d.altSpellings.push(h),c=null,h=null):(d.name.startsWith("Falkland Islands")&&(d.altSpellings.includes("Falkland Islands")||d.altSpellings.push("Falkland Islands")),d.name.startsWith("Saint Martin")&&(d.name="Saint Martin"),d.name.startsWith("Sint Maarten")&&(d.name="Sint Maarten"))):d.name.startsWith("Palestine")?d.name="Palestine":d.name.startsWith("Republic of Kosovo")?(d.name="Kosovo",d.altSpellings.includes("Republic of Kosovo")||d.altSpellings.push("Republic of Kosovo")):d.name=="Russian Federation"?d.name="Russia":d.name.startsWith("Syrian Arab")?d.name="Syria":d.name.startsWith("Tanzania")?d.name="Tanzania":d.name.includes("Great Britain")?["Great Britain","Britain","England","Wales","Scotland","Northern Ireland"].forEach(p=>{d.altSpellings.includes(p)||d.altSpellings.push(p)}):d.name=="Viet Nam"&&(d.altSpellings.includes("Vietnam")||d.altSpellings.push("Vietnam"));return o}else throw new Error("unable to fetch countries:",l.statusText)},findMatchingCountries=(l,o)=>{let s=o.filter(c=>c.name==l||c.nativeName==l);return s.length==0&&(s=o.filter(c=>!!(c.altSpellings&&c.altSpellings.length>0&&c.altSpellings.includes(l)||c.translations&&Object.values(c.translations).includes(l)||c.nativeName&&c.nativeName==l))),s},onlyUnique=(l,o,s)=>s.indexOf(l)===o,registerDataset_svelte_svelte_type_style_lang="";function create_if_block$e(l){let o,s,c,h=l[6].map(func$1).join(";")+"",d;return{c(){o=element("p"),s=text(`The following countries in the dataset are not valid for this region and the records will be removed:\r
    `),c=element("span"),d=text(h)},m(p,Co){insert(p,o,Co),append(o,s),append(o,c),append(c,d)},p(p,Co){Co[0]&64&&h!==(h=p[6].map(func$1).join(";")+"")&&set_data(d,h)},d(p){p&&detach(o)}}}function create_fragment$n(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,Hs,ds,hs,ys,ms,Rs,bs,ps,ks,xs,Ss,Us,Ps,Qs,Js,qs,Gs,Zs,Es,fs,vs,Bs;function Ls(Ws){l[26](Ws)}let Fs={items:l[7]};l[4]!==void 0&&(Fs.value=l[4]),Yo=new Select({props:Fs}),binding_callbacks.push(()=>bind(Yo,"value",Ls));function zs(Ws){l[27](Ws)}let js={items:l[12]};l[5]!==void 0&&(js.value=l[5]),gs=new Select({props:js}),binding_callbacks.push(()=>bind(gs,"value",zs));let ma=l[6].length&&create_if_block$e(l);return ms=new ProfileSelect({}),ms.$on("profile-selected",l[13]),ks=new DatasetTeam({props:{profilesIndex:l[9],ids:l[10],invitees:!0}}),ks.$on("remove-new",l[15]),ks.$on("remove-user",l[14]),{c(){o=element("h2"),o.textContent="Please add the details for this dataset",s=space(),c=element("p"),c.textContent="Note that only you and administrators will be able to see the dataset",h=space(),d=element("form"),p=element("label"),p.textContent="Contact Name",Co=space(),Bo=element("input"),Lo=space(),Uo=element("label"),Uo.textContent="Your registered email address",Qo=space(),Po=element("input"),Mo=space(),Go=element("label"),Go.textContent="Collection Code",$o=space(),jo=element("input"),zo=space(),Xo=element("label"),Xo.textContent="Dataset name",Zo=space(),Wo=element("input"),es=space(),is=element("label"),is.textContent="Target region",Jo=space(),Ko=element("div"),create_component(Yo.$$.fragment),ss=space(),cs=element("label"),cs.textContent="Domain",as=space(),us=element("div"),create_component(gs.$$.fragment),_s=space(),ma&&ma.c(),Hs=space(),ds=element("label"),ds.textContent="Invite georeferencers",hs=space(),ys=element("div"),create_component(ms.$$.fragment),Rs=space(),bs=element("label"),bs.textContent="Invited",ps=space(),create_component(ks.$$.fragment),xs=space(),Ss=element("label"),Ss.textContent="Remarks",Us=space(),Ps=element("textarea"),Qs=space(),Js=element("br"),qs=space(),Gs=element("button"),Zs=text("Submit"),attr(o,"class","svelte-1ax7ck6"),attr(p,"for","contactName"),attr(p,"class","svelte-1ax7ck6"),attr(Bo,"id","contactName"),attr(Bo,"type","text"),attr(Uo,"for","email"),attr(Uo,"class","svelte-1ax7ck6"),attr(Po,"id","email"),attr(Po,"type","text"),attr(Go,"for","collcode"),attr(Go,"class","svelte-1ax7ck6"),attr(jo,"id","collcode"),attr(jo,"type","text"),attr(jo,"placeholder","NU, BOL, NMSA, etc"),attr(Xo,"for","datasetname"),attr(Xo,"class","svelte-1ax7ck6"),attr(Wo,"id","datasetname"),attr(Wo,"type","text"),attr(Wo,"placeholder","e.g. NMSA crabs 2019"),attr(is,"for","region"),attr(is,"class","svelte-1ax7ck6"),set_style(Ko,"margin-bottom","0.5em"),attr(cs,"for","domain"),attr(cs,"class","svelte-1ax7ck6"),set_style(us,"margin-bottom","0.5em"),attr(ds,"for","invite"),attr(ds,"class","svelte-1ax7ck6"),attr(bs,"for","invited"),attr(bs,"class","svelte-1ax7ck6"),attr(Ss,"for","remarks"),attr(Ss,"class","svelte-1ax7ck6"),attr(Ps,"id","remarks"),attr(d,"class","content svelte-1ax7ck6"),Gs.disabled=Es=!l[11],attr(Gs,"class","svelte-1ax7ck6")},m(Ws,va){insert(Ws,o,va),insert(Ws,s,va),insert(Ws,c,va),insert(Ws,h,va),insert(Ws,d,va),append(d,p),append(d,Co),append(d,Bo),set_input_value(Bo,l[0]),append(d,Lo),append(d,Uo),append(d,Qo),append(d,Po),set_input_value(Po,l[1]),append(d,Mo),append(d,Go),append(d,$o),append(d,jo),set_input_value(jo,l[3]),append(d,zo),append(d,Xo),append(d,Zo),append(d,Wo),set_input_value(Wo,l[2]),append(d,es),append(d,is),append(d,Jo),append(d,Ko),mount_component(Yo,Ko,null),append(d,ss),append(d,cs),append(d,as),append(d,us),mount_component(gs,us,null),append(d,_s),ma&&ma.m(d,null),append(d,Hs),append(d,ds),append(d,hs),append(d,ys),mount_component(ms,ys,null),append(d,Rs),append(d,bs),append(d,ps),mount_component(ks,d,null),append(d,xs),append(d,Ss),append(d,Us),append(d,Ps),set_input_value(Ps,l[8]),insert(Ws,Qs,va),insert(Ws,Js,va),insert(Ws,qs,va),insert(Ws,Gs,va),append(Gs,Zs),fs=!0,vs||(Bs=[listen(Bo,"input",l[22]),listen(Po,"input",l[23]),listen(jo,"input",l[24]),listen(Wo,"input",l[25]),listen(Ps,"input",l[28]),listen(Gs,"click",l[16])],vs=!0)},p(Ws,va){va[0]&1&&Bo.value!==Ws[0]&&set_input_value(Bo,Ws[0]),va[0]&2&&Po.value!==Ws[1]&&set_input_value(Po,Ws[1]),va[0]&8&&jo.value!==Ws[3]&&set_input_value(jo,Ws[3]),va[0]&4&&Wo.value!==Ws[2]&&set_input_value(Wo,Ws[2]);const ca={};va[0]&128&&(ca.items=Ws[7]),!ts&&va[0]&16&&(ts=!0,ca.value=Ws[4],add_flush_callback(()=>ts=!1)),Yo.$set(ca);const cl={};!Is&&va[0]&32&&(Is=!0,cl.value=Ws[5],add_flush_callback(()=>Is=!1)),gs.$set(cl),Ws[6].length?ma?ma.p(Ws,va):(ma=create_if_block$e(Ws),ma.c(),ma.m(d,Hs)):ma&&(ma.d(1),ma=null);const Ms={};va[0]&512&&(Ms.profilesIndex=Ws[9]),va[0]&1024&&(Ms.ids=Ws[10]),ks.$set(Ms),va[0]&256&&set_input_value(Ps,Ws[8]),(!fs||va[0]&2048&&Es!==(Es=!Ws[11]))&&(Gs.disabled=Es)},i(Ws){fs||(transition_in(Yo.$$.fragment,Ws),transition_in(gs.$$.fragment,Ws),transition_in(ms.$$.fragment,Ws),transition_in(ks.$$.fragment,Ws),fs=!0)},o(Ws){transition_out(Yo.$$.fragment,Ws),transition_out(gs.$$.fragment,Ws),transition_out(ms.$$.fragment,Ws),transition_out(ks.$$.fragment,Ws),fs=!1},d(Ws){Ws&&detach(o),Ws&&detach(s),Ws&&detach(c),Ws&&detach(h),Ws&&detach(d),destroy_component(Yo),destroy_component(gs),ma&&ma.d(),destroy_component(ms),destroy_component(ks),Ws&&detach(Qs),Ws&&detach(Js),Ws&&detach(qs),Ws&&detach(Gs),vs=!1,run_all(Bs)}}}const func$1=l=>l.ambiguous?`${l.country} (ambiguous)`:l.country;function instance$n(l,o,s){let c;const h=createEventDispatcher();let{hasStateProvince:d}=o,{userProfile:p}=o,{datasetCountries:Co}=o;const Bo=[{value:"TER",label:"terrestrial"},{value:"FW",label:"freshwater"},{value:"MAR",label:"marine"}];let Lo,Uo=[],Qo,Po=[],Mo=p.firstName+" "+p.lastName,Go=p.email,$o,jo,zo,Xo,Zo=null,Wo=nanoid(),es={},is=[],Jo=[],Ko=[];onMount(async ms=>{console.log("fetch georef regions");let Rs=await Realtime.ref("settings/georefRegions").once("value");s(20,Lo=Rs.val()),console.log("georef regions fetched"),s(21,Qo=await getCountries())});const Yo=ms=>{s(0,Mo=p.firstName+" "+p.lastName),s(1,Go=p.email)},ts=ms=>{if(Lo&&Object.keys(Lo).length){let Rs=[];for(let bs of Object.keys(Lo))Rs.push({value:bs,label:bs});s(7,Po=Rs)}else s(7,Po=[])},ss=ms=>{let Rs=ms.detail;if(typeof Rs=="string"&&Rs.trim()&&Rs.includes("invite")){let bs=Rs.replace("invite","").trim();Jo.includes(bs)||(Jo.push(bs),Jo=Jo)}else is.includes(Rs.uid)||(s(9,es[Rs.uid]=Rs,es),is.push(Rs.uid),is=is);s(9,es),s(10,Ko=[...is,...Jo])},cs=ms=>{let Rs=ms.detail;if(confirm("Are you certain you want to remove",Rs.firstName,"from the invitees?")){let ps=is.indexOf(ks=>ks.uid==Rs.uid);is.splice(ps,1),is=is,s(10,Ko=[...is,...Jo])}},as=ms=>{let Rs=ms.detail,bs=Jo.indexOf(ps=>ps==Rs);Jo.splice(bs,1),Jo=Jo,s(10,Ko=[...is,...Jo])},us=ms=>{h("register-dataset",{datasetDetails:{datasetID:Wo,contactName:Mo,email:Go,createdByID:p.uid,datasetName:$o,collectionCode:jo,region:zo.value,domain:Xo.value,hasStateProvince:d,georeferencers:[p.uid],invitees:is,newInvitees:Jo,declinedInvitees:[],remarks:Zo},invalidCountries:Uo.map(Rs=>Rs.country.toLowerCase())})};function gs(){Mo=this.value,s(0,Mo)}function Is(){Go=this.value,s(1,Go)}function _s(){jo=this.value,s(3,jo)}function Hs(){$o=this.value,s(2,$o)}function ds(ms){zo=ms,s(4,zo)}function hs(ms){Xo=ms,s(5,Xo)}function ys(){Zo=this.value,s(8,Zo)}return l.$$set=ms=>{"hasStateProvince"in ms&&s(17,d=ms.hasStateProvince),"userProfile"in ms&&s(18,p=ms.userProfile),"datasetCountries"in ms&&s(19,Co=ms.datasetCountries)},l.$$.update=()=>{l.$$.dirty[0]&262144&&Yo(),l.$$.dirty[0]&1048576&&ts(),l.$$.dirty[0]&63&&s(11,c=Mo&&Go&&$o&&jo&&zo&&Xo),l.$$.dirty[0]&3670064&&(zo&&Xo&&Lo&&Qo?s(6,Uo=validateCountries(Co,Qo,Lo[zo.value])):s(6,Uo=[]))},[Mo,Go,$o,jo,zo,Xo,Uo,Po,Zo,es,Ko,c,Bo,ss,cs,as,us,d,p,Co,Lo,Qo,gs,Is,_s,Hs,ds,hs,ys]}class RegisterDataset extends SvelteComponent{constructor(o){super(),init(this,o,instance$n,create_fragment$n,safe_not_equal,{hasStateProvince:17,userProfile:18,datasetCountries:19},null,[-1,-1])}}const arrayUnion=(...l)=>[...new Set(l.flat())],groupLocalities=async(l,o,s,c)=>{if(l&&typeof l=="object"&&Object.keys(l).length>0){let h="https://us-central1-georefmaps.cloudfunctions.net/grouplocalities ",d;try{d=await fetch(h,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({localityCollector:Object.keys(l)})})}catch(p){throw p}if(d.status==200){let p=await d.json(),Co=[];for(let Bo of Object.keys(p)){let Lo=p[Bo],Uo=[],Qo=0;for(let Mo of Lo){let Go=l[Mo];Go&&(Qo+=Go.length),Uo.push({loc:Mo,recordIDs:Go}),Mo=Go=null}let Po={datasetID:o,groupID:nanoid(),country:s,stateProvince:c,groupKey:Bo,groupLocked:!1,groupLocalities:Uo,groupRecordCount:Qo,completed:!1};Po.groupLocalities.length>1,Co.push(Po)}return Co}else if(d.status==400){let p=await d.text();if(p=="It only makes sense to group large numbers of localities"){console.log(`${s}${c?":"+c:""} has ${Object.keys(l).length} records and will be processed client side`);let Co=[],Bo=0;for(let Uo of Object.keys(l))Co.push({loc:Uo,recordIDs:l[Uo]}),Bo+=l[Uo].length;return[{datasetID:o,groupID:nanoid(),groupKey:"All localities",country:s,stateProvince:c,groupLocked:!1,groupLocalities:Co,groupRecordCount:Bo,completed:!1}]}else throw new Error("call to textpack failed with message: "+p)}else throw new Error("call to textpack failed with status: "+d.status)}else throw new Error("invalid data provided")},packAndLoad_svelte_svelte_type_style_lang="";function create_else_block$a(l){let o,s,c,h,d,p,Co,Bo;return h=new Loader$1({}),{c(){o=element("h2"),o.textContent="Processing localities, this may take a few minutes...",s=space(),c=element("div"),create_component(h.$$.fragment),d=space(),p=element("div"),Co=text(l[0]),attr(o,"class","svelte-1bxfhxo"),set_style(c,"height","300px"),set_style(p,"text-align","center")},m(Lo,Uo){insert(Lo,o,Uo),insert(Lo,s,Uo),insert(Lo,c,Uo),mount_component(h,c,null),insert(Lo,d,Uo),insert(Lo,p,Uo),append(p,Co),Bo=!0},p(Lo,Uo){(!Bo||Uo&1)&&set_data(Co,Lo[0])},i(Lo){Bo||(transition_in(h.$$.fragment,Lo),Bo=!0)},o(Lo){transition_out(h.$$.fragment,Lo),Bo=!1},d(Lo){Lo&&detach(o),Lo&&detach(s),Lo&&detach(c),destroy_component(h),Lo&&detach(d),Lo&&detach(p)}}}function create_if_block$d(l){let o,s,c;return{c(){o=element("h2"),o.textContent="There was a problem with the upload:",s=space(),c=element("p"),c.textContent=`${uploadErrorMessage}`,attr(o,"class","svelte-1bxfhxo")},m(h,d){insert(h,o,d),insert(h,s,d),insert(h,c,d)},p:noop$2,i:noop$2,o:noop$2,d(h){h&&detach(o),h&&detach(s),h&&detach(c)}}}function create_fragment$m(l){let o,s,c,h;const d=[create_if_block$d,create_else_block$a],p=[];function Co(Bo,Lo){return 1}return s=Co(),c=p[s]=d[s](l),{c(){o=element("div"),c.c()},m(Bo,Lo){insert(Bo,o,Lo),p[s].m(o,null),h=!0},p(Bo,[Lo]){c.p(Bo,Lo)},i(Bo){h||(transition_in(c),h=!0)},o(Bo){transition_out(c),h=!1},d(Bo){Bo&&detach(o),p[s].d()}}}let uploadErrorMessage="";function instance$m(l,o,s){const c=createEventDispatcher();let{fileForGeoref:h}=o,{localityRecordIDMap:d}=o,{invalidCountries:p}=o,{dataset:Co}=o,{userID:Bo}=o,Lo,Uo={},Qo="";const Po=async()=>{if(d){s(0,Qo="grouping localities, this may take a few minutes...");let $o=[];for(let[jo,zo]of Object.entries(d))if(!p.includes(jo.toLowerCase()))if(Co.hasStateProvince){if(Uo[jo]=Object.keys(zo),Uo[jo].includes("none")&&Uo[jo].length>1){const Xo=Uo[jo].indexOf("none");Uo[jo].splice(Xo,1),Uo[jo].unshift("none")}Uo[jo].length>1&&Uo[jo].unshift("all");for(let[Xo,Zo]of Object.entries(zo))$o.push(groupLocalities(Zo,Co.datasetID,jo,Xo))}else Uo[jo]=!0,$o.push(groupLocalities(zo,Co.datasetID,jo,null));try{let jo=await Promise.all($o),zo=arrayUnion(...jo);s(6,Lo=zo)}catch(jo){console.error(jo.message),c("error-with-textpack",jo)}}},Mo=async($o,jo)=>{let zo=Firestore.collection("userDatasets").doc($o);(await zo.get()).exists?await zo.update({[jo]:FieldValue.arrayUnion(Co.datasetID)}):await zo.set({[jo]:[Co.datasetID]})},Go=async()=>{let $o=null;try{$o=await getSafeTime()}catch(jo){c("componenterror",jo);return}if(Lo){let jo=Lo.reduce((Ko,Yo)=>Ko+Yo.groupRecordCount,0);s(0,Qo="prepping for data upload"),s(1,Co.datasetURL="",Co),s(1,Co.recordCount=jo,Co),s(1,Co.recordsCompleted=0,Co),s(1,Co.groupCount=Lo.length,Co),s(1,Co.groupsComplete=0,Co),s(1,Co.dateCreated=$o,Co),s(1,Co.lastGeoreference="",Co),s(1,Co.completed=!1,Co),s(1,Co.dateCompleted=null,Co),s(1,Co.countryProvs=Uo,Co),s(0,Qo="saving dataset file");try{let Ko=await Storage.ref().child(`${Co.datasetID}.csv`).put(h);s(1,Co.url=await Ko.ref.getDownloadURL(),Co)}catch(Ko){alert("error saving dataset file:",Ko.message);return}s(0,Qo="saving locality groups");let zo=[],Xo=Firestore.batch(),Zo=499,Wo=0;for(;Wo<Lo.length;){let Ko=Firestore.collection("recordGroups").doc();Xo.set(Ko,Lo[Wo]),(Wo==Zo||Wo==Lo.length-1)&&(zo.push(Xo.commit()),Xo=Firestore.batch(),Zo+=500),Wo++}try{await Promise.all(zo)}catch(Ko){console.error(Ko),alert("error saving locality groups:",Ko.message);return}s(0,Qo="updating user datasets");try{await Mo(Bo,"current")}catch(Ko){alert("error adding userDataset for creator:",Ko.message);return}let es=Co.newInvitees.map(Ko=>Ko.replace(/[@\.\s]+/g,"").toLowerCase()),is=[...Co.invitees,...es];console.log("allIDs:",is);let Jo=[];for(let Ko of is)Jo.push(Mo(Ko,"invited"));try{await Promise.all(Jo)}catch(Ko){console.error(Ko),alert("error adding userDatasets",Ko.message);return}s(0,Qo="saving dataset record");try{await Firestore.collection("datasets").doc(Co.datasetID).set(Co)}catch(Ko){console.error(Ko),alert("error creating database:",Ko.message);return}c("upload-complete")}};return l.$$set=$o=>{"fileForGeoref"in $o&&s(2,h=$o.fileForGeoref),"localityRecordIDMap"in $o&&s(3,d=$o.localityRecordIDMap),"invalidCountries"in $o&&s(4,p=$o.invalidCountries),"dataset"in $o&&s(1,Co=$o.dataset),"userID"in $o&&s(5,Bo=$o.userID)},l.$$.update=()=>{l.$$.dirty&8&&Po(),l.$$.dirty&64&&Go()},[Qo,Co,h,d,p,Bo,Lo]}class PackAndLoad extends SvelteComponent{constructor(o){super(),init(this,o,instance$m,create_fragment$m,safe_not_equal,{fileForGeoref:2,localityRecordIDMap:3,invalidCountries:4,dataset:1,userID:5})}}const welldone_svelte_svelte_type_style_lang="";function create_fragment$l(l){let o,s,c,h,d,p,Co,Bo,Lo;return{c(){o=element("h2"),o.textContent="Congratulations, your dataset has been uploaded for georeferencing!",s=space(),c=element("p"),h=text("You can "),d=element("span"),d.textContent="proceed to your list of datasets",p=text(" and their progress or "),Co=element("span"),Co.textContent="start georeferencing",attr(o,"class","svelte-oywgrp"),attr(d,"class","clickable-text svelte-oywgrp"),attr(Co,"class","clickable-text svelte-oywgrp")},m(Uo,Qo){insert(Uo,o,Qo),insert(Uo,s,Qo),insert(Uo,c,Qo),append(c,h),append(c,d),append(c,p),append(c,Co),Bo||(Lo=[listen(d,"click",l[0]),listen(Co,"click",l[1])],Bo=!0)},p:noop$2,i:noop$2,o:noop$2,d(Uo){Uo&&detach(o),Uo&&detach(s),Uo&&detach(c),Bo=!1,run_all(Lo)}}}function instance$l(l){const o=createEventDispatcher();return[h=>{o("to-datasets")},h=>{o("start-georeferencing")}]}class Welldone extends SvelteComponent{constructor(o){super(),init(this,o,instance$l,create_fragment$l,safe_not_equal,{})}}const datasetsList_svelte_svelte_type_style_lang="";function get_each_context$3(l,o,s){const c=l.slice();return c[22]=o[s],c[24]=s,c}function create_else_block_2$3(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block$c(l){let o,s,c,h,d,p,Co,Bo,Lo;function Uo(Mo,Go){return Mo[2].length?create_if_block_1$7:create_else_block_1$4}let Qo=Uo(l),Po=Qo(l);return{c(){Po.c(),o=space(),s=element("div"),c=element("button"),c.textContent="Start over",h=space(),d=element("button"),p=text("Show next"),attr(c,"class","svelte-yc8f7j"),d.disabled=Co=!l[2]||!l[2].length,attr(d,"class","svelte-yc8f7j")},m(Mo,Go){Po.m(Mo,Go),insert(Mo,o,Go),insert(Mo,s,Go),append(s,c),append(s,h),append(s,d),append(d,p),Bo||(Lo=[listen(c,"click",l[3]),listen(d,"click",l[6])],Bo=!0)},p(Mo,Go){Qo===(Qo=Uo(Mo))&&Po?Po.p(Mo,Go):(Po.d(1),Po=Qo(Mo),Po&&(Po.c(),Po.m(o.parentNode,o))),Go&4&&Co!==(Co=!Mo[2]||!Mo[2].length)&&(d.disabled=Co)},i:noop$2,o:noop$2,d(Mo){Po.d(Mo),Mo&&detach(o),Mo&&detach(s),Bo=!1,run_all(Lo)}}}function create_else_block_1$4(l){let o;return{c(){o=element("div"),o.textContent="No datasets to show",attr(o,"class","nodatasets svelte-yc8f7j")},m(s,c){insert(s,o,c)},p:noop$2,d(s){s&&detach(o)}}}function create_if_block_1$7(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs=!l[0]&&create_if_block_3$4(),as=l[2],us=[];for(let gs=0;gs<as.length;gs+=1)us[gs]=create_each_block$3(get_each_context$3(l,as,gs));return{c(){o=element("table"),s=element("tr"),c=element("th"),c.textContent="Dataset",h=space(),d=element("th"),d.textContent="Collection",p=space(),Co=element("th"),Co.textContent="Region",Bo=space(),Lo=element("th"),Lo.textContent="Domain",Uo=space(),Qo=element("th"),Qo.textContent="Created",Po=space(),Mo=element("th"),Mo.textContent="Completed",Go=space(),$o=element("th"),$o.textContent="Total Records",jo=space(),zo=element("th"),zo.textContent="Locality Groups",Xo=space(),Zo=element("th"),Zo.textContent="Records Complete",Wo=space(),es=element("th"),es.textContent="Groups Complete",is=space(),Jo=element("th"),Jo.textContent="Last Georef",Ko=space(),cs&&cs.c(),Yo=space(),ts=element("th"),ts.textContent="Remove",ss=space();for(let gs=0;gs<us.length;gs+=1)us[gs].c();attr(c,"class","svelte-yc8f7j"),attr(d,"class","svelte-yc8f7j"),attr(Co,"class","svelte-yc8f7j"),attr(Lo,"class","svelte-yc8f7j"),attr(Qo,"class","svelte-yc8f7j"),attr(Mo,"class","svelte-yc8f7j"),attr($o,"class","svelte-yc8f7j"),attr(zo,"class","svelte-yc8f7j"),attr(Zo,"class","svelte-yc8f7j"),attr(es,"class","svelte-yc8f7j"),attr(Jo,"class","svelte-yc8f7j"),attr(ts,"class","svelte-yc8f7j")},m(gs,Is){insert(gs,o,Is),append(o,s),append(s,c),append(s,h),append(s,d),append(s,p),append(s,Co),append(s,Bo),append(s,Lo),append(s,Uo),append(s,Qo),append(s,Po),append(s,Mo),append(s,Go),append(s,$o),append(s,jo),append(s,zo),append(s,Xo),append(s,Zo),append(s,Wo),append(s,es),append(s,is),append(s,Jo),append(s,Ko),cs&&cs.m(s,null),append(s,Yo),append(s,ts),append(o,ss);for(let _s=0;_s<us.length;_s+=1)us[_s].m(o,null)},p(gs,Is){if(gs[0]?cs&&(cs.d(1),cs=null):cs||(cs=create_if_block_3$4(),cs.c(),cs.m(s,Yo)),Is&1973){as=gs[2];let _s;for(_s=0;_s<as.length;_s+=1){const Hs=get_each_context$3(gs,as,_s);us[_s]?us[_s].p(Hs,Is):(us[_s]=create_each_block$3(Hs),us[_s].c(),us[_s].m(o,null))}for(;_s<us.length;_s+=1)us[_s].d(1);us.length=as.length}},d(gs){gs&&detach(o),cs&&cs.d(),destroy_each(us,gs)}}}function create_if_block_3$4(l){let o;return{c(){o=element("th"),o.textContent="Accept",attr(o,"class","svelte-yc8f7j")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_else_block$9(l){let o,s,c,h;function d(...p){return l[16](l[22],...p)}return{c(){o=element("td"),s=element("button"),s.textContent="Remove",attr(s,"class","svelte-yc8f7j"),attr(o,"class","table-button svelte-yc8f7j")},m(p,Co){insert(p,o,Co),append(o,s),c||(h=listen(s,"click",stop_propagation(d)),c=!0)},p(p,Co){l=p},d(p){p&&detach(o),c=!1,h()}}}function create_if_block_2$5(l){let o,s,c,h,d,p,Co;function Bo(...Uo){return l[14](l[22],...Uo)}function Lo(...Uo){return l[15](l[22],...Uo)}return{c(){o=element("td"),s=element("button"),s.textContent="Accept",c=space(),h=element("td"),d=element("button"),d.textContent="Decline",attr(s,"class","svelte-yc8f7j"),attr(o,"class","table-button svelte-yc8f7j"),attr(d,"class","svelte-yc8f7j"),attr(h,"class","table-button svelte-yc8f7j")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),insert(Uo,c,Qo),insert(Uo,h,Qo),append(h,d),p||(Co=[listen(s,"click",stop_propagation(Bo)),listen(d,"click",stop_propagation(Lo))],p=!0)},p(Uo,Qo){l=Uo},d(Uo){Uo&&detach(o),Uo&&detach(c),Uo&&detach(h),p=!1,run_all(Co)}}}function create_each_block$3(l){let o,s,c=(l[22].datasetName||null)+"",h,d,p,Co=(l[22].collectionCode||null)+"",Bo,Lo,Uo,Qo=(l[22].region||null)+"",Po,Mo,Go,$o=(l[22].domain||null)+"",jo,zo,Xo,Zo=(l[22].dateCreated?l[4](l[22].dateCreated):"")+"",Wo,es,is,Jo=(l[22].completed?l[4](l[22].dateCompleted):"NA")+"",Ko,Yo,ts,ss=l[22].recordCount+"",cs,as,us,gs=l[22].groupCount+"",Is,_s,Hs,ds=l[22].recordsCompleted+"",hs,ys,ms=Math.round(l[22].recordsCompleted/l[22].recordCount*100)+"",Rs,bs,ps,ks,xs=l[22].groupsComplete+"",Ss,Us,Ps=Math.round(l[22].groupsComplete/l[22].groupCount*100)+"",Qs,Js,qs,Gs,Zs=(l[22].lastGeoreference?l[5](l[22].lastGeoreference):null)+"",Es,fs,vs,Bs,Ls;function Fs(ma,Ws){return ma[0]?create_else_block$9:create_if_block_2$5}let zs=Fs(l),js=zs(l);return{c(){o=element("tr"),s=element("td"),h=text(c),d=space(),p=element("td"),Bo=text(Co),Lo=space(),Uo=element("td"),Po=text(Qo),Mo=space(),Go=element("td"),jo=text($o),zo=space(),Xo=element("td"),Wo=text(Zo),es=space(),is=element("td"),Ko=text(Jo),Yo=space(),ts=element("td"),cs=text(ss),as=space(),us=element("td"),Is=text(gs),_s=space(),Hs=element("td"),hs=text(ds),ys=text(" ("),Rs=text(ms),bs=text("%)"),ps=space(),ks=element("td"),Ss=text(xs),Us=text(" ("),Qs=text(Ps),Js=text("%)"),qs=space(),Gs=element("td"),Es=text(Zs),fs=space(),js.c(),vs=space(),attr(o,"class","tr-hover svelte-yc8f7j"),toggle_class(o,"oddrow",l[24]%2)},m(ma,Ws){insert(ma,o,Ws),append(o,s),append(s,h),append(o,d),append(o,p),append(p,Bo),append(o,Lo),append(o,Uo),append(Uo,Po),append(o,Mo),append(o,Go),append(Go,jo),append(o,zo),append(o,Xo),append(Xo,Wo),append(o,es),append(o,is),append(is,Ko),append(o,Yo),append(o,ts),append(ts,cs),append(o,as),append(o,us),append(us,Is),append(o,_s),append(o,Hs),append(Hs,hs),append(Hs,ys),append(Hs,Rs),append(Hs,bs),append(o,ps),append(o,ks),append(ks,Ss),append(ks,Us),append(ks,Qs),append(ks,Js),append(o,qs),append(o,Gs),append(Gs,Es),append(o,fs),js.m(o,null),append(o,vs),Bs||(Ls=listen(o,"click",function(){is_function(l[10](l[22]))&&l[10](l[22]).apply(this,arguments)}),Bs=!0)},p(ma,Ws){l=ma,Ws&4&&c!==(c=(l[22].datasetName||null)+"")&&set_data(h,c),Ws&4&&Co!==(Co=(l[22].collectionCode||null)+"")&&set_data(Bo,Co),Ws&4&&Qo!==(Qo=(l[22].region||null)+"")&&set_data(Po,Qo),Ws&4&&$o!==($o=(l[22].domain||null)+"")&&set_data(jo,$o),Ws&4&&Zo!==(Zo=(l[22].dateCreated?l[4](l[22].dateCreated):"")+"")&&set_data(Wo,Zo),Ws&4&&Jo!==(Jo=(l[22].completed?l[4](l[22].dateCompleted):"NA")+"")&&set_data(Ko,Jo),Ws&4&&ss!==(ss=l[22].recordCount+"")&&set_data(cs,ss),Ws&4&&gs!==(gs=l[22].groupCount+"")&&set_data(Is,gs),Ws&4&&ds!==(ds=l[22].recordsCompleted+"")&&set_data(hs,ds),Ws&4&&ms!==(ms=Math.round(l[22].recordsCompleted/l[22].recordCount*100)+"")&&set_data(Rs,ms),Ws&4&&xs!==(xs=l[22].groupsComplete+"")&&set_data(Ss,xs),Ws&4&&Ps!==(Ps=Math.round(l[22].groupsComplete/l[22].groupCount*100)+"")&&set_data(Qs,Ps),Ws&4&&Zs!==(Zs=(l[22].lastGeoreference?l[5](l[22].lastGeoreference):null)+"")&&set_data(Es,Zs),zs===(zs=Fs(l))&&js?js.p(l,Ws):(js.d(1),js=zs(l),js&&(js.c(),js.m(o,vs)))},d(ma){ma&&detach(o),js.d(),Bs=!1,Ls()}}}function create_fragment$k(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po;const Mo=[create_if_block$c,create_else_block_2$3],Go=[];function $o(jo,zo){return jo[1]?0:1}return Bo=$o(l),Lo=Go[Bo]=Mo[Bo](l),{c(){o=element("div"),s=element("div"),c=element("div"),c.textContent="Current datasets",h=space(),d=element("div"),d.textContent="Invited datasets",p=space(),Co=element("div"),Lo.c(),attr(c,"class","tab svelte-yc8f7j"),toggle_class(c,"tab-selected",l[0]),attr(d,"class","tab svelte-yc8f7j"),toggle_class(d,"tab-selected",!l[0]),attr(s,"class","tabs svelte-yc8f7j"),attr(Co,"class","datasetslist-content svelte-yc8f7j"),attr(o,"class","datasetlist-container svelte-yc8f7j")},m(jo,zo){insert(jo,o,zo),append(o,s),append(s,c),append(s,h),append(s,d),append(o,p),append(o,Co),Go[Bo].m(Co,null),Uo=!0,Qo||(Po=[listen(c,"click",l[12]),listen(d,"click",l[13])],Qo=!0)},p(jo,[zo]){zo&1&&toggle_class(c,"tab-selected",jo[0]),zo&1&&toggle_class(d,"tab-selected",!jo[0]);let Xo=Bo;Bo=$o(jo),Bo===Xo?Go[Bo].p(jo,zo):(group_outros(),transition_out(Go[Xo],1,1,()=>{Go[Xo]=null}),check_outros(),Lo=Go[Bo],Lo?Lo.p(jo,zo):(Lo=Go[Bo]=Mo[Bo](jo),Lo.c()),transition_in(Lo,1),Lo.m(Co,null))},i(jo){Uo||(transition_in(Lo),Uo=!0)},o(jo){transition_out(Lo),Uo=!1},d(jo){jo&&detach(o),Go[Bo].d(),Qo=!1,run_all(Po)}}}let fetchSize=10;function instance$k(l,o,s){let{profile:c}=o,h=createEventDispatcher(),d=!0,p=!1,Co=null,Bo=[],Lo=[],Uo=0;onMount(async Yo=>{Firestore.collection("userDatasets").doc(c.uid).onSnapshot(ts=>{if(ts.exists){let ss=!1;Co||(ss=!0),Co=ts.data(),ss&&Qo()}})});const Qo=Yo=>{s(2,Lo=[]),Uo=0,Co&&(d?Bo=Co.current:Bo=Co.invited,$o())},Po=Yo=>{if(!Yo)return"";typeof Yo=="object"&&(Yo=Yo.seconds*1e3);let ts=new Date(Yo);return new Date(ts.getTime()-ts.getTimezoneOffset()*60*1e3).toISOString().split("T")[0]},Mo=Yo=>{if(!Yo)return"";typeof Yo=="object"&&(Yo=Yo.seconds*1e3);let ts=new Date(Yo),cs=new Date(ts.getTime()-ts.getTimezoneOffset()*60*1e3).toISOString().split(/[T\.]/g);return cs.pop(),cs.join(" ")},Go=async Yo=>{let ts;d?ts="georeferencers":ts="invitees";let ss=Firestore.collection("datasets").where(ts,"array-contains",c.uid).where("datasetID","in",Yo),cs;try{cs=await ss.get()}catch(as){throw new Error("error fetching datasets: "+as.message)}return cs.empty?[]:cs.docs.map(us=>us.data())},$o=async Yo=>{if(s(1,p=!1),Bo&&Bo.length){let ts=Bo.slice(Uo,Uo+fetchSize);if(ts.length)try{let ss=await Go(ts);ss.sort((cs,as)=>cs.dateCreated<as.dateCreated?1:-1),s(2,Lo=ss),Uo+=fetchSize}catch(ss){alert(ss.message);return}else s(2,Lo=[])}else s(2,Lo=[]);s(1,p=!0)},jo=async Yo=>{let ts=Firestore.collection("datasets").doc(Yo),ss=Firestore.collection("userDatasets").doc(c.uid);try{let cs=ts.update({invitees:FieldValue.arrayRemove(c.uid),georeferencers:FieldValue.arrayUnion(c.uid)}),as=ss.update({invited:FieldValue.arrayRemove(Yo),current:FieldValue.arrayUnion(Yo)});await Promise.all([cs,as]),Qo()}catch(cs){alert(cs.message);return}},zo=async Yo=>{if(confirm("Are you certain you want to remove this dataset from your list permanently?")){let ss=Firestore.collection("datasets").doc(Yo),cs=Firestore.collection("userDatasets").doc(c.uid),as={georeferencers:FieldValue.arrayRemove(c.uid)};(await Realtime.ref(`stats/perDataset/${Yo}/perUser/${c.uid}/recordsGeoreferenced`).once("value")).exists()?as.pastGeoreferencers=FieldValue.arrayUnion(c.uid):as.declinedInvitees=FieldValue.arrayUnion(c.uid);let Is=ss.update(as),_s=cs.update({current:FieldValue.arraryRemove(Yo)});try{await Promise.all([Is,_s])}catch(Hs){console.error(Hs),alert("error updating database:",Hs.message)}}},Xo=async Yo=>{if(confirm("Are you certain you want to decline this invitation to georeference this dataset?")){let ss=Firestore.collection("datasets").doc(Yo),cs=Firestore.collection("userDatasets").doc(c.uid),as=ss.update({invitees:FieldValue.arrayRemove(c.uid),declinedInvitees:FieldValue.arrayUnion(c.uid)}),us=cs.update({invited:FieldValue.arrayRemove(Yo)});try{await Promise.all([as,us])}catch(gs){console.error(gs),alert("error updating database:",gs.message)}}},Zo=Yo=>{d?h("dataset-selected",Yo):alert("please accept invitation to this dataset to start georeferencing")},Wo=Yo=>s(0,d=!0),es=Yo=>s(0,d=!1),is=(Yo,ts)=>jo(Yo.datasetID),Jo=(Yo,ts)=>Xo(Yo.datasetID),Ko=(Yo,ts)=>zo(Yo.datasetID);return l.$$set=Yo=>{"profile"in Yo&&s(11,c=Yo.profile)},l.$$.update=()=>{l.$$.dirty&1&&Qo()},[d,p,Lo,Qo,Po,Mo,$o,jo,zo,Xo,Zo,c,Wo,es,is,Jo,Ko]}class DatasetsList extends SvelteComponent{constructor(o){super(),init(this,o,instance$k,create_fragment$k,safe_not_equal,{profile:11})}}var src={compareTwoStrings,findBestMatch};function compareTwoStrings(l,o){if(l=l.replace(/\s+/g,""),o=o.replace(/\s+/g,""),l===o)return 1;if(l.length<2||o.length<2)return 0;let s=new Map;for(let h=0;h<l.length-1;h++){const d=l.substring(h,h+2),p=s.has(d)?s.get(d)+1:1;s.set(d,p)}let c=0;for(let h=0;h<o.length-1;h++){const d=o.substring(h,h+2),p=s.has(d)?s.get(d):0;p>0&&(s.set(d,p-1),c++)}return 2*c/(l.length+o.length-2)}function findBestMatch(l,o){if(!areArgsValid(l,o))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const s=[];let c=0;for(let d=0;d<o.length;d++){const p=o[d],Co=compareTwoStrings(l,p);s.push({target:p,rating:Co}),Co>s[c].rating&&(c=d)}const h=s[c];return{ratings:s,bestMatch:h,bestMatchIndex:c}}function areArgsValid(l,o){return!(typeof l!="string"||!Array.isArray(o)||!o.length||o.find(function(s){return typeof s!="string"}))}/*!
 * Chart.js v3.1.0
 * https://www.chartjs.org
 * (c) 2021 Chart.js Contributors
 * Released under the MIT License
 */const requestAnimFrame=function(){return typeof window>"u"?function(l){return l()}:window.requestAnimationFrame}();function throttled(l,o,s){const c=s||(p=>Array.prototype.slice.call(p));let h=!1,d=[];return function(...p){d=c(p),h||(h=!0,requestAnimFrame.call(window,()=>{h=!1,l.apply(o,d)}))}}function debounce(l,o){let s;return function(){return o?(clearTimeout(s),s=setTimeout(l,o)):l(),o}}const _toLeftRightCenter=l=>l==="start"?"left":l==="end"?"right":"center",_alignStartEnd=(l,o,s)=>l==="start"?o:l==="end"?s:(o+s)/2,_textX=(l,o,s)=>l==="right"?s:l==="center"?(o+s)/2:o;function noop(){}const uid=function(){let l=0;return function(){return l++}}();function isNullOrUndef(l){return l===null||typeof l>"u"}function isArray(l){if(Array.isArray&&Array.isArray(l))return!0;const o=Object.prototype.toString.call(l);return o.substr(0,7)==="[object"&&o.substr(-6)==="Array]"}function isObject(l){return l!==null&&Object.prototype.toString.call(l)==="[object Object]"}const isNumberFinite=l=>(typeof l=="number"||l instanceof Number)&&isFinite(+l);function finiteOrDefault(l,o){return isNumberFinite(l)?l:o}function valueOrDefault(l,o){return typeof l>"u"?o:l}const toPercentage=(l,o)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100:l/o,toDimension=(l,o)=>typeof l=="string"&&l.endsWith("%")?parseFloat(l)/100*o:+l;function callback(l,o,s){if(l&&typeof l.call=="function")return l.apply(s,o)}function each(l,o,s,c){let h,d,p;if(isArray(l))if(d=l.length,c)for(h=d-1;h>=0;h--)o.call(s,l[h],h);else for(h=0;h<d;h++)o.call(s,l[h],h);else if(isObject(l))for(p=Object.keys(l),d=p.length,h=0;h<d;h++)o.call(s,l[p[h]],p[h])}function _elementsEqual(l,o){let s,c,h,d;if(!l||!o||l.length!==o.length)return!1;for(s=0,c=l.length;s<c;++s)if(h=l[s],d=o[s],h.datasetIndex!==d.datasetIndex||h.index!==d.index)return!1;return!0}function clone$1(l){if(isArray(l))return l.map(clone$1);if(isObject(l)){const o=Object.create(null),s=Object.keys(l),c=s.length;let h=0;for(;h<c;++h)o[s[h]]=clone$1(l[s[h]]);return o}return l}function isValidKey(l){return["__proto__","prototype","constructor"].indexOf(l)===-1}function _merger(l,o,s,c){if(!isValidKey(l))return;const h=o[l],d=s[l];isObject(h)&&isObject(d)?merge(h,d,c):o[l]=clone$1(d)}function merge(l,o,s){const c=isArray(o)?o:[o],h=c.length;if(!isObject(l))return l;s=s||{};const d=s.merger||_merger;for(let p=0;p<h;++p){if(o=c[p],!isObject(o))continue;const Co=Object.keys(o);for(let Bo=0,Lo=Co.length;Bo<Lo;++Bo)d(Co[Bo],l,o,s)}return l}function mergeIf(l,o){return merge(l,o,{merger:_mergerIf})}function _mergerIf(l,o,s){if(!isValidKey(l))return;const c=o[l],h=s[l];isObject(c)&&isObject(h)?mergeIf(c,h):Object.prototype.hasOwnProperty.call(o,l)||(o[l]=clone$1(h))}const emptyString="",dot=".";function indexOfDotOrLength(l,o){const s=l.indexOf(dot,o);return s===-1?l.length:s}function resolveObjectKey(l,o){if(o===emptyString)return l;let s=0,c=indexOfDotOrLength(o,s);for(;l&&c>s;)l=l[o.substr(s,c-s)],s=c+1,c=indexOfDotOrLength(o,s);return l}function _capitalize(l){return l.charAt(0).toUpperCase()+l.slice(1)}const defined=l=>typeof l<"u",isFunction=l=>typeof l=="function",PI=Math.PI,TAU=2*PI,PITAU=TAU+PI,INFINITY=Number.POSITIVE_INFINITY,RAD_PER_DEG=PI/180,HALF_PI=PI/2,QUARTER_PI=PI/4,TWO_THIRDS_PI=PI*2/3,log10=Math.log10,sign=Math.sign;function niceNum(l){const o=Math.pow(10,Math.floor(log10(l))),s=l/o;return(s<=1?1:s<=2?2:s<=5?5:10)*o}function _factorize(l){const o=[],s=Math.sqrt(l);let c;for(c=1;c<s;c++)l%c===0&&(o.push(c),o.push(l/c));return s===(s|0)&&o.push(s),o.sort((h,d)=>h-d).pop(),o}function isNumber(l){return!isNaN(parseFloat(l))&&isFinite(l)}function almostEquals(l,o,s){return Math.abs(l-o)<s}function almostWhole(l,o){const s=Math.round(l);return s-o<=l&&s+o>=l}function _setMinAndMaxByKey(l,o,s){let c,h,d;for(c=0,h=l.length;c<h;c++)d=l[c][s],isNaN(d)||(o.min=Math.min(o.min,d),o.max=Math.max(o.max,d))}function toRadians(l){return l*(PI/180)}function toDegrees(l){return l*(180/PI)}function _decimalPlaces(l){if(!isNumberFinite(l))return;let o=1,s=0;for(;Math.round(l*o)/o!==l;)o*=10,s++;return s}function getAngleFromPoint(l,o){const s=o.x-l.x,c=o.y-l.y,h=Math.sqrt(s*s+c*c);let d=Math.atan2(c,s);return d<-.5*PI&&(d+=TAU),{angle:d,distance:h}}function distanceBetweenPoints(l,o){return Math.sqrt(Math.pow(o.x-l.x,2)+Math.pow(o.y-l.y,2))}function _angleDiff(l,o){return(l-o+PITAU)%TAU-PI}function _normalizeAngle(l){return(l%TAU+TAU)%TAU}function _angleBetween(l,o,s){const c=_normalizeAngle(l),h=_normalizeAngle(o),d=_normalizeAngle(s),p=_normalizeAngle(h-c),Co=_normalizeAngle(d-c),Bo=_normalizeAngle(c-h),Lo=_normalizeAngle(c-d);return c===h||c===d||p>Co&&Bo<Lo}function _limitValue(l,o,s){return Math.max(o,Math.min(s,l))}function _int16Range(l){return _limitValue(l,-32768,32767)}const atEdge=l=>l===0||l===1,elasticIn=(l,o,s)=>-(Math.pow(2,10*(l-=1))*Math.sin((l-o)*TAU/s)),elasticOut=(l,o,s)=>Math.pow(2,-10*l)*Math.sin((l-o)*TAU/s)+1,effects={linear:l=>l,easeInQuad:l=>l*l,easeOutQuad:l=>-l*(l-2),easeInOutQuad:l=>(l/=.5)<1?.5*l*l:-.5*(--l*(l-2)-1),easeInCubic:l=>l*l*l,easeOutCubic:l=>(l-=1)*l*l+1,easeInOutCubic:l=>(l/=.5)<1?.5*l*l*l:.5*((l-=2)*l*l+2),easeInQuart:l=>l*l*l*l,easeOutQuart:l=>-((l-=1)*l*l*l-1),easeInOutQuart:l=>(l/=.5)<1?.5*l*l*l*l:-.5*((l-=2)*l*l*l-2),easeInQuint:l=>l*l*l*l*l,easeOutQuint:l=>(l-=1)*l*l*l*l+1,easeInOutQuint:l=>(l/=.5)<1?.5*l*l*l*l*l:.5*((l-=2)*l*l*l*l+2),easeInSine:l=>-Math.cos(l*HALF_PI)+1,easeOutSine:l=>Math.sin(l*HALF_PI),easeInOutSine:l=>-.5*(Math.cos(PI*l)-1),easeInExpo:l=>l===0?0:Math.pow(2,10*(l-1)),easeOutExpo:l=>l===1?1:-Math.pow(2,-10*l)+1,easeInOutExpo:l=>atEdge(l)?l:l<.5?.5*Math.pow(2,10*(l*2-1)):.5*(-Math.pow(2,-10*(l*2-1))+2),easeInCirc:l=>l>=1?l:-(Math.sqrt(1-l*l)-1),easeOutCirc:l=>Math.sqrt(1-(l-=1)*l),easeInOutCirc:l=>(l/=.5)<1?-.5*(Math.sqrt(1-l*l)-1):.5*(Math.sqrt(1-(l-=2)*l)+1),easeInElastic:l=>atEdge(l)?l:elasticIn(l,.075,.3),easeOutElastic:l=>atEdge(l)?l:elasticOut(l,.075,.3),easeInOutElastic(l){return atEdge(l)?l:l<.5?.5*elasticIn(l*2,.1125,.45):.5+.5*elasticOut(l*2-1,.1125,.45)},easeInBack(l){return l*l*((1.70158+1)*l-1.70158)},easeOutBack(l){return(l-=1)*l*((1.70158+1)*l+1.70158)+1},easeInOutBack(l){let o=1.70158;return(l/=.5)<1?.5*(l*l*(((o*=1.525)+1)*l-o)):.5*((l-=2)*l*(((o*=1.525)+1)*l+o)+2)},easeInBounce:l=>1-effects.easeOutBounce(1-l),easeOutBounce(l){return l<1/2.75?7.5625*l*l:l<2/2.75?7.5625*(l-=1.5/2.75)*l+.75:l<2.5/2.75?7.5625*(l-=2.25/2.75)*l+.9375:7.5625*(l-=2.625/2.75)*l+.984375},easeInOutBounce:l=>l<.5?effects.easeInBounce(l*2)*.5:effects.easeOutBounce(l*2-1)*.5+.5};/*!
 * @kurkle/color v0.1.9
 * https://github.com/kurkle/color#readme
 * (c) 2020 Jukka Kurkela
 * Released under the MIT License
 */const map={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hex="0123456789ABCDEF",h1=l=>hex[l&15],h2=l=>hex[(l&240)>>4]+hex[l&15],eq=l=>(l&240)>>4===(l&15);function isShort(l){return eq(l.r)&&eq(l.g)&&eq(l.b)&&eq(l.a)}function hexParse(l){var o=l.length,s;return l[0]==="#"&&(o===4||o===5?s={r:255&map[l[1]]*17,g:255&map[l[2]]*17,b:255&map[l[3]]*17,a:o===5?map[l[4]]*17:255}:(o===7||o===9)&&(s={r:map[l[1]]<<4|map[l[2]],g:map[l[3]]<<4|map[l[4]],b:map[l[5]]<<4|map[l[6]],a:o===9?map[l[7]]<<4|map[l[8]]:255})),s}function hexString(l){var o=isShort(l)?h1:h2;return l&&"#"+o(l.r)+o(l.g)+o(l.b)+(l.a<255?o(l.a):"")}function round(l){return l+.5|0}const lim=(l,o,s)=>Math.max(Math.min(l,s),o);function p2b(l){return lim(round(l*2.55),0,255)}function n2b(l){return lim(round(l*255),0,255)}function b2n(l){return lim(round(l/2.55)/100,0,1)}function n2p(l){return lim(round(l*100),0,100)}const RGB_RE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function rgbParse(l){const o=RGB_RE.exec(l);let s=255,c,h,d;if(!!o){if(o[7]!==c){const p=+o[7];s=255&(o[8]?p2b(p):p*255)}return c=+o[1],h=+o[3],d=+o[5],c=255&(o[2]?p2b(c):c),h=255&(o[4]?p2b(h):h),d=255&(o[6]?p2b(d):d),{r:c,g:h,b:d,a:s}}}function rgbString(l){return l&&(l.a<255?`rgba(${l.r}, ${l.g}, ${l.b}, ${b2n(l.a)})`:`rgb(${l.r}, ${l.g}, ${l.b})`)}const HUE_RE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function hsl2rgbn(l,o,s){const c=o*Math.min(s,1-s),h=(d,p=(d+l/30)%12)=>s-c*Math.max(Math.min(p-3,9-p,1),-1);return[h(0),h(8),h(4)]}function hsv2rgbn(l,o,s){const c=(h,d=(h+l/60)%6)=>s-s*o*Math.max(Math.min(d,4-d,1),0);return[c(5),c(3),c(1)]}function hwb2rgbn(l,o,s){const c=hsl2rgbn(l,1,.5);let h;for(o+s>1&&(h=1/(o+s),o*=h,s*=h),h=0;h<3;h++)c[h]*=1-o-s,c[h]+=o;return c}function rgb2hsl(l){const s=l.r/255,c=l.g/255,h=l.b/255,d=Math.max(s,c,h),p=Math.min(s,c,h),Co=(d+p)/2;let Bo,Lo,Uo;return d!==p&&(Uo=d-p,Lo=Co>.5?Uo/(2-d-p):Uo/(d+p),Bo=d===s?(c-h)/Uo+(c<h?6:0):d===c?(h-s)/Uo+2:(s-c)/Uo+4,Bo=Bo*60+.5),[Bo|0,Lo||0,Co]}function calln(l,o,s,c){return(Array.isArray(o)?l(o[0],o[1],o[2]):l(o,s,c)).map(n2b)}function hsl2rgb(l,o,s){return calln(hsl2rgbn,l,o,s)}function hwb2rgb(l,o,s){return calln(hwb2rgbn,l,o,s)}function hsv2rgb(l,o,s){return calln(hsv2rgbn,l,o,s)}function hue(l){return(l%360+360)%360}function hueParse(l){const o=HUE_RE.exec(l);let s=255,c;if(!o)return;o[5]!==c&&(s=o[6]?p2b(+o[5]):n2b(+o[5]));const h=hue(+o[2]),d=+o[3]/100,p=+o[4]/100;return o[1]==="hwb"?c=hwb2rgb(h,d,p):o[1]==="hsv"?c=hsv2rgb(h,d,p):c=hsl2rgb(h,d,p),{r:c[0],g:c[1],b:c[2],a:s}}function rotate(l,o){var s=rgb2hsl(l);s[0]=hue(s[0]+o),s=hsl2rgb(s),l.r=s[0],l.g=s[1],l.b=s[2]}function hslString(l){if(!l)return;const o=rgb2hsl(l),s=o[0],c=n2p(o[1]),h=n2p(o[2]);return l.a<255?`hsla(${s}, ${c}%, ${h}%, ${b2n(l.a)})`:`hsl(${s}, ${c}%, ${h}%)`}const map$1={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},names={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function unpack(){const l={},o=Object.keys(names),s=Object.keys(map$1);let c,h,d,p,Co;for(c=0;c<o.length;c++){for(p=Co=o[c],h=0;h<s.length;h++)d=s[h],Co=Co.replace(d,map$1[d]);d=parseInt(names[p],16),l[Co]=[d>>16&255,d>>8&255,d&255]}return l}let names$1;function nameParse(l){names$1||(names$1=unpack(),names$1.transparent=[0,0,0,0]);const o=names$1[l.toLowerCase()];return o&&{r:o[0],g:o[1],b:o[2],a:o.length===4?o[3]:255}}function modHSL(l,o,s){if(l){let c=rgb2hsl(l);c[o]=Math.max(0,Math.min(c[o]+c[o]*s,o===0?360:1)),c=hsl2rgb(c),l.r=c[0],l.g=c[1],l.b=c[2]}}function clone(l,o){return l&&Object.assign(o||{},l)}function fromObject(l){var o={r:0,g:0,b:0,a:255};return Array.isArray(l)?l.length>=3&&(o={r:l[0],g:l[1],b:l[2],a:255},l.length>3&&(o.a=n2b(l[3]))):(o=clone(l,{r:0,g:0,b:0,a:1}),o.a=n2b(o.a)),o}function functionParse(l){return l.charAt(0)==="r"?rgbParse(l):hueParse(l)}class Color{constructor(o){if(o instanceof Color)return o;const s=typeof o;let c;s==="object"?c=fromObject(o):s==="string"&&(c=hexParse(o)||nameParse(o)||functionParse(o)),this._rgb=c,this._valid=!!c}get valid(){return this._valid}get rgb(){var o=clone(this._rgb);return o&&(o.a=b2n(o.a)),o}set rgb(o){this._rgb=fromObject(o)}rgbString(){return this._valid?rgbString(this._rgb):this._rgb}hexString(){return this._valid?hexString(this._rgb):this._rgb}hslString(){return this._valid?hslString(this._rgb):this._rgb}mix(o,s){const c=this;if(o){const h=c.rgb,d=o.rgb;let p;const Co=s===p?.5:s,Bo=2*Co-1,Lo=h.a-d.a,Uo=((Bo*Lo===-1?Bo:(Bo+Lo)/(1+Bo*Lo))+1)/2;p=1-Uo,h.r=255&Uo*h.r+p*d.r+.5,h.g=255&Uo*h.g+p*d.g+.5,h.b=255&Uo*h.b+p*d.b+.5,h.a=Co*h.a+(1-Co)*d.a,c.rgb=h}return c}clone(){return new Color(this.rgb)}alpha(o){return this._rgb.a=n2b(o),this}clearer(o){const s=this._rgb;return s.a*=1-o,this}greyscale(){const o=this._rgb,s=round(o.r*.3+o.g*.59+o.b*.11);return o.r=o.g=o.b=s,this}opaquer(o){const s=this._rgb;return s.a*=1+o,this}negate(){const o=this._rgb;return o.r=255-o.r,o.g=255-o.g,o.b=255-o.b,this}lighten(o){return modHSL(this._rgb,2,o),this}darken(o){return modHSL(this._rgb,2,-o),this}saturate(o){return modHSL(this._rgb,1,o),this}desaturate(o){return modHSL(this._rgb,1,-o),this}rotate(o){return rotate(this._rgb,o),this}}function index_esm(l){return new Color(l)}const isPatternOrGradient=l=>l instanceof CanvasGradient||l instanceof CanvasPattern;function color$2(l){return isPatternOrGradient(l)?l:index_esm(l)}function getHoverColor(l){return isPatternOrGradient(l)?l:index_esm(l).saturate(.5).darken(.1).hexString()}const overrides=Object.create(null),descriptors=Object.create(null);function getScope$1(l,o){if(!o)return l;const s=o.split(".");for(let c=0,h=s.length;c<h;++c){const d=s[c];l=l[d]||(l[d]=Object.create(null))}return l}function set(l,o,s){return typeof o=="string"?merge(getScope$1(l,o),s):merge(getScope$1(l,""),o)}class Defaults{constructor(o){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,c)=>getHoverColor(c.backgroundColor),this.hoverBorderColor=(s,c)=>getHoverColor(c.borderColor),this.hoverColor=(s,c)=>getHoverColor(c.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.describe(o)}set(o,s){return set(this,o,s)}get(o){return getScope$1(this,o)}describe(o,s){return set(descriptors,o,s)}override(o,s){return set(overrides,o,s)}route(o,s,c,h){const d=getScope$1(this,o),p=getScope$1(this,c),Co="_"+s;Object.defineProperties(d,{[Co]:{value:d[s],writable:!0},[s]:{enumerable:!0,get(){const Bo=this[Co],Lo=p[h];return isObject(Bo)?Object.assign({},Lo,Bo):valueOrDefault(Bo,Lo)},set(Bo){this[Co]=Bo}}})}}var defaults=new Defaults({_scriptable:l=>!l.startsWith("on"),_indexable:l=>l!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function toFontString(l){return!l||isNullOrUndef(l.size)||isNullOrUndef(l.family)?null:(l.style?l.style+" ":"")+(l.weight?l.weight+" ":"")+l.size+"px "+l.family}function _measureText(l,o,s,c,h){let d=o[h];return d||(d=o[h]=l.measureText(h).width,s.push(h)),d>c&&(c=d),c}function _longestText(l,o,s,c){c=c||{};let h=c.data=c.data||{},d=c.garbageCollect=c.garbageCollect||[];c.font!==o&&(h=c.data={},d=c.garbageCollect=[],c.font=o),l.save(),l.font=o;let p=0;const Co=s.length;let Bo,Lo,Uo,Qo,Po;for(Bo=0;Bo<Co;Bo++)if(Qo=s[Bo],Qo!=null&&isArray(Qo)!==!0)p=_measureText(l,h,d,p,Qo);else if(isArray(Qo))for(Lo=0,Uo=Qo.length;Lo<Uo;Lo++)Po=Qo[Lo],Po!=null&&!isArray(Po)&&(p=_measureText(l,h,d,p,Po));l.restore();const Mo=d.length/2;if(Mo>s.length){for(Bo=0;Bo<Mo;Bo++)delete h[d[Bo]];d.splice(0,Mo)}return p}function _alignPixel(l,o,s){const c=l.currentDevicePixelRatio,h=s!==0?Math.max(s/2,.5):0;return Math.round((o-h)*c)/c+h}function clearCanvas(l,o){o=o||l.getContext("2d"),o.save(),o.resetTransform(),o.clearRect(0,0,l.width,l.height),o.restore()}function drawPoint(l,o,s,c){let h,d,p,Co,Bo;const Lo=o.pointStyle,Uo=o.rotation,Qo=o.radius;let Po=(Uo||0)*RAD_PER_DEG;if(Lo&&typeof Lo=="object"&&(h=Lo.toString(),h==="[object HTMLImageElement]"||h==="[object HTMLCanvasElement]")){l.save(),l.translate(s,c),l.rotate(Po),l.drawImage(Lo,-Lo.width/2,-Lo.height/2,Lo.width,Lo.height),l.restore();return}if(!(isNaN(Qo)||Qo<=0)){switch(l.beginPath(),Lo){default:l.arc(s,c,Qo,0,TAU),l.closePath();break;case"triangle":l.moveTo(s+Math.sin(Po)*Qo,c-Math.cos(Po)*Qo),Po+=TWO_THIRDS_PI,l.lineTo(s+Math.sin(Po)*Qo,c-Math.cos(Po)*Qo),Po+=TWO_THIRDS_PI,l.lineTo(s+Math.sin(Po)*Qo,c-Math.cos(Po)*Qo),l.closePath();break;case"rectRounded":Bo=Qo*.516,Co=Qo-Bo,d=Math.cos(Po+QUARTER_PI)*Co,p=Math.sin(Po+QUARTER_PI)*Co,l.arc(s-d,c-p,Bo,Po-PI,Po-HALF_PI),l.arc(s+p,c-d,Bo,Po-HALF_PI,Po),l.arc(s+d,c+p,Bo,Po,Po+HALF_PI),l.arc(s-p,c+d,Bo,Po+HALF_PI,Po+PI),l.closePath();break;case"rect":if(!Uo){Co=Math.SQRT1_2*Qo,l.rect(s-Co,c-Co,2*Co,2*Co);break}Po+=QUARTER_PI;case"rectRot":d=Math.cos(Po)*Qo,p=Math.sin(Po)*Qo,l.moveTo(s-d,c-p),l.lineTo(s+p,c-d),l.lineTo(s+d,c+p),l.lineTo(s-p,c+d),l.closePath();break;case"crossRot":Po+=QUARTER_PI;case"cross":d=Math.cos(Po)*Qo,p=Math.sin(Po)*Qo,l.moveTo(s-d,c-p),l.lineTo(s+d,c+p),l.moveTo(s+p,c-d),l.lineTo(s-p,c+d);break;case"star":d=Math.cos(Po)*Qo,p=Math.sin(Po)*Qo,l.moveTo(s-d,c-p),l.lineTo(s+d,c+p),l.moveTo(s+p,c-d),l.lineTo(s-p,c+d),Po+=QUARTER_PI,d=Math.cos(Po)*Qo,p=Math.sin(Po)*Qo,l.moveTo(s-d,c-p),l.lineTo(s+d,c+p),l.moveTo(s+p,c-d),l.lineTo(s-p,c+d);break;case"line":d=Math.cos(Po)*Qo,p=Math.sin(Po)*Qo,l.moveTo(s-d,c-p),l.lineTo(s+d,c+p);break;case"dash":l.moveTo(s,c),l.lineTo(s+Math.cos(Po)*Qo,c+Math.sin(Po)*Qo);break}l.fill(),o.borderWidth>0&&l.stroke()}}function _isPointInArea(l,o,s){return s=s||.5,l&&l.x>o.left-s&&l.x<o.right+s&&l.y>o.top-s&&l.y<o.bottom+s}function clipArea(l,o){l.save(),l.beginPath(),l.rect(o.left,o.top,o.right-o.left,o.bottom-o.top),l.clip()}function unclipArea(l){l.restore()}function _steppedLineTo(l,o,s,c,h){if(!o)return l.lineTo(s.x,s.y);if(h==="middle"){const d=(o.x+s.x)/2;l.lineTo(d,o.y),l.lineTo(d,s.y)}else h==="after"!=!!c?l.lineTo(o.x,s.y):l.lineTo(s.x,o.y);l.lineTo(s.x,s.y)}function _bezierCurveTo(l,o,s,c){if(!o)return l.lineTo(s.x,s.y);l.bezierCurveTo(c?o.cp1x:o.cp2x,c?o.cp1y:o.cp2y,c?s.cp2x:s.cp1x,c?s.cp2y:s.cp1y,s.x,s.y)}function renderText(l,o,s,c,h,d={}){const p=isArray(o)?o:[o],Co=d.strokeWidth>0&&d.strokeColor!=="";let Bo,Lo;for(l.save(),d.translation&&l.translate(d.translation[0],d.translation[1]),isNullOrUndef(d.rotation)||l.rotate(d.rotation),l.font=h.string,d.color&&(l.fillStyle=d.color),d.textAlign&&(l.textAlign=d.textAlign),d.textBaseline&&(l.textBaseline=d.textBaseline),Bo=0;Bo<p.length;++Bo){if(Lo=p[Bo],Co&&(d.strokeColor&&(l.strokeStyle=d.strokeColor),isNullOrUndef(d.strokeWidth)||(l.lineWidth=d.strokeWidth),l.strokeText(Lo,s,c,d.maxWidth)),l.fillText(Lo,s,c,d.maxWidth),d.strikethrough||d.underline){const Uo=l.measureText(Lo),Qo=s-Uo.actualBoundingBoxLeft,Po=s+Uo.actualBoundingBoxRight,Mo=c-Uo.actualBoundingBoxAscent,Go=c+Uo.actualBoundingBoxDescent,$o=d.strikethrough?(Mo+Go)/2:Go;l.strokeStyle=l.fillStyle,l.beginPath(),l.lineWidth=d.decorationWidth||2,l.moveTo(Qo,$o),l.lineTo(Po,$o),l.stroke()}c+=h.lineHeight}l.restore()}function addRoundedRectPath(l,o){const{x:s,y:c,w:h,h:d,radius:p}=o;l.arc(s+p.topLeft,c+p.topLeft,p.topLeft,-HALF_PI,PI,!0),l.lineTo(s,c+d-p.bottomLeft),l.arc(s+p.bottomLeft,c+d-p.bottomLeft,p.bottomLeft,PI,HALF_PI,!0),l.lineTo(s+h-p.bottomRight,c+d),l.arc(s+h-p.bottomRight,c+d-p.bottomRight,p.bottomRight,HALF_PI,0,!0),l.lineTo(s+h,c+p.topRight),l.arc(s+h-p.topRight,c+p.topRight,p.topRight,0,-HALF_PI,!0),l.lineTo(s+p.topLeft,c)}const LINE_HEIGHT=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),FONT_STYLE$1=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function toLineHeight(l,o){const s=(""+l).match(LINE_HEIGHT);if(!s||s[1]==="normal")return o*1.2;switch(l=+s[2],s[3]){case"px":return l;case"%":l/=100;break}return o*l}const numberOrZero$1=l=>+l||0;function _readValueToProps(l,o){const s={},c=isObject(o),h=c?Object.keys(o):o,d=isObject(l)?c?p=>valueOrDefault(l[p],l[o[p]]):p=>l[p]:()=>l;for(const p of h)s[p]=numberOrZero$1(d(p));return s}function toTRBL(l){return _readValueToProps(l,{top:"y",right:"x",bottom:"y",left:"x"})}function toTRBLCorners(l){return _readValueToProps(l,["topLeft","topRight","bottomLeft","bottomRight"])}function toPadding(l){const o=toTRBL(l);return o.width=o.left+o.right,o.height=o.top+o.bottom,o}function toFont(l,o){l=l||{},o=o||defaults.font;let s=valueOrDefault(l.size,o.size);typeof s=="string"&&(s=parseInt(s,10));let c=valueOrDefault(l.style,o.style);c&&!(""+c).match(FONT_STYLE$1)&&(console.warn('Invalid font style specified: "'+c+'"'),c="");const h={family:valueOrDefault(l.family,o.family),lineHeight:toLineHeight(valueOrDefault(l.lineHeight,o.lineHeight),s),size:s,style:c,weight:valueOrDefault(l.weight,o.weight),string:""};return h.string=toFontString(h),h}function resolve(l,o,s,c){let h=!0,d,p,Co;for(d=0,p=l.length;d<p;++d)if(Co=l[d],Co!==void 0&&(o!==void 0&&typeof Co=="function"&&(Co=Co(o),h=!1),s!==void 0&&isArray(Co)&&(Co=Co[s%Co.length],h=!1),Co!==void 0))return c&&!h&&(c.cacheable=!1),Co}function _addGrace(l,o){const{min:s,max:c}=l;return{min:s-Math.abs(toDimension(o,s)),max:c+toDimension(o,c)}}function _lookup(l,o,s){s=s||(p=>l[p]<o);let c=l.length-1,h=0,d;for(;c-h>1;)d=h+c>>1,s(d)?h=d:c=d;return{lo:h,hi:c}}const _lookupByKey=(l,o,s)=>_lookup(l,s,c=>l[c][o]<s),_rlookupByKey=(l,o,s)=>_lookup(l,s,c=>l[c][o]>=s);function _filterBetween(l,o,s){let c=0,h=l.length;for(;c<h&&l[c]<o;)c++;for(;h>c&&l[h-1]>s;)h--;return c>0||h<l.length?l.slice(c,h):l}const arrayEvents=["push","pop","shift","splice","unshift"];function listenArrayEvents(l,o){if(l._chartjs){l._chartjs.listeners.push(o);return}Object.defineProperty(l,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[o]}}),arrayEvents.forEach(s=>{const c="_onData"+_capitalize(s),h=l[s];Object.defineProperty(l,s,{configurable:!0,enumerable:!1,value(...d){const p=h.apply(this,d);return l._chartjs.listeners.forEach(Co=>{typeof Co[c]=="function"&&Co[c](...d)}),p}})})}function unlistenArrayEvents(l,o){const s=l._chartjs;if(!s)return;const c=s.listeners,h=c.indexOf(o);h!==-1&&c.splice(h,1),!(c.length>0)&&(arrayEvents.forEach(d=>{delete l[d]}),delete l._chartjs)}function _arrayUnique(l){const o=new Set;let s,c;for(s=0,c=l.length;s<c;++s)o.add(l[s]);if(o.size===c)return l;const h=[];return o.forEach(d=>{h.push(d)}),h}function _createResolver(l,o=[""],s=l,c,h=()=>l[0]){defined(c)||(c=_resolve("_fallback",l));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:l,_rootScopes:s,_fallback:c,_getTarget:h,override:p=>_createResolver([p,...l],o,s,c)};return new Proxy(d,{deleteProperty(p,Co){return delete p[Co],delete p._keys,delete l[0][Co],!0},get(p,Co){return _cached(p,Co,()=>_resolveWithPrefixes(Co,o,l,p))},getOwnPropertyDescriptor(p,Co){return Reflect.getOwnPropertyDescriptor(p._scopes[0],Co)},getPrototypeOf(){return Reflect.getPrototypeOf(l[0])},has(p,Co){return getKeysFromAllScopes(p).includes(Co)},ownKeys(p){return getKeysFromAllScopes(p)},set(p,Co,Bo){const Lo=p._storage||(p._storage=h());return Lo[Co]=Bo,delete p[Co],delete p._keys,!0}})}function _attachContext(l,o,s,c){const h={_cacheable:!1,_proxy:l,_context:o,_subProxy:s,_stack:new Set,_descriptors:_descriptors(l,c),setContext:d=>_attachContext(l,d,s,c),override:d=>_attachContext(l.override(d),o,s,c)};return new Proxy(h,{deleteProperty(d,p){return delete d[p],delete l[p],!0},get(d,p,Co){return _cached(d,p,()=>_resolveWithContext(d,p,Co))},getOwnPropertyDescriptor(d,p){return d._descriptors.allKeys?Reflect.has(l,p)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(l,p)},getPrototypeOf(){return Reflect.getPrototypeOf(l)},has(d,p){return Reflect.has(l,p)},ownKeys(){return Reflect.ownKeys(l)},set(d,p,Co){return l[p]=Co,delete d[p],!0}})}function _descriptors(l,o={scriptable:!0,indexable:!0}){const{_scriptable:s=o.scriptable,_indexable:c=o.indexable,_allKeys:h=o.allKeys}=l;return{allKeys:h,scriptable:s,indexable:c,isScriptable:isFunction(s)?s:()=>s,isIndexable:isFunction(c)?c:()=>c}}const readKey=(l,o)=>l?l+_capitalize(o):o,needsSubResolver=(l,o)=>isObject(o)&&l!=="adapters";function _cached(l,o,s){let c=l[o];return defined(c)||(c=s(),defined(c)&&(l[o]=c)),c}function _resolveWithContext(l,o,s){const{_proxy:c,_context:h,_subProxy:d,_descriptors:p}=l;let Co=c[o];return isFunction(Co)&&p.isScriptable(o)&&(Co=_resolveScriptable(o,Co,l,s)),isArray(Co)&&Co.length&&(Co=_resolveArray(o,Co,l,p.isIndexable)),needsSubResolver(o,Co)&&(Co=_attachContext(Co,h,d&&d[o],p)),Co}function _resolveScriptable(l,o,s,c){const{_proxy:h,_context:d,_subProxy:p,_stack:Co}=s;if(Co.has(l))throw new Error("Recursion detected: "+[...Co].join("->")+"->"+l);return Co.add(l),o=o(d,p||c),Co.delete(l),isObject(o)&&(o=createSubResolver(h._scopes,h,l,o)),o}function _resolveArray(l,o,s,c){const{_proxy:h,_context:d,_subProxy:p,_descriptors:Co}=s;if(defined(d.index)&&c(l))o=o[d.index%o.length];else if(isObject(o[0])){const Bo=o,Lo=h._scopes.filter(Uo=>Uo!==Bo);o=[];for(const Uo of Bo){const Qo=createSubResolver(Lo,h,l,Uo);o.push(_attachContext(Qo,d,p&&p[l],Co))}}return o}function resolveFallback(l,o,s){return isFunction(l)?l(o,s):l}const getScope=(l,o)=>l===!0?o:typeof l=="string"?resolveObjectKey(o,l):void 0;function addScopes(l,o,s,c){for(const h of o){const d=getScope(s,h);if(d){l.add(d);const p=resolveFallback(d._fallback,s,d);if(defined(p)&&p!==s&&p!==c)return p}else if(d===!1&&defined(c)&&s!==c)return null}return!1}function createSubResolver(l,o,s,c){const h=o._rootScopes,d=resolveFallback(o._fallback,s,c),p=[...l,...h],Co=new Set;Co.add(c);let Bo=addScopesFromKey(Co,p,s,d||s);return Bo===null||defined(d)&&d!==s&&(Bo=addScopesFromKey(Co,p,d,Bo),Bo===null)?!1:_createResolver([...Co],[""],h,d,()=>{const Lo=o._getTarget();return s in Lo||(Lo[s]={}),Lo[s]})}function addScopesFromKey(l,o,s,c){for(;s;)s=addScopes(l,o,s,c);return s}function _resolveWithPrefixes(l,o,s,c){let h;for(const d of o)if(h=_resolve(readKey(d,l),s),defined(h))return needsSubResolver(l,h)?createSubResolver(s,c,l,h):h}function _resolve(l,o){for(const s of o){if(!s)continue;const c=s[l];if(defined(c))return c}}function getKeysFromAllScopes(l){let o=l._keys;return o||(o=l._keys=resolveKeysFromAllScopes(l._scopes)),o}function resolveKeysFromAllScopes(l){const o=new Set;for(const s of l)for(const c of Object.keys(s).filter(h=>!h.startsWith("_")))o.add(c);return[...o]}const EPSILON=Number.EPSILON||1e-14,getPoint=(l,o)=>o<l.length&&!l[o].skip&&l[o];function splineCurve(l,o,s,c){const h=l.skip?o:l,d=o,p=s.skip?o:s,Co=distanceBetweenPoints(d,h),Bo=distanceBetweenPoints(p,d);let Lo=Co/(Co+Bo),Uo=Bo/(Co+Bo);Lo=isNaN(Lo)?0:Lo,Uo=isNaN(Uo)?0:Uo;const Qo=c*Lo,Po=c*Uo;return{previous:{x:d.x-Qo*(p.x-h.x),y:d.y-Qo*(p.y-h.y)},next:{x:d.x+Po*(p.x-h.x),y:d.y+Po*(p.y-h.y)}}}function monotoneAdjust(l,o,s){const c=l.length;let h,d,p,Co,Bo,Lo=getPoint(l,0);for(let Uo=0;Uo<c-1;++Uo)if(Bo=Lo,Lo=getPoint(l,Uo+1),!(!Bo||!Lo)){if(almostEquals(o[Uo],0,EPSILON)){s[Uo]=s[Uo+1]=0;continue}h=s[Uo]/o[Uo],d=s[Uo+1]/o[Uo],Co=Math.pow(h,2)+Math.pow(d,2),!(Co<=9)&&(p=3/Math.sqrt(Co),s[Uo]=h*p*o[Uo],s[Uo+1]=d*p*o[Uo])}}function monotoneCompute(l,o){const s=l.length;let c,h,d,p=getPoint(l,0);for(let Co=0;Co<s;++Co){if(h=d,d=p,p=getPoint(l,Co+1),!d)continue;const{x:Bo,y:Lo}=d;h&&(c=(Bo-h.x)/3,d.cp1x=Bo-c,d.cp1y=Lo-c*o[Co]),p&&(c=(p.x-Bo)/3,d.cp2x=Bo+c,d.cp2y=Lo+c*o[Co])}}function splineCurveMonotone(l){const o=l.length,s=Array(o).fill(0),c=Array(o);let h,d,p,Co=getPoint(l,0);for(h=0;h<o;++h)if(d=p,p=Co,Co=getPoint(l,h+1),!!p){if(Co){const Bo=Co.x-p.x;s[h]=Bo!==0?(Co.y-p.y)/Bo:0}c[h]=d?Co?sign(s[h-1])!==sign(s[h])?0:(s[h-1]+s[h])/2:s[h-1]:s[h]}monotoneAdjust(l,s,c),monotoneCompute(l,c)}function capControlPoint(l,o,s){return Math.max(Math.min(l,s),o)}function capBezierPoints(l,o){let s,c,h,d,p,Co=_isPointInArea(l[0],o);for(s=0,c=l.length;s<c;++s)p=d,d=Co,Co=s<c-1&&_isPointInArea(l[s+1],o),d&&(h=l[s],p&&(h.cp1x=capControlPoint(h.cp1x,o.left,o.right),h.cp1y=capControlPoint(h.cp1y,o.top,o.bottom)),Co&&(h.cp2x=capControlPoint(h.cp2x,o.left,o.right),h.cp2y=capControlPoint(h.cp2y,o.top,o.bottom)))}function _updateBezierControlPoints(l,o,s,c){let h,d,p,Co;if(o.spanGaps&&(l=l.filter(Bo=>!Bo.skip)),o.cubicInterpolationMode==="monotone")splineCurveMonotone(l);else{let Bo=c?l[l.length-1]:l[0];for(h=0,d=l.length;h<d;++h)p=l[h],Co=splineCurve(Bo,p,l[Math.min(h+1,d-(c?0:1))%d],o.tension),p.cp1x=Co.previous.x,p.cp1y=Co.previous.y,p.cp2x=Co.next.x,p.cp2y=Co.next.y,Bo=p}o.capBezierPoints&&capBezierPoints(l,s)}function _getParentNode(l){let o=l.parentNode;return o&&o.toString()==="[object ShadowRoot]"&&(o=o.host),o}function parseMaxStyle(l,o,s){let c;return typeof l=="string"?(c=parseInt(l,10),l.indexOf("%")!==-1&&(c=c/100*o.parentNode[s])):c=l,c}const getComputedStyle$1=l=>window.getComputedStyle(l,null);function getStyle(l,o){return getComputedStyle$1(l).getPropertyValue(o)}const positions=["top","right","bottom","left"];function getPositionedStyle(l,o,s){const c={};s=s?"-"+s:"";for(let h=0;h<4;h++){const d=positions[h];c[d]=parseFloat(l[o+"-"+d+s])||0}return c.width=c.left+c.right,c.height=c.top+c.bottom,c}const useOffsetPos=(l,o,s)=>(l>0||o>0)&&(!s||!s.shadowRoot);function getCanvasPosition(l,o){const s=l.native||l,c=s.touches,h=c&&c.length?c[0]:s,{offsetX:d,offsetY:p}=h;let Co=!1,Bo,Lo;if(useOffsetPos(d,p,s.target))Bo=d,Lo=p;else{const Uo=o.getBoundingClientRect();Bo=h.clientX-Uo.left,Lo=h.clientY-Uo.top,Co=!0}return{x:Bo,y:Lo,box:Co}}function getRelativePosition$1(l,o){const{canvas:s,currentDevicePixelRatio:c}=o,h=getComputedStyle$1(s),d=h.boxSizing==="border-box",p=getPositionedStyle(h,"padding"),Co=getPositionedStyle(h,"border","width"),{x:Bo,y:Lo,box:Uo}=getCanvasPosition(l,s),Qo=p.left+(Uo&&Co.left),Po=p.top+(Uo&&Co.top);let{width:Mo,height:Go}=o;return d&&(Mo-=p.width+Co.width,Go-=p.height+Co.height),{x:Math.round((Bo-Qo)/Mo*s.width/c),y:Math.round((Lo-Po)/Go*s.height/c)}}function getContainerSize(l,o,s){let c,h;if(o===void 0||s===void 0){const d=_getParentNode(l);if(!d)o=l.clientWidth,s=l.clientHeight;else{const p=d.getBoundingClientRect(),Co=getComputedStyle$1(d),Bo=getPositionedStyle(Co,"border","width"),Lo=getPositionedStyle(Co,"padding");o=p.width-Lo.width-Bo.width,s=p.height-Lo.height-Bo.height,c=parseMaxStyle(Co.maxWidth,d,"clientWidth"),h=parseMaxStyle(Co.maxHeight,d,"clientHeight")}}return{width:o,height:s,maxWidth:c||INFINITY,maxHeight:h||INFINITY}}const round1=l=>Math.round(l*10)/10;function getMaximumSize(l,o,s,c){const h=getComputedStyle$1(l),d=getPositionedStyle(h,"margin"),p=parseMaxStyle(h.maxWidth,l,"clientWidth")||INFINITY,Co=parseMaxStyle(h.maxHeight,l,"clientHeight")||INFINITY,Bo=getContainerSize(l,o,s);let{width:Lo,height:Uo}=Bo;if(h.boxSizing==="content-box"){const Qo=getPositionedStyle(h,"border","width"),Po=getPositionedStyle(h,"padding");Lo-=Po.width+Qo.width,Uo-=Po.height+Qo.height}return Lo=Math.max(0,Lo-d.width),Uo=Math.max(0,c?Math.floor(Lo/c):Uo-d.height),Lo=round1(Math.min(Lo,p,Bo.maxWidth)),Uo=round1(Math.min(Uo,Co,Bo.maxHeight)),Lo&&!Uo&&(Uo=round1(Lo/2)),{width:Lo,height:Uo}}function retinaScale(l,o,s){const c=l.currentDevicePixelRatio=o||1,{canvas:h,width:d,height:p}=l;h.height=p*c,h.width=d*c,l.ctx.setTransform(c,0,0,c,0,0),h.style&&(s||!h.style.height&&!h.style.width)&&(h.style.height=p+"px",h.style.width=d+"px")}const supportsEventListenerOptions=function(){let l=!1;try{const o={get passive(){return l=!0,!1}};window.addEventListener("test",null,o),window.removeEventListener("test",null,o)}catch{}return l}();function readUsedSize(l,o){const s=getStyle(l,o),c=s&&s.match(/^(\d+)(\.\d+)?px$/);return c?+c[1]:void 0}function _pointInLine(l,o,s,c){return{x:l.x+s*(o.x-l.x),y:l.y+s*(o.y-l.y)}}function _steppedInterpolation(l,o,s,c){return{x:l.x+s*(o.x-l.x),y:c==="middle"?s<.5?l.y:o.y:c==="after"?s<1?l.y:o.y:s>0?o.y:l.y}}function _bezierInterpolation(l,o,s,c){const h={x:l.cp2x,y:l.cp2y},d={x:o.cp1x,y:o.cp1y},p=_pointInLine(l,h,s),Co=_pointInLine(h,d,s),Bo=_pointInLine(d,o,s),Lo=_pointInLine(p,Co,s),Uo=_pointInLine(Co,Bo,s);return _pointInLine(Lo,Uo,s)}const intlCache=new Map;function getNumberFormat(l,o){o=o||{};const s=l+JSON.stringify(o);let c=intlCache.get(s);return c||(c=new Intl.NumberFormat(l,o),intlCache.set(s,c)),c}function formatNumber(l,o,s){return getNumberFormat(o,s).format(l)}const getRightToLeftAdapter=function(l,o){return{x(s){return l+l+o-s},setWidth(s){o=s},textAlign(s){return s==="center"?s:s==="right"?"left":"right"},xPlus(s,c){return s-c},leftForLtr(s,c){return s-c}}},getLeftToRightAdapter=function(){return{x(l){return l},setWidth(l){},textAlign(l){return l},xPlus(l,o){return l+o},leftForLtr(l,o){return l}}};function getRtlAdapter(l,o,s){return l?getRightToLeftAdapter(o,s):getLeftToRightAdapter()}function overrideTextDirection(l,o){let s,c;(o==="ltr"||o==="rtl")&&(s=l.canvas.style,c=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",o,"important"),l.prevTextDirection=c)}function restoreTextDirection(l,o){o!==void 0&&(delete l.prevTextDirection,l.canvas.style.setProperty("direction",o[0],o[1]))}function propertyFn(l){return l==="angle"?{between:_angleBetween,compare:_angleDiff,normalize:_normalizeAngle}:{between:(o,s,c)=>o>=Math.min(s,c)&&o<=Math.max(c,s),compare:(o,s)=>o-s,normalize:o=>o}}function normalizeSegment({start:l,end:o,count:s,loop:c,style:h}){return{start:l%s,end:o%s,loop:c&&(o-l+1)%s===0,style:h}}function getSegment(l,o,s){const{property:c,start:h,end:d}=s,{between:p,normalize:Co}=propertyFn(c),Bo=o.length;let{start:Lo,end:Uo,loop:Qo}=l,Po,Mo;if(Qo){for(Lo+=Bo,Uo+=Bo,Po=0,Mo=Bo;Po<Mo&&p(Co(o[Lo%Bo][c]),h,d);++Po)Lo--,Uo--;Lo%=Bo,Uo%=Bo}return Uo<Lo&&(Uo+=Bo),{start:Lo,end:Uo,loop:Qo,style:l.style}}function _boundSegment(l,o,s){if(!s)return[l];const{property:c,start:h,end:d}=s,p=o.length,{compare:Co,between:Bo,normalize:Lo}=propertyFn(c),{start:Uo,end:Qo,loop:Po,style:Mo}=getSegment(l,o,s),Go=[];let $o=!1,jo=null,zo,Xo,Zo;const Wo=()=>Bo(h,Zo,zo)&&Co(h,Zo)!==0,es=()=>Co(d,zo)===0||Bo(d,Zo,zo),is=()=>$o||Wo(),Jo=()=>!$o||es();for(let Ko=Uo,Yo=Uo;Ko<=Qo;++Ko)Xo=o[Ko%p],!Xo.skip&&(zo=Lo(Xo[c]),$o=Bo(zo,h,d),jo===null&&is()&&(jo=Co(zo,h)===0?Ko:Yo),jo!==null&&Jo()&&(Go.push(normalizeSegment({start:jo,end:Ko,loop:Po,count:p,style:Mo})),jo=null),Yo=Ko,Zo=zo);return jo!==null&&Go.push(normalizeSegment({start:jo,end:Qo,loop:Po,count:p,style:Mo})),Go}function _boundSegments(l,o){const s=[],c=l.segments;for(let h=0;h<c.length;h++){const d=_boundSegment(c[h],l.points,o);d.length&&s.push(...d)}return s}function findStartAndEnd(l,o,s,c){let h=0,d=o-1;if(s&&!c)for(;h<o&&!l[h].skip;)h++;for(;h<o&&l[h].skip;)h++;for(h%=o,s&&(d+=h);d>h&&l[d%o].skip;)d--;return d%=o,{start:h,end:d}}function solidSegments(l,o,s,c){const h=l.length,d=[];let p=o,Co=l[o],Bo;for(Bo=o+1;Bo<=s;++Bo){const Lo=l[Bo%h];Lo.skip||Lo.stop?Co.skip||(c=!1,d.push({start:o%h,end:(Bo-1)%h,loop:c}),o=p=Lo.stop?Bo:null):(p=Bo,Co.skip&&(o=Bo)),Co=Lo}return p!==null&&d.push({start:o%h,end:p%h,loop:c}),d}function _computeSegments(l,o){const s=l.points,c=l.options.spanGaps,h=s.length;if(!h)return[];const d=!!l._loop,{start:p,end:Co}=findStartAndEnd(s,h,d,c);if(c===!0)return splitByStyles([{start:p,end:Co,loop:d}],s,o);const Bo=Co<p?Co+h:Co,Lo=!!l._fullLoop&&p===0&&Co===h-1;return splitByStyles(solidSegments(s,p,Bo,Lo),s,o)}function splitByStyles(l,o,s){return!s||!s.setContext||!o?l:doSplitByStyles(l,o,s)}function doSplitByStyles(l,o,s){const c=o.length,h=[];let d=l[0].start,p=d;for(const Co of l){let Bo,Lo,Uo=o[d%c];for(p=d+1;p<=Co.end;p++){const Qo=o[p%c];Lo=readStyle(s.setContext({type:"segment",p0:Uo,p1:Qo})),styleChanged(Lo,Bo)&&(h.push({start:d,end:p-1,loop:Co.loop,style:Bo}),Bo=Lo,d=p-1),Uo=Qo,Bo=Lo}d<p-1&&(h.push({start:d,end:p-1,loop:Co.loop,style:Lo}),d=p-1)}return h}function readStyle(l){return{backgroundColor:l.backgroundColor,borderCapStyle:l.borderCapStyle,borderDash:l.borderDash,borderDashOffset:l.borderDashOffset,borderJoinStyle:l.borderJoinStyle,borderWidth:l.borderWidth,borderColor:l.borderColor}}function styleChanged(l,o){return o&&JSON.stringify(l)!==JSON.stringify(o)}/*!
 * Chart.js v3.1.0
 * https://www.chartjs.org
 * (c) 2021 Chart.js Contributors
 * Released under the MIT License
 */class Animator{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(o,s,c,h){const d=s.listeners[h],p=s.duration;d.forEach(Co=>Co({chart:o,numSteps:p,currentStep:Math.min(c-s.start,p)}))}_refresh(){const o=this;o._request||(o._running=!0,o._request=requestAnimFrame.call(window,()=>{o._update(),o._request=null,o._running&&o._refresh()}))}_update(o=Date.now()){const s=this;let c=0;s._charts.forEach((h,d)=>{if(!h.running||!h.items.length)return;const p=h.items;let Co=p.length-1,Bo=!1,Lo;for(;Co>=0;--Co)Lo=p[Co],Lo._active?(Lo._total>h.duration&&(h.duration=Lo._total),Lo.tick(o),Bo=!0):(p[Co]=p[p.length-1],p.pop());Bo&&(d.draw(),s._notify(d,h,o,"progress")),p.length||(h.running=!1,s._notify(d,h,o,"complete")),c+=p.length}),s._lastDate=o,c===0&&(s._running=!1)}_getAnims(o){const s=this._charts;let c=s.get(o);return c||(c={running:!1,items:[],listeners:{complete:[],progress:[]}},s.set(o,c)),c}listen(o,s,c){this._getAnims(o).listeners[s].push(c)}add(o,s){!s||!s.length||this._getAnims(o).items.push(...s)}has(o){return this._getAnims(o).items.length>0}start(o){const s=this._charts.get(o);!s||(s.running=!0,s.start=Date.now(),s.duration=s.items.reduce((c,h)=>Math.max(c,h._duration),0),this._refresh())}running(o){if(!this._running)return!1;const s=this._charts.get(o);return!(!s||!s.running||!s.items.length)}stop(o){const s=this._charts.get(o);if(!s||!s.items.length)return;const c=s.items;let h=c.length-1;for(;h>=0;--h)c[h].cancel();s.items=[],this._notify(o,s,Date.now(),"complete")}remove(o){return this._charts.delete(o)}}var animator=new Animator;const transparent="transparent",interpolators={boolean(l,o,s){return s>.5?o:l},color(l,o,s){const c=color$2(l||transparent),h=c.valid&&color$2(o||transparent);return h&&h.valid?h.mix(c,s).hexString():o},number(l,o,s){return l+(o-l)*s}};class Animation{constructor(o,s,c,h){const d=s[c];h=resolve([o.to,h,d,o.from]);const p=resolve([o.from,d,h]);this._active=!0,this._fn=o.fn||interpolators[o.type||typeof p],this._easing=effects[o.easing]||effects.linear,this._start=Math.floor(Date.now()+(o.delay||0)),this._duration=this._total=Math.floor(o.duration),this._loop=!!o.loop,this._target=s,this._prop=c,this._from=p,this._to=h,this._promises=void 0}active(){return this._active}update(o,s,c){const h=this;if(h._active){h._notify(!1);const d=h._target[h._prop],p=c-h._start,Co=h._duration-p;h._start=c,h._duration=Math.floor(Math.max(Co,o.duration)),h._total+=p,h._loop=!!o.loop,h._to=resolve([o.to,s,d,o.from]),h._from=resolve([o.from,d,s])}}cancel(){const o=this;o._active&&(o.tick(Date.now()),o._active=!1,o._notify(!1))}tick(o){const s=this,c=o-s._start,h=s._duration,d=s._prop,p=s._from,Co=s._loop,Bo=s._to;let Lo;if(s._active=p!==Bo&&(Co||c<h),!s._active){s._target[d]=Bo,s._notify(!0);return}if(c<0){s._target[d]=p;return}Lo=c/h%2,Lo=Co&&Lo>1?2-Lo:Lo,Lo=s._easing(Math.min(1,Math.max(0,Lo))),s._target[d]=s._fn(p,Bo,Lo)}wait(){const o=this._promises||(this._promises=[]);return new Promise((s,c)=>{o.push({res:s,rej:c})})}_notify(o){const s=o?"res":"rej",c=this._promises||[];for(let h=0;h<c.length;h++)c[h][s]()}}const numbers=["x","y","borderWidth","radius","tension"],colors=["color","borderColor","backgroundColor"];defaults.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const animationOptions=Object.keys(defaults.animation);defaults.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:l=>l!=="onProgress"&&l!=="onComplete"&&l!=="fn"});defaults.set("animations",{colors:{type:"color",properties:colors},numbers:{type:"number",properties:numbers}});defaults.describe("animations",{_fallback:"animation"});defaults.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:l=>l|0}}}});class Animations{constructor(o,s){this._chart=o,this._properties=new Map,this.configure(s)}configure(o){if(!isObject(o))return;const s=this._properties;Object.getOwnPropertyNames(o).forEach(c=>{const h=o[c];if(!isObject(h))return;const d={};for(const p of animationOptions)d[p]=h[p];(isArray(h.properties)&&h.properties||[c]).forEach(p=>{(p===c||!s.has(p))&&s.set(p,d)})})}_animateOptions(o,s){const c=s.options,h=resolveTargetOptions(o,c);if(!h)return[];const d=this._createAnimations(h,c);return c.$shared&&awaitAll(o.options.$animations,c).then(()=>{o.options=c},()=>{}),d}_createAnimations(o,s){const c=this._properties,h=[],d=o.$animations||(o.$animations={}),p=Object.keys(s),Co=Date.now();let Bo;for(Bo=p.length-1;Bo>=0;--Bo){const Lo=p[Bo];if(Lo.charAt(0)==="$")continue;if(Lo==="options"){h.push(...this._animateOptions(o,s));continue}const Uo=s[Lo];let Qo=d[Lo];const Po=c.get(Lo);if(Qo)if(Po&&Qo.active()){Qo.update(Po,Uo,Co);continue}else Qo.cancel();if(!Po||!Po.duration){o[Lo]=Uo;continue}d[Lo]=Qo=new Animation(Po,o,Lo,Uo),h.push(Qo)}return h}update(o,s){if(this._properties.size===0){Object.assign(o,s);return}const c=this._createAnimations(o,s);if(c.length)return animator.add(this._chart,c),!0}}function awaitAll(l,o){const s=[],c=Object.keys(o);for(let h=0;h<c.length;h++){const d=l[c[h]];d&&d.active()&&s.push(d.wait())}return Promise.all(s)}function resolveTargetOptions(l,o){if(!o)return;let s=l.options;if(!s){l.options=o;return}return s.$shared&&(l.options=s=Object.assign({},s,{$shared:!1,$animations:{}})),s}function scaleClip(l,o){const s=l&&l.options||{},c=s.reverse,h=s.min===void 0?o:0,d=s.max===void 0?o:0;return{start:c?d:h,end:c?h:d}}function defaultClip(l,o,s){if(s===!1)return!1;const c=scaleClip(l,s),h=scaleClip(o,s);return{top:h.end,right:c.end,bottom:h.start,left:c.start}}function toClip(l){let o,s,c,h;return isObject(l)?(o=l.top,s=l.right,c=l.bottom,h=l.left):o=s=c=h=l,{top:o,right:s,bottom:c,left:h}}function getSortedDatasetIndices(l,o){const s=[],c=l._getSortedDatasetMetas(o);let h,d;for(h=0,d=c.length;h<d;++h)s.push(c[h].index);return s}function applyStack(l,o,s,c){const h=l.keys,d=c.mode==="single";let p,Co,Bo,Lo;if(o!==null){for(p=0,Co=h.length;p<Co;++p){if(Bo=+h[p],Bo===s){if(c.all)continue;break}Lo=l.values[Bo],isNumberFinite(Lo)&&(d||o===0||sign(o)===sign(Lo))&&(o+=Lo)}return o}}function convertObjectDataToArray(l){const o=Object.keys(l),s=new Array(o.length);let c,h,d;for(c=0,h=o.length;c<h;++c)d=o[c],s[c]={x:d,y:l[d]};return s}function isStacked(l,o){const s=l&&l.options.stacked;return s||s===void 0&&o.stack!==void 0}function getStackKey(l,o,s){return`${l.id}.${o.id}.${s.stack||s.type}`}function getUserBounds(l){const{min:o,max:s,minDefined:c,maxDefined:h}=l.getUserBounds();return{min:c?o:Number.NEGATIVE_INFINITY,max:h?s:Number.POSITIVE_INFINITY}}function getOrCreateStack(l,o,s){const c=l[o]||(l[o]={});return c[s]||(c[s]={})}function updateStacks(l,o){const{chart:s,_cachedMeta:c}=l,h=s._stacks||(s._stacks={}),{iScale:d,vScale:p,index:Co}=c,Bo=d.axis,Lo=p.axis,Uo=getStackKey(d,p,c),Qo=o.length;let Po;for(let Mo=0;Mo<Qo;++Mo){const Go=o[Mo],{[Bo]:$o,[Lo]:jo}=Go,zo=Go._stacks||(Go._stacks={});Po=zo[Lo]=getOrCreateStack(h,Uo,$o),Po[Co]=jo}}function getFirstScaleId(l,o){const s=l.scales;return Object.keys(s).filter(c=>s[c].axis===o).shift()}function createDatasetContext(l,o){return Object.assign(Object.create(l),{active:!1,dataset:void 0,datasetIndex:o,index:o,mode:"default",type:"dataset"})}function createDataContext(l,o,s){return Object.assign(Object.create(l),{active:!1,dataIndex:o,parsed:void 0,raw:void 0,element:s,index:o,mode:"default",type:"data"})}function clearStacks(l,o){o=o||l._parsed;for(const s of o){const c=s._stacks;if(!c||c[l.vScale.id]===void 0||c[l.vScale.id][l.index]===void 0)return;delete c[l.vScale.id][l.index]}}const isDirectUpdateMode=l=>l==="reset"||l==="none",cloneIfNotShared=(l,o)=>o?l:Object.assign({},l);class DatasetController{constructor(o,s){this.chart=o,this._ctx=o.ctx,this.index=s,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.$context=void 0,this.initialize()}initialize(){const o=this,s=o._cachedMeta;o.configure(),o.linkScales(),s._stacked=isStacked(s.vScale,s),o.addElements()}updateIndex(o){this.index=o}linkScales(){const o=this,s=o.chart,c=o._cachedMeta,h=o.getDataset(),d=(Po,Mo,Go,$o)=>Po==="x"?Mo:Po==="r"?$o:Go,p=c.xAxisID=valueOrDefault(h.xAxisID,getFirstScaleId(s,"x")),Co=c.yAxisID=valueOrDefault(h.yAxisID,getFirstScaleId(s,"y")),Bo=c.rAxisID=valueOrDefault(h.rAxisID,getFirstScaleId(s,"r")),Lo=c.indexAxis,Uo=c.iAxisID=d(Lo,p,Co,Bo),Qo=c.vAxisID=d(Lo,Co,p,Bo);c.xScale=o.getScaleForId(p),c.yScale=o.getScaleForId(Co),c.rScale=o.getScaleForId(Bo),c.iScale=o.getScaleForId(Uo),c.vScale=o.getScaleForId(Qo)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(o){return this.chart.scales[o]}_getOtherScale(o){const s=this._cachedMeta;return o===s.iScale?s.vScale:s.iScale}reset(){this._update("reset")}_destroy(){const o=this._cachedMeta;this._data&&unlistenArrayEvents(this._data,this),o._stacked&&clearStacks(o)}_dataCheck(){const o=this,s=o.getDataset(),c=s.data||(s.data=[]);isObject(c)?o._data=convertObjectDataToArray(c):o._data!==c&&(o._data&&(unlistenArrayEvents(o._data,o),clearStacks(o._cachedMeta)),c&&Object.isExtensible(c)&&listenArrayEvents(c,o),o._data=c)}addElements(){const o=this,s=o._cachedMeta;o._dataCheck(),o.datasetElementType&&(s.dataset=new o.datasetElementType)}buildOrUpdateElements(o){const s=this,c=s._cachedMeta,h=s.getDataset();let d=!1;s._dataCheck(),c._stacked=isStacked(c.vScale,c),c.stack!==h.stack&&(d=!0,clearStacks(c),c.stack=h.stack),s._resyncElements(o),d&&updateStacks(s,c._parsed)}configure(){const o=this,s=o.chart.config,c=s.datasetScopeKeys(o._type),h=s.getOptionScopes(o.getDataset(),c,!0);o.options=s.createResolver(h,o.getContext()),o._parsing=o.options.parsing}parse(o,s){const c=this,{_cachedMeta:h,_data:d}=c,{iScale:p,_stacked:Co}=h,Bo=p.axis;let Lo=o===0&&s===d.length?!0:h._sorted,Uo=o>0&&h._parsed[o-1],Qo,Po,Mo;if(c._parsing===!1)h._parsed=d,h._sorted=!0;else{isArray(d[o])?Mo=c.parseArrayData(h,d,o,s):isObject(d[o])?Mo=c.parseObjectData(h,d,o,s):Mo=c.parsePrimitiveData(h,d,o,s);const Go=()=>Po[Bo]===null||Uo&&Po[Bo]<Uo[Bo];for(Qo=0;Qo<s;++Qo)h._parsed[Qo+o]=Po=Mo[Qo],Lo&&(Go()&&(Lo=!1),Uo=Po);h._sorted=Lo}Co&&updateStacks(c,Mo)}parsePrimitiveData(o,s,c,h){const{iScale:d,vScale:p}=o,Co=d.axis,Bo=p.axis,Lo=d.getLabels(),Uo=d===p,Qo=new Array(h);let Po,Mo,Go;for(Po=0,Mo=h;Po<Mo;++Po)Go=Po+c,Qo[Po]={[Co]:Uo||d.parse(Lo[Go],Go),[Bo]:p.parse(s[Go],Go)};return Qo}parseArrayData(o,s,c,h){const{xScale:d,yScale:p}=o,Co=new Array(h);let Bo,Lo,Uo,Qo;for(Bo=0,Lo=h;Bo<Lo;++Bo)Uo=Bo+c,Qo=s[Uo],Co[Bo]={x:d.parse(Qo[0],Uo),y:p.parse(Qo[1],Uo)};return Co}parseObjectData(o,s,c,h){const{xScale:d,yScale:p}=o,{xAxisKey:Co="x",yAxisKey:Bo="y"}=this._parsing,Lo=new Array(h);let Uo,Qo,Po,Mo;for(Uo=0,Qo=h;Uo<Qo;++Uo)Po=Uo+c,Mo=s[Po],Lo[Uo]={x:d.parse(resolveObjectKey(Mo,Co),Po),y:p.parse(resolveObjectKey(Mo,Bo),Po)};return Lo}getParsed(o){return this._cachedMeta._parsed[o]}getDataElement(o){return this._cachedMeta.data[o]}applyStack(o,s,c){const h=this.chart,d=this._cachedMeta,p=s[o.axis],Co={keys:getSortedDatasetIndices(h,!0),values:s._stacks[o.axis]};return applyStack(Co,p,d.index,{mode:c})}updateRangeFromParsed(o,s,c,h){const d=c[s.axis];let p=d===null?NaN:d;const Co=h&&c._stacks[s.axis];h&&Co&&(h.values=Co,o.min=Math.min(o.min,p),o.max=Math.max(o.max,p),p=applyStack(h,d,this._cachedMeta.index,{all:!0})),o.min=Math.min(o.min,p),o.max=Math.max(o.max,p)}getMinMax(o,s){const c=this,h=c._cachedMeta,d=h._parsed,p=h._sorted&&o===h.iScale,Co=d.length,Bo=c._getOtherScale(o),Lo=s&&h._stacked&&{keys:getSortedDatasetIndices(c.chart,!0),values:null},Uo={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:Qo,max:Po}=getUserBounds(Bo);let Mo,Go,$o,jo;function zo(){return $o=d[Mo],Go=$o[o.axis],jo=$o[Bo.axis],!isNumberFinite(Go)||Qo>jo||Po<jo}for(Mo=0;Mo<Co&&!(!zo()&&(c.updateRangeFromParsed(Uo,o,$o,Lo),p));++Mo);if(p){for(Mo=Co-1;Mo>=0;--Mo)if(!zo()){c.updateRangeFromParsed(Uo,o,$o,Lo);break}}return Uo}getAllParsedValues(o){const s=this._cachedMeta._parsed,c=[];let h,d,p;for(h=0,d=s.length;h<d;++h)p=s[h][o.axis],isNumberFinite(p)&&c.push(p);return c}getMaxOverflow(){return!1}getLabelAndValue(o){const s=this,c=s._cachedMeta,h=c.iScale,d=c.vScale,p=s.getParsed(o);return{label:h?""+h.getLabelForValue(p[h.axis]):"",value:d?""+d.getLabelForValue(p[d.axis]):""}}_update(o){const s=this,c=s._cachedMeta;s.configure(),s._cachedDataOpts={},s.update(o||"default"),c._clip=toClip(valueOrDefault(s.options.clip,defaultClip(c.xScale,c.yScale,s.getMaxOverflow())))}update(o){}draw(){const o=this,s=o._ctx,c=o.chart,h=o._cachedMeta,d=h.data||[],p=c.chartArea,Co=[],Bo=o._drawStart||0,Lo=o._drawCount||d.length-Bo;let Uo;for(h.dataset&&h.dataset.draw(s,p,Bo,Lo),Uo=Bo;Uo<Bo+Lo;++Uo){const Qo=d[Uo];Qo.active?Co.push(Qo):Qo.draw(s,p)}for(Uo=0;Uo<Co.length;++Uo)Co[Uo].draw(s,p)}getStyle(o,s){const c=s?"active":"default";return o===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(c):this.resolveDataElementOptions(o||0,c)}getContext(o,s,c){const h=this,d=h.getDataset();let p;if(o>=0&&o<h._cachedMeta.data.length){const Co=h._cachedMeta.data[o];p=Co.$context||(Co.$context=createDataContext(h.getContext(),o,Co)),p.parsed=h.getParsed(o),p.raw=d.data[o]}else p=h.$context||(h.$context=createDatasetContext(h.chart.getContext(),h.index)),p.dataset=d;return p.active=!!s,p.mode=c,p}resolveDatasetElementOptions(o){return this._resolveElementOptions(this.datasetElementType.id,o)}resolveDataElementOptions(o,s){return this._resolveElementOptions(this.dataElementType.id,s,o)}_resolveElementOptions(o,s="default",c){const h=this,d=s==="active",p=h._cachedDataOpts,Co=o+"-"+s,Bo=p[Co],Lo=h.enableOptionSharing&&defined(c);if(Bo)return cloneIfNotShared(Bo,Lo);const Uo=h.chart.config,Qo=Uo.datasetElementScopeKeys(h._type,o),Po=d?[`${o}Hover`,"hover",o,""]:[o,""],Mo=Uo.getOptionScopes(h.getDataset(),Qo),Go=Object.keys(defaults.elements[o]),$o=()=>h.getContext(c,d),jo=Uo.resolveNamedOptions(Mo,Go,$o,Po);return jo.$shared&&(jo.$shared=Lo,p[Co]=Object.freeze(cloneIfNotShared(jo,Lo))),jo}_resolveAnimations(o,s,c){const h=this,d=h.chart,p=h._cachedDataOpts,Co=`animation-${s}`,Bo=p[Co];if(Bo)return Bo;let Lo;if(d.options.animation!==!1){const Qo=h.chart.config,Po=Qo.datasetAnimationScopeKeys(h._type,s),Mo=Qo.getOptionScopes(h.getDataset(),Po);Lo=Qo.createResolver(Mo,h.getContext(o,c,s))}const Uo=new Animations(d,Lo&&Lo.animations);return Lo&&Lo._cacheable&&(p[Co]=Object.freeze(Uo)),Uo}getSharedOptions(o){if(!!o.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},o))}includeOptions(o,s){return!s||isDirectUpdateMode(o)||this.chart._animationsDisabled}updateElement(o,s,c,h){isDirectUpdateMode(h)?Object.assign(o,c):this._resolveAnimations(s,h).update(o,c)}updateSharedOptions(o,s,c){o&&!isDirectUpdateMode(s)&&this._resolveAnimations(void 0,s).update(o,c)}_setStyle(o,s,c,h){o.active=h;const d=this.getStyle(s,h);this._resolveAnimations(s,c,h).update(o,{options:!h&&this.getSharedOptions(d)||d})}removeHoverStyle(o,s,c){this._setStyle(o,c,"active",!1)}setHoverStyle(o,s,c){this._setStyle(o,c,"active",!0)}_removeDatasetHoverStyle(){const o=this._cachedMeta.dataset;o&&this._setStyle(o,void 0,"active",!1)}_setDatasetHoverStyle(){const o=this._cachedMeta.dataset;o&&this._setStyle(o,void 0,"active",!0)}_resyncElements(o){const s=this,c=s._cachedMeta.data.length,h=s._data.length;h>c?s._insertElements(c,h-c,o):h<c&&s._removeElements(h,c-h);const d=Math.min(h,c);d&&s.parse(0,d)}_insertElements(o,s,c=!0){const h=this,d=h._cachedMeta,p=d.data,Co=o+s;let Bo;const Lo=Uo=>{for(Uo.length+=s,Bo=Uo.length-1;Bo>=Co;Bo--)Uo[Bo]=Uo[Bo-s]};for(Lo(p),Bo=o;Bo<Co;++Bo)p[Bo]=new h.dataElementType;h._parsing&&Lo(d._parsed),h.parse(o,s),c&&h.updateElements(p,o,s,"reset")}updateElements(o,s,c,h){}_removeElements(o,s){const c=this,h=c._cachedMeta;if(c._parsing){const d=h._parsed.splice(o,s);h._stacked&&clearStacks(h,d)}h.data.splice(o,s)}_onDataPush(){const o=arguments.length;this._insertElements(this.getDataset().data.length-o,o)}_onDataPop(){this._removeElements(this._cachedMeta.data.length-1,1)}_onDataShift(){this._removeElements(0,1)}_onDataSplice(o,s){this._removeElements(o,s),this._insertElements(o,arguments.length-2)}_onDataUnshift(){this._insertElements(0,arguments.length)}}DatasetController.defaults={};DatasetController.prototype.datasetElementType=null;DatasetController.prototype.dataElementType=null;function getAllScaleValues(l){if(!l._cache.$bar){const o=l.getMatchingVisibleMetas("bar");let s=[];for(let c=0,h=o.length;c<h;c++)s=s.concat(o[c].controller.getAllParsedValues(l));l._cache.$bar=_arrayUnique(s.sort((c,h)=>c-h))}return l._cache.$bar}function computeMinSampleSize(l){const o=getAllScaleValues(l);let s=l._length,c,h,d,p;const Co=()=>{s=Math.min(s,c&&Math.abs(d-p)||s),p=d};for(c=0,h=o.length;c<h;++c)d=l.getPixelForValue(o[c]),Co();for(c=0,h=l.ticks.length;c<h;++c)d=l.getPixelForTick(c),Co();return s}function computeFitCategoryTraits(l,o,s,c){const h=s.barThickness;let d,p;return isNullOrUndef(h)?(d=o.min*s.categoryPercentage,p=s.barPercentage):(d=h*c,p=1),{chunk:d/c,ratio:p,start:o.pixels[l]-d/2}}function computeFlexCategoryTraits(l,o,s,c){const h=o.pixels,d=h[l];let p=l>0?h[l-1]:null,Co=l<h.length-1?h[l+1]:null;const Bo=s.categoryPercentage;p===null&&(p=d-(Co===null?o.end-o.start:Co-d)),Co===null&&(Co=d+d-p);const Lo=d-(d-Math.min(p,Co))/2*Bo;return{chunk:Math.abs(Co-p)/2*Bo/c,ratio:s.barPercentage,start:Lo}}function parseFloatBar(l,o,s,c){const h=s.parse(l[0],c),d=s.parse(l[1],c),p=Math.min(h,d),Co=Math.max(h,d);let Bo=p,Lo=Co;Math.abs(p)>Math.abs(Co)&&(Bo=Co,Lo=p),o[s.axis]=Lo,o._custom={barStart:Bo,barEnd:Lo,start:h,end:d,min:p,max:Co}}function parseValue(l,o,s,c){return isArray(l)?parseFloatBar(l,o,s,c):o[s.axis]=s.parse(l,c),o}function parseArrayOrPrimitive(l,o,s,c){const h=l.iScale,d=l.vScale,p=h.getLabels(),Co=h===d,Bo=[];let Lo,Uo,Qo,Po;for(Lo=s,Uo=s+c;Lo<Uo;++Lo)Po=o[Lo],Qo={},Qo[h.axis]=Co||h.parse(p[Lo],Lo),Bo.push(parseValue(Po,Qo,d,Lo));return Bo}function isFloatBar(l){return l&&l.barStart!==void 0&&l.barEnd!==void 0}class BarController extends DatasetController{parsePrimitiveData(o,s,c,h){return parseArrayOrPrimitive(o,s,c,h)}parseArrayData(o,s,c,h){return parseArrayOrPrimitive(o,s,c,h)}parseObjectData(o,s,c,h){const{iScale:d,vScale:p}=o,{xAxisKey:Co="x",yAxisKey:Bo="y"}=this._parsing,Lo=d.axis==="x"?Co:Bo,Uo=p.axis==="x"?Co:Bo,Qo=[];let Po,Mo,Go,$o;for(Po=c,Mo=c+h;Po<Mo;++Po)$o=s[Po],Go={},Go[d.axis]=d.parse(resolveObjectKey($o,Lo),Po),Qo.push(parseValue(resolveObjectKey($o,Uo),Go,p,Po));return Qo}updateRangeFromParsed(o,s,c,h){super.updateRangeFromParsed(o,s,c,h);const d=c._custom;d&&s===this._cachedMeta.vScale&&(o.min=Math.min(o.min,d.min),o.max=Math.max(o.max,d.max))}getLabelAndValue(o){const s=this,c=s._cachedMeta,{iScale:h,vScale:d}=c,p=s.getParsed(o),Co=p._custom,Bo=isFloatBar(Co)?"["+Co.start+", "+Co.end+"]":""+d.getLabelForValue(p[d.axis]);return{label:""+h.getLabelForValue(p[h.axis]),value:Bo}}initialize(){const o=this;o.enableOptionSharing=!0,super.initialize();const s=o._cachedMeta;s.stack=o.getDataset().stack}update(o){const s=this,c=s._cachedMeta;s.updateElements(c.data,0,c.data.length,o)}updateElements(o,s,c,h){const d=this,p=h==="reset",Co=d._cachedMeta.vScale,Bo=Co.getBasePixel(),Lo=Co.isHorizontal(),Uo=d._getRuler(),Qo=d.resolveDataElementOptions(s,h),Po=d.getSharedOptions(Qo),Mo=d.includeOptions(h,Po);d.updateSharedOptions(Po,h,Qo);for(let Go=s;Go<s+c;Go++){const $o=d.getParsed(Go),jo=p||isNullOrUndef($o[Co.axis])?{base:Bo,head:Bo}:d._calculateBarValuePixels(Go),zo=d._calculateBarIndexPixels(Go,Uo),Xo={horizontal:Lo,base:jo.base,x:Lo?jo.head:zo.center,y:Lo?zo.center:jo.head,height:Lo?zo.size:void 0,width:Lo?void 0:zo.size};Mo&&(Xo.options=Po||d.resolveDataElementOptions(Go,h)),d.updateElement(o[Go],Go,Xo,h)}}_getStacks(o,s){const c=this,d=c._cachedMeta.iScale,p=d.getMatchingVisibleMetas(c._type),Co=d.options.stacked,Bo=p.length,Lo=[];let Uo,Qo;for(Uo=0;Uo<Bo;++Uo){if(Qo=p[Uo],typeof s<"u"){const Po=Qo.controller.getParsed(s)[Qo.controller._cachedMeta.vScale.axis];if(isNullOrUndef(Po)||isNaN(Po))continue}if((Co===!1||Lo.indexOf(Qo.stack)===-1||Co===void 0&&Qo.stack===void 0)&&Lo.push(Qo.stack),Qo.index===o)break}return Lo.length||Lo.push(void 0),Lo}_getStackCount(o){return this._getStacks(void 0,o).length}_getStackIndex(o,s){const c=this._getStacks(o),h=s!==void 0?c.indexOf(s):-1;return h===-1?c.length-1:h}_getRuler(){const o=this,s=o.options,c=o._cachedMeta,h=c.iScale,d=[];let p,Co;for(p=0,Co=c.data.length;p<Co;++p)d.push(h.getPixelForValue(o.getParsed(p)[h.axis],p));const Bo=s.barThickness;return{min:Bo||computeMinSampleSize(h),pixels:d,start:h._startPixel,end:h._endPixel,stackCount:o._getStackCount(),scale:h,grouped:s.grouped,ratio:Bo?1:s.categoryPercentage*s.barPercentage}}_calculateBarValuePixels(o){const s=this,{vScale:c,_stacked:h}=s._cachedMeta,{base:d,minBarLength:p}=s.options,Co=s.getParsed(o),Bo=Co._custom,Lo=isFloatBar(Bo);let Uo=Co[c.axis],Qo=0,Po=h?s.applyStack(c,Co,h):Uo,Mo,Go;Po!==Uo&&(Qo=Po-Uo,Po=Uo),Lo&&(Uo=Bo.barStart,Po=Bo.barEnd-Bo.barStart,Uo!==0&&sign(Uo)!==sign(Bo.barEnd)&&(Qo=0),Qo+=Uo);const $o=!isNullOrUndef(d)&&!Lo?d:Qo;let jo=c.getPixelForValue($o);this.chart.getDataVisibility(o)?Mo=c.getPixelForValue(Qo+Po):Mo=jo,Go=Mo-jo,p!==void 0&&Math.abs(Go)<p&&(Go=Go<0?-p:p,Uo===0&&(jo-=Go/2),Mo=jo+Go);const zo=d||0;if(jo===c.getPixelForValue(zo)){const Xo=c.getLineWidthForValue(zo)/2;Go>0?(jo+=Xo,Go-=Xo):Go<0&&(jo-=Xo,Go+=Xo)}return{size:Go,base:jo,head:Mo,center:Mo+Go/2}}_calculateBarIndexPixels(o,s){const c=this,h=s.scale,d=c.options,p=valueOrDefault(d.maxBarThickness,1/0);let Co,Bo;if(s.grouped){const Lo=d.skipNull?c._getStackCount(o):s.stackCount,Uo=d.barThickness==="flex"?computeFlexCategoryTraits(o,s,d,Lo):computeFitCategoryTraits(o,s,d,Lo),Qo=c._getStackIndex(c.index,c._cachedMeta.stack);Co=Uo.start+Uo.chunk*Qo+Uo.chunk/2,Bo=Math.min(p,Uo.chunk*Uo.ratio)}else Co=h.getPixelForValue(c.getParsed(o)[h.axis],o),Bo=Math.min(p,s.min*s.ratio);return{base:Co-Bo/2,head:Co+Bo/2,center:Co,size:Bo}}draw(){const o=this,s=o.chart,c=o._cachedMeta,h=c.vScale,d=c.data,p=d.length;let Co=0;for(clipArea(s.ctx,s.chartArea);Co<p;++Co)o.getParsed(Co)[h.axis]!==null&&d[Co].draw(o._ctx);unclipArea(s.ctx)}}BarController.id="bar";BarController.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};BarController.overrides={interaction:{mode:"index"},scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class BubbleController extends DatasetController{initialize(){this.enableOptionSharing=!0,super.initialize()}parseObjectData(o,s,c,h){const{xScale:d,yScale:p}=o,{xAxisKey:Co="x",yAxisKey:Bo="y"}=this._parsing,Lo=[];let Uo,Qo,Po;for(Uo=c,Qo=c+h;Uo<Qo;++Uo)Po=s[Uo],Lo.push({x:d.parse(resolveObjectKey(Po,Co),Uo),y:p.parse(resolveObjectKey(Po,Bo),Uo),_custom:Po&&Po.r&&+Po.r});return Lo}getMaxOverflow(){const{data:o,_parsed:s}=this._cachedMeta;let c=0;for(let h=o.length-1;h>=0;--h)c=Math.max(c,o[h].size()/2,s[h]._custom);return c>0&&c}getLabelAndValue(o){const s=this,c=s._cachedMeta,{xScale:h,yScale:d}=c,p=s.getParsed(o),Co=h.getLabelForValue(p.x),Bo=d.getLabelForValue(p.y),Lo=p._custom;return{label:c.label,value:"("+Co+", "+Bo+(Lo?", "+Lo:"")+")"}}update(o){const s=this,c=s._cachedMeta.data;s.updateElements(c,0,c.length,o)}updateElements(o,s,c,h){const d=this,p=h==="reset",{xScale:Co,yScale:Bo}=d._cachedMeta,Lo=d.resolveDataElementOptions(s,h),Uo=d.getSharedOptions(Lo),Qo=d.includeOptions(h,Uo);for(let Po=s;Po<s+c;Po++){const Mo=o[Po],Go=!p&&d.getParsed(Po),$o=p?Co.getPixelForDecimal(.5):Co.getPixelForValue(Go.x),jo=p?Bo.getBasePixel():Bo.getPixelForValue(Go.y),zo={x:$o,y:jo,skip:isNaN($o)||isNaN(jo)};Qo&&(zo.options=d.resolveDataElementOptions(Po,h),p&&(zo.options.radius=0)),d.updateElement(Mo,Po,zo,h)}d.updateSharedOptions(Uo,h,Lo)}resolveDataElementOptions(o,s){const c=this.getParsed(o);let h=super.resolveDataElementOptions(o,s);h.$shared&&(h=Object.assign({},h,{$shared:!1}));const d=h.radius;return s!=="active"&&(h.radius=0),h.radius+=valueOrDefault(c&&c._custom,d),h}}BubbleController.id="bubble";BubbleController.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};BubbleController.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function getRatioAndOffset(l,o,s){let c=1,h=1,d=0,p=0;if(o<TAU){const Co=l,Bo=Co+o,Lo=Math.cos(Co),Uo=Math.sin(Co),Qo=Math.cos(Bo),Po=Math.sin(Bo),Mo=(Zo,Wo,es)=>_angleBetween(Zo,Co,Bo)?1:Math.max(Wo,Wo*s,es,es*s),Go=(Zo,Wo,es)=>_angleBetween(Zo,Co,Bo)?-1:Math.min(Wo,Wo*s,es,es*s),$o=Mo(0,Lo,Qo),jo=Mo(HALF_PI,Uo,Po),zo=Go(PI,Lo,Qo),Xo=Go(PI+HALF_PI,Uo,Po);c=($o-zo)/2,h=(jo-Xo)/2,d=-($o+zo)/2,p=-(jo+Xo)/2}return{ratioX:c,ratioY:h,offsetX:d,offsetY:p}}class DoughnutController extends DatasetController{constructor(o,s){super(o,s),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(o,s){const c=this.getDataset().data,h=this._cachedMeta;let d,p;for(d=o,p=o+s;d<p;++d)h._parsed[d]=+c[d]}_getRotation(){return toRadians(this.options.rotation-90)}_getCircumference(){return toRadians(this.options.circumference)}_getRotationExtents(){let o=TAU,s=-TAU;const c=this;for(let h=0;h<c.chart.data.datasets.length;++h)if(c.chart.isDatasetVisible(h)){const d=c.chart.getDatasetMeta(h).controller,p=d._getRotation(),Co=d._getCircumference();o=Math.min(o,p),s=Math.max(s,p+Co)}return{rotation:o,circumference:s-o}}update(o){const s=this,c=s.chart,{chartArea:h}=c,d=s._cachedMeta,p=d.data,Co=s.getMaxBorderWidth()+s.getMaxOffset(p),Bo=Math.max((Math.min(h.width,h.height)-Co)/2,0),Lo=Math.min(toPercentage(s.options.cutout,Bo),1),Uo=s._getRingWeight(s.index),{circumference:Qo,rotation:Po}=s._getRotationExtents(),{ratioX:Mo,ratioY:Go,offsetX:$o,offsetY:jo}=getRatioAndOffset(Po,Qo,Lo),zo=(h.width-Co)/Mo,Xo=(h.height-Co)/Go,Zo=Math.max(Math.min(zo,Xo)/2,0),Wo=toDimension(s.options.radius,Zo),es=Math.max(Wo*Lo,0),is=(Wo-es)/s._getVisibleDatasetWeightTotal();s.offsetX=$o*Wo,s.offsetY=jo*Wo,d.total=s.calculateTotal(),s.outerRadius=Wo-is*s._getRingWeightOffset(s.index),s.innerRadius=Math.max(s.outerRadius-is*Uo,0),s.updateElements(p,0,p.length,o)}_circumference(o,s){const c=this,h=c.options,d=c._cachedMeta,p=c._getCircumference();return s&&h.animation.animateRotate||!this.chart.getDataVisibility(o)||d._parsed[o]===null?0:c.calculateCircumference(d._parsed[o]*p/TAU)}updateElements(o,s,c,h){const d=this,p=h==="reset",Co=d.chart,Bo=Co.chartArea,Uo=Co.options.animation,Qo=(Bo.left+Bo.right)/2,Po=(Bo.top+Bo.bottom)/2,Mo=p&&Uo.animateScale,Go=Mo?0:d.innerRadius,$o=Mo?0:d.outerRadius,jo=d.resolveDataElementOptions(s,h),zo=d.getSharedOptions(jo),Xo=d.includeOptions(h,zo);let Zo=d._getRotation(),Wo;for(Wo=0;Wo<s;++Wo)Zo+=d._circumference(Wo,p);for(Wo=s;Wo<s+c;++Wo){const es=d._circumference(Wo,p),is=o[Wo],Jo={x:Qo+d.offsetX,y:Po+d.offsetY,startAngle:Zo,endAngle:Zo+es,circumference:es,outerRadius:$o,innerRadius:Go};Xo&&(Jo.options=zo||d.resolveDataElementOptions(Wo,h)),Zo+=es,d.updateElement(is,Wo,Jo,h)}d.updateSharedOptions(zo,h,jo)}calculateTotal(){const o=this._cachedMeta,s=o.data;let c=0,h;for(h=0;h<s.length;h++){const d=o._parsed[h];d!==null&&!isNaN(d)&&this.chart.getDataVisibility(h)&&(c+=Math.abs(d))}return c}calculateCircumference(o){const s=this._cachedMeta.total;return s>0&&!isNaN(o)?TAU*(Math.abs(o)/s):0}getLabelAndValue(o){const s=this,c=s._cachedMeta,h=s.chart,d=h.data.labels||[],p=formatNumber(c._parsed[o],h.options.locale);return{label:d[o]||"",value:p}}getMaxBorderWidth(o){const s=this;let c=0;const h=s.chart;let d,p,Co,Bo,Lo;if(!o){for(d=0,p=h.data.datasets.length;d<p;++d)if(h.isDatasetVisible(d)){Co=h.getDatasetMeta(d),o=Co.data,Bo=Co.controller,Bo!==s&&Bo.configure();break}}if(!o)return 0;for(d=0,p=o.length;d<p;++d)Lo=Bo.resolveDataElementOptions(d),Lo.borderAlign!=="inner"&&(c=Math.max(c,Lo.borderWidth||0,Lo.hoverBorderWidth||0));return c}getMaxOffset(o){let s=0;for(let c=0,h=o.length;c<h;++c){const d=this.resolveDataElementOptions(c);s=Math.max(s,d.offset||0,d.hoverOffset||0)}return s}_getRingWeightOffset(o){let s=0;for(let c=0;c<o;++c)this.chart.isDatasetVisible(c)&&(s+=this._getRingWeight(c));return s}_getRingWeight(o){return Math.max(valueOrDefault(this.chart.data.datasets[o].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}DoughnutController.id="doughnut";DoughnutController.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",indexAxis:"r"};DoughnutController.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(l){const o=l.data;return o.labels.length&&o.datasets.length?o.labels.map((s,c)=>{const d=l.getDatasetMeta(0).controller.getStyle(c);return{text:s,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,lineWidth:d.borderWidth,hidden:!l.getDataVisibility(c),index:c}}):[]}},onClick(l,o,s){s.chart.toggleDataVisibility(o.index),s.chart.update()}},tooltip:{callbacks:{title(){return""},label(l){let o=l.label;const s=": "+l.formattedValue;return isArray(o)?(o=o.slice(),o[0]+=s):o+=s,o}}}}};class LineController extends DatasetController{initialize(){this.enableOptionSharing=!0,super.initialize()}update(o){const s=this,c=s._cachedMeta,{dataset:h,data:d=[],_dataset:p}=c,Co=s.chart._animationsDisabled;let{start:Bo,count:Lo}=getStartAndCountOfVisiblePoints(c,d,Co);s._drawStart=Bo,s._drawCount=Lo,scaleRangesChanged(c)&&(Bo=0,Lo=d.length),h._decimated=!!p._decimated,h.points=d;const Uo=s.resolveDatasetElementOptions(o);s.options.showLine||(Uo.borderWidth=0),Uo.segment=s.options.segment,s.updateElement(h,void 0,{animated:!Co,options:Uo},o),s.updateElements(d,Bo,Lo,o)}updateElements(o,s,c,h){const d=this,p=h==="reset",{xScale:Co,yScale:Bo,_stacked:Lo}=d._cachedMeta,Uo=d.resolveDataElementOptions(s,h),Qo=d.getSharedOptions(Uo),Po=d.includeOptions(h,Qo),Mo=d.options.spanGaps,Go=isNumber(Mo)?Mo:Number.POSITIVE_INFINITY,$o=d.chart._animationsDisabled||p||h==="none";let jo=s>0&&d.getParsed(s-1);for(let zo=s;zo<s+c;++zo){const Xo=o[zo],Zo=d.getParsed(zo),Wo=$o?Xo:{},es=isNullOrUndef(Zo.y),is=Wo.x=Co.getPixelForValue(Zo.x,zo),Jo=Wo.y=p||es?Bo.getBasePixel():Bo.getPixelForValue(Lo?d.applyStack(Bo,Zo,Lo):Zo.y,zo);Wo.skip=isNaN(is)||isNaN(Jo)||es,Wo.stop=zo>0&&Zo.x-jo.x>Go,Wo.parsed=Zo,Po&&(Wo.options=Qo||d.resolveDataElementOptions(zo,h)),$o||d.updateElement(Xo,zo,Wo,h),jo=Zo}d.updateSharedOptions(Qo,h,Uo)}getMaxOverflow(){const o=this,s=o._cachedMeta,c=s.dataset,h=c.options&&c.options.borderWidth||0,d=s.data||[];if(!d.length)return h;const p=d[0].size(o.resolveDataElementOptions(0)),Co=d[d.length-1].size(o.resolveDataElementOptions(d.length-1));return Math.max(h,p,Co)/2}draw(){this._cachedMeta.dataset.updateControlPoints(this.chart.chartArea),super.draw()}}LineController.id="line";LineController.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};LineController.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};function getStartAndCountOfVisiblePoints(l,o,s){const c=o.length;let h=0,d=c;if(l._sorted){const{iScale:p,_parsed:Co}=l,Bo=p.axis,{min:Lo,max:Uo,minDefined:Qo,maxDefined:Po}=p.getUserBounds();Qo&&(h=_limitValue(Math.min(_lookupByKey(Co,p.axis,Lo).lo,s?c:_lookupByKey(o,Bo,p.getPixelForValue(Lo)).lo),0,c-1)),Po?d=_limitValue(Math.max(_lookupByKey(Co,p.axis,Uo).hi+1,s?0:_lookupByKey(o,Bo,p.getPixelForValue(Uo)).hi+1),h,c)-h:d=c-h}return{start:h,count:d}}function scaleRangesChanged(l){const{xScale:o,yScale:s,_scaleRanges:c}=l,h={xmin:o.min,xmax:o.max,ymin:s.min,ymax:s.max};if(!c)return l._scaleRanges=h,!0;const d=c.xmin!==o.min||c.xmax!==o.max||c.ymin!==s.min||c.ymax!==s.max;return Object.assign(c,h),d}class PolarAreaController extends DatasetController{constructor(o,s){super(o,s),this.innerRadius=void 0,this.outerRadius=void 0}update(o){const s=this._cachedMeta.data;this._updateRadius(),this.updateElements(s,0,s.length,o)}_updateRadius(){const o=this,s=o.chart,c=s.chartArea,h=s.options,d=Math.min(c.right-c.left,c.bottom-c.top),p=Math.max(d/2,0),Co=Math.max(h.cutoutPercentage?p/100*h.cutoutPercentage:1,0),Bo=(p-Co)/s.getVisibleDatasetCount();o.outerRadius=p-Bo*o.index,o.innerRadius=o.outerRadius-Bo}updateElements(o,s,c,h){const d=this,p=h==="reset",Co=d.chart,Bo=d.getDataset(),Uo=Co.options.animation,Qo=d._cachedMeta.rScale,Po=Qo.xCenter,Mo=Qo.yCenter,Go=Qo.getIndexAngle(0)-.5*PI;let $o=Go,jo;const zo=360/d.countVisibleElements();for(jo=0;jo<s;++jo)$o+=d._computeAngle(jo,h,zo);for(jo=s;jo<s+c;jo++){const Xo=o[jo];let Zo=$o,Wo=$o+d._computeAngle(jo,h,zo),es=Co.getDataVisibility(jo)?Qo.getDistanceFromCenterForValue(Bo.data[jo]):0;$o=Wo,p&&(Uo.animateScale&&(es=0),Uo.animateRotate&&(Zo=Wo=Go));const is={x:Po,y:Mo,innerRadius:0,outerRadius:es,startAngle:Zo,endAngle:Wo,options:d.resolveDataElementOptions(jo,h)};d.updateElement(Xo,jo,is,h)}}countVisibleElements(){const o=this.getDataset(),s=this._cachedMeta;let c=0;return s.data.forEach((h,d)=>{!isNaN(o.data[d])&&this.chart.getDataVisibility(d)&&c++}),c}_computeAngle(o,s,c){return this.chart.getDataVisibility(o)?toRadians(this.resolveDataElementOptions(o,s).angle||c):0}}PolarAreaController.id="polarArea";PolarAreaController.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};PolarAreaController.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(l){const o=l.data;return o.labels.length&&o.datasets.length?o.labels.map((s,c)=>{const d=l.getDatasetMeta(0).controller.getStyle(c);return{text:s,fillStyle:d.backgroundColor,strokeStyle:d.borderColor,lineWidth:d.borderWidth,hidden:!l.getDataVisibility(c),index:c}}):[]}},onClick(l,o,s){s.chart.toggleDataVisibility(o.index),s.chart.update()}},tooltip:{callbacks:{title(){return""},label(l){return l.chart.data.labels[l.dataIndex]+": "+l.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class PieController extends DoughnutController{}PieController.id="pie";PieController.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class RadarController extends DatasetController{getLabelAndValue(o){const s=this,c=s._cachedMeta.vScale,h=s.getParsed(o);return{label:c.getLabels()[o],value:""+c.getLabelForValue(h[c.axis])}}update(o){const s=this,c=s._cachedMeta,h=c.dataset,d=c.data||[],p=c.iScale.getLabels();if(h.points=d,o!=="resize"){const Co=s.resolveDatasetElementOptions(o);s.options.showLine||(Co.borderWidth=0);const Bo={_loop:!0,_fullLoop:p.length===d.length,options:Co};s.updateElement(h,void 0,Bo,o)}s.updateElements(d,0,d.length,o)}updateElements(o,s,c,h){const d=this,p=d.getDataset(),Co=d._cachedMeta.rScale,Bo=h==="reset";for(let Lo=s;Lo<s+c;Lo++){const Uo=o[Lo],Qo=d.resolveDataElementOptions(Lo,h),Po=Co.getPointPositionForValue(Lo,p.data[Lo]),Mo=Bo?Co.xCenter:Po.x,Go=Bo?Co.yCenter:Po.y,$o={x:Mo,y:Go,angle:Po.angle,skip:isNaN(Mo)||isNaN(Go),options:Qo};d.updateElement(Uo,Lo,$o,h)}}}RadarController.id="radar";RadarController.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};RadarController.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class ScatterController extends LineController{}ScatterController.id="scatter";ScatterController.defaults={showLine:!1,fill:!1};ScatterController.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(l){return"("+l.label+", "+l.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};function abstract(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}class DateAdapter{constructor(o){this.options=o||{}}formats(){return abstract()}parse(o,s){return abstract()}format(o,s){return abstract()}add(o,s,c){return abstract()}diff(o,s,c){return abstract()}startOf(o,s,c){return abstract()}endOf(o,s){return abstract()}}DateAdapter.override=function(l){Object.assign(DateAdapter.prototype,l)};var adapters={_date:DateAdapter};function getRelativePosition(l,o){return"native"in l?{x:l.x,y:l.y}:getRelativePosition$1(l,o)}function evaluateAllVisibleItems(l,o){const s=l.getSortedVisibleDatasetMetas();let c,h,d;for(let p=0,Co=s.length;p<Co;++p){({index:c,data:h}=s[p]);for(let Bo=0,Lo=h.length;Bo<Lo;++Bo)d=h[Bo],d.skip||o(d,c,Bo)}}function binarySearch(l,o,s,c){const{controller:h,data:d,_sorted:p}=l,Co=h._cachedMeta.iScale;if(Co&&o===Co.axis&&p&&d.length){const Bo=Co._reversePixels?_rlookupByKey:_lookupByKey;if(c){if(h._sharedOptions){const Lo=d[0],Uo=typeof Lo.getRange=="function"&&Lo.getRange(o);if(Uo){const Qo=Bo(d,o,s-Uo),Po=Bo(d,o,s+Uo);return{lo:Qo.lo,hi:Po.hi}}}}else return Bo(d,o,s)}return{lo:0,hi:d.length-1}}function optimizedEvaluateItems(l,o,s,c,h){const d=l.getSortedVisibleDatasetMetas(),p=s[o];for(let Co=0,Bo=d.length;Co<Bo;++Co){const{index:Lo,data:Uo}=d[Co],{lo:Qo,hi:Po}=binarySearch(d[Co],o,p,h);for(let Mo=Qo;Mo<=Po;++Mo){const Go=Uo[Mo];Go.skip||c(Go,Lo,Mo)}}}function getDistanceMetricForAxis(l){const o=l.indexOf("x")!==-1,s=l.indexOf("y")!==-1;return function(c,h){const d=o?Math.abs(c.x-h.x):0,p=s?Math.abs(c.y-h.y):0;return Math.sqrt(Math.pow(d,2)+Math.pow(p,2))}}function getIntersectItems(l,o,s,c){const h=[];return _isPointInArea(o,l.chartArea,l._minPadding)&&optimizedEvaluateItems(l,s,o,function(p,Co,Bo){p.inRange(o.x,o.y,c)&&h.push({element:p,datasetIndex:Co,index:Bo})},!0),h}function getNearestItems(l,o,s,c,h){const d=getDistanceMetricForAxis(s);let p=Number.POSITIVE_INFINITY,Co=[];return _isPointInArea(o,l.chartArea,l._minPadding)&&optimizedEvaluateItems(l,s,o,function(Lo,Uo,Qo){if(c&&!Lo.inRange(o.x,o.y,h))return;const Po=Lo.getCenterPoint(h),Mo=d(o,Po);Mo<p?(Co=[{element:Lo,datasetIndex:Uo,index:Qo}],p=Mo):Mo===p&&Co.push({element:Lo,datasetIndex:Uo,index:Qo})}),Co}function getAxisItems(l,o,s,c){const h=getRelativePosition(o,l),d=[],p=s.axis,Co=p==="x"?"inXRange":"inYRange";let Bo=!1;return evaluateAllVisibleItems(l,(Lo,Uo,Qo)=>{Lo[Co](h[p],c)&&d.push({element:Lo,datasetIndex:Uo,index:Qo}),Lo.inRange(h.x,h.y,c)&&(Bo=!0)}),s.intersect&&!Bo?[]:d}var Interaction={modes:{index(l,o,s,c){const h=getRelativePosition(o,l),d=s.axis||"x",p=s.intersect?getIntersectItems(l,h,d,c):getNearestItems(l,h,d,!1,c),Co=[];return p.length?(l.getSortedVisibleDatasetMetas().forEach(Bo=>{const Lo=p[0].index,Uo=Bo.data[Lo];Uo&&!Uo.skip&&Co.push({element:Uo,datasetIndex:Bo.index,index:Lo})}),Co):[]},dataset(l,o,s,c){const h=getRelativePosition(o,l),d=s.axis||"xy";let p=s.intersect?getIntersectItems(l,h,d,c):getNearestItems(l,h,d,!1,c);if(p.length>0){const Co=p[0].datasetIndex,Bo=l.getDatasetMeta(Co).data;p=[];for(let Lo=0;Lo<Bo.length;++Lo)p.push({element:Bo[Lo],datasetIndex:Co,index:Lo})}return p},point(l,o,s,c){const h=getRelativePosition(o,l),d=s.axis||"xy";return getIntersectItems(l,h,d,c)},nearest(l,o,s,c){const h=getRelativePosition(o,l),d=s.axis||"xy";return getNearestItems(l,h,d,s.intersect,c)},x(l,o,s,c){return s.axis="x",getAxisItems(l,o,s,c)},y(l,o,s,c){return s.axis="y",getAxisItems(l,o,s,c)}}};const STATIC_POSITIONS=["left","top","right","bottom"];function filterByPosition(l,o){return l.filter(s=>s.pos===o)}function filterDynamicPositionByAxis(l,o){return l.filter(s=>STATIC_POSITIONS.indexOf(s.pos)===-1&&s.box.axis===o)}function sortByWeight(l,o){return l.sort((s,c)=>{const h=o?c:s,d=o?s:c;return h.weight===d.weight?h.index-d.index:h.weight-d.weight})}function wrapBoxes(l){const o=[];let s,c,h;for(s=0,c=(l||[]).length;s<c;++s)h=l[s],o.push({index:s,box:h,pos:h.position,horizontal:h.isHorizontal(),weight:h.weight});return o}function setLayoutDims(l,o){let s,c,h;for(s=0,c=l.length;s<c;++s)h=l[s],h.horizontal?(h.width=h.box.fullSize&&o.availableWidth,h.height=o.hBoxMaxHeight):(h.width=o.vBoxMaxWidth,h.height=h.box.fullSize&&o.availableHeight)}function buildLayoutBoxes(l){const o=wrapBoxes(l),s=sortByWeight(o.filter(Lo=>Lo.box.fullSize),!0),c=sortByWeight(filterByPosition(o,"left"),!0),h=sortByWeight(filterByPosition(o,"right")),d=sortByWeight(filterByPosition(o,"top"),!0),p=sortByWeight(filterByPosition(o,"bottom")),Co=filterDynamicPositionByAxis(o,"x"),Bo=filterDynamicPositionByAxis(o,"y");return{fullSize:s,leftAndTop:c.concat(d),rightAndBottom:h.concat(Bo).concat(p).concat(Co),chartArea:filterByPosition(o,"chartArea"),vertical:c.concat(h).concat(Bo),horizontal:d.concat(p).concat(Co)}}function getCombinedMax(l,o,s,c){return Math.max(l[s],o[s])+Math.max(l[c],o[c])}function updateMaxPadding(l,o){l.top=Math.max(l.top,o.top),l.left=Math.max(l.left,o.left),l.bottom=Math.max(l.bottom,o.bottom),l.right=Math.max(l.right,o.right)}function updateDims(l,o,s){const c=s.box,h=l.maxPadding;isObject(s.pos)||(s.size&&(l[s.pos]-=s.size),s.size=s.horizontal?c.height:c.width,l[s.pos]+=s.size),c.getPadding&&updateMaxPadding(h,c.getPadding());const d=Math.max(0,o.outerWidth-getCombinedMax(h,l,"left","right")),p=Math.max(0,o.outerHeight-getCombinedMax(h,l,"top","bottom")),Co=d!==l.w,Bo=p!==l.h;return l.w=d,l.h=p,s.horizontal?{same:Co,other:Bo}:{same:Bo,other:Co}}function handleMaxPadding(l){const o=l.maxPadding;function s(c){const h=Math.max(o[c]-l[c],0);return l[c]+=h,h}l.y+=s("top"),l.x+=s("left"),s("right"),s("bottom")}function getMargins(l,o){const s=o.maxPadding;function c(h){const d={left:0,top:0,right:0,bottom:0};return h.forEach(p=>{d[p]=Math.max(o[p],s[p])}),d}return c(l?["left","right"]:["top","bottom"])}function fitBoxes(l,o,s){const c=[];let h,d,p,Co,Bo,Lo;for(h=0,d=l.length,Bo=0;h<d;++h){p=l[h],Co=p.box,Co.update(p.width||o.w,p.height||o.h,getMargins(p.horizontal,o));const{same:Uo,other:Qo}=updateDims(o,s,p);Bo|=Uo&&c.length,Lo=Lo||Qo,Co.fullSize||c.push(p)}return Bo&&fitBoxes(c,o,s)||Lo}function placeBoxes(l,o,s){const c=s.padding;let h=o.x,d=o.y,p,Co,Bo,Lo;for(p=0,Co=l.length;p<Co;++p)Bo=l[p],Lo=Bo.box,Bo.horizontal?(Lo.left=Lo.fullSize?c.left:o.left,Lo.right=Lo.fullSize?s.outerWidth-c.right:o.left+o.w,Lo.top=d,Lo.bottom=d+Lo.height,Lo.width=Lo.right-Lo.left,d=Lo.bottom):(Lo.left=h,Lo.right=h+Lo.width,Lo.top=Lo.fullSize?c.top:o.top,Lo.bottom=Lo.fullSize?s.outerHeight-c.right:o.top+o.h,Lo.height=Lo.bottom-Lo.top,h=Lo.right);o.x=h,o.y=d}defaults.set("layout",{padding:{top:0,right:0,bottom:0,left:0}});var layouts={addBox(l,o){l.boxes||(l.boxes=[]),o.fullSize=o.fullSize||!1,o.position=o.position||"top",o.weight=o.weight||0,o._layers=o._layers||function(){return[{z:0,draw(s){o.draw(s)}}]},l.boxes.push(o)},removeBox(l,o){const s=l.boxes?l.boxes.indexOf(o):-1;s!==-1&&l.boxes.splice(s,1)},configure(l,o,s){o.fullSize=s.fullSize,o.position=s.position,o.weight=s.weight},update(l,o,s,c){if(!l)return;const h=toPadding(l.options.layout.padding),d=o-h.width,p=s-h.height,Co=buildLayoutBoxes(l.boxes),Bo=Co.vertical,Lo=Co.horizontal;each(l.boxes,Go=>{typeof Go.beforeLayout=="function"&&Go.beforeLayout()});const Uo=Bo.reduce((Go,$o)=>$o.box.options&&$o.box.options.display===!1?Go:Go+1,0)||1,Qo=Object.freeze({outerWidth:o,outerHeight:s,padding:h,availableWidth:d,availableHeight:p,vBoxMaxWidth:d/2/Uo,hBoxMaxHeight:p/2}),Po=Object.assign({},h);updateMaxPadding(Po,toPadding(c));const Mo=Object.assign({maxPadding:Po,w:d,h:p,x:h.left,y:h.top},h);setLayoutDims(Bo.concat(Lo),Qo),fitBoxes(Co.fullSize,Mo,Qo),fitBoxes(Bo,Mo,Qo),fitBoxes(Lo,Mo,Qo)&&fitBoxes(Bo,Mo,Qo),handleMaxPadding(Mo),placeBoxes(Co.leftAndTop,Mo,Qo),Mo.x+=Mo.w,Mo.y+=Mo.h,placeBoxes(Co.rightAndBottom,Mo,Qo),l.chartArea={left:Mo.left,top:Mo.top,right:Mo.left+Mo.w,bottom:Mo.top+Mo.h,height:Mo.h,width:Mo.w},each(Co.chartArea,Go=>{const $o=Go.box;Object.assign($o,l.chartArea),$o.update(Mo.w,Mo.h)})}};class BasePlatform{acquireContext(o,s){}releaseContext(o){return!1}addEventListener(o,s,c){}removeEventListener(o,s,c){}getDevicePixelRatio(){return 1}getMaximumSize(o,s,c,h){return s=Math.max(0,s||o.width),c=c||o.height,{width:s,height:Math.max(0,h?Math.floor(s/h):c)}}isAttached(o){return!0}}class BasicPlatform extends BasePlatform{acquireContext(o){return o&&o.getContext&&o.getContext("2d")||null}}const EXPANDO_KEY="$chartjs",EVENT_TYPES={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},isNullOrEmpty=l=>l===null||l==="";function initCanvas(l,o){const s=l.style,c=l.getAttribute("height"),h=l.getAttribute("width");if(l[EXPANDO_KEY]={initial:{height:c,width:h,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",isNullOrEmpty(h)){const d=readUsedSize(l,"width");d!==void 0&&(l.width=d)}if(isNullOrEmpty(c))if(l.style.height==="")l.height=l.width/(o||2);else{const d=readUsedSize(l,"height");d!==void 0&&(l.height=d)}return l}const eventListenerOptions=supportsEventListenerOptions?{passive:!0}:!1;function addListener(l,o,s){l.addEventListener(o,s,eventListenerOptions)}function removeListener(l,o,s){l.canvas.removeEventListener(o,s,eventListenerOptions)}function fromNativeEvent(l,o){const s=EVENT_TYPES[l.type]||l.type,{x:c,y:h}=getRelativePosition$1(l,o);return{type:s,chart:o,native:l,x:c!==void 0?c:null,y:h!==void 0?h:null}}function createAttachObserver(l,o,s){const c=l.canvas,d=c&&_getParentNode(c)||c,p=new MutationObserver(Co=>{const Bo=_getParentNode(d);Co.forEach(Lo=>{for(let Uo=0;Uo<Lo.addedNodes.length;Uo++){const Qo=Lo.addedNodes[Uo];(Qo===d||Qo===Bo)&&s(Lo.target)}})});return p.observe(document,{childList:!0,subtree:!0}),p}function createDetachObserver(l,o,s){const c=l.canvas,h=c&&_getParentNode(c);if(!h)return;const d=new MutationObserver(p=>{p.forEach(Co=>{for(let Bo=0;Bo<Co.removedNodes.length;Bo++)if(Co.removedNodes[Bo]===c){s();break}})});return d.observe(h,{childList:!0}),d}const drpListeningCharts=new Map;let oldDevicePixelRatio=0;function onWindowResize(){const l=window.devicePixelRatio;l!==oldDevicePixelRatio&&(oldDevicePixelRatio=l,drpListeningCharts.forEach((o,s)=>{s.currentDevicePixelRatio!==l&&o()}))}function listenDevicePixelRatioChanges(l,o){drpListeningCharts.size||window.addEventListener("resize",onWindowResize),drpListeningCharts.set(l,o)}function unlistenDevicePixelRatioChanges(l){drpListeningCharts.delete(l),drpListeningCharts.size||window.removeEventListener("resize",onWindowResize)}function createResizeObserver(l,o,s){const c=l.canvas,h=c&&_getParentNode(c);if(!h)return;const d=throttled((Co,Bo)=>{const Lo=h.clientWidth;s(Co,Bo),Lo<h.clientWidth&&s()},window),p=new ResizeObserver(Co=>{const Bo=Co[0],Lo=Bo.contentRect.width,Uo=Bo.contentRect.height;Lo===0&&Uo===0||d(Lo,Uo)});return p.observe(h),listenDevicePixelRatioChanges(l,d),p}function releaseObserver(l,o,s){s&&s.disconnect(),o==="resize"&&unlistenDevicePixelRatioChanges(l)}function createProxyAndListen(l,o,s){const c=l.canvas,h=throttled(d=>{l.ctx!==null&&s(fromNativeEvent(d,l))},l,d=>{const p=d[0];return[p,p.offsetX,p.offsetY]});return addListener(c,o,h),h}class DomPlatform extends BasePlatform{acquireContext(o,s){const c=o&&o.getContext&&o.getContext("2d");return c&&c.canvas===o?(initCanvas(o,s),c):null}releaseContext(o){const s=o.canvas;if(!s[EXPANDO_KEY])return!1;const c=s[EXPANDO_KEY].initial;["height","width"].forEach(d=>{const p=c[d];isNullOrUndef(p)?s.removeAttribute(d):s.setAttribute(d,p)});const h=c.style||{};return Object.keys(h).forEach(d=>{s.style[d]=h[d]}),s.width=s.width,delete s[EXPANDO_KEY],!0}addEventListener(o,s,c){this.removeEventListener(o,s);const h=o.$proxies||(o.$proxies={}),p={attach:createAttachObserver,detach:createDetachObserver,resize:createResizeObserver}[s]||createProxyAndListen;h[s]=p(o,s,c)}removeEventListener(o,s){const c=o.$proxies||(o.$proxies={}),h=c[s];if(!h)return;({attach:releaseObserver,detach:releaseObserver,resize:releaseObserver}[s]||removeListener)(o,s,h),c[s]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(o,s,c,h){return getMaximumSize(o,s,c,h)}isAttached(o){const s=_getParentNode(o);return!!(s&&_getParentNode(s))}}class Element$1{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(o){const{x:s,y:c}=this.getProps(["x","y"],o);return{x:s,y:c}}hasValue(){return isNumber(this.x)&&isNumber(this.y)}getProps(o,s){const c=this,h=this.$animations;if(!s||!h)return c;const d={};return o.forEach(p=>{d[p]=h[p]&&h[p].active()?h[p]._to:c[p]}),d}}Element$1.defaults={};Element$1.defaultRoutes=void 0;const formatters={values(l){return isArray(l)?l:""+l},numeric(l,o,s){if(l===0)return"0";const c=this.chart.options.locale;let h,d=l;if(s.length>1){const Lo=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(Lo<1e-4||Lo>1e15)&&(h="scientific"),d=calculateDelta(l,s)}const p=log10(Math.abs(d)),Co=Math.max(Math.min(-1*Math.floor(p),20),0),Bo={notation:h,minimumFractionDigits:Co,maximumFractionDigits:Co};return Object.assign(Bo,this.options.ticks.format),formatNumber(l,c,Bo)},logarithmic(l,o,s){if(l===0)return"0";const c=l/Math.pow(10,Math.floor(log10(l)));return c===1||c===2||c===5?formatters.numeric.call(this,l,o,s):""}};function calculateDelta(l,o){let s=o.length>3?o[2].value-o[1].value:o[1].value-o[0].value;return Math.abs(s)>1&&l!==Math.floor(l)&&(s=l-Math.floor(l)),s}var Ticks={formatters};defaults.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(l,o)=>o.lineWidth,tickColor:(l,o)=>o.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ticks.formatters.values,minor:{},major:{},align:"center",crossAlign:"near"}});defaults.route("scale.ticks","color","","color");defaults.route("scale.grid","color","","borderColor");defaults.route("scale.grid","borderColor","","borderColor");defaults.route("scale.title","color","","color");defaults.describe("scale",{_fallback:!1,_scriptable:l=>!l.startsWith("before")&&!l.startsWith("after")&&l!=="callback"&&l!=="parser",_indexable:l=>l!=="borderDash"&&l!=="tickBorderDash"});defaults.describe("scales",{_fallback:"scale"});function autoSkip(l,o){const s=l.options.ticks,c=s.maxTicksLimit||determineMaxTicks(l),h=s.major.enabled?getMajorIndices(o):[],d=h.length,p=h[0],Co=h[d-1],Bo=[];if(d>c)return skipMajors(o,Bo,h,d/c),Bo;const Lo=calculateSpacing(h,o,c);if(d>0){let Uo,Qo;const Po=d>1?Math.round((Co-p)/(d-1)):null;for(skip(o,Bo,Lo,isNullOrUndef(Po)?0:p-Po,p),Uo=0,Qo=d-1;Uo<Qo;Uo++)skip(o,Bo,Lo,h[Uo],h[Uo+1]);return skip(o,Bo,Lo,Co,isNullOrUndef(Po)?o.length:Co+Po),Bo}return skip(o,Bo,Lo),Bo}function determineMaxTicks(l){const o=l.options.offset,s=l._tickSize(),c=l._length/s+(o?0:1),h=l._maxLength/s;return Math.floor(Math.min(c,h))}function calculateSpacing(l,o,s){const c=getEvenSpacing(l),h=o.length/s;if(!c)return Math.max(h,1);const d=_factorize(c);for(let p=0,Co=d.length-1;p<Co;p++){const Bo=d[p];if(Bo>h)return Bo}return Math.max(h,1)}function getMajorIndices(l){const o=[];let s,c;for(s=0,c=l.length;s<c;s++)l[s].major&&o.push(s);return o}function skipMajors(l,o,s,c){let h=0,d=s[0],p;for(c=Math.ceil(c),p=0;p<l.length;p++)p===d&&(o.push(l[p]),h++,d=s[h*c])}function skip(l,o,s,c,h){const d=valueOrDefault(c,0),p=Math.min(valueOrDefault(h,l.length),l.length);let Co=0,Bo,Lo,Uo;for(s=Math.ceil(s),h&&(Bo=h-c,s=Bo/Math.floor(Bo/s)),Uo=d;Uo<0;)Co++,Uo=Math.round(d+Co*s);for(Lo=Math.max(d,0);Lo<p;Lo++)Lo===Uo&&(o.push(l[Lo]),Co++,Uo=Math.round(d+Co*s))}function getEvenSpacing(l){const o=l.length;let s,c;if(o<2)return!1;for(c=l[0],s=1;s<o;++s)if(l[s]-l[s-1]!==c)return!1;return c}const reverseAlign=l=>l==="left"?"right":l==="right"?"left":l,offsetFromEdge=(l,o,s)=>o==="top"||o==="left"?l[o]+s:l[o]-s;function sample(l,o){const s=[],c=l.length/o,h=l.length;let d=0;for(;d<h;d+=c)s.push(l[Math.floor(d)]);return s}function getPixelForGridLine(l,o,s){const c=l.ticks.length,h=Math.min(o,c-1),d=l._startPixel,p=l._endPixel,Co=1e-6;let Bo=l.getPixelForTick(h),Lo;if(!(s&&(c===1?Lo=Math.max(Bo-d,p-Bo):o===0?Lo=(l.getPixelForTick(1)-Bo)/2:Lo=(Bo-l.getPixelForTick(h-1))/2,Bo+=h<o?Lo:-Lo,Bo<d-Co||Bo>p+Co)))return Bo}function garbageCollect(l,o){each(l,s=>{const c=s.gc,h=c.length/2;let d;if(h>o){for(d=0;d<h;++d)delete s.data[c[d]];c.splice(0,h)}})}function getTickMarkLength(l){return l.drawTicks?l.tickLength:0}function getTitleHeight(l,o){if(!l.display)return 0;const s=toFont(l.font,o),c=toPadding(l.padding);return(isArray(l.text)?l.text.length:1)*s.lineHeight+c.height}function createScaleContext(l,o){return Object.assign(Object.create(l),{scale:o,type:"scale"})}function createTickContext(l,o,s){return Object.assign(Object.create(l),{tick:s,index:o,type:"tick"})}function titleAlign(l,o,s){let c=_toLeftRightCenter(l);return(s&&o!=="right"||!s&&o==="right")&&(c=reverseAlign(c)),c}function titleArgs(l,o,s,c){const{top:h,left:d,bottom:p,right:Co}=l;let Bo=0,Lo,Uo,Qo;return l.isHorizontal()?(Uo=_alignStartEnd(c,d,Co),Qo=offsetFromEdge(l,s,o),Lo=Co-d):(Uo=offsetFromEdge(l,s,o),Qo=_alignStartEnd(c,p,h),Bo=s==="left"?-HALF_PI:HALF_PI),{titleX:Uo,titleY:Qo,maxWidth:Lo,rotation:Bo}}class Scale extends Element$1{constructor(o){super(),this.id=o.id,this.type=o.type,this.options=void 0,this.ctx=o.ctx,this.chart=o.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(o){const s=this;s.options=o.setContext(s.getContext()),s.axis=o.axis,s._userMin=s.parse(o.min),s._userMax=s.parse(o.max),s._suggestedMin=s.parse(o.suggestedMin),s._suggestedMax=s.parse(o.suggestedMax)}parse(o,s){return o}getUserBounds(){let{_userMin:o,_userMax:s,_suggestedMin:c,_suggestedMax:h}=this;return o=finiteOrDefault(o,Number.POSITIVE_INFINITY),s=finiteOrDefault(s,Number.NEGATIVE_INFINITY),c=finiteOrDefault(c,Number.POSITIVE_INFINITY),h=finiteOrDefault(h,Number.NEGATIVE_INFINITY),{min:finiteOrDefault(o,c),max:finiteOrDefault(s,h),minDefined:isNumberFinite(o),maxDefined:isNumberFinite(s)}}getMinMax(o){const s=this;let{min:c,max:h,minDefined:d,maxDefined:p}=s.getUserBounds(),Co;if(d&&p)return{min:c,max:h};const Bo=s.getMatchingVisibleMetas();for(let Lo=0,Uo=Bo.length;Lo<Uo;++Lo)Co=Bo[Lo].controller.getMinMax(s,o),d||(c=Math.min(c,Co.min)),p||(h=Math.max(h,Co.max));return{min:finiteOrDefault(c,finiteOrDefault(h,c)),max:finiteOrDefault(h,finiteOrDefault(c,h))}}getPadding(){const o=this;return{left:o.paddingLeft||0,top:o.paddingTop||0,right:o.paddingRight||0,bottom:o.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const o=this.chart.data;return this.options.labels||(this.isHorizontal()?o.xLabels:o.yLabels)||o.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){callback(this.options.beforeUpdate,[this])}update(o,s,c){const h=this,d=h.options.ticks,p=d.sampleSize;h.beforeUpdate(),h.maxWidth=o,h.maxHeight=s,h._margins=c=Object.assign({left:0,right:0,top:0,bottom:0},c),h.ticks=null,h._labelSizes=null,h._gridLineItems=null,h._labelItems=null,h.beforeSetDimensions(),h.setDimensions(),h.afterSetDimensions(),h._maxLength=h.isHorizontal()?h.width+c.left+c.right:h.height+c.top+c.bottom,h._dataLimitsCached||(h.beforeDataLimits(),h.determineDataLimits(),h.afterDataLimits(),h._dataLimitsCached=!0),h.beforeBuildTicks(),h.ticks=h.buildTicks()||[],h.afterBuildTicks();const Co=p<h.ticks.length;h._convertTicksToLabels(Co?sample(h.ticks,p):h.ticks),h.configure(),h.beforeCalculateLabelRotation(),h.calculateLabelRotation(),h.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(h.ticks=autoSkip(h,h.ticks),h._labelSizes=null),Co&&h._convertTicksToLabels(h.ticks),h.beforeFit(),h.fit(),h.afterFit(),h.afterUpdate()}configure(){const o=this;let s=o.options.reverse,c,h;o.isHorizontal()?(c=o.left,h=o.right):(c=o.top,h=o.bottom,s=!s),o._startPixel=c,o._endPixel=h,o._reversePixels=s,o._length=h-c,o._alignToPixels=o.options.alignToPixels}afterUpdate(){callback(this.options.afterUpdate,[this])}beforeSetDimensions(){callback(this.options.beforeSetDimensions,[this])}setDimensions(){const o=this;o.isHorizontal()?(o.width=o.maxWidth,o.left=0,o.right=o.width):(o.height=o.maxHeight,o.top=0,o.bottom=o.height),o.paddingLeft=0,o.paddingTop=0,o.paddingRight=0,o.paddingBottom=0}afterSetDimensions(){callback(this.options.afterSetDimensions,[this])}_callHooks(o){const s=this;s.chart.notifyPlugins(o,s.getContext()),callback(s.options[o],[s])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){callback(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(o){const s=this,c=s.options.ticks;let h,d,p;for(h=0,d=o.length;h<d;h++)p=o[h],p.label=callback(c.callback,[p.value,h,o],s)}afterTickToLabelConversion(){callback(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){callback(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const o=this,s=o.options,c=s.ticks,h=o.ticks.length,d=c.minRotation||0,p=c.maxRotation;let Co=d,Bo,Lo,Uo;if(!o._isVisible()||!c.display||d>=p||h<=1||!o.isHorizontal()){o.labelRotation=d;return}const Qo=o._getLabelSizes(),Po=Qo.widest.width,Mo=Qo.highest.height,Go=_limitValue(o.chart.width-Po,0,o.maxWidth);Bo=s.offset?o.maxWidth/h:Go/(h-1),Po+6>Bo&&(Bo=Go/(h-(s.offset?.5:1)),Lo=o.maxHeight-getTickMarkLength(s.grid)-c.padding-getTitleHeight(s.title,o.chart.options.font),Uo=Math.sqrt(Po*Po+Mo*Mo),Co=toDegrees(Math.min(Math.asin(Math.min((Qo.highest.height+6)/Bo,1)),Math.asin(Math.min(Lo/Uo,1))-Math.asin(Mo/Uo))),Co=Math.max(d,Math.min(p,Co))),o.labelRotation=Co}afterCalculateLabelRotation(){callback(this.options.afterCalculateLabelRotation,[this])}beforeFit(){callback(this.options.beforeFit,[this])}fit(){const o=this,s={width:0,height:0},{chart:c,options:{ticks:h,title:d,grid:p}}=o,Co=o._isVisible(),Bo=o.isHorizontal();if(Co){const Lo=getTitleHeight(d,c.options.font);if(Bo?(s.width=o.maxWidth,s.height=getTickMarkLength(p)+Lo):(s.height=o.maxHeight,s.width=getTickMarkLength(p)+Lo),h.display&&o.ticks.length){const{first:Uo,last:Qo,widest:Po,highest:Mo}=o._getLabelSizes(),Go=h.padding*2,$o=toRadians(o.labelRotation),jo=Math.cos($o),zo=Math.sin($o);if(Bo){const Xo=h.mirror?0:zo*Po.width+jo*Mo.height;s.height=Math.min(o.maxHeight,s.height+Xo+Go)}else{const Xo=h.mirror?0:jo*Po.width+zo*Mo.height;s.width=Math.min(o.maxWidth,s.width+Xo+Go)}o._calculatePadding(Uo,Qo,zo,jo)}}o._handleMargins(),Bo?(o.width=o._length=c.width-o._margins.left-o._margins.right,o.height=s.height):(o.width=s.width,o.height=o._length=c.height-o._margins.top-o._margins.bottom)}_calculatePadding(o,s,c,h){const d=this,{ticks:{align:p,padding:Co},position:Bo}=d.options,Lo=d.labelRotation!==0,Uo=Bo!=="top"&&d.axis==="x";if(d.isHorizontal()){const Qo=d.getPixelForTick(0)-d.left,Po=d.right-d.getPixelForTick(d.ticks.length-1);let Mo=0,Go=0;Lo?Uo?(Mo=h*o.width,Go=c*s.height):(Mo=c*o.height,Go=h*s.width):p==="start"?Go=s.width:p==="end"?Mo=o.width:(Mo=o.width/2,Go=s.width/2),d.paddingLeft=Math.max((Mo-Qo+Co)*d.width/(d.width-Qo),0),d.paddingRight=Math.max((Go-Po+Co)*d.width/(d.width-Po),0)}else{let Qo=s.height/2,Po=o.height/2;p==="start"?(Qo=0,Po=o.height):p==="end"&&(Qo=s.height,Po=0),d.paddingTop=Qo+Co,d.paddingBottom=Po+Co}}_handleMargins(){const o=this;o._margins&&(o._margins.left=Math.max(o.paddingLeft,o._margins.left),o._margins.top=Math.max(o.paddingTop,o._margins.top),o._margins.right=Math.max(o.paddingRight,o._margins.right),o._margins.bottom=Math.max(o.paddingBottom,o._margins.bottom))}afterFit(){callback(this.options.afterFit,[this])}isHorizontal(){const{axis:o,position:s}=this.options;return s==="top"||s==="bottom"||o==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(o){const s=this;s.beforeTickToLabelConversion(),s.generateTickLabels(o),s.afterTickToLabelConversion()}_getLabelSizes(){const o=this;let s=o._labelSizes;if(!s){const c=o.options.ticks.sampleSize;let h=o.ticks;c<h.length&&(h=sample(h,c)),o._labelSizes=s=o._computeLabelSizes(h,h.length)}return s}_computeLabelSizes(o,s){const{ctx:c,_longestTextCache:h}=this,d=[],p=[];let Co=0,Bo=0,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo;for(Lo=0;Lo<s;++Lo){if(Po=o[Lo].label,Mo=this._resolveTickFontOptions(Lo),c.font=Go=Mo.string,$o=h[Go]=h[Go]||{data:{},gc:[]},jo=Mo.lineHeight,zo=Xo=0,!isNullOrUndef(Po)&&!isArray(Po))zo=_measureText(c,$o.data,$o.gc,zo,Po),Xo=jo;else if(isArray(Po))for(Uo=0,Qo=Po.length;Uo<Qo;++Uo)Zo=Po[Uo],!isNullOrUndef(Zo)&&!isArray(Zo)&&(zo=_measureText(c,$o.data,$o.gc,zo,Zo),Xo+=jo);d.push(zo),p.push(Xo),Co=Math.max(zo,Co),Bo=Math.max(Xo,Bo)}garbageCollect(h,s);const Wo=d.indexOf(Co),es=p.indexOf(Bo),is=Jo=>({width:d[Jo]||0,height:p[Jo]||0});return{first:is(0),last:is(s-1),widest:is(Wo),highest:is(es)}}getLabelForValue(o){return o}getPixelForValue(o,s){return NaN}getValueForPixel(o){}getPixelForTick(o){const s=this.ticks;return o<0||o>s.length-1?null:this.getPixelForValue(s[o].value)}getPixelForDecimal(o){const s=this;s._reversePixels&&(o=1-o);const c=s._startPixel+o*s._length;return _int16Range(s._alignToPixels?_alignPixel(s.chart,c,0):c)}getDecimalForPixel(o){const s=(o-this._startPixel)/this._length;return this._reversePixels?1-s:s}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:o,max:s}=this;return o<0&&s<0?s:o>0&&s>0?o:0}getContext(o){const s=this,c=s.ticks||[];if(o>=0&&o<c.length){const h=c[o];return h.$context||(h.$context=createTickContext(s.getContext(),o,h))}return s.$context||(s.$context=createScaleContext(s.chart.getContext(),s))}_tickSize(){const o=this,s=o.options.ticks,c=toRadians(o.labelRotation),h=Math.abs(Math.cos(c)),d=Math.abs(Math.sin(c)),p=o._getLabelSizes(),Co=s.autoSkipPadding||0,Bo=p?p.widest.width+Co:0,Lo=p?p.highest.height+Co:0;return o.isHorizontal()?Lo*h>Bo*d?Bo/h:Lo/d:Lo*d<Bo*h?Lo/h:Bo/d}_isVisible(){const o=this.options.display;return o!=="auto"?!!o:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(o){const s=this,c=s.axis,h=s.chart,d=s.options,{grid:p,position:Co}=d,Bo=p.offset,Lo=s.isHorizontal(),Qo=s.ticks.length+(Bo?1:0),Po=getTickMarkLength(p),Mo=[],Go=p.setContext(s.getContext(0)),$o=Go.drawBorder?Go.borderWidth:0,jo=$o/2,zo=function(us){return _alignPixel(h,us,$o)};let Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as;if(Co==="top")Xo=zo(s.bottom),Jo=s.bottom-Po,Yo=Xo-jo,ss=zo(o.top)+jo,as=o.bottom;else if(Co==="bottom")Xo=zo(s.top),ss=o.top,as=zo(o.bottom)-jo,Jo=Xo+jo,Yo=s.top+Po;else if(Co==="left")Xo=zo(s.right),is=s.right-Po,Ko=Xo-jo,ts=zo(o.left)+jo,cs=o.right;else if(Co==="right")Xo=zo(s.left),ts=o.left,cs=zo(o.right)-jo,is=Xo+jo,Ko=s.left+Po;else if(c==="x"){if(Co==="center")Xo=zo((o.top+o.bottom)/2+.5);else if(isObject(Co)){const us=Object.keys(Co)[0],gs=Co[us];Xo=zo(s.chart.scales[us].getPixelForValue(gs))}ss=o.top,as=o.bottom,Jo=Xo+jo,Yo=Jo+Po}else if(c==="y"){if(Co==="center")Xo=zo((o.left+o.right)/2);else if(isObject(Co)){const us=Object.keys(Co)[0],gs=Co[us];Xo=zo(s.chart.scales[us].getPixelForValue(gs))}is=Xo-jo,Ko=is-Po,ts=o.left,cs=o.right}for(Zo=0;Zo<Qo;++Zo){const us=p.setContext(s.getContext(Zo)),gs=us.lineWidth,Is=us.color,_s=p.borderDash||[],Hs=us.borderDashOffset,ds=us.tickWidth,hs=us.tickColor,ys=us.tickBorderDash||[],ms=us.tickBorderDashOffset;Wo=getPixelForGridLine(s,Zo,Bo),Wo!==void 0&&(es=_alignPixel(h,Wo,gs),Lo?is=Ko=ts=cs=es:Jo=Yo=ss=as=es,Mo.push({tx1:is,ty1:Jo,tx2:Ko,ty2:Yo,x1:ts,y1:ss,x2:cs,y2:as,width:gs,color:Is,borderDash:_s,borderDashOffset:Hs,tickWidth:ds,tickColor:hs,tickBorderDash:ys,tickBorderDashOffset:ms}))}return s._ticksLength=Qo,s._borderValue=Xo,Mo}_computeLabelItems(o){const s=this,c=s.axis,h=s.options,{position:d,ticks:p}=h,Co=s.isHorizontal(),Bo=s.ticks,{align:Lo,crossAlign:Uo,padding:Qo,mirror:Po}=p,Mo=getTickMarkLength(h.grid),Go=Mo+Qo,$o=Po?-Qo:Go,jo=-toRadians(s.labelRotation),zo=[];let Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us="middle";if(d==="top")Jo=s.bottom-$o,Ko=s._getXAxisLabelAlignment();else if(d==="bottom")Jo=s.top+$o,Ko=s._getXAxisLabelAlignment();else if(d==="left"){const Is=s._getYAxisLabelAlignment(Mo);Ko=Is.textAlign,is=Is.x}else if(d==="right"){const Is=s._getYAxisLabelAlignment(Mo);Ko=Is.textAlign,is=Is.x}else if(c==="x"){if(d==="center")Jo=(o.top+o.bottom)/2+Go;else if(isObject(d)){const Is=Object.keys(d)[0],_s=d[Is];Jo=s.chart.scales[Is].getPixelForValue(_s)+Go}Ko=s._getXAxisLabelAlignment()}else if(c==="y"){if(d==="center")is=(o.left+o.right)/2-Go;else if(isObject(d)){const Is=Object.keys(d)[0],_s=d[Is];is=s.chart.scales[Is].getPixelForValue(_s)}Ko=s._getYAxisLabelAlignment(Mo).textAlign}c==="y"&&(Lo==="start"?us="top":Lo==="end"&&(us="bottom"));const gs=s._getLabelSizes();for(Xo=0,Zo=Bo.length;Xo<Zo;++Xo){Wo=Bo[Xo],es=Wo.label;const Is=p.setContext(s.getContext(Xo));Yo=s.getPixelForTick(Xo)+p.labelOffset,ts=s._resolveTickFontOptions(Xo),ss=ts.lineHeight,cs=isArray(es)?es.length:1;const _s=cs/2,Hs=Is.color,ds=Is.textStrokeColor,hs=Is.textStrokeWidth;Co?(is=Yo,d==="top"?Uo==="near"||jo!==0?as=-cs*ss+ss/2:Uo==="center"?as=-gs.highest.height/2-_s*ss+ss:as=-gs.highest.height+ss/2:Uo==="near"||jo!==0?as=ss/2:Uo==="center"?as=gs.highest.height/2-_s*ss:as=gs.highest.height-cs*ss,Po&&(as*=-1)):(Jo=Yo,as=(1-cs)*ss/2),zo.push({rotation:jo,label:es,font:ts,color:Hs,strokeColor:ds,strokeWidth:hs,textOffset:as,textAlign:Ko,textBaseline:us,translation:[is,Jo]})}return zo}_getXAxisLabelAlignment(){const o=this,{position:s,ticks:c}=o.options;if(-toRadians(o.labelRotation))return s==="top"?"left":"right";let d="center";return c.align==="start"?d="left":c.align==="end"&&(d="right"),d}_getYAxisLabelAlignment(o){const s=this,{position:c,ticks:{crossAlign:h,mirror:d,padding:p}}=s.options,Co=s._getLabelSizes(),Bo=o+p,Lo=Co.widest.width;let Uo,Qo;return c==="left"?d?(Uo="left",Qo=s.right+p):(Qo=s.right-Bo,h==="near"?Uo="right":h==="center"?(Uo="center",Qo-=Lo/2):(Uo="left",Qo=s.left)):c==="right"?d?(Uo="right",Qo=s.left+p):(Qo=s.left+Bo,h==="near"?Uo="left":h==="center"?(Uo="center",Qo+=Lo/2):(Uo="right",Qo=s.right)):Uo="right",{textAlign:Uo,x:Qo}}_computeLabelArea(){const o=this;if(o.options.ticks.mirror)return;const s=o.chart,c=o.options.position;if(c==="left"||c==="right")return{top:0,left:o.left,bottom:s.height,right:o.right};if(c==="top"||c==="bottom")return{top:o.top,left:0,bottom:o.bottom,right:s.width}}drawBackground(){const{ctx:o,options:{backgroundColor:s},left:c,top:h,width:d,height:p}=this;s&&(o.save(),o.fillStyle=s,o.fillRect(c,h,d,p),o.restore())}getLineWidthForValue(o){const s=this,c=s.options.grid;if(!s._isVisible()||!c.display)return 0;const d=s.ticks.findIndex(p=>p.value===o);return d>=0?c.setContext(s.getContext(d)).lineWidth:0}drawGrid(o){const s=this,c=s.options.grid,h=s.ctx,d=s.chart,p=c.setContext(s.getContext()),Co=c.drawBorder?p.borderWidth:0,Bo=s._gridLineItems||(s._gridLineItems=s._computeGridLineItems(o));let Lo,Uo;const Qo=(Po,Mo,Go)=>{!Go.width||!Go.color||(h.save(),h.lineWidth=Go.width,h.strokeStyle=Go.color,h.setLineDash(Go.borderDash||[]),h.lineDashOffset=Go.borderDashOffset,h.beginPath(),h.moveTo(Po.x,Po.y),h.lineTo(Mo.x,Mo.y),h.stroke(),h.restore())};if(c.display)for(Lo=0,Uo=Bo.length;Lo<Uo;++Lo){const Po=Bo[Lo];c.drawOnChartArea&&Qo({x:Po.x1,y:Po.y1},{x:Po.x2,y:Po.y2},Po),c.drawTicks&&Qo({x:Po.tx1,y:Po.ty1},{x:Po.tx2,y:Po.ty2},{color:Po.tickColor,width:Po.tickWidth,borderDash:Po.tickBorderDash,borderDashOffset:Po.tickBorderDashOffset})}if(Co){const Po=p.lineWidth,Mo=s._borderValue;let Go,$o,jo,zo;s.isHorizontal()?(Go=_alignPixel(d,s.left,Co)-Co/2,$o=_alignPixel(d,s.right,Po)+Po/2,jo=zo=Mo):(jo=_alignPixel(d,s.top,Co)-Co/2,zo=_alignPixel(d,s.bottom,Po)+Po/2,Go=$o=Mo),Qo({x:Go,y:jo},{x:$o,y:zo},{width:Co,color:p.borderColor})}}drawLabels(o){const s=this;if(!s.options.ticks.display)return;const h=s.ctx,d=s._computeLabelArea();d&&clipArea(h,d);const p=s._labelItems||(s._labelItems=s._computeLabelItems(o));let Co,Bo;for(Co=0,Bo=p.length;Co<Bo;++Co){const Lo=p[Co],Uo=Lo.font,Qo=Lo.label;let Po=Lo.textOffset;renderText(h,Qo,0,Po,Uo,Lo)}d&&unclipArea(h)}drawTitle(){const{ctx:o,options:{position:s,title:c,reverse:h}}=this;if(!c.display)return;const d=toFont(c.font),p=toPadding(c.padding),Co=c.align;let Bo=d.lineHeight/2;s==="bottom"?(Bo+=p.bottom,isArray(c.text)&&(Bo+=d.lineHeight*(c.text.length-1))):Bo+=p.top;const{titleX:Lo,titleY:Uo,maxWidth:Qo,rotation:Po}=titleArgs(this,Bo,s,Co);renderText(o,c.text,0,0,d,{color:c.color,maxWidth:Qo,rotation:Po,textAlign:titleAlign(Co,s,h),textBaseline:"middle",translation:[Lo,Uo]})}draw(o){const s=this;!s._isVisible()||(s.drawBackground(),s.drawGrid(o),s.drawTitle(),s.drawLabels(o))}_layers(){const o=this,s=o.options,c=s.ticks&&s.ticks.z||0,h=s.grid&&s.grid.z||0;return!o._isVisible()||c===h||o.draw!==Scale.prototype.draw?[{z:c,draw(d){o.draw(d)}}]:[{z:h,draw(d){o.drawBackground(),o.drawGrid(d),o.drawTitle()}},{z:c,draw(d){o.drawLabels(d)}}]}getMatchingVisibleMetas(o){const s=this,c=s.chart.getSortedVisibleDatasetMetas(),h=s.axis+"AxisID",d=[];let p,Co;for(p=0,Co=c.length;p<Co;++p){const Bo=c[p];Bo[h]===s.id&&(!o||Bo.type===o)&&d.push(Bo)}return d}_resolveTickFontOptions(o){const s=this.options.ticks.setContext(this.getContext(o));return toFont(s.font)}}class TypedRegistry{constructor(o,s,c){this.type=o,this.scope=s,this.override=c,this.items=Object.create(null)}isForType(o){return Object.prototype.isPrototypeOf.call(this.type.prototype,o.prototype)}register(o){const s=this,c=Object.getPrototypeOf(o);let h;isIChartComponent(c)&&(h=s.register(c));const d=s.items,p=o.id,Co=s.scope+"."+p;if(!p)throw new Error("class does not have id: "+o);return p in d||(d[p]=o,registerDefaults(o,Co,h),s.override&&defaults.override(o.id,o.overrides)),Co}get(o){return this.items[o]}unregister(o){const s=this.items,c=o.id,h=this.scope;c in s&&delete s[c],h&&c in defaults[h]&&(delete defaults[h][c],this.override&&delete overrides[c])}}function registerDefaults(l,o,s){const c=merge(Object.create(null),[s?defaults.get(s):{},defaults.get(o),l.defaults]);defaults.set(o,c),l.defaultRoutes&&routeDefaults(o,l.defaultRoutes),l.descriptors&&defaults.describe(o,l.descriptors)}function routeDefaults(l,o){Object.keys(o).forEach(s=>{const c=s.split("."),h=c.pop(),d=[l].concat(c).join("."),p=o[s].split("."),Co=p.pop(),Bo=p.join(".");defaults.route(d,h,Bo,Co)})}function isIChartComponent(l){return"id"in l&&"defaults"in l}class Registry{constructor(){this.controllers=new TypedRegistry(DatasetController,"datasets",!0),this.elements=new TypedRegistry(Element$1,"elements"),this.plugins=new TypedRegistry(Object,"plugins"),this.scales=new TypedRegistry(Scale,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...o){this._each("register",o)}remove(...o){this._each("unregister",o)}addControllers(...o){this._each("register",o,this.controllers)}addElements(...o){this._each("register",o,this.elements)}addPlugins(...o){this._each("register",o,this.plugins)}addScales(...o){this._each("register",o,this.scales)}getController(o){return this._get(o,this.controllers,"controller")}getElement(o){return this._get(o,this.elements,"element")}getPlugin(o){return this._get(o,this.plugins,"plugin")}getScale(o){return this._get(o,this.scales,"scale")}removeControllers(...o){this._each("unregister",o,this.controllers)}removeElements(...o){this._each("unregister",o,this.elements)}removePlugins(...o){this._each("unregister",o,this.plugins)}removeScales(...o){this._each("unregister",o,this.scales)}_each(o,s,c){const h=this;[...s].forEach(d=>{const p=c||h._getRegistryForType(d);c||p.isForType(d)||p===h.plugins&&d.id?h._exec(o,p,d):each(d,Co=>{const Bo=c||h._getRegistryForType(Co);h._exec(o,Bo,Co)})})}_exec(o,s,c){const h=_capitalize(o);callback(c["before"+h],[],c),s[o](c),callback(c["after"+h],[],c)}_getRegistryForType(o){for(let s=0;s<this._typedRegistries.length;s++){const c=this._typedRegistries[s];if(c.isForType(o))return c}return this.plugins}_get(o,s,c){const h=s.get(o);if(h===void 0)throw new Error('"'+o+'" is not a registered '+c+".");return h}}var registry=new Registry;class PluginService{constructor(){this._init=[]}notify(o,s,c,h){const d=this;s==="beforeInit"&&(d._init=d._createDescriptors(o,!0),d._notify(d._init,o,"install"));const p=h?d._descriptors(o).filter(h):d._descriptors(o),Co=d._notify(p,o,s,c);return s==="destroy"&&(d._notify(p,o,"stop"),d._notify(d._init,o,"uninstall")),Co}_notify(o,s,c,h){h=h||{};for(const d of o){const p=d.plugin,Co=p[c],Bo=[s,h,d.options];if(callback(Co,Bo,p)===!1&&h.cancelable)return!1}return!0}invalidate(){isNullOrUndef(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(o){if(this._cache)return this._cache;const s=this._cache=this._createDescriptors(o);return this._notifyStateChanges(o),s}_createDescriptors(o,s){const c=o&&o.config,h=valueOrDefault(c.options&&c.options.plugins,{}),d=allPlugins(c);return h===!1&&!s?[]:createDescriptors(o,d,h,s)}_notifyStateChanges(o){const s=this._oldCache||[],c=this._cache,h=(d,p)=>d.filter(Co=>!p.some(Bo=>Co.plugin.id===Bo.plugin.id));this._notify(h(s,c),o,"stop"),this._notify(h(c,s),o,"start")}}function allPlugins(l){const o=[],s=Object.keys(registry.plugins.items);for(let h=0;h<s.length;h++)o.push(registry.getPlugin(s[h]));const c=l.plugins||[];for(let h=0;h<c.length;h++){const d=c[h];o.indexOf(d)===-1&&o.push(d)}return o}function getOpts(l,o){return!o&&l===!1?null:l===!0?{}:l}function createDescriptors(l,o,s,c){const h=[],d=l.getContext();for(let p=0;p<o.length;p++){const Co=o[p],Bo=Co.id,Lo=getOpts(s[Bo],c);Lo!==null&&h.push({plugin:Co,options:pluginOpts(l.config,Co,Lo,d)})}return h}function pluginOpts(l,o,s,c){const h=l.pluginScopeKeys(o),d=l.getOptionScopes(s,h);return l.createResolver(d,c,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function getIndexAxis(l,o){const s=defaults.datasets[l]||{};return((o.datasets||{})[l]||{}).indexAxis||o.indexAxis||s.indexAxis||"x"}function getAxisFromDefaultScaleID(l,o){let s=l;return l==="_index_"?s=o:l==="_value_"&&(s=o==="x"?"y":"x"),s}function getDefaultScaleIDFromAxis(l,o){return l===o?"_index_":"_value_"}function axisFromPosition(l){if(l==="top"||l==="bottom")return"x";if(l==="left"||l==="right")return"y"}function determineAxis(l,o){return l==="x"||l==="y"?l:o.axis||axisFromPosition(o.position)||l.charAt(0).toLowerCase()}function mergeScaleConfig(l,o){const s=overrides[l.type]||{scales:{}},c=o.scales||{},h=getIndexAxis(l.type,o),d=Object.create(null),p=Object.create(null);return Object.keys(c).forEach(Co=>{const Bo=c[Co],Lo=determineAxis(Co,Bo),Uo=getDefaultScaleIDFromAxis(Lo,h),Qo=s.scales||{};d[Lo]=d[Lo]||Co,p[Co]=mergeIf(Object.create(null),[{axis:Lo},Bo,Qo[Lo],Qo[Uo]])}),l.data.datasets.forEach(Co=>{const Bo=Co.type||l.type,Lo=Co.indexAxis||getIndexAxis(Bo,o),Qo=(overrides[Bo]||{}).scales||{};Object.keys(Qo).forEach(Po=>{const Mo=getAxisFromDefaultScaleID(Po,Lo),Go=Co[Mo+"AxisID"]||d[Mo]||Mo;p[Go]=p[Go]||Object.create(null),mergeIf(p[Go],[{axis:Mo},c[Go],Qo[Po]])})}),Object.keys(p).forEach(Co=>{const Bo=p[Co];mergeIf(Bo,[defaults.scales[Bo.type],defaults.scale])}),p}function initOptions(l){const o=l.options||(l.options={});o.plugins=valueOrDefault(o.plugins,{}),o.scales=mergeScaleConfig(l,o)}function initConfig(l){l=l||{};const o=l.data=l.data||{datasets:[],labels:[]};return o.datasets=o.datasets||[],o.labels=o.labels||[],initOptions(l),l}const keyCache=new Map,keysCached=new Set;function cachedKeys(l,o){let s=keyCache.get(l);return s||(s=o(),keyCache.set(l,s),keysCached.add(s)),s}const addIfFound=(l,o,s)=>{const c=resolveObjectKey(o,s);c!==void 0&&l.add(c)};class Config{constructor(o){this._config=initConfig(o),this._scopeCache=new Map,this._resolverCache=new Map}get type(){return this._config.type}set type(o){this._config.type=o}get data(){return this._config.data}set data(o){this._config.data=o}get options(){return this._config.options}set options(o){this._config.options=o}get plugins(){return this._config.plugins}update(){const o=this._config;this.clearCache(),initOptions(o)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(o){return cachedKeys(o,()=>[[`datasets.${o}`,""]])}datasetAnimationScopeKeys(o,s){return cachedKeys(`${o}.transition.${s}`,()=>[[`datasets.${o}.transitions.${s}`,`transitions.${s}`],[`datasets.${o}`,""]])}datasetElementScopeKeys(o,s){return cachedKeys(`${o}-${s}`,()=>[[`datasets.${o}.elements.${s}`,`datasets.${o}`,`elements.${s}`,""]])}pluginScopeKeys(o){const s=o.id,c=this.type;return cachedKeys(`${c}-plugin-${s}`,()=>[[`plugins.${s}`,...o.additionalOptionScopes||[]]])}_cachedScopes(o,s){const c=this._scopeCache;let h=c.get(o);return(!h||s)&&(h=new Map,c.set(o,h)),h}getOptionScopes(o,s,c){const{options:h,type:d}=this,p=this._cachedScopes(o,c),Co=p.get(s);if(Co)return Co;const Bo=new Set;s.forEach(Uo=>{o&&(Bo.add(o),Uo.forEach(Qo=>addIfFound(Bo,o,Qo))),Uo.forEach(Qo=>addIfFound(Bo,h,Qo)),Uo.forEach(Qo=>addIfFound(Bo,overrides[d]||{},Qo)),Uo.forEach(Qo=>addIfFound(Bo,defaults,Qo)),Uo.forEach(Qo=>addIfFound(Bo,descriptors,Qo))});const Lo=[...Bo];return keysCached.has(s)&&p.set(s,Lo),Lo}chartOptionScopes(){const{options:o,type:s}=this;return[o,overrides[s]||{},defaults.datasets[s]||{},{type:s},defaults,descriptors]}resolveNamedOptions(o,s,c,h=[""]){const d={$shared:!0},{resolver:p,subPrefixes:Co}=getResolver(this._resolverCache,o,h);let Bo=p;if(needContext(p,s)){d.$shared=!1,c=isFunction(c)?c():c;const Lo=this.createResolver(o,c,Co);Bo=_attachContext(p,c,Lo)}for(const Lo of s)d[Lo]=Bo[Lo];return d}createResolver(o,s,c=[""],h){const{resolver:d}=getResolver(this._resolverCache,o,c);return isObject(s)?_attachContext(d,s,void 0,h):d}}function getResolver(l,o,s){let c=l.get(o);c||(c=new Map,l.set(o,c));const h=s.join();let d=c.get(h);return d||(d={resolver:_createResolver(o,s),subPrefixes:s.filter(Co=>!Co.toLowerCase().includes("hover"))},c.set(h,d)),d}function needContext(l,o){const{isScriptable:s,isIndexable:c}=_descriptors(l);for(const h of o)if(s(h)&&isFunction(l[h])||c(h)&&isArray(l[h]))return!0;return!1}var version="3.1.0";const KNOWN_POSITIONS=["top","bottom","left","right","chartArea"];function positionIsHorizontal(l,o){return l==="top"||l==="bottom"||KNOWN_POSITIONS.indexOf(l)===-1&&o==="x"}function compare2Level(l,o){return function(s,c){return s[l]===c[l]?s[o]-c[o]:s[l]-c[l]}}function onAnimationsComplete(l){const o=l.chart,s=o.options.animation;o.notifyPlugins("afterRender"),callback(s&&s.onComplete,[l],o)}function onAnimationProgress(l){const o=l.chart,s=o.options.animation;callback(s&&s.onProgress,[l],o)}function isDomSupported(){return typeof window<"u"&&typeof document<"u"}function getCanvas(l){return isDomSupported()&&typeof l=="string"?l=document.getElementById(l):l&&l.length&&(l=l[0]),l&&l.canvas&&(l=l.canvas),l}const instances={},getChart=l=>{const o=getCanvas(l);return Object.values(instances).filter(s=>s.canvas===o).pop()};class Chart{constructor(o,s){const c=this;this.config=s=new Config(s);const h=getCanvas(o),d=getChart(h);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas can be reused.");const p=s.createResolver(s.chartOptionScopes(),c.getContext());this.platform=c._initializePlatform(h,s);const Co=c.platform.acquireContext(h,p.aspectRatio),Bo=Co&&Co.canvas,Lo=Bo&&Bo.height,Uo=Bo&&Bo.width;if(this.id=uid(),this.ctx=Co,this.canvas=Bo,this.width=Uo,this.height=Lo,this._options=p,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._sortedMetasets=[],this.scales={},this.scale=void 0,this._plugins=new PluginService,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=debounce(()=>this.update("resize"),p.resizeDelay||0),instances[c.id]=c,!Co||!Bo){console.error("Failed to create chart: can't acquire context from the given item");return}animator.listen(c,"complete",onAnimationsComplete),animator.listen(c,"progress",onAnimationProgress),c._initialize(),c.attached&&c.update()}get aspectRatio(){const{options:{aspectRatio:o,maintainAspectRatio:s},width:c,height:h,_aspectRatio:d}=this;return isNullOrUndef(o)?s&&d?d:h?c/h:null:o}get data(){return this.config.data}set data(o){this.config.data=o}get options(){return this._options}set options(o){this.config.options=o}_initialize(){const o=this;return o.notifyPlugins("beforeInit"),o.options.responsive?o.resize():retinaScale(o,o.options.devicePixelRatio),o.bindEvents(),o.notifyPlugins("afterInit"),o}_initializePlatform(o,s){return s.platform?new s.platform:!isDomSupported()||typeof OffscreenCanvas<"u"&&o instanceof OffscreenCanvas?new BasicPlatform:new DomPlatform}clear(){return clearCanvas(this.canvas,this.ctx),this}stop(){return animator.stop(this),this}resize(o,s){animator.running(this)?this._resizeBeforeDraw={width:o,height:s}:this._resize(o,s)}_resize(o,s){const c=this,h=c.options,d=c.canvas,p=h.maintainAspectRatio&&c.aspectRatio,Co=c.platform.getMaximumSize(d,o,s,p),Bo=c.currentDevicePixelRatio,Lo=h.devicePixelRatio||c.platform.getDevicePixelRatio();c.width===Co.width&&c.height===Co.height&&Bo===Lo||(c.width=Co.width,c.height=Co.height,c._aspectRatio=c.aspectRatio,retinaScale(c,Lo,!0),c.notifyPlugins("resize",{size:Co}),callback(h.onResize,[c,Co],c),c.attached&&c._doResize()&&c.render())}ensureScalesHaveIDs(){const s=this.options.scales||{};each(s,(c,h)=>{c.id=h})}buildOrUpdateScales(){const o=this,s=o.options,c=s.scales,h=o.scales,d=Object.keys(h).reduce((Co,Bo)=>(Co[Bo]=!1,Co),{});let p=[];c&&(p=p.concat(Object.keys(c).map(Co=>{const Bo=c[Co],Lo=determineAxis(Co,Bo),Uo=Lo==="r",Qo=Lo==="x";return{options:Bo,dposition:Uo?"chartArea":Qo?"bottom":"left",dtype:Uo?"radialLinear":Qo?"category":"linear"}}))),each(p,Co=>{const Bo=Co.options,Lo=Bo.id,Uo=determineAxis(Lo,Bo),Qo=valueOrDefault(Bo.type,Co.dtype);(Bo.position===void 0||positionIsHorizontal(Bo.position,Uo)!==positionIsHorizontal(Co.dposition))&&(Bo.position=Co.dposition),d[Lo]=!0;let Po=null;if(Lo in h&&h[Lo].type===Qo)Po=h[Lo];else{const Mo=registry.getScale(Qo);Po=new Mo({id:Lo,type:Qo,ctx:o.ctx,chart:o}),h[Po.id]=Po}Po.init(Bo,s)}),each(d,(Co,Bo)=>{Co||delete h[Bo]}),each(h,Co=>{layouts.configure(o,Co,Co.options),layouts.addBox(o,Co)})}_updateMetasetIndex(o,s){const c=this._metasets,h=o.index;h!==s&&(c[h]=c[s],c[s]=o,o.index=s)}_updateMetasets(){const o=this,s=o._metasets,c=o.data.datasets.length,h=s.length;if(h>c){for(let d=c;d<h;++d)o._destroyDatasetMeta(d);s.splice(c,h-c)}o._sortedMetasets=s.slice(0).sort(compare2Level("order","index"))}_removeUnreferencedMetasets(){const o=this,{_metasets:s,data:{datasets:c}}=o;s.length>c.length&&delete o._stacks,s.forEach((h,d)=>{c.filter(p=>p===h._dataset).length===0&&o._destroyDatasetMeta(d)})}buildOrUpdateControllers(){const o=this,s=[],c=o.data.datasets;let h,d;for(o._removeUnreferencedMetasets(),h=0,d=c.length;h<d;h++){const p=c[h];let Co=o.getDatasetMeta(h);const Bo=p.type||o.config.type;if(Co.type&&Co.type!==Bo&&(o._destroyDatasetMeta(h),Co=o.getDatasetMeta(h)),Co.type=Bo,Co.indexAxis=p.indexAxis||getIndexAxis(Bo,o.options),Co.order=p.order||0,o._updateMetasetIndex(Co,h),Co.label=""+p.label,Co.visible=o.isDatasetVisible(h),Co.controller)Co.controller.updateIndex(h),Co.controller.linkScales();else{const Lo=registry.getController(Bo),{datasetElementType:Uo,dataElementType:Qo}=defaults.datasets[Bo];Object.assign(Lo.prototype,{dataElementType:registry.getElement(Qo),datasetElementType:Uo&&registry.getElement(Uo)}),Co.controller=new Lo(o,h),s.push(Co.controller)}}return o._updateMetasets(),s}_resetElements(){const o=this;each(o.data.datasets,(s,c)=>{o.getDatasetMeta(c).controller.reset()},o)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(o){const s=this,c=s.config;c.update(),s._options=c.createResolver(c.chartOptionScopes(),s.getContext()),each(s.scales,Co=>{layouts.removeBox(s,Co)});const h=s._animationsDisabled=!s.options.animation;if(s.ensureScalesHaveIDs(),s.buildOrUpdateScales(),s._plugins.invalidate(),s.notifyPlugins("beforeUpdate",{mode:o,cancelable:!0})===!1)return;const d=s.buildOrUpdateControllers();s.notifyPlugins("beforeElementsUpdate");let p=0;for(let Co=0,Bo=s.data.datasets.length;Co<Bo;Co++){const{controller:Lo}=s.getDatasetMeta(Co),Uo=!h&&d.indexOf(Lo)===-1;Lo.buildOrUpdateElements(Uo),p=Math.max(+Lo.getMaxOverflow(),p)}s._minPadding=p,s._updateLayout(p),h||each(d,Co=>{Co.reset()}),s._updateDatasets(o),s.notifyPlugins("afterUpdate",{mode:o}),s._layers.sort(compare2Level("z","_idx")),s._lastEvent&&s._eventHandler(s._lastEvent,!0),s.render()}_updateLayout(o){const s=this;if(s.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;layouts.update(s,s.width,s.height,o);const c=s.chartArea,h=c.width<=0||c.height<=0;s._layers=[],each(s.boxes,d=>{h&&d.position==="chartArea"||(d.configure&&d.configure(),s._layers.push(...d._layers()))},s),s._layers.forEach((d,p)=>{d._idx=p}),s.notifyPlugins("afterLayout")}_updateDatasets(o){const s=this,c=typeof o=="function";if(s.notifyPlugins("beforeDatasetsUpdate",{mode:o,cancelable:!0})!==!1){for(let h=0,d=s.data.datasets.length;h<d;++h)s._updateDataset(h,c?o({datasetIndex:h}):o);s.notifyPlugins("afterDatasetsUpdate",{mode:o})}}_updateDataset(o,s){const c=this,h=c.getDatasetMeta(o),d={meta:h,index:o,mode:s,cancelable:!0};c.notifyPlugins("beforeDatasetUpdate",d)!==!1&&(h.controller._update(s),d.cancelable=!1,c.notifyPlugins("afterDatasetUpdate",d))}render(){const o=this;o.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(animator.has(o)?o.attached&&!animator.running(o)&&animator.start(o):(o.draw(),onAnimationsComplete({chart:o})))}draw(){const o=this;let s;if(o._resizeBeforeDraw){const{width:h,height:d}=o._resizeBeforeDraw;o._resize(h,d),o._resizeBeforeDraw=null}if(o.clear(),o.width<=0||o.height<=0||o.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const c=o._layers;for(s=0;s<c.length&&c[s].z<=0;++s)c[s].draw(o.chartArea);for(o._drawDatasets();s<c.length;++s)c[s].draw(o.chartArea);o.notifyPlugins("afterDraw")}_getSortedDatasetMetas(o){const c=this._sortedMetasets,h=[];let d,p;for(d=0,p=c.length;d<p;++d){const Co=c[d];(!o||Co.visible)&&h.push(Co)}return h}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){const o=this;if(o.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const s=o.getSortedVisibleDatasetMetas();for(let c=s.length-1;c>=0;--c)o._drawDataset(s[c]);o.notifyPlugins("afterDatasetsDraw")}_drawDataset(o){const s=this,c=s.ctx,h=o._clip,d=s.chartArea,p={meta:o,index:o.index,cancelable:!0};s.notifyPlugins("beforeDatasetDraw",p)!==!1&&(clipArea(c,{left:h.left===!1?0:d.left-h.left,right:h.right===!1?s.width:d.right+h.right,top:h.top===!1?0:d.top-h.top,bottom:h.bottom===!1?s.height:d.bottom+h.bottom}),o.controller.draw(),unclipArea(c),p.cancelable=!1,s.notifyPlugins("afterDatasetDraw",p))}getElementsAtEventForMode(o,s,c,h){const d=Interaction.modes[s];return typeof d=="function"?d(this,o,c,h):[]}getDatasetMeta(o){const s=this,c=s.data.datasets[o],h=s._metasets;let d=h.filter(p=>p&&p._dataset===c).pop();return d||(d=h[o]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:c&&c.order||0,index:o,_dataset:c,_parsed:[],_sorted:!1}),d}getContext(){return this.$context||(this.$context={chart:this,type:"chart"})}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(o){const s=this.data.datasets[o];if(!s)return!1;const c=this.getDatasetMeta(o);return typeof c.hidden=="boolean"?!c.hidden:!s.hidden}setDatasetVisibility(o,s){const c=this.getDatasetMeta(o);c.hidden=!s}toggleDataVisibility(o){this._hiddenIndices[o]=!this._hiddenIndices[o]}getDataVisibility(o){return!this._hiddenIndices[o]}_updateDatasetVisibility(o,s){const c=this,h=s?"show":"hide",d=c.getDatasetMeta(o),p=d.controller._resolveAnimations(void 0,h);c.setDatasetVisibility(o,s),p.update(d,{visible:s}),c.update(Co=>Co.datasetIndex===o?h:void 0)}hide(o){this._updateDatasetVisibility(o,!1)}show(o){this._updateDatasetVisibility(o,!0)}_destroyDatasetMeta(o){const s=this,c=s._metasets&&s._metasets[o];c&&c.controller&&(c.controller._destroy(),delete s._metasets[o])}destroy(){const o=this,{canvas:s,ctx:c}=o;let h,d;for(o.stop(),animator.remove(o),h=0,d=o.data.datasets.length;h<d;++h)o._destroyDatasetMeta(h);o.config.clearCache(),s&&(o.unbindEvents(),clearCanvas(s,c),o.platform.releaseContext(c),o.canvas=null,o.ctx=null),o.notifyPlugins("destroy"),delete instances[o.id]}toBase64Image(...o){return this.canvas.toDataURL(...o)}bindEvents(){const o=this,s=o._listeners,c=o.platform,h=(Co,Bo)=>{c.addEventListener(o,Co,Bo),s[Co]=Bo},d=(Co,Bo)=>{s[Co]&&(c.removeEventListener(o,Co,Bo),delete s[Co])};let p=function(Co,Bo,Lo){Co.offsetX=Bo,Co.offsetY=Lo,o._eventHandler(Co)};if(each(o.options.events,Co=>h(Co,p)),o.options.responsive){p=(Lo,Uo)=>{o.canvas&&o.resize(Lo,Uo)};let Co;const Bo=()=>{d("attach",Bo),o.attached=!0,o.resize(),h("resize",p),h("detach",Co)};Co=()=>{o.attached=!1,d("resize",p),h("attach",Bo)},c.isAttached(o.canvas)?Bo():Co()}else o.attached=!0}unbindEvents(){const o=this,s=o._listeners;!s||(delete o._listeners,each(s,(c,h)=>{o.platform.removeEventListener(o,h,c)}))}updateHoverStyle(o,s,c){const h=c?"set":"remove";let d,p,Co,Bo;for(s==="dataset"&&(d=this.getDatasetMeta(o[0].datasetIndex),d.controller["_"+h+"DatasetHoverStyle"]()),Co=0,Bo=o.length;Co<Bo;++Co){p=o[Co];const Lo=p&&this.getDatasetMeta(p.datasetIndex).controller;Lo&&Lo[h+"HoverStyle"](p.element,p.datasetIndex,p.index)}}getActiveElements(){return this._active||[]}setActiveElements(o){const s=this,c=s._active||[],h=o.map(({datasetIndex:p,index:Co})=>{const Bo=s.getDatasetMeta(p);if(!Bo)throw new Error("No dataset found at index "+p);return{datasetIndex:p,element:Bo.data[Co],index:Co}});!_elementsEqual(h,c)&&(s._active=h,s._updateHoverStyles(h,c))}notifyPlugins(o,s,c){return this._plugins.notify(this,o,s,c)}_updateHoverStyles(o,s,c){const h=this,d=h.options.hover,p=(Lo,Uo)=>Lo.filter(Qo=>!Uo.some(Po=>Qo.datasetIndex===Po.datasetIndex&&Qo.index===Po.index)),Co=p(s,o),Bo=c?o:p(o,s);Co.length&&h.updateHoverStyle(Co,d.mode,!1),Bo.length&&d.mode&&h.updateHoverStyle(Bo,d.mode,!0)}_eventHandler(o,s){const c=this,h={event:o,replay:s,cancelable:!0},d=Co=>(Co.options.events||this.options.events).includes(o.type);if(c.notifyPlugins("beforeEvent",h,d)===!1)return;const p=c._handleEvent(o,s);return h.cancelable=!1,c.notifyPlugins("afterEvent",h,d),(p||h.changed)&&c.render(),c}_handleEvent(o,s){const c=this,{_active:h=[],options:d}=c,p=d.hover,Co=s;let Bo=[],Lo=!1,Uo=null;return o.type!=="mouseout"&&(Bo=c.getElementsAtEventForMode(o,p.mode,p,Co),Uo=o.type==="click"?c._lastEvent:o),c._lastEvent=null,_isPointInArea(o,c.chartArea,c._minPadding)&&(callback(d.onHover,[o,Bo,c],c),(o.type==="mouseup"||o.type==="click"||o.type==="contextmenu")&&callback(d.onClick,[o,Bo,c],c)),Lo=!_elementsEqual(Bo,h),(Lo||s)&&(c._active=Bo,c._updateHoverStyles(Bo,h,s)),c._lastEvent=Uo,Lo}}const invalidatePlugins=()=>each(Chart.instances,l=>l._plugins.invalidate()),enumerable=!0;Object.defineProperties(Chart,{defaults:{enumerable,value:defaults},instances:{enumerable,value:instances},overrides:{enumerable,value:overrides},registry:{enumerable,value:registry},version:{enumerable,value:version},getChart:{enumerable,value:getChart},register:{enumerable,value:(...l)=>{registry.add(...l),invalidatePlugins()}},unregister:{enumerable,value:(...l)=>{registry.remove(...l),invalidatePlugins()}}});function clipArc(l,o){const{startAngle:s,endAngle:c,pixelMargin:h,x:d,y:p,outerRadius:Co,innerRadius:Bo}=o;let Lo=h/Co;l.beginPath(),l.arc(d,p,Co,s-Lo,c+Lo),Bo>h?(Lo=h/Bo,l.arc(d,p,Bo,c+Lo,s-Lo,!0)):l.arc(d,p,h,c+HALF_PI,s-HALF_PI),l.closePath(),l.clip()}function toRadiusCorners(l){return _readValueToProps(l,["outerStart","outerEnd","innerStart","innerEnd"])}function parseBorderRadius$1(l,o,s,c){const h=toRadiusCorners(l.options.borderRadius),d=(s-o)/2,p=Math.min(d,c*o/2),Co=Bo=>{const Lo=(s-Math.min(d,Bo))*c/2;return _limitValue(Bo,0,Math.min(d,Lo))};return{outerStart:Co(h.outerStart),outerEnd:Co(h.outerEnd),innerStart:_limitValue(h.innerStart,0,p),innerEnd:_limitValue(h.innerEnd,0,p)}}function rThetaToXY(l,o,s,c){return{x:s+l*Math.cos(o),y:c+l*Math.sin(o)}}function pathArc(l,o){const{x:s,y:c,startAngle:h,endAngle:d,pixelMargin:p}=o,Co=Math.max(o.outerRadius-p,0),Bo=o.innerRadius+p,{outerStart:Lo,outerEnd:Uo,innerStart:Qo,innerEnd:Po}=parseBorderRadius$1(o,Bo,Co,d-h),Mo=Co-Lo,Go=Co-Uo,$o=h+Lo/Mo,jo=d-Uo/Go,zo=Bo+Qo,Xo=Bo+Po,Zo=h+Qo/zo,Wo=d-Po/Xo;if(l.beginPath(),l.arc(s,c,Co,$o,jo),Uo>0){const Jo=rThetaToXY(Go,jo,s,c);l.arc(Jo.x,Jo.y,Uo,jo,d+HALF_PI)}const es=rThetaToXY(Xo,d,s,c);if(l.lineTo(es.x,es.y),Po>0){const Jo=rThetaToXY(Xo,Wo,s,c);l.arc(Jo.x,Jo.y,Po,d+HALF_PI,Wo+Math.PI)}if(l.arc(s,c,Bo,d-Po/Bo,h+Qo/Bo,!0),Qo>0){const Jo=rThetaToXY(zo,Zo,s,c);l.arc(Jo.x,Jo.y,Qo,Zo+Math.PI,h-HALF_PI)}const is=rThetaToXY(Mo,h,s,c);if(l.lineTo(is.x,is.y),Lo>0){const Jo=rThetaToXY(Mo,$o,s,c);l.arc(Jo.x,Jo.y,Lo,h-HALF_PI,$o)}l.closePath()}function drawArc(l,o){if(o.fullCircles){o.endAngle=o.startAngle+TAU,pathArc(l,o);for(let s=0;s<o.fullCircles;++s)l.fill()}isNaN(o.circumference)||(o.endAngle=o.startAngle+o.circumference%TAU),pathArc(l,o),l.fill()}function drawFullCircleBorders(l,o,s){const{x:c,y:h,startAngle:d,endAngle:p,pixelMargin:Co}=o,Bo=Math.max(o.outerRadius-Co,0),Lo=o.innerRadius+Co;let Uo;for(s&&(o.endAngle=o.startAngle+TAU,clipArc(l,o),o.endAngle=p,o.endAngle===o.startAngle&&(o.endAngle+=TAU,o.fullCircles--)),l.beginPath(),l.arc(c,h,Lo,d+TAU,d,!0),Uo=0;Uo<o.fullCircles;++Uo)l.stroke();for(l.beginPath(),l.arc(c,h,Bo,d,d+TAU),Uo=0;Uo<o.fullCircles;++Uo)l.stroke()}function drawBorder(l,o){const{options:s}=o,c=s.borderAlign==="inner";!s.borderWidth||(c?(l.lineWidth=s.borderWidth*2,l.lineJoin="round"):(l.lineWidth=s.borderWidth,l.lineJoin="bevel"),o.fullCircles&&drawFullCircleBorders(l,o,c),c&&clipArc(l,o),pathArc(l,o),l.stroke())}class ArcElement extends Element$1{constructor(o){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,o&&Object.assign(this,o)}inRange(o,s,c){const h=this.getProps(["x","y"],c),{angle:d,distance:p}=getAngleFromPoint(h,{x:o,y:s}),{startAngle:Co,endAngle:Bo,innerRadius:Lo,outerRadius:Uo,circumference:Qo}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],c),Po=Qo>=TAU||_angleBetween(d,Co,Bo),Mo=p>=Lo&&p<=Uo;return Po&&Mo}getCenterPoint(o){const{x:s,y:c,startAngle:h,endAngle:d,innerRadius:p,outerRadius:Co}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],o),Bo=(h+d)/2,Lo=(p+Co)/2;return{x:s+Math.cos(Bo)*Lo,y:c+Math.sin(Bo)*Lo}}tooltipPosition(o){return this.getCenterPoint(o)}draw(o){const s=this,c=s.options,h=c.offset||0;if(s.pixelMargin=c.borderAlign==="inner"?.33:0,s.fullCircles=Math.floor(s.circumference/TAU),!(s.circumference===0||s.innerRadius<0||s.outerRadius<0)){if(o.save(),h&&s.circumference<TAU){const d=(s.startAngle+s.endAngle)/2;o.translate(Math.cos(d)*h,Math.sin(d)*h)}o.fillStyle=c.backgroundColor,o.strokeStyle=c.borderColor,drawArc(o,s),drawBorder(o,s),o.restore()}}}ArcElement.id="arc";ArcElement.defaults={borderAlign:"center",borderColor:"#fff",borderRadius:0,borderWidth:2,offset:0,angle:void 0};ArcElement.defaultRoutes={backgroundColor:"backgroundColor"};function setStyle(l,o,s=o){l.lineCap=valueOrDefault(s.borderCapStyle,o.borderCapStyle),l.setLineDash(valueOrDefault(s.borderDash,o.borderDash)),l.lineDashOffset=valueOrDefault(s.borderDashOffset,o.borderDashOffset),l.lineJoin=valueOrDefault(s.borderJoinStyle,o.borderJoinStyle),l.lineWidth=valueOrDefault(s.borderWidth,o.borderWidth),l.strokeStyle=valueOrDefault(s.borderColor,o.borderColor)}function lineTo(l,o,s){l.lineTo(s.x,s.y)}function getLineMethod(l){return l.stepped?_steppedLineTo:l.tension?_bezierCurveTo:lineTo}function pathVars(l,o,s){s=s||{};const c=l.length,h=Math.max(s.start||0,o.start),d=Math.min(s.end||c-1,o.end);return{count:c,start:h,loop:o.loop,ilen:d<h?c+d-h:d-h}}function pathSegment(l,o,s,c){const{points:h,options:d}=o,{count:p,start:Co,loop:Bo,ilen:Lo}=pathVars(h,s,c),Uo=getLineMethod(d);let{move:Qo=!0,reverse:Po}=c||{},Mo,Go,$o;for(Mo=0;Mo<=Lo;++Mo)Go=h[(Co+(Po?Lo-Mo:Mo))%p],!Go.skip&&(Qo?(l.moveTo(Go.x,Go.y),Qo=!1):Uo(l,$o,Go,Po,d.stepped),$o=Go);return Bo&&(Go=h[(Co+(Po?Lo:0))%p],Uo(l,$o,Go,Po,d.stepped)),!!Bo}function fastPathSegment(l,o,s,c){const h=o.points,{count:d,start:p,ilen:Co}=pathVars(h,s,c),{move:Bo=!0,reverse:Lo}=c||{};let Uo=0,Qo=0,Po,Mo,Go,$o,jo,zo;const Xo=Wo=>(p+(Lo?Co-Wo:Wo))%d,Zo=()=>{$o!==jo&&(l.lineTo(Uo,jo),l.lineTo(Uo,$o),l.lineTo(Uo,zo))};for(Bo&&(Mo=h[Xo(0)],l.moveTo(Mo.x,Mo.y)),Po=0;Po<=Co;++Po){if(Mo=h[Xo(Po)],Mo.skip)continue;const Wo=Mo.x,es=Mo.y,is=Wo|0;is===Go?(es<$o?$o=es:es>jo&&(jo=es),Uo=(Qo*Uo+Wo)/++Qo):(Zo(),l.lineTo(Wo,es),Go=is,Qo=0,$o=jo=es),zo=es}Zo()}function _getSegmentMethod(l){const o=l.options,s=o.borderDash&&o.borderDash.length;return!l._decimated&&!l._loop&&!o.tension&&!o.stepped&&!s?fastPathSegment:pathSegment}function _getInterpolationMethod(l){return l.stepped?_steppedInterpolation:l.tension?_bezierInterpolation:_pointInLine}function strokePathWithCache(l,o,s,c){let h=o._path;h||(h=o._path=new Path2D,o.path(h,s,c)&&h.closePath()),setStyle(l,o.options),l.stroke(h)}function strokePathDirect(l,o,s,c){const{segments:h,options:d}=o,p=_getSegmentMethod(o);for(const Co of h)setStyle(l,d,Co.style),l.beginPath(),p(l,o,Co,{start:s,end:s+c-1})&&l.closePath(),l.stroke()}const usePath2D=typeof Path2D=="function";function draw(l,o,s,c){usePath2D&&o.segments.length===1?strokePathWithCache(l,o,s,c):strokePathDirect(l,o,s,c)}class LineElement extends Element$1{constructor(o){super(),this.animated=!0,this.options=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,o&&Object.assign(this,o)}updateControlPoints(o){const s=this,c=s.options;if(c.tension&&!c.stepped&&!s._pointsUpdated){const h=c.spanGaps?s._loop:s._fullLoop;_updateBezierControlPoints(s._points,c,o,h),s._pointsUpdated=!0}}set points(o){const s=this;s._points=o,delete s._segments,delete s._path,s._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=_computeSegments(this,this.options.segment))}first(){const o=this.segments,s=this.points;return o.length&&s[o[0].start]}last(){const o=this.segments,s=this.points,c=o.length;return c&&s[o[c-1].end]}interpolate(o,s){const c=this,h=c.options,d=o[s],p=c.points,Co=_boundSegments(c,{property:s,start:d,end:d});if(!Co.length)return;const Bo=[],Lo=_getInterpolationMethod(h);let Uo,Qo;for(Uo=0,Qo=Co.length;Uo<Qo;++Uo){const{start:Po,end:Mo}=Co[Uo],Go=p[Po],$o=p[Mo];if(Go===$o){Bo.push(Go);continue}const jo=Math.abs((d-Go[s])/($o[s]-Go[s])),zo=Lo(Go,$o,jo,h.stepped);zo[s]=o[s],Bo.push(zo)}return Bo.length===1?Bo[0]:Bo}pathSegment(o,s,c){return _getSegmentMethod(this)(o,this,s,c)}path(o,s,c){const h=this,d=h.segments,p=_getSegmentMethod(h);let Co=h._loop;s=s||0,c=c||h.points.length-s;for(const Bo of d)Co&=p(o,h,Bo,{start:s,end:s+c-1});return!!Co}draw(o,s,c,h){const d=this,p=d.options||{};!(d.points||[]).length||!p.borderWidth||(o.save(),draw(o,d,c,h),o.restore(),d.animated&&(d._pointsUpdated=!1,d._path=void 0))}}LineElement.id="line";LineElement.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};LineElement.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};LineElement.descriptors={_scriptable:!0,_indexable:l=>l!=="borderDash"&&l!=="fill"};function inRange$1(l,o,s,c){const h=l.options,{[s]:d}=l.getProps([s],c);return Math.abs(o-d)<h.radius+h.hitRadius}class PointElement extends Element$1{constructor(o){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,o&&Object.assign(this,o)}inRange(o,s,c){const h=this.options,{x:d,y:p}=this.getProps(["x","y"],c);return Math.pow(o-d,2)+Math.pow(s-p,2)<Math.pow(h.hitRadius+h.radius,2)}inXRange(o,s){return inRange$1(this,o,"x",s)}inYRange(o,s){return inRange$1(this,o,"y",s)}getCenterPoint(o){const{x:s,y:c}=this.getProps(["x","y"],o);return{x:s,y:c}}size(o){o=o||this.options||{};let s=o.radius||0;s=Math.max(s,s&&o.hoverRadius||0);const c=s&&o.borderWidth||0;return(s+c)*2}draw(o){const s=this,c=s.options;s.skip||c.radius<.1||(o.strokeStyle=c.borderColor,o.lineWidth=c.borderWidth,o.fillStyle=c.backgroundColor,drawPoint(o,c,s.x,s.y))}getRange(){const o=this.options||{};return o.radius+o.hitRadius}}PointElement.id="point";PointElement.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};PointElement.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function getBarBounds(l,o){const{x:s,y:c,base:h,width:d,height:p}=l.getProps(["x","y","base","width","height"],o);let Co,Bo,Lo,Uo,Qo;return l.horizontal?(Qo=p/2,Co=Math.min(s,h),Bo=Math.max(s,h),Lo=c-Qo,Uo=c+Qo):(Qo=d/2,Co=s-Qo,Bo=s+Qo,Lo=Math.min(c,h),Uo=Math.max(c,h)),{left:Co,top:Lo,right:Bo,bottom:Uo}}function parseBorderSkipped(l){let o=l.options.borderSkipped;const s={};return o&&(o=l.horizontal?parseEdge(o,"left","right",l.base>l.x):parseEdge(o,"bottom","top",l.base<l.y),s[o]=!0),s}function parseEdge(l,o,s,c){return c?(l=swap(l,o,s),l=startEnd(l,s,o)):l=startEnd(l,o,s),l}function swap(l,o,s){return l===o?s:l===s?o:l}function startEnd(l,o,s){return l==="start"?o:l==="end"?s:l}function skipOrLimit(l,o,s,c){return l?0:Math.max(Math.min(o,c),s)}function parseBorderWidth(l,o,s){const c=l.options.borderWidth,h=parseBorderSkipped(l),d=toTRBL(c);return{t:skipOrLimit(h.top,d.top,0,s),r:skipOrLimit(h.right,d.right,0,o),b:skipOrLimit(h.bottom,d.bottom,0,s),l:skipOrLimit(h.left,d.left,0,o)}}function parseBorderRadius(l,o,s){const c=l.options.borderRadius,h=toTRBLCorners(c),d=Math.min(o,s),p=parseBorderSkipped(l);return{topLeft:skipOrLimit(p.top||p.left,h.topLeft,0,d),topRight:skipOrLimit(p.top||p.right,h.topRight,0,d),bottomLeft:skipOrLimit(p.bottom||p.left,h.bottomLeft,0,d),bottomRight:skipOrLimit(p.bottom||p.right,h.bottomRight,0,d)}}function boundingRects(l){const o=getBarBounds(l),s=o.right-o.left,c=o.bottom-o.top,h=parseBorderWidth(l,s/2,c/2),d=parseBorderRadius(l,s/2,c/2);return{outer:{x:o.left,y:o.top,w:s,h:c,radius:d},inner:{x:o.left+h.l,y:o.top+h.t,w:s-h.l-h.r,h:c-h.t-h.b,radius:{topLeft:Math.max(0,d.topLeft-Math.max(h.t,h.l)),topRight:Math.max(0,d.topRight-Math.max(h.t,h.r)),bottomLeft:Math.max(0,d.bottomLeft-Math.max(h.b,h.l)),bottomRight:Math.max(0,d.bottomRight-Math.max(h.b,h.r))}}}}function inRange(l,o,s,c){const h=o===null,d=s===null,Co=l&&!(h&&d)&&getBarBounds(l,c);return Co&&(h||o>=Co.left&&o<=Co.right)&&(d||s>=Co.top&&s<=Co.bottom)}function hasRadius(l){return l.topLeft||l.topRight||l.bottomLeft||l.bottomRight}function addNormalRectPath(l,o){l.rect(o.x,o.y,o.w,o.h)}class BarElement extends Element$1{constructor(o){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,o&&Object.assign(this,o)}draw(o){const s=this.options,{inner:c,outer:h}=boundingRects(this),d=hasRadius(h.radius)?addRoundedRectPath:addNormalRectPath;o.save(),(h.w!==c.w||h.h!==c.h)&&(o.beginPath(),d(o,h),o.clip(),d(o,c),o.fillStyle=s.borderColor,o.fill("evenodd")),o.beginPath(),d(o,c),o.fillStyle=s.backgroundColor,o.fill(),o.restore()}inRange(o,s,c){return inRange(this,o,s,c)}inXRange(o,s){return inRange(this,o,null,s)}inYRange(o,s){return inRange(this,null,o,s)}getCenterPoint(o){const{x:s,y:c,base:h,horizontal:d}=this.getProps(["x","y","base","horizontal"],o);return{x:d?(s+h)/2:s,y:d?c:(c+h)/2}}getRange(o){return o==="x"?this.width/2:this.height/2}}BarElement.id="bar";BarElement.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,pointStyle:void 0};BarElement.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};const getBoxSize=(l,o)=>{let{boxHeight:s=o,boxWidth:c=o}=l;return l.usePointStyle&&(s=Math.min(s,o),c=Math.min(c,o)),{boxWidth:c,boxHeight:s,itemHeight:Math.max(o,s)}},itemsEqual=(l,o)=>l!==null&&o!==null&&l.datasetIndex===o.datasetIndex&&l.index===o.index;class Legend extends Element$1{constructor(o){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=o.chart,this.options=o.options,this.ctx=o.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(o,s,c){const h=this;h.maxWidth=o,h.maxHeight=s,h._margins=c,h.setDimensions(),h.buildLabels(),h.fit()}setDimensions(){const o=this;o.isHorizontal()?(o.width=o.maxWidth,o.left=0,o.right=o.width):(o.height=o.maxHeight,o.top=0,o.bottom=o.height)}buildLabels(){const o=this,s=o.options.labels||{};let c=callback(s.generateLabels,[o.chart],o)||[];s.filter&&(c=c.filter(h=>s.filter(h,o.chart.data))),s.sort&&(c=c.sort((h,d)=>s.sort(h,d,o.chart.data))),o.options.reverse&&c.reverse(),o.legendItems=c}fit(){const o=this,{options:s,ctx:c}=o;if(!s.display){o.width=o.height=0;return}const h=s.labels,d=toFont(h.font),p=d.size,Co=o._computeTitleHeight(),{boxWidth:Bo,itemHeight:Lo}=getBoxSize(h,p);let Uo,Qo;c.font=d.string,o.isHorizontal()?(Uo=o.maxWidth,Qo=o._fitRows(Co,p,Bo,Lo)+10):(Qo=o.maxHeight,Uo=o._fitCols(Co,p,Bo,Lo)+10),o.width=Math.min(Uo,s.maxWidth||o.maxWidth),o.height=Math.min(Qo,s.maxHeight||o.maxHeight)}_fitRows(o,s,c,h){const d=this,{ctx:p,maxWidth:Co,options:{labels:{padding:Bo}}}=d,Lo=d.legendHitBoxes=[],Uo=d.lineWidths=[0],Qo=h+Bo;let Po=o;p.textAlign="left",p.textBaseline="middle";let Mo=-1,Go=-Qo;return d.legendItems.forEach(($o,jo)=>{const zo=c+s/2+p.measureText($o.text).width;(jo===0||Uo[Uo.length-1]+zo+2*Bo>Co)&&(Po+=Qo,Uo[Uo.length-(jo>0?0:1)]=0,Go+=Qo,Mo++),Lo[jo]={left:0,top:Go,row:Mo,width:zo,height:h},Uo[Uo.length-1]+=zo+Bo}),Po}_fitCols(o,s,c,h){const d=this,{ctx:p,maxHeight:Co,options:{labels:{padding:Bo}}}=d,Lo=d.legendHitBoxes=[],Uo=d.columnSizes=[],Qo=Co-o;let Po=Bo,Mo=0,Go=0,$o=0,jo=0,zo=0;return d.legendItems.forEach((Xo,Zo)=>{const Wo=c+s/2+p.measureText(Xo.text).width;Zo>0&&Go+s+2*Bo>Qo&&(Po+=Mo+Bo,Uo.push({width:Mo,height:Go}),$o+=Mo+Bo,zo++,jo=0,Mo=Go=0),Mo=Math.max(Mo,Wo),Go+=s+Bo,Lo[Zo]={left:$o,top:jo,col:zo,width:Wo,height:h},jo+=h+Bo}),Po+=Mo,Uo.push({width:Mo,height:Go}),Po}adjustHitBoxes(){const o=this;if(!o.options.display)return;const s=o._computeTitleHeight(),{legendHitBoxes:c,options:{align:h,labels:{padding:d}}}=o;if(this.isHorizontal()){let p=0,Co=_alignStartEnd(h,o.left+d,o.right-o.lineWidths[p]);for(const Bo of c)p!==Bo.row&&(p=Bo.row,Co=_alignStartEnd(h,o.left+d,o.right-o.lineWidths[p])),Bo.top+=o.top+s+d,Bo.left=Co,Co+=Bo.width+d}else{let p=0,Co=_alignStartEnd(h,o.top+s+d,o.bottom-o.columnSizes[p].height);for(const Bo of c)Bo.col!==p&&(p=Bo.col,Co=_alignStartEnd(h,o.top+s+d,o.bottom-o.columnSizes[p].height)),Bo.top=Co,Bo.left+=o.left+d,Co+=Bo.height+d}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){const o=this;if(o.options.display){const s=o.ctx;clipArea(s,o),o._draw(),unclipArea(s)}}_draw(){const o=this,{options:s,columnSizes:c,lineWidths:h,ctx:d}=o,{align:p,labels:Co}=s,Bo=defaults.color,Lo=getRtlAdapter(s.rtl,o.left,o.width),Uo=toFont(Co.font),{color:Qo,padding:Po}=Co,Mo=Uo.size,Go=Mo/2;let $o;o.drawTitle(),d.textAlign=Lo.textAlign("left"),d.textBaseline="middle",d.lineWidth=.5,d.font=Uo.string;const{boxWidth:jo,boxHeight:zo,itemHeight:Xo}=getBoxSize(Co,Mo),Zo=function(Ko,Yo,ts){if(isNaN(jo)||jo<=0||isNaN(zo)||zo<0)return;d.save();const ss=valueOrDefault(ts.lineWidth,1);if(d.fillStyle=valueOrDefault(ts.fillStyle,Bo),d.lineCap=valueOrDefault(ts.lineCap,"butt"),d.lineDashOffset=valueOrDefault(ts.lineDashOffset,0),d.lineJoin=valueOrDefault(ts.lineJoin,"miter"),d.lineWidth=ss,d.strokeStyle=valueOrDefault(ts.strokeStyle,Bo),d.setLineDash(valueOrDefault(ts.lineDash,[])),Co.usePointStyle){const cs={radius:jo*Math.SQRT2/2,pointStyle:ts.pointStyle,rotation:ts.rotation,borderWidth:ss},as=Lo.xPlus(Ko,jo/2),us=Yo+Go;drawPoint(d,cs,as,us)}else{const cs=Yo+Math.max((Mo-zo)/2,0),as=Lo.leftForLtr(Ko,jo),us=toTRBLCorners(ts.borderRadius);d.beginPath(),Object.values(us).some(gs=>gs!==0)?addRoundedRectPath(d,{x:as,y:cs,w:jo,h:zo,radius:us}):d.rect(as,cs,jo,zo),d.fill(),ss!==0&&d.stroke()}d.restore()},Wo=function(Ko,Yo,ts){renderText(d,ts.text,Ko,Yo+Xo/2,Uo,{strikethrough:ts.hidden,textAlign:ts.textAlign})},es=o.isHorizontal(),is=this._computeTitleHeight();es?$o={x:_alignStartEnd(p,o.left+Po,o.right-h[0]),y:o.top+Po+is,line:0}:$o={x:o.left+Po,y:_alignStartEnd(p,o.top+is+Po,o.bottom-c[0].height),line:0},overrideTextDirection(o.ctx,s.textDirection);const Jo=Xo+Po;o.legendItems.forEach((Ko,Yo)=>{d.strokeStyle=Ko.fontColor||Qo,d.fillStyle=Ko.fontColor||Qo;const ts=d.measureText(Ko.text).width,ss=Lo.textAlign(Ko.textAlign||(Ko.textAlign=Co.textAlign)),cs=jo+Mo/2+ts;let as=$o.x,us=$o.y;Lo.setWidth(o.width),es?Yo>0&&as+cs+Po>o.right&&(us=$o.y+=Jo,$o.line++,as=$o.x=_alignStartEnd(p,o.left+Po,o.right-h[$o.line])):Yo>0&&us+Jo>o.bottom&&(as=$o.x=as+c[$o.line].width+Po,$o.line++,us=$o.y=_alignStartEnd(p,o.top+is+Po,o.bottom-c[$o.line].height));const gs=Lo.x(as);Zo(gs,us,Ko),as=_textX(ss,as+jo+Go,o.right),Wo(Lo.x(as),us,Ko),es?$o.x+=cs+Po:$o.y+=Jo}),restoreTextDirection(o.ctx,s.textDirection)}drawTitle(){const o=this,s=o.options,c=s.title,h=toFont(c.font),d=toPadding(c.padding);if(!c.display)return;const p=getRtlAdapter(s.rtl,o.left,o.width),Co=o.ctx,Bo=c.position,Lo=h.size/2,Uo=d.top+Lo;let Qo,Po=o.left,Mo=o.width;if(this.isHorizontal())Mo=Math.max(...o.lineWidths),Qo=o.top+Uo,Po=_alignStartEnd(s.align,Po,o.right-Mo);else{const $o=o.columnSizes.reduce((jo,zo)=>Math.max(jo,zo.height),0);Qo=Uo+_alignStartEnd(s.align,o.top,o.bottom-$o-s.labels.padding-o._computeTitleHeight())}const Go=_alignStartEnd(Bo,Po,Po+Mo);Co.textAlign=p.textAlign(_toLeftRightCenter(Bo)),Co.textBaseline="middle",Co.strokeStyle=c.color,Co.fillStyle=c.color,Co.font=h.string,renderText(Co,c.text,Go,Qo,h)}_computeTitleHeight(){const o=this.options.title,s=toFont(o.font),c=toPadding(o.padding);return o.display?s.lineHeight+c.height:0}_getLegendItemAt(o,s){const c=this;let h,d,p;if(o>=c.left&&o<=c.right&&s>=c.top&&s<=c.bottom){for(p=c.legendHitBoxes,h=0;h<p.length;++h)if(d=p[h],o>=d.left&&o<=d.left+d.width&&s>=d.top&&s<=d.top+d.height)return c.legendItems[h]}return null}handleEvent(o){const s=this,c=s.options;if(!isListened(o.type,c))return;const h=s._getLegendItemAt(o.x,o.y);if(o.type==="mousemove"){const d=s._hoveredItem,p=itemsEqual(d,h);d&&!p&&callback(c.onLeave,[o,d,s],s),s._hoveredItem=h,h&&!p&&callback(c.onHover,[o,h,s],s)}else h&&callback(c.onClick,[o,h,s],s)}}function isListened(l,o){return!!(l==="mousemove"&&(o.onHover||o.onLeave)||o.onClick&&(l==="click"||l==="mouseup"))}var plugin_legend={id:"legend",_element:Legend,start(l,o,s){const c=l.legend=new Legend({ctx:l.ctx,options:s,chart:l});layouts.configure(l,c,s),layouts.addBox(l,c)},stop(l){layouts.removeBox(l,l.legend),delete l.legend},beforeUpdate(l,o,s){const c=l.legend;layouts.configure(l,c,s),c.options=s},afterUpdate(l){const o=l.legend;o.buildLabels(),o.adjustHitBoxes()},afterEvent(l,o){o.replay||l.legend.handleEvent(o.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(l,o,s){const c=o.datasetIndex,h=s.chart;h.isDatasetVisible(c)?(h.hide(c),o.hidden=!0):(h.show(c),o.hidden=!1)},onHover:null,onLeave:null,labels:{color:l=>l.chart.options.color,boxWidth:40,padding:10,generateLabels(l){const o=l.data.datasets,{labels:{usePointStyle:s,pointStyle:c,textAlign:h,color:d}}=l.legend.options;return l._getSortedDatasetMetas().map(p=>{const Co=p.controller.getStyle(s?0:void 0),Bo=toPadding(Co.borderWidth);return{text:o[p.index].label,fillStyle:Co.backgroundColor,fontColor:d,hidden:!p.visible,lineCap:Co.borderCapStyle,lineDash:Co.borderDash,lineDashOffset:Co.borderDashOffset,lineJoin:Co.borderJoinStyle,lineWidth:(Bo.width+Bo.height)/4,strokeStyle:Co.borderColor,pointStyle:c||Co.pointStyle,rotation:Co.rotation,textAlign:h||Co.textAlign,borderRadius:0,datasetIndex:p.index}},this)}},title:{color:l=>l.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:l=>!l.startsWith("on"),labels:{_scriptable:l=>!["generateLabels","filter","sort"].includes(l)}}};class Title extends Element$1{constructor(o){super(),this.chart=o.chart,this.options=o.options,this.ctx=o.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(o,s){const c=this,h=c.options;if(c.left=0,c.top=0,!h.display){c.width=c.height=c.right=c.bottom=0;return}c.width=c.right=o,c.height=c.bottom=s;const d=isArray(h.text)?h.text.length:1;c._padding=toPadding(h.padding);const p=d*toFont(h.font).lineHeight+c._padding.height;c.isHorizontal()?c.height=p:c.width=p}isHorizontal(){const o=this.options.position;return o==="top"||o==="bottom"}_drawArgs(o){const{top:s,left:c,bottom:h,right:d,options:p}=this,Co=p.align;let Bo=0,Lo,Uo,Qo;return this.isHorizontal()?(Uo=_alignStartEnd(Co,c,d),Qo=s+o,Lo=d-c):(p.position==="left"?(Uo=c+o,Qo=_alignStartEnd(Co,h,s),Bo=PI*-.5):(Uo=d-o,Qo=_alignStartEnd(Co,s,h),Bo=PI*.5),Lo=h-s),{titleX:Uo,titleY:Qo,maxWidth:Lo,rotation:Bo}}draw(){const o=this,s=o.ctx,c=o.options;if(!c.display)return;const h=toFont(c.font),p=h.lineHeight/2+o._padding.top,{titleX:Co,titleY:Bo,maxWidth:Lo,rotation:Uo}=o._drawArgs(p);renderText(s,c.text,0,0,h,{color:c.color,maxWidth:Lo,rotation:Uo,textAlign:_toLeftRightCenter(c.align),textBaseline:"middle",translation:[Co,Bo]})}}function createTitle(l,o){const s=new Title({ctx:l.ctx,options:o,chart:l});layouts.configure(l,s,o),layouts.addBox(l,s),l.titleBlock=s}var plugin_title={id:"title",_element:Title,start(l,o,s){createTitle(l,s)},stop(l){const o=l.titleBlock;layouts.removeBox(l,o),delete l.titleBlock},beforeUpdate(l,o,s){const c=l.titleBlock;layouts.configure(l,c,s),c.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const positioners={average(l){if(!l.length)return!1;let o,s,c=0,h=0,d=0;for(o=0,s=l.length;o<s;++o){const p=l[o].element;if(p&&p.hasValue()){const Co=p.tooltipPosition();c+=Co.x,h+=Co.y,++d}}return{x:c/d,y:h/d}},nearest(l,o){let s=o.x,c=o.y,h=Number.POSITIVE_INFINITY,d,p,Co;for(d=0,p=l.length;d<p;++d){const Bo=l[d].element;if(Bo&&Bo.hasValue()){const Lo=Bo.getCenterPoint(),Uo=distanceBetweenPoints(o,Lo);Uo<h&&(h=Uo,Co=Bo)}}if(Co){const Bo=Co.tooltipPosition();s=Bo.x,c=Bo.y}return{x:s,y:c}}};function pushOrConcat(l,o){return o&&(isArray(o)?Array.prototype.push.apply(l,o):l.push(o)),l}function splitNewlines(l){return(typeof l=="string"||l instanceof String)&&l.indexOf(`
`)>-1?l.split(`
`):l}function createTooltipItem(l,o){const{element:s,datasetIndex:c,index:h}=o,d=l.getDatasetMeta(c).controller,{label:p,value:Co}=d.getLabelAndValue(h);return{chart:l,label:p,parsed:d.getParsed(h),raw:l.data.datasets[c].data[h],formattedValue:Co,dataset:d.getDataset(),dataIndex:h,datasetIndex:c,element:s}}function getTooltipSize(l,o){const s=l._chart.ctx,{body:c,footer:h,title:d}=l,{boxWidth:p,boxHeight:Co}=o,Bo=toFont(o.bodyFont),Lo=toFont(o.titleFont),Uo=toFont(o.footerFont),Qo=d.length,Po=h.length,Mo=c.length,Go=toPadding(o.padding);let $o=Go.height,jo=0,zo=c.reduce((Wo,es)=>Wo+es.before.length+es.lines.length+es.after.length,0);if(zo+=l.beforeBody.length+l.afterBody.length,Qo&&($o+=Qo*Lo.lineHeight+(Qo-1)*o.titleSpacing+o.titleMarginBottom),zo){const Wo=o.displayColors?Math.max(Co,Bo.lineHeight):Bo.lineHeight;$o+=Mo*Wo+(zo-Mo)*Bo.lineHeight+(zo-1)*o.bodySpacing}Po&&($o+=o.footerMarginTop+Po*Uo.lineHeight+(Po-1)*o.footerSpacing);let Xo=0;const Zo=function(Wo){jo=Math.max(jo,s.measureText(Wo).width+Xo)};return s.save(),s.font=Lo.string,each(l.title,Zo),s.font=Bo.string,each(l.beforeBody.concat(l.afterBody),Zo),Xo=o.displayColors?p+2:0,each(c,Wo=>{each(Wo.before,Zo),each(Wo.lines,Zo),each(Wo.after,Zo)}),Xo=0,s.font=Uo.string,each(l.footer,Zo),s.restore(),jo+=Go.width,{width:jo,height:$o}}function determineYAlign(l,o){const{y:s,height:c}=o;return s<c/2?"top":s>l.height-c/2?"bottom":"center"}function doesNotFitWithAlign(l,o,s,c){const{x:h,width:d}=c,p=s.caretSize+s.caretPadding;if(l==="left"&&h+d+p>o.width||l==="right"&&h-d-p<0)return!0}function determineXAlign(l,o,s,c){const{x:h,width:d}=s,{width:p,chartArea:{left:Co,right:Bo}}=l;let Lo="center";return c==="center"?Lo=h<=(Co+Bo)/2?"left":"right":h<=d/2?Lo="left":h>=p-d/2&&(Lo="right"),doesNotFitWithAlign(Lo,l,o,s)&&(Lo="center"),Lo}function determineAlignment(l,o,s){const c=o.yAlign||determineYAlign(l,s);return{xAlign:o.xAlign||determineXAlign(l,o,s,c),yAlign:c}}function alignX(l,o){let{x:s,width:c}=l;return o==="right"?s-=c:o==="center"&&(s-=c/2),s}function alignY(l,o,s){let{y:c,height:h}=l;return o==="top"?c+=s:o==="bottom"?c-=h+s:c-=h/2,c}function getBackgroundPoint(l,o,s,c){const{caretSize:h,caretPadding:d,cornerRadius:p}=l,{xAlign:Co,yAlign:Bo}=s,Lo=h+d,Uo=p+d;let Qo=alignX(o,Co);const Po=alignY(o,Bo,Lo);return Bo==="center"?Co==="left"?Qo+=Lo:Co==="right"&&(Qo-=Lo):Co==="left"?Qo-=Uo:Co==="right"&&(Qo+=Uo),{x:_limitValue(Qo,0,c.width-o.width),y:_limitValue(Po,0,c.height-o.height)}}function getAlignedX(l,o,s){const c=toPadding(s.padding);return o==="center"?l.x+l.width/2:o==="right"?l.x+l.width-c.right:l.x+c.left}function getBeforeAfterBodyLines(l){return pushOrConcat([],splitNewlines(l))}function createTooltipContext(l,o,s){return Object.assign(Object.create(l),{tooltip:o,tooltipItems:s,type:"tooltip"})}function overrideCallbacks(l,o){const s=o&&o.dataset&&o.dataset.tooltip&&o.dataset.tooltip.callbacks;return s?l.override(s):l}class Tooltip extends Element$1{constructor(o){super(),this.opacity=0,this._active=[],this._chart=o._chart,this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.options=o.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(o){this.options=o,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const o=this,s=o._cachedAnimations;if(s)return s;const c=o._chart,h=o.options.setContext(o.getContext()),d=h.enabled&&c.options.animation&&h.animations,p=new Animations(o._chart,d);return d._cacheable&&(o._cachedAnimations=Object.freeze(p)),p}getContext(){const o=this;return o.$context||(o.$context=createTooltipContext(o._chart.getContext(),o,o._tooltipItems))}getTitle(o,s){const c=this,{callbacks:h}=s,d=h.beforeTitle.apply(c,[o]),p=h.title.apply(c,[o]),Co=h.afterTitle.apply(c,[o]);let Bo=[];return Bo=pushOrConcat(Bo,splitNewlines(d)),Bo=pushOrConcat(Bo,splitNewlines(p)),Bo=pushOrConcat(Bo,splitNewlines(Co)),Bo}getBeforeBody(o,s){return getBeforeAfterBodyLines(s.callbacks.beforeBody.apply(this,[o]))}getBody(o,s){const c=this,{callbacks:h}=s,d=[];return each(o,p=>{const Co={before:[],lines:[],after:[]},Bo=overrideCallbacks(h,p);pushOrConcat(Co.before,splitNewlines(Bo.beforeLabel.call(c,p))),pushOrConcat(Co.lines,Bo.label.call(c,p)),pushOrConcat(Co.after,splitNewlines(Bo.afterLabel.call(c,p))),d.push(Co)}),d}getAfterBody(o,s){return getBeforeAfterBodyLines(s.callbacks.afterBody.apply(this,[o]))}getFooter(o,s){const c=this,{callbacks:h}=s,d=h.beforeFooter.apply(c,[o]),p=h.footer.apply(c,[o]),Co=h.afterFooter.apply(c,[o]);let Bo=[];return Bo=pushOrConcat(Bo,splitNewlines(d)),Bo=pushOrConcat(Bo,splitNewlines(p)),Bo=pushOrConcat(Bo,splitNewlines(Co)),Bo}_createItems(o){const s=this,c=s._active,h=s._chart.data,d=[],p=[],Co=[];let Bo=[],Lo,Uo;for(Lo=0,Uo=c.length;Lo<Uo;++Lo)Bo.push(createTooltipItem(s._chart,c[Lo]));return o.filter&&(Bo=Bo.filter((Qo,Po,Mo)=>o.filter(Qo,Po,Mo,h))),o.itemSort&&(Bo=Bo.sort((Qo,Po)=>o.itemSort(Qo,Po,h))),each(Bo,Qo=>{const Po=overrideCallbacks(o.callbacks,Qo);d.push(Po.labelColor.call(s,Qo)),p.push(Po.labelPointStyle.call(s,Qo)),Co.push(Po.labelTextColor.call(s,Qo))}),s.labelColors=d,s.labelPointStyles=p,s.labelTextColors=Co,s.dataPoints=Bo,Bo}update(o,s){const c=this,h=c.options.setContext(c.getContext()),d=c._active;let p,Co=[];if(!d.length)c.opacity!==0&&(p={opacity:0});else{const Bo=positioners[h.position].call(c,d,c._eventPosition);Co=c._createItems(h),c.title=c.getTitle(Co,h),c.beforeBody=c.getBeforeBody(Co,h),c.body=c.getBody(Co,h),c.afterBody=c.getAfterBody(Co,h),c.footer=c.getFooter(Co,h);const Lo=c._size=getTooltipSize(c,h),Uo=Object.assign({},Bo,Lo),Qo=determineAlignment(c._chart,h,Uo),Po=getBackgroundPoint(h,Uo,Qo,c._chart);c.xAlign=Qo.xAlign,c.yAlign=Qo.yAlign,p={opacity:1,x:Po.x,y:Po.y,width:Lo.width,height:Lo.height,caretX:Bo.x,caretY:Bo.y}}c._tooltipItems=Co,c.$context=void 0,p&&c._resolveAnimations().update(c,p),o&&h.external&&h.external.call(c,{chart:c._chart,tooltip:c,replay:s})}drawCaret(o,s,c,h){const d=this.getCaretPosition(o,c,h);s.lineTo(d.x1,d.y1),s.lineTo(d.x2,d.y2),s.lineTo(d.x3,d.y3)}getCaretPosition(o,s,c){const{xAlign:h,yAlign:d}=this,{cornerRadius:p,caretSize:Co}=c,{x:Bo,y:Lo}=o,{width:Uo,height:Qo}=s;let Po,Mo,Go,$o,jo,zo;return d==="center"?(jo=Lo+Qo/2,h==="left"?(Po=Bo,Mo=Po-Co,$o=jo+Co,zo=jo-Co):(Po=Bo+Uo,Mo=Po+Co,$o=jo-Co,zo=jo+Co),Go=Po):(h==="left"?Mo=Bo+p+Co:h==="right"?Mo=Bo+Uo-p-Co:Mo=this.caretX,d==="top"?($o=Lo,jo=$o-Co,Po=Mo-Co,Go=Mo+Co):($o=Lo+Qo,jo=$o+Co,Po=Mo+Co,Go=Mo-Co),zo=$o),{x1:Po,x2:Mo,x3:Go,y1:$o,y2:jo,y3:zo}}drawTitle(o,s,c){const h=this,d=h.title,p=d.length;let Co,Bo,Lo;if(p){const Uo=getRtlAdapter(c.rtl,h.x,h.width);for(o.x=getAlignedX(h,c.titleAlign,c),s.textAlign=Uo.textAlign(c.titleAlign),s.textBaseline="middle",Co=toFont(c.titleFont),Bo=c.titleSpacing,s.fillStyle=c.titleColor,s.font=Co.string,Lo=0;Lo<p;++Lo)s.fillText(d[Lo],Uo.x(o.x),o.y+Co.lineHeight/2),o.y+=Co.lineHeight+Bo,Lo+1===p&&(o.y+=c.titleMarginBottom-Bo)}}_drawColorBox(o,s,c,h,d){const p=this,Co=p.labelColors[c],Bo=p.labelPointStyles[c],{boxHeight:Lo,boxWidth:Uo}=d,Qo=toFont(d.bodyFont),Po=getAlignedX(p,"left",d),Mo=h.x(Po),Go=Lo<Qo.lineHeight?(Qo.lineHeight-Lo)/2:0,$o=s.y+Go;if(d.usePointStyle){const jo={radius:Math.min(Uo,Lo)/2,pointStyle:Bo.pointStyle,rotation:Bo.rotation,borderWidth:1},zo=h.leftForLtr(Mo,Uo)+Uo/2,Xo=$o+Lo/2;o.strokeStyle=d.multiKeyBackground,o.fillStyle=d.multiKeyBackground,drawPoint(o,jo,zo,Xo),o.strokeStyle=Co.borderColor,o.fillStyle=Co.backgroundColor,drawPoint(o,jo,zo,Xo)}else{o.lineWidth=Co.borderWidth||1,o.strokeStyle=Co.borderColor,o.setLineDash(Co.borderDash||[]),o.lineDashOffset=Co.borderDashOffset||0;const jo=h.leftForLtr(Mo,Uo),zo=h.leftForLtr(h.xPlus(Mo,1),Uo-2),Xo=toTRBLCorners(Co.borderRadius);Object.values(Xo).some(Zo=>Zo!==0)?(o.beginPath(),o.fillStyle=d.multiKeyBackground,addRoundedRectPath(o,{x:jo,y:$o,w:Uo,h:Lo,radius:Xo}),o.fill(),o.stroke(),o.fillStyle=Co.backgroundColor,o.beginPath(),addRoundedRectPath(o,{x:zo,y:$o+1,w:Uo-2,h:Lo-2,radius:Xo}),o.fill()):(o.fillStyle=d.multiKeyBackground,o.fillRect(jo,$o,Uo,Lo),o.strokeRect(jo,$o,Uo,Lo),o.fillStyle=Co.backgroundColor,o.fillRect(zo,$o+1,Uo-2,Lo-2))}o.fillStyle=p.labelTextColors[c]}drawBody(o,s,c){const h=this,{body:d}=h,{bodySpacing:p,bodyAlign:Co,displayColors:Bo,boxHeight:Lo,boxWidth:Uo}=c,Qo=toFont(c.bodyFont);let Po=Qo.lineHeight,Mo=0;const Go=getRtlAdapter(c.rtl,h.x,h.width),$o=function(Ko){s.fillText(Ko,Go.x(o.x+Mo),o.y+Po/2),o.y+=Po+p},jo=Go.textAlign(Co);let zo,Xo,Zo,Wo,es,is,Jo;for(s.textAlign=Co,s.textBaseline="middle",s.font=Qo.string,o.x=getAlignedX(h,jo,c),s.fillStyle=c.bodyColor,each(h.beforeBody,$o),Mo=Bo&&jo!=="right"?Co==="center"?Uo/2+1:Uo+2:0,Wo=0,is=d.length;Wo<is;++Wo){for(zo=d[Wo],Xo=h.labelTextColors[Wo],s.fillStyle=Xo,each(zo.before,$o),Zo=zo.lines,Bo&&Zo.length&&(h._drawColorBox(s,o,Wo,Go,c),Po=Math.max(Qo.lineHeight,Lo)),es=0,Jo=Zo.length;es<Jo;++es)$o(Zo[es]),Po=Qo.lineHeight;each(zo.after,$o)}Mo=0,Po=Qo.lineHeight,each(h.afterBody,$o),o.y-=p}drawFooter(o,s,c){const h=this,d=h.footer,p=d.length;let Co,Bo;if(p){const Lo=getRtlAdapter(c.rtl,h.x,h.width);for(o.x=getAlignedX(h,c.footerAlign,c),o.y+=c.footerMarginTop,s.textAlign=Lo.textAlign(c.footerAlign),s.textBaseline="middle",Co=toFont(c.footerFont),s.fillStyle=c.footerColor,s.font=Co.string,Bo=0;Bo<p;++Bo)s.fillText(d[Bo],Lo.x(o.x),o.y+Co.lineHeight/2),o.y+=Co.lineHeight+c.footerSpacing}}drawBackground(o,s,c,h){const{xAlign:d,yAlign:p}=this,{x:Co,y:Bo}=o,{width:Lo,height:Uo}=c,Qo=h.cornerRadius;s.fillStyle=h.backgroundColor,s.strokeStyle=h.borderColor,s.lineWidth=h.borderWidth,s.beginPath(),s.moveTo(Co+Qo,Bo),p==="top"&&this.drawCaret(o,s,c,h),s.lineTo(Co+Lo-Qo,Bo),s.quadraticCurveTo(Co+Lo,Bo,Co+Lo,Bo+Qo),p==="center"&&d==="right"&&this.drawCaret(o,s,c,h),s.lineTo(Co+Lo,Bo+Uo-Qo),s.quadraticCurveTo(Co+Lo,Bo+Uo,Co+Lo-Qo,Bo+Uo),p==="bottom"&&this.drawCaret(o,s,c,h),s.lineTo(Co+Qo,Bo+Uo),s.quadraticCurveTo(Co,Bo+Uo,Co,Bo+Uo-Qo),p==="center"&&d==="left"&&this.drawCaret(o,s,c,h),s.lineTo(Co,Bo+Qo),s.quadraticCurveTo(Co,Bo,Co+Qo,Bo),s.closePath(),s.fill(),h.borderWidth>0&&s.stroke()}_updateAnimationTarget(o){const s=this,c=s._chart,h=s.$animations,d=h&&h.x,p=h&&h.y;if(d||p){const Co=positioners[o.position].call(s,s._active,s._eventPosition);if(!Co)return;const Bo=s._size=getTooltipSize(s,o),Lo=Object.assign({},Co,s._size),Uo=determineAlignment(c,o,Lo),Qo=getBackgroundPoint(o,Lo,Uo,c);(d._to!==Qo.x||p._to!==Qo.y)&&(s.xAlign=Uo.xAlign,s.yAlign=Uo.yAlign,s.width=Bo.width,s.height=Bo.height,s.caretX=Co.x,s.caretY=Co.y,s._resolveAnimations().update(s,Qo))}}draw(o){const s=this,c=s.options.setContext(s.getContext());let h=s.opacity;if(!h)return;s._updateAnimationTarget(c);const d={width:s.width,height:s.height},p={x:s.x,y:s.y};h=Math.abs(h)<.001?0:h;const Co=toPadding(c.padding),Bo=s.title.length||s.beforeBody.length||s.body.length||s.afterBody.length||s.footer.length;c.enabled&&Bo&&(o.save(),o.globalAlpha=h,s.drawBackground(p,o,d,c),overrideTextDirection(o,c.textDirection),p.y+=Co.top,s.drawTitle(p,o,c),s.drawBody(p,o,c),s.drawFooter(p,o,c),restoreTextDirection(o,c.textDirection),o.restore())}getActiveElements(){return this._active||[]}setActiveElements(o,s){const c=this,h=c._active,d=o.map(({datasetIndex:Bo,index:Lo})=>{const Uo=c._chart.getDatasetMeta(Bo);if(!Uo)throw new Error("Cannot find a dataset at index "+Bo);return{datasetIndex:Bo,element:Uo.data[Lo],index:Lo}}),p=!_elementsEqual(h,d),Co=c._positionChanged(d,s);(p||Co)&&(c._active=d,c._eventPosition=s,c.update(!0))}handleEvent(o,s){const c=this,h=c.options,d=c._active||[];let p=!1,Co=[];o.type!=="mouseout"&&(Co=c._chart.getElementsAtEventForMode(o,h.mode,h,s),h.reverse&&Co.reverse());const Bo=c._positionChanged(Co,o);return p=s||!_elementsEqual(Co,d)||Bo,p&&(c._active=Co,(h.enabled||h.external)&&(c._eventPosition={x:o.x,y:o.y},c.update(!0,s))),p}_positionChanged(o,s){const c=this,h=positioners[c.options.position].call(c,o,s);return c.caretX!==h.x||c.caretY!==h.y}}Tooltip.positioners=positioners;var plugin_tooltip={id:"tooltip",_element:Tooltip,positioners,afterInit(l,o,s){s&&(l.tooltip=new Tooltip({_chart:l,options:s}))},beforeUpdate(l,o,s){l.tooltip&&l.tooltip.initialize(s)},reset(l,o,s){l.tooltip&&l.tooltip.initialize(s)},afterDraw(l){const o=l.tooltip,s={tooltip:o};l.notifyPlugins("beforeTooltipDraw",s)!==!1&&(o&&o.draw(l.ctx),l.notifyPlugins("afterTooltipDraw",s))},afterEvent(l,o){if(l.tooltip){const s=o.replay;l.tooltip.handleEvent(o.event,s)&&(o.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(l,o)=>o.bodyFont.size,boxWidth:(l,o)=>o.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:noop,title(l){if(l.length>0){const o=l[0],s=o.chart.data.labels,c=s?s.length:0;if(this&&this.options&&this.options.mode==="dataset")return o.dataset.label||"";if(o.label)return o.label;if(c>0&&o.dataIndex<c)return s[o.dataIndex]}return""},afterTitle:noop,beforeBody:noop,beforeLabel:noop,label(l){if(this&&this.options&&this.options.mode==="dataset")return l.label+": "+l.formattedValue||l.formattedValue;let o=l.dataset.label||"";o&&(o+=": ");const s=l.formattedValue;return isNullOrUndef(s)||(o+=s),o},labelColor(l){const s=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{borderColor:s.borderColor,backgroundColor:s.backgroundColor,borderWidth:s.borderWidth,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(l){const s=l.chart.getDatasetMeta(l.datasetIndex).controller.getStyle(l.dataIndex);return{pointStyle:s.pointStyle,rotation:s.rotation}},afterLabel:noop,afterBody:noop,beforeFooter:noop,footer:noop,afterFooter:noop}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:l=>l!=="filter"&&l!=="itemSort"&&l!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const addIfString=(l,o,s)=>typeof o=="string"?l.push(o)-1:isNaN(o)?null:s;function findOrAddLabel(l,o,s){const c=l.indexOf(o);if(c===-1)return addIfString(l,o,s);const h=l.lastIndexOf(o);return c!==h?s:c}const validIndex=(l,o)=>l===null?null:_limitValue(Math.round(l),0,o);class CategoryScale extends Scale{constructor(o){super(o),this._startValue=void 0,this._valueRange=0}parse(o,s){if(isNullOrUndef(o))return null;const c=this.getLabels();return s=isFinite(s)&&c[s]===o?s:findOrAddLabel(c,o,valueOrDefault(s,o)),validIndex(s,c.length-1)}determineDataLimits(){const o=this,{minDefined:s,maxDefined:c}=o.getUserBounds();let{min:h,max:d}=o.getMinMax(!0);o.options.bounds==="ticks"&&(s||(h=0),c||(d=o.getLabels().length-1)),o.min=h,o.max=d}buildTicks(){const o=this,s=o.min,c=o.max,h=o.options.offset,d=[];let p=o.getLabels();p=s===0&&c===p.length-1?p:p.slice(s,c+1),o._valueRange=Math.max(p.length-(h?0:1),1),o._startValue=o.min-(h?.5:0);for(let Co=s;Co<=c;Co++)d.push({value:Co});return d}getLabelForValue(o){const c=this.getLabels();return o>=0&&o<c.length?c[o]:o}configure(){const o=this;super.configure(),o.isHorizontal()||(o._reversePixels=!o._reversePixels)}getPixelForValue(o){const s=this;return typeof o!="number"&&(o=s.parse(o)),o===null?NaN:s.getPixelForDecimal((o-s._startValue)/s._valueRange)}getPixelForTick(o){const s=this,c=s.ticks;return o<0||o>c.length-1?null:s.getPixelForValue(c[o].value)}getValueForPixel(o){const s=this;return Math.round(s._startValue+s.getDecimalForPixel(o)*s._valueRange)}getBasePixel(){return this.bottom}}CategoryScale.id="category";CategoryScale.defaults={ticks:{callback:CategoryScale.prototype.getLabelForValue}};function generateTicks$1(l,o){const s=[],{step:h,min:d,max:p,precision:Co,count:Bo,maxTicks:Lo}=l,Uo=h||1,Qo=Lo-1,{min:Po,max:Mo}=o,Go=!isNullOrUndef(d),$o=!isNullOrUndef(p),jo=!isNullOrUndef(Bo);let zo=niceNum((Mo-Po)/Qo/Uo)*Uo,Xo,Zo,Wo,es;if(zo<1e-14&&!Go&&!$o)return[{value:Po},{value:Mo}];es=Math.ceil(Mo/zo)-Math.floor(Po/zo),es>Qo&&(zo=niceNum(es*zo/Qo/Uo)*Uo),isNullOrUndef(Co)||(Xo=Math.pow(10,Co),zo=Math.ceil(zo*Xo)/Xo),Zo=Math.floor(Po/zo)*zo,Wo=Math.ceil(Mo/zo)*zo,Go&&$o&&h&&almostWhole((p-d)/h,zo/1e3)?(es=Math.min((p-d)/zo,Lo),zo=(p-d)/es,Zo=d,Wo=p):jo?(Zo=Go?d:Zo,Wo=$o?p:Wo,es=Bo-1,zo=(Wo-Zo)/es):(es=(Wo-Zo)/zo,almostEquals(es,Math.round(es),zo/1e3)?es=Math.round(es):es=Math.ceil(es)),Xo=Math.pow(10,isNullOrUndef(Co)?_decimalPlaces(zo):Co),Zo=Math.round(Zo*Xo)/Xo,Wo=Math.round(Wo*Xo)/Xo;let is=0;for(Go&&(s.push({value:d}),Zo<=d&&is++,almostEquals(Math.round((Zo+is*zo)*Xo)/Xo,d,zo/10)&&is++);is<es;++is)s.push({value:Math.round((Zo+is*zo)*Xo)/Xo});return $o?almostEquals(s[s.length-1].value,p,zo/10)?s[s.length-1].value=p:s.push({value:p}):s.push({value:Wo}),s}class LinearScaleBase extends Scale{constructor(o){super(o),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(o,s){return isNullOrUndef(o)||(typeof o=="number"||o instanceof Number)&&!isFinite(+o)?null:+o}handleTickRangeOptions(){const o=this,{beginAtZero:s,stacked:c}=o.options,{minDefined:h,maxDefined:d}=o.getUserBounds();let{min:p,max:Co}=o;const Bo=Uo=>p=h?p:Uo,Lo=Uo=>Co=d?Co:Uo;if(s||c){const Uo=sign(p),Qo=sign(Co);Uo<0&&Qo<0?Lo(0):Uo>0&&Qo>0&&Bo(0)}p===Co&&(Lo(Co+1),s||Bo(p-1)),o.min=p,o.max=Co}getTickLimit(){const o=this,s=o.options.ticks;let{maxTicksLimit:c,stepSize:h}=s,d;return h?d=Math.ceil(o.max/h)-Math.floor(o.min/h)+1:(d=o.computeTickLimit(),c=c||11),c&&(d=Math.min(c,d)),d}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const o=this,s=o.options,c=s.ticks;let h=o.getTickLimit();h=Math.max(2,h);const d={maxTicks:h,min:s.min,max:s.max,precision:c.precision,step:c.stepSize,count:c.count},p=generateTicks$1(d,_addGrace(o,s.grace));return s.bounds==="ticks"&&_setMinAndMaxByKey(p,o,"value"),s.reverse?(p.reverse(),o.start=o.max,o.end=o.min):(o.start=o.min,o.end=o.max),p}configure(){const o=this,s=o.ticks;let c=o.min,h=o.max;if(super.configure(),o.options.offset&&s.length){const d=(h-c)/Math.max(s.length-1,1)/2;c-=d,h+=d}o._startValue=c,o._endValue=h,o._valueRange=h-c}getLabelForValue(o){return formatNumber(o,this.chart.options.locale)}}class LinearScale extends LinearScaleBase{determineDataLimits(){const o=this,{min:s,max:c}=o.getMinMax(!0);o.min=isNumberFinite(s)?s:0,o.max=isNumberFinite(c)?c:1,o.handleTickRangeOptions()}computeTickLimit(){const o=this;if(o.isHorizontal())return Math.ceil(o.width/40);const s=o._resolveTickFontOptions(0);return Math.ceil(o.height/s.lineHeight)}getPixelForValue(o){return o===null?NaN:this.getPixelForDecimal((o-this._startValue)/this._valueRange)}getValueForPixel(o){return this._startValue+this.getDecimalForPixel(o)*this._valueRange}}LinearScale.id="linear";LinearScale.defaults={ticks:{callback:Ticks.formatters.numeric}};function isMajor(l){return l/Math.pow(10,Math.floor(log10(l)))===1}function generateTicks(l,o){const s=Math.floor(log10(o.max)),c=Math.ceil(o.max/Math.pow(10,s)),h=[];let d=finiteOrDefault(l.min,Math.pow(10,Math.floor(log10(o.min)))),p=Math.floor(log10(d)),Co=Math.floor(d/Math.pow(10,p)),Bo=p<0?Math.pow(10,Math.abs(p)):1;do h.push({value:d,major:isMajor(d)}),++Co,Co===10&&(Co=1,++p,Bo=p>=0?1:Bo),d=Math.round(Co*Math.pow(10,p)*Bo)/Bo;while(p<s||p===s&&Co<c);const Lo=finiteOrDefault(l.max,d);return h.push({value:Lo,major:isMajor(d)}),h}class LogarithmicScale extends Scale{constructor(o){super(o),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(o,s){const c=LinearScaleBase.prototype.parse.apply(this,[o,s]);if(c===0){this._zero=!0;return}return isNumberFinite(c)&&c>0?c:null}determineDataLimits(){const o=this,{min:s,max:c}=o.getMinMax(!0);o.min=isNumberFinite(s)?Math.max(0,s):null,o.max=isNumberFinite(c)?Math.max(0,c):null,o.options.beginAtZero&&(o._zero=!0),o.handleTickRangeOptions()}handleTickRangeOptions(){const o=this,{minDefined:s,maxDefined:c}=o.getUserBounds();let h=o.min,d=o.max;const p=Lo=>h=s?h:Lo,Co=Lo=>d=c?d:Lo,Bo=(Lo,Uo)=>Math.pow(10,Math.floor(log10(Lo))+Uo);h===d&&(h<=0?(p(1),Co(10)):(p(Bo(h,-1)),Co(Bo(d,1)))),h<=0&&p(Bo(d,-1)),d<=0&&Co(Bo(h,1)),o._zero&&o.min!==o._suggestedMin&&h===Bo(o.min,0)&&p(Bo(h,-1)),o.min=h,o.max=d}buildTicks(){const o=this,s=o.options,c={min:o._userMin,max:o._userMax},h=generateTicks(c,o);return s.bounds==="ticks"&&_setMinAndMaxByKey(h,o,"value"),s.reverse?(h.reverse(),o.start=o.max,o.end=o.min):(o.start=o.min,o.end=o.max),h}getLabelForValue(o){return o===void 0?"0":formatNumber(o,this.chart.options.locale)}configure(){const o=this,s=o.min;super.configure(),o._startValue=log10(s),o._valueRange=log10(o.max)-log10(s)}getPixelForValue(o){const s=this;return(o===void 0||o===0)&&(o=s.min),o===null||isNaN(o)?NaN:s.getPixelForDecimal(o===s.min?0:(log10(o)-s._startValue)/s._valueRange)}getValueForPixel(o){const s=this,c=s.getDecimalForPixel(o);return Math.pow(10,s._startValue+c*s._valueRange)}}LogarithmicScale.id="logarithmic";LogarithmicScale.defaults={ticks:{callback:Ticks.formatters.logarithmic,major:{enabled:!0}}};function getTickBackdropHeight(l){const o=l.ticks;if(o.display&&l.display){const s=toPadding(o.backdropPadding);return valueOrDefault(o.font&&o.font.size,defaults.font.size)+s.height}return 0}function measureLabelSize(l,o,s){return isArray(s)?{w:_longestText(l,l.font,s),h:s.length*o}:{w:l.measureText(s).width,h:o}}function determineLimits(l,o,s,c,h){return l===c||l===h?{start:o-s/2,end:o+s/2}:l<c||l>h?{start:o-s,end:o}:{start:o,end:o+s}}function fitWithPointLabels(l){const o={l:0,r:l.width,t:0,b:l.height-l.paddingTop},s={};let c,h,d;const p=[],Co=[],Bo=l.getLabels().length;for(c=0;c<Bo;c++){const Po=l.options.pointLabels.setContext(l.getContext(c));Co[c]=Po.padding,d=l.getPointPosition(c,l.drawingArea+Co[c]);const Mo=toFont(Po.font);l.ctx.font=Mo.string,h=measureLabelSize(l.ctx,Mo.lineHeight,l._pointLabels[c]),p[c]=h;const Go=l.getIndexAngle(c),$o=toDegrees(Go),jo=determineLimits($o,d.x,h.w,0,180),zo=determineLimits($o,d.y,h.h,90,270);jo.start<o.l&&(o.l=jo.start,s.l=Go),jo.end>o.r&&(o.r=jo.end,s.r=Go),zo.start<o.t&&(o.t=zo.start,s.t=Go),zo.end>o.b&&(o.b=zo.end,s.b=Go)}l._setReductions(l.drawingArea,o,s),l._pointLabelItems=[];const Lo=l.options,Uo=getTickBackdropHeight(Lo),Qo=l.getDistanceFromCenterForValue(Lo.ticks.reverse?l.min:l.max);for(c=0;c<Bo;c++){const Po=c===0?Uo/2:0,Mo=l.getPointPosition(c,Qo+Po+Co[c]),Go=toDegrees(l.getIndexAngle(c)),$o=p[c];adjustPointPositionForLabelHeight(Go,$o,Mo);const jo=getTextAlignForAngle(Go);let zo;jo==="left"?zo=Mo.x:jo==="center"?zo=Mo.x-$o.w/2:zo=Mo.x-$o.w;const Xo=zo+$o.w;l._pointLabelItems[c]={x:Mo.x,y:Mo.y,textAlign:jo,left:zo,top:Mo.y,right:Xo,bottom:Mo.y+$o.h}}}function getTextAlignForAngle(l){return l===0||l===180?"center":l<180?"left":"right"}function adjustPointPositionForLabelHeight(l,o,s){l===90||l===270?s.y-=o.h/2:(l>270||l<90)&&(s.y-=o.h)}function drawPointLabels(l,o){const{ctx:s,options:{pointLabels:c}}=l;for(let h=o-1;h>=0;h--){const d=c.setContext(l.getContext(h)),p=toFont(d.font),{x:Co,y:Bo,textAlign:Lo,left:Uo,top:Qo,right:Po,bottom:Mo}=l._pointLabelItems[h],{backdropColor:Go}=d;if(!isNullOrUndef(Go)){const $o=toPadding(d.backdropPadding);s.fillStyle=Go,s.fillRect(Uo-$o.left,Qo-$o.top,Po-Uo+$o.width,Mo-Qo+$o.height)}renderText(s,l._pointLabels[h],Co,Bo+p.lineHeight/2,p,{color:d.color,textAlign:Lo,textBaseline:"middle"})}}function pathRadiusLine(l,o,s,c){const{ctx:h}=l;if(s)h.arc(l.xCenter,l.yCenter,o,0,TAU);else{let d=l.getPointPosition(0,o);h.moveTo(d.x,d.y);for(let p=1;p<c;p++)d=l.getPointPosition(p,o),h.lineTo(d.x,d.y)}}function drawRadiusLine(l,o,s,c){const h=l.ctx,d=o.circular,{color:p,lineWidth:Co}=o;!d&&!c||!p||!Co||s<0||(h.save(),h.strokeStyle=p,h.lineWidth=Co,h.setLineDash(o.borderDash),h.lineDashOffset=o.borderDashOffset,h.beginPath(),pathRadiusLine(l,s,d,c),h.closePath(),h.stroke(),h.restore())}function numberOrZero(l){return isNumber(l)?l:0}class RadialLinearScale extends LinearScaleBase{constructor(o){super(o),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const o=this;o.width=o.maxWidth,o.height=o.maxHeight,o.paddingTop=getTickBackdropHeight(o.options)/2,o.xCenter=Math.floor(o.width/2),o.yCenter=Math.floor((o.height-o.paddingTop)/2),o.drawingArea=Math.min(o.height-o.paddingTop,o.width)/2}determineDataLimits(){const o=this,{min:s,max:c}=o.getMinMax(!1);o.min=isNumberFinite(s)&&!isNaN(s)?s:0,o.max=isNumberFinite(c)&&!isNaN(c)?c:0,o.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/getTickBackdropHeight(this.options))}generateTickLabels(o){const s=this;LinearScaleBase.prototype.generateTickLabels.call(s,o),s._pointLabels=s.getLabels().map((c,h)=>{const d=callback(s.options.pointLabels.callback,[c,h],s);return d||d===0?d:""})}fit(){const o=this,s=o.options;s.display&&s.pointLabels.display?fitWithPointLabels(o):o.setCenterPoint(0,0,0,0)}_setReductions(o,s,c){const h=this;let d=s.l/Math.sin(c.l),p=Math.max(s.r-h.width,0)/Math.sin(c.r),Co=-s.t/Math.cos(c.t),Bo=-Math.max(s.b-(h.height-h.paddingTop),0)/Math.cos(c.b);d=numberOrZero(d),p=numberOrZero(p),Co=numberOrZero(Co),Bo=numberOrZero(Bo),h.drawingArea=Math.max(o/2,Math.min(Math.floor(o-(d+p)/2),Math.floor(o-(Co+Bo)/2))),h.setCenterPoint(d,p,Co,Bo)}setCenterPoint(o,s,c,h){const d=this,p=d.width-s-d.drawingArea,Co=o+d.drawingArea,Bo=c+d.drawingArea,Lo=d.height-d.paddingTop-h-d.drawingArea;d.xCenter=Math.floor((Co+p)/2+d.left),d.yCenter=Math.floor((Bo+Lo)/2+d.top+d.paddingTop)}getIndexAngle(o){const s=TAU/this.getLabels().length,c=this.options.startAngle||0;return _normalizeAngle(o*s+toRadians(c))}getDistanceFromCenterForValue(o){const s=this;if(isNullOrUndef(o))return NaN;const c=s.drawingArea/(s.max-s.min);return s.options.reverse?(s.max-o)*c:(o-s.min)*c}getValueForDistanceFromCenter(o){if(isNullOrUndef(o))return NaN;const s=this,c=o/(s.drawingArea/(s.max-s.min));return s.options.reverse?s.max-c:s.min+c}getPointPosition(o,s){const c=this,h=c.getIndexAngle(o)-HALF_PI;return{x:Math.cos(h)*s+c.xCenter,y:Math.sin(h)*s+c.yCenter,angle:h}}getPointPositionForValue(o,s){return this.getPointPosition(o,this.getDistanceFromCenterForValue(s))}getBasePosition(o){return this.getPointPositionForValue(o||0,this.getBaseValue())}getPointLabelPosition(o){const{left:s,top:c,right:h,bottom:d}=this._pointLabelItems[o];return{left:s,top:c,right:h,bottom:d}}drawBackground(){const o=this,{backgroundColor:s,grid:{circular:c}}=o.options;if(s){const h=o.ctx;h.save(),h.beginPath(),pathRadiusLine(o,o.getDistanceFromCenterForValue(o._endValue),c,o.getLabels().length),h.closePath(),h.fillStyle=s,h.fill(),h.restore()}}drawGrid(){const o=this,s=o.ctx,c=o.options,{angleLines:h,grid:d}=c,p=o.getLabels().length;let Co,Bo,Lo;if(c.pointLabels.display&&drawPointLabels(o,p),d.display&&o.ticks.forEach((Uo,Qo)=>{if(Qo!==0){Bo=o.getDistanceFromCenterForValue(Uo.value);const Po=d.setContext(o.getContext(Qo-1));drawRadiusLine(o,Po,Bo,p)}}),h.display){for(s.save(),Co=o.getLabels().length-1;Co>=0;Co--){const Uo=h.setContext(o.getContext(Co)),{color:Qo,lineWidth:Po}=Uo;!Po||!Qo||(s.lineWidth=Po,s.strokeStyle=Qo,s.setLineDash(Uo.borderDash),s.lineDashOffset=Uo.borderDashOffset,Bo=o.getDistanceFromCenterForValue(c.ticks.reverse?o.min:o.max),Lo=o.getPointPosition(Co,Bo),s.beginPath(),s.moveTo(o.xCenter,o.yCenter),s.lineTo(Lo.x,Lo.y),s.stroke())}s.restore()}}drawLabels(){const o=this,s=o.ctx,c=o.options,h=c.ticks;if(!h.display)return;const d=o.getIndexAngle(0);let p,Co;s.save(),s.translate(o.xCenter,o.yCenter),s.rotate(d),s.textAlign="center",s.textBaseline="middle",o.ticks.forEach((Bo,Lo)=>{if(Lo===0&&!c.reverse)return;const Uo=h.setContext(o.getContext(Lo)),Qo=toFont(Uo.font);if(p=o.getDistanceFromCenterForValue(o.ticks[Lo].value),Uo.showLabelBackdrop){Co=s.measureText(Bo.label).width,s.fillStyle=Uo.backdropColor;const Po=toPadding(Uo.backdropPadding);s.fillRect(-Co/2-Po.left,-p-Qo.size/2-Po.top,Co+Po.width,Qo.size+Po.height)}renderText(s,Bo.label,0,-p,Qo,{color:Uo.color})}),s.restore()}drawTitle(){}}RadialLinearScale.id="radialLinear";RadialLinearScale.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPadding:2,callback:Ticks.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(l){return l},padding:5}};RadialLinearScale.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};RadialLinearScale.descriptors={angleLines:{_fallback:"grid"}};const INTERVALS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},UNITS=Object.keys(INTERVALS);function sorter(l,o){return l-o}function parse$1(l,o){if(isNullOrUndef(o))return null;const s=l._adapter,c=l.options.time,{parser:h,round:d,isoWeekday:p}=c;let Co=o;return typeof h=="function"&&(Co=h(Co)),isNumberFinite(Co)||(Co=typeof h=="string"?s.parse(Co,h):s.parse(Co)),Co===null?null:(d&&(Co=d==="week"&&(isNumber(p)||p===!0)?s.startOf(Co,"isoWeek",p):s.startOf(Co,d)),+Co)}function determineUnitForAutoTicks(l,o,s,c){const h=UNITS.length;for(let d=UNITS.indexOf(l);d<h-1;++d){const p=INTERVALS[UNITS[d]],Co=p.steps?p.steps:Number.MAX_SAFE_INTEGER;if(p.common&&Math.ceil((s-o)/(Co*p.size))<=c)return UNITS[d]}return UNITS[h-1]}function determineUnitForFormatting(l,o,s,c,h){for(let d=UNITS.length-1;d>=UNITS.indexOf(s);d--){const p=UNITS[d];if(INTERVALS[p].common&&l._adapter.diff(h,c,p)>=o-1)return p}return UNITS[s?UNITS.indexOf(s):0]}function determineMajorUnit(l){for(let o=UNITS.indexOf(l)+1,s=UNITS.length;o<s;++o)if(INTERVALS[UNITS[o]].common)return UNITS[o]}function addTick(l,o,s){if(!s)l[o]=!0;else if(s.length){const{lo:c,hi:h}=_lookup(s,o),d=s[c]>=o?s[c]:s[h];l[d]=!0}}function setMajorTicks(l,o,s,c){const h=l._adapter,d=+h.startOf(o[0].value,c),p=o[o.length-1].value;let Co,Bo;for(Co=d;Co<=p;Co=+h.add(Co,1,c))Bo=s[Co],Bo>=0&&(o[Bo].major=!0);return o}function ticksFromTimestamps(l,o,s){const c=[],h={},d=o.length;let p,Co;for(p=0;p<d;++p)Co=o[p],h[Co]=p,c.push({value:Co,major:!1});return d===0||!s?c:setMajorTicks(l,c,h,s)}class TimeScale extends Scale{constructor(o){super(o),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1}init(o,s){const c=o.time||(o.time={}),h=this._adapter=new adapters._date(o.adapters.date);mergeIf(c.displayFormats,h.formats()),super.init(o),this._normalized=s.normalized}parse(o,s){return o===void 0?null:parse$1(this,o)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const o=this,s=o.options,c=o._adapter,h=s.time.unit||"day";let{min:d,max:p,minDefined:Co,maxDefined:Bo}=o.getUserBounds();function Lo(Uo){!Co&&!isNaN(Uo.min)&&(d=Math.min(d,Uo.min)),!Bo&&!isNaN(Uo.max)&&(p=Math.max(p,Uo.max))}(!Co||!Bo)&&(Lo(o._getLabelBounds()),(s.bounds!=="ticks"||s.ticks.source!=="labels")&&Lo(o.getMinMax(!1))),d=isNumberFinite(d)&&!isNaN(d)?d:+c.startOf(Date.now(),h),p=isNumberFinite(p)&&!isNaN(p)?p:+c.endOf(Date.now(),h)+1,o.min=Math.min(d,p-1),o.max=Math.max(d+1,p)}_getLabelBounds(){const o=this.getLabelTimestamps();let s=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;return o.length&&(s=o[0],c=o[o.length-1]),{min:s,max:c}}buildTicks(){const o=this,s=o.options,c=s.time,h=s.ticks,d=h.source==="labels"?o.getLabelTimestamps():o._generate();s.bounds==="ticks"&&d.length&&(o.min=o._userMin||d[0],o.max=o._userMax||d[d.length-1]);const p=o.min,Co=o.max,Bo=_filterBetween(d,p,Co);return o._unit=c.unit||(h.autoSkip?determineUnitForAutoTicks(c.minUnit,o.min,o.max,o._getLabelCapacity(p)):determineUnitForFormatting(o,Bo.length,c.minUnit,o.min,o.max)),o._majorUnit=!h.major.enabled||o._unit==="year"?void 0:determineMajorUnit(o._unit),o.initOffsets(d),s.reverse&&Bo.reverse(),ticksFromTimestamps(o,Bo,o._majorUnit)}initOffsets(o){const s=this;let c=0,h=0,d,p;s.options.offset&&o.length&&(d=s.getDecimalForValue(o[0]),o.length===1?c=1-d:c=(s.getDecimalForValue(o[1])-d)/2,p=s.getDecimalForValue(o[o.length-1]),o.length===1?h=p:h=(p-s.getDecimalForValue(o[o.length-2]))/2);const Co=o.length<3?.5:.25;c=_limitValue(c,0,Co),h=_limitValue(h,0,Co),s._offsets={start:c,end:h,factor:1/(c+1+h)}}_generate(){const o=this,s=o._adapter,c=o.min,h=o.max,d=o.options,p=d.time,Co=p.unit||determineUnitForAutoTicks(p.minUnit,c,h,o._getLabelCapacity(c)),Bo=valueOrDefault(p.stepSize,1),Lo=Co==="week"?p.isoWeekday:!1,Uo=isNumber(Lo)||Lo===!0,Qo={};let Po=c,Mo,Go;if(Uo&&(Po=+s.startOf(Po,"isoWeek",Lo)),Po=+s.startOf(Po,Uo?"day":Co),s.diff(h,c,Co)>1e5*Bo)throw new Error(c+" and "+h+" are too far apart with stepSize of "+Bo+" "+Co);const $o=d.ticks.source==="data"&&o.getDataTimestamps();for(Mo=Po,Go=0;Mo<h;Mo=+s.add(Mo,Bo,Co),Go++)addTick(Qo,Mo,$o);return(Mo===h||d.bounds==="ticks"||Go===1)&&addTick(Qo,Mo,$o),Object.keys(Qo).sort((jo,zo)=>jo-zo).map(jo=>+jo)}getLabelForValue(o){const s=this,c=s._adapter,h=s.options.time;return h.tooltipFormat?c.format(o,h.tooltipFormat):c.format(o,h.displayFormats.datetime)}_tickFormatFunction(o,s,c,h){const d=this,p=d.options,Co=p.time.displayFormats,Bo=d._unit,Lo=d._majorUnit,Uo=Bo&&Co[Bo],Qo=Lo&&Co[Lo],Po=c[s],Mo=Lo&&Qo&&Po&&Po.major,Go=d._adapter.format(o,h||(Mo?Qo:Uo)),$o=p.ticks.callback;return $o?callback($o,[Go,s,c],d):Go}generateTickLabels(o){let s,c,h;for(s=0,c=o.length;s<c;++s)h=o[s],h.label=this._tickFormatFunction(h.value,s,o)}getDecimalForValue(o){const s=this;return o===null?NaN:(o-s.min)/(s.max-s.min)}getPixelForValue(o){const s=this,c=s._offsets,h=s.getDecimalForValue(o);return s.getPixelForDecimal((c.start+h)*c.factor)}getValueForPixel(o){const s=this,c=s._offsets,h=s.getDecimalForPixel(o)/c.factor-c.end;return s.min+h*(s.max-s.min)}_getLabelSize(o){const s=this,c=s.options.ticks,h=s.ctx.measureText(o).width,d=toRadians(s.isHorizontal()?c.maxRotation:c.minRotation),p=Math.cos(d),Co=Math.sin(d),Bo=s._resolveTickFontOptions(0).size;return{w:h*p+Bo*Co,h:h*Co+Bo*p}}_getLabelCapacity(o){const s=this,c=s.options.time,h=c.displayFormats,d=h[c.unit]||h.millisecond,p=s._tickFormatFunction(o,0,ticksFromTimestamps(s,[o],s._majorUnit),d),Co=s._getLabelSize(p),Bo=Math.floor(s.isHorizontal()?s.width/Co.w:s.height/Co.h)-1;return Bo>0?Bo:1}getDataTimestamps(){const o=this;let s=o._cache.data||[],c,h;if(s.length)return s;const d=o.getMatchingVisibleMetas();if(o._normalized&&d.length)return o._cache.data=d[0].controller.getAllParsedValues(o);for(c=0,h=d.length;c<h;++c)s=s.concat(d[c].controller.getAllParsedValues(o));return o._cache.data=o.normalize(s)}getLabelTimestamps(){const o=this,s=o._cache.labels||[];let c,h;if(s.length)return s;const d=o.getLabels();for(c=0,h=d.length;c<h;++c)s.push(parse$1(o,d[c]));return o._cache.labels=o._normalized?s:o.normalize(s)}normalize(o){return _arrayUnique(o.sort(sorter))}}TimeScale.id="time";TimeScale.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function interpolate(l,o,s){let c,h,d,p;if(s)c=Math.floor(o),h=Math.ceil(o),d=l[c],p=l[h];else{const Bo=_lookup(l,o);d=Bo.lo,p=Bo.hi,c=l[d],h=l[p]}const Co=h-c;return Co?d+(p-d)*(o-c)/Co:d}class TimeSeriesScale extends TimeScale{constructor(o){super(o),this._table=[],this._maxIndex=void 0}initOffsets(){const o=this,s=o._getTimestampsForTable();o._table=o.buildLookupTable(s),o._maxIndex=o._table.length-1,super.initOffsets(s)}buildLookupTable(o){const s=this,{min:c,max:h}=s;if(!o.length)return[{time:c,pos:0},{time:h,pos:1}];const d=[c];let p,Co,Bo;for(p=0,Co=o.length;p<Co;++p)Bo=o[p],Bo>c&&Bo<h&&d.push(Bo);return d.push(h),d}_getTimestampsForTable(){const o=this;let s=o._cache.all||[];if(s.length)return s;const c=o.getDataTimestamps(),h=o.getLabelTimestamps();return c.length&&h.length?s=o.normalize(c.concat(h)):s=c.length?c:h,s=o._cache.all=s,s}getPixelForValue(o,s){const c=this,h=c._offsets,d=c._normalized&&c._maxIndex>0&&!isNullOrUndef(s)?s/c._maxIndex:c.getDecimalForValue(o);return c.getPixelForDecimal((h.start+d)*h.factor)}getDecimalForValue(o){return interpolate(this._table,o)/this._maxIndex}getValueForPixel(o){const s=this,c=s._offsets,h=s.getDecimalForPixel(o)/c.factor-c.end;return interpolate(s._table,h*this._maxIndex,!0)}}TimeSeriesScale.id="timeseries";TimeSeriesScale.defaults=TimeScale.defaults;function create_fragment$j(l){let o;return{c(){o=element("canvas"),attr(o,"width","400"),attr(o,"height","200")},m(s,c){insert(s,o,c),l[3](o)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o),l[3](null)}}}function instance$j(l,o,s){Chart.register(BarElement,BarController,CategoryScale,LinearScale,plugin_legend,plugin_title,plugin_tooltip);let{chartData:c}=o,h,d;function p(Co){binding_callbacks[Co?"unshift":"push"](()=>{h=Co,s(0,h)})}return l.$$set=Co=>{"chartData"in Co&&s(1,c=Co.chartData)},l.$$.update=()=>{l.$$.dirty&7&&c&&h&&(d?(s(2,d.data=c,d),d.update()):s(2,d=new Chart(h,{type:"bar",data:c,options:{legend:{display:!1},title:{display:!1}}})))},[h,c,d,p]}class BarChart extends SvelteComponent{constructor(o){super(),init(this,o,instance$j,create_fragment$j,safe_not_equal,{chartData:1})}}const datasetStatsChart_svelte_svelte_type_style_lang="";function get_each_context$2(l,o,s){const c=l.slice();return c[32]=o[s],c}function create_else_block_1$3(l){let o,s,c;return s=new Loader$1({}),{c(){o=element("div"),create_component(s.$$.fragment),attr(o,"class","loader svelte-1xdbnrx")},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},p:noop$2,i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function create_if_block$b(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo;function Go(Wo,es){if(Wo[3]=="daily")return create_if_block_2$4;if(Wo[3]=="weekly")return create_if_block_3$3;if(Wo[3]=="monthly")return create_if_block_4$3}let $o=Go(l),jo=$o&&$o(l);function zo(Wo,es){return(Bo==null||es[0]&7)&&(Bo=!!(Wo[1]&&(Wo[0].createdByID==Wo[2]||Wo[0].admins&&Wo[0].admins.includes(Wo[2])))),Bo?create_if_block_1$6:create_else_block$8}let Xo=zo(l,[-1,-1]),Zo=Xo(l);return Uo=new BarChart({props:{chartData:l[5]}}),{c(){jo&&jo.c(),o=space(),s=element("div"),c=element("select"),h=element("option"),h.textContent="Daily",d=element("option"),d.textContent="Weekly",p=element("option"),p.textContent="Monthly",Co=space(),Zo.c(),Lo=space(),create_component(Uo.$$.fragment),h.__value="daily",h.value=h.__value,h.selected=!0,d.__value="weekly",d.value=d.__value,d.selected=!0,p.__value="monthly",p.value=p.__value,attr(c,"class","time-select svelte-1xdbnrx"),l[3]===void 0&&add_render_callback(()=>l[7].call(c)),attr(s,"class","chart-div svelte-1xdbnrx")},m(Wo,es){jo&&jo.m(Wo,es),insert(Wo,o,es),insert(Wo,s,es),append(s,c),append(c,h),append(c,d),append(c,p),select_option(c,l[3]),append(s,Co),Zo.m(s,null),append(s,Lo),mount_component(Uo,s,null),Qo=!0,Po||(Mo=listen(c,"change",l[7]),Po=!0)},p(Wo,es){$o!==($o=Go(Wo))&&(jo&&jo.d(1),jo=$o&&$o(Wo),jo&&(jo.c(),jo.m(o.parentNode,o))),es[0]&8&&select_option(c,Wo[3]),Xo===(Xo=zo(Wo,es))&&Zo?Zo.p(Wo,es):(Zo.d(1),Zo=Xo(Wo),Zo&&(Zo.c(),Zo.m(s,Lo)));const is={};es[0]&32&&(is.chartData=Wo[5]),Uo.$set(is)},i(Wo){Qo||(transition_in(Uo.$$.fragment,Wo),Qo=!0)},o(Wo){transition_out(Uo.$$.fragment,Wo),Qo=!1},d(Wo){jo&&jo.d(Wo),Wo&&detach(o),Wo&&detach(s),Zo.d(),destroy_component(Uo),Po=!1,Mo()}}}function create_if_block_4$3(l){let o;return{c(){o=element("div"),o.textContent="Dataset stats for last six months",attr(o,"class","chart-title svelte-1xdbnrx")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_3$3(l){let o;return{c(){o=element("div"),o.textContent="Dataset stats for last six weeks",attr(o,"class","chart-title svelte-1xdbnrx")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_if_block_2$4(l){let o;return{c(){o=element("div"),o.textContent="Dataset stats for last six days",attr(o,"class","chart-title svelte-1xdbnrx")},m(s,c){insert(s,o,c)},d(s){s&&detach(o)}}}function create_else_block$8(l){let o,s,c,h,d,p;return{c(){o=element("select"),s=element("option"),s.textContent="All",c=element("option"),h=text("Just mine"),s.__value="",s.value=s.__value,s.selected=!0,c.__value=l[2],c.value=c.__value,attr(o,"class","profile-select svelte-1xdbnrx"),l[4]===void 0&&add_render_callback(()=>l[10].call(o))},m(Co,Bo){insert(Co,o,Bo),append(o,s),append(o,c),append(c,h),select_option(o,l[4]),d||(p=listen(o,"change",l[10]),d=!0)},p(Co,Bo){Bo[0]&4&&(c.__value=Co[2],c.value=c.__value),Bo[0]&20&&select_option(o,Co[4])},d(Co){Co&&detach(o),d=!1,p()}}}function create_if_block_1$6(l){let o,s,c,h,d=l[0].georeferencers.sort(l[8]),p=[];for(let Co=0;Co<d.length;Co+=1)p[Co]=create_each_block$2(get_each_context$2(l,d,Co));return{c(){o=element("select"),s=element("option"),s.textContent="All";for(let Co=0;Co<p.length;Co+=1)p[Co].c();s.__value="",s.value=s.__value,s.selected=!0,attr(o,"class","profile-select svelte-1xdbnrx"),l[4]===void 0&&add_render_callback(()=>l[9].call(o))},m(Co,Bo){insert(Co,o,Bo),append(o,s);for(let Lo=0;Lo<p.length;Lo+=1)p[Lo].m(o,null);select_option(o,l[4]),c||(h=listen(o,"change",l[9]),c=!0)},p(Co,Bo){if(Bo[0]&3){d=Co[0].georeferencers.sort(Co[8]);let Lo;for(Lo=0;Lo<d.length;Lo+=1){const Uo=get_each_context$2(Co,d,Lo);p[Lo]?p[Lo].p(Uo,Bo):(p[Lo]=create_each_block$2(Uo),p[Lo].c(),p[Lo].m(o,null))}for(;Lo<p.length;Lo+=1)p[Lo].d(1);p.length=d.length}Bo[0]&20&&select_option(o,Co[4])},d(Co){Co&&detach(o),destroy_each(p,Co),c=!1,h()}}}function create_each_block$2(l){let o,s=l[1][l[32]].firstName+"",c,h;return{c(){o=element("option"),c=text(s),o.__value=h=l[32],o.value=o.__value},m(d,p){insert(d,o,p),append(o,c)},p(d,p){p[0]&3&&s!==(s=d[1][d[32]].firstName+"")&&set_data(c,s),p[0]&3&&h!==(h=d[32])&&(o.__value=h,o.value=o.__value)},d(d){d&&detach(o)}}}function create_fragment$i(l){let o,s,c,h;const d=[create_if_block$b,create_else_block_1$3],p=[];function Co(Bo,Lo){return Bo[5]?0:1}return o=Co(l),s=p[o]=d[o](l),{c(){s.c(),c=empty$1()},m(Bo,Lo){p[o].m(Bo,Lo),insert(Bo,c,Lo),h=!0},p(Bo,Lo){let Uo=o;o=Co(Bo),o===Uo?p[o].p(Bo,Lo):(group_outros(),transition_out(p[Uo],1,1,()=>{p[Uo]=null}),check_outros(),s=p[o],s?s.p(Bo,Lo):(s=p[o]=d[o](Bo),s.c()),transition_in(s,1),s.m(c.parentNode,c))},i(Bo){h||(transition_in(s),h=!0)},o(Bo){transition_out(s),h=!1},d(Bo){p[o].d(Bo),Bo&&detach(c)}}}function instance$i(l,o,s){let{dataset:c}=o,{profilesIndex:h=null}=o,{userID:d}=o,{size:p=6}=o,Co,Bo,Lo,Uo,Qo={},Po,Mo;const Go=["Sun","Mon","Tues","Wed","Thur","Fri","Sat"],$o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let jo=["#c3c388","#77b300"],zo=["#ff944d","#cc5200"];onMount(ds=>{Zo(p,"weekly",null)});const Xo=async ds=>{if(Po)if(Mo)Qo[Mo]&&Qo[Mo][Po]?s(5,Co=Qo[Mo]&&Qo[Mo][Po]):await Zo(p,Po,Mo);else{let hs=!1;Po=="daily"&&Bo&&(s(5,Co=Bo),hs=!0),Po=="weekly"&&Lo&&(s(5,Co=Lo),hs=!0),Po=="monthly"&&Uo&&(s(5,Co=Uo),hs=!0),hs||Zo(p,Po,null)}},Zo=async(ds,hs,ys)=>{let ms=await es(ds,hs,ys),Rs=Wo(ms,hs);ys?(Qo[ys]||(Qo[ys]={}),Qo[ys][hs]=Rs):(hs=="daily"&&(Bo=Rs),hs=="weekly"&&(Lo=Rs),hs=="monthly"&&(Uo=Rs)),s(5,Co=Rs)},Wo=(ds,hs)=>{let ys=[],ms=[],Rs=[];for(let[ps,ks]of Object.entries(ds))ys.push(ps),ms.push(ks.georefsAdded),Rs.push(ks.recordsGeoreferenced);return hs=="daily"&&(ys=ys.map(ps=>{let xs=new Date(ps).getDay();return Go[xs]})),hs=="weekly"&&(ys=ys.map(ps=>{let ks=ps.split(" ");return as(ks[1],ks[0])})),hs=="monthly"&&(ys=ys.map(ps=>{let ks=ps.split(" "),xs=Number(ks[1])-1;return ks[1]=$o[xs],ks.reverse(),ks.join(" ")})),{labels:ys,datasets:[{label:"georefs",data:ms,borderColor:zo[1],backgroundColor:zo[0]},{label:"records",data:Rs,borderColor:jo[1],backgroundColor:jo[0]}]}},es=async(ds,hs,ys)=>{let ms;hs=="daily"&&(ms=Ko(ds)),hs=="weekly"&&(ms=Yo(ds)),hs=="monthly"&&(ms=ts(ds));let Rs={};for(let ps of ms){let ks;ys?ks=`stats/perDataset/${c.datasetID}/perUser/${ys}/${hs}/${ps}`:ks=`stats/perDataset/${c.datasetID}/${hs}/${ps}`,Rs[ps]=Realtime.ref(ks).once("value")}await Promise.all(Object.values(Rs));let bs={};for(let[ps,ks]of Object.entries(Rs))ks.then(xs=>{xs.exists()?bs[ps]=xs.val():bs[ps]={georefsAdded:0,recordsGeoreferenced:0}});return bs},is=ds=>{ds=new Date(Date.UTC(ds.getFullYear(),ds.getMonth(),ds.getDate())),ds.setUTCDate(ds.getUTCDate()+4-(ds.getUTCDay()||7));var hs=new Date(Date.UTC(ds.getUTCFullYear(),0,1)),ys=Math.ceil(((ds-hs)/864e5+1)/7);return`${ds.getUTCFullYear()} ${ys.toString().padStart(2,"0")}`},Jo=ds=>{let hs=ds.getUTCFullYear(),ys=ds.getMonth()+1;return`${hs} ${ys.toString().padStart(2,"0")}`},Ko=ds=>{let hs=[],ys=us();hs.push(ys);let ms=new Date(ys);for(let Rs=1;Rs<ds;Rs++){ms.setDate(ms.getDate()-1);let bs=ms.toISOString().split("T")[0];hs.push(bs)}return hs.reverse(),hs},Yo=ds=>{let hs=[],ys=is(new Date);for(hs.push(ys);hs.length<ds;)ys=ss(ys),hs.push(ys);return hs.reverse(),hs},ts=ds=>{let hs=[],ys=Jo(new Date);for(hs.push(ys);hs.length<ds;)ys=cs(ys),hs.push(ys);return hs.reverse(),hs},ss=ds=>{let hs=ds.split(" "),ys=as(hs[1],hs[0]);return ys=new Date(ys),ys.setDate(ys.getDate()-7),is(ys)},cs=ds=>{let hs=ds.split(" "),ys=new Date(hs[0],hs[1],1);ys.setMonth(ys.getMonth()-1),ys=ys.toISOString().split("T")[0];let ms=ys.split("-");return ms.pop(),ms.join(" ")},as=(ds,hs)=>{var ys=new Date(hs,0,1+(ds-1)*7),ms=ys.getDay(),Rs=ys;return ms<=4?Rs.setDate(ys.getDate()-ys.getDay()+1):Rs.setDate(ys.getDate()+8-ys.getDay()),Rs.setDate(Rs.getDate()+1),Rs.toISOString().split("T")[0]},us=ds=>{let hs=new Date;return new Date(hs.getTime()-hs.getTimezoneOffset()*60*1e3).toISOString().split("T")[0]};function gs(){Po=select_value(this),s(3,Po)}const Is=(ds,hs)=>h[ds].firstName.toLowerCase().localeCompare(h[hs].firstName.toLowerCase());function _s(){Mo=select_value(this),s(4,Mo),s(2,d)}function Hs(){Mo=select_value(this),s(4,Mo),s(2,d)}return l.$$set=ds=>{"dataset"in ds&&s(0,c=ds.dataset),"profilesIndex"in ds&&s(1,h=ds.profilesIndex),"userID"in ds&&s(2,d=ds.userID),"size"in ds&&s(6,p=ds.size)},l.$$.update=()=>{l.$$.dirty[0]&24&&Xo()},[c,h,d,Po,Mo,Co,p,gs,Is,_s,Hs]}class DatasetStatsChart extends SvelteComponent{constructor(o){super(),init(this,o,instance$i,create_fragment$i,safe_not_equal,{dataset:0,profilesIndex:1,userID:2,size:6},null,[-1,-1])}}const datasetUserStatsChart_svelte_svelte_type_style_lang="";function create_else_block$7(l){let o,s,c;return s=new Loader$1({}),{c(){o=element("div"),create_component(s.$$.fragment),attr(o,"class","svelte-14p48bc")},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},p:noop$2,i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function create_if_block$a(l){let o,s;return o=new BarChart({props:{chartData:l[0]}}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h&1&&(d.chartData=c[0]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_fragment$h(l){let o,s,c,h;const d=[create_if_block$a,create_else_block$7],p=[];function Co(Bo,Lo){return Bo[0]?0:1}return o=Co(l),s=p[o]=d[o](l),{c(){s.c(),c=empty$1()},m(Bo,Lo){p[o].m(Bo,Lo),insert(Bo,c,Lo),h=!0},p(Bo,[Lo]){let Uo=o;o=Co(Bo),o===Uo?p[o].p(Bo,Lo):(group_outros(),transition_out(p[Uo],1,1,()=>{p[Uo]=null}),check_outros(),s=p[o],s?s.p(Bo,Lo):(s=p[o]=d[o](Bo),s.c()),transition_in(s,1),s.m(c.parentNode,c))},i(Bo){h||(transition_in(s),h=!0)},o(Bo){transition_out(s),h=!1},d(Bo){p[o].d(Bo),Bo&&detach(c)}}}function instance$h(l,o,s){let{dataset:c}=o,{profilesIndex:h}=o,d,p=["#c3c388","#77b300"],Co=["#ff944d","#cc5200"];const Bo=async Lo=>{let Uo=Realtime.ref("stats/perDataset/"+c.datasetID+"/perUser/"+Lo+"/georefsAdded").once("value"),Qo=Realtime.ref("stats/perDataset/"+c.datasetID+"/perUser/"+Lo+"/recordsGeoreferenced").once("value");return(await Promise.all([Uo,Qo])).map(Go=>Go.val())};return l.$$set=Lo=>{"dataset"in Lo&&s(1,c=Lo.dataset),"profilesIndex"in Lo&&s(2,h=Lo.profilesIndex)},l.$$.update=()=>{if(l.$$.dirty&6&&c&&h){let Lo=[],Uo=[],Qo=[],Po=[];for(let[Mo,Go]of Object.entries(h))c.georeferencers.includes(Mo)&&(Po.push(Bo(Mo)),Lo.push(Go.firstName));Promise.all(Po).then(Mo=>{for(let Go of Mo)Uo.push(Go[0]),Qo.push(Go[1]);s(0,d={labels:Lo,datasets:[{label:"georefs",data:Uo,borderColor:Co[1],backgroundColor:Co[0]},{label:"records",data:Qo,borderColor:p[1],backgroundColor:p[0]}]})})}},[d,c,h]}class DatasetUserStatsChart extends SvelteComponent{constructor(o){super(),init(this,o,instance$h,create_fragment$h,safe_not_equal,{dataset:1,profilesIndex:2})}}function create_fragment$g(l){let o;return{c(){o=element("canvas"),attr(o,"width","400"),attr(o,"height","200")},m(s,c){insert(s,o,c),l[3](o)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o),l[3](null)}}}function instance$g(l,o,s){Chart.register(LineElement,PointElement,LineController,LinearScale,CategoryScale,plugin_legend,plugin_title,plugin_tooltip);let{chartData:c}=o,h,d;function p(Co){binding_callbacks[Co?"unshift":"push"](()=>{h=Co,s(0,h)})}return l.$$set=Co=>{"chartData"in Co&&s(1,c=Co.chartData)},l.$$.update=()=>{l.$$.dirty&7&&c&&h&&(d?(s(2,d.data=c,d),d.update()):s(2,d=new Chart(h,{type:"line",data:c,options:{legend:{display:!1},title:{display:!1},scales:{y:{min:0,max:100}}}})))},[h,c,d,p]}class LineChart extends SvelteComponent{constructor(o){super(),init(this,o,instance$g,create_fragment$g,safe_not_equal,{chartData:1})}}const datasetProgressChart_svelte_svelte_type_style_lang="";function create_else_block$6(l){let o,s,c;return s=new Loader$1({}),{c(){o=element("div"),create_component(s.$$.fragment),attr(o,"class","loader svelte-raifo0")},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},p:noop$2,i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function create_if_block_1$5(l){let o;return{c(){o=element("div")},m(s,c){insert(s,o,c)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o)}}}function create_if_block$9(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po;return Lo=new LineChart({props:{chartData:l[0]}}),{c(){o=element("div"),o.textContent="Dataset completion progress",s=space(),c=element("div"),h=element("select"),d=element("option"),d.textContent="Daily",p=element("option"),p.textContent="Weekly",Co=element("option"),Co.textContent="Monthly",Bo=space(),create_component(Lo.$$.fragment),attr(o,"class","chart-title svelte-raifo0"),d.__value="daily",d.value=d.__value,p.__value="weekly",p.value=p.__value,Co.__value="monthly",Co.value=Co.__value,attr(h,"class","chart-select svelte-raifo0"),l[2]===void 0&&add_render_callback(()=>l[5].call(h)),attr(c,"class","chart-div svelte-raifo0")},m(Mo,Go){insert(Mo,o,Go),insert(Mo,s,Go),insert(Mo,c,Go),append(c,h),append(h,d),append(h,p),append(h,Co),select_option(h,l[2]),append(c,Bo),mount_component(Lo,c,null),Uo=!0,Qo||(Po=[listen(h,"change",l[5]),listen(h,"change",l[6])],Qo=!0)},p(Mo,Go){Go&4&&select_option(h,Mo[2]);const $o={};Go&1&&($o.chartData=Mo[0]),Lo.$set($o)},i(Mo){Uo||(transition_in(Lo.$$.fragment,Mo),Uo=!0)},o(Mo){transition_out(Lo.$$.fragment,Mo),Uo=!1},d(Mo){Mo&&detach(o),Mo&&detach(s),Mo&&detach(c),destroy_component(Lo),Qo=!1,run_all(Po)}}}function create_fragment$f(l){let o,s,c,h;const d=[create_if_block$9,create_if_block_1$5,create_else_block$6],p=[];function Co(Bo,Lo){return Bo[0]?0:Bo[1]?1:2}return o=Co(l),s=p[o]=d[o](l),{c(){s.c(),c=empty$1()},m(Bo,Lo){p[o].m(Bo,Lo),insert(Bo,c,Lo),h=!0},p(Bo,[Lo]){let Uo=o;o=Co(Bo),o===Uo?p[o].p(Bo,Lo):(group_outros(),transition_out(p[Uo],1,1,()=>{p[Uo]=null}),check_outros(),s=p[o],s?s.p(Bo,Lo):(s=p[o]=d[o](Bo),s.c()),transition_in(s,1),s.m(c.parentNode,c))},i(Bo){h||(transition_in(s),h=!0)},o(Bo){transition_out(s),h=!1},d(Bo){p[o].d(Bo),Bo&&detach(c)}}}function instance$f(l,o,s){const c=createEventDispatcher();let{dataset:h}=o,d,p=!1,Co,Bo,Lo,Uo;const Qo=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];onMount(async is=>{let Jo=null;try{Jo=await getSafeTime()}catch(ss){c("componenterror",ss);return}(Jo-h.dateCreated)/(1e3*60*60*24)<21?(s(2,Uo="daily"),Co=await Mo(Uo),s(0,d=Co)):(s(2,Uo="weekly"),Bo=await Mo(Uo),s(0,d=Bo))});const Po=async is=>{is=="daily"&&(Co||(Co=await Mo("daily")),s(0,d=Co)),is=="weekly"&&(Bo||(Bo=await Mo("daily")),s(0,d=Bo)),is=="monthly"&&(Lo||(Lo=await Mo(is)),s(0,d=Lo))},Mo=async is=>{let Jo=await Realtime.ref("stats/perDataset/"+h.datasetID+"/"+is).once("value");if(Jo.exists){let Ko=Jo.val();if(!Ko)return s(1,p=!0),null;let Yo=[],ts=[],ss,cs;if(is=="daily")ss=new Date().toISOString().split("T")[0],cs=Object.keys(Ko).reduce((Hs,ds)=>Hs<ds?Hs:ds,ss);else if(is=="weekly")ss=$o(new Date),cs=Object.keys(Ko).reduce((_s,Hs)=>_s<Hs?_s:Hs,ss);else{let Hs=Zo().split("-");Hs.pop(),ss=Hs.join(" "),cs=Object.keys(Ko).reduce((ds,hs)=>ds<hs?ds:hs,ss)}for(;ss>=cs;){if(is=="daily")Yo.push(ss);else if(is=="weekly"){let _s=ss.split(" ");Yo.push(Go(_s[1],_s[0]))}else{let _s=ss.split(" "),ds=Qo[Number(_s[1])-1]+" "+_s[0];Yo.push(ds)}Ko[ss]?ts.push(Number(Ko[ss].recordsGeoreferenced)):ts.push(0),is=="daily"?ss=jo(ss):is=="weekly"?ss=zo(ss):ss=Xo(ss)}Yo.reverse(),ts.reverse();const as=(_s=>Hs=>_s+=Hs)(0);let gs=ts.map(_s=>Math.round(_s/h.recordCount*100)).map(as);return{labels:Yo,datasets:[{label:"% records complete",data:gs,borderColor:"#606060",backgroundColor:"#A9A9A9"}]}}else return s(1,p=!0),null},Go=(is,Jo)=>{var Ko=new Date(Jo,0,1+(is-1)*7),Yo=Ko.getDay(),ts=Ko;return Yo<=4?ts.setDate(Ko.getDate()-Ko.getDay()+1):ts.setDate(Ko.getDate()+8-Ko.getDay()),ts.setDate(ts.getDate()+1),ts.toISOString().split("T")[0]},$o=is=>{is=new Date(Date.UTC(is.getFullYear(),is.getMonth(),is.getDate())),is.setUTCDate(is.getUTCDate()+4-(is.getUTCDay()||7));var Jo=new Date(Date.UTC(is.getUTCFullYear(),0,1)),Ko=Math.ceil(((is-Jo)/864e5+1)/7);return`${is.getUTCFullYear()} ${Ko.toString().padStart(2,"0")}`},jo=is=>{let Jo=new Date(is),Ko=new Date(Jo.getTime()-24*60*60*1e3);return Ko=Ko.toISOString().split("T")[0],Ko},zo=is=>{let Jo=is.split(" "),Ko=Go(Jo[1],Jo[0]);return Ko=new Date(Ko),Ko.setDate(Ko.getDate()-7),$o(Ko)},Xo=is=>{let Jo=is.split(" ");return Number(Jo[1])==1?(Jo[0]=Number(Jo[0])-1,Jo[1]=12):(Jo[1]=Number(Jo[1])-1,Jo[1]=Jo[1].toString().padStart(2,"0")),Jo.join(" ")},Zo=is=>{let Jo=new Date;return new Date(Jo.getTime()-Jo.getTimezoneOffset()*60*1e3).toISOString().split("T")[0]};function Wo(){Uo=select_value(this),s(2,Uo)}const es=is=>Po(Uo);return l.$$set=is=>{"dataset"in is&&s(4,h=is.dataset)},[d,p,Uo,Po,h,Wo,es]}class DatasetProgressChart extends SvelteComponent{constructor(o){super(),init(this,o,instance$f,create_fragment$f,safe_not_equal,{dataset:4})}}const datasetDetail_svelte_svelte_type_style_lang="";function create_else_block$5(l){let o,s,c,h=l[0].createdByID==l[1].uid||l[0].admins&&l[0].admins.includes(l[1].uid),d,p,Co,Bo,Lo,Uo,Qo=l[0].datasetName+"",Po,Mo,Go,$o,jo,zo,Xo,Zo=l[0].collectionCode+"",Wo,es,is,Jo,Ko,Yo,ts=l[0].region+"",ss,cs,as,us,gs,Is,_s=l[0].domain+"",Hs,ds,hs,ys,ms,Rs,bs=(l[0].dateCreated?l[9](l[0].dateCreated):null)+"",ps,ks,xs,Ss,Us,Ps,Qs=l[0].contactName+"",Js,qs,Gs,Zs,Es,fs,vs=l[0].email+"",Bs,Ls,Fs,zs,js,ma,Ws=(l[0].completed?l[9](l[0].dateCompleted):"NA")+"",va,ca,cl,Ms,$s,ga,Xs=l[0].recordCount+"",ll,sl,nl,pl,El,cA,rl=l[0].recordsCompleted+"",Cl,Ul,Nl,Ll,hl,gl,zl=l[0].groupCount+"",bA,UA,Dl,Kl,vA,Vl,TA=l[0].groupsComplete+"",Tl,xl,ua,_l,uA,fA,hA=(l[0].lastGeoreference?l[10](l[0].lastGeoreference):"NA")+"",Zl,kA,Ml,jl,GA,Ol,yA=(l[0].lastGeoreferenceBy?l[0].lastGeoreferenceBy:"NA")+"",wA,$A,Cs,Al,bl,Wl=l[0].createdByID==l[1].uid||l[0].admins&&l[0].admins.includes(l[1].uid),oA,gA,kl,EA,Ql,JA=l[0].createdByID==l[1].uid||l[0].admins&&l[0].admins.includes(l[1].uid),NA,Yl,xA,xu,Rl=h&&create_if_block_10$1(l);Al=new DatasetProgressChart({props:{dataset:l[0]}});let eA=Wl&&create_if_block_8$1(l);EA=new DatasetStatsChart({props:{dataset:l[0],profilesIndex:l[2],userID:l[1].uid}});let Pl=JA&&create_if_block_3$2(l);return{c(){o=element("div"),s=element("button"),s.innerHTML='<span class="material-icons">list</span>',c=space(),Rl&&Rl.c(),d=space(),p=element("button"),Co=element("span"),Co.textContent="place",Lo=space(),Uo=element("h2"),Po=text(Qo),Mo=space(),Go=element("div"),$o=element("div"),jo=element("span"),jo.textContent="Collection",zo=space(),Xo=element("span"),Wo=text(Zo),es=space(),is=element("div"),Jo=element("span"),Jo.textContent="Region",Ko=space(),Yo=element("span"),ss=text(ts),cs=space(),as=element("div"),us=element("span"),us.textContent="Domain",gs=space(),Is=element("span"),Hs=text(_s),ds=space(),hs=element("div"),ys=element("span"),ys.textContent="Date created",ms=space(),Rs=element("span"),ps=text(bs),ks=space(),xs=element("div"),Ss=element("span"),Ss.textContent="Contact",Us=space(),Ps=element("span"),Js=text(Qs),qs=space(),Gs=element("div"),Zs=element("span"),Zs.textContent="Contact email",Es=space(),fs=element("span"),Bs=text(vs),Ls=space(),Fs=element("div"),zs=element("span"),zs.textContent="Date completed",js=space(),ma=element("span"),va=text(Ws),ca=space(),cl=element("div"),Ms=element("span"),Ms.textContent="Total Records",$s=space(),ga=element("span"),ll=text(Xs),sl=space(),nl=element("div"),pl=element("span"),pl.textContent="Records Completed",El=space(),cA=element("span"),Cl=text(rl),Ul=space(),Nl=element("div"),Ll=element("span"),Ll.textContent="Total groups",hl=space(),gl=element("span"),bA=text(zl),UA=space(),Dl=element("div"),Kl=element("span"),Kl.textContent="Groups complete",vA=space(),Vl=element("span"),Tl=text(TA),xl=space(),ua=element("div"),_l=element("span"),_l.textContent="Last georeference",uA=space(),fA=element("span"),Zl=text(hA),kA=space(),Ml=element("div"),jl=element("span"),jl.textContent="Last georeference by",GA=space(),Ol=element("span"),wA=text(yA),$A=space(),Cs=element("div"),create_component(Al.$$.fragment),bl=space(),eA&&eA.c(),oA=space(),gA=element("div"),kl=space(),create_component(EA.$$.fragment),Ql=space(),Pl&&Pl.c(),NA=empty$1(),attr(s,"class","dataset-tool svelte-1m20jv3"),attr(s,"title","back to datasets"),attr(Co,"class","material-icons"),attr(p,"class","dataset-tool svelte-1m20jv3"),attr(p,"title","start georeferencing"),p.disabled=Bo=l[0].dateCompleted,attr(o,"class","tools-container svelte-1m20jv3"),attr(Uo,"class","svelte-1m20jv3"),attr(jo,"class","label svelte-1m20jv3"),attr(Xo,"class","data-item svelte-1m20jv3"),attr($o,"class","svelte-1m20jv3"),attr(Jo,"class","label svelte-1m20jv3"),attr(Yo,"class","data-item svelte-1m20jv3"),attr(is,"class","svelte-1m20jv3"),attr(us,"class","label svelte-1m20jv3"),attr(Is,"class","data-item svelte-1m20jv3"),attr(as,"class","svelte-1m20jv3"),attr(ys,"class","label svelte-1m20jv3"),attr(Rs,"class","data-item svelte-1m20jv3"),attr(hs,"class","svelte-1m20jv3"),attr(Ss,"class","label svelte-1m20jv3"),attr(Ps,"class","data-item svelte-1m20jv3"),attr(xs,"class","svelte-1m20jv3"),attr(Zs,"class","label svelte-1m20jv3"),attr(fs,"class","data-item svelte-1m20jv3"),attr(Gs,"class","svelte-1m20jv3"),attr(zs,"class","label svelte-1m20jv3"),attr(ma,"class","data-item svelte-1m20jv3"),attr(Fs,"class","svelte-1m20jv3"),attr(Ms,"class","label svelte-1m20jv3"),attr(ga,"class","data-item svelte-1m20jv3"),attr(cl,"class","svelte-1m20jv3"),attr(pl,"class","label svelte-1m20jv3"),attr(cA,"class","data-item svelte-1m20jv3"),attr(nl,"class","svelte-1m20jv3"),attr(Ll,"class","label svelte-1m20jv3"),attr(gl,"class","data-item svelte-1m20jv3"),attr(Nl,"class","svelte-1m20jv3"),attr(Kl,"class","label svelte-1m20jv3"),attr(Vl,"class","data-item svelte-1m20jv3"),attr(Dl,"class","svelte-1m20jv3"),attr(_l,"class","label svelte-1m20jv3"),attr(fA,"class","data-item svelte-1m20jv3"),attr(ua,"class","svelte-1m20jv3"),attr(jl,"class","label svelte-1m20jv3"),attr(Ol,"class","data-item svelte-1m20jv3"),attr(Ml,"class","svelte-1m20jv3"),attr(Go,"class","content svelte-1m20jv3"),attr(gA,"class","chart-spacer svelte-1m20jv3"),attr(Cs,"class","charts svelte-1m20jv3")},m(il,wl){insert(il,o,wl),append(o,s),append(o,c),Rl&&Rl.m(o,null),append(o,d),append(o,p),append(p,Co),l[26](p),insert(il,Lo,wl),insert(il,Uo,wl),append(Uo,Po),insert(il,Mo,wl),insert(il,Go,wl),append(Go,$o),append($o,jo),append($o,zo),append($o,Xo),append(Xo,Wo),append(Go,es),append(Go,is),append(is,Jo),append(is,Ko),append(is,Yo),append(Yo,ss),append(Go,cs),append(Go,as),append(as,us),append(as,gs),append(as,Is),append(Is,Hs),append(Go,ds),append(Go,hs),append(hs,ys),append(hs,ms),append(hs,Rs),append(Rs,ps),append(Go,ks),append(Go,xs),append(xs,Ss),append(xs,Us),append(xs,Ps),append(Ps,Js),append(Go,qs),append(Go,Gs),append(Gs,Zs),append(Gs,Es),append(Gs,fs),append(fs,Bs),append(Go,Ls),append(Go,Fs),append(Fs,zs),append(Fs,js),append(Fs,ma),append(ma,va),append(Go,ca),append(Go,cl),append(cl,Ms),append(cl,$s),append(cl,ga),append(ga,ll),append(Go,sl),append(Go,nl),append(nl,pl),append(nl,El),append(nl,cA),append(cA,Cl),append(Go,Ul),append(Go,Nl),append(Nl,Ll),append(Nl,hl),append(Nl,gl),append(gl,bA),append(Go,UA),append(Go,Dl),append(Dl,Kl),append(Dl,vA),append(Dl,Vl),append(Vl,Tl),append(Go,xl),append(Go,ua),append(ua,_l),append(ua,uA),append(ua,fA),append(fA,Zl),append(Go,kA),append(Go,Ml),append(Ml,jl),append(Ml,GA),append(Ml,Ol),append(Ol,wA),insert(il,$A,wl),insert(il,Cs,wl),mount_component(Al,Cs,null),append(Cs,bl),eA&&eA.m(Cs,null),append(Cs,oA),append(Cs,gA),append(Cs,kl),mount_component(EA,Cs,null),insert(il,Ql,wl),Pl&&Pl.m(il,wl),insert(il,NA,wl),Yl=!0,xA||(xu=[listen(s,"click",l[13]),listen(p,"click",l[11])],xA=!0)},p(il,wl){wl[0]&3&&(h=il[0].createdByID==il[1].uid||il[0].admins&&il[0].admins.includes(il[1].uid)),h?Rl?Rl.p(il,wl):(Rl=create_if_block_10$1(il),Rl.c(),Rl.m(o,d)):Rl&&(Rl.d(1),Rl=null),(!Yl||wl[0]&1&&Bo!==(Bo=il[0].dateCompleted))&&(p.disabled=Bo),(!Yl||wl[0]&1)&&Qo!==(Qo=il[0].datasetName+"")&&set_data(Po,Qo),(!Yl||wl[0]&1)&&Zo!==(Zo=il[0].collectionCode+"")&&set_data(Wo,Zo),(!Yl||wl[0]&1)&&ts!==(ts=il[0].region+"")&&set_data(ss,ts),(!Yl||wl[0]&1)&&_s!==(_s=il[0].domain+"")&&set_data(Hs,_s),(!Yl||wl[0]&1)&&bs!==(bs=(il[0].dateCreated?il[9](il[0].dateCreated):null)+"")&&set_data(ps,bs),(!Yl||wl[0]&1)&&Qs!==(Qs=il[0].contactName+"")&&set_data(Js,Qs),(!Yl||wl[0]&1)&&vs!==(vs=il[0].email+"")&&set_data(Bs,vs),(!Yl||wl[0]&1)&&Ws!==(Ws=(il[0].completed?il[9](il[0].dateCompleted):"NA")+"")&&set_data(va,Ws),(!Yl||wl[0]&1)&&Xs!==(Xs=il[0].recordCount+"")&&set_data(ll,Xs),(!Yl||wl[0]&1)&&rl!==(rl=il[0].recordsCompleted+"")&&set_data(Cl,rl),(!Yl||wl[0]&1)&&zl!==(zl=il[0].groupCount+"")&&set_data(bA,zl),(!Yl||wl[0]&1)&&TA!==(TA=il[0].groupsComplete+"")&&set_data(Tl,TA),(!Yl||wl[0]&1)&&hA!==(hA=(il[0].lastGeoreference?il[10](il[0].lastGeoreference):"NA")+"")&&set_data(Zl,hA),(!Yl||wl[0]&1)&&yA!==(yA=(il[0].lastGeoreferenceBy?il[0].lastGeoreferenceBy:"NA")+"")&&set_data(wA,yA);const lu={};wl[0]&1&&(lu.dataset=il[0]),Al.$set(lu),wl[0]&3&&(Wl=il[0].createdByID==il[1].uid||il[0].admins&&il[0].admins.includes(il[1].uid)),Wl?eA?(eA.p(il,wl),wl[0]&3&&transition_in(eA,1)):(eA=create_if_block_8$1(il),eA.c(),transition_in(eA,1),eA.m(Cs,oA)):eA&&(group_outros(),transition_out(eA,1,1,()=>{eA=null}),check_outros());const vl={};wl[0]&1&&(vl.dataset=il[0]),wl[0]&4&&(vl.profilesIndex=il[2]),wl[0]&2&&(vl.userID=il[1].uid),EA.$set(vl),wl[0]&3&&(JA=il[0].createdByID==il[1].uid||il[0].admins&&il[0].admins.includes(il[1].uid)),JA?Pl?(Pl.p(il,wl),wl[0]&3&&transition_in(Pl,1)):(Pl=create_if_block_3$2(il),Pl.c(),transition_in(Pl,1),Pl.m(NA.parentNode,NA)):Pl&&(group_outros(),transition_out(Pl,1,1,()=>{Pl=null}),check_outros())},i(il){Yl||(transition_in(Al.$$.fragment,il),transition_in(eA),transition_in(EA.$$.fragment,il),transition_in(Pl),Yl=!0)},o(il){transition_out(Al.$$.fragment,il),transition_out(eA),transition_out(EA.$$.fragment,il),transition_out(Pl),Yl=!1},d(il){il&&detach(o),Rl&&Rl.d(),l[26](null),il&&detach(Lo),il&&detach(Uo),il&&detach(Mo),il&&detach(Go),il&&detach($A),il&&detach(Cs),destroy_component(Al),eA&&eA.d(),destroy_component(EA),il&&detach(Ql),Pl&&Pl.d(il),il&&detach(NA),xA=!1,run_all(xu)}}}function create_if_block_1$4(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo=l[8].length&&create_if_block_2$3(l);return{c(){o=element("div"),s=element("p"),c=text("The download has completed. Please remember to "),h=element("span"),h.textContent="open the file in a UTF-8 friendly way...",d=space(),Uo&&Uo.c(),p=space(),Co=element("button"),Co.textContent="Okay",set_style(s,"margin-bottom","20px"),attr(o,"class","vertical svelte-1m20jv3")},m(Qo,Po){insert(Qo,o,Po),append(o,s),append(s,c),append(s,h),append(o,d),Uo&&Uo.m(o,null),append(o,p),append(o,Co),Bo||(Lo=[listen(h,"click",l[23]),listen(Co,"click",l[24])],Bo=!0)},p(Qo,Po){Qo[8].length&&Uo.p(Qo,Po)},i:noop$2,o:noop$2,d(Qo){Qo&&detach(o),Uo&&Uo.d(),Bo=!1,run_all(Lo)}}}function create_if_block$8(l){let o,s,c,h,d,p;return d=new Loader$1({}),{c(){o=element("div"),s=text(l[6]),c=space(),h=element("div"),create_component(d.$$.fragment),attr(h,"class","loaderflex svelte-1m20jv3"),attr(o,"class","vertical svelte-1m20jv3")},m(Co,Bo){insert(Co,o,Bo),append(o,s),append(o,c),append(o,h),mount_component(d,h,null),p=!0},p(Co,Bo){(!p||Bo[0]&64)&&set_data(s,Co[6])},i(Co){p||(transition_in(d.$$.fragment,Co),p=!0)},o(Co){transition_out(d.$$.fragment,Co),p=!1},d(Co){Co&&detach(o),destroy_component(d)}}}function create_if_block_10$1(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo;function Qo(Go,$o){return Go[0].completed?create_if_block_11$1:create_else_block_2$2}let Po=Qo(l),Mo=Po(l);return{c(){Mo.c(),o=space(),s=element("button"),s.innerHTML='<span class="material-icons">file_download</span>',c=space(),h=element("button"),h.innerHTML='<span class="material-icons">download_for_offline</span>',d=space(),p=element("button"),p.innerHTML='<span class="material-icons-outlined">inventory</span>',Co=space(),Bo=element("button"),Bo.innerHTML='<span class="material-icons">lock_open</span>',attr(s,"class","dataset-tool svelte-1m20jv3"),attr(s,"title","download dataset with georefs"),attr(h,"class","dataset-tool svelte-1m20jv3"),attr(h,"title","download georefs only"),attr(p,"class","dataset-tool svelte-1m20jv3"),attr(p,"title","quality control"),p.hidden=!0,attr(Bo,"class","dataset-tool svelte-1m20jv3"),attr(Bo,"title","clear locked record groups")},m(Go,$o){Mo.m(Go,$o),insert(Go,o,$o),insert(Go,s,$o),insert(Go,c,$o),insert(Go,h,$o),insert(Go,d,$o),insert(Go,p,$o),insert(Go,Co,$o),insert(Go,Bo,$o),Lo||(Uo=[listen(s,"click",l[14]),listen(h,"click",l[15]),listen(p,"click",l[25]),listen(Bo,"click",l[12])],Lo=!0)},p(Go,$o){Po===(Po=Qo(Go))&&Mo?Mo.p(Go,$o):(Mo.d(1),Mo=Po(Go),Mo&&(Mo.c(),Mo.m(o.parentNode,o)))},d(Go){Mo.d(Go),Go&&detach(o),Go&&detach(s),Go&&detach(c),Go&&detach(h),Go&&detach(d),Go&&detach(p),Go&&detach(Co),Go&&detach(Bo),Lo=!1,run_all(Uo)}}}function create_else_block_2$2(l){let o,s,c;return{c(){o=element("button"),o.innerHTML='<span class="material-icons-outlined">done_all</span>',attr(o,"class","dataset-tool svelte-1m20jv3"),attr(o,"title","mark completed")},m(h,d){insert(h,o,d),s||(c=listen(o,"click",l[16]),s=!0)},p:noop$2,d(h){h&&detach(o),s=!1,c()}}}function create_if_block_11$1(l){let o,s,c;return{c(){o=element("button"),o.innerHTML='<span class="material-icons-outlined">remove_done</span>',attr(o,"class","dataset-tool svelte-1m20jv3"),attr(o,"title","reopen dataset")},m(h,d){insert(h,o,d),s||(c=listen(o,"click",l[17]),s=!0)},p:noop$2,d(h){h&&detach(o),s=!1,c()}}}function create_if_block_8$1(l){let o,s,c,h;const d=[create_if_block_9$1,create_else_block_1$2],p=[];function Co(Bo,Lo){return Bo[2]?0:1}return o=Co(l),s=p[o]=d[o](l),{c(){s.c(),c=empty$1()},m(Bo,Lo){p[o].m(Bo,Lo),insert(Bo,c,Lo),h=!0},p(Bo,Lo){let Uo=o;o=Co(Bo),o===Uo?p[o].p(Bo,Lo):(group_outros(),transition_out(p[Uo],1,1,()=>{p[Uo]=null}),check_outros(),s=p[o],s?s.p(Bo,Lo):(s=p[o]=d[o](Bo),s.c()),transition_in(s,1),s.m(c.parentNode,c))},i(Bo){h||(transition_in(s),h=!0)},o(Bo){transition_out(s),h=!1},d(Bo){p[o].d(Bo),Bo&&detach(c)}}}function create_else_block_1$2(l){let o,s,c;return s=new Loader$1({}),{c(){o=element("div"),create_component(s.$$.fragment),attr(o,"class","chart-loader svelte-1m20jv3")},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},p:noop$2,i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function create_if_block_9$1(l){let o,s,c,h,d,p;return d=new DatasetUserStatsChart({props:{dataset:l[0],profilesIndex:l[2]}}),{c(){o=element("div"),s=space(),c=element("div"),c.textContent="Stats per georeferencer",h=space(),create_component(d.$$.fragment),attr(o,"class","chart-spacer svelte-1m20jv3"),attr(c,"class","chart-title svelte-1m20jv3")},m(Co,Bo){insert(Co,o,Bo),insert(Co,s,Bo),insert(Co,c,Bo),insert(Co,h,Bo),mount_component(d,Co,Bo),p=!0},p(Co,Bo){const Lo={};Bo[0]&1&&(Lo.dataset=Co[0]),Bo[0]&4&&(Lo.profilesIndex=Co[2]),d.$set(Lo)},i(Co){p||(transition_in(d.$$.fragment,Co),p=!0)},o(Co){transition_out(d.$$.fragment,Co),p=!1},d(Co){Co&&detach(o),Co&&detach(s),Co&&detach(c),Co&&detach(h),destroy_component(d,Co)}}}function create_if_block_3$2(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo=l[0].georeferencers&&l[0].georeferencers.length&&create_if_block_7$1(l),Qo=l[0].pastGeoreferencers&&l[0].pastGeoreferencers.length&&create_if_block_6$2(l),Po=(l[0].invitees&&l[0].invitees.length||l[0].newInvitees&&l[0].newInvitees.length)&&create_if_block_5$2(l),Mo=l[0].declinedInvitees&&l[0].declinedInvitees.length&&create_if_block_4$2(l);return Bo=new ProfileSelect({}),Bo.$on("profile-selected",l[22]),{c(){Uo&&Uo.c(),o=space(),Qo&&Qo.c(),s=space(),Po&&Po.c(),c=space(),Mo&&Mo.c(),h=space(),d=element("div"),p=element("h4"),p.textContent="Invite new georeferencers",Co=space(),create_component(Bo.$$.fragment),set_style(p,"margin-bottom","0")},m(Go,$o){Uo&&Uo.m(Go,$o),insert(Go,o,$o),Qo&&Qo.m(Go,$o),insert(Go,s,$o),Po&&Po.m(Go,$o),insert(Go,c,$o),Mo&&Mo.m(Go,$o),insert(Go,h,$o),insert(Go,d,$o),append(d,p),append(d,Co),mount_component(Bo,d,null),Lo=!0},p(Go,$o){Go[0].georeferencers&&Go[0].georeferencers.length?Uo?(Uo.p(Go,$o),$o[0]&1&&transition_in(Uo,1)):(Uo=create_if_block_7$1(Go),Uo.c(),transition_in(Uo,1),Uo.m(o.parentNode,o)):Uo&&(group_outros(),transition_out(Uo,1,1,()=>{Uo=null}),check_outros()),Go[0].pastGeoreferencers&&Go[0].pastGeoreferencers.length?Qo?(Qo.p(Go,$o),$o[0]&1&&transition_in(Qo,1)):(Qo=create_if_block_6$2(Go),Qo.c(),transition_in(Qo,1),Qo.m(s.parentNode,s)):Qo&&(group_outros(),transition_out(Qo,1,1,()=>{Qo=null}),check_outros()),Go[0].invitees&&Go[0].invitees.length||Go[0].newInvitees&&Go[0].newInvitees.length?Po?(Po.p(Go,$o),$o[0]&1&&transition_in(Po,1)):(Po=create_if_block_5$2(Go),Po.c(),transition_in(Po,1),Po.m(c.parentNode,c)):Po&&(group_outros(),transition_out(Po,1,1,()=>{Po=null}),check_outros()),Go[0].declinedInvitees&&Go[0].declinedInvitees.length?Mo?(Mo.p(Go,$o),$o[0]&1&&transition_in(Mo,1)):(Mo=create_if_block_4$2(Go),Mo.c(),transition_in(Mo,1),Mo.m(h.parentNode,h)):Mo&&(group_outros(),transition_out(Mo,1,1,()=>{Mo=null}),check_outros())},i(Go){Lo||(transition_in(Uo),transition_in(Qo),transition_in(Po),transition_in(Mo),transition_in(Bo.$$.fragment,Go),Lo=!0)},o(Go){transition_out(Uo),transition_out(Qo),transition_out(Po),transition_out(Mo),transition_out(Bo.$$.fragment,Go),Lo=!1},d(Go){Uo&&Uo.d(Go),Go&&detach(o),Qo&&Qo.d(Go),Go&&detach(s),Po&&Po.d(Go),Go&&detach(c),Mo&&Mo.d(Go),Go&&detach(h),Go&&detach(d),destroy_component(Bo)}}}function create_if_block_7$1(l){let o,s,c,h,d;return h=new DatasetTeam({props:{datasetCreatedByID:l[0].createdByID,ids:l[0].georeferencers,profilesIndex:l[2],georef:!0,admins:l[0].admins}}),h.$on("make-admin",l[18]),h.$on("remove-user",l[19]),{c(){o=element("div"),s=element("h4"),s.textContent="Current Georeferencers",c=space(),create_component(h.$$.fragment),set_style(s,"margin-bottom","0")},m(p,Co){insert(p,o,Co),append(o,s),append(o,c),mount_component(h,o,null),d=!0},p(p,Co){const Bo={};Co[0]&1&&(Bo.datasetCreatedByID=p[0].createdByID),Co[0]&1&&(Bo.ids=p[0].georeferencers),Co[0]&4&&(Bo.profilesIndex=p[2]),Co[0]&1&&(Bo.admins=p[0].admins),h.$set(Bo)},i(p){d||(transition_in(h.$$.fragment,p),d=!0)},o(p){transition_out(h.$$.fragment,p),d=!1},d(p){p&&detach(o),destroy_component(h)}}}function create_if_block_6$2(l){let o,s,c,h,d;return h=new DatasetTeam({props:{ids:l[0].pastGeoreferencers,profilesIndex:l[2]}}),h.$on("reinvite",l[21]),{c(){o=element("div"),s=element("h4"),s.textContent="Past Georeferencers",c=space(),create_component(h.$$.fragment),set_style(s,"margin-bottom","0")},m(p,Co){insert(p,o,Co),append(o,s),append(o,c),mount_component(h,o,null),d=!0},p(p,Co){const Bo={};Co[0]&1&&(Bo.ids=p[0].pastGeoreferencers),Co[0]&4&&(Bo.profilesIndex=p[2]),h.$set(Bo)},i(p){d||(transition_in(h.$$.fragment,p),d=!0)},o(p){transition_out(h.$$.fragment,p),d=!1},d(p){p&&detach(o),destroy_component(h)}}}function create_if_block_5$2(l){let o,s,c,h,d;return h=new DatasetTeam({props:{ids:[...l[0].invitees,...l[0].newInvitees],invitees:!0,profilesIndex:l[2]}}),h.$on("remove-user",l[19]),h.$on("remove-new",l[20]),{c(){o=element("div"),s=element("h4"),s.textContent="Invitees",c=space(),create_component(h.$$.fragment),set_style(s,"margin-bottom","0")},m(p,Co){insert(p,o,Co),append(o,s),append(o,c),mount_component(h,o,null),d=!0},p(p,Co){const Bo={};Co[0]&1&&(Bo.ids=[...p[0].invitees,...p[0].newInvitees]),Co[0]&4&&(Bo.profilesIndex=p[2]),h.$set(Bo)},i(p){d||(transition_in(h.$$.fragment,p),d=!0)},o(p){transition_out(h.$$.fragment,p),d=!1},d(p){p&&detach(o),destroy_component(h)}}}function create_if_block_4$2(l){let o,s,c,h,d;return h=new DatasetTeam({props:{ids:l[0].declinedInvitees,profilesIndex:l[2]}}),h.$on("reinvite",l[21]),{c(){o=element("div"),s=element("h4"),s.textContent="Declined",c=space(),create_component(h.$$.fragment),set_style(s,"margin-bottom","0")},m(p,Co){insert(p,o,Co),append(o,s),append(o,c),mount_component(h,o,null),d=!0},p(p,Co){const Bo={};Co[0]&1&&(Bo.ids=p[0].declinedInvitees),Co[0]&4&&(Bo.profilesIndex=p[2]),h.$set(Bo)},i(p){d||(transition_in(h.$$.fragment,p),d=!0)},o(p){transition_out(h.$$.fragment,p),d=!1},d(p){p&&detach(o),destroy_component(h)}}}function create_if_block_2$3(l){let o,s,c;return{c(){o=element("p"),o.textContent=`There were problems with associating georeferences for the following ${l[8].length} record/s:`,s=space(),c=element("p"),c.textContent=`${l[8].join("; ")}`,set_style(o,"font-weight","bold")},m(h,d){insert(h,o,d),insert(h,s,d),insert(h,c,d)},p:noop$2,d(h){h&&detach(o),h&&detach(s),h&&detach(c)}}}function create_fragment$e(l){let o,s,c,h,d,p,Co;const Bo=[create_if_block$8,create_if_block_1$4,create_else_block$5],Lo=[];function Uo(Qo,Po){return Qo[3]?0:Qo[4]?1:2}return c=Uo(l),h=Lo[c]=Bo[c](l),p=new Toast({}),{c(){o=element("div"),s=element("div"),h.c(),d=space(),create_component(p.$$.fragment),attr(s,"class","container svelte-1m20jv3"),attr(o,"class","outer svelte-1m20jv3")},m(Qo,Po){insert(Qo,o,Po),append(o,s),Lo[c].m(s,null),append(o,d),mount_component(p,o,null),Co=!0},p(Qo,Po){let Mo=c;c=Uo(Qo),c===Mo?Lo[c].p(Qo,Po):(group_outros(),transition_out(Lo[Mo],1,1,()=>{Lo[Mo]=null}),check_outros(),h=Lo[c],h?h.p(Qo,Po):(h=Lo[c]=Bo[c](Qo),h.c()),transition_in(h,1),h.m(s,null))},i(Qo){Co||(transition_in(h),transition_in(p.$$.fragment,Qo),Co=!0)},o(Qo){transition_out(h),transition_out(p.$$.fragment,Qo),Co=!1},d(Qo){Qo&&detach(o),Lo[c].d(),destroy_component(p)}}}function instance$e(l,o,s){const c=createEventDispatcher();let{dataset:h}=o,{profile:d}=o,p=null,Co=!1,Bo=!1,Lo=[],Uo,Qo="";onMount(async ds=>{if(h.createdByID==d.uid||h.admins&&h.admins.includes(d.uid)){let hs=[h.admins,h.georeferencers,h.pastGeoreferencers,h.invitees,h.declinedInvitees];hs=hs.filter(ks=>ks&&ks.length);let ys=hs.flat(),ms=[],Rs=Firestore.collection("userProfiles");for(let ks of ys)ms.push(Rs.doc(ks).get());let bs={},ps=await Promise.all(ms);for(let ks of ps)if(ks.exists){let xs=ks.data();bs[xs.uid]=xs}s(2,p=bs)}});const Po=ds=>{if(!ds)return"";typeof ds=="object"&&(ds=ds.seconds*1e3);let hs=new Date(ds);return new Date(hs.getTime()-hs.getTimezoneOffset()*60*1e3).toISOString().split("T")[0]},Mo=ds=>{if(!ds)return"";typeof ds=="object"&&(ds=ds.seconds*1e3);let hs=new Date(ds),ms=new Date(hs.getTime()-hs.getTimezoneOffset()*60*1e3).toISOString().split(/[T\.]/g);return ms.pop(),ms.join(" ")},Go=ds=>{c("start-georeferencing")},$o=async ds=>{let ys=await Firestore.collection("recordGroups").where("datasetID","==",h.datasetID).where("groupLocked","==",!0).limit(100).get();if(ys.empty)alert("No record groups to unlock");else{let ms=0;const Rs=Firestore.batch();for(let ks of ys.docs)Rs.update(ks.ref,{groupLocked:!1});await Rs.commit(),ms+=ys.docs.length;let bs=ys.docs[ys.docs.length-1],ps=!0;for(;ps;){let xs=await Firestore.collection("recordGroups").where("datasetID","==",h.datasetID).where("groupLocked","==",!0).startAt(bs).limit(100).get();if(xs.empty)ps=!1;else{const Ss=Firestore.batch();for(let Us of xs.docs)Ss.update(Us.ref,{groupLocked:!1});await Ss.commit(),ms+=xs.docs.length,bs=xs.docs[xs.docs.length-1]}}alert(`${ms} record group${ms>1?"s":""} unlocked`)}},jo=ds=>{c("to-datasets")},zo=(ds,hs,ys)=>{if(ds.nscfGeorefID=hs.georefID,ds.georeferenceCountry=hs.country,ds.georeferenceStateProvince=hs.stateProvince,ds.georeferenceLocality=hs.locality,ds.decimalCoordinates=hs.decimalCoordinates,ds["dwc:decimalLatitude"]=hs.decimalLatitude,ds["dwc:decimalLongitude"]=hs.decimalLongitude,ds.georeferenceUncertainty=hs.uncertainty,ds.georeferenceUncertaintyUnit=hs.uncertaintyUnit,hs.uncertainty){let Us=hs.uncertainty;hs.uncertaintyUnit=="km"&&(Us=hs.uncertainty*1e3),ds["dwc:coordinateUncertaintyInMeters"]=Us}else ds["dwc:coordinateUncertaintyInMeters"]=null;ds["dwc:geodeticDatum"]=hs.datum,ds["dwc:georeferencedBy"]=ys.georefBy,ds.georeferencedByID=ys.georefByID;let ms=new Date(ys.georefDate),Rs=new Date(ms.getTime()-ms.getTimezoneOffset()*60*1e3).toISOString().split("T")[0];ds["dwc:georeferencedDate"]=Rs,ds["dwc:georeferenceSources"]=hs.sources,ds["dwc:georeferenceProtocol"]=hs.protocol;let bs=[];ys.georefRemarks&&ys.georefRemarks.trim()&&bs.push(ys.georefRemarks.trim());let ps;if(hs.locality&&hs.locality.trim())if(h.localityField&&ds[h.localityField])ps=src.compareTwoStrings(ds[h.localityField],hs.locality);else{let Us=[ds.locality,ds["dwc:locality"],ds.verbatimLocality,ds["dwc:verbatimLocality"]].filter(Ps=>Ps).map(Ps=>Ps.trim()).filter(Ps=>Ps);if(Us.length){let Ps=Us.pop();ps=src.compareTwoStrings(Ps,hs.locality)}}let ks=[];if(!ps||ps<.9){let Us=hs.locality;ks.push(Us),ks.push(ps)}if(ys.georefBy!=hs.by){let Us="by: "+hs.by;hs.byORCID&&hs.byORCID.trim()&&(Us+=` (${hs.byORCID})`),ks.push(Us)}if(Rs!=hs.date){let Us="date: "+hs.date;ks.push(Us)}if(ks.length){if(hs.verified?ks.push("verified"):ks.push("unverified"),hs.remarks&&hs.remarks.trim()){let Ps="remarks: "+hs.remarks.trim();ks.push(Ps)}let Us="::ORIG GEOREF: "+ks.join(", ");bs.push(Us)}else hs.remarks&&hs.remarks.trim()&&bs.push(hs.remarks.trim());let xs=bs.join("; ").trim();xs=xs.replace(/^\:\:/,"").replace(/;\s+\:\:/," ::"),ds["dwc:georeferenceRemarks"]=xs,ys.georefVerified?ys.georefVerifiedByRole?ds["dwc:georeferenceVerificationStatus"]="verified by "+ys.georefVerifiedByRole:ds["dwc:georeferenceVerificationStatus"]="verified (no role indicated)":ds["dwc:georeferenceVerificationStatus"]="requires verification",ds.georeferenceVerifiedBy=ys.georefVerifiedBy,ds.georeferenceVerifiedDate=ys.georefVerifiedDate,ds.originalGeorefJSON=JSON.stringify(hs),ds.originalGeoreferencedBy=hs.by,ds.originalGeoreferenceByID=hs.byORCID,ds.originalGeoreferenceDate=hs.date,ds.originalGeoreferenceRemarks=hs.remarks;let Ss;hs.verified?hs.verifiedByRole?Ss="verified by "+hs.verifiedByRole:Ss="verified (no role indicated)":Ss="requires verification",ds.originalGeoreferenceVerificationStatus=Ss,ds.originalGeoreferenceVerifiedBy=hs.verifiedBy,ds.originalGeoreferenceVerifiedDate=hs.verifiedDate},Xo=async ds=>{s(3,Co=!0);let hs;try{s(6,Qo="fetching original dataset..."),h.datasetURL||s(0,h.datasetURL=await Storage.ref(`${h.datasetID}.csv`).getDownloadURL(),h),hs=await Yo(h.datasetURL)}catch(Ps){if(Ps.length){console.error("errors fetching original dataset:");for(let Qs of Ps)console.error(Qs);alert("error fetching original dataset, see console"),s(6,Qo=null),s(3,Co=!1);return}else{alert("error fetching original dataset: ",Ps.message),s(6,Qo=null),s(3,Co=!1);return}}s(6,Qo="fetching recordGroups...");let ys=await Jo();s(6,Qo="fetching georefs...");let ms;try{let Ps=Object.keys(ys.georefIDs);if(!Ps.length){alert("there are no georeferences for this dataset yet, nothing will be downloaded"),s(6,Qo=null);return}let Qs=`${h.region.replace(/\s+/g,"")}${h.domain.replace(/\s+/g,"")}`.toLowerCase();ms=await Ko(Ps,Qs)}catch(Ps){alert("Error with download: "+Ps.message),s(6,Qo=null);return}s(6,Qo="and finally assembling everthing...");let Rs={};for(let Ps of ms)Rs[Ps.georefID]=Ps;let bs=Object.keys(hs[0]);for(let Ps of hs){let Qs=Ps[h.recordIDField];if(ys.recordGeorefData[Qs]){let Js=ys.recordGeorefData[Qs],qs=Rs[Js.georefID];if(!qs){Lo.push(Qs);continue}zo(Ps,qs,Js)}}s(6,Qo="saving file..."),bs=[...bs,"nscfGeorefID","georeferenceCountry","georeferenceStateProvince","georeferenceLocality","decimalCoordinates","dwc:decimalLatitude","dwc:decimalLongitude","georeferenceUncertainty","georeferenceUncertaintyUnit","dwc:coordinateUncertaintyInMeters","dwc:geodeticDatum","dwc:georeferencedBy","georeferencedByID","dwc:georeferencedDate","originalGeoreferencedBy","originalGeoreferenceByID","originalGeoreferenceDate","dwc:georeferenceSources","originalGeorefSource","dwc:georeferenceProtocol","dwc:georeferenceRemarks","originalGeoreferenceRemarks","dwc:georeferenceVerificationStatus","georeferenceVerifiedBy","georeferenceVerifiedDate","originalGeoreferenceVerificationStatus","originalGeoreferenceVerifiedBy","originalGeoreferenceVerifiedDate"];let ps=Papa.unparse({fields:bs,data:hs}),ks=new Date,xs=new Date(ks.getTime()-ks.getTimezoneOffset()*60*1e3).toISOString();xs=xs.replace(/-:/g,"");let Ss=h.datasetName+"_georeferenced"+xs+".csv",Us=document.createElement("a");Us.href="data:text/csv;charset=utf-8,"+encodeURI(ps),Us.target="_blank",Us.download=Ss,Us.click(),is("dataset"),s(4,Bo=!0),s(3,Co=!1)},Zo=async ds=>{s(3,Co=!0),s(6,Qo="fetching record groups");let hs=await Jo();s(6,Qo="fetching georefs...");let ys;try{let Us=Object.keys(hs.georefIDs);if(!Us.length){alert("there are no georeferences for this dataset yet, nothing will be downloaded"),s(6,Qo=null);return}let Ps=`${h.region.replace(/\s+/g,"")}${h.domain.replace(/\s+/g,"")}`.toLowerCase();ys=await Ko(Us,Ps)}catch(Us){alert("Error with download: "+Us.message),s(6,Qo=null);return}s(6,Qo="and finally assembling everthing...");let ms={};for(let Us of ys)ms[Us.georefID]=Us;let Rs=[];for(let[Us,Ps]of Object.entries(hs.recordGeorefData)){let Qs={};Qs[h.recordIDField]=Us;let Js=ms[Ps.georefID];if(!Js){Lo.push(Us);continue}zo(Qs,Js,Ps),Rs.push(Qs)}let bs=Papa.unparse(Rs),ps=new Date,ks=new Date(ps.getTime()-ps.getTimezoneOffset()*60*1e3).toISOString();ks=ks.replace(/-:/g,"");let xs=h.datasetName+"_georeferences"+ks+".csv",Ss=document.createElement("a");Ss.href="data:text/csv;charset=utf-8,"+encodeURI(bs),Ss.target="_blank",Ss.download=xs,Ss.click(),is("georefs only"),s(4,Bo=!0),s(3,Co=!1)},Wo=async ds=>{await Firestore.collection("datasets").doc(h.datasetID).update({completed:!0,dateCompleted:new Date().getTime()}),s(0,h.dateCompleted=new Date().getTime(),h),s(0,h.completed=!0,h)},es=async ds=>{await Firestore.collection("datasets").doc(h.datasetID).update({completed:!1,dateCompleted:null}),s(0,h.dateCompleted=null,h),s(0,h.completed=!1,h)},is=ds=>{if(!ds)throw new Error("a downloadType is required to update the dataset");let hs={lastDownload:{downloadDate:FieldValue.serverTimestamp(),downloadBy:d.formattedName,downloadType:ds}};Firestore.collection("datasets").doc(h.datasetID).update(hs)},Jo=async ds=>{let hs=await Firestore.collection("recordGroups").where("datasetID","==",h.datasetID).get();if(hs.empty)throw new Error("no record groups returned for this dataset!!");{let ys=hs.docs.map(bs=>bs.data()),ms={},Rs={};for(let bs of ys)if(bs.groupLocalities&&bs.groupLocalities.length){for(let ps of bs.groupLocalities)if(ps.georefID){ms[ps.georefID]||(ms[ps.georefID]=!0);for(let ks of ps.recordIDs)Rs[ks]={georefID:ps.georefID,georefBy:ps.georefBy,georefByID:ps.georefByID,georefDate:ps.georefDate,georefVerified:ps.georefVerified,georefVerifiedBy:ps.georefVerifiedBy,georefVerifiedDate:ps.georefVerifiedDate,georefVerifiedByRole:ps.georefVerifiedByRole,georefRemarks:ps.georefRemarks}}}return{georefIDs:ms,recordGeorefData:Rs}}},Ko=async(ds,hs)=>{if(Array.isArray(ds)&&ds.length){let ys={index:hs,georefIDs:ds},ms="https://us-central1-georef-745b9.cloudfunctions.net/getgeorefsbyid",Rs=await Auth$1.currentUser.getIdToken(!0),bs;try{bs=await fetch(ms,{method:"POST",headers:{Authorization:Rs,"Content-Type":"application/json"},body:JSON.stringify(ys)})}catch(ps){throw new Error("georefs could not be fetched: "+ps.message)}if(bs.ok){let ps=await bs.json();return ps=ps.map(ks=>ks._source),ps}else{let ps=await bs.text();throw new Error("error fetching georefs: "+ps)}}else throw new Error("georefIDs provided is invalid")},Yo=ds=>new Promise((hs,ys)=>{fetch(ds).then(ms=>ms.blob()).then(ms=>ms.text()).then(ms=>{Papa.parse(ms,{header:!0,skipEmptyLines:!0,complete(Rs){Rs.errors.length?ys(Rs.errors):hs(Rs.data)},error(Rs){ys(Rs)}})}).catch(ms=>{ys(ms)})}),ts=ds=>{let{uid:hs,firstName:ys}=ds.detail;confirm(`Are you sure you want to make ${ys} an admin?`)&&(h.admins?(s(0,h.admins=[...h.admins,hs],h),Firestore.collection("datasets").doc(h.datasetID).update({admins:FieldValue.arrayUnion(hs)})):(s(0,h.admins=[hs],h),Firestore.collection("datasets").doc(h.datasetID).update({admins:[hs]})))},ss=ds=>{let{uid:hs,firstName:ys,list:ms}=ds.detail;if(confirm(`Are you sure you want to remove ${ys} from ${ms}?`)){let bs=Firestore.collection("datasets").doc(h.datasetID),ps=Firestore.collection("userDatasets").doc(hs);if(ms=="georeferencers"){let ks=h.georeferencers.indexOf(hs);h.georeferencers.splice(ks,1),s(0,h),bs.update({georeferencers:FieldValue.arrayRemove(hs)}),ps.update({current:FieldValue.arrayRemove(h.datasetID)}),Realtime.ref(`stats/perDataset/${h.datasetID}/perUser/${hs}/georefsAdded`).once("value").then(xs=>{xs.exists()&&xs.val()&&bs.update({pastGeoreferencers:FieldValue.arrayUnion(hs)})}).catch(xs=>{console.error("error checking dataset stats for georeferencer with uid",hs,":",xs.message)})}else{let ks=h.invitees.indexOf(hs);h.invitees.splice(ks,1),s(0,h),bs.update({invitees:FieldValue.arrayRemove(hs)}),ps.update({invited:FieldValue.arrayRemove(h.datasetID)})}}},cs=ds=>{let hs=ds.detail;if(hs&&hs.trim()){let ys=Firestore.collection("datasets").doc(h.datasetID),ms=hs.replace(/[@\.\s]+/g,"").toLowerCase(),Rs=Firestore.collection("userDatasets").doc(ms),bs=h.newInvitees.indexOf(hs);if(bs>=0)h.newInvitees.splice(bs,1),s(0,h),ys.update({newInvitees:FieldValue.arrayRemove(hs)}),Rs.update({invited:FieldValue.arrayRemove(h.datasetID)});else{let ps=["georeferencers","invitees","pastGeoreferencers","declinedInvitees"];for(let ks of ps){let xs=h[ks].indexOf(hs);if(xs>=0){h[ks].splice(xs,1),s(0,h),ys.update({[ks]:FieldValue.arrayRemove(hs)}),Rs=Firestore.collection("userDatasets").doc(hs),Rs.delete();break}}}}},as=ds=>{let hs=ds.detail,ys=Firestore.collection("datasets").doc(h.datasetID),ms=Firestore.collection("userDatasets").doc(hs);if(h.pastGeoreferencers&&h.pastGeoreferencers.length){let Rs=h.pastGeoreferencers.indexOf(hs);if(Rs>=0){h.pastGeoreferencers.splice(Rs,1),s(0,h),ys.update({pastGeoreferencers:FieldValue.arrayRemove(hs),invitees:FieldValue.arrayUnion(hs)}),ms.update({current:FieldValue.arrayUnion(h.datasetID)});return}}if(h.declinedInvitees&&h.declinedInvitees.length){let Rs=h.declinedInvitees.indexOf(hs);if(Rs>=0){h.declinedInvitees.splice(Rs,1),s(0,h),ys.update({declinedInvitees:FieldValue.arrayRemove(hs),invitees:FieldValue.arrayUnion(hs)}),ms.update({current:FieldValue.arrayUnion(h.datasetID)});return}}},us=ds=>{let hs=ds.detail,ys=Firestore.collection("datasets").doc(h.datasetID);if(typeof hs=="string"&&hs.trim()&&hs.includes("invite")){let ms=hs.replace("invite","").trim();if(!h.newInvitees.find(bs=>bs.replace(/[@\.\s]+/g,"").toLowerCase()==ms.replace(/[@\.\s]+/g,"").toLowerCase())){let bs=ms.replace(/[@\.\s]+/g,"").toLowerCase(),ps=Firestore.collection("userDatasets").doc(bs);s(0,h.newInvitees=[...h.newInvitees,ms],h),ys.update({newInvitees:FieldValue.arrayUnion(ms)}),ps.get().then(ks=>{ks.exists?ps.update({invited:FieldValue.arrayUnion(h.datasetID)}):ps.set({invited:[h.datasetID]})}).catch(ks=>{console.error("error updating userDatesets for",ms,":",error.message)})}}else{let ms=hs;if(ms.uid==d.uid){alert("You're already listed as a georeferencer");return}let Rs=h.invitees.find(ps=>ps==ms.uid),bs=h.georeferencers.find(ps=>ps==ms.uid);if(!Rs&&!bs){s(2,p[ms.uid]=ms,p),s(0,h.invitees=[...h.invitees,ms.uid],h),console.log(h.invitees);let ps=Firestore.collection("userDatasets").doc(ms.uid);ys.update({invitees:FieldValue.arrayUnion(ms.uid)}),ps.get().then(ks=>{ks.exists?ps.update({invited:FieldValue.arrayUnion(h.datasetID)}):ps.set({invited:[h.datasetID]})}).catch(ks=>{let xs=`error updating datasets for ${ms.formattedName} with uid ${ms.uid}: ${ks.message}`;console.error(xs)})}else alert("user already added to dataset")}},gs=ds=>{alert(`Special characters in UTF-8 files get scrambled if the file is opened directly in Excel. 
    You need to import the file from the data tab in Excel and set the encoding to UTF-8 during the import process. 
    Alternatively the file can be opened in a text editor like Notepad, or imported directly into Google Sheets, R, or OpenRefine, without problems.`)},Is=ds=>s(4,Bo=!1),_s=ds=>c("quality-control");function Hs(ds){binding_callbacks[ds?"unshift":"push"](()=>{Uo=ds,s(5,Uo)})}return l.$$set=ds=>{"dataset"in ds&&s(0,h=ds.dataset),"profile"in ds&&s(1,d=ds.profile)},[h,d,p,Co,Bo,Uo,Qo,c,Lo,Po,Mo,Go,$o,jo,Xo,Zo,Wo,es,ts,ss,cs,as,us,gs,Is,_s,Hs]}class DatasetDetail extends SvelteComponent{constructor(o){super(),init(this,o,instance$e,create_fragment$e,safe_not_equal,{dataset:0,profile:1},null,[-1,-1])}}const get_default_slot_changes$1=l=>({label:l&2,button:l&1}),get_default_slot_context$1=l=>({label:l[1],button:l[0]});function create_fragment$d(l){let o;const s=l[6].default,c=create_slot(s,l,l[5],get_default_slot_context$1);return{c(){c&&c.c()},m(h,d){c&&c.m(h,d),o=!0},p(h,[d]){c&&c.p&&(!o||d&35)&&update_slot_base(c,s,h,h[5],o?get_slot_changes(s,h[5],d,get_default_slot_changes$1):get_all_dirty_from_scope(h[5]),get_default_slot_context$1)},i(h){o||(transition_in(c,h),o=!0)},o(h){transition_out(c,h),o=!1},d(h){c&&c.d(h)}}}function instance$d(l,o,s){let c,h;const d=["id","toggled","disabled"];let p=compute_rest_props(o,d),{$$slots:Co={},$$scope:Bo}=o,{id:Lo="toggle"+Math.random().toString(36)}=o,{toggled:Uo=!0}=o,{disabled:Qo=!1}=o;return l.$$set=Po=>{o=assign(assign({},o),exclude_internal_props(Po)),s(7,p=compute_rest_props(o,d)),"id"in Po&&s(2,Lo=Po.id),"toggled"in Po&&s(3,Uo=Po.toggled),"disabled"in Po&&s(4,Qo=Po.disabled),"$$scope"in Po&&s(5,Bo=Po.$$scope)},l.$$.update=()=>{l.$$.dirty&4&&s(1,c={for:Lo}),s(0,h={...p,id:Lo,disabled:Qo,"aria-checked":Uo,type:"button",role:"switch"})},[h,c,Lo,Uo,Qo,Bo,Co]}class ToggleCore extends SvelteComponent{constructor(o){super(),init(this,o,instance$d,create_fragment$d,safe_not_equal,{id:2,toggled:3,disabled:4})}}const Toggle_svelte_svelte_type_style_lang="",get_default_slot_changes=l=>({toggled:l&1}),get_default_slot_context=l=>({toggled:l[0]});function create_if_block$7(l){let o,s=(l[0]?l[5]:l[6])+"",c;return{c(){o=element("span"),c=text(s),attr(o,"class","svelte-1y1be9d")},m(h,d){insert(h,o,d),append(o,c)},p(h,d){d&97&&s!==(s=(h[0]?h[5]:h[6])+"")&&set_data(c,s)},d(h){h&&detach(o)}}}function fallback_block(l){let o,s=l[5]&&l[6]&&create_if_block$7(l);return{c(){s&&s.c(),o=empty$1()},m(c,h){s&&s.m(c,h),insert(c,o,h)},p(c,h){c[5]&&c[6]?s?s.p(c,h):(s=create_if_block$7(c),s.c(),s.m(o.parentNode,o)):s&&(s.d(1),s=null)},d(c){s&&s.d(c),c&&detach(o)}}}function create_default_slot$1(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo=[l[19]],Po={};for(let Xo=0;Xo<Qo.length;Xo+=1)Po=assign(Po,Qo[Xo]);let Mo=[l[10],l[20],{style:p="color: "+l[7]+"; background-color: "+(l[0]?l[8]:l[9])+"; "+l[10].style},{disabled:l[4]}],Go={};for(let Xo=0;Xo<Mo.length;Xo+=1)Go=assign(Go,Mo[Xo]);const $o=l[11].default,jo=create_slot($o,l,l[17],get_default_slot_context),zo=jo||fallback_block(l);return{c(){o=element("label"),s=text(l[1]),c=space(),h=element("div"),d=element("button"),Co=space(),zo&&zo.c(),set_attributes(o,Po),toggle_class(o,"hideLabel",l[2]),toggle_class(o,"svelte-1y1be9d",!0),set_attributes(d,Go),toggle_class(d,"small",l[3]),toggle_class(d,"svelte-1y1be9d",!0),attr(h,"class","svelte-1y1be9d")},m(Xo,Zo){insert(Xo,o,Zo),append(o,s),insert(Xo,c,Zo),insert(Xo,h,Zo),append(h,d),d.autofocus&&d.focus(),append(h,Co),zo&&zo.m(h,null),Bo=!0,Lo||(Uo=[listen(d,"click",l[12]),listen(d,"click",l[15]),listen(d,"focus",l[13]),listen(d,"blur",l[14])],Lo=!0)},p(Xo,Zo){(!Bo||Zo&2)&&set_data(s,Xo[1]),set_attributes(o,Po=get_spread_update(Qo,[Zo&524288&&Xo[19]])),toggle_class(o,"hideLabel",Xo[2]),toggle_class(o,"svelte-1y1be9d",!0),set_attributes(d,Go=get_spread_update(Mo,[Zo&1024&&Xo[10],Zo&1048576&&Xo[20],(!Bo||Zo&1921&&p!==(p="color: "+Xo[7]+"; background-color: "+(Xo[0]?Xo[8]:Xo[9])+"; "+Xo[10].style))&&{style:p},(!Bo||Zo&16)&&{disabled:Xo[4]}])),toggle_class(d,"small",Xo[3]),toggle_class(d,"svelte-1y1be9d",!0),jo?jo.p&&(!Bo||Zo&131073)&&update_slot_base(jo,$o,Xo,Xo[17],Bo?get_slot_changes($o,Xo[17],Zo,get_default_slot_changes):get_all_dirty_from_scope(Xo[17]),get_default_slot_context):zo&&zo.p&&(!Bo||Zo&97)&&zo.p(Xo,Bo?Zo:-1)},i(Xo){Bo||(transition_in(zo,Xo),Bo=!0)},o(Xo){transition_out(zo,Xo),Bo=!1},d(Xo){Xo&&detach(o),Xo&&detach(c),Xo&&detach(h),zo&&zo.d(Xo),Lo=!1,run_all(Uo)}}}function create_fragment$c(l){let o,s,c;function h(p){l[16](p)}let d={$$slots:{default:[create_default_slot$1,({label:p,button:Co})=>({19:p,20:Co}),({label:p,button:Co})=>(p?524288:0)|(Co?1048576:0)]},$$scope:{ctx:l}};return l[0]!==void 0&&(d.toggled=l[0]),o=new ToggleCore({props:d}),binding_callbacks.push(()=>bind(o,"toggled",h)),{c(){create_component(o.$$.fragment)},m(p,Co){mount_component(o,p,Co),c=!0},p(p,[Co]){const Bo={};Co&1705983&&(Bo.$$scope={dirty:Co,ctx:p}),!s&&Co&1&&(s=!0,Bo.toggled=p[0],add_flush_callback(()=>s=!1)),o.$set(Bo)},i(p){c||(transition_in(o.$$.fragment,p),c=!0)},o(p){transition_out(o.$$.fragment,p),c=!1},d(p){destroy_component(o,p)}}}function instance$c(l,o,s){const c=["label","hideLabel","small","toggled","disabled","on","off","switchColor","toggledColor","untoggledColor"];let h=compute_rest_props(o,c),{$$slots:d={},$$scope:p}=o,{label:Co="Label"}=o,{hideLabel:Bo=!1}=o,{small:Lo=!1}=o,{toggled:Uo=!0}=o,{disabled:Qo=!1}=o,{on:Po=void 0}=o,{off:Mo=void 0}=o,{switchColor:Go="#fff"}=o,{toggledColor:$o="#0f62fe"}=o,{untoggledColor:jo="#8d8d8d"}=o;const zo=createEventDispatcher();function Xo(Jo){bubble.call(this,l,Jo)}function Zo(Jo){bubble.call(this,l,Jo)}function Wo(Jo){bubble.call(this,l,Jo)}const es=()=>s(0,Uo=!Uo);function is(Jo){Uo=Jo,s(0,Uo)}return l.$$set=Jo=>{o=assign(assign({},o),exclude_internal_props(Jo)),s(10,h=compute_rest_props(o,c)),"label"in Jo&&s(1,Co=Jo.label),"hideLabel"in Jo&&s(2,Bo=Jo.hideLabel),"small"in Jo&&s(3,Lo=Jo.small),"toggled"in Jo&&s(0,Uo=Jo.toggled),"disabled"in Jo&&s(4,Qo=Jo.disabled),"on"in Jo&&s(5,Po=Jo.on),"off"in Jo&&s(6,Mo=Jo.off),"switchColor"in Jo&&s(7,Go=Jo.switchColor),"toggledColor"in Jo&&s(8,$o=Jo.toggledColor),"untoggledColor"in Jo&&s(9,jo=Jo.untoggledColor),"$$scope"in Jo&&s(17,p=Jo.$$scope)},l.$$.update=()=>{l.$$.dirty&1&&zo("toggle",Uo)},[Uo,Co,Bo,Lo,Qo,Po,Mo,Go,$o,jo,h,d,Xo,Zo,Wo,es,is,p]}class Toggle extends SvelteComponent{constructor(o){super(),init(this,o,instance$c,create_fragment$c,safe_not_equal,{label:1,hideLabel:2,small:3,toggled:0,disabled:4,on:5,off:6,switchColor:7,toggledColor:8,untoggledColor:9})}}const countryProvSelect_svelte_svelte_type_style_lang="";function create_if_block$6(l){let o,s,c,h,d,p,Co;function Bo(Uo){l[10](Uo)}let Lo={items:l[4],placeholder:null,isClearable:!1,isDisabled:l[1]||l[4].length<=1};return l[5]!==void 0&&(Lo.value=l[5]),d=new Select({props:Lo}),binding_callbacks.push(()=>bind(d,"value",Bo)),d.$on("select",l[7]),{c(){o=element("div"),s=element("span"),s.textContent="stateProvince",c=space(),h=element("div"),create_component(d.$$.fragment),attr(s,"class","label svelte-2sdf9e"),attr(h,"class","inline-select-fill svelte-2sdf9e"),set_style(h,"--disabledBorderColor","darkgrey"),attr(o,"class","inline-select svelte-2sdf9e"),set_style(o,"margin-top","5px")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),append(o,c),append(o,h),mount_component(d,h,null),Co=!0},p(Uo,Qo){const Po={};Qo&16&&(Po.items=Uo[4]),Qo&18&&(Po.isDisabled=Uo[1]||Uo[4].length<=1),!p&&Qo&32&&(p=!0,Po.value=Uo[5],add_flush_callback(()=>p=!1)),d.$set(Po)},i(Uo){Co||(transition_in(d.$$.fragment,Uo),Co=!0)},o(Uo){transition_out(d.$$.fragment,Uo),Co=!1},d(Uo){Uo&&detach(o),destroy_component(d)}}}function create_fragment$b(l){let o,s,c,h,d,p,Co,Bo,Lo;function Uo(Mo){l[9](Mo)}let Qo={items:l[2],isClearable:!1,isDisabled:l[1]};l[3]!==void 0&&(Qo.value=l[3]),p=new Select({props:Qo}),binding_callbacks.push(()=>bind(p,"value",Uo)),p.$on("select",l[6]);let Po=l[0]&&create_if_block$6(l);return{c(){o=element("div"),s=element("div"),c=element("span"),c.textContent="country",h=space(),d=element("div"),create_component(p.$$.fragment),Bo=space(),Po&&Po.c(),attr(c,"class","label svelte-2sdf9e"),attr(d,"class","inline-select-fill svelte-2sdf9e"),attr(s,"class","inline-select svelte-2sdf9e")},m(Mo,Go){insert(Mo,o,Go),append(o,s),append(s,c),append(s,h),append(s,d),mount_component(p,d,null),append(o,Bo),Po&&Po.m(o,null),Lo=!0},p(Mo,[Go]){const $o={};Go&4&&($o.items=Mo[2]),Go&2&&($o.isDisabled=Mo[1]),!Co&&Go&8&&(Co=!0,$o.value=Mo[3],add_flush_callback(()=>Co=!1)),p.$set($o),Mo[0]?Po?(Po.p(Mo,Go),Go&1&&transition_in(Po,1)):(Po=create_if_block$6(Mo),Po.c(),transition_in(Po,1),Po.m(o,null)):Po&&(group_outros(),transition_out(Po,1,1,()=>{Po=null}),check_outros())},i(Mo){Lo||(transition_in(p.$$.fragment,Mo),transition_in(Po),Lo=!0)},o(Mo){transition_out(p.$$.fragment,Mo),transition_out(Po),Lo=!1},d(Mo){Mo&&detach(o),destroy_component(p),Po&&Po.d()}}}function instance$b(l,o,s){const c=createEventDispatcher();let{hasStateProvince:h}=o,{countryProvs:d}=o,{disabled:p}=o,Co=[],Bo=null,Lo=[],Uo=null,Qo=!1;const Po=Xo=>{let Zo=Object.keys(d);Zo.sort(),Zo.length>1&&Zo.unshift("all"),s(2,Co=Zo.map(Wo=>({value:Wo,label:Wo}))),s(3,Bo=Co[0]),h&&(Bo.value!="all"?(s(4,Lo=d[Bo.value].map(Wo=>({value:Wo,label:Wo}))),s(5,Uo=Lo[0])):(s(4,Lo=[]),s(5,Uo=void 0))),$o()},Mo=async Xo=>{h&&(Qo=!0,Bo.value=="all"?(s(4,Lo=[]),s(5,Uo=void 0)):(s(4,Lo=d[Bo.value].map(Zo=>({value:Zo,label:Zo}))),s(5,Uo=Lo[0]))),$o()},Go=async Xo=>{Qo?Qo=!1:$o()},$o=Xo=>{let Zo={country:Bo.value};Uo?Zo.stateProvince=Uo.value:Zo.stateProvince=null,c("admin-selected",Zo)};function jo(Xo){Bo=Xo,s(3,Bo)}function zo(Xo){Uo=Xo,s(5,Uo)}return l.$$set=Xo=>{"hasStateProvince"in Xo&&s(0,h=Xo.hasStateProvince),"countryProvs"in Xo&&s(8,d=Xo.countryProvs),"disabled"in Xo&&s(1,p=Xo.disabled)},l.$$.update=()=>{l.$$.dirty&256&&d&&Po()},[h,p,Co,Bo,Lo,Uo,Mo,Go,d,jo,zo]}class CountryProvSelect extends SvelteComponent{constructor(o){super(),init(this,o,instance$b,create_fragment$b,safe_not_equal,{hasStateProvince:0,countryProvs:8,disabled:1})}}const georefRecordGroup_svelte_svelte_type_style_lang="";function get_each_context$1(l,o,s){const c=l.slice();return c[6]=o[s],c[8]=s,c}function create_else_block$4(l){let o,s;return o=new Loader$1({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block$5(l){let o,s=l[1].recordGroup.groupLocalities.filter(func).length==l[1].recordGroup.groupLocalities.length,c,h=l[1].recordGroup.groupLocalities,d=[];for(let Co=0;Co<h.length;Co+=1)d[Co]=create_each_block$1(get_each_context$1(l,h,Co));let p=s&&create_if_block_1$3(l);return{c(){for(let Co=0;Co<d.length;Co+=1)d[Co].c();o=space(),p&&p.c(),c=empty$1()},m(Co,Bo){for(let Lo=0;Lo<d.length;Lo+=1)d[Lo].m(Co,Bo);insert(Co,o,Bo),p&&p.m(Co,Bo),insert(Co,c,Bo)},p(Co,Bo){if(Bo&14){h=Co[1].recordGroup.groupLocalities;let Lo;for(Lo=0;Lo<h.length;Lo+=1){const Uo=get_each_context$1(Co,h,Lo);d[Lo]?d[Lo].p(Uo,Bo):(d[Lo]=create_each_block$1(Uo),d[Lo].c(),d[Lo].m(o.parentNode,o))}for(;Lo<d.length;Lo+=1)d[Lo].d(1);d.length=h.length}Bo&2&&(s=Co[1].recordGroup.groupLocalities.filter(func).length==Co[1].recordGroup.groupLocalities.length),s?p?p.p(Co,Bo):(p=create_if_block_1$3(Co),p.c(),p.m(c.parentNode,c)):p&&(p.d(1),p=null)},i:noop$2,o:noop$2,d(Co){destroy_each(d,Co),Co&&detach(o),p&&p.d(Co),Co&&detach(c)}}}function create_each_block$1(l){let o,s,c,h=l[6].loc+"",d,p,Co,Bo,Lo,Uo;function Qo(...Po){return l[4](l[8],...Po)}return{c(){o=element("div"),s=element("div"),c=element("p"),d=text(h),p=space(),Co=element("p"),Co.textContent="content_copy",attr(c,"class","grouptext text-unselectable svelte-b5baef"),toggle_class(c,"selected",l[6].selected),attr(Co,"class","material-icons inline-icon svelte-b5baef"),set_style(Co,"margin-right","5px"),set_style(Co,"margin-left","5px"),attr(Co,"title","copy locality string"),attr(s,"class","container svelte-b5baef"),o.hidden=Bo=l[6].georefID},m(Po,Mo){insert(Po,o,Mo),append(o,s),append(s,c),append(c,d),append(s,p),append(s,Co),Lo||(Uo=[listen(c,"click",Qo),listen(Co,"click",function(){is_function(l[3](l[6].loc))&&l[3](l[6].loc).apply(this,arguments)})],Lo=!0)},p(Po,Mo){l=Po,Mo&2&&h!==(h=l[6].loc+"")&&set_data(d,h),Mo&2&&toggle_class(c,"selected",l[6].selected),Mo&2&&Bo!==(Bo=l[6].georefID)&&(o.hidden=Bo)},d(Po){Po&&detach(o),Lo=!1,run_all(Uo)}}}function create_if_block_1$3(l){let o,s,c=l[1].recordGroup.groupKey+"",h,d;return{c(){o=element("h5"),s=text("The localities for this group ["),h=text(c),d=text("] have been georeferenced")},m(p,Co){insert(p,o,Co),append(o,s),append(o,h),append(o,d)},p(p,Co){Co&2&&c!==(c=p[1].recordGroup.groupKey+"")&&set_data(h,c)},d(p){p&&detach(o)}}}function create_fragment$a(l){let o,s,c,h;const d=[create_if_block$5,create_else_block$4],p=[];function Co(Bo,Lo){return Bo[1].recordGroup&&!Bo[0]?0:1}return s=Co(l),c=p[s]=d[s](l),{c(){o=element("div"),c.c()},m(Bo,Lo){insert(Bo,o,Lo),p[s].m(o,null),h=!0},p(Bo,[Lo]){let Uo=s;s=Co(Bo),s===Uo?p[s].p(Bo,Lo):(group_outros(),transition_out(p[Uo],1,1,()=>{p[Uo]=null}),check_outros(),c=p[s],c?c.p(Bo,Lo):(c=p[s]=d[s](Bo),c.c()),transition_in(c,1),c.m(o,null))},i(Bo){h||(transition_in(c),h=!0)},o(Bo){transition_out(c),h=!1},d(Bo){Bo&&detach(o),p[s].d()}}}const func=l=>l.georefID;function instance$a(l,o,s){let c;component_subscribe(l,dataStore,Lo=>s(1,c=Lo));const h=createEventDispatcher();let{busy:d=!1}=o;const p=(Lo,Uo)=>{if(Lo.ctrlKey)set_store_value(dataStore,c.recordGroup.groupLocalities[Uo].selected=!c.recordGroup.groupLocalities[Uo].selected,c);else if(Lo.shiftKey){let Qo;for(let Po=0;Po<c.recordGroup.groupLocalities.length;Po++)c.recordGroup.groupLocalities[Po].selected&&(Qo=Po);for(let Po of c.recordGroup.groupLocalities)Po.selected=!1;if(Qo<Uo&&([Uo,Qo]=[Qo,Uo]),Uo<Qo)for(let Po=Uo;Po<=Qo;Po++)set_store_value(dataStore,c.recordGroup.groupLocalities[Po].selected=!0,c);else set_store_value(dataStore,c.recordGroup.groupLocalities[Uo].selected=!0,c)}else{for(let Qo of c.recordGroup.groupLocalities)Qo.selected=!1;set_store_value(dataStore,c.recordGroup.groupLocalities[Uo].selected=!0,c)}},Co=Lo=>{navigator.clipboard.writeText&&navigator.clipboard.writeText(Lo).then(Uo=>{h("locality-copied")})},Bo=(Lo,Uo)=>p(Uo,Lo);return l.$$set=Lo=>{"busy"in Lo&&s(0,d=Lo.busy)},[d,c,p,Co,Bo]}class GeorefRecordGroup extends SvelteComponent{constructor(o){super(),init(this,o,instance$a,create_fragment$a,safe_not_equal,{busy:0})}}const georef_svelte_svelte_type_style_lang="",{window:window_1$2}=globals;function create_else_block_3(l){let o,s,c,h,d;return{c(){o=element("button"),s=element("span"),s.textContent="bookmark_added",attr(s,"class","material-icons"),attr(o,"class","recordgroup-tool svelte-5apqlr"),attr(o,"title","remove bookmark"),o.disabled=c=!l[3].georefIndex||l[3].recordGroup.bookmarkedByUID!=l[1].uid},m(p,Co){insert(p,o,Co),append(o,s),h||(d=listen(o,"click",l[33]),h=!0)},p(p,Co){Co[0]&10&&c!==(c=!p[3].georefIndex||p[3].recordGroup.bookmarkedByUID!=p[1].uid)&&(o.disabled=c)},d(p){p&&detach(o),h=!1,d()}}}function create_if_block_6$1(l){let o,s,c,h,d;return{c(){o=element("button"),s=element("span"),s.textContent="bookmark_border",attr(s,"class","material-icons"),attr(o,"class","recordgroup-tool svelte-5apqlr"),attr(o,"title","bookmark this group"),o.disabled=c=!l[3].georefIndex},m(p,Co){insert(p,o,Co),append(o,s),h||(d=listen(o,"click",l[32]),h=!0)},p(p,Co){Co[0]&8&&c!==(c=!p[3].georefIndex)&&(o.disabled=c)},d(p){p&&detach(o),h=!1,d()}}}function create_if_block_5$1(l){let o,s;return o=new CountryProvSelect({props:{hasStateProvince:l[0].hasStateProvince,countryProvs:l[0].countryProvs,disabled:l[2]}}),o.$on("admin-selected",l[22]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&1&&(d.hasStateProvince=c[0].hasStateProvince),h[0]&1&&(d.countryProvs=c[0].countryProvs),h[0]&4&&(d.disabled=c[2]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_else_block_2$1(l){let o,s,c,h=(l[18]||"NA")+"",d,p,Co,Bo,Lo=(l[17]||"NA")+"",Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo=l[3].recordGroup&&l[3].recordGroup.bookmarked&&l[3].recordGroup.bookmarkedByUID!=l[1].uid&&create_if_block_4$1(l);return Go=new GeorefRecordGroup({props:{busy:l[7]||savingGeoref||l[8]}}),Go.$on("locality-copied",l[35]),{c(){o=element("div"),s=element("span"),c=text("Localities: "),d=text(h),p=space(),Co=element("span"),Bo=text("Records: "),Uo=text(Lo),Qo=space(),Jo&&Jo.c(),Po=space(),Mo=element("div"),create_component(Go.$$.fragment),$o=space(),jo=element("div"),zo=element("label"),zo.textContent="Locality georef remarks",Xo=space(),Zo=element("textarea"),set_style(o,"text-align","right"),attr(Mo,"class","recordgroup svelte-5apqlr"),attr(zo,"for","slgr"),attr(zo,"class","svelte-5apqlr"),attr(Zo,"id","slgr"),set_style(Zo,"width","100%"),attr(Zo,"placeholder","Add remarks about applying this georeference to this/these selected localities"),attr(Zo,"rows","2"),attr(jo,"class","recordgroup-remarks svelte-5apqlr")},m(Ko,Yo){insert(Ko,o,Yo),append(o,s),append(s,c),append(s,d),append(o,p),append(o,Co),append(Co,Bo),append(Co,Uo),insert(Ko,Qo,Yo),Jo&&Jo.m(Ko,Yo),insert(Ko,Po,Yo),insert(Ko,Mo,Yo),mount_component(Go,Mo,null),insert(Ko,$o,Yo),insert(Ko,jo,Yo),append(jo,zo),append(jo,Xo),append(jo,Zo),set_input_value(Zo,l[14]),Wo=!0,es||(is=listen(Zo,"input",l[42]),es=!0)},p(Ko,Yo){(!Wo||Yo[0]&262144)&&h!==(h=(Ko[18]||"NA")+"")&&set_data(d,h),(!Wo||Yo[0]&131072)&&Lo!==(Lo=(Ko[17]||"NA")+"")&&set_data(Uo,Lo),Ko[3].recordGroup&&Ko[3].recordGroup.bookmarked&&Ko[3].recordGroup.bookmarkedByUID!=Ko[1].uid?Jo?Jo.p(Ko,Yo):(Jo=create_if_block_4$1(Ko),Jo.c(),Jo.m(Po.parentNode,Po)):Jo&&(Jo.d(1),Jo=null);const ts={};Yo[0]&384&&(ts.busy=Ko[7]||savingGeoref||Ko[8]),Go.$set(ts),Yo[0]&16384&&set_input_value(Zo,Ko[14])},i(Ko){Wo||(transition_in(Go.$$.fragment,Ko),Wo=!0)},o(Ko){transition_out(Go.$$.fragment,Ko),Wo=!1},d(Ko){Ko&&detach(o),Ko&&detach(Qo),Jo&&Jo.d(Ko),Ko&&detach(Po),Ko&&detach(Mo),destroy_component(Go),Ko&&detach($o),Ko&&detach(jo),es=!1,is()}}}function create_if_block$4(l){let o;function s(d,p){return d[11]=="all"?create_if_block_1$2:d[12]&&d[12]!="all"?create_if_block_2$2:create_else_block_1$1}let c=s(l),h=c(l);return{c(){h.c(),o=empty$1()},m(d,p){h.m(d,p),insert(d,o,p)},p(d,p){c===(c=s(d))&&h?h.p(d,p):(h.d(1),h=c(d),h&&(h.c(),h.m(o.parentNode,o)))},i:noop$2,o:noop$2,d(d){h.d(d),d&&detach(o)}}}function create_if_block_4$1(l){let o,s,c,h=l[3].recordGroup.bookmarkedBy+"",d;return{c(){o=element("div"),s=element("strong"),c=text("This group was bookmarked by "),d=text(h),attr(o,"class","warning svelte-5apqlr")},m(p,Co){insert(p,o,Co),append(o,s),append(s,c),append(s,d)},p(p,Co){Co[0]&8&&h!==(h=p[3].recordGroup.bookmarkedBy+"")&&set_data(d,h)},d(p){p&&detach(o)}}}function create_else_block_1$1(l){let o,s,c;return{c(){o=element("h5"),s=text("You've reached the end of the records for "),c=text(l[11])},m(h,d){insert(h,o,d),append(o,s),append(o,c)},p(h,d){d[0]&2048&&set_data(c,h[11])},d(h){h&&detach(o)}}}function create_if_block_2$2(l){let o;function s(d,p){return d[12]=="none"?create_if_block_3$1:create_else_block$3}let c=s(l),h=c(l);return{c(){h.c(),o=empty$1()},m(d,p){h.m(d,p),insert(d,o,p)},p(d,p){c===(c=s(d))&&h?h.p(d,p):(h.d(1),h=c(d),h&&(h.c(),h.m(o.parentNode,o)))},d(d){h.d(d),d&&detach(o)}}}function create_if_block_1$2(l){let o;return{c(){o=element("h5"),o.textContent="You've reached the end of the records for this dataset"},m(s,c){insert(s,o,c)},p:noop$2,d(s){s&&detach(o)}}}function create_else_block$3(l){let o,s,c,h,d;return{c(){o=element("h5"),s=text("You've reached the end of the records for "),c=text(l[11]),h=text(", "),d=text(l[12])},m(p,Co){insert(p,o,Co),append(o,s),append(o,c),append(o,h),append(o,d)},p(p,Co){Co[0]&2048&&set_data(c,p[11]),Co[0]&4096&&set_data(d,p[12])},d(p){p&&detach(o)}}}function create_if_block_3$1(l){let o,s,c,h;return{c(){o=element("h5"),s=text("You've reached the end of the records for "),c=text(l[11]),h=text(", (no stateProvince)")},m(d,p){insert(d,o,p),append(o,s),append(o,c),append(o,h)},p(d,p){p[0]&2048&&set_data(c,d[11])},d(d){d&&detach(o)}}}function create_fragment$9(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,Hs,ds,hs,ys,ms,Rs,bs,ps,ks,xs,Ss,Us,Ps,Qs,Js,qs,Gs,Zs,Es,fs,vs,Bs,Ls,Fs,zs,js,ma;function Ws(rl,Cl){return!rl[3].recordGroup||!rl[3].recordGroup.bookmarked?create_if_block_6$1:create_else_block_3}let va=Ws(l),ca=va(l);function cl(rl){l[41](rl)}let Ms={hideLabel:!0,label:"Show bookmarked",switchColor:"#eee",toggledColor:"lightblue",untoggledColor:"lightgrey",disabled:!l[13]||l[13].length==0};l[2]!==void 0&&(Ms.toggled=l[2]),Yo=new Toggle({props:Ms}),binding_callbacks.push(()=>bind(Yo,"toggled",cl));let $s=l[0].countryProvs&&create_if_block_5$1(l);const ga=[create_if_block$4,create_else_block_2$1],Xs=[];function ll(rl,Cl){return rl[16]?0:1}as=ll(l),us=Xs[as]=ga[as](l);function sl(rl){l[43](rl)}let nl={elasticindex:l[9]};l[10]!==void 0&&(nl.customSearchString=l[10]),ds=new CustomSearch({props:nl}),binding_callbacks.push(()=>bind(ds,"customSearchString",sl)),ds.$on("custom-search-searching",l[21]),ds.$on("custom-search-cleared",l[24]),ds.$on("custom-georefs",l[23]),Rs=new GeorefMatchList({}),Rs.$on("georef-selected",l[28]);function pl(rl){l[44](rl)}let El={};l[15]!==void 0&&(El.pastedDecimalCoords=l[15]),Ss=new GeorefMatchMap({props:El}),binding_callbacks.push(()=>bind(Ss,"pastedDecimalCoords",pl)),Ss.$on("georef-selected",l[28]);let cA={georef:l[6],defaultGeorefBy:l[1].formattedName,defaultGeorefByORCID:l[1].orcid,submitButtonText:"Use this georeference"};return Zs=new GeorefForm({props:cA}),l[45](Zs),Zs.$on("clear-georef",l[25]),Zs.$on("georef-flagged",l[26]),Zs.$on("coords-from-paste",l[27]),Zs.$on("set-georef",l[29]),Fs=new Toast({}),{c(){o=element("div"),s=element("div"),c=element("div"),h=element("h4"),d=text("Locality group"),p=space(),Co=element("div"),Bo=element("button"),Bo.innerHTML='<span class="material-icons">list</span>',Lo=space(),Uo=element("button"),Qo=element("span"),Qo.textContent="low_priority",Po=space(),Mo=element("button"),Mo.innerHTML='<span class="material-icons">replay</span>',Go=space(),$o=element("button"),jo=element("span"),jo.textContent="skip_next",Xo=space(),ca.c(),Zo=space(),Wo=element("button"),Wo.innerHTML='<span class="material-icons">location_off</span>',es=space(),is=element("div"),Jo=element("span"),Jo.textContent="bookmarked",Ko=space(),create_component(Yo.$$.fragment),ss=space(),$s&&$s.c(),cs=space(),us.c(),gs=space(),Is=element("div"),_s=element("h4"),_s.textContent="Candidate georeferences",Hs=space(),create_component(ds.$$.fragment),ys=space(),ms=element("div"),create_component(Rs.$$.fragment),bs=space(),ps=element("div"),ks=space(),xs=element("div"),create_component(Ss.$$.fragment),Ps=space(),Qs=element("div"),Js=element("h4"),Js.textContent="Georeference",qs=space(),Gs=element("div"),create_component(Zs.$$.fragment),Es=space(),fs=element("div"),vs=space(),Bs=element("div"),Ls=space(),create_component(Fs.$$.fragment),attr(h,"title",locStringsTitle),attr(h,"class","svelte-5apqlr"),attr(Bo,"class","recordgroup-tool svelte-5apqlr"),attr(Bo,"title","back to datasets"),attr(Qo,"class","material-icons"),attr(Uo,"class","recordgroup-tool svelte-5apqlr"),attr(Uo,"title","restart queue"),Uo.disabled=l[2],attr(Mo,"class","recordgroup-tool svelte-5apqlr"),attr(Mo,"title","clear georefs added to this group"),attr(jo,"class","material-icons"),attr($o,"class","recordgroup-tool svelte-5apqlr"),attr($o,"title","skip this group"),$o.disabled=zo=!l[3].georefIndex,attr(Wo,"class","recordgroup-tool svelte-5apqlr"),attr(Wo,"title","state selected localities cannot be georeferenced"),attr(Jo,"class","label svelte-5apqlr"),attr(is,"class","bookmarkToggle svelte-5apqlr"),attr(c,"class","recordgroup-container svelte-5apqlr"),attr(_s,"class","svelte-5apqlr"),attr(ms,"class","matchlist-flex svelte-5apqlr"),attr(ps,"class","matchlist-flex-plug svelte-5apqlr"),attr(Is,"class","matchlist-container svelte-5apqlr"),attr(xs,"class","matchmap-container svelte-5apqlr"),attr(Js,"class","georef-flex-header svelte-5apqlr"),attr(Gs,"class","georef-form-flex svelte-5apqlr"),attr(fs,"class","georef-form-plug svelte-5apqlr"),attr(Qs,"class","georef-form-container svelte-5apqlr"),attr(s,"class","grid-container svelte-5apqlr"),attr(o,"class","col-flex-container svelte-5apqlr"),attr(Bs,"class","stopper svelte-5apqlr")},m(rl,Cl){insert(rl,o,Cl),append(o,s),append(s,c),append(c,h),append(h,d),append(c,p),append(c,Co),append(Co,Bo),append(Co,Lo),append(Co,Uo),append(Uo,Qo),append(Co,Po),append(Co,Mo),append(Co,Go),append(Co,$o),append($o,jo),append(Co,Xo),ca.m(Co,null),append(Co,Zo),append(Co,Wo),append(c,es),append(c,is),append(is,Jo),append(is,Ko),mount_component(Yo,is,null),append(c,ss),$s&&$s.m(c,null),append(c,cs),Xs[as].m(c,null),append(s,gs),append(s,Is),append(Is,_s),append(Is,Hs),mount_component(ds,Is,null),append(Is,ys),append(Is,ms),mount_component(Rs,ms,null),append(Is,bs),append(Is,ps),append(s,ks),append(s,xs),mount_component(Ss,xs,null),append(s,Ps),append(s,Qs),append(Qs,Js),append(Qs,qs),append(Qs,Gs),mount_component(Zs,Gs,null),l[46](Gs),append(Qs,Es),append(Qs,fs),insert(rl,vs,Cl),insert(rl,Bs,Cl),insert(rl,Ls,Cl),mount_component(Fs,rl,Cl),zs=!0,js||(ma=[listen(window_1$2,"beforeunload",l[36]),listen(window_1$2,"unload",l[37]),listen(Bo,"click",l[30]),listen(Uo,"click",l[19]),listen(Mo,"click",l[31]),listen($o,"click",l[20]),listen(Wo,"click",l[34])],js=!0)},p(rl,Cl){(!zs||Cl[0]&4)&&(Uo.disabled=rl[2]),(!zs||Cl[0]&8&&zo!==(zo=!rl[3].georefIndex))&&($o.disabled=zo),va===(va=Ws(rl))&&ca?ca.p(rl,Cl):(ca.d(1),ca=va(rl),ca&&(ca.c(),ca.m(Co,Zo)));const Ul={};Cl[0]&8192&&(Ul.disabled=!rl[13]||rl[13].length==0),!ts&&Cl[0]&4&&(ts=!0,Ul.toggled=rl[2],add_flush_callback(()=>ts=!1)),Yo.$set(Ul),rl[0].countryProvs?$s?($s.p(rl,Cl),Cl[0]&1&&transition_in($s,1)):($s=create_if_block_5$1(rl),$s.c(),transition_in($s,1),$s.m(c,cs)):$s&&(group_outros(),transition_out($s,1,1,()=>{$s=null}),check_outros());let Nl=as;as=ll(rl),as===Nl?Xs[as].p(rl,Cl):(group_outros(),transition_out(Xs[Nl],1,1,()=>{Xs[Nl]=null}),check_outros(),us=Xs[as],us?us.p(rl,Cl):(us=Xs[as]=ga[as](rl),us.c()),transition_in(us,1),us.m(c,null));const Ll={};Cl[0]&512&&(Ll.elasticindex=rl[9]),!hs&&Cl[0]&1024&&(hs=!0,Ll.customSearchString=rl[10],add_flush_callback(()=>hs=!1)),ds.$set(Ll);const hl={};!Us&&Cl[0]&32768&&(Us=!0,hl.pastedDecimalCoords=rl[15],add_flush_callback(()=>Us=!1)),Ss.$set(hl);const gl={};Cl[0]&64&&(gl.georef=rl[6]),Cl[0]&2&&(gl.defaultGeorefBy=rl[1].formattedName),Cl[0]&2&&(gl.defaultGeorefByORCID=rl[1].orcid),Zs.$set(gl)},i(rl){zs||(transition_in(Yo.$$.fragment,rl),transition_in($s),transition_in(us),transition_in(ds.$$.fragment,rl),transition_in(Rs.$$.fragment,rl),transition_in(Ss.$$.fragment,rl),transition_in(Zs.$$.fragment,rl),transition_in(Fs.$$.fragment,rl),zs=!0)},o(rl){transition_out(Yo.$$.fragment,rl),transition_out($s),transition_out(us),transition_out(ds.$$.fragment,rl),transition_out(Rs.$$.fragment,rl),transition_out(Ss.$$.fragment,rl),transition_out(Zs.$$.fragment,rl),transition_out(Fs.$$.fragment,rl),zs=!1},d(rl){rl&&detach(o),ca.d(),destroy_component(Yo),$s&&$s.d(),Xs[as].d(),destroy_component(ds),destroy_component(Rs),destroy_component(Ss),l[45](null),destroy_component(Zs),l[46](null),rl&&detach(vs),rl&&detach(Bs),rl&&detach(Ls),destroy_component(Fs,rl),js=!1,run_all(ma)}}}let savingGeoref=!1,locStringsTitle="Select the items below that represent the same locality and then choose and apply or create an appropriate georeference";function instance$9(l,o,s){let c;component_subscribe(l,dataStore,Ms=>s(3,c=Ms));let{dataset:h}=o,{profile:d}=o,p,Co,Bo,Lo=createEventDispatcher(),Uo,Qo=!0,Po=!1,Mo=!1,Go=!1,$o,jo=[],zo=[],Xo=null,Zo=null,Wo=null,es=null,is=null,Jo=!1,Ko=!1,Yo=null,ts=0,ss,cs=null,as=0,us=0,gs=!1,Is,_s;const Hs=async Ms=>{let $s,ga=`userDatasetQueuePosition/${d.uid}/${h.datasetID}/${Wo}`;h.hasStateProvince&&(es?ga+=`/${es}`:ga+="/all");try{$s=await Realtime.ref(ga).once("value")}catch(Xs){throw Xs.message="there was an error getting last recordgroup SNAP for this user: "+Xs.message,Xs}if($s.exists())return $s.val();{let Xs=`userDatasetQueuePosition/${d.uid}/${h.datasetID}`,ll;try{ll=await Realtime.ref(Xs).once("value")}catch(nl){throw nl.message="there was an error getting last recordgroup SNAP for this user: "+nl.message,nl}if(ll.exists())return null;let sl;try{sl=await Realtime.ref(`userDatasetLastRecordGroup/${d.uid}/${h.datasetID}`).once("value")}catch(nl){throw nl.message="there was an error getting last recordgroup SNAP for this user: "+nl.message,nl}if(sl.exists()){const nl=sl.val();let pl;try{pl=await Firestore.collection("recordGroups").doc(nl).get()}catch(El){throw El.message="there was an error getting last recordgroup for this user: "+El.message,El}if(pl.exists)return pl.data().groupID}}return null};onMount(async Ms=>{s(9,$o=h.region.toLowerCase().replace(/\s+/g,"")+h.domain.toLowerCase()),Firestore.collection("userDatasetBookmarks").where("uid","==",d.uid).where("datasetID","==",h.datasetID).get().then(Xs=>{if(!Xs.empty){const ll=Xs.docs[0],sl=ll.data();s(13,is=sl.recordGroupIDs),Yo=ll.ref}});let $s;try{$s=await Hs()}catch(Xs){alert(Xs.message),console.error(Xs);return}try{ds("at",$s)}catch(Xs){alert("there was an error getting a record group to georeference: "+Xs.message),console.error(Xs)}Realtime.ref(".info/connected").on("value",function(Xs){Xs.val()===!0?s(38,Qo=!0):s(38,Qo=!1)}),s(39,Po=!0)}),onDestroy(async Ms=>{await hs()});const ds=async(Ms,$s)=>{if(Qo){set_store_value(dataStore,c.recordGroup=null,c),set_store_value(dataStore,c.recordGroupSnap=null,c),set_store_value(dataStore,c.georefIndex=null,c),set_store_value(dataStore,c.locGeorefIndex=null,c),Ss(),jo=[],zo=[],as=0,us=0,s(10,Xo=null);let ga=null;if(Jo)if(ts<is.length){const sl=is[ts],nl=await Firestore.collection("recordGroups").doc(sl).get();if(nl.exists)ga=[nl];else{alert("Could not fetch bookmarked recordGroup with ID",sl);return}}else{alert("You have no more bookmarked locality groups for this dataset"),s(2,Jo=!1);return}else{let sl=null;Wo&&(sl=Wo);let nl=null;for(es&&(nl=es);!ga;)try{ga=await getNextAvailableRecordGroup(h.datasetID,sl,nl,Ms,$s)}catch(pl){console.error(pl),alert("error fetching locality group, see console");return}if(!ga.length){s(16,gs=!0);return}}set_store_value(dataStore,c.recordGroupSnap=ga[0],c),set_store_value(dataStore,c.recordGroup=c.recordGroupSnap.data(),c);for(let sl of c.recordGroup.groupLocalities)sl.id||(sl.id=nanoid());let Xs=Math.round(100/c.recordGroup.groupLocalities.length);Xs>20&&(Xs=20),Xs<5&&(Xs=5);let ll;try{ll=await fetchCandidateGeorefs(c.recordGroup.groupLocalities,$o,Xs,!0)}catch(sl){console.error("error fetching georefs:",sl.message),alert("fetching georeferences failed")}if(Zo=null,Object.keys(ll.georefIndex).length&&(set_store_value(dataStore,c.georefIndex=ll.georefIndex,c),set_store_value(dataStore,c.locGeorefIndex=ll.locGeorefIndex,c)),!Jo){let sl=`userDatasetQueuePosition/${d.uid}/${h.datasetID}/${Wo}`;h.hasStateProvince&&(es?sl+=`/${es}`:sl+="/all");try{await Realtime.ref(sl).set(c.recordGroup.groupID)}catch(nl){console.error("error updating userLastSnap on firebase:",nl.message),console.error(nl)}}s(7,Mo=!1)}else alert("You are not online, please check your connection")},hs=async Ms=>{if(c.recordGroupSnap)try{await c.recordGroupSnap.ref.update({groupLocked:!1})}catch($s){alert("error releasing the locality group:"+$s.message)}},ys=async Ms=>{if(c.recordGroupSnap){let $s=c.recordGroup.groupLocalities.filter(ll=>ll.georefID).length,ga=c.recordGroup.groupLocalities.length,Xs=!1;$s==ga&&(Xs=!0,set_store_value(dataStore,c.recordGroup.completed=!0,c)),set_store_value(dataStore,c.recordGroup.groupLocked=!1,c),c.recordGroup.georeferencers&&Array.isArray(c.recordGroup.georeferencers)?c.recordGroup.georeferencers.includes(d.uid)||c.recordGroup.georeferencers.push(d.uid):set_store_value(dataStore,c.recordGroup.georeferencers=[d.uid],c);for(let ll of c.recordGroup.groupLocalities)delete ll.id;s(8,Go=!0);try{await c.recordGroupSnap.ref.set(c.recordGroup)}catch(ll){alert("error saving record group:"+ll.message),console.error(ll),console.log(c.recordGroup),s(8,Go=!1)}if(as||us){let ll=[],sl={};for(let nl of c.recordGroup.groupLocalities)nl.georefID&&(sl[nl.georefID]?sl[nl.georefID]=[...sl[nl.georefID],...nl.recordIDs]:sl[nl.georefID]=nl.recordIDs);for(let[nl,pl]of Object.entries(sl)){let El=c.georefIndex[nl];El&&ll.push(updateGeorefRecords(Firestore,FieldValue,El,h.datasetID,pl))}ll.push(updateGeorefStats(Realtime,ServerValue,as,us,d.uid,d.formattedName,h.datasetID,Xs)),ll.push(updateDatasetStats(Firestore,Bo,us,d.formattedName,Xs)),ll.push(updateDatasetGeorefs(Firestore,FieldValue,h.datasetID,zo));try{await Promise.all(ll)}catch(nl){s(8,Go=!1),console.error(nl),alert("there was an error updating stats: "+nl.message)}}s(8,Go=!1)}},ms=async Ms=>{let $s="Are you sure you want to start over for ";if(h.countryProvs?Wo=="all"?$s+="all countries":($s+=Wo,es!="all"&&(es=="none"?$s+=" (no stateProvince)":$s+=", "+es)):$s+="this dataset",$s+="?",confirm($s)){let Xs=`userDatasetQueuePosition/${d.uid}/${h.datasetID}/`;Wo?(Xs+=Wo,es?Xs+="/"+es:Xs+="/all"):Xs+="all";try{await Realtime.ref(Xs).remove()}catch{console.log(Xs,"does not exist. No action necessary")}ds()}},Rs=async Ms=>{s(7,Mo=!0),as||us?await ys():await hs(),Jo?(ts++,ts>=is.length?(alert("You have no more bookmarked locality groups for this dataset"),s(2,Jo=!1)):await ds()):await ds("after",c.recordGroup.groupID)},bs=Ms=>{c.selectedGeorefID&&qs(c.selectedGeorefID),Zo||(Zo=c.georefIndex),set_store_value(dataStore,c.georefIndex=null,c)},ps=async Ms=>{s(11,Wo=Ms.detail.country),s(12,es=Ms.detail.stateProvince),s(16,gs=!1),s(7,Mo=!0),as||us?await ys():await hs();let $s;try{$s=await Hs()}catch(ga){alert(ga.message),console.error(ga);return}try{await ds("at",$s)}catch(ga){alert("there was an error getting a record group to georeference: "+ga.message),console.error(ga)}s(7,Mo=!1)},ks=Ms=>{let $s=Ms.detail;set_store_value(dataStore,c.georefIndex=$s,c)},xs=Ms=>{c.selectedGeorefID&&qs(c.selectedGeorefID),Zo&&(set_store_value(dataStore,c.georefIndex=Zo,c),Zo=null)},Ss=Ms=>{if(Uo){let $s=Uo;s(6,Uo=null),$s.selected=!1}Co.clear()},Us=Ms=>{c.selectedGeorefID&&qs(c.selectedGeorefID)},Ps=async Ms=>{Ss();let $s=Ms.detail;delete c.georefIndex[$s],set_store_value(dataStore,c.georefIndex=c.georefIndex,c),await flagGeoref($s,$o)},Qs=Ms=>{s(15,cs=Ms.detail)},Js=Ms=>{if(c.selectedGeorefID&&qs(c.selectedGeorefID),Ms&&Ms.detail){let $s=Ms.detail;set_store_value(dataStore,c.georefIndex[$s].selected=!0,c),s(6,Uo=c.georefIndex[$s]),Uo.ambiguous&&s(4,p.scrollTop=0,p);let ga=c.markers[$s];ga&&(ga.setIcon({path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"blue",fillOpacity:1,strokeColor:"blue"}),ga.setZIndex(1),ga.panToMe()),set_store_value(dataStore,c.selectedGeorefID=$s,c),set_store_value(dataStore,c.georefIndex=c.georefIndex,c)}},qs=Ms=>{let $s=c.markers[Ms];$s&&($s.setIcon({path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"green",fillOpacity:1,strokeColor:"green"}),$s.setZIndex(0)),c.georefIndex[Ms]&&set_store_value(dataStore,c.georefIndex[Ms].selected=!1,c),set_store_value(dataStore,c.selectedGeorefID=null,c)},Gs=async Ms=>{let $s=Ms.detail;if(!$s.ambiguous){let Xs=["decimalCoordinates","uncertainty","uncertaintyUnit","datum","by","date","protocol","sources"],ll=[];for(let sl of Xs)(!$s[sl]||typeof $s[sl]=="string"&&!$s[sl].trim())&&ll.push(sl);if(ll.length){alert("Required fields are missing: "+ll.join(", ")+`\r
Please make sure these fields are completed before proceeding`);return}}let ga=c.recordGroup.groupLocalities.filter(Xs=>Xs.selected);if(ga.length){let Xs=!0;if(Uo&&Uo.georefID==$s.georefID&&(Xs=!1),Xs&&($s.used=!0,$s.persist(d,h,$o,!1),set_store_value(dataStore,c.georefIndex={...c.georefIndex,[$s.georefID]:$s},c)),!$s.used){$s.used=!0;let pl=`https://us-central1-georef-745b9.cloudfunctions.net/georefused?georefID=${$s.georefID}&index=${$o}`;fetch(pl),jo.push($s.georefID)}zo.push($s.georefID);let ll=null;try{ll=await getSafeTime()}catch(pl){Lo("componenterror",pl);return}for(let pl of ga)pl.georefID=$s.georefID,pl.georefBy=d.formattedName,pl.georefByUID=d.uid,pl.georefByID=d.orcid||null,pl.georefDate=ll,ss?pl.georefRemarks=ss:pl.georefRemarks=null,pl.georefVerified=!1,pl.georefVerifiedBy=null,pl.georefVerifiedDate=null,pl.georefVerifiedByRole=null,pl.georefVerifiedRemarks=null,pl.recordIDs&&pl.recordIDs.length&&(us+=pl.recordIDs.length),pl.selected=!1,s(14,ss=null);set_store_value(dataStore,c.recordGroup.groupLocalities=c.recordGroup.groupLocalities,c),c.selectedGeorefID&&qs(c.selectedGeorefID),Ss(),as+=ga.length;let sl=c.recordGroup.groupLocalities.filter(pl=>pl.georefID).length,nl=c.recordGroup.groupLocalities.length;sl==nl&&(await ys(),Jo?(ts++,ds()):ds("after",c.recordGroup.groupID))}else{alert("localities must be selected to apply the georeference");return}},Zs=async Ms=>{s(7,Mo=!0),as?await ys():await hs(),set_store_value(dataStore,c.recordGroupSnap=null,c),set_store_value(dataStore,c.recordGroup=null,c),set_store_value(dataStore,c.georefIndex=null,c),Lo("back-to-datasets")},Es=Ms=>{if(c.recordGroup){for(let $s of c.recordGroup.groupLocalities)$s.georefID=null;if(dataStore.set(c),jo.length){for(let $s of jo){set_store_value(dataStore,c.georefIndex[$s].used=!1,c);let ga=`https://us-central1-georef-745b9.cloudfunctions.net/georefused?georefID=${$s}&index=${$o}&setfalse`;fetch(ga)}jo=[]}as=0,us=0}},fs=async Ms=>{let $s=c.recordGroupSnap.id;if(Ms.currentTarget.disabled=!0,Yo)try{await Yo.update({recordGroupIDs:FieldValue.arrayUnion($s)}),is.push($s),await c.recordGroupSnap.ref.update({bookmarked:!0,bookmarkedBy:d.formattedName,bookmarkedByUID:d.uid,bookmarkedDate:FieldValue.serverTimestamp()})}catch(ga){console.error(ga),alert("error bookmarking record group: "+ga.message);return}else{let ga={uid:d.uid,datasetID:h.datasetID,recordGroupIDs:[$s]};try{Yo=await Firestore.collection("userDatasetBookmarks").add(ga)}catch(Xs){console.error(Xs),alert("error adding first bookmark for user");return}s(13,is=[$s]);try{await c.recordGroupSnap.ref.update({bookmarked:!0,bookmarkedBy:d.formattedName,bookmarkedByUID:d.uid,bookmarkedDate:FieldValue.serverTimestamp()})}catch(Xs){console.error(Xs),alert("error updating record group bookmark data");return}}set_store_value(dataStore,c.recordGroup.bookmarked=!0,c),set_store_value(dataStore,c.recordGroup.bookmarkedBy=d.formattedName,c),set_store_value(dataStore,c.recordGroup.bookmarkedByUID=d.uid,c),window.pushToast&&window.pushToast("locality group bookmarked")},vs=async Ms=>{let $s=c.recordGroupSnap.id;Ms.currentTarget.disabled=!0;try{await Yo.update({recordGroupIDs:FieldValue.arrayRemove($s)})}catch(Xs){console.error(Xs),alert("error removing bookmarked record group");return}try{await c.recordGroupSnap.ref.update({bookmarked:!1,bookmarkedBy:null,bookmarkedByUID:null,bookmarkedDate:null})}catch(Xs){console.error(Xs),alert("error updating recordgroup bookmark details");return}const ga=is.indexOf($s);is.splice(ga,1),Jo&&ts>0&&ts--,set_store_value(dataStore,c.recordGroup.bookmarked=!1,c),set_store_value(dataStore,c.recordGroup.bookmarkedBy=null,c),set_store_value(dataStore,c.recordGroup.bookmarkedByUID=null,c),window.pushToast&&window.pushToast("locality group unbookmarked")},Bs=Ms=>{let $s=c.recordGroup.groupLocalities.filter(ga=>ga.selected);if($s.length)if(ss&&ss.trim()){let ga=new Georef;ga.locality=$s[0].loc,ga.ambiguous=!0,ga.by=d.formattedName,ga.byORCID=d.orcid||null;let Xs=new Date;ga.date=new Date(Xs.getTime()-Xs.getTimezoneOffset()*60*1e3).toISOString().split("T")[0],ga.originalGeorefSource="NSCF georeference database",ga.protocol=null,ga.remarks=ss,Gs({detail:ga})}else alert("Please add remarks (e.g. ambiguous or imprecise) under Locality Strings in order to assert no georef");else alert("No locality strings selected")},Ls=Ms=>{window.pushToast&&window.pushToast("locality copied")},Fs=Ms=>{if(as)return Ms.preventDefault(),Ms.returnValue="georefs have not been saved, go back to datsets before closing","georefs have not been saved, go back to datsets before closing"},zs=Ms=>{navigator.sendBeacon(`https://us-central1-georef-745b9.cloudfunctions.net/updaterecordgrouplock?groupid=${c.recordGroupSnap.id}`,"")};function js(Ms){Jo=Ms,s(2,Jo)}function ma(){ss=this.value,s(14,ss)}function Ws(Ms){Xo=Ms,s(10,Xo)}function va(Ms){cs=Ms,s(15,cs)}function ca(Ms){binding_callbacks[Ms?"unshift":"push"](()=>{Co=Ms,s(5,Co)})}function cl(Ms){binding_callbacks[Ms?"unshift":"push"](()=>{p=Ms,s(4,p)})}return l.$$set=Ms=>{"dataset"in Ms&&s(0,h=Ms.dataset),"profile"in Ms&&s(1,d=Ms.profile)},l.$$.update=()=>{l.$$.dirty[0]&1&&Firestore&&(Bo=Firestore.collection("datasets").doc(h.datasetID)),l.$$.dirty[0]&8&&c.recordGroup&&c.recordGroup.groupLocalities&&(s(17,Is=c.recordGroup.groupLocalities.filter(Ms=>!Ms.georefID).map(Ms=>Ms.recordIDs.length).reduce((Ms,$s)=>Ms+$s,0)),s(18,_s=c.recordGroup.groupLocalities.filter(Ms=>!Ms.georefID).length)),l.$$.dirty[1]&384&&!Qo&&Po&&alert("There appears to be a problem with your connection. Please check before continuing"),l.$$.dirty[0]&4|l.$$.dirty[1]&512&&(Jo?(ts=0,s(40,Ko=!0),ds()):Ko&&Hs().then(Ms=>{ds("at",Ms)}).catch(Ms=>{console.error(Ms),alert("error getting users last group ID")}))},[h,d,Jo,c,p,Co,Uo,Mo,Go,$o,Xo,Wo,es,is,ss,cs,gs,Is,_s,ms,Rs,bs,ps,ks,xs,Us,Ps,Qs,Js,Gs,Zs,Es,fs,vs,Bs,Ls,Fs,zs,Qo,Po,Ko,js,ma,Ws,va,ca,cl]}class Georef_1 extends SvelteComponent{constructor(o){super(),init(this,o,instance$9,create_fragment$9,safe_not_equal,{dataset:0,profile:1},null,[-1,-1])}}/*!
 * html2canvas 1.3.2 <https://html2canvas.hertzen.com>
 * Copyright (c) 2021 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(l,o){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,c){s.__proto__=c}||function(s,c){for(var h in c)Object.prototype.hasOwnProperty.call(c,h)&&(s[h]=c[h])},extendStatics(l,o)};function __extends(l,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");extendStatics(l,o);function s(){this.constructor=l}l.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}var __assign=function(){return __assign=Object.assign||function(o){for(var s,c=1,h=arguments.length;c<h;c++){s=arguments[c];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(o[d]=s[d])}return o},__assign.apply(this,arguments)};function __awaiter(l,o,s,c){function h(d){return d instanceof s?d:new s(function(p){p(d)})}return new(s||(s=Promise))(function(d,p){function Co(Uo){try{Lo(c.next(Uo))}catch(Qo){p(Qo)}}function Bo(Uo){try{Lo(c.throw(Uo))}catch(Qo){p(Qo)}}function Lo(Uo){Uo.done?d(Uo.value):h(Uo.value).then(Co,Bo)}Lo((c=c.apply(l,o||[])).next())})}function __generator(l,o){var s={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},c,h,d,p;return p={next:Co(0),throw:Co(1),return:Co(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function Co(Lo){return function(Uo){return Bo([Lo,Uo])}}function Bo(Lo){if(c)throw new TypeError("Generator is already executing.");for(;s;)try{if(c=1,h&&(d=Lo[0]&2?h.return:Lo[0]?h.throw||((d=h.return)&&d.call(h),0):h.next)&&!(d=d.call(h,Lo[1])).done)return d;switch(h=0,d&&(Lo=[Lo[0]&2,d.value]),Lo[0]){case 0:case 1:d=Lo;break;case 4:return s.label++,{value:Lo[1],done:!1};case 5:s.label++,h=Lo[1],Lo=[0];continue;case 7:Lo=s.ops.pop(),s.trys.pop();continue;default:if(d=s.trys,!(d=d.length>0&&d[d.length-1])&&(Lo[0]===6||Lo[0]===2)){s=0;continue}if(Lo[0]===3&&(!d||Lo[1]>d[0]&&Lo[1]<d[3])){s.label=Lo[1];break}if(Lo[0]===6&&s.label<d[1]){s.label=d[1],d=Lo;break}if(d&&s.label<d[2]){s.label=d[2],s.ops.push(Lo);break}d[2]&&s.ops.pop(),s.trys.pop();continue}Lo=o.call(l,s)}catch(Uo){Lo=[6,Uo],h=0}finally{c=d=0}if(Lo[0]&5)throw Lo[1];return{value:Lo[0]?Lo[1]:void 0,done:!0}}}function __spreadArray(l,o,s){if(s||arguments.length===2)for(var c=0,h=o.length,d;c<h;c++)(d||!(c in o))&&(d||(d=Array.prototype.slice.call(o,0,c)),d[c]=o[c]);return l.concat(d||o)}var Bounds=function(){function l(o,s,c,h){this.left=o,this.top=s,this.width=c,this.height=h}return l.prototype.add=function(o,s,c,h){return new l(this.left+o,this.top+s,this.width+c,this.height+h)},l.fromClientRect=function(o,s){return new l(s.left+o.windowBounds.left,s.top+o.windowBounds.top,s.width,s.height)},l.fromDOMRectList=function(o,s){var c=s[0];return c?new l(c.x+o.windowBounds.left,c.y+o.windowBounds.top,c.width,c.height):l.EMPTY},l.EMPTY=new l(0,0,0,0),l}(),parseBounds=function(l,o){return Bounds.fromClientRect(l,o.getBoundingClientRect())},parseDocumentSize=function(l){var o=l.body,s=l.documentElement;if(!o||!s)throw new Error("Unable to get document size");var c=Math.max(Math.max(o.scrollWidth,s.scrollWidth),Math.max(o.offsetWidth,s.offsetWidth),Math.max(o.clientWidth,s.clientWidth)),h=Math.max(Math.max(o.scrollHeight,s.scrollHeight),Math.max(o.offsetHeight,s.offsetHeight),Math.max(o.clientHeight,s.clientHeight));return new Bounds(0,0,c,h)},toCodePoints$1=function(l){for(var o=[],s=0,c=l.length;s<c;){var h=l.charCodeAt(s++);if(h>=55296&&h<=56319&&s<c){var d=l.charCodeAt(s++);(d&64512)===56320?o.push(((h&1023)<<10)+(d&1023)+65536):(o.push(h),s--)}else o.push(h)}return o},fromCodePoint$1=function(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];if(String.fromCodePoint)return String.fromCodePoint.apply(String,l);var s=l.length;if(!s)return"";for(var c=[],h=-1,d="";++h<s;){var p=l[h];p<=65535?c.push(p):(p-=65536,c.push((p>>10)+55296,p%1024+56320)),(h+1===s||c.length>16384)&&(d+=String.fromCharCode.apply(String,c),c.length=0)}return d},chars$2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$2=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i$2=0;i$2<chars$2.length;i$2++)lookup$2[chars$2.charCodeAt(i$2)]=i$2;var decode$1=function(l){var o=l.length*.75,s=l.length,c,h=0,d,p,Co,Bo;l[l.length-1]==="="&&(o--,l[l.length-2]==="="&&o--);var Lo=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(o):new Array(o),Uo=Array.isArray(Lo)?Lo:new Uint8Array(Lo);for(c=0;c<s;c+=4)d=lookup$2[l.charCodeAt(c)],p=lookup$2[l.charCodeAt(c+1)],Co=lookup$2[l.charCodeAt(c+2)],Bo=lookup$2[l.charCodeAt(c+3)],Uo[h++]=d<<2|p>>4,Uo[h++]=(p&15)<<4|Co>>2,Uo[h++]=(Co&3)<<6|Bo&63;return Lo},polyUint16Array$1=function(l){for(var o=l.length,s=[],c=0;c<o;c+=2)s.push(l[c+1]<<8|l[c]);return s},polyUint32Array$1=function(l){for(var o=l.length,s=[],c=0;c<o;c+=4)s.push(l[c+3]<<24|l[c+2]<<16|l[c+1]<<8|l[c]);return s},UTRIE2_SHIFT_2$1=5,UTRIE2_SHIFT_1$1=6+5,UTRIE2_INDEX_SHIFT$1=2,UTRIE2_SHIFT_1_2$1=UTRIE2_SHIFT_1$1-UTRIE2_SHIFT_2$1,UTRIE2_LSCP_INDEX_2_OFFSET$1=65536>>UTRIE2_SHIFT_2$1,UTRIE2_DATA_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_2$1,UTRIE2_DATA_MASK$1=UTRIE2_DATA_BLOCK_LENGTH$1-1,UTRIE2_LSCP_INDEX_2_LENGTH$1=1024>>UTRIE2_SHIFT_2$1,UTRIE2_INDEX_2_BMP_LENGTH$1=UTRIE2_LSCP_INDEX_2_OFFSET$1+UTRIE2_LSCP_INDEX_2_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_OFFSET$1=UTRIE2_INDEX_2_BMP_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_LENGTH$1=32,UTRIE2_INDEX_1_OFFSET$1=UTRIE2_UTF8_2B_INDEX_2_OFFSET$1+UTRIE2_UTF8_2B_INDEX_2_LENGTH$1,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1=65536>>UTRIE2_SHIFT_1$1,UTRIE2_INDEX_2_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_1_2$1,UTRIE2_INDEX_2_MASK$1=UTRIE2_INDEX_2_BLOCK_LENGTH$1-1,slice16$1=function(l,o,s){return l.slice?l.slice(o,s):new Uint16Array(Array.prototype.slice.call(l,o,s))},slice32$1=function(l,o,s){return l.slice?l.slice(o,s):new Uint32Array(Array.prototype.slice.call(l,o,s))},createTrieFromBase64$1=function(l){var o=decode$1(l),s=Array.isArray(o)?polyUint32Array$1(o):new Uint32Array(o),c=Array.isArray(o)?polyUint16Array$1(o):new Uint16Array(o),h=24,d=slice16$1(c,h/2,s[4]/2),p=s[5]===2?slice16$1(c,(h+s[4])/2):slice32$1(s,Math.ceil((h+s[4])/4));return new Trie$1(s[0],s[1],s[2],s[3],d,p)},Trie$1=function(){function l(o,s,c,h,d,p){this.initialValue=o,this.errorValue=s,this.highStart=c,this.highValueIndex=h,this.index=d,this.data=p}return l.prototype.get=function(o){var s;if(o>=0){if(o<55296||o>56319&&o<=65535)return s=this.index[o>>UTRIE2_SHIFT_2$1],s=(s<<UTRIE2_INDEX_SHIFT$1)+(o&UTRIE2_DATA_MASK$1),this.data[s];if(o<=65535)return s=this.index[UTRIE2_LSCP_INDEX_2_OFFSET$1+(o-55296>>UTRIE2_SHIFT_2$1)],s=(s<<UTRIE2_INDEX_SHIFT$1)+(o&UTRIE2_DATA_MASK$1),this.data[s];if(o<this.highStart)return s=UTRIE2_INDEX_1_OFFSET$1-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1+(o>>UTRIE2_SHIFT_1$1),s=this.index[s],s+=o>>UTRIE2_SHIFT_2$1&UTRIE2_INDEX_2_MASK$1,s=this.index[s],s=(s<<UTRIE2_INDEX_SHIFT$1)+(o&UTRIE2_DATA_MASK$1),this.data[s];if(o<=1114111)return this.data[this.highValueIndex]}return this.errorValue},l}(),base64$1="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",LETTER_NUMBER_MODIFIER=50,BK=1,CR$1=2,LF$1=3,CM=4,NL=5,WJ=7,ZW=8,GL=9,SP=10,ZWJ$1=11,B2=12,BA=13,BB=14,HY=15,CB=16,CL=17,CP=18,EX=19,IN=20,NS=21,OP=22,QU=23,IS=24,NU=25,PO=26,PR=27,SY=28,AI=29,AL=30,CJ=31,EB=32,EM=33,H2=34,H3=35,HL=36,ID=37,JL=38,JV=39,JT=40,RI$1=41,SA=42,XX=43,ea_OP=[9001,65288],BREAK_MANDATORY="!",BREAK_NOT_ALLOWED$1="\xD7",BREAK_ALLOWED$1="\xF7",UnicodeTrie$1=createTrieFromBase64$1(base64$1),ALPHABETICS=[AL,HL],HARD_LINE_BREAKS=[BK,CR$1,LF$1,NL],SPACE$1=[SP,ZW],PREFIX_POSTFIX=[PR,PO],LINE_BREAKS=HARD_LINE_BREAKS.concat(SPACE$1),KOREAN_SYLLABLE_BLOCK=[JL,JV,JT,H2,H3],HYPHEN=[HY,BA],codePointsToCharacterClasses=function(l,o){o===void 0&&(o="strict");var s=[],c=[],h=[];return l.forEach(function(d,p){var Co=UnicodeTrie$1.get(d);if(Co>LETTER_NUMBER_MODIFIER?(h.push(!0),Co-=LETTER_NUMBER_MODIFIER):h.push(!1),["normal","auto","loose"].indexOf(o)!==-1&&[8208,8211,12316,12448].indexOf(d)!==-1)return c.push(p),s.push(CB);if(Co===CM||Co===ZWJ$1){if(p===0)return c.push(p),s.push(AL);var Bo=s[p-1];return LINE_BREAKS.indexOf(Bo)===-1?(c.push(c[p-1]),s.push(Bo)):(c.push(p),s.push(AL))}if(c.push(p),Co===CJ)return s.push(o==="strict"?NS:ID);if(Co===SA||Co===AI)return s.push(AL);if(Co===XX)return d>=131072&&d<=196605||d>=196608&&d<=262141?s.push(ID):s.push(AL);s.push(Co)}),[c,s,h]},isAdjacentWithSpaceIgnored=function(l,o,s,c){var h=c[s];if(Array.isArray(l)?l.indexOf(h)!==-1:l===h)for(var d=s;d<=c.length;){d++;var p=c[d];if(p===o)return!0;if(p!==SP)break}if(h===SP)for(var d=s;d>0;){d--;var Co=c[d];if(Array.isArray(l)?l.indexOf(Co)!==-1:l===Co)for(var Bo=s;Bo<=c.length;){Bo++;var p=c[Bo];if(p===o)return!0;if(p!==SP)break}if(Co!==SP)break}return!1},previousNonSpaceClassType=function(l,o){for(var s=l;s>=0;){var c=o[s];if(c===SP)s--;else return c}return 0},_lineBreakAtIndex=function(l,o,s,c,h){if(s[c]===0)return BREAK_NOT_ALLOWED$1;var d=c-1;if(Array.isArray(h)&&h[d]===!0)return BREAK_NOT_ALLOWED$1;var p=d-1,Co=d+1,Bo=o[d],Lo=p>=0?o[p]:0,Uo=o[Co];if(Bo===CR$1&&Uo===LF$1)return BREAK_NOT_ALLOWED$1;if(HARD_LINE_BREAKS.indexOf(Bo)!==-1)return BREAK_MANDATORY;if(HARD_LINE_BREAKS.indexOf(Uo)!==-1||SPACE$1.indexOf(Uo)!==-1)return BREAK_NOT_ALLOWED$1;if(previousNonSpaceClassType(d,o)===ZW)return BREAK_ALLOWED$1;if(UnicodeTrie$1.get(l[d])===ZWJ$1||(Bo===EB||Bo===EM)&&UnicodeTrie$1.get(l[Co])===ZWJ$1||Bo===WJ||Uo===WJ||Bo===GL||[SP,BA,HY].indexOf(Bo)===-1&&Uo===GL||[CL,CP,EX,IS,SY].indexOf(Uo)!==-1||previousNonSpaceClassType(d,o)===OP||isAdjacentWithSpaceIgnored(QU,OP,d,o)||isAdjacentWithSpaceIgnored([CL,CP],NS,d,o)||isAdjacentWithSpaceIgnored(B2,B2,d,o))return BREAK_NOT_ALLOWED$1;if(Bo===SP)return BREAK_ALLOWED$1;if(Bo===QU||Uo===QU)return BREAK_NOT_ALLOWED$1;if(Uo===CB||Bo===CB)return BREAK_ALLOWED$1;if([BA,HY,NS].indexOf(Uo)!==-1||Bo===BB||Lo===HL&&HYPHEN.indexOf(Bo)!==-1||Bo===SY&&Uo===HL||Uo===IN||ALPHABETICS.indexOf(Uo)!==-1&&Bo===NU||ALPHABETICS.indexOf(Bo)!==-1&&Uo===NU||Bo===PR&&[ID,EB,EM].indexOf(Uo)!==-1||[ID,EB,EM].indexOf(Bo)!==-1&&Uo===PO||ALPHABETICS.indexOf(Bo)!==-1&&PREFIX_POSTFIX.indexOf(Uo)!==-1||PREFIX_POSTFIX.indexOf(Bo)!==-1&&ALPHABETICS.indexOf(Uo)!==-1||[PR,PO].indexOf(Bo)!==-1&&(Uo===NU||[OP,HY].indexOf(Uo)!==-1&&o[Co+1]===NU)||[OP,HY].indexOf(Bo)!==-1&&Uo===NU||Bo===NU&&[NU,SY,IS].indexOf(Uo)!==-1)return BREAK_NOT_ALLOWED$1;if([NU,SY,IS,CL,CP].indexOf(Uo)!==-1)for(var Qo=d;Qo>=0;){var Po=o[Qo];if(Po===NU)return BREAK_NOT_ALLOWED$1;if([SY,IS].indexOf(Po)!==-1)Qo--;else break}if([PR,PO].indexOf(Uo)!==-1)for(var Qo=[CL,CP].indexOf(Bo)!==-1?p:d;Qo>=0;){var Po=o[Qo];if(Po===NU)return BREAK_NOT_ALLOWED$1;if([SY,IS].indexOf(Po)!==-1)Qo--;else break}if(JL===Bo&&[JL,JV,H2,H3].indexOf(Uo)!==-1||[JV,H2].indexOf(Bo)!==-1&&[JV,JT].indexOf(Uo)!==-1||[JT,H3].indexOf(Bo)!==-1&&Uo===JT||KOREAN_SYLLABLE_BLOCK.indexOf(Bo)!==-1&&[IN,PO].indexOf(Uo)!==-1||KOREAN_SYLLABLE_BLOCK.indexOf(Uo)!==-1&&Bo===PR||ALPHABETICS.indexOf(Bo)!==-1&&ALPHABETICS.indexOf(Uo)!==-1||Bo===IS&&ALPHABETICS.indexOf(Uo)!==-1||ALPHABETICS.concat(NU).indexOf(Bo)!==-1&&Uo===OP&&ea_OP.indexOf(l[Co])===-1||ALPHABETICS.concat(NU).indexOf(Uo)!==-1&&Bo===CP)return BREAK_NOT_ALLOWED$1;if(Bo===RI$1&&Uo===RI$1){for(var Mo=s[d],Go=1;Mo>0&&(Mo--,o[Mo]===RI$1);)Go++;if(Go%2!==0)return BREAK_NOT_ALLOWED$1}return Bo===EB&&Uo===EM?BREAK_NOT_ALLOWED$1:BREAK_ALLOWED$1},cssFormattedClasses=function(l,o){o||(o={lineBreak:"normal",wordBreak:"normal"});var s=codePointsToCharacterClasses(l,o.lineBreak),c=s[0],h=s[1],d=s[2];(o.wordBreak==="break-all"||o.wordBreak==="break-word")&&(h=h.map(function(Co){return[NU,AL,SA].indexOf(Co)!==-1?ID:Co}));var p=o.wordBreak==="keep-all"?d.map(function(Co,Bo){return Co&&l[Bo]>=19968&&l[Bo]<=40959}):void 0;return[c,h,p]},Break=function(){function l(o,s,c,h){this.codePoints=o,this.required=s===BREAK_MANDATORY,this.start=c,this.end=h}return l.prototype.slice=function(){return fromCodePoint$1.apply(void 0,this.codePoints.slice(this.start,this.end))},l}(),LineBreaker=function(l,o){var s=toCodePoints$1(l),c=cssFormattedClasses(s,o),h=c[0],d=c[1],p=c[2],Co=s.length,Bo=0,Lo=0;return{next:function(){if(Lo>=Co)return{done:!0,value:null};for(var Uo=BREAK_NOT_ALLOWED$1;Lo<Co&&(Uo=_lineBreakAtIndex(s,d,h,++Lo,p))===BREAK_NOT_ALLOWED$1;);if(Uo!==BREAK_NOT_ALLOWED$1||Lo===Co){var Qo=new Break(s,Uo,Bo,Lo);return Bo=Lo,{value:Qo,done:!1}}return{done:!0,value:null}}}},FLAG_UNRESTRICTED=1<<0,FLAG_ID=1<<1,FLAG_INTEGER=1<<2,FLAG_NUMBER=1<<3,LINE_FEED=10,SOLIDUS=47,REVERSE_SOLIDUS=92,CHARACTER_TABULATION=9,SPACE=32,QUOTATION_MARK=34,EQUALS_SIGN=61,NUMBER_SIGN=35,DOLLAR_SIGN=36,PERCENTAGE_SIGN=37,APOSTROPHE=39,LEFT_PARENTHESIS=40,RIGHT_PARENTHESIS=41,LOW_LINE=95,HYPHEN_MINUS=45,EXCLAMATION_MARK=33,LESS_THAN_SIGN=60,GREATER_THAN_SIGN=62,COMMERCIAL_AT=64,LEFT_SQUARE_BRACKET=91,RIGHT_SQUARE_BRACKET=93,CIRCUMFLEX_ACCENT=61,LEFT_CURLY_BRACKET=123,QUESTION_MARK=63,RIGHT_CURLY_BRACKET=125,VERTICAL_LINE=124,TILDE=126,CONTROL=128,REPLACEMENT_CHARACTER=65533,ASTERISK=42,PLUS_SIGN=43,COMMA=44,COLON=58,SEMICOLON=59,FULL_STOP=46,NULL=0,BACKSPACE=8,LINE_TABULATION=11,SHIFT_OUT=14,INFORMATION_SEPARATOR_ONE=31,DELETE=127,EOF=-1,ZERO=48,a=97,e=101,f=102,u=117,z=122,A=65,E=69,F=70,U=85,Z=90,isDigit=function(l){return l>=ZERO&&l<=57},isSurrogateCodePoint=function(l){return l>=55296&&l<=57343},isHex=function(l){return isDigit(l)||l>=A&&l<=F||l>=a&&l<=f},isLowerCaseLetter=function(l){return l>=a&&l<=z},isUpperCaseLetter=function(l){return l>=A&&l<=Z},isLetter=function(l){return isLowerCaseLetter(l)||isUpperCaseLetter(l)},isNonASCIICodePoint=function(l){return l>=CONTROL},isWhiteSpace=function(l){return l===LINE_FEED||l===CHARACTER_TABULATION||l===SPACE},isNameStartCodePoint=function(l){return isLetter(l)||isNonASCIICodePoint(l)||l===LOW_LINE},isNameCodePoint=function(l){return isNameStartCodePoint(l)||isDigit(l)||l===HYPHEN_MINUS},isNonPrintableCodePoint=function(l){return l>=NULL&&l<=BACKSPACE||l===LINE_TABULATION||l>=SHIFT_OUT&&l<=INFORMATION_SEPARATOR_ONE||l===DELETE},isValidEscape=function(l,o){return l!==REVERSE_SOLIDUS?!1:o!==LINE_FEED},isIdentifierStart=function(l,o,s){return l===HYPHEN_MINUS?isNameStartCodePoint(o)||isValidEscape(o,s):isNameStartCodePoint(l)?!0:!!(l===REVERSE_SOLIDUS&&isValidEscape(l,o))},isNumberStart=function(l,o,s){return l===PLUS_SIGN||l===HYPHEN_MINUS?isDigit(o)?!0:o===FULL_STOP&&isDigit(s):isDigit(l===FULL_STOP?o:l)},stringToNumber=function(l){var o=0,s=1;(l[o]===PLUS_SIGN||l[o]===HYPHEN_MINUS)&&(l[o]===HYPHEN_MINUS&&(s=-1),o++);for(var c=[];isDigit(l[o]);)c.push(l[o++]);var h=c.length?parseInt(fromCodePoint$1.apply(void 0,c),10):0;l[o]===FULL_STOP&&o++;for(var d=[];isDigit(l[o]);)d.push(l[o++]);var p=d.length,Co=p?parseInt(fromCodePoint$1.apply(void 0,d),10):0;(l[o]===E||l[o]===e)&&o++;var Bo=1;(l[o]===PLUS_SIGN||l[o]===HYPHEN_MINUS)&&(l[o]===HYPHEN_MINUS&&(Bo=-1),o++);for(var Lo=[];isDigit(l[o]);)Lo.push(l[o++]);var Uo=Lo.length?parseInt(fromCodePoint$1.apply(void 0,Lo),10):0;return s*(h+Co*Math.pow(10,-p))*Math.pow(10,Bo*Uo)},LEFT_PARENTHESIS_TOKEN={type:2},RIGHT_PARENTHESIS_TOKEN={type:3},COMMA_TOKEN={type:4},SUFFIX_MATCH_TOKEN={type:13},PREFIX_MATCH_TOKEN={type:8},COLUMN_TOKEN={type:21},DASH_MATCH_TOKEN={type:9},INCLUDE_MATCH_TOKEN={type:10},LEFT_CURLY_BRACKET_TOKEN={type:11},RIGHT_CURLY_BRACKET_TOKEN={type:12},SUBSTRING_MATCH_TOKEN={type:14},BAD_URL_TOKEN={type:23},BAD_STRING_TOKEN={type:1},CDO_TOKEN={type:25},CDC_TOKEN={type:24},COLON_TOKEN={type:26},SEMICOLON_TOKEN={type:27},LEFT_SQUARE_BRACKET_TOKEN={type:28},RIGHT_SQUARE_BRACKET_TOKEN={type:29},WHITESPACE_TOKEN={type:31},EOF_TOKEN={type:32},Tokenizer=function(){function l(){this._value=[]}return l.prototype.write=function(o){this._value=this._value.concat(toCodePoints$1(o))},l.prototype.read=function(){for(var o=[],s=this.consumeToken();s!==EOF_TOKEN;)o.push(s),s=this.consumeToken();return o},l.prototype.consumeToken=function(){var o=this.consumeCodePoint();switch(o){case QUOTATION_MARK:return this.consumeStringToken(QUOTATION_MARK);case NUMBER_SIGN:var s=this.peekCodePoint(0),c=this.peekCodePoint(1),h=this.peekCodePoint(2);if(isNameCodePoint(s)||isValidEscape(c,h)){var d=isIdentifierStart(s,c,h)?FLAG_ID:FLAG_UNRESTRICTED,p=this.consumeName();return{type:5,value:p,flags:d}}break;case DOLLAR_SIGN:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUFFIX_MATCH_TOKEN;break;case APOSTROPHE:return this.consumeStringToken(APOSTROPHE);case LEFT_PARENTHESIS:return LEFT_PARENTHESIS_TOKEN;case RIGHT_PARENTHESIS:return RIGHT_PARENTHESIS_TOKEN;case ASTERISK:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUBSTRING_MATCH_TOKEN;break;case PLUS_SIGN:if(isNumberStart(o,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(o),this.consumeNumericToken();break;case COMMA:return COMMA_TOKEN;case HYPHEN_MINUS:var Co=o,Bo=this.peekCodePoint(0),Lo=this.peekCodePoint(1);if(isNumberStart(Co,Bo,Lo))return this.reconsumeCodePoint(o),this.consumeNumericToken();if(isIdentifierStart(Co,Bo,Lo))return this.reconsumeCodePoint(o),this.consumeIdentLikeToken();if(Bo===HYPHEN_MINUS&&Lo===GREATER_THAN_SIGN)return this.consumeCodePoint(),this.consumeCodePoint(),CDC_TOKEN;break;case FULL_STOP:if(isNumberStart(o,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(o),this.consumeNumericToken();break;case SOLIDUS:if(this.peekCodePoint(0)===ASTERISK)for(this.consumeCodePoint();;){var Uo=this.consumeCodePoint();if(Uo===ASTERISK&&(Uo=this.consumeCodePoint(),Uo===SOLIDUS))return this.consumeToken();if(Uo===EOF)return this.consumeToken()}break;case COLON:return COLON_TOKEN;case SEMICOLON:return SEMICOLON_TOKEN;case LESS_THAN_SIGN:if(this.peekCodePoint(0)===EXCLAMATION_MARK&&this.peekCodePoint(1)===HYPHEN_MINUS&&this.peekCodePoint(2)===HYPHEN_MINUS)return this.consumeCodePoint(),this.consumeCodePoint(),CDO_TOKEN;break;case COMMERCIAL_AT:var Qo=this.peekCodePoint(0),Po=this.peekCodePoint(1),Mo=this.peekCodePoint(2);if(isIdentifierStart(Qo,Po,Mo)){var p=this.consumeName();return{type:7,value:p}}break;case LEFT_SQUARE_BRACKET:return LEFT_SQUARE_BRACKET_TOKEN;case REVERSE_SOLIDUS:if(isValidEscape(o,this.peekCodePoint(0)))return this.reconsumeCodePoint(o),this.consumeIdentLikeToken();break;case RIGHT_SQUARE_BRACKET:return RIGHT_SQUARE_BRACKET_TOKEN;case CIRCUMFLEX_ACCENT:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),PREFIX_MATCH_TOKEN;break;case LEFT_CURLY_BRACKET:return LEFT_CURLY_BRACKET_TOKEN;case RIGHT_CURLY_BRACKET:return RIGHT_CURLY_BRACKET_TOKEN;case u:case U:var Go=this.peekCodePoint(0),$o=this.peekCodePoint(1);return Go===PLUS_SIGN&&(isHex($o)||$o===QUESTION_MARK)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(o),this.consumeIdentLikeToken();case VERTICAL_LINE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),DASH_MATCH_TOKEN;if(this.peekCodePoint(0)===VERTICAL_LINE)return this.consumeCodePoint(),COLUMN_TOKEN;break;case TILDE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),INCLUDE_MATCH_TOKEN;break;case EOF:return EOF_TOKEN}return isWhiteSpace(o)?(this.consumeWhiteSpace(),WHITESPACE_TOKEN):isDigit(o)?(this.reconsumeCodePoint(o),this.consumeNumericToken()):isNameStartCodePoint(o)?(this.reconsumeCodePoint(o),this.consumeIdentLikeToken()):{type:6,value:fromCodePoint$1(o)}},l.prototype.consumeCodePoint=function(){var o=this._value.shift();return typeof o>"u"?-1:o},l.prototype.reconsumeCodePoint=function(o){this._value.unshift(o)},l.prototype.peekCodePoint=function(o){return o>=this._value.length?-1:this._value[o]},l.prototype.consumeUnicodeRangeToken=function(){for(var o=[],s=this.consumeCodePoint();isHex(s)&&o.length<6;)o.push(s),s=this.consumeCodePoint();for(var c=!1;s===QUESTION_MARK&&o.length<6;)o.push(s),s=this.consumeCodePoint(),c=!0;if(c){var h=parseInt(fromCodePoint$1.apply(void 0,o.map(function(Bo){return Bo===QUESTION_MARK?ZERO:Bo})),16),d=parseInt(fromCodePoint$1.apply(void 0,o.map(function(Bo){return Bo===QUESTION_MARK?F:Bo})),16);return{type:30,start:h,end:d}}var p=parseInt(fromCodePoint$1.apply(void 0,o),16);if(this.peekCodePoint(0)===HYPHEN_MINUS&&isHex(this.peekCodePoint(1))){this.consumeCodePoint(),s=this.consumeCodePoint();for(var Co=[];isHex(s)&&Co.length<6;)Co.push(s),s=this.consumeCodePoint();var d=parseInt(fromCodePoint$1.apply(void 0,Co),16);return{type:30,start:p,end:d}}else return{type:30,start:p,end:p}},l.prototype.consumeIdentLikeToken=function(){var o=this.consumeName();return o.toLowerCase()==="url"&&this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),{type:19,value:o}):{type:20,value:o}},l.prototype.consumeUrlToken=function(){var o=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF)return{type:22,value:""};var s=this.peekCodePoint(0);if(s===APOSTROPHE||s===QUOTATION_MARK){var c=this.consumeStringToken(this.consumeCodePoint());return c.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS)?(this.consumeCodePoint(),{type:22,value:c.value}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN)}for(;;){var h=this.consumeCodePoint();if(h===EOF||h===RIGHT_PARENTHESIS)return{type:22,value:fromCodePoint$1.apply(void 0,o)};if(isWhiteSpace(h))return this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS?(this.consumeCodePoint(),{type:22,value:fromCodePoint$1.apply(void 0,o)}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN);if(h===QUOTATION_MARK||h===APOSTROPHE||h===LEFT_PARENTHESIS||isNonPrintableCodePoint(h))return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;if(h===REVERSE_SOLIDUS)if(isValidEscape(h,this.peekCodePoint(0)))o.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;else o.push(h)}},l.prototype.consumeWhiteSpace=function(){for(;isWhiteSpace(this.peekCodePoint(0));)this.consumeCodePoint()},l.prototype.consumeBadUrlRemnants=function(){for(;;){var o=this.consumeCodePoint();if(o===RIGHT_PARENTHESIS||o===EOF)return;isValidEscape(o,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},l.prototype.consumeStringSlice=function(o){for(var s=6e4,c="";o>0;){var h=Math.min(s,o);c+=fromCodePoint$1.apply(void 0,this._value.splice(0,h)),o-=h}return this._value.shift(),c},l.prototype.consumeStringToken=function(o){var s="",c=0;do{var h=this._value[c];if(h===EOF||h===void 0||h===o)return s+=this.consumeStringSlice(c),{type:0,value:s};if(h===LINE_FEED)return this._value.splice(0,c),BAD_STRING_TOKEN;if(h===REVERSE_SOLIDUS){var d=this._value[c+1];d!==EOF&&d!==void 0&&(d===LINE_FEED?(s+=this.consumeStringSlice(c),c=-1,this._value.shift()):isValidEscape(h,d)&&(s+=this.consumeStringSlice(c),s+=fromCodePoint$1(this.consumeEscapedCodePoint()),c=-1))}c++}while(!0)},l.prototype.consumeNumber=function(){var o=[],s=FLAG_INTEGER,c=this.peekCodePoint(0);for((c===PLUS_SIGN||c===HYPHEN_MINUS)&&o.push(this.consumeCodePoint());isDigit(this.peekCodePoint(0));)o.push(this.consumeCodePoint());c=this.peekCodePoint(0);var h=this.peekCodePoint(1);if(c===FULL_STOP&&isDigit(h))for(o.push(this.consumeCodePoint(),this.consumeCodePoint()),s=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)o.push(this.consumeCodePoint());c=this.peekCodePoint(0),h=this.peekCodePoint(1);var d=this.peekCodePoint(2);if((c===E||c===e)&&((h===PLUS_SIGN||h===HYPHEN_MINUS)&&isDigit(d)||isDigit(h)))for(o.push(this.consumeCodePoint(),this.consumeCodePoint()),s=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)o.push(this.consumeCodePoint());return[stringToNumber(o),s]},l.prototype.consumeNumericToken=function(){var o=this.consumeNumber(),s=o[0],c=o[1],h=this.peekCodePoint(0),d=this.peekCodePoint(1),p=this.peekCodePoint(2);if(isIdentifierStart(h,d,p)){var Co=this.consumeName();return{type:15,number:s,flags:c,unit:Co}}return h===PERCENTAGE_SIGN?(this.consumeCodePoint(),{type:16,number:s,flags:c}):{type:17,number:s,flags:c}},l.prototype.consumeEscapedCodePoint=function(){var o=this.consumeCodePoint();if(isHex(o)){for(var s=fromCodePoint$1(o);isHex(this.peekCodePoint(0))&&s.length<6;)s+=fromCodePoint$1(this.consumeCodePoint());isWhiteSpace(this.peekCodePoint(0))&&this.consumeCodePoint();var c=parseInt(s,16);return c===0||isSurrogateCodePoint(c)||c>1114111?REPLACEMENT_CHARACTER:c}return o===EOF?REPLACEMENT_CHARACTER:o},l.prototype.consumeName=function(){for(var o="";;){var s=this.consumeCodePoint();if(isNameCodePoint(s))o+=fromCodePoint$1(s);else if(isValidEscape(s,this.peekCodePoint(0)))o+=fromCodePoint$1(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(s),o}},l}(),Parser=function(){function l(o){this._tokens=o}return l.create=function(o){var s=new Tokenizer;return s.write(o),new l(s.read())},l.parseValue=function(o){return l.create(o).parseComponentValue()},l.parseValues=function(o){return l.create(o).parseComponentValues()},l.prototype.parseComponentValue=function(){for(var o=this.consumeToken();o.type===31;)o=this.consumeToken();if(o.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(o);var s=this.consumeComponentValue();do o=this.consumeToken();while(o.type===31);if(o.type===32)return s;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},l.prototype.parseComponentValues=function(){for(var o=[];;){var s=this.consumeComponentValue();if(s.type===32)return o;o.push(s),o.push()}},l.prototype.consumeComponentValue=function(){var o=this.consumeToken();switch(o.type){case 11:case 28:case 2:return this.consumeSimpleBlock(o.type);case 19:return this.consumeFunction(o)}return o},l.prototype.consumeSimpleBlock=function(o){for(var s={type:o,values:[]},c=this.consumeToken();;){if(c.type===32||isEndingTokenFor(c,o))return s;this.reconsumeToken(c),s.values.push(this.consumeComponentValue()),c=this.consumeToken()}},l.prototype.consumeFunction=function(o){for(var s={name:o.value,values:[],type:18};;){var c=this.consumeToken();if(c.type===32||c.type===3)return s;this.reconsumeToken(c),s.values.push(this.consumeComponentValue())}},l.prototype.consumeToken=function(){var o=this._tokens.shift();return typeof o>"u"?EOF_TOKEN:o},l.prototype.reconsumeToken=function(o){this._tokens.unshift(o)},l}(),isDimensionToken=function(l){return l.type===15},isNumberToken=function(l){return l.type===17},isIdentToken=function(l){return l.type===20},isStringToken=function(l){return l.type===0},isIdentWithValue=function(l,o){return isIdentToken(l)&&l.value===o},nonWhiteSpace=function(l){return l.type!==31},nonFunctionArgSeparator=function(l){return l.type!==31&&l.type!==4},parseFunctionArgs=function(l){var o=[],s=[];return l.forEach(function(c){if(c.type===4){if(s.length===0)throw new Error("Error parsing function args, zero tokens for arg");o.push(s),s=[];return}c.type!==31&&s.push(c)}),s.length&&o.push(s),o},isEndingTokenFor=function(l,o){return o===11&&l.type===12||o===28&&l.type===29?!0:o===2&&l.type===3},isLength=function(l){return l.type===17||l.type===15},isLengthPercentage=function(l){return l.type===16||isLength(l)},parseLengthPercentageTuple=function(l){return l.length>1?[l[0],l[1]]:[l[0]]},ZERO_LENGTH={type:17,number:0,flags:FLAG_INTEGER},FIFTY_PERCENT={type:16,number:50,flags:FLAG_INTEGER},HUNDRED_PERCENT={type:16,number:100,flags:FLAG_INTEGER},getAbsoluteValueForTuple=function(l,o,s){var c=l[0],h=l[1];return[getAbsoluteValue(c,o),getAbsoluteValue(typeof h<"u"?h:c,s)]},getAbsoluteValue=function(l,o){if(l.type===16)return l.number/100*o;if(isDimensionToken(l))switch(l.unit){case"rem":case"em":return 16*l.number;case"px":default:return l.number}return l.number},DEG="deg",GRAD="grad",RAD="rad",TURN="turn",angle={name:"angle",parse:function(l,o){if(o.type===15)switch(o.unit){case DEG:return Math.PI*o.number/180;case GRAD:return Math.PI/200*o.number;case RAD:return o.number;case TURN:return Math.PI*2*o.number}throw new Error("Unsupported angle type")}},isAngle=function(l){return l.type===15&&(l.unit===DEG||l.unit===GRAD||l.unit===RAD||l.unit===TURN)},parseNamedSide=function(l){var o=l.filter(isIdentToken).map(function(s){return s.value}).join(" ");switch(o){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ZERO_LENGTH,ZERO_LENGTH];case"to top":case"bottom":return deg(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ZERO_LENGTH,HUNDRED_PERCENT];case"to right":case"left":return deg(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[HUNDRED_PERCENT,HUNDRED_PERCENT];case"to bottom":case"top":return deg(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[HUNDRED_PERCENT,ZERO_LENGTH];case"to left":case"right":return deg(270)}return 0},deg=function(l){return Math.PI*l/180},color$1={name:"color",parse:function(l,o){if(o.type===18){var s=SUPPORTED_COLOR_FUNCTIONS[o.name];if(typeof s>"u")throw new Error('Attempting to parse an unsupported color function "'+o.name+'"');return s(l,o.values)}if(o.type===5){if(o.value.length===3){var c=o.value.substring(0,1),h=o.value.substring(1,2),d=o.value.substring(2,3);return pack(parseInt(c+c,16),parseInt(h+h,16),parseInt(d+d,16),1)}if(o.value.length===4){var c=o.value.substring(0,1),h=o.value.substring(1,2),d=o.value.substring(2,3),p=o.value.substring(3,4);return pack(parseInt(c+c,16),parseInt(h+h,16),parseInt(d+d,16),parseInt(p+p,16)/255)}if(o.value.length===6){var c=o.value.substring(0,2),h=o.value.substring(2,4),d=o.value.substring(4,6);return pack(parseInt(c,16),parseInt(h,16),parseInt(d,16),1)}if(o.value.length===8){var c=o.value.substring(0,2),h=o.value.substring(2,4),d=o.value.substring(4,6),p=o.value.substring(6,8);return pack(parseInt(c,16),parseInt(h,16),parseInt(d,16),parseInt(p,16)/255)}}if(o.type===20){var Co=COLORS[o.value.toUpperCase()];if(typeof Co<"u")return Co}return COLORS.TRANSPARENT}},isTransparent=function(l){return(255&l)===0},asString=function(l){var o=255&l,s=255&l>>8,c=255&l>>16,h=255&l>>24;return o<255?"rgba("+h+","+c+","+s+","+o/255+")":"rgb("+h+","+c+","+s+")"},pack=function(l,o,s,c){return(l<<24|o<<16|s<<8|Math.round(c*255)<<0)>>>0},getTokenColorValue=function(l,o){if(l.type===17)return l.number;if(l.type===16){var s=o===3?1:255;return o===3?l.number/100*s:Math.round(l.number/100*s)}return 0},rgb=function(l,o){var s=o.filter(nonFunctionArgSeparator);if(s.length===3){var c=s.map(getTokenColorValue),h=c[0],d=c[1],p=c[2];return pack(h,d,p,1)}if(s.length===4){var Co=s.map(getTokenColorValue),h=Co[0],d=Co[1],p=Co[2],Bo=Co[3];return pack(h,d,p,Bo)}return 0};function hue2rgb(l,o,s){return s<0&&(s+=1),s>=1&&(s-=1),s<1/6?(o-l)*s*6+l:s<1/2?o:s<2/3?(o-l)*6*(2/3-s)+l:l}var hsl=function(l,o){var s=o.filter(nonFunctionArgSeparator),c=s[0],h=s[1],d=s[2],p=s[3],Co=(c.type===17?deg(c.number):angle.parse(l,c))/(Math.PI*2),Bo=isLengthPercentage(h)?h.number/100:0,Lo=isLengthPercentage(d)?d.number/100:0,Uo=typeof p<"u"&&isLengthPercentage(p)?getAbsoluteValue(p,1):1;if(Bo===0)return pack(Lo*255,Lo*255,Lo*255,1);var Qo=Lo<=.5?Lo*(Bo+1):Lo+Bo-Lo*Bo,Po=Lo*2-Qo,Mo=hue2rgb(Po,Qo,Co+1/3),Go=hue2rgb(Po,Qo,Co),$o=hue2rgb(Po,Qo,Co-1/3);return pack(Mo*255,Go*255,$o*255,Uo)},SUPPORTED_COLOR_FUNCTIONS={hsl,hsla:hsl,rgb,rgba:rgb},parseColor=function(l,o){return color$1.parse(l,Parser.create(o).parseComponentValue())},COLORS={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},BACKGROUND_CLIP;(function(l){l[l.BORDER_BOX=0]="BORDER_BOX",l[l.PADDING_BOX=1]="PADDING_BOX",l[l.CONTENT_BOX=2]="CONTENT_BOX"})(BACKGROUND_CLIP||(BACKGROUND_CLIP={}));var backgroundClip={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(l,o){return o.map(function(s){if(isIdentToken(s))switch(s.value){case"padding-box":return BACKGROUND_CLIP.PADDING_BOX;case"content-box":return BACKGROUND_CLIP.CONTENT_BOX}return BACKGROUND_CLIP.BORDER_BOX})}},backgroundColor={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},parseColorStop=function(l,o){var s=color$1.parse(l,o[0]),c=o[1];return c&&isLengthPercentage(c)?{color:s,stop:c}:{color:s,stop:null}},processColorStops=function(l,o){var s=l[0],c=l[l.length-1];s.stop===null&&(s.stop=ZERO_LENGTH),c.stop===null&&(c.stop=HUNDRED_PERCENT);for(var h=[],d=0,p=0;p<l.length;p++){var Co=l[p].stop;if(Co!==null){var Bo=getAbsoluteValue(Co,o);Bo>d?h.push(Bo):h.push(d),d=Bo}else h.push(null)}for(var Lo=null,p=0;p<h.length;p++){var Uo=h[p];if(Uo===null)Lo===null&&(Lo=p);else if(Lo!==null){for(var Qo=p-Lo,Po=h[Lo-1],Mo=(Uo-Po)/(Qo+1),Go=1;Go<=Qo;Go++)h[Lo+Go-1]=Mo*Go;Lo=null}}return l.map(function($o,jo){var zo=$o.color;return{color:zo,stop:Math.max(Math.min(1,h[jo]/o),0)}})},getAngleFromCorner=function(l,o,s){var c=o/2,h=s/2,d=getAbsoluteValue(l[0],o)-c,p=h-getAbsoluteValue(l[1],s);return(Math.atan2(p,d)+Math.PI*2)%(Math.PI*2)},calculateGradientDirection=function(l,o,s){var c=typeof l=="number"?l:getAngleFromCorner(l,o,s),h=Math.abs(o*Math.sin(c))+Math.abs(s*Math.cos(c)),d=o/2,p=s/2,Co=h/2,Bo=Math.sin(c-Math.PI/2)*Co,Lo=Math.cos(c-Math.PI/2)*Co;return[h,d-Lo,d+Lo,p-Bo,p+Bo]},distance=function(l,o){return Math.sqrt(l*l+o*o)},findCorner=function(l,o,s,c,h){var d=[[0,0],[0,o],[l,0],[l,o]];return d.reduce(function(p,Co){var Bo=Co[0],Lo=Co[1],Uo=distance(s-Bo,c-Lo);return(h?Uo<p.optimumDistance:Uo>p.optimumDistance)?{optimumCorner:Co,optimumDistance:Uo}:p},{optimumDistance:h?1/0:-1/0,optimumCorner:null}).optimumCorner},calculateRadius=function(l,o,s,c,h){var d=0,p=0;switch(l.size){case CSSRadialExtent.CLOSEST_SIDE:l.shape===CSSRadialShape.CIRCLE?d=p=Math.min(Math.abs(o),Math.abs(o-c),Math.abs(s),Math.abs(s-h)):l.shape===CSSRadialShape.ELLIPSE&&(d=Math.min(Math.abs(o),Math.abs(o-c)),p=Math.min(Math.abs(s),Math.abs(s-h)));break;case CSSRadialExtent.CLOSEST_CORNER:if(l.shape===CSSRadialShape.CIRCLE)d=p=Math.min(distance(o,s),distance(o,s-h),distance(o-c,s),distance(o-c,s-h));else if(l.shape===CSSRadialShape.ELLIPSE){var Co=Math.min(Math.abs(s),Math.abs(s-h))/Math.min(Math.abs(o),Math.abs(o-c)),Bo=findCorner(c,h,o,s,!0),Lo=Bo[0],Uo=Bo[1];d=distance(Lo-o,(Uo-s)/Co),p=Co*d}break;case CSSRadialExtent.FARTHEST_SIDE:l.shape===CSSRadialShape.CIRCLE?d=p=Math.max(Math.abs(o),Math.abs(o-c),Math.abs(s),Math.abs(s-h)):l.shape===CSSRadialShape.ELLIPSE&&(d=Math.max(Math.abs(o),Math.abs(o-c)),p=Math.max(Math.abs(s),Math.abs(s-h)));break;case CSSRadialExtent.FARTHEST_CORNER:if(l.shape===CSSRadialShape.CIRCLE)d=p=Math.max(distance(o,s),distance(o,s-h),distance(o-c,s),distance(o-c,s-h));else if(l.shape===CSSRadialShape.ELLIPSE){var Co=Math.max(Math.abs(s),Math.abs(s-h))/Math.max(Math.abs(o),Math.abs(o-c)),Qo=findCorner(c,h,o,s,!1),Lo=Qo[0],Uo=Qo[1];d=distance(Lo-o,(Uo-s)/Co),p=Co*d}break}return Array.isArray(l.size)&&(d=getAbsoluteValue(l.size[0],c),p=l.size.length===2?getAbsoluteValue(l.size[1],h):d),[d,p]},linearGradient=function(l,o){var s=deg(180),c=[];return parseFunctionArgs(o).forEach(function(h,d){if(d===0){var p=h[0];if(p.type===20&&p.value==="to"){s=parseNamedSide(h);return}else if(isAngle(p)){s=angle.parse(l,p);return}}var Co=parseColorStop(l,h);c.push(Co)}),{angle:s,stops:c,type:CSSImageType.LINEAR_GRADIENT}},prefixLinearGradient=function(l,o){var s=deg(180),c=[];return parseFunctionArgs(o).forEach(function(h,d){if(d===0){var p=h[0];if(p.type===20&&["top","left","right","bottom"].indexOf(p.value)!==-1){s=parseNamedSide(h);return}else if(isAngle(p)){s=(angle.parse(l,p)+deg(270))%deg(360);return}}var Co=parseColorStop(l,h);c.push(Co)}),{angle:s,stops:c,type:CSSImageType.LINEAR_GRADIENT}},webkitGradient=function(l,o){var s=deg(180),c=[],h=CSSImageType.LINEAR_GRADIENT,d=CSSRadialShape.CIRCLE,p=CSSRadialExtent.FARTHEST_CORNER,Co=[];return parseFunctionArgs(o).forEach(function(Bo,Lo){var Uo=Bo[0];if(Lo===0){if(isIdentToken(Uo)&&Uo.value==="linear"){h=CSSImageType.LINEAR_GRADIENT;return}else if(isIdentToken(Uo)&&Uo.value==="radial"){h=CSSImageType.RADIAL_GRADIENT;return}}if(Uo.type===18){if(Uo.name==="from"){var Qo=color$1.parse(l,Uo.values[0]);c.push({stop:ZERO_LENGTH,color:Qo})}else if(Uo.name==="to"){var Qo=color$1.parse(l,Uo.values[0]);c.push({stop:HUNDRED_PERCENT,color:Qo})}else if(Uo.name==="color-stop"){var Po=Uo.values.filter(nonFunctionArgSeparator);if(Po.length===2){var Qo=color$1.parse(l,Po[1]),Mo=Po[0];isNumberToken(Mo)&&c.push({stop:{type:16,number:Mo.number*100,flags:Mo.flags},color:Qo})}}}}),h===CSSImageType.LINEAR_GRADIENT?{angle:(s+deg(180))%deg(360),stops:c,type:h}:{size:p,shape:d,stops:c,position:Co,type:h}},CLOSEST_SIDE="closest-side",FARTHEST_SIDE="farthest-side",CLOSEST_CORNER="closest-corner",FARTHEST_CORNER="farthest-corner",CIRCLE="circle",ELLIPSE="ellipse",COVER="cover",CONTAIN="contain",radialGradient=function(l,o){var s=CSSRadialShape.CIRCLE,c=CSSRadialExtent.FARTHEST_CORNER,h=[],d=[];return parseFunctionArgs(o).forEach(function(p,Co){var Bo=!0;if(Co===0){var Lo=!1;Bo=p.reduce(function(Qo,Po){if(Lo)if(isIdentToken(Po))switch(Po.value){case"center":return d.push(FIFTY_PERCENT),Qo;case"top":case"left":return d.push(ZERO_LENGTH),Qo;case"right":case"bottom":return d.push(HUNDRED_PERCENT),Qo}else(isLengthPercentage(Po)||isLength(Po))&&d.push(Po);else if(isIdentToken(Po))switch(Po.value){case CIRCLE:return s=CSSRadialShape.CIRCLE,!1;case ELLIPSE:return s=CSSRadialShape.ELLIPSE,!1;case"at":return Lo=!0,!1;case CLOSEST_SIDE:return c=CSSRadialExtent.CLOSEST_SIDE,!1;case COVER:case FARTHEST_SIDE:return c=CSSRadialExtent.FARTHEST_SIDE,!1;case CONTAIN:case CLOSEST_CORNER:return c=CSSRadialExtent.CLOSEST_CORNER,!1;case FARTHEST_CORNER:return c=CSSRadialExtent.FARTHEST_CORNER,!1}else if(isLength(Po)||isLengthPercentage(Po))return Array.isArray(c)||(c=[]),c.push(Po),!1;return Qo},Bo)}if(Bo){var Uo=parseColorStop(l,p);h.push(Uo)}}),{size:c,shape:s,stops:h,position:d,type:CSSImageType.RADIAL_GRADIENT}},prefixRadialGradient=function(l,o){var s=CSSRadialShape.CIRCLE,c=CSSRadialExtent.FARTHEST_CORNER,h=[],d=[];return parseFunctionArgs(o).forEach(function(p,Co){var Bo=!0;if(Co===0?Bo=p.reduce(function(Uo,Qo){if(isIdentToken(Qo))switch(Qo.value){case"center":return d.push(FIFTY_PERCENT),!1;case"top":case"left":return d.push(ZERO_LENGTH),!1;case"right":case"bottom":return d.push(HUNDRED_PERCENT),!1}else if(isLengthPercentage(Qo)||isLength(Qo))return d.push(Qo),!1;return Uo},Bo):Co===1&&(Bo=p.reduce(function(Uo,Qo){if(isIdentToken(Qo))switch(Qo.value){case CIRCLE:return s=CSSRadialShape.CIRCLE,!1;case ELLIPSE:return s=CSSRadialShape.ELLIPSE,!1;case CONTAIN:case CLOSEST_SIDE:return c=CSSRadialExtent.CLOSEST_SIDE,!1;case FARTHEST_SIDE:return c=CSSRadialExtent.FARTHEST_SIDE,!1;case CLOSEST_CORNER:return c=CSSRadialExtent.CLOSEST_CORNER,!1;case COVER:case FARTHEST_CORNER:return c=CSSRadialExtent.FARTHEST_CORNER,!1}else if(isLength(Qo)||isLengthPercentage(Qo))return Array.isArray(c)||(c=[]),c.push(Qo),!1;return Uo},Bo)),Bo){var Lo=parseColorStop(l,p);h.push(Lo)}}),{size:c,shape:s,stops:h,position:d,type:CSSImageType.RADIAL_GRADIENT}},CSSImageType;(function(l){l[l.URL=0]="URL",l[l.LINEAR_GRADIENT=1]="LINEAR_GRADIENT",l[l.RADIAL_GRADIENT=2]="RADIAL_GRADIENT"})(CSSImageType||(CSSImageType={}));var isLinearGradient=function(l){return l.type===CSSImageType.LINEAR_GRADIENT},isRadialGradient=function(l){return l.type===CSSImageType.RADIAL_GRADIENT},CSSRadialShape;(function(l){l[l.CIRCLE=0]="CIRCLE",l[l.ELLIPSE=1]="ELLIPSE"})(CSSRadialShape||(CSSRadialShape={}));var CSSRadialExtent;(function(l){l[l.CLOSEST_SIDE=0]="CLOSEST_SIDE",l[l.FARTHEST_SIDE=1]="FARTHEST_SIDE",l[l.CLOSEST_CORNER=2]="CLOSEST_CORNER",l[l.FARTHEST_CORNER=3]="FARTHEST_CORNER"})(CSSRadialExtent||(CSSRadialExtent={}));var image={name:"image",parse:function(l,o){if(o.type===22){var s={url:o.value,type:CSSImageType.URL};return l.cache.addImage(o.value),s}if(o.type===18){var c=SUPPORTED_IMAGE_FUNCTIONS[o.name];if(typeof c>"u")throw new Error('Attempting to parse an unsupported image function "'+o.name+'"');return c(l,o.values)}throw new Error("Unsupported image type "+o.type)}};function isSupportedImage(l){return!(l.type===20&&l.value==="none")&&(l.type!==18||!!SUPPORTED_IMAGE_FUNCTIONS[l.name])}var SUPPORTED_IMAGE_FUNCTIONS={"linear-gradient":linearGradient,"-moz-linear-gradient":prefixLinearGradient,"-ms-linear-gradient":prefixLinearGradient,"-o-linear-gradient":prefixLinearGradient,"-webkit-linear-gradient":prefixLinearGradient,"radial-gradient":radialGradient,"-moz-radial-gradient":prefixRadialGradient,"-ms-radial-gradient":prefixRadialGradient,"-o-radial-gradient":prefixRadialGradient,"-webkit-radial-gradient":prefixRadialGradient,"-webkit-gradient":webkitGradient},backgroundImage={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(l,o){if(o.length===0)return[];var s=o[0];return s.type===20&&s.value==="none"?[]:o.filter(function(c){return nonFunctionArgSeparator(c)&&isSupportedImage(c)}).map(function(c){return image.parse(l,c)})}},backgroundOrigin={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(l,o){return o.map(function(s){if(isIdentToken(s))switch(s.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},backgroundPosition={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(l,o){return parseFunctionArgs(o).map(function(s){return s.filter(isLengthPercentage)}).map(parseLengthPercentageTuple)}},BACKGROUND_REPEAT;(function(l){l[l.REPEAT=0]="REPEAT",l[l.NO_REPEAT=1]="NO_REPEAT",l[l.REPEAT_X=2]="REPEAT_X",l[l.REPEAT_Y=3]="REPEAT_Y"})(BACKGROUND_REPEAT||(BACKGROUND_REPEAT={}));var backgroundRepeat={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(l,o){return parseFunctionArgs(o).map(function(s){return s.filter(isIdentToken).map(function(c){return c.value}).join(" ")}).map(parseBackgroundRepeat)}},parseBackgroundRepeat=function(l){switch(l){case"no-repeat":return BACKGROUND_REPEAT.NO_REPEAT;case"repeat-x":case"repeat no-repeat":return BACKGROUND_REPEAT.REPEAT_X;case"repeat-y":case"no-repeat repeat":return BACKGROUND_REPEAT.REPEAT_Y;case"repeat":default:return BACKGROUND_REPEAT.REPEAT}},BACKGROUND_SIZE;(function(l){l.AUTO="auto",l.CONTAIN="contain",l.COVER="cover"})(BACKGROUND_SIZE||(BACKGROUND_SIZE={}));var backgroundSize={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(l,o){return parseFunctionArgs(o).map(function(s){return s.filter(isBackgroundSizeInfoToken)})}},isBackgroundSizeInfoToken=function(l){return isIdentToken(l)||isLengthPercentage(l)},borderColorForSide=function(l){return{name:"border-"+l+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},borderTopColor=borderColorForSide("top"),borderRightColor=borderColorForSide("right"),borderBottomColor=borderColorForSide("bottom"),borderLeftColor=borderColorForSide("left"),borderRadiusForSide=function(l){return{name:"border-radius-"+l,initialValue:"0 0",prefix:!1,type:1,parse:function(o,s){return parseLengthPercentageTuple(s.filter(isLengthPercentage))}}},borderTopLeftRadius=borderRadiusForSide("top-left"),borderTopRightRadius=borderRadiusForSide("top-right"),borderBottomRightRadius=borderRadiusForSide("bottom-right"),borderBottomLeftRadius=borderRadiusForSide("bottom-left"),BORDER_STYLE;(function(l){l[l.NONE=0]="NONE",l[l.SOLID=1]="SOLID",l[l.DASHED=2]="DASHED",l[l.DOTTED=3]="DOTTED",l[l.DOUBLE=4]="DOUBLE"})(BORDER_STYLE||(BORDER_STYLE={}));var borderStyleForSide=function(l){return{name:"border-"+l+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(o,s){switch(s){case"none":return BORDER_STYLE.NONE;case"dashed":return BORDER_STYLE.DASHED;case"dotted":return BORDER_STYLE.DOTTED;case"double":return BORDER_STYLE.DOUBLE}return BORDER_STYLE.SOLID}}},borderTopStyle=borderStyleForSide("top"),borderRightStyle=borderStyleForSide("right"),borderBottomStyle=borderStyleForSide("bottom"),borderLeftStyle=borderStyleForSide("left"),borderWidthForSide=function(l){return{name:"border-"+l+"-width",initialValue:"0",type:0,prefix:!1,parse:function(o,s){return isDimensionToken(s)?s.number:0}}},borderTopWidth=borderWidthForSide("top"),borderRightWidth=borderWidthForSide("right"),borderBottomWidth=borderWidthForSide("bottom"),borderLeftWidth=borderWidthForSide("left"),color={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},direction={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(l,o){switch(o){case"rtl":return 1;case"ltr":default:return 0}}},display={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(l,o){return o.filter(isIdentToken).reduce(function(s,c){return s|parseDisplayValue(c.value)},0)}},parseDisplayValue=function(l){switch(l){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},FLOAT;(function(l){l[l.NONE=0]="NONE",l[l.LEFT=1]="LEFT",l[l.RIGHT=2]="RIGHT",l[l.INLINE_START=3]="INLINE_START",l[l.INLINE_END=4]="INLINE_END"})(FLOAT||(FLOAT={}));var float={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(l,o){switch(o){case"left":return FLOAT.LEFT;case"right":return FLOAT.RIGHT;case"inline-start":return FLOAT.INLINE_START;case"inline-end":return FLOAT.INLINE_END}return FLOAT.NONE}},letterSpacing={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(l,o){return o.type===20&&o.value==="normal"?0:o.type===17||o.type===15?o.number:0}},LINE_BREAK;(function(l){l.NORMAL="normal",l.STRICT="strict"})(LINE_BREAK||(LINE_BREAK={}));var lineBreak={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(l,o){switch(o){case"strict":return LINE_BREAK.STRICT;case"normal":default:return LINE_BREAK.NORMAL}}},lineHeight={name:"line-height",initialValue:"normal",prefix:!1,type:4},computeLineHeight=function(l,o){return isIdentToken(l)&&l.value==="normal"?1.2*o:l.type===17?o*l.number:isLengthPercentage(l)?getAbsoluteValue(l,o):o},listStyleImage={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(l,o){return o.type===20&&o.value==="none"?null:image.parse(l,o)}},LIST_STYLE_POSITION;(function(l){l[l.INSIDE=0]="INSIDE",l[l.OUTSIDE=1]="OUTSIDE"})(LIST_STYLE_POSITION||(LIST_STYLE_POSITION={}));var listStylePosition={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(l,o){switch(o){case"inside":return LIST_STYLE_POSITION.INSIDE;case"outside":default:return LIST_STYLE_POSITION.OUTSIDE}}},LIST_STYLE_TYPE;(function(l){l[l.NONE=-1]="NONE",l[l.DISC=0]="DISC",l[l.CIRCLE=1]="CIRCLE",l[l.SQUARE=2]="SQUARE",l[l.DECIMAL=3]="DECIMAL",l[l.CJK_DECIMAL=4]="CJK_DECIMAL",l[l.DECIMAL_LEADING_ZERO=5]="DECIMAL_LEADING_ZERO",l[l.LOWER_ROMAN=6]="LOWER_ROMAN",l[l.UPPER_ROMAN=7]="UPPER_ROMAN",l[l.LOWER_GREEK=8]="LOWER_GREEK",l[l.LOWER_ALPHA=9]="LOWER_ALPHA",l[l.UPPER_ALPHA=10]="UPPER_ALPHA",l[l.ARABIC_INDIC=11]="ARABIC_INDIC",l[l.ARMENIAN=12]="ARMENIAN",l[l.BENGALI=13]="BENGALI",l[l.CAMBODIAN=14]="CAMBODIAN",l[l.CJK_EARTHLY_BRANCH=15]="CJK_EARTHLY_BRANCH",l[l.CJK_HEAVENLY_STEM=16]="CJK_HEAVENLY_STEM",l[l.CJK_IDEOGRAPHIC=17]="CJK_IDEOGRAPHIC",l[l.DEVANAGARI=18]="DEVANAGARI",l[l.ETHIOPIC_NUMERIC=19]="ETHIOPIC_NUMERIC",l[l.GEORGIAN=20]="GEORGIAN",l[l.GUJARATI=21]="GUJARATI",l[l.GURMUKHI=22]="GURMUKHI",l[l.HEBREW=22]="HEBREW",l[l.HIRAGANA=23]="HIRAGANA",l[l.HIRAGANA_IROHA=24]="HIRAGANA_IROHA",l[l.JAPANESE_FORMAL=25]="JAPANESE_FORMAL",l[l.JAPANESE_INFORMAL=26]="JAPANESE_INFORMAL",l[l.KANNADA=27]="KANNADA",l[l.KATAKANA=28]="KATAKANA",l[l.KATAKANA_IROHA=29]="KATAKANA_IROHA",l[l.KHMER=30]="KHMER",l[l.KOREAN_HANGUL_FORMAL=31]="KOREAN_HANGUL_FORMAL",l[l.KOREAN_HANJA_FORMAL=32]="KOREAN_HANJA_FORMAL",l[l.KOREAN_HANJA_INFORMAL=33]="KOREAN_HANJA_INFORMAL",l[l.LAO=34]="LAO",l[l.LOWER_ARMENIAN=35]="LOWER_ARMENIAN",l[l.MALAYALAM=36]="MALAYALAM",l[l.MONGOLIAN=37]="MONGOLIAN",l[l.MYANMAR=38]="MYANMAR",l[l.ORIYA=39]="ORIYA",l[l.PERSIAN=40]="PERSIAN",l[l.SIMP_CHINESE_FORMAL=41]="SIMP_CHINESE_FORMAL",l[l.SIMP_CHINESE_INFORMAL=42]="SIMP_CHINESE_INFORMAL",l[l.TAMIL=43]="TAMIL",l[l.TELUGU=44]="TELUGU",l[l.THAI=45]="THAI",l[l.TIBETAN=46]="TIBETAN",l[l.TRAD_CHINESE_FORMAL=47]="TRAD_CHINESE_FORMAL",l[l.TRAD_CHINESE_INFORMAL=48]="TRAD_CHINESE_INFORMAL",l[l.UPPER_ARMENIAN=49]="UPPER_ARMENIAN",l[l.DISCLOSURE_OPEN=50]="DISCLOSURE_OPEN",l[l.DISCLOSURE_CLOSED=51]="DISCLOSURE_CLOSED"})(LIST_STYLE_TYPE||(LIST_STYLE_TYPE={}));var listStyleType={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(l,o){switch(o){case"disc":return LIST_STYLE_TYPE.DISC;case"circle":return LIST_STYLE_TYPE.CIRCLE;case"square":return LIST_STYLE_TYPE.SQUARE;case"decimal":return LIST_STYLE_TYPE.DECIMAL;case"cjk-decimal":return LIST_STYLE_TYPE.CJK_DECIMAL;case"decimal-leading-zero":return LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO;case"lower-roman":return LIST_STYLE_TYPE.LOWER_ROMAN;case"upper-roman":return LIST_STYLE_TYPE.UPPER_ROMAN;case"lower-greek":return LIST_STYLE_TYPE.LOWER_GREEK;case"lower-alpha":return LIST_STYLE_TYPE.LOWER_ALPHA;case"upper-alpha":return LIST_STYLE_TYPE.UPPER_ALPHA;case"arabic-indic":return LIST_STYLE_TYPE.ARABIC_INDIC;case"armenian":return LIST_STYLE_TYPE.ARMENIAN;case"bengali":return LIST_STYLE_TYPE.BENGALI;case"cambodian":return LIST_STYLE_TYPE.CAMBODIAN;case"cjk-earthly-branch":return LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH;case"cjk-heavenly-stem":return LIST_STYLE_TYPE.CJK_HEAVENLY_STEM;case"cjk-ideographic":return LIST_STYLE_TYPE.CJK_IDEOGRAPHIC;case"devanagari":return LIST_STYLE_TYPE.DEVANAGARI;case"ethiopic-numeric":return LIST_STYLE_TYPE.ETHIOPIC_NUMERIC;case"georgian":return LIST_STYLE_TYPE.GEORGIAN;case"gujarati":return LIST_STYLE_TYPE.GUJARATI;case"gurmukhi":return LIST_STYLE_TYPE.GURMUKHI;case"hebrew":return LIST_STYLE_TYPE.HEBREW;case"hiragana":return LIST_STYLE_TYPE.HIRAGANA;case"hiragana-iroha":return LIST_STYLE_TYPE.HIRAGANA_IROHA;case"japanese-formal":return LIST_STYLE_TYPE.JAPANESE_FORMAL;case"japanese-informal":return LIST_STYLE_TYPE.JAPANESE_INFORMAL;case"kannada":return LIST_STYLE_TYPE.KANNADA;case"katakana":return LIST_STYLE_TYPE.KATAKANA;case"katakana-iroha":return LIST_STYLE_TYPE.KATAKANA_IROHA;case"khmer":return LIST_STYLE_TYPE.KHMER;case"korean-hangul-formal":return LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL;case"korean-hanja-formal":return LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL;case"korean-hanja-informal":return LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL;case"lao":return LIST_STYLE_TYPE.LAO;case"lower-armenian":return LIST_STYLE_TYPE.LOWER_ARMENIAN;case"malayalam":return LIST_STYLE_TYPE.MALAYALAM;case"mongolian":return LIST_STYLE_TYPE.MONGOLIAN;case"myanmar":return LIST_STYLE_TYPE.MYANMAR;case"oriya":return LIST_STYLE_TYPE.ORIYA;case"persian":return LIST_STYLE_TYPE.PERSIAN;case"simp-chinese-formal":return LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL;case"simp-chinese-informal":return LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL;case"tamil":return LIST_STYLE_TYPE.TAMIL;case"telugu":return LIST_STYLE_TYPE.TELUGU;case"thai":return LIST_STYLE_TYPE.THAI;case"tibetan":return LIST_STYLE_TYPE.TIBETAN;case"trad-chinese-formal":return LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL;case"trad-chinese-informal":return LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL;case"upper-armenian":return LIST_STYLE_TYPE.UPPER_ARMENIAN;case"disclosure-open":return LIST_STYLE_TYPE.DISCLOSURE_OPEN;case"disclosure-closed":return LIST_STYLE_TYPE.DISCLOSURE_CLOSED;case"none":default:return LIST_STYLE_TYPE.NONE}}},marginForSide=function(l){return{name:"margin-"+l,initialValue:"0",prefix:!1,type:4}},marginTop=marginForSide("top"),marginRight=marginForSide("right"),marginBottom=marginForSide("bottom"),marginLeft=marginForSide("left"),OVERFLOW;(function(l){l[l.VISIBLE=0]="VISIBLE",l[l.HIDDEN=1]="HIDDEN",l[l.SCROLL=2]="SCROLL",l[l.CLIP=3]="CLIP",l[l.AUTO=4]="AUTO"})(OVERFLOW||(OVERFLOW={}));var overflow={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(l,o){return o.filter(isIdentToken).map(function(s){switch(s.value){case"hidden":return OVERFLOW.HIDDEN;case"scroll":return OVERFLOW.SCROLL;case"clip":return OVERFLOW.CLIP;case"auto":return OVERFLOW.AUTO;case"visible":default:return OVERFLOW.VISIBLE}})}},overflowWrap={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(l,o){switch(o){case"break-word":return"break-word";case"normal":default:return"normal"}}},paddingForSide=function(l){return{name:"padding-"+l,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},paddingTop=paddingForSide("top"),paddingRight=paddingForSide("right"),paddingBottom=paddingForSide("bottom"),paddingLeft=paddingForSide("left"),TEXT_ALIGN;(function(l){l[l.LEFT=0]="LEFT",l[l.CENTER=1]="CENTER",l[l.RIGHT=2]="RIGHT"})(TEXT_ALIGN||(TEXT_ALIGN={}));var textAlign={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(l,o){switch(o){case"right":return TEXT_ALIGN.RIGHT;case"center":case"justify":return TEXT_ALIGN.CENTER;case"left":default:return TEXT_ALIGN.LEFT}}},POSITION;(function(l){l[l.STATIC=0]="STATIC",l[l.RELATIVE=1]="RELATIVE",l[l.ABSOLUTE=2]="ABSOLUTE",l[l.FIXED=3]="FIXED",l[l.STICKY=4]="STICKY"})(POSITION||(POSITION={}));var position={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(l,o){switch(o){case"relative":return POSITION.RELATIVE;case"absolute":return POSITION.ABSOLUTE;case"fixed":return POSITION.FIXED;case"sticky":return POSITION.STICKY}return POSITION.STATIC}},textShadow={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(l,o){return o.length===1&&isIdentWithValue(o[0],"none")?[]:parseFunctionArgs(o).map(function(s){for(var c={color:COLORS.TRANSPARENT,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH},h=0,d=0;d<s.length;d++){var p=s[d];isLength(p)?(h===0?c.offsetX=p:h===1?c.offsetY=p:c.blur=p,h++):c.color=color$1.parse(l,p)}return c})}},TEXT_TRANSFORM;(function(l){l[l.NONE=0]="NONE",l[l.LOWERCASE=1]="LOWERCASE",l[l.UPPERCASE=2]="UPPERCASE",l[l.CAPITALIZE=3]="CAPITALIZE"})(TEXT_TRANSFORM||(TEXT_TRANSFORM={}));var textTransform={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(l,o){switch(o){case"uppercase":return TEXT_TRANSFORM.UPPERCASE;case"lowercase":return TEXT_TRANSFORM.LOWERCASE;case"capitalize":return TEXT_TRANSFORM.CAPITALIZE}return TEXT_TRANSFORM.NONE}},transform$1={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(l,o){if(o.type===20&&o.value==="none")return null;if(o.type===18){var s=SUPPORTED_TRANSFORM_FUNCTIONS[o.name];if(typeof s>"u")throw new Error('Attempting to parse an unsupported transform function "'+o.name+'"');return s(o.values)}return null}},matrix=function(l){var o=l.filter(function(s){return s.type===17}).map(function(s){return s.number});return o.length===6?o:null},matrix3d=function(l){var o=l.filter(function(Bo){return Bo.type===17}).map(function(Bo){return Bo.number}),s=o[0],c=o[1];o[2],o[3];var h=o[4],d=o[5];o[6],o[7],o[8],o[9],o[10],o[11];var p=o[12],Co=o[13];return o[14],o[15],o.length===16?[s,c,h,d,p,Co]:null},SUPPORTED_TRANSFORM_FUNCTIONS={matrix,matrix3d},DEFAULT_VALUE={type:16,number:50,flags:FLAG_INTEGER},DEFAULT=[DEFAULT_VALUE,DEFAULT_VALUE],transformOrigin={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(l,o){var s=o.filter(isLengthPercentage);return s.length!==2?DEFAULT:[s[0],s[1]]}},VISIBILITY;(function(l){l[l.VISIBLE=0]="VISIBLE",l[l.HIDDEN=1]="HIDDEN",l[l.COLLAPSE=2]="COLLAPSE"})(VISIBILITY||(VISIBILITY={}));var visibility={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(l,o){switch(o){case"hidden":return VISIBILITY.HIDDEN;case"collapse":return VISIBILITY.COLLAPSE;case"visible":default:return VISIBILITY.VISIBLE}}},WORD_BREAK;(function(l){l.NORMAL="normal",l.BREAK_ALL="break-all",l.KEEP_ALL="keep-all"})(WORD_BREAK||(WORD_BREAK={}));var wordBreak={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(l,o){switch(o){case"break-all":return WORD_BREAK.BREAK_ALL;case"keep-all":return WORD_BREAK.KEEP_ALL;case"normal":default:return WORD_BREAK.NORMAL}}},zIndex={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(l,o){if(o.type===20)return{auto:!0,order:0};if(isNumberToken(o))return{auto:!1,order:o.number};throw new Error("Invalid z-index number parsed")}},time={name:"time",parse:function(l,o){if(o.type===15)switch(o.unit.toLowerCase()){case"s":return 1e3*o.number;case"ms":return o.number}throw new Error("Unsupported time type")}},opacity={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(l,o){return isNumberToken(o)?o.number:1}},textDecorationColor={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},textDecorationLine={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(l,o){return o.filter(isIdentToken).map(function(s){switch(s.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(s){return s!==0})}},fontFamily={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(l,o){var s=[],c=[];return o.forEach(function(h){switch(h.type){case 20:case 0:s.push(h.value);break;case 17:s.push(h.number.toString());break;case 4:c.push(s.join(" ")),s.length=0;break}}),s.length&&c.push(s.join(" ")),c.map(function(h){return h.indexOf(" ")===-1?h:"'"+h+"'"})}},fontSize={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},fontWeight={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(l,o){if(isNumberToken(o))return o.number;if(isIdentToken(o))switch(o.value){case"bold":return 700;case"normal":default:return 400}return 400}},fontVariant={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(l,o){return o.filter(isIdentToken).map(function(s){return s.value})}},FONT_STYLE;(function(l){l.NORMAL="normal",l.ITALIC="italic",l.OBLIQUE="oblique"})(FONT_STYLE||(FONT_STYLE={}));var fontStyle={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(l,o){switch(o){case"oblique":return FONT_STYLE.OBLIQUE;case"italic":return FONT_STYLE.ITALIC;case"normal":default:return FONT_STYLE.NORMAL}}},contains=function(l,o){return(l&o)!==0},content={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(l,o){if(o.length===0)return[];var s=o[0];return s.type===20&&s.value==="none"?[]:o}},counterIncrement={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(l,o){if(o.length===0)return null;var s=o[0];if(s.type===20&&s.value==="none")return null;for(var c=[],h=o.filter(nonWhiteSpace),d=0;d<h.length;d++){var p=h[d],Co=h[d+1];if(p.type===20){var Bo=Co&&isNumberToken(Co)?Co.number:1;c.push({counter:p.value,increment:Bo})}}return c}},counterReset={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(l,o){if(o.length===0)return[];for(var s=[],c=o.filter(nonWhiteSpace),h=0;h<c.length;h++){var d=c[h],p=c[h+1];if(isIdentToken(d)&&d.value!=="none"){var Co=p&&isNumberToken(p)?p.number:0;s.push({counter:d.value,reset:Co})}}return s}},duration={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(l,o){return o.filter(isDimensionToken).map(function(s){return time.parse(l,s)})}},quotes={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(l,o){if(o.length===0)return null;var s=o[0];if(s.type===20&&s.value==="none")return null;var c=[],h=o.filter(isStringToken);if(h.length%2!==0)return null;for(var d=0;d<h.length;d+=2){var p=h[d].value,Co=h[d+1].value;c.push({open:p,close:Co})}return c}},getQuote=function(l,o,s){if(!l)return"";var c=l[Math.min(o,l.length-1)];return c?s?c.open:c.close:""},boxShadow={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(l,o){return o.length===1&&isIdentWithValue(o[0],"none")?[]:parseFunctionArgs(o).map(function(s){for(var c={color:255,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH,spread:ZERO_LENGTH,inset:!1},h=0,d=0;d<s.length;d++){var p=s[d];isIdentWithValue(p,"inset")?c.inset=!0:isLength(p)?(h===0?c.offsetX=p:h===1?c.offsetY=p:h===2?c.blur=p:c.spread=p,h++):c.color=color$1.parse(l,p)}return c})}},PAINT_ORDER_LAYER;(function(l){l[l.FILL=0]="FILL",l[l.STROKE=1]="STROKE",l[l.MARKERS=2]="MARKERS"})(PAINT_ORDER_LAYER||(PAINT_ORDER_LAYER={}));var paintOrder={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(l,o){var s=[PAINT_ORDER_LAYER.FILL,PAINT_ORDER_LAYER.STROKE,PAINT_ORDER_LAYER.MARKERS],c=[];return o.filter(isIdentToken).forEach(function(h){switch(h.value){case"stroke":c.push(PAINT_ORDER_LAYER.STROKE);break;case"fill":c.push(PAINT_ORDER_LAYER.FILL);break;case"markers":c.push(PAINT_ORDER_LAYER.MARKERS);break}}),s.forEach(function(h){c.indexOf(h)===-1&&c.push(h)}),c}},webkitTextStrokeColor={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},webkitTextStrokeWidth={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(l,o){return isDimensionToken(o)?o.number:0}},CSSParsedDeclaration=function(){function l(o,s){var c,h;this.animationDuration=parse(o,duration,s.animationDuration),this.backgroundClip=parse(o,backgroundClip,s.backgroundClip),this.backgroundColor=parse(o,backgroundColor,s.backgroundColor),this.backgroundImage=parse(o,backgroundImage,s.backgroundImage),this.backgroundOrigin=parse(o,backgroundOrigin,s.backgroundOrigin),this.backgroundPosition=parse(o,backgroundPosition,s.backgroundPosition),this.backgroundRepeat=parse(o,backgroundRepeat,s.backgroundRepeat),this.backgroundSize=parse(o,backgroundSize,s.backgroundSize),this.borderTopColor=parse(o,borderTopColor,s.borderTopColor),this.borderRightColor=parse(o,borderRightColor,s.borderRightColor),this.borderBottomColor=parse(o,borderBottomColor,s.borderBottomColor),this.borderLeftColor=parse(o,borderLeftColor,s.borderLeftColor),this.borderTopLeftRadius=parse(o,borderTopLeftRadius,s.borderTopLeftRadius),this.borderTopRightRadius=parse(o,borderTopRightRadius,s.borderTopRightRadius),this.borderBottomRightRadius=parse(o,borderBottomRightRadius,s.borderBottomRightRadius),this.borderBottomLeftRadius=parse(o,borderBottomLeftRadius,s.borderBottomLeftRadius),this.borderTopStyle=parse(o,borderTopStyle,s.borderTopStyle),this.borderRightStyle=parse(o,borderRightStyle,s.borderRightStyle),this.borderBottomStyle=parse(o,borderBottomStyle,s.borderBottomStyle),this.borderLeftStyle=parse(o,borderLeftStyle,s.borderLeftStyle),this.borderTopWidth=parse(o,borderTopWidth,s.borderTopWidth),this.borderRightWidth=parse(o,borderRightWidth,s.borderRightWidth),this.borderBottomWidth=parse(o,borderBottomWidth,s.borderBottomWidth),this.borderLeftWidth=parse(o,borderLeftWidth,s.borderLeftWidth),this.boxShadow=parse(o,boxShadow,s.boxShadow),this.color=parse(o,color,s.color),this.direction=parse(o,direction,s.direction),this.display=parse(o,display,s.display),this.float=parse(o,float,s.cssFloat),this.fontFamily=parse(o,fontFamily,s.fontFamily),this.fontSize=parse(o,fontSize,s.fontSize),this.fontStyle=parse(o,fontStyle,s.fontStyle),this.fontVariant=parse(o,fontVariant,s.fontVariant),this.fontWeight=parse(o,fontWeight,s.fontWeight),this.letterSpacing=parse(o,letterSpacing,s.letterSpacing),this.lineBreak=parse(o,lineBreak,s.lineBreak),this.lineHeight=parse(o,lineHeight,s.lineHeight),this.listStyleImage=parse(o,listStyleImage,s.listStyleImage),this.listStylePosition=parse(o,listStylePosition,s.listStylePosition),this.listStyleType=parse(o,listStyleType,s.listStyleType),this.marginTop=parse(o,marginTop,s.marginTop),this.marginRight=parse(o,marginRight,s.marginRight),this.marginBottom=parse(o,marginBottom,s.marginBottom),this.marginLeft=parse(o,marginLeft,s.marginLeft),this.opacity=parse(o,opacity,s.opacity);var d=parse(o,overflow,s.overflow);this.overflowX=d[0],this.overflowY=d[d.length>1?1:0],this.overflowWrap=parse(o,overflowWrap,s.overflowWrap),this.paddingTop=parse(o,paddingTop,s.paddingTop),this.paddingRight=parse(o,paddingRight,s.paddingRight),this.paddingBottom=parse(o,paddingBottom,s.paddingBottom),this.paddingLeft=parse(o,paddingLeft,s.paddingLeft),this.paintOrder=parse(o,paintOrder,s.paintOrder),this.position=parse(o,position,s.position),this.textAlign=parse(o,textAlign,s.textAlign),this.textDecorationColor=parse(o,textDecorationColor,(c=s.textDecorationColor)!==null&&c!==void 0?c:s.color),this.textDecorationLine=parse(o,textDecorationLine,(h=s.textDecorationLine)!==null&&h!==void 0?h:s.textDecoration),this.textShadow=parse(o,textShadow,s.textShadow),this.textTransform=parse(o,textTransform,s.textTransform),this.transform=parse(o,transform$1,s.transform),this.transformOrigin=parse(o,transformOrigin,s.transformOrigin),this.visibility=parse(o,visibility,s.visibility),this.webkitTextStrokeColor=parse(o,webkitTextStrokeColor,s.webkitTextStrokeColor),this.webkitTextStrokeWidth=parse(o,webkitTextStrokeWidth,s.webkitTextStrokeWidth),this.wordBreak=parse(o,wordBreak,s.wordBreak),this.zIndex=parse(o,zIndex,s.zIndex)}return l.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===VISIBILITY.VISIBLE},l.prototype.isTransparent=function(){return isTransparent(this.backgroundColor)},l.prototype.isTransformed=function(){return this.transform!==null},l.prototype.isPositioned=function(){return this.position!==POSITION.STATIC},l.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},l.prototype.isFloating=function(){return this.float!==FLOAT.NONE},l.prototype.isInlineLevel=function(){return contains(this.display,4)||contains(this.display,33554432)||contains(this.display,268435456)||contains(this.display,536870912)||contains(this.display,67108864)||contains(this.display,134217728)},l}(),CSSParsedPseudoDeclaration=function(){function l(o,s){this.content=parse(o,content,s.content),this.quotes=parse(o,quotes,s.quotes)}return l}(),CSSParsedCounterDeclaration=function(){function l(o,s){this.counterIncrement=parse(o,counterIncrement,s.counterIncrement),this.counterReset=parse(o,counterReset,s.counterReset)}return l}(),parse=function(l,o,s){var c=new Tokenizer,h=s!==null&&typeof s<"u"?s.toString():o.initialValue;c.write(h);var d=new Parser(c.read());switch(o.type){case 2:var p=d.parseComponentValue();return o.parse(l,isIdentToken(p)?p.value:o.initialValue);case 0:return o.parse(l,d.parseComponentValue());case 1:return o.parse(l,d.parseComponentValues());case 4:return d.parseComponentValue();case 3:switch(o.format){case"angle":return angle.parse(l,d.parseComponentValue());case"color":return color$1.parse(l,d.parseComponentValue());case"image":return image.parse(l,d.parseComponentValue());case"length":var Co=d.parseComponentValue();return isLength(Co)?Co:ZERO_LENGTH;case"length-percentage":var Bo=d.parseComponentValue();return isLengthPercentage(Bo)?Bo:ZERO_LENGTH;case"time":return time.parse(l,d.parseComponentValue())}break}},elementDebuggerAttribute="data-html2canvas-debug",getElementDebugType=function(l){var o=l.getAttribute(elementDebuggerAttribute);switch(o){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},isDebugging=function(l,o){var s=getElementDebugType(l);return s===1||o===s},ElementContainer=function(){function l(o,s){if(this.context=o,this.textNodes=[],this.elements=[],this.flags=0,isDebugging(s,3))debugger;this.styles=new CSSParsedDeclaration(o,window.getComputedStyle(s,null)),isHTMLElementNode(s)&&(this.styles.animationDuration.some(function(c){return c>0})&&(s.style.animationDuration="0s"),this.styles.transform!==null&&(s.style.transform="none")),this.bounds=parseBounds(this.context,s),isDebugging(s,4)&&(this.flags|=16)}return l}(),base64="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",chars$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i$1=0;i$1<chars$1.length;i$1++)lookup$1[chars$1.charCodeAt(i$1)]=i$1;var decode=function(l){var o=l.length*.75,s=l.length,c,h=0,d,p,Co,Bo;l[l.length-1]==="="&&(o--,l[l.length-2]==="="&&o--);var Lo=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(o):new Array(o),Uo=Array.isArray(Lo)?Lo:new Uint8Array(Lo);for(c=0;c<s;c+=4)d=lookup$1[l.charCodeAt(c)],p=lookup$1[l.charCodeAt(c+1)],Co=lookup$1[l.charCodeAt(c+2)],Bo=lookup$1[l.charCodeAt(c+3)],Uo[h++]=d<<2|p>>4,Uo[h++]=(p&15)<<4|Co>>2,Uo[h++]=(Co&3)<<6|Bo&63;return Lo},polyUint16Array=function(l){for(var o=l.length,s=[],c=0;c<o;c+=2)s.push(l[c+1]<<8|l[c]);return s},polyUint32Array=function(l){for(var o=l.length,s=[],c=0;c<o;c+=4)s.push(l[c+3]<<24|l[c+2]<<16|l[c+1]<<8|l[c]);return s},UTRIE2_SHIFT_2=5,UTRIE2_SHIFT_1=6+5,UTRIE2_INDEX_SHIFT=2,UTRIE2_SHIFT_1_2=UTRIE2_SHIFT_1-UTRIE2_SHIFT_2,UTRIE2_LSCP_INDEX_2_OFFSET=65536>>UTRIE2_SHIFT_2,UTRIE2_DATA_BLOCK_LENGTH=1<<UTRIE2_SHIFT_2,UTRIE2_DATA_MASK=UTRIE2_DATA_BLOCK_LENGTH-1,UTRIE2_LSCP_INDEX_2_LENGTH=1024>>UTRIE2_SHIFT_2,UTRIE2_INDEX_2_BMP_LENGTH=UTRIE2_LSCP_INDEX_2_OFFSET+UTRIE2_LSCP_INDEX_2_LENGTH,UTRIE2_UTF8_2B_INDEX_2_OFFSET=UTRIE2_INDEX_2_BMP_LENGTH,UTRIE2_UTF8_2B_INDEX_2_LENGTH=32,UTRIE2_INDEX_1_OFFSET=UTRIE2_UTF8_2B_INDEX_2_OFFSET+UTRIE2_UTF8_2B_INDEX_2_LENGTH,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=65536>>UTRIE2_SHIFT_1,UTRIE2_INDEX_2_BLOCK_LENGTH=1<<UTRIE2_SHIFT_1_2,UTRIE2_INDEX_2_MASK=UTRIE2_INDEX_2_BLOCK_LENGTH-1,slice16=function(l,o,s){return l.slice?l.slice(o,s):new Uint16Array(Array.prototype.slice.call(l,o,s))},slice32=function(l,o,s){return l.slice?l.slice(o,s):new Uint32Array(Array.prototype.slice.call(l,o,s))},createTrieFromBase64=function(l,o){var s=decode(l),c=Array.isArray(s)?polyUint32Array(s):new Uint32Array(s),h=Array.isArray(s)?polyUint16Array(s):new Uint16Array(s),d=24,p=slice16(h,d/2,c[4]/2),Co=c[5]===2?slice16(h,(d+c[4])/2):slice32(c,Math.ceil((d+c[4])/4));return new Trie(c[0],c[1],c[2],c[3],p,Co)},Trie=function(){function l(o,s,c,h,d,p){this.initialValue=o,this.errorValue=s,this.highStart=c,this.highValueIndex=h,this.index=d,this.data=p}return l.prototype.get=function(o){var s;if(o>=0){if(o<55296||o>56319&&o<=65535)return s=this.index[o>>UTRIE2_SHIFT_2],s=(s<<UTRIE2_INDEX_SHIFT)+(o&UTRIE2_DATA_MASK),this.data[s];if(o<=65535)return s=this.index[UTRIE2_LSCP_INDEX_2_OFFSET+(o-55296>>UTRIE2_SHIFT_2)],s=(s<<UTRIE2_INDEX_SHIFT)+(o&UTRIE2_DATA_MASK),this.data[s];if(o<this.highStart)return s=UTRIE2_INDEX_1_OFFSET-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH+(o>>UTRIE2_SHIFT_1),s=this.index[s],s+=o>>UTRIE2_SHIFT_2&UTRIE2_INDEX_2_MASK,s=this.index[s],s=(s<<UTRIE2_INDEX_SHIFT)+(o&UTRIE2_DATA_MASK),this.data[s];if(o<=1114111)return this.data[this.highValueIndex]}return this.errorValue},l}(),chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var Prepend=1,CR=2,LF=3,Control=4,Extend=5,SpacingMark=7,L=8,V=9,T=10,LV=11,LVT=12,ZWJ=13,Extended_Pictographic=14,RI=15,toCodePoints=function(l){for(var o=[],s=0,c=l.length;s<c;){var h=l.charCodeAt(s++);if(h>=55296&&h<=56319&&s<c){var d=l.charCodeAt(s++);(d&64512)===56320?o.push(((h&1023)<<10)+(d&1023)+65536):(o.push(h),s--)}else o.push(h)}return o},fromCodePoint=function(){for(var l=[],o=0;o<arguments.length;o++)l[o]=arguments[o];if(String.fromCodePoint)return String.fromCodePoint.apply(String,l);var s=l.length;if(!s)return"";for(var c=[],h=-1,d="";++h<s;){var p=l[h];p<=65535?c.push(p):(p-=65536,c.push((p>>10)+55296,p%1024+56320)),(h+1===s||c.length>16384)&&(d+=String.fromCharCode.apply(String,c),c.length=0)}return d},UnicodeTrie=createTrieFromBase64(base64),BREAK_NOT_ALLOWED="\xD7",BREAK_ALLOWED="\xF7",codePointToClass=function(l){return UnicodeTrie.get(l)},_graphemeBreakAtIndex=function(l,o,s){var c=s-2,h=o[c],d=o[s-1],p=o[s];if(d===CR&&p===LF)return BREAK_NOT_ALLOWED;if(d===CR||d===LF||d===Control||p===CR||p===LF||p===Control)return BREAK_ALLOWED;if(d===L&&[L,V,LV,LVT].indexOf(p)!==-1||(d===LV||d===V)&&(p===V||p===T)||(d===LVT||d===T)&&p===T||p===ZWJ||p===Extend||p===SpacingMark||d===Prepend)return BREAK_NOT_ALLOWED;if(d===ZWJ&&p===Extended_Pictographic){for(;h===Extend;)h=o[--c];if(h===Extended_Pictographic)return BREAK_NOT_ALLOWED}if(d===RI&&p===RI){for(var Co=0;h===RI;)Co++,h=o[--c];if(Co%2===0)return BREAK_NOT_ALLOWED}return BREAK_ALLOWED},GraphemeBreaker=function(l){var o=toCodePoints(l),s=o.length,c=0,h=0,d=o.map(codePointToClass);return{next:function(){if(c>=s)return{done:!0,value:null};for(var p=BREAK_NOT_ALLOWED;c<s&&(p=_graphemeBreakAtIndex(o,d,++c))===BREAK_NOT_ALLOWED;);if(p!==BREAK_NOT_ALLOWED||c===s){var Co=fromCodePoint.apply(null,o.slice(h,c));return h=c,{value:Co,done:!1}}return{done:!0,value:null}}}},splitGraphemes=function(l){for(var o=GraphemeBreaker(l),s=[],c;!(c=o.next()).done;)c.value&&s.push(c.value.slice());return s},testRangeBounds=function(l){var o=123;if(l.createRange){var s=l.createRange();if(s.getBoundingClientRect){var c=l.createElement("boundtest");c.style.height=o+"px",c.style.display="block",l.body.appendChild(c),s.selectNode(c);var h=s.getBoundingClientRect(),d=Math.round(h.height);if(l.body.removeChild(c),d===o)return!0}}return!1},testIOSLineBreak=function(l){var o=l.createElement("boundtest");o.style.width="50px",o.style.display="block",o.style.fontSize="12px",o.style.letterSpacing="0px",o.style.wordSpacing="0px",l.body.appendChild(o);var s=l.createRange();o.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var c=o.firstChild,h=toCodePoints$1(c.data).map(function(Bo){return fromCodePoint$1(Bo)}),d=0,p={},Co=h.every(function(Bo,Lo){s.setStart(c,d),s.setEnd(c,d+Bo.length);var Uo=s.getBoundingClientRect();d+=Bo.length;var Qo=Uo.x>p.x||Uo.y>p.y;return p=Uo,Lo===0?!0:Qo});return l.body.removeChild(o),Co},testCORS=function(){return typeof new Image().crossOrigin<"u"},testResponseType=function(){return typeof new XMLHttpRequest().responseType=="string"},testSVG=function(l){var o=new Image,s=l.createElement("canvas"),c=s.getContext("2d");if(!c)return!1;o.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{c.drawImage(o,0,0),s.toDataURL()}catch{return!1}return!0},isGreenPixel=function(l){return l[0]===0&&l[1]===255&&l[2]===0&&l[3]===255},testForeignObject=function(l){var o=l.createElement("canvas"),s=100;o.width=s,o.height=s;var c=o.getContext("2d");if(!c)return Promise.reject(!1);c.fillStyle="rgb(0, 255, 0)",c.fillRect(0,0,s,s);var h=new Image,d=o.toDataURL();h.src=d;var p=createForeignObjectSVG(s,s,0,0,h);return c.fillStyle="red",c.fillRect(0,0,s,s),loadSerializedSVG$1(p).then(function(Co){c.drawImage(Co,0,0);var Bo=c.getImageData(0,0,s,s).data;c.fillStyle="red",c.fillRect(0,0,s,s);var Lo=l.createElement("div");return Lo.style.backgroundImage="url("+d+")",Lo.style.height=s+"px",isGreenPixel(Bo)?loadSerializedSVG$1(createForeignObjectSVG(s,s,0,0,Lo)):Promise.reject(!1)}).then(function(Co){return c.drawImage(Co,0,0),isGreenPixel(c.getImageData(0,0,s,s).data)}).catch(function(){return!1})},createForeignObjectSVG=function(l,o,s,c,h){var d="http://www.w3.org/2000/svg",p=document.createElementNS(d,"svg"),Co=document.createElementNS(d,"foreignObject");return p.setAttributeNS(null,"width",l.toString()),p.setAttributeNS(null,"height",o.toString()),Co.setAttributeNS(null,"width","100%"),Co.setAttributeNS(null,"height","100%"),Co.setAttributeNS(null,"x",s.toString()),Co.setAttributeNS(null,"y",c.toString()),Co.setAttributeNS(null,"externalResourcesRequired","true"),p.appendChild(Co),Co.appendChild(h),p},loadSerializedSVG$1=function(l){return new Promise(function(o,s){var c=new Image;c.onload=function(){return o(c)},c.onerror=s,c.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(l))})},FEATURES={get SUPPORT_RANGE_BOUNDS(){var l=testRangeBounds(document);return Object.defineProperty(FEATURES,"SUPPORT_RANGE_BOUNDS",{value:l}),l},get SUPPORT_WORD_BREAKING(){var l=FEATURES.SUPPORT_RANGE_BOUNDS&&testIOSLineBreak(document);return Object.defineProperty(FEATURES,"SUPPORT_WORD_BREAKING",{value:l}),l},get SUPPORT_SVG_DRAWING(){var l=testSVG(document);return Object.defineProperty(FEATURES,"SUPPORT_SVG_DRAWING",{value:l}),l},get SUPPORT_FOREIGNOBJECT_DRAWING(){var l=typeof Array.from=="function"&&typeof window.fetch=="function"?testForeignObject(document):Promise.resolve(!1);return Object.defineProperty(FEATURES,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:l}),l},get SUPPORT_CORS_IMAGES(){var l=testCORS();return Object.defineProperty(FEATURES,"SUPPORT_CORS_IMAGES",{value:l}),l},get SUPPORT_RESPONSE_TYPE(){var l=testResponseType();return Object.defineProperty(FEATURES,"SUPPORT_RESPONSE_TYPE",{value:l}),l},get SUPPORT_CORS_XHR(){var l="withCredentials"in new XMLHttpRequest;return Object.defineProperty(FEATURES,"SUPPORT_CORS_XHR",{value:l}),l}},TextBounds=function(){function l(o,s){this.text=o,this.bounds=s}return l}(),parseTextBounds=function(l,o,s,c){var h=breakText(o,s),d=[],p=0;return h.forEach(function(Co){if(s.textDecorationLine.length||Co.trim().length>0)if(FEATURES.SUPPORT_RANGE_BOUNDS)FEATURES.SUPPORT_WORD_BREAKING?d.push(new TextBounds(Co,getRangeBounds(l,c,p,Co.length))):d.push(new TextBounds(Co,Bounds.fromDOMRectList(l,createRange(c,p,Co.length).getClientRects())));else{var Bo=c.splitText(Co.length);d.push(new TextBounds(Co,getWrapperBounds(l,c))),c=Bo}else FEATURES.SUPPORT_RANGE_BOUNDS||(c=c.splitText(Co.length));p+=Co.length}),d},getWrapperBounds=function(l,o){var s=o.ownerDocument;if(s){var c=s.createElement("html2canvaswrapper");c.appendChild(o.cloneNode(!0));var h=o.parentNode;if(h){h.replaceChild(c,o);var d=parseBounds(l,c);return c.firstChild&&h.replaceChild(c.firstChild,c),d}}return Bounds.EMPTY},createRange=function(l,o,s){var c=l.ownerDocument;if(!c)throw new Error("Node has no owner document");var h=c.createRange();return h.setStart(l,o),h.setEnd(l,o+s),h},getRangeBounds=function(l,o,s,c){return Bounds.fromClientRect(l,createRange(o,s,c).getBoundingClientRect())},breakText=function(l,o){return o.letterSpacing!==0?splitGraphemes(l):breakWords(l,o)},wordSeparators=[32,160,4961,65792,65793,4153,4241],breakWords=function(l,o){for(var s=LineBreaker(l,{lineBreak:o.lineBreak,wordBreak:o.overflowWrap==="break-word"?"break-word":o.wordBreak}),c=[],h,d=function(){if(h.value){var p=h.value.slice(),Co=toCodePoints$1(p),Bo="";Co.forEach(function(Lo){wordSeparators.indexOf(Lo)===-1?Bo+=fromCodePoint$1(Lo):(Bo.length&&c.push(Bo),c.push(fromCodePoint$1(Lo)),Bo="")}),Bo.length&&c.push(Bo)}};!(h=s.next()).done;)d();return c},TextContainer=function(){function l(o,s,c){this.text=transform(s.data,c.textTransform),this.textBounds=parseTextBounds(o,this.text,c,s)}return l}(),transform=function(l,o){switch(o){case TEXT_TRANSFORM.LOWERCASE:return l.toLowerCase();case TEXT_TRANSFORM.CAPITALIZE:return l.replace(CAPITALIZE,capitalize);case TEXT_TRANSFORM.UPPERCASE:return l.toUpperCase();default:return l}},CAPITALIZE=/(^|\s|:|-|\(|\))([a-z])/g,capitalize=function(l,o,s){return l.length>0?o+s.toUpperCase():l},ImageElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;return h.src=c.currentSrc||c.src,h.intrinsicWidth=c.naturalWidth,h.intrinsicHeight=c.naturalHeight,h.context.cache.addImage(h.src),h}return o}(ElementContainer),CanvasElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;return h.canvas=c,h.intrinsicWidth=c.width,h.intrinsicHeight=c.height,h}return o}(ElementContainer),SVGElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this,d=new XMLSerializer,p=parseBounds(s,c);return c.setAttribute("width",p.width+"px"),c.setAttribute("height",p.height+"px"),h.svg="data:image/svg+xml,"+encodeURIComponent(d.serializeToString(c)),h.intrinsicWidth=c.width.baseVal.value,h.intrinsicHeight=c.height.baseVal.value,h.context.cache.addImage(h.svg),h}return o}(ElementContainer),LIElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;return h.value=c.value,h}return o}(ElementContainer),OLElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;return h.start=c.start,h.reversed=typeof c.reversed=="boolean"&&c.reversed===!0,h}return o}(ElementContainer),CHECKBOX_BORDER_RADIUS=[{type:15,flags:0,unit:"px",number:3}],RADIO_BORDER_RADIUS=[{type:16,flags:0,number:50}],reformatInputBounds=function(l){return l.width>l.height?new Bounds(l.left+(l.width-l.height)/2,l.top,l.height,l.height):l.width<l.height?new Bounds(l.left,l.top+(l.height-l.width)/2,l.width,l.width):l},getInputValue=function(l){var o=l.type===PASSWORD?new Array(l.value.length+1).join("\u2022"):l.value;return o.length===0?l.placeholder||"":o},CHECKBOX="checkbox",RADIO="radio",PASSWORD="password",INPUT_COLOR=707406591,InputElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;switch(h.type=c.type.toLowerCase(),h.checked=c.checked,h.value=getInputValue(c),(h.type===CHECKBOX||h.type===RADIO)&&(h.styles.backgroundColor=3739148031,h.styles.borderTopColor=h.styles.borderRightColor=h.styles.borderBottomColor=h.styles.borderLeftColor=2779096575,h.styles.borderTopWidth=h.styles.borderRightWidth=h.styles.borderBottomWidth=h.styles.borderLeftWidth=1,h.styles.borderTopStyle=h.styles.borderRightStyle=h.styles.borderBottomStyle=h.styles.borderLeftStyle=BORDER_STYLE.SOLID,h.styles.backgroundClip=[BACKGROUND_CLIP.BORDER_BOX],h.styles.backgroundOrigin=[0],h.bounds=reformatInputBounds(h.bounds)),h.type){case CHECKBOX:h.styles.borderTopRightRadius=h.styles.borderTopLeftRadius=h.styles.borderBottomRightRadius=h.styles.borderBottomLeftRadius=CHECKBOX_BORDER_RADIUS;break;case RADIO:h.styles.borderTopRightRadius=h.styles.borderTopLeftRadius=h.styles.borderBottomRightRadius=h.styles.borderBottomLeftRadius=RADIO_BORDER_RADIUS;break}return h}return o}(ElementContainer),SelectElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this,d=c.options[c.selectedIndex||0];return h.value=d&&d.text||"",h}return o}(ElementContainer),TextareaElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;return h.value=c.value,h}return o}(ElementContainer),IFrameElementContainer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;h.src=c.src,h.width=parseInt(c.width,10)||0,h.height=parseInt(c.height,10)||0,h.backgroundColor=h.styles.backgroundColor;try{if(c.contentWindow&&c.contentWindow.document&&c.contentWindow.document.documentElement){h.tree=parseTree(s,c.contentWindow.document.documentElement);var d=c.contentWindow.document.documentElement?parseColor(s,getComputedStyle(c.contentWindow.document.documentElement).backgroundColor):COLORS.TRANSPARENT,p=c.contentWindow.document.body?parseColor(s,getComputedStyle(c.contentWindow.document.body).backgroundColor):COLORS.TRANSPARENT;h.backgroundColor=isTransparent(d)?isTransparent(p)?h.styles.backgroundColor:p:d}}catch{}return h}return o}(ElementContainer),LIST_OWNERS=["OL","UL","MENU"],parseNodeTree=function(l,o,s,c){for(var h=o.firstChild,d=void 0;h;h=d)if(d=h.nextSibling,isTextNode(h)&&h.data.trim().length>0)s.textNodes.push(new TextContainer(l,h,s.styles));else if(isElementNode(h))if(isSlotElement(h)&&h.assignedNodes)h.assignedNodes().forEach(function(Co){return parseNodeTree(l,Co,s,c)});else{var p=createContainer(l,h);p.styles.isVisible()&&(createsRealStackingContext(h,p,c)?p.flags|=4:createsStackingContext(p.styles)&&(p.flags|=2),LIST_OWNERS.indexOf(h.tagName)!==-1&&(p.flags|=8),s.elements.push(p),h.slot,h.shadowRoot?parseNodeTree(l,h.shadowRoot,p,c):!isTextareaElement(h)&&!isSVGElement(h)&&!isSelectElement(h)&&parseNodeTree(l,h,p,c))}},createContainer=function(l,o){return isImageElement(o)?new ImageElementContainer(l,o):isCanvasElement(o)?new CanvasElementContainer(l,o):isSVGElement(o)?new SVGElementContainer(l,o):isLIElement(o)?new LIElementContainer(l,o):isOLElement(o)?new OLElementContainer(l,o):isInputElement(o)?new InputElementContainer(l,o):isSelectElement(o)?new SelectElementContainer(l,o):isTextareaElement(o)?new TextareaElementContainer(l,o):isIFrameElement(o)?new IFrameElementContainer(l,o):new ElementContainer(l,o)},parseTree=function(l,o){var s=createContainer(l,o);return s.flags|=4,parseNodeTree(l,o,s,s),s},createsRealStackingContext=function(l,o,s){return o.styles.isPositionedWithZIndex()||o.styles.opacity<1||o.styles.isTransformed()||isBodyElement(l)&&s.styles.isTransparent()},createsStackingContext=function(l){return l.isPositioned()||l.isFloating()},isTextNode=function(l){return l.nodeType===Node.TEXT_NODE},isElementNode=function(l){return l.nodeType===Node.ELEMENT_NODE},isHTMLElementNode=function(l){return isElementNode(l)&&typeof l.style<"u"&&!isSVGElementNode(l)},isSVGElementNode=function(l){return typeof l.className=="object"},isLIElement=function(l){return l.tagName==="LI"},isOLElement=function(l){return l.tagName==="OL"},isInputElement=function(l){return l.tagName==="INPUT"},isHTMLElement=function(l){return l.tagName==="HTML"},isSVGElement=function(l){return l.tagName==="svg"},isBodyElement=function(l){return l.tagName==="BODY"},isCanvasElement=function(l){return l.tagName==="CANVAS"},isImageElement=function(l){return l.tagName==="IMG"},isIFrameElement=function(l){return l.tagName==="IFRAME"},isStyleElement=function(l){return l.tagName==="STYLE"},isScriptElement=function(l){return l.tagName==="SCRIPT"},isTextareaElement=function(l){return l.tagName==="TEXTAREA"},isSelectElement=function(l){return l.tagName==="SELECT"},isSlotElement=function(l){return l.tagName==="SLOT"},CounterState=function(){function l(){this.counters={}}return l.prototype.getCounterValue=function(o){var s=this.counters[o];return s&&s.length?s[s.length-1]:1},l.prototype.getCounterValues=function(o){var s=this.counters[o];return s||[]},l.prototype.pop=function(o){var s=this;o.forEach(function(c){return s.counters[c].pop()})},l.prototype.parse=function(o){var s=this,c=o.counterIncrement,h=o.counterReset,d=!0;c!==null&&c.forEach(function(Co){var Bo=s.counters[Co.counter];Bo&&Co.increment!==0&&(d=!1,Bo.length||Bo.push(1),Bo[Math.max(0,Bo.length-1)]+=Co.increment)});var p=[];return d&&h.forEach(function(Co){var Bo=s.counters[Co.counter];p.push(Co.counter),Bo||(Bo=s.counters[Co.counter]=[]),Bo.push(Co.reset)}),p},l}(),ROMAN_UPPER={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ARMENIAN={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},HEBREW={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},GEORGIAN={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},createAdditiveCounter=function(l,o,s,c,h,d){return l<o||l>s?createCounterText(l,h,d.length>0):c.integers.reduce(function(p,Co,Bo){for(;l>=Co;)l-=Co,p+=c.values[Bo];return p},"")+d},createCounterStyleWithSymbolResolver=function(l,o,s,c){var h="";do s||l--,h=c(l)+h,l/=o;while(l*o>=o);return h},createCounterStyleFromRange=function(l,o,s,c,h){var d=s-o+1;return(l<0?"-":"")+(createCounterStyleWithSymbolResolver(Math.abs(l),d,c,function(p){return fromCodePoint$1(Math.floor(p%d)+o)})+h)},createCounterStyleFromSymbols=function(l,o,s){s===void 0&&(s=". ");var c=o.length;return createCounterStyleWithSymbolResolver(Math.abs(l),c,!1,function(h){return o[Math.floor(h%c)]})+s},CJK_ZEROS=1<<0,CJK_TEN_COEFFICIENTS=1<<1,CJK_TEN_HIGH_COEFFICIENTS=1<<2,CJK_HUNDRED_COEFFICIENTS=1<<3,createCJKCounter=function(l,o,s,c,h,d){if(l<-9999||l>9999)return createCounterText(l,LIST_STYLE_TYPE.CJK_DECIMAL,h.length>0);var p=Math.abs(l),Co=h;if(p===0)return o[0]+Co;for(var Bo=0;p>0&&Bo<=4;Bo++){var Lo=p%10;Lo===0&&contains(d,CJK_ZEROS)&&Co!==""?Co=o[Lo]+Co:Lo>1||Lo===1&&Bo===0||Lo===1&&Bo===1&&contains(d,CJK_TEN_COEFFICIENTS)||Lo===1&&Bo===1&&contains(d,CJK_TEN_HIGH_COEFFICIENTS)&&l>100||Lo===1&&Bo>1&&contains(d,CJK_HUNDRED_COEFFICIENTS)?Co=o[Lo]+(Bo>0?s[Bo-1]:"")+Co:Lo===1&&Bo>0&&(Co=s[Bo-1]+Co),p=Math.floor(p/10)}return(l<0?c:"")+Co},CHINESE_INFORMAL_MULTIPLIERS="\u5341\u767E\u5343\u842C",CHINESE_FORMAL_MULTIPLIERS="\u62FE\u4F70\u4EDF\u842C",JAPANESE_NEGATIVE="\u30DE\u30A4\u30CA\u30B9",KOREAN_NEGATIVE="\uB9C8\uC774\uB108\uC2A4",createCounterText=function(l,o,s){var c=s?". ":"",h=s?"\u3001":"",d=s?", ":"",p=s?" ":"";switch(o){case LIST_STYLE_TYPE.DISC:return"\u2022"+p;case LIST_STYLE_TYPE.CIRCLE:return"\u25E6"+p;case LIST_STYLE_TYPE.SQUARE:return"\u25FE"+p;case LIST_STYLE_TYPE.DECIMAL_LEADING_ZERO:var Co=createCounterStyleFromRange(l,48,57,!0,c);return Co.length<4?"0"+Co:Co;case LIST_STYLE_TYPE.CJK_DECIMAL:return createCounterStyleFromSymbols(l,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",h);case LIST_STYLE_TYPE.LOWER_ROMAN:return createAdditiveCounter(l,1,3999,ROMAN_UPPER,LIST_STYLE_TYPE.DECIMAL,c).toLowerCase();case LIST_STYLE_TYPE.UPPER_ROMAN:return createAdditiveCounter(l,1,3999,ROMAN_UPPER,LIST_STYLE_TYPE.DECIMAL,c);case LIST_STYLE_TYPE.LOWER_GREEK:return createCounterStyleFromRange(l,945,969,!1,c);case LIST_STYLE_TYPE.LOWER_ALPHA:return createCounterStyleFromRange(l,97,122,!1,c);case LIST_STYLE_TYPE.UPPER_ALPHA:return createCounterStyleFromRange(l,65,90,!1,c);case LIST_STYLE_TYPE.ARABIC_INDIC:return createCounterStyleFromRange(l,1632,1641,!0,c);case LIST_STYLE_TYPE.ARMENIAN:case LIST_STYLE_TYPE.UPPER_ARMENIAN:return createAdditiveCounter(l,1,9999,ARMENIAN,LIST_STYLE_TYPE.DECIMAL,c);case LIST_STYLE_TYPE.LOWER_ARMENIAN:return createAdditiveCounter(l,1,9999,ARMENIAN,LIST_STYLE_TYPE.DECIMAL,c).toLowerCase();case LIST_STYLE_TYPE.BENGALI:return createCounterStyleFromRange(l,2534,2543,!0,c);case LIST_STYLE_TYPE.CAMBODIAN:case LIST_STYLE_TYPE.KHMER:return createCounterStyleFromRange(l,6112,6121,!0,c);case LIST_STYLE_TYPE.CJK_EARTHLY_BRANCH:return createCounterStyleFromSymbols(l,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",h);case LIST_STYLE_TYPE.CJK_HEAVENLY_STEM:return createCounterStyleFromSymbols(l,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",h);case LIST_STYLE_TYPE.CJK_IDEOGRAPHIC:case LIST_STYLE_TYPE.TRAD_CHINESE_INFORMAL:return createCJKCounter(l,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",CHINESE_INFORMAL_MULTIPLIERS,"\u8CA0",h,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case LIST_STYLE_TYPE.TRAD_CHINESE_FORMAL:return createCJKCounter(l,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",CHINESE_FORMAL_MULTIPLIERS,"\u8CA0",h,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case LIST_STYLE_TYPE.SIMP_CHINESE_INFORMAL:return createCJKCounter(l,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",CHINESE_INFORMAL_MULTIPLIERS,"\u8D1F",h,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case LIST_STYLE_TYPE.SIMP_CHINESE_FORMAL:return createCJKCounter(l,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",CHINESE_FORMAL_MULTIPLIERS,"\u8D1F",h,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case LIST_STYLE_TYPE.JAPANESE_INFORMAL:return createCJKCounter(l,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",JAPANESE_NEGATIVE,h,0);case LIST_STYLE_TYPE.JAPANESE_FORMAL:return createCJKCounter(l,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",JAPANESE_NEGATIVE,h,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case LIST_STYLE_TYPE.KOREAN_HANGUL_FORMAL:return createCJKCounter(l,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",KOREAN_NEGATIVE,d,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case LIST_STYLE_TYPE.KOREAN_HANJA_INFORMAL:return createCJKCounter(l,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",KOREAN_NEGATIVE,d,0);case LIST_STYLE_TYPE.KOREAN_HANJA_FORMAL:return createCJKCounter(l,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",KOREAN_NEGATIVE,d,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case LIST_STYLE_TYPE.DEVANAGARI:return createCounterStyleFromRange(l,2406,2415,!0,c);case LIST_STYLE_TYPE.GEORGIAN:return createAdditiveCounter(l,1,19999,GEORGIAN,LIST_STYLE_TYPE.DECIMAL,c);case LIST_STYLE_TYPE.GUJARATI:return createCounterStyleFromRange(l,2790,2799,!0,c);case LIST_STYLE_TYPE.GURMUKHI:return createCounterStyleFromRange(l,2662,2671,!0,c);case LIST_STYLE_TYPE.HEBREW:return createAdditiveCounter(l,1,10999,HEBREW,LIST_STYLE_TYPE.DECIMAL,c);case LIST_STYLE_TYPE.HIRAGANA:return createCounterStyleFromSymbols(l,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case LIST_STYLE_TYPE.HIRAGANA_IROHA:return createCounterStyleFromSymbols(l,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case LIST_STYLE_TYPE.KANNADA:return createCounterStyleFromRange(l,3302,3311,!0,c);case LIST_STYLE_TYPE.KATAKANA:return createCounterStyleFromSymbols(l,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",h);case LIST_STYLE_TYPE.KATAKANA_IROHA:return createCounterStyleFromSymbols(l,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",h);case LIST_STYLE_TYPE.LAO:return createCounterStyleFromRange(l,3792,3801,!0,c);case LIST_STYLE_TYPE.MONGOLIAN:return createCounterStyleFromRange(l,6160,6169,!0,c);case LIST_STYLE_TYPE.MYANMAR:return createCounterStyleFromRange(l,4160,4169,!0,c);case LIST_STYLE_TYPE.ORIYA:return createCounterStyleFromRange(l,2918,2927,!0,c);case LIST_STYLE_TYPE.PERSIAN:return createCounterStyleFromRange(l,1776,1785,!0,c);case LIST_STYLE_TYPE.TAMIL:return createCounterStyleFromRange(l,3046,3055,!0,c);case LIST_STYLE_TYPE.TELUGU:return createCounterStyleFromRange(l,3174,3183,!0,c);case LIST_STYLE_TYPE.THAI:return createCounterStyleFromRange(l,3664,3673,!0,c);case LIST_STYLE_TYPE.TIBETAN:return createCounterStyleFromRange(l,3872,3881,!0,c);case LIST_STYLE_TYPE.DECIMAL:default:return createCounterStyleFromRange(l,48,57,!0,c)}},IGNORE_ATTRIBUTE="data-html2canvas-ignore",DocumentCloner=function(){function l(o,s,c){if(this.context=o,this.options=c,this.scrolledElements=[],this.referenceElement=s,this.counters=new CounterState,this.quoteDepth=0,!s.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(s.ownerDocument.documentElement)}return l.prototype.toIFrame=function(o,s){var c=this,h=createIFrameContainer(o,s);if(!h.contentWindow)return Promise.reject("Unable to find iframe window");var d=o.defaultView.pageXOffset,p=o.defaultView.pageYOffset,Co=h.contentWindow,Bo=Co.document,Lo=iframeLoader(h).then(function(){return __awaiter(c,void 0,void 0,function(){var Uo,Qo;return __generator(this,function(Po){switch(Po.label){case 0:return this.scrolledElements.forEach(restoreNodeScroll),Co&&(Co.scrollTo(s.left,s.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(Co.scrollY!==s.top||Co.scrollX!==s.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(Co.scrollX-s.left,Co.scrollY-s.top,0,0))),Uo=this.options.onclone,Qo=this.clonedReferenceElement,typeof Qo>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:Bo.fonts&&Bo.fonts.ready?[4,Bo.fonts.ready]:[3,2];case 1:Po.sent(),Po.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,imagesReady(Bo)]:[3,4];case 3:Po.sent(),Po.label=4;case 4:return typeof Uo=="function"?[2,Promise.resolve().then(function(){return Uo(Bo,Qo)}).then(function(){return h})]:[2,h]}})})});return Bo.open(),Bo.write(serializeDoctype(document.doctype)+"<html></html>"),restoreOwnerScroll(this.referenceElement.ownerDocument,d,p),Bo.replaceChild(Bo.adoptNode(this.documentElement),Bo.documentElement),Bo.close(),Lo},l.prototype.createElementClone=function(o){if(isDebugging(o,2))debugger;if(isCanvasElement(o))return this.createCanvasClone(o);if(isStyleElement(o))return this.createStyleClone(o);var s=o.cloneNode(!1);return isImageElement(s)&&(isImageElement(o)&&o.currentSrc&&o.currentSrc!==o.src&&(s.src=o.currentSrc,s.srcset=""),s.loading==="lazy"&&(s.loading="eager")),s},l.prototype.createStyleClone=function(o){try{var s=o.sheet;if(s&&s.cssRules){var c=[].slice.call(s.cssRules,0).reduce(function(d,p){return p&&typeof p.cssText=="string"?d+p.cssText:d},""),h=o.cloneNode(!1);return h.textContent=c,h}}catch(d){if(this.context.logger.error("Unable to access cssRules property",d),d.name!=="SecurityError")throw d}return o.cloneNode(!1)},l.prototype.createCanvasClone=function(o){var s;if(this.options.inlineImages&&o.ownerDocument){var c=o.ownerDocument.createElement("img");try{return c.src=o.toDataURL(),c}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",o)}}var h=o.cloneNode(!1);try{h.width=o.width,h.height=o.height;var d=o.getContext("2d"),p=h.getContext("2d");if(p)if(!this.options.allowTaint&&d)p.putImageData(d.getImageData(0,0,o.width,o.height),0,0);else{var Co=(s=o.getContext("webgl2"))!==null&&s!==void 0?s:o.getContext("webgl");if(Co){var Bo=Co.getContextAttributes();(Bo==null?void 0:Bo.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",o)}p.drawImage(o,0,0)}return h}catch{this.context.logger.info("Unable to clone canvas as it is tainted",o)}return h},l.prototype.cloneNode=function(o){if(isTextNode(o))return document.createTextNode(o.data);if(!o.ownerDocument)return o.cloneNode(!1);var s=o.ownerDocument.defaultView;if(s&&isElementNode(o)&&(isHTMLElementNode(o)||isSVGElementNode(o))){var c=this.createElementClone(o);c.style.transitionProperty="none";var h=s.getComputedStyle(o),d=s.getComputedStyle(o,":before"),p=s.getComputedStyle(o,":after");this.referenceElement===o&&isHTMLElementNode(c)&&(this.clonedReferenceElement=c),isBodyElement(c)&&createPseudoHideStyles(c);for(var Co=this.counters.parse(new CSSParsedCounterDeclaration(this.context,h)),Bo=this.resolvePseudoContent(o,c,d,PseudoElementType.BEFORE),Lo=o.firstChild;Lo;Lo=Lo.nextSibling)(!isElementNode(Lo)||!isScriptElement(Lo)&&!Lo.hasAttribute(IGNORE_ATTRIBUTE)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(Lo)))&&(!this.options.copyStyles||!isElementNode(Lo)||!isStyleElement(Lo))&&c.appendChild(this.cloneNode(Lo));Bo&&c.insertBefore(Bo,c.firstChild);var Uo=this.resolvePseudoContent(o,c,p,PseudoElementType.AFTER);return Uo&&c.appendChild(Uo),this.counters.pop(Co),h&&(this.options.copyStyles||isSVGElementNode(o))&&!isIFrameElement(o)&&copyCSSStyles(h,c),(o.scrollTop!==0||o.scrollLeft!==0)&&this.scrolledElements.push([c,o.scrollLeft,o.scrollTop]),(isTextareaElement(o)||isSelectElement(o))&&(isTextareaElement(c)||isSelectElement(c))&&(c.value=o.value),c}return o.cloneNode(!1)},l.prototype.resolvePseudoContent=function(o,s,c,h){var d=this;if(!!c){var p=c.content,Co=s.ownerDocument;if(!(!Co||!p||p==="none"||p==="-moz-alt-content"||c.display==="none")){this.counters.parse(new CSSParsedCounterDeclaration(this.context,c));var Bo=new CSSParsedPseudoDeclaration(this.context,c),Lo=Co.createElement("html2canvaspseudoelement");copyCSSStyles(c,Lo),Bo.content.forEach(function(Qo){if(Qo.type===0)Lo.appendChild(Co.createTextNode(Qo.value));else if(Qo.type===22){var Po=Co.createElement("img");Po.src=Qo.value,Po.style.opacity="1",Lo.appendChild(Po)}else if(Qo.type===18){if(Qo.name==="attr"){var Mo=Qo.values.filter(isIdentToken);Mo.length&&Lo.appendChild(Co.createTextNode(o.getAttribute(Mo[0].value)||""))}else if(Qo.name==="counter"){var Go=Qo.values.filter(nonFunctionArgSeparator),$o=Go[0],jo=Go[1];if($o&&isIdentToken($o)){var zo=d.counters.getCounterValue($o.value),Xo=jo&&isIdentToken(jo)?listStyleType.parse(d.context,jo.value):LIST_STYLE_TYPE.DECIMAL;Lo.appendChild(Co.createTextNode(createCounterText(zo,Xo,!1)))}}else if(Qo.name==="counters"){var Zo=Qo.values.filter(nonFunctionArgSeparator),$o=Zo[0],Wo=Zo[1],jo=Zo[2];if($o&&isIdentToken($o)){var es=d.counters.getCounterValues($o.value),is=jo&&isIdentToken(jo)?listStyleType.parse(d.context,jo.value):LIST_STYLE_TYPE.DECIMAL,Jo=Wo&&Wo.type===0?Wo.value:"",Ko=es.map(function(ss){return createCounterText(ss,is,!1)}).join(Jo);Lo.appendChild(Co.createTextNode(Ko))}}}else if(Qo.type===20)switch(Qo.value){case"open-quote":Lo.appendChild(Co.createTextNode(getQuote(Bo.quotes,d.quoteDepth++,!0)));break;case"close-quote":Lo.appendChild(Co.createTextNode(getQuote(Bo.quotes,--d.quoteDepth,!1)));break;default:Lo.appendChild(Co.createTextNode(Qo.value))}}),Lo.className=PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;var Uo=h===PseudoElementType.BEFORE?" "+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE:" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;return isSVGElementNode(s)?s.className.baseValue+=Uo:s.className+=Uo,Lo}}},l.destroy=function(o){return o.parentNode?(o.parentNode.removeChild(o),!0):!1},l}(),PseudoElementType;(function(l){l[l.BEFORE=0]="BEFORE",l[l.AFTER=1]="AFTER"})(PseudoElementType||(PseudoElementType={}));var createIFrameContainer=function(l,o){var s=l.createElement("iframe");return s.className="html2canvas-container",s.style.visibility="hidden",s.style.position="fixed",s.style.left="-10000px",s.style.top="0px",s.style.border="0",s.width=o.width.toString(),s.height=o.height.toString(),s.scrolling="no",s.setAttribute(IGNORE_ATTRIBUTE,"true"),l.body.appendChild(s),s},imageReady=function(l){return new Promise(function(o){if(l.complete){o();return}if(!l.src){o();return}l.onload=o,l.onerror=o})},imagesReady=function(l){return Promise.all([].slice.call(l.images,0).map(imageReady))},iframeLoader=function(l){return new Promise(function(o,s){var c=l.contentWindow;if(!c)return s("No window assigned for iframe");var h=c.document;c.onload=l.onload=function(){c.onload=l.onload=null;var d=setInterval(function(){h.body.childNodes.length>0&&h.readyState==="complete"&&(clearInterval(d),o(l))},50)}})},ignoredStyleProperties=["all","d","content"],copyCSSStyles=function(l,o){for(var s=l.length-1;s>=0;s--){var c=l.item(s);ignoredStyleProperties.indexOf(c)===-1&&o.style.setProperty(c,l.getPropertyValue(c))}return o},serializeDoctype=function(l){var o="";return l&&(o+="<!DOCTYPE ",l.name&&(o+=l.name),l.internalSubset&&(o+=l.internalSubset),l.publicId&&(o+='"'+l.publicId+'"'),l.systemId&&(o+='"'+l.systemId+'"'),o+=">"),o},restoreOwnerScroll=function(l,o,s){l&&l.defaultView&&(o!==l.defaultView.pageXOffset||s!==l.defaultView.pageYOffset)&&l.defaultView.scrollTo(o,s)},restoreNodeScroll=function(l){var o=l[0],s=l[1],c=l[2];o.scrollLeft=s,o.scrollTop=c},PSEUDO_BEFORE=":before",PSEUDO_AFTER=":after",PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",PSEUDO_HIDE_ELEMENT_STYLE=`{
    content: "" !important;
    display: none !important;
}`,createPseudoHideStyles=function(l){createStyles(l,"."+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+PSEUDO_BEFORE+PSEUDO_HIDE_ELEMENT_STYLE+`
         .`+PSEUDO_HIDE_ELEMENT_CLASS_AFTER+PSEUDO_AFTER+PSEUDO_HIDE_ELEMENT_STYLE)},createStyles=function(l,o){var s=l.ownerDocument;if(s){var c=s.createElement("style");c.textContent=o,l.appendChild(c)}},CacheStorage=function(){function l(){}return l.getOrigin=function(o){var s=l._link;return s?(s.href=o,s.href=s.href,s.protocol+s.hostname+s.port):"about:blank"},l.isSameOrigin=function(o){return l.getOrigin(o)===l._origin},l.setContext=function(o){l._link=o.document.createElement("a"),l._origin=l.getOrigin(o.location.href)},l._origin="about:blank",l}(),Cache=function(){function l(o,s){this.context=o,this._options=s,this._cache={}}return l.prototype.addImage=function(o){var s=Promise.resolve();return this.has(o)||(isBlobImage(o)||isRenderable(o))&&(this._cache[o]=this.loadImage(o)).catch(function(){}),s},l.prototype.match=function(o){return this._cache[o]},l.prototype.loadImage=function(o){return __awaiter(this,void 0,void 0,function(){var s,c,h,d,p=this;return __generator(this,function(Co){switch(Co.label){case 0:return s=CacheStorage.isSameOrigin(o),c=!isInlineImage(o)&&this._options.useCORS===!0&&FEATURES.SUPPORT_CORS_IMAGES&&!s,h=!isInlineImage(o)&&!s&&!isBlobImage(o)&&typeof this._options.proxy=="string"&&FEATURES.SUPPORT_CORS_XHR&&!c,!s&&this._options.allowTaint===!1&&!isInlineImage(o)&&!isBlobImage(o)&&!h&&!c?[2]:(d=o,h?[4,this.proxy(d)]:[3,2]);case 1:d=Co.sent(),Co.label=2;case 2:return this.context.logger.debug("Added image "+o.substring(0,256)),[4,new Promise(function(Bo,Lo){var Uo=new Image;Uo.onload=function(){return Bo(Uo)},Uo.onerror=Lo,(isInlineBase64Image(d)||c)&&(Uo.crossOrigin="anonymous"),Uo.src=d,Uo.complete===!0&&setTimeout(function(){return Bo(Uo)},500),p._options.imageTimeout>0&&setTimeout(function(){return Lo("Timed out ("+p._options.imageTimeout+"ms) loading image")},p._options.imageTimeout)})];case 3:return[2,Co.sent()]}})})},l.prototype.has=function(o){return typeof this._cache[o]<"u"},l.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},l.prototype.proxy=function(o){var s=this,c=this._options.proxy;if(!c)throw new Error("No proxy defined");var h=o.substring(0,256);return new Promise(function(d,p){var Co=FEATURES.SUPPORT_RESPONSE_TYPE?"blob":"text",Bo=new XMLHttpRequest;Bo.onload=function(){if(Bo.status===200)if(Co==="text")d(Bo.response);else{var Qo=new FileReader;Qo.addEventListener("load",function(){return d(Qo.result)},!1),Qo.addEventListener("error",function(Po){return p(Po)},!1),Qo.readAsDataURL(Bo.response)}else p("Failed to proxy resource "+h+" with status code "+Bo.status)},Bo.onerror=p;var Lo=c.indexOf("?")>-1?"&":"?";if(Bo.open("GET",""+c+Lo+"url="+encodeURIComponent(o)+"&responseType="+Co),Co!=="text"&&Bo instanceof XMLHttpRequest&&(Bo.responseType=Co),s._options.imageTimeout){var Uo=s._options.imageTimeout;Bo.timeout=Uo,Bo.ontimeout=function(){return p("Timed out ("+Uo+"ms) proxying "+h)}}Bo.send()})},l}(),INLINE_SVG=/^data:image\/svg\+xml/i,INLINE_BASE64=/^data:image\/.*;base64,/i,INLINE_IMG=/^data:image\/.*/i,isRenderable=function(l){return FEATURES.SUPPORT_SVG_DRAWING||!isSVG(l)},isInlineImage=function(l){return INLINE_IMG.test(l)},isInlineBase64Image=function(l){return INLINE_BASE64.test(l)},isBlobImage=function(l){return l.substr(0,4)==="blob"},isSVG=function(l){return l.substr(-3).toLowerCase()==="svg"||INLINE_SVG.test(l)},PathType;(function(l){l[l.VECTOR=0]="VECTOR",l[l.BEZIER_CURVE=1]="BEZIER_CURVE"})(PathType||(PathType={}));var equalPath=function(l,o){return l.length===o.length?l.some(function(s,c){return s===o[c]}):!1},transformPath=function(l,o,s,c,h){return l.map(function(d,p){switch(p){case 0:return d.add(o,s);case 1:return d.add(o+c,s);case 2:return d.add(o+c,s+h);case 3:return d.add(o,s+h)}return d})},Vector=function(){function l(o,s){this.type=PathType.VECTOR,this.x=o,this.y=s}return l.prototype.add=function(o,s){return new l(this.x+o,this.y+s)},l}(),lerp=function(l,o,s){return new Vector(l.x+(o.x-l.x)*s,l.y+(o.y-l.y)*s)},BezierCurve=function(){function l(o,s,c,h){this.type=PathType.BEZIER_CURVE,this.start=o,this.startControl=s,this.endControl=c,this.end=h}return l.prototype.subdivide=function(o,s){var c=lerp(this.start,this.startControl,o),h=lerp(this.startControl,this.endControl,o),d=lerp(this.endControl,this.end,o),p=lerp(c,h,o),Co=lerp(h,d,o),Bo=lerp(p,Co,o);return s?new l(this.start,c,p,Bo):new l(Bo,Co,d,this.end)},l.prototype.add=function(o,s){return new l(this.start.add(o,s),this.startControl.add(o,s),this.endControl.add(o,s),this.end.add(o,s))},l.prototype.reverse=function(){return new l(this.end,this.endControl,this.startControl,this.start)},l}(),isBezierCurve=function(l){return l.type===PathType.BEZIER_CURVE},BoundCurves=function(){function l(o){var s=o.styles,c=o.bounds,h=getAbsoluteValueForTuple(s.borderTopLeftRadius,c.width,c.height),d=h[0],p=h[1],Co=getAbsoluteValueForTuple(s.borderTopRightRadius,c.width,c.height),Bo=Co[0],Lo=Co[1],Uo=getAbsoluteValueForTuple(s.borderBottomRightRadius,c.width,c.height),Qo=Uo[0],Po=Uo[1],Mo=getAbsoluteValueForTuple(s.borderBottomLeftRadius,c.width,c.height),Go=Mo[0],$o=Mo[1],jo=[];jo.push((d+Bo)/c.width),jo.push((Go+Qo)/c.width),jo.push((p+$o)/c.height),jo.push((Lo+Po)/c.height);var zo=Math.max.apply(Math,jo);zo>1&&(d/=zo,p/=zo,Bo/=zo,Lo/=zo,Qo/=zo,Po/=zo,Go/=zo,$o/=zo);var Xo=c.width-Bo,Zo=c.height-Po,Wo=c.width-Qo,es=c.height-$o,is=s.borderTopWidth,Jo=s.borderRightWidth,Ko=s.borderBottomWidth,Yo=s.borderLeftWidth,ts=getAbsoluteValue(s.paddingTop,o.bounds.width),ss=getAbsoluteValue(s.paddingRight,o.bounds.width),cs=getAbsoluteValue(s.paddingBottom,o.bounds.width),as=getAbsoluteValue(s.paddingLeft,o.bounds.width);this.topLeftBorderDoubleOuterBox=d>0||p>0?getCurvePoints(c.left+Yo/3,c.top+is/3,d-Yo/3,p-is/3,CORNER.TOP_LEFT):new Vector(c.left+Yo/3,c.top+is/3),this.topRightBorderDoubleOuterBox=d>0||p>0?getCurvePoints(c.left+Xo,c.top+is/3,Bo-Jo/3,Lo-is/3,CORNER.TOP_RIGHT):new Vector(c.left+c.width-Jo/3,c.top+is/3),this.bottomRightBorderDoubleOuterBox=Qo>0||Po>0?getCurvePoints(c.left+Wo,c.top+Zo,Qo-Jo/3,Po-Ko/3,CORNER.BOTTOM_RIGHT):new Vector(c.left+c.width-Jo/3,c.top+c.height-Ko/3),this.bottomLeftBorderDoubleOuterBox=Go>0||$o>0?getCurvePoints(c.left+Yo/3,c.top+es,Go-Yo/3,$o-Ko/3,CORNER.BOTTOM_LEFT):new Vector(c.left+Yo/3,c.top+c.height-Ko/3),this.topLeftBorderDoubleInnerBox=d>0||p>0?getCurvePoints(c.left+Yo*2/3,c.top+is*2/3,d-Yo*2/3,p-is*2/3,CORNER.TOP_LEFT):new Vector(c.left+Yo*2/3,c.top+is*2/3),this.topRightBorderDoubleInnerBox=d>0||p>0?getCurvePoints(c.left+Xo,c.top+is*2/3,Bo-Jo*2/3,Lo-is*2/3,CORNER.TOP_RIGHT):new Vector(c.left+c.width-Jo*2/3,c.top+is*2/3),this.bottomRightBorderDoubleInnerBox=Qo>0||Po>0?getCurvePoints(c.left+Wo,c.top+Zo,Qo-Jo*2/3,Po-Ko*2/3,CORNER.BOTTOM_RIGHT):new Vector(c.left+c.width-Jo*2/3,c.top+c.height-Ko*2/3),this.bottomLeftBorderDoubleInnerBox=Go>0||$o>0?getCurvePoints(c.left+Yo*2/3,c.top+es,Go-Yo*2/3,$o-Ko*2/3,CORNER.BOTTOM_LEFT):new Vector(c.left+Yo*2/3,c.top+c.height-Ko*2/3),this.topLeftBorderStroke=d>0||p>0?getCurvePoints(c.left+Yo/2,c.top+is/2,d-Yo/2,p-is/2,CORNER.TOP_LEFT):new Vector(c.left+Yo/2,c.top+is/2),this.topRightBorderStroke=d>0||p>0?getCurvePoints(c.left+Xo,c.top+is/2,Bo-Jo/2,Lo-is/2,CORNER.TOP_RIGHT):new Vector(c.left+c.width-Jo/2,c.top+is/2),this.bottomRightBorderStroke=Qo>0||Po>0?getCurvePoints(c.left+Wo,c.top+Zo,Qo-Jo/2,Po-Ko/2,CORNER.BOTTOM_RIGHT):new Vector(c.left+c.width-Jo/2,c.top+c.height-Ko/2),this.bottomLeftBorderStroke=Go>0||$o>0?getCurvePoints(c.left+Yo/2,c.top+es,Go-Yo/2,$o-Ko/2,CORNER.BOTTOM_LEFT):new Vector(c.left+Yo/2,c.top+c.height-Ko/2),this.topLeftBorderBox=d>0||p>0?getCurvePoints(c.left,c.top,d,p,CORNER.TOP_LEFT):new Vector(c.left,c.top),this.topRightBorderBox=Bo>0||Lo>0?getCurvePoints(c.left+Xo,c.top,Bo,Lo,CORNER.TOP_RIGHT):new Vector(c.left+c.width,c.top),this.bottomRightBorderBox=Qo>0||Po>0?getCurvePoints(c.left+Wo,c.top+Zo,Qo,Po,CORNER.BOTTOM_RIGHT):new Vector(c.left+c.width,c.top+c.height),this.bottomLeftBorderBox=Go>0||$o>0?getCurvePoints(c.left,c.top+es,Go,$o,CORNER.BOTTOM_LEFT):new Vector(c.left,c.top+c.height),this.topLeftPaddingBox=d>0||p>0?getCurvePoints(c.left+Yo,c.top+is,Math.max(0,d-Yo),Math.max(0,p-is),CORNER.TOP_LEFT):new Vector(c.left+Yo,c.top+is),this.topRightPaddingBox=Bo>0||Lo>0?getCurvePoints(c.left+Math.min(Xo,c.width-Jo),c.top+is,Xo>c.width+Jo?0:Math.max(0,Bo-Jo),Math.max(0,Lo-is),CORNER.TOP_RIGHT):new Vector(c.left+c.width-Jo,c.top+is),this.bottomRightPaddingBox=Qo>0||Po>0?getCurvePoints(c.left+Math.min(Wo,c.width-Yo),c.top+Math.min(Zo,c.height-Ko),Math.max(0,Qo-Jo),Math.max(0,Po-Ko),CORNER.BOTTOM_RIGHT):new Vector(c.left+c.width-Jo,c.top+c.height-Ko),this.bottomLeftPaddingBox=Go>0||$o>0?getCurvePoints(c.left+Yo,c.top+Math.min(es,c.height-Ko),Math.max(0,Go-Yo),Math.max(0,$o-Ko),CORNER.BOTTOM_LEFT):new Vector(c.left+Yo,c.top+c.height-Ko),this.topLeftContentBox=d>0||p>0?getCurvePoints(c.left+Yo+as,c.top+is+ts,Math.max(0,d-(Yo+as)),Math.max(0,p-(is+ts)),CORNER.TOP_LEFT):new Vector(c.left+Yo+as,c.top+is+ts),this.topRightContentBox=Bo>0||Lo>0?getCurvePoints(c.left+Math.min(Xo,c.width+Yo+as),c.top+is+ts,Xo>c.width+Yo+as?0:Bo-Yo+as,Lo-(is+ts),CORNER.TOP_RIGHT):new Vector(c.left+c.width-(Jo+ss),c.top+is+ts),this.bottomRightContentBox=Qo>0||Po>0?getCurvePoints(c.left+Math.min(Wo,c.width-(Yo+as)),c.top+Math.min(Zo,c.height+is+ts),Math.max(0,Qo-(Jo+ss)),Po-(Ko+cs),CORNER.BOTTOM_RIGHT):new Vector(c.left+c.width-(Jo+ss),c.top+c.height-(Ko+cs)),this.bottomLeftContentBox=Go>0||$o>0?getCurvePoints(c.left+Yo+as,c.top+es,Math.max(0,Go-(Yo+as)),$o-(Ko+cs),CORNER.BOTTOM_LEFT):new Vector(c.left+Yo+as,c.top+c.height-(Ko+cs))}return l}(),CORNER;(function(l){l[l.TOP_LEFT=0]="TOP_LEFT",l[l.TOP_RIGHT=1]="TOP_RIGHT",l[l.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",l[l.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(CORNER||(CORNER={}));var getCurvePoints=function(l,o,s,c,h){var d=4*((Math.sqrt(2)-1)/3),p=s*d,Co=c*d,Bo=l+s,Lo=o+c;switch(h){case CORNER.TOP_LEFT:return new BezierCurve(new Vector(l,Lo),new Vector(l,Lo-Co),new Vector(Bo-p,o),new Vector(Bo,o));case CORNER.TOP_RIGHT:return new BezierCurve(new Vector(l,o),new Vector(l+p,o),new Vector(Bo,Lo-Co),new Vector(Bo,Lo));case CORNER.BOTTOM_RIGHT:return new BezierCurve(new Vector(Bo,o),new Vector(Bo,o+Co),new Vector(l+p,Lo),new Vector(l,Lo));case CORNER.BOTTOM_LEFT:default:return new BezierCurve(new Vector(Bo,Lo),new Vector(Bo-p,Lo),new Vector(l,o+Co),new Vector(l,o))}},calculateBorderBoxPath=function(l){return[l.topLeftBorderBox,l.topRightBorderBox,l.bottomRightBorderBox,l.bottomLeftBorderBox]},calculateContentBoxPath=function(l){return[l.topLeftContentBox,l.topRightContentBox,l.bottomRightContentBox,l.bottomLeftContentBox]},calculatePaddingBoxPath=function(l){return[l.topLeftPaddingBox,l.topRightPaddingBox,l.bottomRightPaddingBox,l.bottomLeftPaddingBox]},TransformEffect=function(){function l(o,s,c){this.offsetX=o,this.offsetY=s,this.matrix=c,this.type=0,this.target=6}return l}(),ClipEffect=function(){function l(o,s){this.path=o,this.target=s,this.type=1}return l}(),OpacityEffect=function(){function l(o){this.opacity=o,this.type=2,this.target=6}return l}(),isTransformEffect=function(l){return l.type===0},isClipEffect=function(l){return l.type===1},isOpacityEffect=function(l){return l.type===2},StackingContext=function(){function l(o){this.element=o,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return l}(),ElementPaint=function(){function l(o,s){if(this.container=o,this.parent=s,this.effects=[],this.curves=new BoundCurves(this.container),this.container.styles.opacity<1&&this.effects.push(new OpacityEffect(this.container.styles.opacity)),this.container.styles.transform!==null){var c=this.container.bounds.left+this.container.styles.transformOrigin[0].number,h=this.container.bounds.top+this.container.styles.transformOrigin[1].number,d=this.container.styles.transform;this.effects.push(new TransformEffect(c,h,d))}if(this.container.styles.overflowX!==OVERFLOW.VISIBLE){var p=calculateBorderBoxPath(this.curves),Co=calculatePaddingBoxPath(this.curves);equalPath(p,Co)?this.effects.push(new ClipEffect(p,6)):(this.effects.push(new ClipEffect(p,2)),this.effects.push(new ClipEffect(Co,4)))}}return l.prototype.getEffects=function(o){for(var s=[POSITION.ABSOLUTE,POSITION.FIXED].indexOf(this.container.styles.position)===-1,c=this.parent,h=this.effects.slice(0);c;){var d=c.effects.filter(function(Bo){return!isClipEffect(Bo)});if(s||c.container.styles.position!==POSITION.STATIC||!c.parent){if(h.unshift.apply(h,d),s=[POSITION.ABSOLUTE,POSITION.FIXED].indexOf(c.container.styles.position)===-1,c.container.styles.overflowX!==OVERFLOW.VISIBLE){var p=calculateBorderBoxPath(c.curves),Co=calculatePaddingBoxPath(c.curves);equalPath(p,Co)||h.unshift(new ClipEffect(Co,6))}}else h.unshift.apply(h,d);c=c.parent}return h.filter(function(Bo){return contains(Bo.target,o)})},l}(),parseStackTree=function(l,o,s,c){l.container.elements.forEach(function(h){var d=contains(h.flags,4),p=contains(h.flags,2),Co=new ElementPaint(h,l);contains(h.styles.display,2048)&&c.push(Co);var Bo=contains(h.flags,8)?[]:c;if(d||p){var Lo=d||h.styles.isPositioned()?s:o,Uo=new StackingContext(Co);if(h.styles.isPositioned()||h.styles.opacity<1||h.styles.isTransformed()){var Qo=h.styles.zIndex.order;if(Qo<0){var Po=0;Lo.negativeZIndex.some(function(Go,$o){return Qo>Go.element.container.styles.zIndex.order?(Po=$o,!1):Po>0}),Lo.negativeZIndex.splice(Po,0,Uo)}else if(Qo>0){var Mo=0;Lo.positiveZIndex.some(function(Go,$o){return Qo>=Go.element.container.styles.zIndex.order?(Mo=$o+1,!1):Mo>0}),Lo.positiveZIndex.splice(Mo,0,Uo)}else Lo.zeroOrAutoZIndexOrTransformedOrOpacity.push(Uo)}else h.styles.isFloating()?Lo.nonPositionedFloats.push(Uo):Lo.nonPositionedInlineLevel.push(Uo);parseStackTree(Co,Uo,d?Uo:s,Bo)}else h.styles.isInlineLevel()?o.inlineLevel.push(Co):o.nonInlineLevel.push(Co),parseStackTree(Co,o,s,Bo);contains(h.flags,8)&&processListItems(h,Bo)})},processListItems=function(l,o){for(var s=l instanceof OLElementContainer?l.start:1,c=l instanceof OLElementContainer?l.reversed:!1,h=0;h<o.length;h++){var d=o[h];d.container instanceof LIElementContainer&&typeof d.container.value=="number"&&d.container.value!==0&&(s=d.container.value),d.listValue=createCounterText(s,d.container.styles.listStyleType,!0),s+=c?-1:1}},parseStackingContexts=function(l){var o=new ElementPaint(l,null),s=new StackingContext(o),c=[];return parseStackTree(o,s,s,c),processListItems(o.container,c),s},parsePathForBorder=function(l,o){switch(o){case 0:return createPathFromCurves(l.topLeftBorderBox,l.topLeftPaddingBox,l.topRightBorderBox,l.topRightPaddingBox);case 1:return createPathFromCurves(l.topRightBorderBox,l.topRightPaddingBox,l.bottomRightBorderBox,l.bottomRightPaddingBox);case 2:return createPathFromCurves(l.bottomRightBorderBox,l.bottomRightPaddingBox,l.bottomLeftBorderBox,l.bottomLeftPaddingBox);case 3:default:return createPathFromCurves(l.bottomLeftBorderBox,l.bottomLeftPaddingBox,l.topLeftBorderBox,l.topLeftPaddingBox)}},parsePathForBorderDoubleOuter=function(l,o){switch(o){case 0:return createPathFromCurves(l.topLeftBorderBox,l.topLeftBorderDoubleOuterBox,l.topRightBorderBox,l.topRightBorderDoubleOuterBox);case 1:return createPathFromCurves(l.topRightBorderBox,l.topRightBorderDoubleOuterBox,l.bottomRightBorderBox,l.bottomRightBorderDoubleOuterBox);case 2:return createPathFromCurves(l.bottomRightBorderBox,l.bottomRightBorderDoubleOuterBox,l.bottomLeftBorderBox,l.bottomLeftBorderDoubleOuterBox);case 3:default:return createPathFromCurves(l.bottomLeftBorderBox,l.bottomLeftBorderDoubleOuterBox,l.topLeftBorderBox,l.topLeftBorderDoubleOuterBox)}},parsePathForBorderDoubleInner=function(l,o){switch(o){case 0:return createPathFromCurves(l.topLeftBorderDoubleInnerBox,l.topLeftPaddingBox,l.topRightBorderDoubleInnerBox,l.topRightPaddingBox);case 1:return createPathFromCurves(l.topRightBorderDoubleInnerBox,l.topRightPaddingBox,l.bottomRightBorderDoubleInnerBox,l.bottomRightPaddingBox);case 2:return createPathFromCurves(l.bottomRightBorderDoubleInnerBox,l.bottomRightPaddingBox,l.bottomLeftBorderDoubleInnerBox,l.bottomLeftPaddingBox);case 3:default:return createPathFromCurves(l.bottomLeftBorderDoubleInnerBox,l.bottomLeftPaddingBox,l.topLeftBorderDoubleInnerBox,l.topLeftPaddingBox)}},parsePathForBorderStroke=function(l,o){switch(o){case 0:return createStrokePathFromCurves(l.topLeftBorderStroke,l.topRightBorderStroke);case 1:return createStrokePathFromCurves(l.topRightBorderStroke,l.bottomRightBorderStroke);case 2:return createStrokePathFromCurves(l.bottomRightBorderStroke,l.bottomLeftBorderStroke);case 3:default:return createStrokePathFromCurves(l.bottomLeftBorderStroke,l.topLeftBorderStroke)}},createStrokePathFromCurves=function(l,o){var s=[];return isBezierCurve(l)?s.push(l.subdivide(.5,!1)):s.push(l),isBezierCurve(o)?s.push(o.subdivide(.5,!0)):s.push(o),s},createPathFromCurves=function(l,o,s,c){var h=[];return isBezierCurve(l)?h.push(l.subdivide(.5,!1)):h.push(l),isBezierCurve(s)?h.push(s.subdivide(.5,!0)):h.push(s),isBezierCurve(c)?h.push(c.subdivide(.5,!0).reverse()):h.push(c),isBezierCurve(o)?h.push(o.subdivide(.5,!1).reverse()):h.push(o),h},paddingBox=function(l){var o=l.bounds,s=l.styles;return o.add(s.borderLeftWidth,s.borderTopWidth,-(s.borderRightWidth+s.borderLeftWidth),-(s.borderTopWidth+s.borderBottomWidth))},contentBox=function(l){var o=l.styles,s=l.bounds,c=getAbsoluteValue(o.paddingLeft,s.width),h=getAbsoluteValue(o.paddingRight,s.width),d=getAbsoluteValue(o.paddingTop,s.width),p=getAbsoluteValue(o.paddingBottom,s.width);return s.add(c+o.borderLeftWidth,d+o.borderTopWidth,-(o.borderRightWidth+o.borderLeftWidth+c+h),-(o.borderTopWidth+o.borderBottomWidth+d+p))},calculateBackgroundPositioningArea=function(l,o){return l===0?o.bounds:l===2?contentBox(o):paddingBox(o)},calculateBackgroundPaintingArea=function(l,o){return l===BACKGROUND_CLIP.BORDER_BOX?o.bounds:l===BACKGROUND_CLIP.CONTENT_BOX?contentBox(o):paddingBox(o)},calculateBackgroundRendering=function(l,o,s){var c=calculateBackgroundPositioningArea(getBackgroundValueForIndex(l.styles.backgroundOrigin,o),l),h=calculateBackgroundPaintingArea(getBackgroundValueForIndex(l.styles.backgroundClip,o),l),d=calculateBackgroundSize(getBackgroundValueForIndex(l.styles.backgroundSize,o),s,c),p=d[0],Co=d[1],Bo=getAbsoluteValueForTuple(getBackgroundValueForIndex(l.styles.backgroundPosition,o),c.width-p,c.height-Co),Lo=calculateBackgroundRepeatPath(getBackgroundValueForIndex(l.styles.backgroundRepeat,o),Bo,d,c,h),Uo=Math.round(c.left+Bo[0]),Qo=Math.round(c.top+Bo[1]);return[Lo,Uo,Qo,p,Co]},isAuto=function(l){return isIdentToken(l)&&l.value===BACKGROUND_SIZE.AUTO},hasIntrinsicValue=function(l){return typeof l=="number"},calculateBackgroundSize=function(l,o,s){var c=o[0],h=o[1],d=o[2],p=l[0],Co=l[1];if(!p)return[0,0];if(isLengthPercentage(p)&&Co&&isLengthPercentage(Co))return[getAbsoluteValue(p,s.width),getAbsoluteValue(Co,s.height)];var Bo=hasIntrinsicValue(d);if(isIdentToken(p)&&(p.value===BACKGROUND_SIZE.CONTAIN||p.value===BACKGROUND_SIZE.COVER)){if(hasIntrinsicValue(d)){var Lo=s.width/s.height;return Lo<d!=(p.value===BACKGROUND_SIZE.COVER)?[s.width,s.width/d]:[s.height*d,s.height]}return[s.width,s.height]}var Uo=hasIntrinsicValue(c),Qo=hasIntrinsicValue(h),Po=Uo||Qo;if(isAuto(p)&&(!Co||isAuto(Co))){if(Uo&&Qo)return[c,h];if(!Bo&&!Po)return[s.width,s.height];if(Po&&Bo){var Mo=Uo?c:h*d,Go=Qo?h:c/d;return[Mo,Go]}var $o=Uo?c:s.width,jo=Qo?h:s.height;return[$o,jo]}if(Bo){var zo=0,Xo=0;return isLengthPercentage(p)?zo=getAbsoluteValue(p,s.width):isLengthPercentage(Co)&&(Xo=getAbsoluteValue(Co,s.height)),isAuto(p)?zo=Xo*d:(!Co||isAuto(Co))&&(Xo=zo/d),[zo,Xo]}var Zo=null,Wo=null;if(isLengthPercentage(p)?Zo=getAbsoluteValue(p,s.width):Co&&isLengthPercentage(Co)&&(Wo=getAbsoluteValue(Co,s.height)),Zo!==null&&(!Co||isAuto(Co))&&(Wo=Uo&&Qo?Zo/c*h:s.height),Wo!==null&&isAuto(p)&&(Zo=Uo&&Qo?Wo/h*c:s.width),Zo!==null&&Wo!==null)return[Zo,Wo];throw new Error("Unable to calculate background-size for element")},getBackgroundValueForIndex=function(l,o){var s=l[o];return typeof s>"u"?l[0]:s},calculateBackgroundRepeatPath=function(l,o,s,c,h){var d=o[0],p=o[1],Co=s[0],Bo=s[1];switch(l){case BACKGROUND_REPEAT.REPEAT_X:return[new Vector(Math.round(c.left),Math.round(c.top+p)),new Vector(Math.round(c.left+c.width),Math.round(c.top+p)),new Vector(Math.round(c.left+c.width),Math.round(Bo+c.top+p)),new Vector(Math.round(c.left),Math.round(Bo+c.top+p))];case BACKGROUND_REPEAT.REPEAT_Y:return[new Vector(Math.round(c.left+d),Math.round(c.top)),new Vector(Math.round(c.left+d+Co),Math.round(c.top)),new Vector(Math.round(c.left+d+Co),Math.round(c.height+c.top)),new Vector(Math.round(c.left+d),Math.round(c.height+c.top))];case BACKGROUND_REPEAT.NO_REPEAT:return[new Vector(Math.round(c.left+d),Math.round(c.top+p)),new Vector(Math.round(c.left+d+Co),Math.round(c.top+p)),new Vector(Math.round(c.left+d+Co),Math.round(c.top+p+Bo)),new Vector(Math.round(c.left+d),Math.round(c.top+p+Bo))];default:return[new Vector(Math.round(h.left),Math.round(h.top)),new Vector(Math.round(h.left+h.width),Math.round(h.top)),new Vector(Math.round(h.left+h.width),Math.round(h.height+h.top)),new Vector(Math.round(h.left),Math.round(h.height+h.top))]}},SMALL_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",SAMPLE_TEXT="Hidden Text",FontMetrics=function(){function l(o){this._data={},this._document=o}return l.prototype.parseMetrics=function(o,s){var c=this._document.createElement("div"),h=this._document.createElement("img"),d=this._document.createElement("span"),p=this._document.body;c.style.visibility="hidden",c.style.fontFamily=o,c.style.fontSize=s,c.style.margin="0",c.style.padding="0",p.appendChild(c),h.src=SMALL_IMAGE,h.width=1,h.height=1,h.style.margin="0",h.style.padding="0",h.style.verticalAlign="baseline",d.style.fontFamily=o,d.style.fontSize=s,d.style.margin="0",d.style.padding="0",d.appendChild(this._document.createTextNode(SAMPLE_TEXT)),c.appendChild(d),c.appendChild(h);var Co=h.offsetTop-d.offsetTop+2;c.removeChild(d),c.appendChild(this._document.createTextNode(SAMPLE_TEXT)),c.style.lineHeight="normal",h.style.verticalAlign="super";var Bo=h.offsetTop-c.offsetTop+2;return p.removeChild(c),{baseline:Co,middle:Bo}},l.prototype.getMetrics=function(o,s){var c=o+" "+s;return typeof this._data[c]>"u"&&(this._data[c]=this.parseMetrics(o,s)),this._data[c]},l}(),Renderer=function(){function l(o,s){this.context=o,this.options=s}return l}(),MASK_OFFSET=1e4,CanvasRenderer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;return h._activeEffects=[],h.canvas=c.canvas?c.canvas:document.createElement("canvas"),h.ctx=h.canvas.getContext("2d"),c.canvas||(h.canvas.width=Math.floor(c.width*c.scale),h.canvas.height=Math.floor(c.height*c.scale),h.canvas.style.width=c.width+"px",h.canvas.style.height=c.height+"px"),h.fontMetrics=new FontMetrics(document),h.ctx.scale(h.options.scale,h.options.scale),h.ctx.translate(-c.x,-c.y),h.ctx.textBaseline="bottom",h._activeEffects=[],h.context.logger.debug("Canvas renderer initialized ("+c.width+"x"+c.height+") with scale "+c.scale),h}return o.prototype.applyEffects=function(s){for(var c=this;this._activeEffects.length;)this.popEffect();s.forEach(function(h){return c.applyEffect(h)})},o.prototype.applyEffect=function(s){this.ctx.save(),isOpacityEffect(s)&&(this.ctx.globalAlpha=s.opacity),isTransformEffect(s)&&(this.ctx.translate(s.offsetX,s.offsetY),this.ctx.transform(s.matrix[0],s.matrix[1],s.matrix[2],s.matrix[3],s.matrix[4],s.matrix[5]),this.ctx.translate(-s.offsetX,-s.offsetY)),isClipEffect(s)&&(this.path(s.path),this.ctx.clip()),this._activeEffects.push(s)},o.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},o.prototype.renderStack=function(s){return __awaiter(this,void 0,void 0,function(){var c;return __generator(this,function(h){switch(h.label){case 0:return c=s.element.container.styles,c.isVisible()?[4,this.renderStackContent(s)]:[3,2];case 1:h.sent(),h.label=2;case 2:return[2]}})})},o.prototype.renderNode=function(s){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(c){switch(c.label){case 0:if(contains(s.container.flags,16))debugger;return s.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(s)]:[3,3];case 1:return c.sent(),[4,this.renderNodeContent(s)];case 2:c.sent(),c.label=3;case 3:return[2]}})})},o.prototype.renderTextWithLetterSpacing=function(s,c,h){var d=this;if(c===0)this.ctx.fillText(s.text,s.bounds.left,s.bounds.top+h);else{var p=splitGraphemes(s.text);p.reduce(function(Co,Bo){return d.ctx.fillText(Bo,Co,s.bounds.top+h),Co+d.ctx.measureText(Bo).width},s.bounds.left)}},o.prototype.createFontStyle=function(s){var c=s.fontVariant.filter(function(p){return p==="normal"||p==="small-caps"}).join(""),h=s.fontFamily.join(", "),d=isDimensionToken(s.fontSize)?""+s.fontSize.number+s.fontSize.unit:s.fontSize.number+"px";return[[s.fontStyle,c,s.fontWeight,d,h].join(" "),h,d]},o.prototype.renderTextNode=function(s,c){return __awaiter(this,void 0,void 0,function(){var h,d,p,Co,Bo,Lo,Uo,Qo,Po=this;return __generator(this,function(Mo){return h=this.createFontStyle(c),d=h[0],p=h[1],Co=h[2],this.ctx.font=d,this.ctx.direction=c.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",Bo=this.fontMetrics.getMetrics(p,Co),Lo=Bo.baseline,Uo=Bo.middle,Qo=c.paintOrder,s.textBounds.forEach(function(Go){Qo.forEach(function($o){switch($o){case PAINT_ORDER_LAYER.FILL:Po.ctx.fillStyle=asString(c.color),Po.renderTextWithLetterSpacing(Go,c.letterSpacing,Lo);var jo=c.textShadow;jo.length&&Go.text.trim().length&&(jo.slice(0).reverse().forEach(function(zo){Po.ctx.shadowColor=asString(zo.color),Po.ctx.shadowOffsetX=zo.offsetX.number*Po.options.scale,Po.ctx.shadowOffsetY=zo.offsetY.number*Po.options.scale,Po.ctx.shadowBlur=zo.blur.number,Po.renderTextWithLetterSpacing(Go,c.letterSpacing,Lo)}),Po.ctx.shadowColor="",Po.ctx.shadowOffsetX=0,Po.ctx.shadowOffsetY=0,Po.ctx.shadowBlur=0),c.textDecorationLine.length&&(Po.ctx.fillStyle=asString(c.textDecorationColor||c.color),c.textDecorationLine.forEach(function(zo){switch(zo){case 1:Po.ctx.fillRect(Go.bounds.left,Math.round(Go.bounds.top+Lo),Go.bounds.width,1);break;case 2:Po.ctx.fillRect(Go.bounds.left,Math.round(Go.bounds.top),Go.bounds.width,1);break;case 3:Po.ctx.fillRect(Go.bounds.left,Math.ceil(Go.bounds.top+Uo),Go.bounds.width,1);break}}));break;case PAINT_ORDER_LAYER.STROKE:c.webkitTextStrokeWidth&&Go.text.trim().length&&(Po.ctx.strokeStyle=asString(c.webkitTextStrokeColor),Po.ctx.lineWidth=c.webkitTextStrokeWidth,Po.ctx.lineJoin=window.chrome?"miter":"round",Po.ctx.strokeText(Go.text,Go.bounds.left,Go.bounds.top+Lo)),Po.ctx.strokeStyle="",Po.ctx.lineWidth=0,Po.ctx.lineJoin="miter";break}})}),[2]})})},o.prototype.renderReplacedElement=function(s,c,h){if(h&&s.intrinsicWidth>0&&s.intrinsicHeight>0){var d=contentBox(s),p=calculatePaddingBoxPath(c);this.path(p),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(h,0,0,s.intrinsicWidth,s.intrinsicHeight,d.left,d.top,d.width,d.height),this.ctx.restore()}},o.prototype.renderNodeContent=function(s){return __awaiter(this,void 0,void 0,function(){var c,h,d,p,Co,Bo,Xo,Xo,Lo,Uo,Qo,Po,Wo,Mo,Go,es,$o,jo,zo,Xo,Zo,Wo,es;return __generator(this,function(is){switch(is.label){case 0:this.applyEffects(s.getEffects(4)),c=s.container,h=s.curves,d=c.styles,p=0,Co=c.textNodes,is.label=1;case 1:return p<Co.length?(Bo=Co[p],[4,this.renderTextNode(Bo,d)]):[3,4];case 2:is.sent(),is.label=3;case 3:return p++,[3,1];case 4:if(!(c instanceof ImageElementContainer))return[3,8];is.label=5;case 5:return is.trys.push([5,7,,8]),[4,this.context.cache.match(c.src)];case 6:return Xo=is.sent(),this.renderReplacedElement(c,h,Xo),[3,8];case 7:return is.sent(),this.context.logger.error("Error loading image "+c.src),[3,8];case 8:if(c instanceof CanvasElementContainer&&this.renderReplacedElement(c,h,c.canvas),!(c instanceof SVGElementContainer))return[3,12];is.label=9;case 9:return is.trys.push([9,11,,12]),[4,this.context.cache.match(c.svg)];case 10:return Xo=is.sent(),this.renderReplacedElement(c,h,Xo),[3,12];case 11:return is.sent(),this.context.logger.error("Error loading svg "+c.svg.substring(0,255)),[3,12];case 12:return c instanceof IFrameElementContainer&&c.tree?(Lo=new o(this.context,{scale:this.options.scale,backgroundColor:c.backgroundColor,x:0,y:0,width:c.width,height:c.height}),[4,Lo.render(c.tree)]):[3,14];case 13:Uo=is.sent(),c.width&&c.height&&this.ctx.drawImage(Uo,0,0,c.width,c.height,c.bounds.left,c.bounds.top,c.bounds.width,c.bounds.height),is.label=14;case 14:if(c instanceof InputElementContainer&&(Qo=Math.min(c.bounds.width,c.bounds.height),c.type===CHECKBOX?c.checked&&(this.ctx.save(),this.path([new Vector(c.bounds.left+Qo*.39363,c.bounds.top+Qo*.79),new Vector(c.bounds.left+Qo*.16,c.bounds.top+Qo*.5549),new Vector(c.bounds.left+Qo*.27347,c.bounds.top+Qo*.44071),new Vector(c.bounds.left+Qo*.39694,c.bounds.top+Qo*.5649),new Vector(c.bounds.left+Qo*.72983,c.bounds.top+Qo*.23),new Vector(c.bounds.left+Qo*.84,c.bounds.top+Qo*.34085),new Vector(c.bounds.left+Qo*.39363,c.bounds.top+Qo*.79)]),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore()):c.type===RADIO&&c.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(c.bounds.left+Qo/2,c.bounds.top+Qo/2,Qo/4,0,Math.PI*2,!0),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore())),isTextInputElement(c)&&c.value.length){switch(Po=this.createFontStyle(d),Wo=Po[0],Mo=Po[1],Go=this.fontMetrics.getMetrics(Wo,Mo).baseline,this.ctx.font=Wo,this.ctx.fillStyle=asString(d.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=canvasTextAlign(c.styles.textAlign),es=contentBox(c),$o=0,c.styles.textAlign){case TEXT_ALIGN.CENTER:$o+=es.width/2;break;case TEXT_ALIGN.RIGHT:$o+=es.width;break}jo=es.add($o,0,0,-es.height/2+1),this.ctx.save(),this.path([new Vector(es.left,es.top),new Vector(es.left+es.width,es.top),new Vector(es.left+es.width,es.top+es.height),new Vector(es.left,es.top+es.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new TextBounds(c.value,jo),d.letterSpacing,Go),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!contains(c.styles.display,2048))return[3,20];if(c.styles.listStyleImage===null)return[3,19];if(zo=c.styles.listStyleImage,zo.type!==CSSImageType.URL)return[3,18];Xo=void 0,Zo=zo.url,is.label=15;case 15:return is.trys.push([15,17,,18]),[4,this.context.cache.match(Zo)];case 16:return Xo=is.sent(),this.ctx.drawImage(Xo,c.bounds.left-(Xo.width+10),c.bounds.top),[3,18];case 17:return is.sent(),this.context.logger.error("Error loading list-style-image "+Zo),[3,18];case 18:return[3,20];case 19:s.listValue&&c.styles.listStyleType!==LIST_STYLE_TYPE.NONE&&(Wo=this.createFontStyle(d)[0],this.ctx.font=Wo,this.ctx.fillStyle=asString(d.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",es=new Bounds(c.bounds.left,c.bounds.top+getAbsoluteValue(c.styles.paddingTop,c.bounds.width),c.bounds.width,computeLineHeight(d.lineHeight,d.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new TextBounds(s.listValue,es),d.letterSpacing,computeLineHeight(d.lineHeight,d.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),is.label=20;case 20:return[2]}})})},o.prototype.renderStackContent=function(s){return __awaiter(this,void 0,void 0,function(){var c,h,zo,d,p,zo,Co,Bo,zo,Lo,Uo,zo,Qo,Po,zo,Mo,Go,zo,$o,jo,zo;return __generator(this,function(Xo){switch(Xo.label){case 0:if(contains(s.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(s.element)];case 1:Xo.sent(),c=0,h=s.negativeZIndex,Xo.label=2;case 2:return c<h.length?(zo=h[c],[4,this.renderStack(zo)]):[3,5];case 3:Xo.sent(),Xo.label=4;case 4:return c++,[3,2];case 5:return[4,this.renderNodeContent(s.element)];case 6:Xo.sent(),d=0,p=s.nonInlineLevel,Xo.label=7;case 7:return d<p.length?(zo=p[d],[4,this.renderNode(zo)]):[3,10];case 8:Xo.sent(),Xo.label=9;case 9:return d++,[3,7];case 10:Co=0,Bo=s.nonPositionedFloats,Xo.label=11;case 11:return Co<Bo.length?(zo=Bo[Co],[4,this.renderStack(zo)]):[3,14];case 12:Xo.sent(),Xo.label=13;case 13:return Co++,[3,11];case 14:Lo=0,Uo=s.nonPositionedInlineLevel,Xo.label=15;case 15:return Lo<Uo.length?(zo=Uo[Lo],[4,this.renderStack(zo)]):[3,18];case 16:Xo.sent(),Xo.label=17;case 17:return Lo++,[3,15];case 18:Qo=0,Po=s.inlineLevel,Xo.label=19;case 19:return Qo<Po.length?(zo=Po[Qo],[4,this.renderNode(zo)]):[3,22];case 20:Xo.sent(),Xo.label=21;case 21:return Qo++,[3,19];case 22:Mo=0,Go=s.zeroOrAutoZIndexOrTransformedOrOpacity,Xo.label=23;case 23:return Mo<Go.length?(zo=Go[Mo],[4,this.renderStack(zo)]):[3,26];case 24:Xo.sent(),Xo.label=25;case 25:return Mo++,[3,23];case 26:$o=0,jo=s.positiveZIndex,Xo.label=27;case 27:return $o<jo.length?(zo=jo[$o],[4,this.renderStack(zo)]):[3,30];case 28:Xo.sent(),Xo.label=29;case 29:return $o++,[3,27];case 30:return[2]}})})},o.prototype.mask=function(s){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(s.slice(0).reverse()),this.ctx.closePath()},o.prototype.path=function(s){this.ctx.beginPath(),this.formatPath(s),this.ctx.closePath()},o.prototype.formatPath=function(s){var c=this;s.forEach(function(h,d){var p=isBezierCurve(h)?h.start:h;d===0?c.ctx.moveTo(p.x,p.y):c.ctx.lineTo(p.x,p.y),isBezierCurve(h)&&c.ctx.bezierCurveTo(h.startControl.x,h.startControl.y,h.endControl.x,h.endControl.y,h.end.x,h.end.y)})},o.prototype.renderRepeat=function(s,c,h,d){this.path(s),this.ctx.fillStyle=c,this.ctx.translate(h,d),this.ctx.fill(),this.ctx.translate(-h,-d)},o.prototype.resizeImage=function(s,c,h){var d;if(s.width===c&&s.height===h)return s;var p=(d=this.canvas.ownerDocument)!==null&&d!==void 0?d:document,Co=p.createElement("canvas");Co.width=Math.max(1,c),Co.height=Math.max(1,h);var Bo=Co.getContext("2d");return Bo.drawImage(s,0,0,s.width,s.height,0,0,c,h),Co},o.prototype.renderBackgroundImage=function(s){return __awaiter(this,void 0,void 0,function(){var c,h,d,p,Co,Bo;return __generator(this,function(Lo){switch(Lo.label){case 0:c=s.styles.backgroundImage.length-1,h=function(Uo){var Qo,Po,Mo,ts,Is,_s,as,us,Ko,Go,ts,Is,_s,as,us,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,Hs,ds,hs,ys,ms,Rs,bs,ps;return __generator(this,function(ks){switch(ks.label){case 0:if(Uo.type!==CSSImageType.URL)return[3,5];Qo=void 0,Po=Uo.url,ks.label=1;case 1:return ks.trys.push([1,3,,4]),[4,d.context.cache.match(Po)];case 2:return Qo=ks.sent(),[3,4];case 3:return ks.sent(),d.context.logger.error("Error loading background-image "+Po),[3,4];case 4:return Qo&&(Mo=calculateBackgroundRendering(s,c,[Qo.width,Qo.height,Qo.width/Qo.height]),ts=Mo[0],Is=Mo[1],_s=Mo[2],as=Mo[3],us=Mo[4],Ko=d.ctx.createPattern(d.resizeImage(Qo,as,us),"repeat"),d.renderRepeat(ts,Ko,Is,_s)),[3,6];case 5:isLinearGradient(Uo)?(Go=calculateBackgroundRendering(s,c,[null,null,null]),ts=Go[0],Is=Go[1],_s=Go[2],as=Go[3],us=Go[4],$o=calculateGradientDirection(Uo.angle,as,us),jo=$o[0],zo=$o[1],Xo=$o[2],Zo=$o[3],Wo=$o[4],es=document.createElement("canvas"),es.width=as,es.height=us,is=es.getContext("2d"),Jo=is.createLinearGradient(zo,Zo,Xo,Wo),processColorStops(Uo.stops,jo).forEach(function(xs){return Jo.addColorStop(xs.stop,asString(xs.color))}),is.fillStyle=Jo,is.fillRect(0,0,as,us),as>0&&us>0&&(Ko=d.ctx.createPattern(es,"repeat"),d.renderRepeat(ts,Ko,Is,_s))):isRadialGradient(Uo)&&(Yo=calculateBackgroundRendering(s,c,[null,null,null]),ts=Yo[0],ss=Yo[1],cs=Yo[2],as=Yo[3],us=Yo[4],gs=Uo.position.length===0?[FIFTY_PERCENT]:Uo.position,Is=getAbsoluteValue(gs[0],as),_s=getAbsoluteValue(gs[gs.length-1],us),Hs=calculateRadius(Uo,Is,_s,as,us),ds=Hs[0],hs=Hs[1],ds>0&&hs>0&&(ys=d.ctx.createRadialGradient(ss+Is,cs+_s,0,ss+Is,cs+_s,ds),processColorStops(Uo.stops,ds*2).forEach(function(xs){return ys.addColorStop(xs.stop,asString(xs.color))}),d.path(ts),d.ctx.fillStyle=ys,ds!==hs?(ms=s.bounds.left+.5*s.bounds.width,Rs=s.bounds.top+.5*s.bounds.height,bs=hs/ds,ps=1/bs,d.ctx.save(),d.ctx.translate(ms,Rs),d.ctx.transform(1,0,0,bs,0,0),d.ctx.translate(-ms,-Rs),d.ctx.fillRect(ss,ps*(cs-Rs)+Rs,as,us*ps),d.ctx.restore()):d.ctx.fill())),ks.label=6;case 6:return c--,[2]}})},d=this,p=0,Co=s.styles.backgroundImage.slice(0).reverse(),Lo.label=1;case 1:return p<Co.length?(Bo=Co[p],[5,h(Bo)]):[3,4];case 2:Lo.sent(),Lo.label=3;case 3:return p++,[3,1];case 4:return[2]}})})},o.prototype.renderSolidBorder=function(s,c,h){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(d){return this.path(parsePathForBorder(h,c)),this.ctx.fillStyle=asString(s),this.ctx.fill(),[2]})})},o.prototype.renderDoubleBorder=function(s,c,h,d){return __awaiter(this,void 0,void 0,function(){var p,Co;return __generator(this,function(Bo){switch(Bo.label){case 0:return c<3?[4,this.renderSolidBorder(s,h,d)]:[3,2];case 1:return Bo.sent(),[2];case 2:return p=parsePathForBorderDoubleOuter(d,h),this.path(p),this.ctx.fillStyle=asString(s),this.ctx.fill(),Co=parsePathForBorderDoubleInner(d,h),this.path(Co),this.ctx.fill(),[2]}})})},o.prototype.renderNodeBackgroundAndBorders=function(s){return __awaiter(this,void 0,void 0,function(){var c,h,d,p,Co,Bo,Lo,Uo,Qo=this;return __generator(this,function(Po){switch(Po.label){case 0:return this.applyEffects(s.getEffects(2)),c=s.container.styles,h=!isTransparent(c.backgroundColor)||c.backgroundImage.length,d=[{style:c.borderTopStyle,color:c.borderTopColor,width:c.borderTopWidth},{style:c.borderRightStyle,color:c.borderRightColor,width:c.borderRightWidth},{style:c.borderBottomStyle,color:c.borderBottomColor,width:c.borderBottomWidth},{style:c.borderLeftStyle,color:c.borderLeftColor,width:c.borderLeftWidth}],p=calculateBackgroundCurvedPaintingArea(getBackgroundValueForIndex(c.backgroundClip,0),s.curves),h||c.boxShadow.length?(this.ctx.save(),this.path(p),this.ctx.clip(),isTransparent(c.backgroundColor)||(this.ctx.fillStyle=asString(c.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(s.container)]):[3,2];case 1:Po.sent(),this.ctx.restore(),c.boxShadow.slice(0).reverse().forEach(function(Mo){Qo.ctx.save();var Go=calculateBorderBoxPath(s.curves),$o=Mo.inset?0:MASK_OFFSET,jo=transformPath(Go,-$o+(Mo.inset?1:-1)*Mo.spread.number,(Mo.inset?1:-1)*Mo.spread.number,Mo.spread.number*(Mo.inset?-2:2),Mo.spread.number*(Mo.inset?-2:2));Mo.inset?(Qo.path(Go),Qo.ctx.clip(),Qo.mask(jo)):(Qo.mask(Go),Qo.ctx.clip(),Qo.path(jo)),Qo.ctx.shadowOffsetX=Mo.offsetX.number+$o,Qo.ctx.shadowOffsetY=Mo.offsetY.number,Qo.ctx.shadowColor=asString(Mo.color),Qo.ctx.shadowBlur=Mo.blur.number,Qo.ctx.fillStyle=Mo.inset?asString(Mo.color):"rgba(0,0,0,1)",Qo.ctx.fill(),Qo.ctx.restore()}),Po.label=2;case 2:Co=0,Bo=0,Lo=d,Po.label=3;case 3:return Bo<Lo.length?(Uo=Lo[Bo],Uo.style!==BORDER_STYLE.NONE&&!isTransparent(Uo.color)&&Uo.width>0?Uo.style!==BORDER_STYLE.DASHED?[3,5]:[4,this.renderDashedDottedBorder(Uo.color,Uo.width,Co,s.curves,BORDER_STYLE.DASHED)]:[3,11]):[3,13];case 4:return Po.sent(),[3,11];case 5:return Uo.style!==BORDER_STYLE.DOTTED?[3,7]:[4,this.renderDashedDottedBorder(Uo.color,Uo.width,Co,s.curves,BORDER_STYLE.DOTTED)];case 6:return Po.sent(),[3,11];case 7:return Uo.style!==BORDER_STYLE.DOUBLE?[3,9]:[4,this.renderDoubleBorder(Uo.color,Uo.width,Co,s.curves)];case 8:return Po.sent(),[3,11];case 9:return[4,this.renderSolidBorder(Uo.color,Co,s.curves)];case 10:Po.sent(),Po.label=11;case 11:Co++,Po.label=12;case 12:return Bo++,[3,3];case 13:return[2]}})})},o.prototype.renderDashedDottedBorder=function(s,c,h,d,p){return __awaiter(this,void 0,void 0,function(){var Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,es,is;return __generator(this,function(Jo){return this.ctx.save(),Co=parsePathForBorderStroke(d,h),Bo=parsePathForBorder(d,h),p===BORDER_STYLE.DASHED&&(this.path(Bo),this.ctx.clip()),isBezierCurve(Bo[0])?(Lo=Bo[0].start.x,Uo=Bo[0].start.y):(Lo=Bo[0].x,Uo=Bo[0].y),isBezierCurve(Bo[1])?(Qo=Bo[1].end.x,Po=Bo[1].end.y):(Qo=Bo[1].x,Po=Bo[1].y),h===0||h===2?Mo=Math.abs(Lo-Qo):Mo=Math.abs(Uo-Po),this.ctx.beginPath(),p===BORDER_STYLE.DOTTED?this.formatPath(Co):this.formatPath(Bo.slice(0,2)),Go=c<3?c*3:c*2,$o=c<3?c*2:c,p===BORDER_STYLE.DOTTED&&(Go=c,$o=c),jo=!0,Mo<=Go*2?jo=!1:Mo<=Go*2+$o?(zo=Mo/(2*Go+$o),Go*=zo,$o*=zo):(Xo=Math.floor((Mo+$o)/(Go+$o)),Zo=(Mo-Xo*Go)/(Xo-1),Wo=(Mo-(Xo+1)*Go)/Xo,$o=Wo<=0||Math.abs($o-Zo)<Math.abs($o-Wo)?Zo:Wo),jo&&(p===BORDER_STYLE.DOTTED?this.ctx.setLineDash([0,Go+$o]):this.ctx.setLineDash([Go,$o])),p===BORDER_STYLE.DOTTED?(this.ctx.lineCap="round",this.ctx.lineWidth=c):this.ctx.lineWidth=c*2+1.1,this.ctx.strokeStyle=asString(s),this.ctx.stroke(),this.ctx.setLineDash([]),p===BORDER_STYLE.DASHED&&(isBezierCurve(Bo[0])&&(es=Bo[3],is=Bo[0],this.ctx.beginPath(),this.formatPath([new Vector(es.end.x,es.end.y),new Vector(is.start.x,is.start.y)]),this.ctx.stroke()),isBezierCurve(Bo[1])&&(es=Bo[1],is=Bo[2],this.ctx.beginPath(),this.formatPath([new Vector(es.end.x,es.end.y),new Vector(is.start.x,is.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},o.prototype.render=function(s){return __awaiter(this,void 0,void 0,function(){var c;return __generator(this,function(h){switch(h.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),c=parseStackingContexts(s),[4,this.renderStack(c)];case 1:return h.sent(),this.applyEffects([]),[2,this.canvas]}})})},o}(Renderer),isTextInputElement=function(l){return l instanceof TextareaElementContainer||l instanceof SelectElementContainer?!0:l instanceof InputElementContainer&&l.type!==RADIO&&l.type!==CHECKBOX},calculateBackgroundCurvedPaintingArea=function(l,o){switch(l){case BACKGROUND_CLIP.BORDER_BOX:return calculateBorderBoxPath(o);case BACKGROUND_CLIP.CONTENT_BOX:return calculateContentBoxPath(o);case BACKGROUND_CLIP.PADDING_BOX:default:return calculatePaddingBoxPath(o)}},canvasTextAlign=function(l){switch(l){case TEXT_ALIGN.CENTER:return"center";case TEXT_ALIGN.RIGHT:return"right";case TEXT_ALIGN.LEFT:default:return"left"}},ForeignObjectRenderer=function(l){__extends(o,l);function o(s,c){var h=l.call(this,s,c)||this;return h.canvas=c.canvas?c.canvas:document.createElement("canvas"),h.ctx=h.canvas.getContext("2d"),h.options=c,h.canvas.width=Math.floor(c.width*c.scale),h.canvas.height=Math.floor(c.height*c.scale),h.canvas.style.width=c.width+"px",h.canvas.style.height=c.height+"px",h.ctx.scale(h.options.scale,h.options.scale),h.ctx.translate(-c.x,-c.y),h.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+c.width+"x"+c.height+" at "+c.x+","+c.y+") with scale "+c.scale),h}return o.prototype.render=function(s){return __awaiter(this,void 0,void 0,function(){var c,h;return __generator(this,function(d){switch(d.label){case 0:return c=createForeignObjectSVG(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,s),[4,loadSerializedSVG(c)];case 1:return h=d.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(h,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},o}(Renderer),loadSerializedSVG=function(l){return new Promise(function(o,s){var c=new Image;c.onload=function(){o(c)},c.onerror=s,c.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(l))})},Logger=function(){function l(o){var s=o.id,c=o.enabled;this.id=s,this.enabled=c,this.start=Date.now()}return l.prototype.debug=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,__spreadArray([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},l.prototype.getTime=function(){return Date.now()-this.start},l.prototype.info=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,__spreadArray([this.id,this.getTime()+"ms"],o))},l.prototype.warn=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,__spreadArray([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},l.prototype.error=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,__spreadArray([this.id,this.getTime()+"ms"],o)):this.info.apply(this,o))},l.instances={},l}(),Context=function(){function l(o,s){var c;this.windowBounds=s,this.instanceName="#"+l.instanceCount++,this.logger=new Logger({id:this.instanceName,enabled:o.logging}),this.cache=(c=o.cache)!==null&&c!==void 0?c:new Cache(this,o)}return l.instanceCount=1,l}(),html2canvas=function(l,o){return o===void 0&&(o={}),renderElement(l,o)};typeof window<"u"&&CacheStorage.setContext(window);var renderElement=function(l,o){return __awaiter(void 0,void 0,void 0,function(){var s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,Jo,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,Hs,ds,hs,ys,ms,Rs,bs;return __generator(this,function(ps){switch(ps.label){case 0:if(!l||typeof l!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(s=l.ownerDocument,!s)throw new Error("Element is not attached to a Document");if(c=s.defaultView,!c)throw new Error("Document is not attached to a Window");return h={allowTaint:(Ko=o.allowTaint)!==null&&Ko!==void 0?Ko:!1,imageTimeout:(Yo=o.imageTimeout)!==null&&Yo!==void 0?Yo:15e3,proxy:o.proxy,useCORS:(ts=o.useCORS)!==null&&ts!==void 0?ts:!1},d=__assign({logging:(ss=o.logging)!==null&&ss!==void 0?ss:!0,cache:o.cache},h),p={windowWidth:(cs=o.windowWidth)!==null&&cs!==void 0?cs:c.innerWidth,windowHeight:(as=o.windowHeight)!==null&&as!==void 0?as:c.innerHeight,scrollX:(us=o.scrollX)!==null&&us!==void 0?us:c.pageXOffset,scrollY:(gs=o.scrollY)!==null&&gs!==void 0?gs:c.pageYOffset},Co=new Bounds(p.scrollX,p.scrollY,p.windowWidth,p.windowHeight),Bo=new Context(d,Co),Lo=(Is=o.foreignObjectRendering)!==null&&Is!==void 0?Is:!1,Uo={allowTaint:(_s=o.allowTaint)!==null&&_s!==void 0?_s:!1,onclone:o.onclone,ignoreElements:o.ignoreElements,inlineImages:Lo,copyStyles:Lo},Bo.logger.debug("Starting document clone with size "+Co.width+"x"+Co.height+" scrolled to "+-Co.left+","+-Co.top),Qo=new DocumentCloner(Bo,l,Uo),Po=Qo.clonedReferenceElement,Po?[4,Qo.toIFrame(s,Co)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return Mo=ps.sent(),Go=isBodyElement(Po)||isHTMLElement(Po)?parseDocumentSize(Po.ownerDocument):parseBounds(Bo,Po),$o=Go.width,jo=Go.height,zo=Go.left,Xo=Go.top,Zo=parseBackgroundColor(Bo,Po,o.backgroundColor),Wo={canvas:o.canvas,backgroundColor:Zo,scale:(ds=(Hs=o.scale)!==null&&Hs!==void 0?Hs:c.devicePixelRatio)!==null&&ds!==void 0?ds:1,x:((hs=o.x)!==null&&hs!==void 0?hs:0)+zo,y:((ys=o.y)!==null&&ys!==void 0?ys:0)+Xo,width:(ms=o.width)!==null&&ms!==void 0?ms:Math.ceil($o),height:(Rs=o.height)!==null&&Rs!==void 0?Rs:Math.ceil(jo)},Lo?(Bo.logger.debug("Document cloned, using foreign object rendering"),Jo=new ForeignObjectRenderer(Bo,Wo),[4,Jo.render(Po)]):[3,3];case 2:return es=ps.sent(),[3,5];case 3:return Bo.logger.debug("Document cloned, element located at "+zo+","+Xo+" with size "+$o+"x"+jo+" using computed rendering"),Bo.logger.debug("Starting DOM parsing"),is=parseTree(Bo,Po),Zo===is.styles.backgroundColor&&(is.styles.backgroundColor=COLORS.TRANSPARENT),Bo.logger.debug("Starting renderer for element at "+Wo.x+","+Wo.y+" with size "+Wo.width+"x"+Wo.height),Jo=new CanvasRenderer(Bo,Wo),[4,Jo.render(is)];case 4:es=ps.sent(),ps.label=5;case 5:return(!((bs=o.removeContainer)!==null&&bs!==void 0)||bs)&&(DocumentCloner.destroy(Mo)||Bo.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),Bo.logger.debug("Finished rendering"),[2,es]}})})},parseBackgroundColor=function(l,o,s){var c=o.ownerDocument,h=c.documentElement?parseColor(l,getComputedStyle(c.documentElement).backgroundColor):COLORS.TRANSPARENT,d=c.body?parseColor(l,getComputedStyle(c.body).backgroundColor):COLORS.TRANSPARENT,p=typeof s=="string"?parseColor(l,s):s===null?COLORS.TRANSPARENT:4294967295;return o===c.documentElement?isTransparent(h)?isTransparent(d)?p:d:h:p};const qcGeorefMap_svelte_svelte_type_style_lang="";function create_fragment$8(l){let o;return{c(){o=element("div"),attr(o,"class","mapview svelte-1xw28c1")},m(s,c){insert(s,o,c),l[4](o)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o),l[4](null)}}}function instance$8(l,o,s){let c;component_subscribe(l,dataStore,bs=>s(3,c=bs));const h=createEventDispatcher();let d,p,Co,Bo,Lo=!1,Uo,Qo,Po,Mo,Go=!0;onMount(async bs=>{ds()||(await new Loader({apiKey:mapsAPIKey,version:"weekly",libraries:["geometry"]}).load(),h("map-ready")),Bo=new google.maps.Map(Co,{zoom:8,center:{lat:-24.321476,lng:24.909317},disableDoubleClickZoom:!0});const ks=document.createElement("div"),xs=document.createElement("div");xs.style.backgroundColor="#fff",xs.style.border="2px solid #fff",xs.style.borderRadius="3px",xs.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",xs.style.cursor="pointer",xs.style.margin="10px",xs.style.textAlign="center",xs.title="Click to toggle uncertainty circles",ks.appendChild(xs);const Ss=document.createElement("div");Ss.style.color="rgb(25,25,25)",Ss.style.fontFamily="Roboto,Arial,sans-serif",Ss.style.fontSize="16px",Ss.style.lineHeight="38px",Ss.style.paddingLeft="5px",Ss.style.paddingRight="5px",Ss.innerHTML="Circles",xs.appendChild(Ss),xs.addEventListener("click",_s),Bo.controls[google.maps.ControlPosition.TOP_RIGHT].push(ks),new MeasureTool(Bo,{showSegmentLength:!1}),Lo=!0,Hs()});const $o=bs=>{Uo&&ts(),Po&&es(),bs.decimalCoordinates?(Yo(bs),Qo?Xo(bs.decimalCoordinates):zo(bs.decimalCoordinates)):Qo&&Zo(),d=bs.uncertainty,p=bs.uncertaintyUnit},jo=bs=>{if(bs.decimalCoordinates&&(Qo?Xo(bs.decimalCoordinates):zo(bs.decimalCoordinates),Po?Jo(bs.decimalCoordinates):d&&!bs.uncertainty&&Wo(bs.decimalCoordinates)),bs.uncertainty&&bs.uncertainty>0&&bs.uncertaintyUnit)if(d=bs.uncertainty,p=bs.uncertaintyUnit,Po)is();else{const ps=Qo.getPosition().toUrlValue();Wo(ps)}},zo=bs=>{let ps;try{ps=Ko(bs)}catch(ks){console.error(`error making latLng for ${bs} in addCoordsPin: ${ks.message}}`),alert("error moving uncertainty circle, see console");return}Qo=new google.maps.Marker({position:ps,map:Bo,draggable:!0,color:"blue",title:"Move to update coordinates"}),google.maps.event.addListener(Qo,"dragend",function(ks){let xs=ks.latLng.toUrlValue();Po?Jo(xs):Wo(xs),h("new-coords",xs)})},Xo=bs=>{let ps;try{ps=Ko(bs)}catch(ks){console.error(`error making latLng for ${bs} in moveCoordsPin: ${ks.message}}`),alert("error moving uncertainty circle, see console");return}Qo.setPosition(ps)},Zo=bs=>{Qo.setMap=null,Qo=null},Wo=bs=>{d&&(Po=ms(bs,d,p,Bo,"blue"))},es=bs=>{Po.setMap(null),Po=null},is=bs=>{let ps=hs(d,p);ps>0?Po.getRadius()!=ps&&Po.setRadius(ps):es()},Jo=bs=>{let ps;try{ps=Ko(bs)}catch(ks){console.error(`error making latLng for ${bs}: ${ks.message}}`),alert("error moving uncertainty circle, see console");return}Po.setCenter(ps)},Ko=bs=>{if(!bs||!bs.trim())throw new Error("empty coords string");const ps=bs.split(",").map(xs=>xs.trim()).filter(xs=>xs);if(ps.length<2)throw new Error("incomplete coords string");if(isNaN(ps[0]))throw new Error("invalid latitude");if(isNaN(ps[1]))throw new Error("invalid longitude ");return{lat:Number(ps[0]),lng:Number(ps[1])}},Yo=bs=>{Uo=ys(bs.decimalCoordinates,Bo,"green","Original georef location");let ps=ms(bs.decimalCoordinates,bs.uncertainty,bs.uncertaintyUnit,Bo,"green");ps&&(Uo.circle=ps)},ts=bs=>{Uo.circle&&(Uo.circle.setMap(null),Uo.circle=null),Uo.setMap(null),Uo=null},ss=bs=>{if(c.georefIndex&&Object.keys(c.georefIndex).length){let ps=new google.maps.LatLngBounds;for(let ks of Object.values(c.georefIndex))if(!ks.ambiguous){let xs=new google.maps.LatLng(ks.decimalLatitude,ks.decimalLongitude);ps.extend(xs)}return ps}else return null},cs=bs=>{const ps=ss();ps&&Bo.fitBounds(ps)},as=bs=>{if(c.markers&&Object.keys(c.markers).length){for(let ps of Object.values(c.markers))ps.circle&&ps.circle.setMap(null),ps.setMap(null);set_store_value(dataStore,c.markers=null,c)}},us=bs=>{if(c.georefIndex&&Object.keys(c.georefIndex).length&&Mo!=c.georefIndex){Go=!0;for(let[ps,ks]of Object.entries(c.georefIndex)){if(ks.ambiguous)continue;let xs;try{xs=Is(ks,Bo,Go)}catch(Ss){console.log(`error creating marker for ${ps}:`,Ss.message);continue}c.markers||set_store_value(dataStore,c.markers={},c),set_store_value(dataStore,c.markers[ps]=xs,c)}Mo=c.georefIndex,cs()}},gs=bs=>{if(c.georefIndex&&Object.keys(c.georefIndex).length&&Mo==c.georefIndex){for(let[ps,ks]of Object.entries(c.georefIndex))if(!ks.ambiguous)if(c.markers){if(!c.markers.hasOwnProperty(ps)){let xs=Is(ks,Bo,Go);set_store_value(dataStore,c.markers[ps]=xs,c)}}else{let xs=Is(ks,Bo,Go);set_store_value(dataStore,c.markers={},c),set_store_value(dataStore,c.markers[ps]=xs,c)}for(let[ps,ks]of Object.entries(c.markers))c.georefIndex.hasOwnProperty(ps)||(ks.circle.setMap(null),ks.setMap(null),delete c.markers[ps])}},Is=(bs,ps,ks)=>{if(!bs)throw new Error("georef is null");let xs=new google.maps.LatLng(bs.decimalLatitude,bs.decimalLongitude),Ss=new google.maps.Marker({position:xs,map:ps,icon:{path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"lightgrey",fillOpacity:1,strokeColor:"lightgrey"},zIndex:0}),Us=hs(bs.uncertainty,bs.uncertaintyUnit);if(Us){let Ps=new google.maps.Circle({strokeColor:"lightgrey",strokeOpacity:.8,strokeWeight:2,fillColor:"lightgrey",fillOpacity:.2,center:xs,map:ps,radius:Us,clickable:!1,visible:ks});Ss.circle=Ps,google.maps.event.addListener(Ps,"dblclick",function(Qs){google.maps.event.trigger(ps,"dblclick",Qs)})}return Ss.addListener("click",Ps=>{h("georef-selected",bs.georefID)}),Ss.panToMe=Ps=>{ps.panTo(Ss.getPosition())},Ss},_s=bs=>{if(c.markers&&Object.keys(c.markers).length)if(Go){for(let ps of Object.values(c.markers))ps.circle&&ps.circle.setVisible(!1);Go=!1}else{for(let ps of Object.values(c.markers))ps.circle&&ps.circle.setVisible(!0);Go=!0}},Hs=bs=>{Lo&&c.georefIndex&&Object.keys(c.georefIndex).length&&Mo!=c.georefIndex&&(as(),us(),cs())},ds=bs=>!!(window.google&&typeof window.google=="object"&&window.google.maps&&typeof window.google.maps=="object"&&window.google.maps.Map&&typeof window.google.maps.Map=="function"),hs=(bs,ps)=>!isNaN(bs)&&bs>0&&ps&&ps.trim()&&["m","km","mi"].includes(ps.toLowerCase())?(ps=ps.trim().toLowerCase(),ps=="m"?bs:ps=="km"?bs*1e3:Number((bs*1.60934*1e3).toFixed(2))):0,ys=(bs,ps,ks,xs)=>{let Ss;try{Ss=Ko(bs)}catch(Ps){console.error(`error making latLng for ${bs} in makeMarker: ${Ps.message}}`),alert("error moving uncertainty circle, see console");return}return new google.maps.Marker({position:Ss,map:ps,icon:{path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:ks,fillOpacity:1,strokeColor:ks},zIndex:0,title:xs})},ms=(bs,ps,ks,xs,Ss)=>{if(ps&&ks){let Us;try{Us=Ko(bs)}catch(Qs){console.error(`error making latLng for ${bs} in makeCircle: ${Qs.message}}`),alert("error moving uncertainty circle, see console");return}let Ps=hs(ps,ks);return Ps?new google.maps.Circle({strokeColor:Ss,strokeOpacity:.8,strokeWeight:2,fillColor:Ss,fillOpacity:.2,center:Us,map:xs,radius:Ps,clickable:!1}):null}else return null};function Rs(bs){binding_callbacks[bs?"unshift":"push"](()=>{Co=bs,s(0,Co)})}return l.$$.update=()=>{l.$$.dirty[0]&8&&(c.georefIndex,Hs(),gs())},[Co,$o,jo,c,Rs]}class QcGeorefMap extends SvelteComponent{constructor(o){super(),init(this,o,instance$8,create_fragment$8,safe_not_equal,{setMapWithNewGeoref:1,updateGeorefDetails:2},null,[-1,-1])}get setMapWithNewGeoref(){return this.$$.ctx[1]}get updateGeorefDetails(){return this.$$.ctx[2]}}const FirestoreGeorefRecords=Firestore.collection("georefRecords"),findNextGeorefToVerify=async(l,o,s,c,h)=>{if(!l)throw new Error("no datasetID provided to findNextGeorefToVerify");if(!o)throw new Error("no currentUserID provided to findNextGeorefToVerify");let d=FirestoreGeorefRecords.where("datasetIDs","array-contains",l).where("verified","==",!1).where("locked","==",!1).orderBy(FieldPath.documentId());s?(console.log("filtering georefs for user",s),d=d.where("createdByID","==",s)):d=d.where("createdByID","!=",o),c&&h&&(d=d[c](h)),d=d.limit(1);let p;try{p=await d.get()}catch(Co){console.error("Error reading georefRecords:"),console.error(Co);return}if(p.empty)return null;{const Co=p.docs.pop();try{await Firestore.runTransaction(async Bo=>{if((await Bo.get(Co.ref)).data().locked)throw new Error("already locked");await Bo.update(Co.ref,{locked:!0})})}catch(Bo){throw Bo}try{const Bo=await FirestoreGeorefs.doc(Co.id).get();return}catch(Bo){const Lo="Error reading georefBackup: "+Bo.message;throw new Error(Lo)}}},qcGeorefs_svelte_svelte_type_style_lang="",{window:window_1$1}=globals;function create_else_block$2(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo;const Xo=[create_if_block_2$1,create_else_block_2],Zo=[];function Wo(ts,ss){return ts[5]?0:1}c=Wo(l),h=Zo[c]=Xo[c](l);const es=[create_if_block_1$1,create_else_block_1],is=[];function Jo(ts,ss){return ts[6]?0:1}Co=Jo(l),Bo=is[Co]=es[Co](l);let Ko={};Qo=new QcGeorefMap({props:Ko}),l[23](Qo),Qo.$on("new-coords",l[9]),Qo.$on("map-ready",l[24]),Qo.$on("georef-selected",l[16]);let Yo={editable:!1,showVerification:!0,georef:l[7],showResetButton:!1,showSubmitButton:!1};return jo=new GeorefForm({props:Yo}),l[25](jo),jo.$on("georef-flagged",l[13]),{c(){o=element("div"),s=element("div"),h.c(),d=space(),p=element("div"),Bo.c(),Lo=space(),Uo=element("div"),create_component(Qo.$$.fragment),Po=space(),Mo=element("div"),Go=element("h4"),Go.textContent="Georeference",$o=space(),create_component(jo.$$.fragment),attr(s,"class","georef-form-container current-georef-container svelte-2ufc8a"),attr(p,"class","matchlist-container svelte-2ufc8a"),attr(Uo,"class","matchmap-container svelte-2ufc8a"),attr(Go,"class","svelte-2ufc8a"),attr(Mo,"class","georef-form-container similar-georef-container svelte-2ufc8a"),attr(o,"class","grid-container svelte-2ufc8a")},m(ts,ss){insert(ts,o,ss),append(o,s),Zo[c].m(s,null),append(o,d),append(o,p),is[Co].m(p,null),append(o,Lo),append(o,Uo),mount_component(Qo,Uo,null),append(o,Po),append(o,Mo),append(Mo,Go),append(Mo,$o),mount_component(jo,Mo,null),zo=!0},p(ts,ss){let cs=c;c=Wo(ts),c===cs?Zo[c].p(ts,ss):(group_outros(),transition_out(Zo[cs],1,1,()=>{Zo[cs]=null}),check_outros(),h=Zo[c],h?h.p(ts,ss):(h=Zo[c]=Xo[c](ts),h.c()),transition_in(h,1),h.m(s,null));let as=Co;Co=Jo(ts),Co===as?is[Co].p(ts,ss):(group_outros(),transition_out(is[as],1,1,()=>{is[as]=null}),check_outros(),Bo=is[Co],Bo?Bo.p(ts,ss):(Bo=is[Co]=es[Co](ts),Bo.c()),transition_in(Bo,1),Bo.m(p,null));const us={};Qo.$set(us);const gs={};ss[0]&128&&(gs.georef=ts[7]),jo.$set(gs)},i(ts){zo||(transition_in(h),transition_in(Bo),transition_in(Qo.$$.fragment,ts),transition_in(jo.$$.fragment,ts),zo=!0)},o(ts){transition_out(h),transition_out(Bo),transition_out(Qo.$$.fragment,ts),transition_out(jo.$$.fragment,ts),zo=!1},d(ts){ts&&detach(o),Zo[c].d(),is[Co].d(),l[23](null),destroy_component(Qo),l[25](null),destroy_component(jo)}}}function create_if_block$3(l){let o;return{c(){o=element("div"),o.innerHTML='<h4 class="svelte-2ufc8a">No more georeferences to verify for this dataset</h4>',attr(o,"class","center svelte-2ufc8a")},m(s,c){insert(s,o,c)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o)}}}function create_else_block_2(l){let o,s,c;return s=new Loader$1({}),{c(){o=element("div"),create_component(s.$$.fragment),attr(o,"class","center svelte-2ufc8a")},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},p:noop$2,i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function create_if_block_2$1(l){let o,s,c,h,d={georef:l[5],showResetButton:!1,submitButtonText:"Confirm this georeference",showVerification:!0,defaultGeorefBy:l[0].formattedName,defaultGeorefByORCID:l[0].orcid,requiredFields:["verifiedBy","verifiedDate","verifierRole"]};return c=new GeorefForm({props:d}),l[22](c),c.$on("coords-from-paste",l[10]),c.$on("uncertainty-changed",l[11]),c.$on("locality-changed",l[11]),c.$on("georef-flagged",l[13]),c.$on("set-georef",l[12]),{c(){o=element("h4"),o.textContent="Verification",s=space(),create_component(c.$$.fragment),attr(o,"class","svelte-2ufc8a")},m(p,Co){insert(p,o,Co),insert(p,s,Co),mount_component(c,p,Co),h=!0},p(p,Co){const Bo={};Co[0]&32&&(Bo.georef=p[5]),Co[0]&1&&(Bo.defaultGeorefBy=p[0].formattedName),Co[0]&1&&(Bo.defaultGeorefByORCID=p[0].orcid),c.$set(Bo)},i(p){h||(transition_in(c.$$.fragment,p),h=!0)},o(p){transition_out(c.$$.fragment,p),h=!1},d(p){p&&detach(o),p&&detach(s),l[22](null),destroy_component(c,p)}}}function create_else_block_1(l){let o,s,c,h,d,p,Co;return h=new GeorefMatchList({}),h.$on("georef-selected",l[16]),{c(){o=element("h4"),o.textContent="Similar georeferences",s=space(),c=element("div"),create_component(h.$$.fragment),d=space(),p=element("div"),attr(o,"class","svelte-2ufc8a"),attr(c,"class","matchlist-flex svelte-2ufc8a"),attr(p,"class","matchlist-flex-plug svelte-2ufc8a")},m(Bo,Lo){insert(Bo,o,Lo),insert(Bo,s,Lo),insert(Bo,c,Lo),mount_component(h,c,null),insert(Bo,d,Lo),insert(Bo,p,Lo),Co=!0},p:noop$2,i(Bo){Co||(transition_in(h.$$.fragment,Bo),Co=!0)},o(Bo){transition_out(h.$$.fragment,Bo),Co=!1},d(Bo){Bo&&detach(o),Bo&&detach(s),Bo&&detach(c),destroy_component(h),Bo&&detach(d),Bo&&detach(p)}}}function create_if_block_1$1(l){let o,s,c;return s=new Loader$1({}),{c(){o=element("div"),create_component(s.$$.fragment),attr(o,"class","center svelte-2ufc8a")},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},p:noop$2,i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function create_fragment$7(l){let o,s,c,h,d,p,Co,Bo;const Lo=[create_if_block$3,create_else_block$2],Uo=[];function Qo(Po,Mo){return 1}return s=Qo(),c=Uo[s]=Lo[s](l),d=new Toast({}),{c(){o=element("div"),c.c(),h=space(),create_component(d.$$.fragment),attr(o,"class","qcgeoref-container svelte-2ufc8a")},m(Po,Mo){insert(Po,o,Mo),Uo[s].m(o,null),append(o,h),mount_component(d,o,null),p=!0,Co||(Bo=[listen(window_1$1,"beforeunload",l[14]),listen(window_1$1,"unload",l[15]),listen(o,"keyup",l[8])],Co=!0)},p(Po,Mo){c.p(Po,Mo)},i(Po){p||(transition_in(c),transition_in(d.$$.fragment,Po),p=!0)},o(Po){transition_out(c),transition_out(d.$$.fragment,Po),p=!1},d(Po){Po&&detach(o),Uo[s].d(),destroy_component(d),Co=!1,run_all(Bo)}}}let desiredQueueLength=3;function instance$7(l,o,s){let c;component_subscribe(l,dataStore,Es=>s(36,c=Es));const h=Firestore.collection("georefRecords"),d=Firestore.collection("georefBackup");let{profile:p}=o,{dataset:Co}=o,{selectedGeoreferencer:Bo}=o,Lo,Uo=[],Qo=!1,Po,Mo=!1,Go,$o,jo,zo,Xo,Zo=[],Wo=[],es=!1,is,Jo,Ko=!1,Yo,ts;onMount(async Es=>{ts=`verifierDatasetQueuePositions/${p.uid}/${Co.datasetID}`;const fs=await Realtime.ref(ts).once("value");fs.exists()?Yo=fs.val():Yo=null});const ss=async Es=>{for(;!Qo&&Uo.length<desiredQueueLength;){let fs="startAt";jo&&(fs="startAfter");let vs=null;Yo&&(Bo!=null?vs=Yo[Bo.uid]:vs=Yo.all);let Bs;try{let Ls=null;Bo&&(Ls=Bo.uid),Bs=findNextGeorefToVerify(Co.datasetID,Ls,fs,vs)}catch(Ls){console.error(Ls.message);continue}if(Bs||(Qo=!0),querySnap.empty){console.log("no more georefs"),Qo=!0;continue}else{const Ls=querySnap.docs.pop();try{await Firestore.runTransaction(async zs=>{if((await zs.get(Ls.ref)).data().locked)throw new Error;await zs.update(Ls.ref,{locked:!0})})}catch{continue}let Fs;try{Fs=await d.doc(Ls.id).get()}catch(zs){console.error("Error reading georefBackup"),console.error(zs);return}if(Fs.exists){const zs=Fs.data(),js=Object.assign(new Georef,zs);jo?(s(21,Uo=[...Uo,js]),Wo=[...Wo,cs(js.locality)]):(s(5,jo=js),Po.setMapWithNewGeoref(jo),Ko=!1,Zo=[],zo=as(js),s(6,es=!0),Jo=await cs(js.locality),delete Jo[js.georefID],s(6,es=!1),set_store_value(dataStore,c.georefIndex=Jo,c))}}}},cs=async Es=>{Es=Es.replace(/(alt|elev)[:;\.]{0,1}\s+\d+(m|ft|f)/i,"").trim();let fs;try{fs=await fetchGeorefsForLoc(Es,Lo,20,!1)}catch(vs){console.error(vs),alert("error fetching similar georeferences, see console");return}if(fs.length){let vs={};for(let Bs of fs){let Ls=Object.assign(new Georef,Bs._source);vs[Ls.georefID]=Ls}return vs}else return{}},as=Es=>{const fs={locality:Es.locality,decimalCoordinates:Es.decimalCoordinates,by:Es.by,date:Es.date,sources:Es.sources,protocol:Es.protocol};return Es.uncertaintyUnit&&Es.uncertainty?fs.uncertainty=`${Es.uncertainty}${Es.uncertaintyUnit}`:fs.uncertainty=null,fs},us=async Es=>{await bs(),s(5,jo=null),Ko=!1,Zo=[],zo=null,s(21,Uo=[]),ss()},gs=Es=>{Es.code=="KeyZ"&&(Es.ctrlKey||Es.metaKey)&&Zo.length&&Po.updateGeorefDetails(Zo.pop())},Is=Es=>{const fs={decimalCoordinates:Es.detail};Zo.push(Xo),Xo=fs,s(5,jo.decimalCoordinates=Es.detail,jo),Ko=!0},_s=Es=>{const fs={decimalCoordinates:Es.detail};Zo.push(Xo),Xo=fs,Po.updateGeorefDetails(Xo),Ko=!0},Hs=Es=>{let fs=Es.detail;Zo.push(Xo),Xo=fs,Po.updateGeorefDetails(Xo),Object.assign(jo,Xo),Ko=!0},ds=(Es,fs,vs)=>new Promise(Bs=>{Es.toBlob(Ls=>{Bs(Ls)},fs,vs)}),hs=async(Es,fs)=>{let vs=null;if(!Es.ambiguous){const Fs=await ds(fs,"image/jpeg",.95);let zs;try{zs=await Storage.ref().child(`verificationImages/${Es.georefID}.jpg`).put(Fs)}catch(js){console.error(js),alert("Error saving map image file, see console");return}vs=await zs.ref.getDownloadURL()}const Bs={datasetID:Co.datasetID,georefID:Es.georefID,georefAmbiguous:Es.ambiguous,georeferencerID:Es.createdByID,imageURL:vs,reviewerID:p.uid,georefVals:zo,feedbackMessage:Es.verificationRemarks};try{await Firestore.collection("verificationFeedback").doc(Es.georefID).set(Bs)}catch(Fs){console.error(Fs),alert("Error saving feedback record for previous georef, see console");return}const Ls={};Ls[`georefVerificationFeedback/${Co.datasetID}/${p.uid}/all`]=ServerValue.increment(1),Ls[`georefVerificationFeedback/${Co.datasetID}/${p.uid}/${Es.createdByID}`]=ServerValue.increment(1);try{await Realtime.ref().update(Ls)}catch(Fs){console.error(Fs),alert("error updating feedback counts, see console");return}window.pushToast?window.pushToast("feedback saved"):console.log("feedback saved")},ys=async Es=>{const fs="https://us-central1-georef-745b9.cloudfunctions.net/updategeoref";let vs;try{let Bs=await Auth$1.currentUser.getIdToken(!0);vs=await fetch(fs,{method:"POST",headers:{Authorization:Bs,"Content-Type":"application/json"},body:JSON.stringify({georef:Es,index:Lo})})}catch(Bs){console.error(Bs),alert("Oops, something went wrong while trying to save georef with ID "+Es.georefID+", see the console");return}if(vs.ok)try{const Bs=h.doc(Es.georefID).update({verified:!0,locked:!1}),Ls=d.doc(Es.georefID).set(Es);await Promise.all([Bs,Ls]),console.log("georef",Es.georefID,"successfully verified")}catch(Bs){alert("Oops, something went wrong with the georef verification update to Firestore for georef with ID "+Es.georefID+": "+Bs.message)}else alert("Oops, something went wrong while trying to save georef with ID"+Es.georefID+": "+vs.statusText)},ms=async Es=>{let fs=Es.detail;if(console.log(fs),!fs.ambiguous&&!fs.verified){alert("verifiedBy, verifiedDate, and verifierRole must be added in order to verify this georeference");return}let vs;if(fs.sendVerificationFeedback&&fs.verificationRemarks){let Fs=null;Ko&&(Fs=await html2canvas(Po)),vs=hs(fs,Fs)}let Bs=null;fs.verified&&(Bs=ys(fs)),Us();let Ls=[];if(vs&&Ls.push(vs),Bs&&Ls.push(Bs),Ls.length){try{await Promise.all(Ls)}catch(Fs){console.error(Fs),alert("There was an error saving feedback or verification, see the console");return}window.pushToast?window.pushToast("last georef updated"):console.log("last georef verification updated successfully")}},Rs=async Es=>{const fs=Es.detail;try{await flagGeoref(fs,Lo)}catch(vs){console.error(vs),alert("there was an error flagging the georef, see console");return}},bs=async Es=>{if(Uo.length||jo){let fs=[];if(jo){const vs=h.doc(jo.georefID).update({locked:!1});fs.push(vs)}for(let vs of Uo){const Bs=h.doc(vs.georefID).update({locked:!1});fs.push(Bs)}await Promise.all(fs)}},ps=Es=>{if(Ko)return Es.preventDefault(),Es.returnValue="the string is not used but is required","the string is not used by is required"},ks=Es=>{bs()},xs=Es=>{if(c.selectedGeorefID&&Ss(c.selectedGeorefID),Es&&Es.detail){let fs=Es.detail;set_store_value(dataStore,c.georefIndex[fs].selected=!0,c),s(7,is=c.georefIndex[fs]),is.ambiguous&&s(4,$o.scrollTop=0,$o);let vs=c.markers[fs];vs&&(vs.setIcon({path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"grey",fillOpacity:1,strokeColor:"grey"}),vs.circle&&vs.circle.setOptions({strokeColor:"grey"}),vs.setZIndex(1),vs.panToMe()),set_store_value(dataStore,c.selectedGeorefID=fs,c),set_store_value(dataStore,c.georefIndex=c.georefIndex,c)}},Ss=Es=>{let fs=c.markers[Es];fs&&(fs.setIcon({path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:"lightgrey",fillOpacity:1,strokeColor:"lightgrey"}),fs.circle&&fs.circle.setOptions({strokeColor:"lightgrey"}),fs.setZIndex(0)),c.georefIndex[Es]&&set_store_value(dataStore,c.georefIndex[Es].selected=!1,c),set_store_value(dataStore,c.selectedGeorefID=null,c)},Us=async Es=>{if(Uo.length){s(5,jo=Uo.shift()),s(3,Go.scrollTop=0,Go),Po.setMapWithNewGeoref(jo),Ko=!1,Zo=[],zo=as(jo),Yo?Bo.value?(Yo[Bo.value]=jo.georefID,Realtime.ref(ts).child(Bo.value).set(jo.georefID)):(Yo.all=jo.georefID,Realtime.ref(ts).child("all").set(jo.georefID)):Bo.value?(Yo={[Bo.value]:jo.georefID},Realtime.ref(ts).child(Bo.value).set(jo.georefID)):(Yo={all:jo.georefID},Realtime.ref(ts).child("all").set(jo.georefID));let fs=Wo.shift();s(6,es=!0),setTimeout(async vs=>{Jo=await fs,set_store_value(dataStore,c.georefIndex=Jo,c),s(6,es=!1)},100)}ss()},Ps=Es=>{jo&&(jo.flagged||h.doc(jo.georefID).update({locked:!1}),Us())},Qs=Es=>{console.log("running reset queue position"),Yo&&(Bo.value?(delete Yo[Bo.value],Realtime.ref(ts).child(Bo.value).remove()):(delete Yo.all,Realtime.ref(ts).child("all").remove())),us()};onDestroy(bs);function Js(Es){binding_callbacks[Es?"unshift":"push"](()=>{Go=Es,s(3,Go)})}function qs(Es){binding_callbacks[Es?"unshift":"push"](()=>{Po=Es,s(1,Po)})}const Gs=Es=>s(2,Mo=!0);function Zs(Es){binding_callbacks[Es?"unshift":"push"](()=>{$o=Es,s(4,$o)})}return l.$$set=Es=>{"profile"in Es&&s(0,p=Es.profile),"dataset"in Es&&s(17,Co=Es.dataset),"selectedGeoreferencer"in Es&&s(18,Bo=Es.selectedGeoreferencer)},l.$$.update=()=>{l.$$.dirty[0]&131072&&Co&&(Lo=(Co.region+Co.domain).toLowerCase().replace(/\s+/g,"")),l.$$.dirty[0]&262144&&Bo&&(console.log("fetching georefs on selectedGeoreferencer change..."),us()),l.$$.dirty[0]&2097152&&(Uo.length?console.log("georef queue has",Uo.length,"georefs"):console.log("no georefs in georef queue"))},[p,Po,Mo,Go,$o,jo,es,is,gs,Is,_s,Hs,ms,Rs,ps,ks,xs,Co,Bo,Ps,Qs,Uo,Js,qs,Gs,Zs]}class QcGeorefs extends SvelteComponent{constructor(o){super(),init(this,o,instance$7,create_fragment$7,safe_not_equal,{profile:0,dataset:17,selectedGeoreferencer:18,skipCurrentGeoref:19,resetQueuePosition:20},null,[-1,-1])}get skipCurrentGeoref(){return this.$$.ctx[19]}get resetQueuePosition(){return this.$$.ctx[20]}}const Dialog_svelte_svelte_type_style_lang="";function create_if_block$2(l){let o,s,c;return{c(){o=element("textarea"),attr(o,"class","svelte-1v95nir")},m(h,d){insert(h,o,d),set_input_value(o,l[2]),s||(c=listen(o,"input",l[7]),s=!0)},p(h,d){d&4&&set_input_value(o,h[2])},d(h){h&&detach(o),s=!1,c()}}}function create_fragment$6(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo=l[1]&&create_if_block$2(l);return{c(){o=element("h4"),s=text(l[0]),c=space(),Qo&&Qo.c(),h=space(),d=element("div"),p=element("button"),p.textContent="Cancel",Co=space(),Bo=element("button"),Bo.textContent="Okay",attr(o,"class","svelte-1v95nir"),attr(d,"class","buttons svelte-1v95nir")},m(Po,Mo){insert(Po,o,Mo),append(o,s),insert(Po,c,Mo),Qo&&Qo.m(Po,Mo),insert(Po,h,Mo),insert(Po,d,Mo),append(d,p),append(d,Co),append(d,Bo),Lo||(Uo=[listen(p,"click",l[3]),listen(Bo,"click",l[4])],Lo=!0)},p(Po,[Mo]){Mo&1&&set_data(s,Po[0]),Po[1]?Qo?Qo.p(Po,Mo):(Qo=create_if_block$2(Po),Qo.c(),Qo.m(h.parentNode,h)):Qo&&(Qo.d(1),Qo=null)},i:noop$2,o:noop$2,d(Po){Po&&detach(o),Po&&detach(c),Qo&&Qo.d(Po),Po&&detach(h),Po&&detach(d),Lo=!1,run_all(Uo)}}}function instance$6(l,o,s){let{message:c}=o,{hasForm:h=!1}=o,{onCancel:d=()=>{}}=o,{onOkay:p=()=>{}}=o;const{close:Co}=getContext("simple-modal");let Bo;function Lo(){d(),Co()}function Uo(){p(Bo),Co()}function Qo(){Bo=this.value,s(2,Bo)}return l.$$set=Po=>{"message"in Po&&s(0,c=Po.message),"hasForm"in Po&&s(1,h=Po.hasForm),"onCancel"in Po&&s(5,d=Po.onCancel),"onOkay"in Po&&s(6,p=Po.onOkay)},[c,h,Bo,Lo,Uo,d,p,Qo]}class Dialog extends SvelteComponent{constructor(o){super(),init(this,o,instance$6,create_fragment$6,safe_not_equal,{message:0,hasForm:1,onCancel:5,onOkay:6})}}const qualityControl_svelte_svelte_type_style_lang="";function create_else_block$1(l){let o;return{c(){o=element("div"),o.textContent="under construction..."},m(s,c){insert(s,o,c)},p:noop$2,i:noop$2,o:noop$2,d(s){s&&detach(o)}}}function create_if_block$1(l){let o,s,c={profile:l[0],dataset:l[1],selectedGeoreferencer:l[2]};return o=new QcGeorefs({props:c}),l[15](o),{c(){create_component(o.$$.fragment)},m(h,d){mount_component(o,h,d),s=!0},p(h,d){const p={};d&1&&(p.profile=h[0]),d&2&&(p.dataset=h[1]),d&4&&(p.selectedGeoreferencer=h[2]),o.$set(p)},i(h){s||(transition_in(o.$$.fragment,h),s=!0)},o(h){transition_out(o.$$.fragment,h),s=!1},d(h){l[15](null),destroy_component(o,h)}}}function create_fragment$5(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po=l[1].datasetName+"",Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,Hs;function ds(bs){l[14](bs)}let hs={items:l[6]};l[2]!==void 0&&(hs.value=l[2]),Jo=new Select({props:hs}),binding_callbacks.push(()=>bind(Jo,"value",ds));const ys=[create_if_block$1,create_else_block$1],ms=[];function Rs(bs,ps){return bs[3]=="georefs"?0:1}return us=Rs(l),gs=ms[us]=ys[us](l),{c(){o=element("div"),s=element("div"),c=element("button"),c.innerHTML='<span class="material-icons">list</span>',h=space(),d=element("button"),d.innerHTML='<span class="material-icons">low_priority</span>',p=space(),Co=element("button"),Co.innerHTML='<span class="material-icons">skip_next</span>',Bo=space(),Lo=element("div"),Uo=element("h4"),Qo=text("Quality control for "),Mo=text(Po),Go=space(),$o=element("div"),jo=element("div"),zo=element("div"),zo.textContent="Georeferences",Xo=space(),Zo=element("div"),Zo.textContent="Species",Wo=space(),es=element("div"),is=element("div"),create_component(Jo.$$.fragment),Yo=space(),ts=element("button"),ss=text("Send feedback"),cs=space(),as=element("div"),gs.c(),attr(c,"class","dataset-tool svelte-14kr7zm"),attr(c,"title","back to datasets"),attr(d,"class","dataset-tool svelte-14kr7zm"),attr(d,"title","restart queue"),attr(Co,"class","dataset-tool svelte-14kr7zm"),attr(Co,"title","skip this validation"),attr(s,"class","tools-container svelte-14kr7zm"),attr(zo,"class","tab svelte-14kr7zm"),toggle_class(zo,"tab-selected",l[3]=="georefs"),attr(Zo,"class","tab svelte-14kr7zm"),toggle_class(Zo,"tab-selected",l[3]=="species"),attr(jo,"class","tabs svelte-14kr7zm"),attr(is,"class","svelte-select svelte-14kr7zm"),attr(ts,"class","feedback-button svelte-14kr7zm"),ts.disabled=l[4],attr(es,"class","georeferencer-controls svelte-14kr7zm"),attr($o,"class","controls svelte-14kr7zm"),attr(as,"class","working-area svelte-14kr7zm"),attr(o,"class","qc-container svelte-14kr7zm")},m(bs,ps){insert(bs,o,ps),append(o,s),append(s,c),append(s,h),append(s,d),append(s,p),append(s,Co),append(o,Bo),append(o,Lo),append(Lo,Uo),append(Uo,Qo),append(Uo,Mo),append(Lo,Go),append(Lo,$o),append($o,jo),append(jo,zo),append(jo,Xo),append(jo,Zo),append($o,Wo),append($o,es),append(es,is),mount_component(Jo,is,null),append(es,Yo),append(es,ts),append(ts,ss),append(o,cs),append(o,as),ms[us].m(as,null),Is=!0,_s||(Hs=[listen(c,"click",l[10]),listen(d,"click",l[9]),listen(Co,"click",l[8]),listen(zo,"click",l[12]),listen(Zo,"click",l[13]),listen(ts,"click",l[7])],_s=!0)},p(bs,[ps]){(!Is||ps&2)&&Po!==(Po=bs[1].datasetName+"")&&set_data(Mo,Po),ps&8&&toggle_class(zo,"tab-selected",bs[3]=="georefs"),ps&8&&toggle_class(Zo,"tab-selected",bs[3]=="species");const ks={};!Ko&&ps&4&&(Ko=!0,ks.value=bs[2],add_flush_callback(()=>Ko=!1)),Jo.$set(ks),(!Is||ps&16)&&(ts.disabled=bs[4]);let xs=us;us=Rs(bs),us===xs?ms[us].p(bs,ps):(group_outros(),transition_out(ms[xs],1,1,()=>{ms[xs]=null}),check_outros(),gs=ms[us],gs?gs.p(bs,ps):(gs=ms[us]=ys[us](bs),gs.c()),transition_in(gs,1),gs.m(as,null))},i(bs){Is||(transition_in(Jo.$$.fragment,bs),transition_in(gs),Is=!0)},o(bs){transition_out(Jo.$$.fragment,bs),transition_out(gs),Is=!1},d(bs){bs&&detach(o),destroy_component(Jo),ms[us].d(),_s=!1,run_all(Hs)}}}function instance$5(l,o,s){const c=createEventDispatcher(),{open:h}=getContext("simple-modal");let{profile:d}=o,{dataset:p}=o,Co="georefs",Bo={},Lo=[],Uo,Qo=!1,Po=null,Mo;onMount(async Ko=>{const Yo=Firestore.collection("userProfiles");let ts=[];for(let cs of p.georeferencers)cs!=d.uid&&ts.push(Yo.doc(cs).get());if(p.pastGeoreferencers&&p.pastGeoreferencers.length)for(let cs of p.pastGeoreferencers)ts.push(Yo.doc(cs).get());let ss=await Promise.all(ts);for(let cs of ss)if(cs.exists){const as=cs.data();let us={value:as.uid,label:as.formattedName};Lo.push(us),Bo[as.uid]=as}Lo.unshift({value:null,label:"all"}),console.log("setting initial selectedGeoreferencer"),s(2,Uo=Lo[0]),Realtime.ref(`georefVerificationFeedback/${p.datasetID}/${d.uid}`).on("value",cs=>{cs.exists()?s(11,Po=cs.value()):(s(11,Po={}),s(4,Qo=!0))})});const Go=Ko=>{Uo.value?Po[Uo.value]?s(4,Qo=!1):s(4,Qo=!0):Po&&Po.all&&s(4,Qo=!1)},$o=async Ko=>{if(!Ko||!Ko.trim()){alert("A feedback message is required");return}Uo.value?s(11,Po[Uo.value]=0,Po):s(11,Po.all=0,Po),s(4,Qo=!0);let Yo="https://us-central1-georef-745b9.cloudfunctions.net/sendfeedback",ts={message:Ko};Uo.value&&(ts.georeferencerID=Uo.value),ts.reviewerID=d.uid,ts.datasetID=p.datasetID;let ss;try{let cs=await Auth.currentUser.getIdToken(!0);ss=await fetch(Yo,{method:"POST",headers:{Authorization:cs,"Content-Type":"application/json"},body:JSON.stringify(ts)})}catch(cs){console.error(cs),alert("Oops, something went wrong with calling the sendfeedback API, see the console");return}ss.ok||alert("There was an issue calling the sendfeedback API with statusText",ss.statusText)},jo=Ko=>{let Yo="";Uo.value?Yo="Send a general feedback message to "+Bo[Uo.value].firstName:Yo="Send a general feedback message to all",h(Dialog,{message:Yo,hasForm:!0,onCancel,onOkay:$o},{closeButton:!1,closeOnEsc:!1,closeOnOuterClick:!1})},zo=Ko=>{Mo&&Mo.skipCurrentGeoref()},Xo=Ko=>{Mo&&Mo.resetQueuePosition()},Zo=Ko=>{c("to-datasets")},Wo=Ko=>s(3,Co="georefs"),es=Ko=>s(3,Co="species");function is(Ko){Uo=Ko,s(2,Uo)}function Jo(Ko){binding_callbacks[Ko?"unshift":"push"](()=>{Mo=Ko,s(5,Mo)})}return l.$$set=Ko=>{"profile"in Ko&&s(0,d=Ko.profile),"dataset"in Ko&&s(1,p=Ko.dataset)},l.$$.update=()=>{l.$$.dirty&2052&&(Po||Uo)&&Go()},[d,p,Uo,Co,Qo,Mo,Lo,jo,zo,Xo,Zo,Po,Wo,es,is,Jo]}class QualityControl extends SvelteComponent{constructor(o){super(),init(this,o,instance$5,create_fragment$5,safe_not_equal,{profile:0,dataset:1})}}const georefStat_svelte_svelte_type_style_lang="";function create_fragment$4(l){let o,s,c,h,d,p=(isNaN(l[1])||l[1]<1e9?l[1]:l[4](l[1]))+"",Co,Bo,Lo;return{c(){o=element("span"),s=element("span"),c=text(l[0]),h=text(":"),d=element("span"),Co=text(p),attr(s,"class","label svelte-zfdtt1"),attr(d,"class","svelte-zfdtt1"),attr(o,"class","base ping svelte-zfdtt1")},m(Uo,Qo){insert(Uo,o,Qo),append(o,s),append(s,c),append(s,h),append(o,d),append(d,Co),l[6](o),Bo||(Lo=listen(o,"transitionend",l[3]),Bo=!0)},p(Uo,[Qo]){Qo&1&&set_data(c,Uo[0]),Qo&2&&p!==(p=(isNaN(Uo[1])||Uo[1]<1e9?Uo[1]:Uo[4](Uo[1]))+"")&&set_data(Co,p)},i:noop$2,o:noop$2,d(Uo){Uo&&detach(o),l[6](null),Bo=!1,Lo()}}}function instance$4(l,o,s){let{labelText:c}=o,{stat:h}=o,{isGeoref:d}=o,p=["#c3c388","#77b300"],Co=["#ff944d","#cc5200"],Bo;onMount(Mo=>{Bo.classList.remove("ping"),d?(s(2,Bo.style.backgroundColor=Co[0],Bo),s(2,Bo.style.color=Co[0],Bo)):(s(2,Bo.style.backgroundColor=p[0],Bo),s(2,Bo.style.color=p[0],Bo))});function Lo(){h!=null&&h!=null&&Bo&&(Bo.classList.add("ping"),d?(s(2,Bo.style.backgroundColor=Co[1],Bo),s(2,Bo.style.color=Co[1],Bo)):(s(2,Bo.style.backgroundColor=p[1],Bo),s(2,Bo.style.color=p[1],Bo)))}const Uo=Mo=>{Bo.classList.contains("ping")&&Bo.classList.remove("ping"),d?(s(2,Bo.style.backgroundColor=Co[0],Bo),s(2,Bo.style.color=Co[0],Bo)):(s(2,Bo.style.backgroundColor=p[0],Bo),s(2,Bo.style.color=p[0],Bo))},Qo=Mo=>{let Go=new Date(Mo);return new Date(Go.getTime()-Go.getTimezoneOffset()*60*1e3).toISOString().split(".")[0].replace("T"," ")};function Po(Mo){binding_callbacks[Mo?"unshift":"push"](()=>{Bo=Mo,s(2,Bo)})}return l.$$set=Mo=>{"labelText"in Mo&&s(0,c=Mo.labelText),"stat"in Mo&&s(1,h=Mo.stat),"isGeoref"in Mo&&s(5,d=Mo.isGeoref)},l.$$.update=()=>{l.$$.dirty&2&&Lo()},[c,h,Bo,Uo,Qo,d,Po]}class GeorefStat extends SvelteComponent{constructor(o){super(),init(this,o,instance$4,create_fragment$4,safe_not_equal,{labelText:0,stat:1,isGeoref:5})}}const georefStats_svelte_svelte_type_style_lang="";function get_each_context(l,o,s){const c=l.slice();return c[12]=o[s],c[14]=s,c}function create_each_block(l){let o,s;return o=new GeorefStat({props:{stat:l[12],labelText:l[1][l[14]],isGeoref:!l[0][l[14]].toLowerCase().includes("record")}}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h&8&&(d.stat=c[12]),h&2&&(d.labelText=c[1][c[14]]),h&1&&(d.isGeoref=!c[0][c[14]].toLowerCase().includes("record")),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_fragment$3(l){let o,s,c=l[2].replace(/:+$/g,"")+"",h,d,p,Co,Bo=l[3],Lo=[];for(let Qo=0;Qo<Bo.length;Qo+=1)Lo[Qo]=create_each_block(get_each_context(l,Bo,Qo));const Uo=Qo=>transition_out(Lo[Qo],1,1,()=>{Lo[Qo]=null});return{c(){o=element("div"),s=element("span"),h=text(c),d=text(":"),p=space();for(let Qo=0;Qo<Lo.length;Qo+=1)Lo[Qo].c();attr(s,"class","svelte-1vrid8p"),attr(o,"class","container svelte-1vrid8p")},m(Qo,Po){insert(Qo,o,Po),append(o,s),append(s,h),append(s,d),append(o,p);for(let Mo=0;Mo<Lo.length;Mo+=1)Lo[Mo].m(o,null);Co=!0},p(Qo,[Po]){if((!Co||Po&4)&&c!==(c=Qo[2].replace(/:+$/g,"")+"")&&set_data(h,c),Po&11){Bo=Qo[3];let Mo;for(Mo=0;Mo<Bo.length;Mo+=1){const Go=get_each_context(Qo,Bo,Mo);Lo[Mo]?(Lo[Mo].p(Go,Po),transition_in(Lo[Mo],1)):(Lo[Mo]=create_each_block(Go),Lo[Mo].c(),transition_in(Lo[Mo],1),Lo[Mo].m(o,null))}for(group_outros(),Mo=Bo.length;Mo<Lo.length;Mo+=1)Uo(Mo);check_outros()}},i(Qo){if(!Co){for(let Po=0;Po<Bo.length;Po+=1)transition_in(Lo[Po]);Co=!0}},o(Qo){Lo=Lo.filter(Boolean);for(let Po=0;Po<Lo.length;Po+=1)transition_out(Lo[Po]);Co=!1},d(Qo){Qo&&detach(o),destroy_each(Lo,Qo)}}}function instance$3(l,o,s){let{Firebase:c}=o,{statsRefStrings:h=[]}=o,{statsLabels:d=[]}=o,{descriptor:p}=o,Co=[];const Bo=$o=>{$o=new Date(Date.UTC($o.getFullYear(),$o.getMonth(),$o.getDate())),$o.setUTCDate($o.getUTCDate()+4-($o.getUTCDay()||7));var jo=new Date(Date.UTC($o.getUTCFullYear(),0,1)),zo=Math.ceil((($o-jo)/864e5+1)/7);return`${$o.getUTCFullYear()} ${zo.toString().padStart(2,"0")}`},Lo=$o=>{let jo=$o.getUTCFullYear(),zo=$o.getMonth()+1;return`${jo} ${zo.toString().padStart(2,"0")}`};let Uo=new Date,Qo=Lo(Uo),Po=Bo(Uo),Mo=new Date(Uo.getTime()-Uo.getTimezoneOffset()*60*1e3).toISOString().split("T")[0];function Go(){s(3,Co=[]);for(let[$o,jo]of h.entries())jo=jo.replace("yearweek",Po).replace("yearmonth",Qo).replace("today",Mo),c.ref(jo).on("value",zo=>{let Xo=zo.val();Xo?s(3,Co[$o]=Xo,Co):s(3,Co[$o]=0,Co)})}return l.$$set=$o=>{"Firebase"in $o&&s(4,c=$o.Firebase),"statsRefStrings"in $o&&s(0,h=$o.statsRefStrings),"statsLabels"in $o&&s(1,d=$o.statsLabels),"descriptor"in $o&&s(2,p=$o.descriptor)},l.$$.update=()=>{l.$$.dirty&17&&c&&h&&h.length&&Go()},[h,d,p,Co,c]}class GeorefStats extends SvelteComponent{constructor(o){super(),init(this,o,instance$3,create_fragment$3,safe_not_equal,{Firebase:4,statsRefStrings:0,statsLabels:1,descriptor:2})}}function create_fragment$2(l){let o,s,c;return s=new GeorefStats({props:{Firebase:Realtime,statsRefStrings:l[0],statsLabels:l[1],descriptor:"Georef stats:"}}),{c(){o=element("div"),create_component(s.$$.fragment)},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},p:noop$2,i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function instance$2(l,o,s){let{profile:c}=o,h=[`stats/perUser/${c.uid}/georefsAdded`,`stats/perUser/${c.uid}/recordsGeoreferenced`,"stats/georefsAdded","stats/recordsGeoreferenced","stats/lastGeorefAdded","stats/lastGeorefAddedBy"],d=["My georefs","My records","Total georefs","Total records","Last georef","Last georef by"];return l.$$set=p=>{"profile"in p&&s(2,c=p.profile)},[h,d,c]}class OverallStats extends SvelteComponent{constructor(o){super(),init(this,o,instance$2,create_fragment$2,safe_not_equal,{profile:2})}}function create_fragment$1(l){let o,s,c;return s=new GeorefStats({props:{Firebase:Realtime,statsRefStrings:l[1],statsLabels:l[2],descriptor:l[0].datasetName}}),{c(){o=element("div"),create_component(s.$$.fragment)},m(h,d){insert(h,o,d),mount_component(s,o,null),c=!0},p(h,[d]){const p={};d&1&&(p.descriptor=h[0].datasetName),s.$set(p)},i(h){c||(transition_in(s.$$.fragment,h),c=!0)},o(h){transition_out(s.$$.fragment,h),c=!1},d(h){h&&detach(o),destroy_component(s)}}}function instance$1(l,o,s){let{dataset:c}=o,{profile:h}=o,d=[`stats/perDataset/${c.datasetID}/perUser/${h.uid}/georefsAdded`,`stats/perDataset/${c.datasetID}/perUser/${h.uid}/recordsGeoreferenced`,`stats/perDataset/${c.datasetID}/perUser/${h.uid}/daily/today/georefsAdded`,`stats/perDataset/${c.datasetID}/perUser/${h.uid}/daily/today/recordsGeoreferenced`,`stats/perDataset/${c.datasetID}/perUser/${h.uid}/weekly/yearweek/georefsAdded`,`stats/perDataset/${c.datasetID}/perUser/${h.uid}/weekly/yearweek/recordsGeoreferenced`,`stats/perDataset/${c.datasetID}/perUser/${h.uid}/monthly/yearmonth/georefsAdded`,`stats/perDataset/${c.datasetID}/perUser/${h.uid}/monthly/yearmonth/recordsGeoreferenced`,`stats/perDataset/${c.datasetID}/daily/today/georefsAdded`,`stats/perDataset/${c.datasetID}/daily/today/recordsGeoreferenced`,`stats/perDataset/${c.datasetID}/weekly/yearweek/georefsAdded`,`stats/perDataset/${c.datasetID}/weekly/yearweek/recordsGeoreferenced`,`stats/perDataset/${c.datasetID}/monthly/yearmonth/georefsAdded`,`stats/perDataset/${c.datasetID}/monthly/yearmonth/recordsGeoreferenced`,`stats/perDataset/${c.datasetID}/georefsAdded`,`stats/perDataset/${c.datasetID}/recordsGeoreferenced`,`stats/perDataset/${c.datasetID}/lastGeorefAdded`,`stats/perDataset/${c.datasetID}/lastGeorefAddedBy`],p=["My total georefs","My total records","My georefs today","My records today","My georefs this week","My records this week","My georefs this month","My records this month","All georefs today","All records today","All georefs this week","All records this week","All georefs this month","All records this month","Total georefs","Total records","Last georef","Last georef by"];return l.$$set=Co=>{"dataset"in Co&&s(0,c=Co.dataset),"profile"in Co&&s(3,h=Co.profile)},[c,d,p,h]}class DatasetStats extends SvelteComponent{constructor(o){super(),init(this,o,instance$1,create_fragment$1,safe_not_equal,{dataset:0,profile:3})}}const App_svelte_svelte_type_style_lang="",{window:window_1}=globals;function create_else_block(l){let o,s,c,h=l[0].firstName+"",d,p,Co=l[0].lastName+"",Bo,Lo,Uo,Qo,Po;return{c(){o=element("div"),s=element("span"),c=text("Logged in as "),d=text(h),p=space(),Bo=text(Co),Lo=space(),Uo=element("button"),Uo.innerHTML="<strong>Sign Out</strong>",set_style(s,"margin-right","10px"),attr(Uo,"class","svelte-19yeodk"),attr(o,"class","header-right svelte-19yeodk")},m(Mo,Go){insert(Mo,o,Go),append(o,s),append(s,c),append(s,d),append(s,p),append(s,Bo),append(o,Lo),append(o,Uo),Qo||(Po=listen(Uo,"click",l[15]),Qo=!0)},p(Mo,Go){Go[0]&1&&h!==(h=Mo[0].firstName+"")&&set_data(d,h),Go[0]&1&&Co!==(Co=Mo[0].lastName+"")&&set_data(Bo,Co)},i:noop$2,o:noop$2,d(Mo){Mo&&detach(o),Qo=!1,Po()}}}function create_if_block_19(l){let o,s,c,h,d,p;return{c(){o=element("div"),s=element("button"),s.innerHTML="<strong>Register</strong>",c=space(),h=element("button"),h.innerHTML="<strong>Sign In</strong>",attr(s,"class","signin svelte-19yeodk"),attr(h,"class","svelte-19yeodk"),attr(o,"class","header-right svelte-19yeodk")},m(Co,Bo){insert(Co,o,Bo),append(o,s),append(o,c),append(o,h),d||(p=[listen(s,"click",l[27]),listen(h,"click",l[28])],d=!0)},p:noop$2,i:noop$2,o:noop$2,d(Co){Co&&detach(o),d=!1,run_all(p)}}}function create_if_block_18(l){let o,s;return o=new Circle({props:{size:"1.5",color:"#1d4a9c",unit:"em"}}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_15(l){let o,s,c,h,d,p;const Co=[create_if_block_16,create_if_block_17],Bo=[];function Lo(Uo,Qo){return(o==null||Qo[0]&1032)&&(o=!!(Uo[10]&&["Georeferencer","DatasetDetail"].includes(Uo[3]))),o?0:((s==null||Qo[0]&8)&&(s=!!["Home","DatasetList"].includes(Uo[3])),s?1:-1)}return~(c=Lo(l,[-1,-1]))&&(h=Bo[c]=Co[c](l)),{c(){h&&h.c(),d=empty$1()},m(Uo,Qo){~c&&Bo[c].m(Uo,Qo),insert(Uo,d,Qo),p=!0},p(Uo,Qo){let Po=c;c=Lo(Uo,Qo),c===Po?~c&&Bo[c].p(Uo,Qo):(h&&(group_outros(),transition_out(Bo[Po],1,1,()=>{Bo[Po]=null}),check_outros()),~c?(h=Bo[c],h?h.p(Uo,Qo):(h=Bo[c]=Co[c](Uo),h.c()),transition_in(h,1),h.m(d.parentNode,d)):h=null)},i(Uo){p||(transition_in(h),p=!0)},o(Uo){transition_out(h),p=!1},d(Uo){~c&&Bo[c].d(Uo),Uo&&detach(d)}}}function create_if_block_17(l){let o,s;return o=new OverallStats({props:{profile:l[0]}}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&1&&(d.profile=c[0]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_16(l){let o,s;return o=new DatasetStats({props:{profile:l[0],dataset:l[10]}}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&1&&(d.profile=c[0]),h[0]&1024&&(d.dataset=c[10]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_14(l){let o,s;return o=new SignUp({}),o.$on("user-sign-in",l[14]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_13(l){let o,s;return o=new SignIn({}),o.$on("to-forgot-pwd",l[29]),o.$on("user-sign-in",l[14]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_12(l){let o,s;return o=new SignInForgotPwd({props:{Auth:Auth$1}}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_11(l){let o,s;return o=new SignInPwdReset({props:{Auth:Auth$1,code:l[4]}}),o.$on("to-sign-in",l[30]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&16&&(d.code=c[4]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_10(l){let o,s;return o=new About({}),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_9(l){let o,s,c={profile:l[0],fileMIMETypes:["text/csv","application/vnd.ms-excel"]};return o=new Home({props:c}),l[31](o),o.$on("to-about",l[13]),o.$on("file-selected",l[16]),o.$on("to-datasets",l[22]),{c(){create_component(o.$$.fragment)},m(h,d){mount_component(o,h,d),s=!0},p(h,d){const p={};d[0]&1&&(p.profile=h[0]),o.$set(p)},i(h){s||(transition_in(o.$$.fragment,h),s=!0)},o(h){transition_out(o.$$.fragment,h),s=!1},d(h){l[31](null),destroy_component(o,h)}}}function create_if_block_8(l){let o,s;return o=new ConfirmCSVFields({props:{file:l[6]}}),o.$on("fields-confirmed",l[17]),o.$on("fields-confirm-cancelled",l[18]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&64&&(d.file=c[6]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_7(l){let o,s;return o=new ConfirmCSVData({props:{file:l[6],requiredFields:l[7]}}),o.$on("data-confirmed",l[19]),o.$on("data-confirm-cancelled",l[18]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&64&&(d.file=c[6]),h[0]&128&&(d.requiredFields=c[7]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_6(l){let o,s;return o=new RegisterDataset({props:{userProfile:l[0],hasStateProvince:l[8].hasStateProvince,datasetCountries:Object.keys(l[8].localityRecordIDMap)}}),o.$on("register-dataset",l[20]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&1&&(d.userProfile=c[0]),h[0]&256&&(d.hasStateProvince=c[8].hasStateProvince),h[0]&256&&(d.datasetCountries=Object.keys(c[8].localityRecordIDMap)),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_5(l){let o,s;return o=new PackAndLoad({props:{localityRecordIDMap:l[8].localityRecordIDMap,invalidCountries:l[11],dataset:l[9],fileForGeoref:l[6],userID:l[1]}}),o.$on("componenterror",handleComponentError),o.$on("upload-complete",l[21]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&256&&(d.localityRecordIDMap=c[8].localityRecordIDMap),h[0]&2048&&(d.invalidCountries=c[11]),h[0]&512&&(d.dataset=c[9]),h[0]&64&&(d.fileForGeoref=c[6]),h[0]&2&&(d.userID=c[1]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_4(l){let o,s;return o=new Welldone({}),o.$on("to-datasets",l[22]),o.$on("start-georeferencing",l[24]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p:noop$2,i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_3(l){let o,s;return o=new DatasetsList({props:{profile:l[0]}}),o.$on("dataset-selected",l[23]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&1&&(d.profile=c[0]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_2(l){let o,s;return o=new DatasetDetail({props:{profile:l[0],dataset:l[10]}}),o.$on("to-datasets",l[22]),o.$on("start-georeferencing",l[24]),o.$on("quality-control",l[32]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&1&&(d.profile=c[0]),h[0]&1024&&(d.dataset=c[10]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block_1(l){let o,s;return o=new Georef_1({props:{profile:l[0],dataset:l[10]}}),o.$on("back-to-datasets",l[33]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&1&&(d.profile=c[0]),h[0]&1024&&(d.dataset=c[10]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_if_block(l){let o,s;return o=new QualityControl({props:{profile:l[0],dataset:l[10]}}),o.$on("to-datasets",l[25]),{c(){create_component(o.$$.fragment)},m(c,h){mount_component(o,c,h),s=!0},p(c,h){const d={};h[0]&1&&(d.profile=c[0]),h[0]&1024&&(d.dataset=c[10]),o.$set(d)},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){destroy_component(o,c)}}}function create_default_slot(l){let o,s,c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is;const _s=[create_if_block_18,create_if_block_19,create_else_block],Hs=[];function ds(Es,fs){return Es[2]?Es[0]?2:1:0}Qo=ds(l),Po=Hs[Qo]=_s[Qo](l);let hs=l[0]&&create_if_block_15(l),ys=l[3]=="Register"&&create_if_block_14(l),ms=l[3]=="SignIn"&&create_if_block_13(l),Rs=l[3]=="ForgotPwd"&&create_if_block_12(),bs=l[3]=="ResetPwd"&&create_if_block_11(l),ps=l[3]=="About"&&create_if_block_10(),ks=l[3]=="Home"&&create_if_block_9(l),xs=l[3]=="ConfirmFields"&&create_if_block_8(l),Ss=l[3]=="ConfirmData"&&create_if_block_7(l),Us=l[3]=="RegisterDataset"&&create_if_block_6(l),Ps=l[3]=="UploadData"&&create_if_block_5(l),Qs=l[3]=="WellDone"&&create_if_block_4(l),Js=l[3]=="DatasetList"&&create_if_block_3(l),qs=l[3]=="DatasetDetail"&&create_if_block_2(l),Gs=l[3]=="Georeferencer"&&create_if_block_1(l),Zs=l[3]=="QualityControl"&&create_if_block(l);return{c(){o=element("div"),s=element("div"),c=element("div"),c.innerHTML=`<img src="images/NSCF logo no text transparent.png" alt="NSCF logo" style="height:100%"/> 
					<span class="logo-span svelte-19yeodk">NSCF Georeferencer</span>`,h=space(),d=element("div"),p=element("div"),Co=element("span"),Co.textContent="Home",Bo=space(),Lo=element("span"),Lo.textContent="About",Uo=space(),Po.c(),Mo=space(),hs&&hs.c(),Go=space(),$o=element("div"),ys&&ys.c(),jo=space(),ms&&ms.c(),zo=space(),Rs&&Rs.c(),Xo=space(),bs&&bs.c(),Zo=space(),ps&&ps.c(),Wo=space(),ks&&ks.c(),es=space(),xs&&xs.c(),is=space(),Ss&&Ss.c(),Jo=space(),Us&&Us.c(),Ko=space(),Ps&&Ps.c(),Yo=space(),Qs&&Qs.c(),ts=space(),Js&&Js.c(),ss=space(),qs&&qs.c(),cs=space(),Gs&&Gs.c(),as=space(),Zs&&Zs.c(),attr(c,"class","header-flex svelte-19yeodk"),set_style(c,"height","100%"),attr(Co,"class","menuitem svelte-19yeodk"),attr(Lo,"class","menuitem svelte-19yeodk"),attr(p,"class","menu svelte-19yeodk"),attr(d,"class","header-right svelte-19yeodk"),attr(s,"class","header svelte-19yeodk"),attr($o,"class","content-container svelte-19yeodk"),attr(o,"class","main-flex-container svelte-19yeodk")},m(Es,fs){insert(Es,o,fs),append(o,s),append(s,c),append(s,h),append(s,d),append(d,p),append(p,Co),append(p,Bo),append(p,Lo),append(d,Uo),Hs[Qo].m(d,null),append(o,Mo),hs&&hs.m(o,null),append(o,Go),append(o,$o),ys&&ys.m($o,null),append($o,jo),ms&&ms.m($o,null),append($o,zo),Rs&&Rs.m($o,null),append($o,Xo),bs&&bs.m($o,null),append($o,Zo),ps&&ps.m($o,null),append($o,Wo),ks&&ks.m($o,null),append($o,es),xs&&xs.m($o,null),append($o,is),Ss&&Ss.m($o,null),append($o,Jo),Us&&Us.m($o,null),append($o,Ko),Ps&&Ps.m($o,null),append($o,Yo),Qs&&Qs.m($o,null),append($o,ts),Js&&Js.m($o,null),append($o,ss),qs&&qs.m($o,null),append($o,cs),Gs&&Gs.m($o,null),append($o,as),Zs&&Zs.m($o,null),us=!0,gs||(Is=[listen(c,"click",l[12]),listen(Co,"click",l[12]),listen(Lo,"click",l[13])],gs=!0)},p(Es,fs){let vs=Qo;Qo=ds(Es),Qo===vs?Hs[Qo].p(Es,fs):(group_outros(),transition_out(Hs[vs],1,1,()=>{Hs[vs]=null}),check_outros(),Po=Hs[Qo],Po?Po.p(Es,fs):(Po=Hs[Qo]=_s[Qo](Es),Po.c()),transition_in(Po,1),Po.m(d,null)),Es[0]?hs?(hs.p(Es,fs),fs[0]&1&&transition_in(hs,1)):(hs=create_if_block_15(Es),hs.c(),transition_in(hs,1),hs.m(o,Go)):hs&&(group_outros(),transition_out(hs,1,1,()=>{hs=null}),check_outros()),Es[3]=="Register"?ys?(ys.p(Es,fs),fs[0]&8&&transition_in(ys,1)):(ys=create_if_block_14(Es),ys.c(),transition_in(ys,1),ys.m($o,jo)):ys&&(group_outros(),transition_out(ys,1,1,()=>{ys=null}),check_outros()),Es[3]=="SignIn"?ms?(ms.p(Es,fs),fs[0]&8&&transition_in(ms,1)):(ms=create_if_block_13(Es),ms.c(),transition_in(ms,1),ms.m($o,zo)):ms&&(group_outros(),transition_out(ms,1,1,()=>{ms=null}),check_outros()),Es[3]=="ForgotPwd"?Rs?(Rs.p(Es,fs),fs[0]&8&&transition_in(Rs,1)):(Rs=create_if_block_12(),Rs.c(),transition_in(Rs,1),Rs.m($o,Xo)):Rs&&(group_outros(),transition_out(Rs,1,1,()=>{Rs=null}),check_outros()),Es[3]=="ResetPwd"?bs?(bs.p(Es,fs),fs[0]&8&&transition_in(bs,1)):(bs=create_if_block_11(Es),bs.c(),transition_in(bs,1),bs.m($o,Zo)):bs&&(group_outros(),transition_out(bs,1,1,()=>{bs=null}),check_outros()),Es[3]=="About"?ps?fs[0]&8&&transition_in(ps,1):(ps=create_if_block_10(),ps.c(),transition_in(ps,1),ps.m($o,Wo)):ps&&(group_outros(),transition_out(ps,1,1,()=>{ps=null}),check_outros()),Es[3]=="Home"?ks?(ks.p(Es,fs),fs[0]&8&&transition_in(ks,1)):(ks=create_if_block_9(Es),ks.c(),transition_in(ks,1),ks.m($o,es)):ks&&(group_outros(),transition_out(ks,1,1,()=>{ks=null}),check_outros()),Es[3]=="ConfirmFields"?xs?(xs.p(Es,fs),fs[0]&8&&transition_in(xs,1)):(xs=create_if_block_8(Es),xs.c(),transition_in(xs,1),xs.m($o,is)):xs&&(group_outros(),transition_out(xs,1,1,()=>{xs=null}),check_outros()),Es[3]=="ConfirmData"?Ss?(Ss.p(Es,fs),fs[0]&8&&transition_in(Ss,1)):(Ss=create_if_block_7(Es),Ss.c(),transition_in(Ss,1),Ss.m($o,Jo)):Ss&&(group_outros(),transition_out(Ss,1,1,()=>{Ss=null}),check_outros()),Es[3]=="RegisterDataset"?Us?(Us.p(Es,fs),fs[0]&8&&transition_in(Us,1)):(Us=create_if_block_6(Es),Us.c(),transition_in(Us,1),Us.m($o,Ko)):Us&&(group_outros(),transition_out(Us,1,1,()=>{Us=null}),check_outros()),Es[3]=="UploadData"?Ps?(Ps.p(Es,fs),fs[0]&8&&transition_in(Ps,1)):(Ps=create_if_block_5(Es),Ps.c(),transition_in(Ps,1),Ps.m($o,Yo)):Ps&&(group_outros(),transition_out(Ps,1,1,()=>{Ps=null}),check_outros()),Es[3]=="WellDone"?Qs?(Qs.p(Es,fs),fs[0]&8&&transition_in(Qs,1)):(Qs=create_if_block_4(Es),Qs.c(),transition_in(Qs,1),Qs.m($o,ts)):Qs&&(group_outros(),transition_out(Qs,1,1,()=>{Qs=null}),check_outros()),Es[3]=="DatasetList"?Js?(Js.p(Es,fs),fs[0]&8&&transition_in(Js,1)):(Js=create_if_block_3(Es),Js.c(),transition_in(Js,1),Js.m($o,ss)):Js&&(group_outros(),transition_out(Js,1,1,()=>{Js=null}),check_outros()),Es[3]=="DatasetDetail"?qs?(qs.p(Es,fs),fs[0]&8&&transition_in(qs,1)):(qs=create_if_block_2(Es),qs.c(),transition_in(qs,1),qs.m($o,cs)):qs&&(group_outros(),transition_out(qs,1,1,()=>{qs=null}),check_outros()),Es[3]=="Georeferencer"?Gs?(Gs.p(Es,fs),fs[0]&8&&transition_in(Gs,1)):(Gs=create_if_block_1(Es),Gs.c(),transition_in(Gs,1),Gs.m($o,as)):Gs&&(group_outros(),transition_out(Gs,1,1,()=>{Gs=null}),check_outros()),Es[3]=="QualityControl"?Zs?(Zs.p(Es,fs),fs[0]&8&&transition_in(Zs,1)):(Zs=create_if_block(Es),Zs.c(),transition_in(Zs,1),Zs.m($o,null)):Zs&&(group_outros(),transition_out(Zs,1,1,()=>{Zs=null}),check_outros())},i(Es){us||(transition_in(Po),transition_in(hs),transition_in(ys),transition_in(ms),transition_in(Rs),transition_in(bs),transition_in(ps),transition_in(ks),transition_in(xs),transition_in(Ss),transition_in(Us),transition_in(Ps),transition_in(Qs),transition_in(Js),transition_in(qs),transition_in(Gs),transition_in(Zs),us=!0)},o(Es){transition_out(Po),transition_out(hs),transition_out(ys),transition_out(ms),transition_out(Rs),transition_out(bs),transition_out(ps),transition_out(ks),transition_out(xs),transition_out(Ss),transition_out(Us),transition_out(Ps),transition_out(Qs),transition_out(Js),transition_out(qs),transition_out(Gs),transition_out(Zs),us=!1},d(Es){Es&&detach(o),Hs[Qo].d(),hs&&hs.d(),ys&&ys.d(),ms&&ms.d(),Rs&&Rs.d(),bs&&bs.d(),ps&&ps.d(),ks&&ks.d(),xs&&xs.d(),Ss&&Ss.d(),Us&&Us.d(),Ps&&Ps.d(),Qs&&Qs.d(),Js&&Js.d(),qs&&qs.d(),Gs&&Gs.d(),Zs&&Zs.d(),gs=!1,run_all(Is)}}}function create_fragment(l){let o,s,c,h,d;return s=new Modal({props:{$$slots:{default:[create_default_slot]},$$scope:{ctx:l}}}),{c(){o=element("main"),create_component(s.$$.fragment),attr(o,"class","svelte-19yeodk")},m(p,Co){insert(p,o,Co),mount_component(s,o,null),c=!0,h||(d=listen(window_1,"unload",l[26]),h=!0)},p(p,Co){const Bo={};Co[0]&4095|Co[1]&256&&(Bo.$$scope={dirty:Co,ctx:p}),s.$set(Bo)},i(p){c||(transition_in(s.$$.fragment,p),c=!0)},o(p){transition_out(s.$$.fragment,p),c=!1},d(p){p&&detach(o),destroy_component(s),h=!1,d()}}}function handleComponentError(l){alert("Oops, something went wrong: "+l.detail.message)}function instance(l,o,s){let c,h,d=!1,p="Home",Co,Bo,Lo,Uo,Qo,Po,Mo,Go;onMount(ys=>{try{getSafeTime().then(console.log)}catch(Rs){alert("There was error with the timestamp API: "+Rs.message)}if(Auth$1.onAuthStateChanged(async Rs=>{Rs?(s(1,h=Rs.uid),window.location.href.includes("/auth/userMgmt")?window.location=window.location.href.split("/auth/userMgmt")[0]:setTimeout(async bs=>{if(c){s(0,c.uid=Rs.uid,c),s(0,c.dateCreated=FieldValue.serverTimestamp(),c);try{await Firestore.collection("userProfiles").doc(c.uid).set(c)}catch(ks){alert("Error saving profile: "+ks.message);return}let ps=Firestore.collection("userDatasets");try{let ks=await ps.doc(c.searchEmail).get();if(ks.exists){let xs=ks.data(),Ss=ps.doc(c.uid).set(xs),Us=ps.doc(c.searchEmail).delete();await Promise.all([Ss,Us])}}catch(ks){alert("Error updating invited datasets for this user: "+ks.message);return}}else try{let ps=await Firestore.collection("userProfiles").doc(Rs.uid).get();ps.exists?(s(0,c=ps.data()),s(1,h=Rs.uid),s(2,d=!0),s(3,p="Home")):console.log("no profile for this user")}catch(ps){alert("error fetching user profile: "+ps.message)}await Firestore.collection("usersSignedIn").doc("users").update({uids:FieldValue.arrayUnion(Rs.uid)}),s(3,p="Home")},100)):(s(0,c=null),s(1,h=null),s(2,d=!0))}),window.location.href.includes("/auth/userMgmt")){console.log("got this far");let Rs=new URL(window.location).searchParams;console.log("mode is",Rs.get("mode")),Rs.get("mode")=="resetPassword"&&(s(4,Co=Rs.get("oobCode")),s(3,p="ResetPwd"))}window.performance&&performance.navigation.type==performance.navigation.TYPE_RELOAD&&window.location.href.includes("/auth/userMgmt")&&(window.location=window.location.href.split("/auth/userMgmt")[0])});function $o(){p=="Georeferencer"?alert("Please click 'Done' above the locality group to return"):p=="Home"?Bo.closeSearching():s(3,p="Home")}function jo(){p!="About"&&s(3,p="About")}function zo(ys){ys.detail&&s(0,c=ys.detail)}function Xo(){Auth$1.signOut().then(ys=>{s(0,c=null),s(1,h=null),s(3,p="Home")}).catch(ys=>{alert("error signing out: "+ys.message)})}function Zo(ys){s(6,Lo=ys.detail.file),console.log("we got file",Lo.name),s(3,p="ConfirmFields")}function Wo(ys){s(7,Uo=ys.detail),s(3,p="ConfirmData")}function es(){s(6,Lo=s(7,Uo=null)),s(3,p="Home")}function is(ys){s(8,Qo=ys.detail),s(3,p="RegisterDataset")}function Jo(ys){s(9,Po=ys.detail.datasetDetails),s(11,Go=ys.detail.invalidCountries),s(9,Po.recordIDField=Uo.recordIDField,Po),s(9,Po.localityField=Uo.localityField,Po),s(3,p="UploadData")}function Ko(ys){s(3,p="WellDone")}function Yo(){s(3,p="DatasetList")}function ts(ys){s(10,Mo=ys.detail),s(3,p="DatasetDetail")}function ss(){s(3,p="Georeferencer")}function cs(){s(10,Mo=null),s(3,p="DatasetList")}const as=async ys=>await Firestore.collection("usersSignedIn").doc("users").update({uids:FieldValue.arrayRemove(c.uid)}),us=ys=>s(3,p="Register"),gs=ys=>s(3,p="SignIn"),Is=ys=>s(3,p="ForgotPwd"),_s=ys=>s(3,p="SignIn");function Hs(ys){binding_callbacks[ys?"unshift":"push"](()=>{Bo=ys,s(5,Bo)})}return[c,h,d,p,Co,Bo,Lo,Uo,Qo,Po,Mo,Go,$o,jo,zo,Xo,Zo,Wo,es,is,Jo,Ko,Yo,ts,ss,cs,as,us,gs,Is,_s,Hs,ys=>s(3,p="QualityControl"),ys=>s(3,p="DatasetList")]}class App extends SvelteComponent{constructor(o){super(),init(this,o,instance,create_fragment,safe_not_equal,{},null,[-1,-1])}}new App({target:document.body})});export default pw();
